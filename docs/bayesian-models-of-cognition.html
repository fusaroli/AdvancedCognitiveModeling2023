<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Bayesian Models of Cognition | 09-BayesianModels</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Bayesian Models of Cognition | 09-BayesianModels" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Bayesian Models of Cognition | 09-BayesianModels" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mixture-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.4</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.5</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
<li class="chapter" data-level="5.7.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.7.2</b> Connection to Kalman Filters</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.2</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#bayesian-memory-agent"><i class="fa fa-check"></i><b>5.9</b> Bayesian memory agent</a></li>
<li class="chapter" data-level="5.10" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.10</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#complete-pooling"><i class="fa fa-check"></i><b>7.3.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="7.3.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#no-pooling"><i class="fa fa-check"></i><b>7.3.2</b> No Pooling</a></li>
<li class="chapter" data-level="7.3.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#partial-pooling-multilevel-modeling"><i class="fa fa-check"></i><b>7.3.3</b> Partial Pooling (Multilevel Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#graphical-model-visualization"><i class="fa fa-check"></i><b>7.4</b> Graphical Model Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#biased-agent-model"><i class="fa fa-check"></i><b>7.4.1</b> Biased Agent Model</a></li>
<li class="chapter" data-level="7.4.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#memory-agent-model"><i class="fa fa-check"></i><b>7.4.2</b> Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random-agent-model"><i class="fa fa-check"></i><b>7.8</b> Multilevel Random Agent Model</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.8.1</b> Assessing multilevel random agents</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#lets-look-at-individuals"><i class="fa fa-check"></i><b>7.9</b> Let’s look at individuals</a></li>
<li class="chapter" data-level="7.10" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-sensitivity-checks"><i class="fa fa-check"></i><b>7.10</b> Prior sensitivity checks</a></li>
<li class="chapter" data-level="7.11" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-1"><i class="fa fa-check"></i><b>7.11</b> Parameter recovery</a></li>
<li class="chapter" data-level="7.12" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-agent-model"><i class="fa fa-check"></i><b>7.12</b> Multilevel Memory Agent Model</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.12.1</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#diagnosing-the-issue-with-bias-and-beta"><i class="fa fa-check"></i><b>7.12.2</b> Diagnosing the issue with bias and beta</a></li>
<li class="chapter" data-level="7.12.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.12.3</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.12.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.12.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.12.5</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.12.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.12.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#section"><i class="fa fa-check"></i><b>7.12.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches"><i class="fa fa-check"></i><b>7.13</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.14" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches-1"><i class="fa fa-check"></i><b>7.14</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.15" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-modeling-cheatsheet"><i class="fa fa-check"></i><b>7.15</b> Multilevel Modeling Cheatsheet</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#when-to-use-each-pooling-approach"><i class="fa fa-check"></i><b>7.15.1</b> When to Use Each Pooling Approach:</a></li>
<li class="chapter" data-level="7.15.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-rules-of-thumb"><i class="fa fa-check"></i><b>7.15.2</b> Parameter Recovery Rules of Thumb:</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#conclusion-the-power-and-challenges-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.16</b> Conclusion: The Power and Challenges of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.17" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#exercises-just-some-ideas"><i class="fa fa-check"></i><b>7.17</b> Exercises (just some ideas)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-challenge-of-model-selection"><i class="fa fa-check"></i><b>8.2.1</b> The Challenge of Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-the-foundation-of-model-comparison"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation: The Foundation of Model Comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-problem-of-overfitting"><i class="fa fa-check"></i><b>8.3.1</b> The Problem of Overfitting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-cross-validation-works"><i class="fa fa-check"></i><b>8.3.2</b> How Cross-Validation Works</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-in-bayesian-models"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation in Bayesian Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#expected-log-predictive-density-elpd"><i class="fa fa-check"></i><b>8.3.4</b> Expected Log Predictive Density (ELPD)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-an-efficient-approximation-to-loo-cv"><i class="fa fa-check"></i><b>8.4</b> PSIS-LOO: An Efficient Approximation to LOO-CV</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-importance-sampling-works"><i class="fa fa-check"></i><b>8.4.1</b> How Importance Sampling Works</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#pareto-smoothing-for-stability"><i class="fa fa-check"></i><b>8.4.2</b> Pareto Smoothing for Stability</a></li>
<li class="chapter" data-level="8.4.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-complete-psis-loo-process"><i class="fa fa-check"></i><b>8.4.3</b> The Complete PSIS-LOO Process</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#simulation-based-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Simulation-Based Model Comparison</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-simulation-parameters"><i class="fa fa-check"></i><b>8.5.1</b> Define Simulation Parameters</a></li>
<li class="chapter" data-level="8.5.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-agent-functions"><i class="fa fa-check"></i><b>8.5.2</b> Define Agent Functions</a></li>
<li class="chapter" data-level="8.5.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generate-simulation-data"><i class="fa fa-check"></i><b>8.5.3</b> Generate Simulation Data</a></li>
<li class="chapter" data-level="8.5.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualize-the-simulation-data"><i class="fa fa-check"></i><b>8.5.4</b> Visualize the Simulation Data</a></li>
<li class="chapter" data-level="8.5.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prepare-data-for-stan-models"><i class="fa fa-check"></i><b>8.5.5</b> Prepare Data for Stan Models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-models-for-comparison"><i class="fa fa-check"></i><b>8.6</b> Implementing Models for Comparison</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#understanding-log-likelihood-in-model-comparison"><i class="fa fa-check"></i><b>8.6.1</b> Understanding Log-Likelihood in Model Comparison</a></li>
<li class="chapter" data-level="8.6.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-biased-agent-model"><i class="fa fa-check"></i><b>8.6.2</b> Multilevel Biased Agent Model</a></li>
<li class="chapter" data-level="8.6.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-agent-model-1"><i class="fa fa-check"></i><b>8.6.3</b> Multilevel Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-models-and-calculating-expected-log-predictive-density"><i class="fa fa-check"></i><b>8.7</b> Fitting Models and Calculating Expected Log Predictive Density</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-for-model-comparison"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation for Model Comparison</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-comparison"><i class="fa fa-check"></i><b>8.9.1</b> PSIS-LOO Comparison</a></li>
<li class="chapter" data-level="8.9.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualizing-loo-cv-results"><i class="fa fa-check"></i><b>8.9.2</b> Visualizing LOO-CV Results</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#formal-model-comparison"><i class="fa fa-check"></i><b>8.10</b> Formal Model Comparison</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#k-fold-cross-validation-for-validation"><i class="fa fa-check"></i><b>8.10.1</b> K-Fold Cross-Validation for Validation</a></li>
<li class="chapter" data-level="8.10.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#comparing-loo-and-k-fold-results"><i class="fa fa-check"></i><b>8.10.2</b> Comparing LOO and K-Fold Results</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-approaches"><i class="fa fa-check"></i><b>8.11</b> Limitations of Model Comparison Approaches</a></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#exercises"><i class="fa fa-check"></i><b>8.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.12.1</b> Rant on internal vs external validity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>9</b> Mixture models</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="mixture-models.html"><a href="mixture-models.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.0.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.0.2" data-path="mixture-models.html"><a href="mixture-models.html#chapter-roadmap"><i class="fa fa-check"></i><b>9.0.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="9.1" data-path="mixture-models.html"><a href="mixture-models.html#visualizing-mixture-distributions-reaction-time-example"><i class="fa fa-check"></i><b>9.1</b> Visualizing Mixture Distributions: Reaction Time Example</a></li>
<li class="chapter" data-level="9.2" data-path="mixture-models.html"><a href="mixture-models.html#theoretical-foundation-for-mixture-models"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation for Mixture Models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mixture-models.html"><a href="mixture-models.html#the-mixture-model-framework"><i class="fa fa-check"></i><b>9.2.1</b> The Mixture Model Framework</a></li>
<li class="chapter" data-level="9.2.2" data-path="mixture-models.html"><a href="mixture-models.html#mixture-models-and-latent-variables"><i class="fa fa-check"></i><b>9.2.2</b> Mixture Models and Latent Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-in-cognitive-modeling"><i class="fa fa-check"></i><b>9.2.3</b> Applications in Cognitive Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mixture-models.html"><a href="mixture-models.html#implementing-a-basic-mixture-model"><i class="fa fa-check"></i><b>9.3</b> Implementing a Basic Mixture Model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixture-models.html"><a href="mixture-models.html#simulating-mixed-strategy-data"><i class="fa fa-check"></i><b>9.3.1</b> Simulating Mixed Strategy Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation-of-a-mixture-model"><i class="fa fa-check"></i><b>9.3.2</b> Stan Implementation of a Mixture Model</a></li>
<li class="chapter" data-level="9.3.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-mixture-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting and Evaluating the Mixture Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="mixture-models.html"><a href="mixture-models.html#model-diagnostics"><i class="fa fa-check"></i><b>9.3.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="9.3.5" data-path="mixture-models.html"><a href="mixture-models.html#parameter-recovery-analysis"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="9.3.6" data-path="mixture-models.html"><a href="mixture-models.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>9.3.6</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixture-models.html"><a href="mixture-models.html#parameter-interpretation"><i class="fa fa-check"></i><b>9.4</b> Parameter Interpretation</a></li>
<li class="chapter" data-level="9.5" data-path="mixture-models.html"><a href="mixture-models.html#multilevel-mixture-models"><i class="fa fa-check"></i><b>9.5</b> Multilevel Mixture Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation"><i class="fa fa-check"></i><b>9.5.1</b> Stan Implementation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mixture-models.html"><a href="mixture-models.html#preparing-data-for-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.2</b> Preparing Data for the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.3</b> Fitting and Evaluating the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.4" data-path="mixture-models.html"><a href="mixture-models.html#examining-individual-differences"><i class="fa fa-check"></i><b>9.5.4</b> Examining Individual Differences</a></li>
<li class="chapter" data-level="9.5.5" data-path="mixture-models.html"><a href="mixture-models.html#interpreting-parameter-correlations"><i class="fa fa-check"></i><b>9.5.5</b> Interpreting Parameter Correlations</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mixture-models.html"><a href="mixture-models.html#comparing-single-process-and-mixture-models"><i class="fa fa-check"></i><b>9.6</b> Comparing Single-Process and Mixture Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mixture-models.html"><a href="mixture-models.html#single-process-model"><i class="fa fa-check"></i><b>9.6.1</b> Single-Process Model</a></li>
<li class="chapter" data-level="9.6.2" data-path="mixture-models.html"><a href="mixture-models.html#model-comparison"><i class="fa fa-check"></i><b>9.6.2</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-of-mixture-models-in-cognitive-science"><i class="fa fa-check"></i><b>9.6.3</b> Applications of Mixture Models in Cognitive Science</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mixture-models.html"><a href="mixture-models.html#conclusion-2"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>10</b> Bayesian Models of Cognition</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#introduction-3"><i class="fa fa-check"></i><b>10.0.1</b> Introduction</a></li>
<li class="chapter" data-level="10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#learning-objectives-4"><i class="fa fa-check"></i><b>10.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#chapter-roadmap-1"><i class="fa fa-check"></i><b>10.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition"><i class="fa fa-check"></i><b>10.3</b> The Bayesian Framework for Cognition</a></li>
<li class="chapter" data-level="10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating"><i class="fa fa-check"></i><b>10.4</b> Visualizing Bayesian Updating</a></li>
<li class="chapter" data-level="10.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science"><i class="fa fa-check"></i><b>10.5</b> Bayesian Models in Cognitive Science</a></li>
<li class="chapter" data-level="10.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making"><i class="fa fa-check"></i><b>10.6</b> Example: Social Influence in Perceptual Decision-Making</a></li>
<li class="chapter" data-level="10.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task"><i class="fa fa-check"></i><b>10.7</b> A Bayesian Integration Model for the Marble Task</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions"><i class="fa fa-check"></i><b>10.7.1</b> Intuitive Explanation Using Beta Distributions</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model"><i class="fa fa-check"></i><b>10.8</b> The Mathematical Model</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evidence-representation"><i class="fa fa-check"></i><b>10.8.1</b> Evidence Representation</a></li>
<li class="chapter" data-level="10.8.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration"><i class="fa fa-check"></i><b>10.8.2</b> Integration</a></li>
<li class="chapter" data-level="10.8.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#decision"><i class="fa fa-check"></i><b>10.8.3</b> Decision</a></li>
<li class="chapter" data-level="10.8.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation-in-r"><i class="fa fa-check"></i><b>10.8.4</b> Implementation in R</a></li>
<li class="chapter" data-level="10.8.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios"><i class="fa fa-check"></i><b>10.8.5</b> Simulating Experimental Scenarios</a></li>
<li class="chapter" data-level="10.8.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration"><i class="fa fa-check"></i><b>10.8.6</b> Visualizing Bayesian Integration</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios"><i class="fa fa-check"></i><b>10.9</b> Examining Belief Distributions for Selected Scenarios</a></li>
<li class="chapter" data-level="10.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayesian-integration"><i class="fa fa-check"></i><b>10.10</b> Weighted Bayesian Integration</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model-1"><i class="fa fa-check"></i><b>10.10.1</b> The Mathematical Model</a></li>
<li class="chapter" data-level="10.10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation"><i class="fa fa-check"></i><b>10.10.2</b> Implementation</a></li>
<li class="chapter" data-level="10.10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration"><i class="fa fa-check"></i><b>10.10.3</b> Visualizing Weighted Bayesian Integration</a></li>
<li class="chapter" data-level="10.10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence"><i class="fa fa-check"></i><b>10.10.4</b> Resolving Conflicting Evidence</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#common-misinterpretations"><i class="fa fa-check"></i><b>10.11</b> Common Misinterpretations</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weight-interpretation"><i class="fa fa-check"></i><b>10.11.1</b> Weight Interpretation</a></li>
<li class="chapter" data-level="10.11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration-vs.-averaging"><i class="fa fa-check"></i><b>10.11.2</b> Integration vs. Averaging</a></li>
<li class="chapter" data-level="10.11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#interpreting-confidence"><i class="fa fa-check"></i><b>10.11.3</b> Interpreting Confidence</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies"><i class="fa fa-check"></i><b>10.12</b> Simulating Agents with Different Evidence Weighting Strategies</a></li>
<li class="chapter" data-level="10.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation"><i class="fa fa-check"></i><b>10.13</b> Key Observations from the Simulation</a></li>
<li class="chapter" data-level="10.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-quality-checks"><i class="fa fa-check"></i><b>10.14</b> Model Quality Checks</a>
<ul>
<li class="chapter" data-level="10.14.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#overview"><i class="fa fa-check"></i><b>10.14.1</b> Overview</a></li>
<li class="chapter" data-level="10.14.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks"><i class="fa fa-check"></i><b>10.14.2</b> Prior and Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="10.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization"><i class="fa fa-check"></i><b>10.15</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="10.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-2"><i class="fa fa-check"></i><b>10.16</b> Parameter recovery</a></li>
<li class="chapter" data-level="10.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models"><i class="fa fa-check"></i><b>10.17</b> Multilevel Bayesian Models</a>
<ul>
<li class="chapter" data-level="10.17.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents"><i class="fa fa-check"></i><b>10.17.1</b> Simulating Data from Multiple Agents</a></li>
<li class="chapter" data-level="10.17.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-individual-differences-in-decision-patterns"><i class="fa fa-check"></i><b>10.17.2</b> Visualizing Individual Differences in Decision Patterns</a></li>
<li class="chapter" data-level="10.17.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-simple-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>10.17.3</b> Implementing the Multilevel Simple Beta-Binomial Model in Stan</a></li>
<li class="chapter" data-level="10.17.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>10.17.4</b> Implementing the Multilevel Weighted Beta-Binomial Model in Stan</a></li>
<li class="chapter" data-level="10.17.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#preparing-data-for-stan-fitting"><i class="fa fa-check"></i><b>10.17.5</b> Preparing Data for Stan Fitting</a></li>
<li class="chapter" data-level="10.17.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-diagnostics-and-quality-checks"><i class="fa fa-check"></i><b>10.17.6</b> Model Diagnostics and Quality Checks</a></li>
<li class="chapter" data-level="10.17.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1"><i class="fa fa-check"></i><b>10.17.7</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="10.17.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#population-level-parameter-analysis"><i class="fa fa-check"></i><b>10.17.8</b> Population-Level Parameter Analysis</a></li>
<li class="chapter" data-level="10.17.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#posterior-predictive-checks-2"><i class="fa fa-check"></i><b>10.17.9</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="10.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-1"><i class="fa fa-check"></i><b>10.18</b> Model Comparison</a></li>
<li class="chapter" data-level="10.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#extensions-and-applications"><i class="fa fa-check"></i><b>10.19</b> Extensions and Applications</a>
<ul>
<li class="chapter" data-level="10.19.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#time-varying-weights"><i class="fa fa-check"></i><b>10.19.1</b> Time-Varying Weights</a></li>
<li class="chapter" data-level="10.19.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#group-comparisons"><i class="fa fa-check"></i><b>10.19.2</b> Group Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="10.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#cognitive-implications-of-multilevel-bayesian-models"><i class="fa fa-check"></i><b>10.20</b> Cognitive Implications of Multilevel Bayesian Models</a></li>
<li class="chapter" data-level="10.21" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#conclusion-3"><i class="fa fa-check"></i><b>10.21</b> Conclusion</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">09-BayesianModels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-models-of-cognition" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Bayesian Models of Cognition<a href="bayesian-models-of-cognition.html#bayesian-models-of-cognition" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-3" class="section level3 hasAnchor" number="10.0.1">
<h3><span class="header-section-number">10.0.1</span> Introduction<a href="bayesian-models-of-cognition.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The impressive power of Bayes theorem and Bayesian approaches to modeling has tempted cognitive scientists into exploring how far they could get in thinking the mind and brain as Bayesian machines. The idea is that the mind is a probabilistic machine that updates its beliefs based on the evidence it receives. The human mind constantly receives input from various sources – direct personal experience, social information from others, prior knowledge, and sensory input. A fundamental question in cognitive science is how these disparate pieces of information are combined to produce coherent beliefs about the world.
The Bayesian framework offers a powerful approach to modeling this process. Under this framework, the mind is conceptualized as a probabilistic machine that continuously updates its beliefs based on new evidence. This contrasts with rule-based or purely associative models by emphasizing:</p>
<ul>
<li><p>Representations of uncertainty: Beliefs are represented as probability distributions, not single values</p></li>
<li><p>Optimal integration: Information is combined according to its reliability</p></li>
<li><p>Prior knowledge: New evidence is interpreted in light of existing beliefs</p></li>
</ul>
<p>In this chapter, we will explore how Bayesian integration can be formalized and used to model cognitive processes. We’ll start with simple models that give equal weight to different information sources, then develop more sophisticated models that allow for differential weighting based on source reliability, and finally consider how beliefs might update over time.</p>
<p>This chapter is not a comprehensive review of Bayesian cognitive modeling, but rather a practical introduction to the topic. We’ll focus on simple models that illustrate key concepts and provide a foundation for more advanced applications.</p>
<p>To go further in your learning check on Bayesian models of cognition check:</p>
<ul>
<li><p>Ma, W. J., Kording, K. P., &amp; Goldreich, D. (2023). Bayesian models of perception and action: An introduction. MIT press.</p></li>
<li><p>Griffiths, T. L., Chater, N., &amp; Tenenbaum, J. B. (Eds.). (2024). Bayesian models of cognition: reverse engineering the mind. MIT Press.</p></li>
<li><p>N. D. Goodman, J. B. Tenenbaum, and The ProbMods Contributors (2016). Probabilistic Models of Cognition (2nd ed.). Retrieved 2025-3-10 from <a href="https://probmods.org/" class="uri">https://probmods.org/</a></p></li>
</ul>
</div>
<div id="learning-objectives-4" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Learning Objectives<a href="bayesian-models-of-cognition.html#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After completing this chapter, you will be able to:</p>
<ul>
<li><p>Understand the basic principles of Bayesian information integration</p></li>
<li><p>Implement models that combine multiple sources of information in a principled Bayesian way</p></li>
<li><p>Fit and evaluate these models using Stan</p></li>
<li><p>Differentiate between alternative Bayesian updating schemes</p></li>
<li><p>Apply Bayesian cognitive models to decision-making data</p></li>
</ul>
</div>
<div id="chapter-roadmap-1" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Chapter Roadmap<a href="bayesian-models-of-cognition.html#chapter-roadmap-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will:</p>
<ul>
<li><p>Introduce the Bayesian framework for cognitive modeling</p></li>
<li><p>Implement a simple Bayesian integration model</p></li>
<li><p>Develop and test a weighted Bayesian model that allows for different source reliability</p></li>
<li><p>Explore temporal Bayesian updating</p></li>
<li><p>Extend our models to multilevel structures that capture individual differences</p></li>
<li><p>Compare alternative Bayesian models and evaluate their cognitive implications</p></li>
</ul>
</div>
<div id="the-bayesian-framework-for-cognition" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> The Bayesian Framework for Cognition<a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian models of cognition explore the idea that the mind operates according to principles similar to Bayes’ theorem, combining different sources of evidence to form updated beliefs. Most commonly this is framed in terms of prior beliefs being updated with new evidence to form updated posterior beliefs. Formally:</p>
<p>P(belief | evidence) ∝ P(evidence | belief) × P(belief)</p>
<p>Where:</p>
<ul>
<li><p>P(belief | evidence) is the posterior belief after observing evidence</p></li>
<li><p>P(evidence | belief) is the likelihood of observing the evidence given a belief</p></li>
<li><p>P(belief) is the prior belief before observing evidence</p></li>
</ul>
<p>In cognitive terms, this means people integrate new information with existing knowledge, giving more weight to reliable information sources and less weight to unreliable ones. Yet, there is nothing mathematically special about the prior and the likelihood. They are just two sources of information that are combined in a way that is consistent with the rules of probability. Any other combination of information sources can be modeled with the same theorem.</p>
<hr />
<p>Note that a more traditional formula for Bayes Theorem would be</p>
<p>P(belief | evidence) = [P(evidence | belief) × P(belief)] / P(evidence)</p>
<p>where the product of prior and likelihood is normalized by P(evidence) (bringing it back to a probability scale).
That’s why we used a ∝ symbol in the formula above, to indicate that we are not considering the normalization constant, and that the posterior is only proportional (and not exactly equal) to the multiplication of the two sources of information. Nevertheless, this is a first useful approximation of the theorem, which we can build on in the rest of the chapter.
***</p>
</div>
<div id="visualizing-bayesian-updating" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Visualizing Bayesian Updating<a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To better understand Bayesian updating, let’s create a conceptual diagram:</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="bayesian-models-of-cognition.html#cb411-1" tabindex="-1"></a><span class="co"># Create a visualization of Bayesian updating process</span></span>
<span id="cb411-2"><a href="bayesian-models-of-cognition.html#cb411-2" tabindex="-1"></a></span>
<span id="cb411-3"><a href="bayesian-models-of-cognition.html#cb411-3" tabindex="-1"></a><span class="co"># Function to create Bayesian updating visualization</span></span>
<span id="cb411-4"><a href="bayesian-models-of-cognition.html#cb411-4" tabindex="-1"></a>create_bayesian_updating_diagram <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb411-5"><a href="bayesian-models-of-cognition.html#cb411-5" tabindex="-1"></a>  <span class="co"># Create example data</span></span>
<span id="cb411-6"><a href="bayesian-models-of-cognition.html#cb411-6" tabindex="-1"></a>  <span class="co"># Prior (starting with uniform distribution)</span></span>
<span id="cb411-7"><a href="bayesian-models-of-cognition.html#cb411-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb411-8"><a href="bayesian-models-of-cognition.html#cb411-8" tabindex="-1"></a>  prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb411-9"><a href="bayesian-models-of-cognition.html#cb411-9" tabindex="-1"></a>  </span>
<span id="cb411-10"><a href="bayesian-models-of-cognition.html#cb411-10" tabindex="-1"></a>  <span class="co"># Likelihood (evidence suggesting higher probability)</span></span>
<span id="cb411-11"><a href="bayesian-models-of-cognition.html#cb411-11" tabindex="-1"></a>  likelihood <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="dv">7</span>, <span class="dv">3</span>)</span>
<span id="cb411-12"><a href="bayesian-models-of-cognition.html#cb411-12" tabindex="-1"></a>  </span>
<span id="cb411-13"><a href="bayesian-models-of-cognition.html#cb411-13" tabindex="-1"></a>  <span class="co"># Posterior (combines prior and likelihood)</span></span>
<span id="cb411-14"><a href="bayesian-models-of-cognition.html#cb411-14" tabindex="-1"></a>  posterior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="dv">8</span>, <span class="dv">4</span>)  <span class="co"># 1+7, 1+3</span></span>
<span id="cb411-15"><a href="bayesian-models-of-cognition.html#cb411-15" tabindex="-1"></a>  </span>
<span id="cb411-16"><a href="bayesian-models-of-cognition.html#cb411-16" tabindex="-1"></a>  <span class="co"># Create data frame for plotting</span></span>
<span id="cb411-17"><a href="bayesian-models-of-cognition.html#cb411-17" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb411-18"><a href="bayesian-models-of-cognition.html#cb411-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb411-19"><a href="bayesian-models-of-cognition.html#cb411-19" tabindex="-1"></a>    <span class="at">density =</span> <span class="fu">c</span>(prior, likelihood, posterior),</span>
<span id="cb411-20"><a href="bayesian-models-of-cognition.html#cb411-20" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Likelihood&quot;</span>, <span class="st">&quot;Posterior&quot;</span>), <span class="at">each =</span> <span class="fu">length</span>(x)),</span>
<span id="cb411-21"><a href="bayesian-models-of-cognition.html#cb411-21" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Likelihood&quot;</span>, <span class="st">&quot;Posterior&quot;</span>))</span>
<span id="cb411-22"><a href="bayesian-models-of-cognition.html#cb411-22" tabindex="-1"></a>  )</span>
<span id="cb411-23"><a href="bayesian-models-of-cognition.html#cb411-23" tabindex="-1"></a>  </span>
<span id="cb411-24"><a href="bayesian-models-of-cognition.html#cb411-24" tabindex="-1"></a>  <span class="co"># Create main plot showing distributions</span></span>
<span id="cb411-25"><a href="bayesian-models-of-cognition.html#cb411-25" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">color =</span> distribution, <span class="at">linetype =</span> distribution)) <span class="sc">+</span></span>
<span id="cb411-26"><a href="bayesian-models-of-cognition.html#cb411-26" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb411-27"><a href="bayesian-models-of-cognition.html#cb411-27" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Likelihood&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;purple&quot;</span>)) <span class="sc">+</span></span>
<span id="cb411-28"><a href="bayesian-models-of-cognition.html#cb411-28" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;Likelihood&quot;</span> <span class="ot">=</span> <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;solid&quot;</span>)) <span class="sc">+</span></span>
<span id="cb411-29"><a href="bayesian-models-of-cognition.html#cb411-29" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bayesian Updating Process&quot;</span>,</span>
<span id="cb411-30"><a href="bayesian-models-of-cognition.html#cb411-30" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Combining prior beliefs with new evidence&quot;</span>,</span>
<span id="cb411-31"><a href="bayesian-models-of-cognition.html#cb411-31" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Belief (probability)&quot;</span>,</span>
<span id="cb411-32"><a href="bayesian-models-of-cognition.html#cb411-32" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Probability Density&quot;</span>,</span>
<span id="cb411-33"><a href="bayesian-models-of-cognition.html#cb411-33" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Distribution&quot;</span>,</span>
<span id="cb411-34"><a href="bayesian-models-of-cognition.html#cb411-34" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="st">&quot;Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb411-35"><a href="bayesian-models-of-cognition.html#cb411-35" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb411-36"><a href="bayesian-models-of-cognition.html#cb411-36" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb411-37"><a href="bayesian-models-of-cognition.html#cb411-37" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="fl">0.9</span>, <span class="at">label =</span> <span class="st">&quot;Low certainty</span><span class="sc">\n</span><span class="st">prior belief&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb411-38"><a href="bayesian-models-of-cognition.html#cb411-38" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">&quot;New evidence</span><span class="sc">\n</span><span class="st">suggests high</span><span class="sc">\n</span><span class="st">probability&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb411-39"><a href="bayesian-models-of-cognition.html#cb411-39" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">2.2</span>, <span class="at">label =</span> <span class="st">&quot;Updated belief</span><span class="sc">\n</span><span class="st">combines both</span><span class="sc">\n</span><span class="st">sources&quot;</span>, <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb411-40"><a href="bayesian-models-of-cognition.html#cb411-40" tabindex="-1"></a>  </span>
<span id="cb411-41"><a href="bayesian-models-of-cognition.html#cb411-41" tabindex="-1"></a>  <span class="co"># Create flow diagram to illustrate process</span></span>
<span id="cb411-42"><a href="bayesian-models-of-cognition.html#cb411-42" tabindex="-1"></a>  flow_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb411-43"><a href="bayesian-models-of-cognition.html#cb411-43" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb411-44"><a href="bayesian-models-of-cognition.html#cb411-44" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb411-45"><a href="bayesian-models-of-cognition.html#cb411-45" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Prior</span><span class="sc">\n</span><span class="st">Belief&quot;</span>, <span class="st">&quot;Evidence&quot;</span>, <span class="st">&quot;Posterior</span><span class="sc">\n</span><span class="st">Belief&quot;</span>),</span>
<span id="cb411-46"><a href="bayesian-models-of-cognition.html#cb411-46" tabindex="-1"></a>    <span class="at">box_color =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb411-47"><a href="bayesian-models-of-cognition.html#cb411-47" tabindex="-1"></a>  )</span>
<span id="cb411-48"><a href="bayesian-models-of-cognition.html#cb411-48" tabindex="-1"></a>  </span>
<span id="cb411-49"><a href="bayesian-models-of-cognition.html#cb411-49" tabindex="-1"></a>  arrow_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb411-50"><a href="bayesian-models-of-cognition.html#cb411-50" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="fl">2.3</span>),</span>
<span id="cb411-51"><a href="bayesian-models-of-cognition.html#cb411-51" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">2.7</span>),</span>
<span id="cb411-52"><a href="bayesian-models-of-cognition.html#cb411-52" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb411-53"><a href="bayesian-models-of-cognition.html#cb411-53" tabindex="-1"></a>    <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb411-54"><a href="bayesian-models-of-cognition.html#cb411-54" tabindex="-1"></a>  )</span>
<span id="cb411-55"><a href="bayesian-models-of-cognition.html#cb411-55" tabindex="-1"></a>  </span>
<span id="cb411-56"><a href="bayesian-models-of-cognition.html#cb411-56" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb411-57"><a href="bayesian-models-of-cognition.html#cb411-57" tabindex="-1"></a>    <span class="co"># Add boxes for process stages</span></span>
<span id="cb411-58"><a href="bayesian-models-of-cognition.html#cb411-58" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> flow_data, <span class="fu">aes</span>(<span class="at">xmin =</span> x <span class="sc">-</span> <span class="fl">0.3</span>, <span class="at">xmax =</span> x <span class="sc">+</span> <span class="fl">0.3</span>, </span>
<span id="cb411-59"><a href="bayesian-models-of-cognition.html#cb411-59" tabindex="-1"></a>                                   <span class="at">ymin =</span> y <span class="sc">-</span> <span class="fl">0.3</span>, <span class="at">ymax =</span> y <span class="sc">+</span> <span class="fl">0.3</span>,</span>
<span id="cb411-60"><a href="bayesian-models-of-cognition.html#cb411-60" tabindex="-1"></a>                                   <span class="at">fill =</span> box_color), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb411-61"><a href="bayesian-models-of-cognition.html#cb411-61" tabindex="-1"></a>    <span class="co"># Add text labels</span></span>
<span id="cb411-62"><a href="bayesian-models-of-cognition.html#cb411-62" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> flow_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb411-63"><a href="bayesian-models-of-cognition.html#cb411-63" tabindex="-1"></a>    <span class="co"># Add arrows</span></span>
<span id="cb411-64"><a href="bayesian-models-of-cognition.html#cb411-64" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> arrow_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend),</span>
<span id="cb411-65"><a href="bayesian-models-of-cognition.html#cb411-65" tabindex="-1"></a>                <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>)) <span class="sc">+</span></span>
<span id="cb411-66"><a href="bayesian-models-of-cognition.html#cb411-66" tabindex="-1"></a>    <span class="co"># Add the operation being performed</span></span>
<span id="cb411-67"><a href="bayesian-models-of-cognition.html#cb411-67" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">label =</span> <span class="st">&quot;×&quot;</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb411-68"><a href="bayesian-models-of-cognition.html#cb411-68" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">label =</span> <span class="st">&quot;∝&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb411-69"><a href="bayesian-models-of-cognition.html#cb411-69" tabindex="-1"></a>    <span class="co"># Formatting</span></span>
<span id="cb411-70"><a href="bayesian-models-of-cognition.html#cb411-70" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>)) <span class="sc">+</span></span>
<span id="cb411-71"><a href="bayesian-models-of-cognition.html#cb411-71" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb411-72"><a href="bayesian-models-of-cognition.html#cb411-72" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb411-73"><a href="bayesian-models-of-cognition.html#cb411-73" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bayesian Inference Flow&quot;</span>)</span>
<span id="cb411-74"><a href="bayesian-models-of-cognition.html#cb411-74" tabindex="-1"></a>  </span>
<span id="cb411-75"><a href="bayesian-models-of-cognition.html#cb411-75" tabindex="-1"></a>  <span class="co"># Combine plots vertically</span></span>
<span id="cb411-76"><a href="bayesian-models-of-cognition.html#cb411-76" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb411-77"><a href="bayesian-models-of-cognition.html#cb411-77" tabindex="-1"></a>  </span>
<span id="cb411-78"><a href="bayesian-models-of-cognition.html#cb411-78" tabindex="-1"></a>  <span class="fu">return</span>(combined_plot)</span>
<span id="cb411-79"><a href="bayesian-models-of-cognition.html#cb411-79" tabindex="-1"></a>}</span>
<span id="cb411-80"><a href="bayesian-models-of-cognition.html#cb411-80" tabindex="-1"></a></span>
<span id="cb411-81"><a href="bayesian-models-of-cognition.html#cb411-81" tabindex="-1"></a><span class="co"># Generate and display the diagram</span></span>
<span id="cb411-82"><a href="bayesian-models-of-cognition.html#cb411-82" tabindex="-1"></a><span class="fu">create_bayesian_updating_diagram</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/09%20visualizing%20bayesian%20updating-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This diagram illustrates the key elements of Bayesian updating:</p>
<ul>
<li><p>Prior belief (blue dashed line): Our initial uncertainty about a phenomenon, before seeing evidence</p></li>
<li><p>Likelihood (red dotted line): The pattern of evidence we observe</p></li>
<li><p>Posterior belief (purple solid line): Our updated belief after combining prior and evidence</p></li>
</ul>
<p>Notice how the posterior distribution:</p>
<ul>
<li><p>Is narrower than either the prior or likelihood alone (indicating increased certainty)</p></li>
<li><p>Sits between the prior and likelihood, but closer to the likelihood (as the evidence was fairly strong)</p></li>
<li><p>Has its peak shifted from the prior toward the likelihood (reflecting belief updating)</p></li>
</ul>
<p>The bottom diagram shows the algebraic process: we multiply the prior by the likelihood, then normalize to get the posterior belief.</p>
</div>
<div id="bayesian-models-in-cognitive-science" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Bayesian Models in Cognitive Science<a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian cognitive models have been successfully applied to a wide range of phenomena:</p>
<ul>
<li><p>Perception: How we combine multiple sensory cues (visual, auditory, tactile) to form a unified percept</p></li>
<li><p>Learning: How we update our knowledge from observation and instruction</p></li>
<li><p>Decision-making: How we weigh different sources of evidence when making choices</p></li>
<li><p>Social cognition: How we integrate others’ opinions with our own knowledge</p></li>
<li><p>Language: How we disambiguate words and sentences based on context</p></li>
<li><p>Psychopathology: How crucial aspects of conditions like schizophrenia and autism can be understood in terms of atypical Bayesian inference (e.g. atypical weights given to different sources of information, or hyper-precise priors or hyper-precise likelihood).</p></li>
</ul>
</div>
<div id="example-social-influence-in-perceptual-decision-making" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Example: Social Influence in Perceptual Decision-Making<a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To ground our discussion in a cognitive science context, let’s consider a simplified version of a recent study examining how people with and without schizophrenia integrate information from different sources (Simonsen et al., 2021).</p>
<p>In this task, participants needed to guess the color of the next marble drawn from a jar. They received information from two sources:</p>
<ul>
<li><p>Direct evidence: A small sample of 8 marbles drawn from the jar (e.g., 6 blue and 2 red marbles)</p></li>
<li><p>Social evidence: The choices and confidence ratings of four other people who had seen their own independent samples from the jar</p></li>
</ul>
<p>This paradigm allows researchers to examine how individuals integrate their own direct perceptual evidence with socially transmitted information — a fundamental process in human cognition that may be altered in certain clinical conditions and be involved in generating some aspects of their psychopathology.</p>
<p>For simplicity, we’ll focus on a binary version where participants must guess whether the next marble will be blue or red, and we’ll examine how they integrate their direct sample with social information from just what one other person has chosen. Further, at every trial the participants are given a new jar with a potentially different proportion of blue and red marbles, so there is no learning involved.</p>
</div>
<div id="a-bayesian-integration-model-for-the-marble-task" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> A Bayesian Integration Model for the Marble Task<a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In a fully Bayesian approach, participants would:</p>
<ul>
<li><p>Use direct evidence to form a belief about the proportion of blue marbles in the jar</p></li>
<li><p>Use social evidence to form another belief about the same proportion</p></li>
<li><p>Combine these beliefs in a principled way to make their final judgment</p></li>
</ul>
<div id="intuitive-explanation-using-beta-distributions" class="section level3 hasAnchor" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> Intuitive Explanation Using Beta Distributions<a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The beta distribution provides an elegant way to represent beliefs about proportions (like the proportion of blue marbles in a jar):</p>
<ul>
<li><p>The beta distribution is defined by two parameters, traditionally called α (alpha) and β (beta).</p></li>
<li><p>These parameters have an intuitive interpretation: you can think of α as the number of “successes” you’ve observed (e.g., blue marbles) plus 1, and β as the number of “failures” (e.g., red marbles) plus 1.</p></li>
<li><p>So a Beta(1,1) distribution represents a uniform belief - no prior knowledge about the proportion.</p></li>
<li><p>After observing evidence, you simply add the counts to these parameters:</p>
<ul>
<li>If you see 6 blue and 2 red marbles, your updated belief is Beta(1+6, 1+2) = Beta(7, 3)</li>
<li>This distribution has its peak at 7/(7+3) = 0.7, reflecting your belief that the true proportion is around 70% blue</li>
</ul></li>
<li><p>To combine multiple sources of evidence, you simply add all the counts together:</p>
<ul>
<li>If direct evidence gives Beta(7, 3) and social evidence suggests Beta(2, 4)</li>
<li>Your combined belief is Beta(7+2, 3+4) = Beta(9, 7)</li>
<li>This has its peak at 9/(9+7) = 0.56, reflecting a compromise between the two sources</li>
</ul></li>
</ul>
<p>The beauty of this approach is that it automatically weights evidence by its strength (amount of data) and properly represents uncertainty through the width of the distribution.</p>
</div>
</div>
<div id="the-mathematical-model" class="section level2 hasAnchor" number="10.8">
<h2><span class="header-section-number">10.8</span> The Mathematical Model<a href="bayesian-models-of-cognition.html#the-mathematical-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For our marble task, the Bayesian inference process involves:</p>
<div id="evidence-representation" class="section level3 hasAnchor" number="10.8.1">
<h3><span class="header-section-number">10.8.1</span> Evidence Representation<a href="bayesian-models-of-cognition.html#evidence-representation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Direct evidence: Observing blue1 blue marbles and red1 red marbles out of total1 trials</p></li>
<li><p>Social evidence: Inferring blue2 blue marbles and red2 red marbles from social information. If we consider only their choice: red corresponds to the sampling of one red marble; blue corresponds to the sampling of one blue marble. If we consider their confidence, we might try to make this correspond to the marbles the sampled: “Clear blue” might imply 8 blue marbles; maybe blue might imply 6 blue and 2 red marbles; “maybe red” might imply 6 red and 2 blue marbles; “clear red” might imply 8 red marbles. Alternatively we can keep it more uncertain and reduce the assumed sample to 0 blue out of 3, 1 blue out of 3, 2 blue marbles out of 3, or 3 blue marbles out of 3. This intrinsically models the added uncertainty in observing the other’s choice and not their samples.</p></li>
</ul>
</div>
<div id="integration" class="section level3 hasAnchor" number="10.8.2">
<h3><span class="header-section-number">10.8.2</span> Integration<a href="bayesian-models-of-cognition.html#integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The integrated belief is represented by a posterior beta distribution:</p>
<p>Beta(α + blue1 + blue2, β + red1 + red2)</p>
<p>Where α and β are prior parameters (typically 1 each for a uniform prior)</p>
</div>
<div id="decision" class="section level3 hasAnchor" number="10.8.3">
<h3><span class="header-section-number">10.8.3</span> Decision<a href="bayesian-models-of-cognition.html#decision" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Final choice (blue or red) depends on whether the expected value of this distribution is above 0.5</p></li>
<li><p>Confidence depends on the concentration of the distribution</p></li>
</ul>
</div>
<div id="implementation-in-r" class="section level3 hasAnchor" number="10.8.4">
<h3><span class="header-section-number">10.8.4</span> Implementation in R<a href="bayesian-models-of-cognition.html#implementation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="bayesian-models-of-cognition.html#cb412-1" tabindex="-1"></a><span class="co"># Beta-binomial model for Bayesian integration in the marble task</span></span>
<span id="cb412-2"><a href="bayesian-models-of-cognition.html#cb412-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb412-3"><a href="bayesian-models-of-cognition.html#cb412-3" tabindex="-1"></a><span class="co"># This function implements a Bayesian integration model for combining direct and social evidence</span></span>
<span id="cb412-4"><a href="bayesian-models-of-cognition.html#cb412-4" tabindex="-1"></a><span class="co"># about the proportion of blue marbles in a jar. It uses the beta-binomial model, which is</span></span>
<span id="cb412-5"><a href="bayesian-models-of-cognition.html#cb412-5" tabindex="-1"></a><span class="co"># particularly suitable for reasoning about proportions.</span></span>
<span id="cb412-6"><a href="bayesian-models-of-cognition.html#cb412-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb412-7"><a href="bayesian-models-of-cognition.html#cb412-7" tabindex="-1"></a><span class="co"># Parameters:</span></span>
<span id="cb412-8"><a href="bayesian-models-of-cognition.html#cb412-8" tabindex="-1"></a><span class="co">#   alpha_prior: Prior alpha parameter (conceptually: prior blue marbles + 1)</span></span>
<span id="cb412-9"><a href="bayesian-models-of-cognition.html#cb412-9" tabindex="-1"></a><span class="co">#   beta_prior: Prior beta parameter (conceptually: prior red marbles + 1)</span></span>
<span id="cb412-10"><a href="bayesian-models-of-cognition.html#cb412-10" tabindex="-1"></a><span class="co">#   blue1: Number of blue marbles in direct evidence</span></span>
<span id="cb412-11"><a href="bayesian-models-of-cognition.html#cb412-11" tabindex="-1"></a><span class="co">#   total1: Total marbles in direct evidence</span></span>
<span id="cb412-12"><a href="bayesian-models-of-cognition.html#cb412-12" tabindex="-1"></a><span class="co">#   blue2: Effective blue marbles from social evidence</span></span>
<span id="cb412-13"><a href="bayesian-models-of-cognition.html#cb412-13" tabindex="-1"></a><span class="co">#   total2: Effective total marbles from social evidence</span></span>
<span id="cb412-14"><a href="bayesian-models-of-cognition.html#cb412-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb412-15"><a href="bayesian-models-of-cognition.html#cb412-15" tabindex="-1"></a><span class="co"># Returns:</span></span>
<span id="cb412-16"><a href="bayesian-models-of-cognition.html#cb412-16" tabindex="-1"></a><span class="co">#   List with posterior parameters and statistics for decision-making</span></span>
<span id="cb412-17"><a href="bayesian-models-of-cognition.html#cb412-17" tabindex="-1"></a>betaBinomialModel <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha_prior, beta_prior, blue1, total1, blue2, total2) {</span>
<span id="cb412-18"><a href="bayesian-models-of-cognition.html#cb412-18" tabindex="-1"></a>  <span class="co"># Calculate red marbles for each source</span></span>
<span id="cb412-19"><a href="bayesian-models-of-cognition.html#cb412-19" tabindex="-1"></a>  red1 <span class="ot">&lt;-</span> total1 <span class="sc">-</span> blue1  <span class="co"># Number of red marbles in direct evidence</span></span>
<span id="cb412-20"><a href="bayesian-models-of-cognition.html#cb412-20" tabindex="-1"></a>  red2 <span class="ot">&lt;-</span> total2 <span class="sc">-</span> blue2  <span class="co"># Inferred number of red marbles from social evidence</span></span>
<span id="cb412-21"><a href="bayesian-models-of-cognition.html#cb412-21" tabindex="-1"></a>  </span>
<span id="cb412-22"><a href="bayesian-models-of-cognition.html#cb412-22" tabindex="-1"></a>  <span class="co"># The key insight of Bayesian integration: simply add up all evidence counts</span></span>
<span id="cb412-23"><a href="bayesian-models-of-cognition.html#cb412-23" tabindex="-1"></a>  <span class="co"># This automatically gives more weight to sources with more data</span></span>
<span id="cb412-24"><a href="bayesian-models-of-cognition.html#cb412-24" tabindex="-1"></a>  alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue1 <span class="sc">+</span> blue2  <span class="co"># Posterior alpha (total blues + prior)</span></span>
<span id="cb412-25"><a href="bayesian-models-of-cognition.html#cb412-25" tabindex="-1"></a>  beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red1 <span class="sc">+</span> red2      <span class="co"># Posterior beta (total reds + prior)</span></span>
<span id="cb412-26"><a href="bayesian-models-of-cognition.html#cb412-26" tabindex="-1"></a>  </span>
<span id="cb412-27"><a href="bayesian-models-of-cognition.html#cb412-27" tabindex="-1"></a>  <span class="co"># Calculate posterior statistics</span></span>
<span id="cb412-28"><a href="bayesian-models-of-cognition.html#cb412-28" tabindex="-1"></a>  expected_rate <span class="ot">&lt;-</span> alpha_post <span class="sc">/</span> (alpha_post <span class="sc">+</span> beta_post)  <span class="co"># Mean of beta distribution</span></span>
<span id="cb412-29"><a href="bayesian-models-of-cognition.html#cb412-29" tabindex="-1"></a>  </span>
<span id="cb412-30"><a href="bayesian-models-of-cognition.html#cb412-30" tabindex="-1"></a>  <span class="co"># Variance has a simple formula for beta distributions</span></span>
<span id="cb412-31"><a href="bayesian-models-of-cognition.html#cb412-31" tabindex="-1"></a>  <span class="co"># Lower variance = higher confidence in our estimate</span></span>
<span id="cb412-32"><a href="bayesian-models-of-cognition.html#cb412-32" tabindex="-1"></a>  variance <span class="ot">&lt;-</span> (alpha_post <span class="sc">*</span> beta_post) <span class="sc">/</span> </span>
<span id="cb412-33"><a href="bayesian-models-of-cognition.html#cb412-33" tabindex="-1"></a>             ((alpha_post <span class="sc">+</span> beta_post)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (alpha_post <span class="sc">+</span> beta_post <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb412-34"><a href="bayesian-models-of-cognition.html#cb412-34" tabindex="-1"></a>  </span>
<span id="cb412-35"><a href="bayesian-models-of-cognition.html#cb412-35" tabindex="-1"></a>  <span class="co"># Calculate 95% credible interval using beta quantile functions</span></span>
<span id="cb412-36"><a href="bayesian-models-of-cognition.html#cb412-36" tabindex="-1"></a>  <span class="co"># This gives us bounds within which we believe the true proportion lies</span></span>
<span id="cb412-37"><a href="bayesian-models-of-cognition.html#cb412-37" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.025</span>, alpha_post, beta_post)</span>
<span id="cb412-38"><a href="bayesian-models-of-cognition.html#cb412-38" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.975</span>, alpha_post, beta_post)</span>
<span id="cb412-39"><a href="bayesian-models-of-cognition.html#cb412-39" tabindex="-1"></a>  </span>
<span id="cb412-40"><a href="bayesian-models-of-cognition.html#cb412-40" tabindex="-1"></a>  <span class="co"># Calculate confidence based on variance</span></span>
<span id="cb412-41"><a href="bayesian-models-of-cognition.html#cb412-41" tabindex="-1"></a>  <span class="co"># Higher variance = lower confidence; transform to 0-1 scale</span></span>
<span id="cb412-42"><a href="bayesian-models-of-cognition.html#cb412-42" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(variance))</span>
<span id="cb412-43"><a href="bayesian-models-of-cognition.html#cb412-43" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, <span class="fu">min</span>(<span class="dv">1</span>, confidence))  <span class="co"># Bound between 0 and 1</span></span>
<span id="cb412-44"><a href="bayesian-models-of-cognition.html#cb412-44" tabindex="-1"></a>  </span>
<span id="cb412-45"><a href="bayesian-models-of-cognition.html#cb412-45" tabindex="-1"></a>  <span class="co"># Make decision based on whether expected rate exceeds 0.5</span></span>
<span id="cb412-46"><a href="bayesian-models-of-cognition.html#cb412-46" tabindex="-1"></a>  <span class="co"># If P(blue) &gt; 0.5, choose blue; otherwise choose red</span></span>
<span id="cb412-47"><a href="bayesian-models-of-cognition.html#cb412-47" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(expected_rate <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">&quot;Blue&quot;</span>, <span class="st">&quot;Red&quot;</span>)</span>
<span id="cb412-48"><a href="bayesian-models-of-cognition.html#cb412-48" tabindex="-1"></a>  </span>
<span id="cb412-49"><a href="bayesian-models-of-cognition.html#cb412-49" tabindex="-1"></a>  <span class="co"># Return all calculated parameters in a structured list</span></span>
<span id="cb412-50"><a href="bayesian-models-of-cognition.html#cb412-50" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb412-51"><a href="bayesian-models-of-cognition.html#cb412-51" tabindex="-1"></a>    <span class="at">alpha_post =</span> alpha_post,</span>
<span id="cb412-52"><a href="bayesian-models-of-cognition.html#cb412-52" tabindex="-1"></a>    <span class="at">beta_post =</span> beta_post,</span>
<span id="cb412-53"><a href="bayesian-models-of-cognition.html#cb412-53" tabindex="-1"></a>    <span class="at">expected_rate =</span> expected_rate,</span>
<span id="cb412-54"><a href="bayesian-models-of-cognition.html#cb412-54" tabindex="-1"></a>    <span class="at">variance =</span> variance,</span>
<span id="cb412-55"><a href="bayesian-models-of-cognition.html#cb412-55" tabindex="-1"></a>    <span class="at">ci_lower =</span> ci_lower,</span>
<span id="cb412-56"><a href="bayesian-models-of-cognition.html#cb412-56" tabindex="-1"></a>    <span class="at">ci_upper =</span> ci_upper,</span>
<span id="cb412-57"><a href="bayesian-models-of-cognition.html#cb412-57" tabindex="-1"></a>    <span class="at">confidence =</span> confidence,</span>
<span id="cb412-58"><a href="bayesian-models-of-cognition.html#cb412-58" tabindex="-1"></a>    <span class="at">choice =</span> choice</span>
<span id="cb412-59"><a href="bayesian-models-of-cognition.html#cb412-59" tabindex="-1"></a>  ))</span>
<span id="cb412-60"><a href="bayesian-models-of-cognition.html#cb412-60" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="simulating-experimental-scenarios" class="section level3 hasAnchor" number="10.8.5">
<h3><span class="header-section-number">10.8.5</span> Simulating Experimental Scenarios<a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll create a comprehensive set of scenarios by varying both direct evidence (number of blue marbles observed directly) and social evidence (number of blue marbles inferred from social information).</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="bayesian-models-of-cognition.html#cb413-1" tabindex="-1"></a><span class="co"># Set total counts for direct and social evidence</span></span>
<span id="cb413-2"><a href="bayesian-models-of-cognition.html#cb413-2" tabindex="-1"></a>total1 <span class="ot">&lt;-</span> <span class="dv">8</span>  <span class="co"># Total marbles in direct evidence</span></span>
<span id="cb413-3"><a href="bayesian-models-of-cognition.html#cb413-3" tabindex="-1"></a>total2 <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Total evidence units in social evidence</span></span>
<span id="cb413-4"><a href="bayesian-models-of-cognition.html#cb413-4" tabindex="-1"></a></span>
<span id="cb413-5"><a href="bayesian-models-of-cognition.html#cb413-5" tabindex="-1"></a><span class="co"># Create all possible combinations of direct and social evidence</span></span>
<span id="cb413-6"><a href="bayesian-models-of-cognition.html#cb413-6" tabindex="-1"></a>scenarios <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb413-7"><a href="bayesian-models-of-cognition.html#cb413-7" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>),  <span class="co"># Direct evidence: 0 to 8 blue marbles</span></span>
<span id="cb413-8"><a href="bayesian-models-of-cognition.html#cb413-8" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>)   <span class="co"># Social evidence: 0 to 3 blue marbles (confidence levels)</span></span>
<span id="cb413-9"><a href="bayesian-models-of-cognition.html#cb413-9" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb413-10"><a href="bayesian-models-of-cognition.html#cb413-10" tabindex="-1"></a>  <span class="at">red1 =</span> total1 <span class="sc">-</span> blue1,  <span class="co"># Calculate red marbles for direct evidence</span></span>
<span id="cb413-11"><a href="bayesian-models-of-cognition.html#cb413-11" tabindex="-1"></a>  <span class="at">red2 =</span> total2 <span class="sc">-</span> blue2   <span class="co"># Calculate implied red marbles for social evidence</span></span>
<span id="cb413-12"><a href="bayesian-models-of-cognition.html#cb413-12" tabindex="-1"></a>)</span>
<span id="cb413-13"><a href="bayesian-models-of-cognition.html#cb413-13" tabindex="-1"></a></span>
<span id="cb413-14"><a href="bayesian-models-of-cognition.html#cb413-14" tabindex="-1"></a><span class="co"># Process all scenarios to generate summary statistics</span></span>
<span id="cb413-15"><a href="bayesian-models-of-cognition.html#cb413-15" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(scenarios), <span class="cf">function</span>(i) {</span>
<span id="cb413-16"><a href="bayesian-models-of-cognition.html#cb413-16" tabindex="-1"></a>  <span class="co"># Extract scenario parameters</span></span>
<span id="cb413-17"><a href="bayesian-models-of-cognition.html#cb413-17" tabindex="-1"></a>  blue1 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>blue1[i]</span>
<span id="cb413-18"><a href="bayesian-models-of-cognition.html#cb413-18" tabindex="-1"></a>  red1 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>red1[i]</span>
<span id="cb413-19"><a href="bayesian-models-of-cognition.html#cb413-19" tabindex="-1"></a>  blue2 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>blue2[i]</span>
<span id="cb413-20"><a href="bayesian-models-of-cognition.html#cb413-20" tabindex="-1"></a>  red2 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>red2[i]</span>
<span id="cb413-21"><a href="bayesian-models-of-cognition.html#cb413-21" tabindex="-1"></a>  </span>
<span id="cb413-22"><a href="bayesian-models-of-cognition.html#cb413-22" tabindex="-1"></a>  <span class="co"># Calculate Bayesian integration using our model</span></span>
<span id="cb413-23"><a href="bayesian-models-of-cognition.html#cb413-23" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">betaBinomialModel</span>(<span class="dv">1</span>, <span class="dv">1</span>, blue1, total1, blue2, total2)</span>
<span id="cb413-24"><a href="bayesian-models-of-cognition.html#cb413-24" tabindex="-1"></a>  </span>
<span id="cb413-25"><a href="bayesian-models-of-cognition.html#cb413-25" tabindex="-1"></a>  <span class="co"># Return summary data for this scenario</span></span>
<span id="cb413-26"><a href="bayesian-models-of-cognition.html#cb413-26" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb413-27"><a href="bayesian-models-of-cognition.html#cb413-27" tabindex="-1"></a>    <span class="at">blue1 =</span> blue1,</span>
<span id="cb413-28"><a href="bayesian-models-of-cognition.html#cb413-28" tabindex="-1"></a>    <span class="at">red1 =</span> red1,</span>
<span id="cb413-29"><a href="bayesian-models-of-cognition.html#cb413-29" tabindex="-1"></a>    <span class="at">blue2 =</span> blue2,</span>
<span id="cb413-30"><a href="bayesian-models-of-cognition.html#cb413-30" tabindex="-1"></a>    <span class="at">red2 =</span> red2,</span>
<span id="cb413-31"><a href="bayesian-models-of-cognition.html#cb413-31" tabindex="-1"></a>    <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,</span>
<span id="cb413-32"><a href="bayesian-models-of-cognition.html#cb413-32" tabindex="-1"></a>    <span class="at">variance =</span> result<span class="sc">$</span>variance,</span>
<span id="cb413-33"><a href="bayesian-models-of-cognition.html#cb413-33" tabindex="-1"></a>    <span class="at">ci_lower =</span> result<span class="sc">$</span>ci_lower,</span>
<span id="cb413-34"><a href="bayesian-models-of-cognition.html#cb413-34" tabindex="-1"></a>    <span class="at">ci_upper =</span> result<span class="sc">$</span>ci_upper,</span>
<span id="cb413-35"><a href="bayesian-models-of-cognition.html#cb413-35" tabindex="-1"></a>    <span class="at">choice =</span> result<span class="sc">$</span>choice,</span>
<span id="cb413-36"><a href="bayesian-models-of-cognition.html#cb413-36" tabindex="-1"></a>    <span class="at">confidence =</span> result<span class="sc">$</span>confidence</span>
<span id="cb413-37"><a href="bayesian-models-of-cognition.html#cb413-37" tabindex="-1"></a>  )</span>
<span id="cb413-38"><a href="bayesian-models-of-cognition.html#cb413-38" tabindex="-1"></a>})</span>
<span id="cb413-39"><a href="bayesian-models-of-cognition.html#cb413-39" tabindex="-1"></a></span>
<span id="cb413-40"><a href="bayesian-models-of-cognition.html#cb413-40" tabindex="-1"></a><span class="co"># Convert social evidence to meaningful labels for better visualization</span></span>
<span id="cb413-41"><a href="bayesian-models-of-cognition.html#cb413-41" tabindex="-1"></a>sim_data<span class="sc">$</span>social_evidence <span class="ot">&lt;-</span> <span class="fu">factor</span>(sim_data<span class="sc">$</span>blue2,</span>
<span id="cb413-42"><a href="bayesian-models-of-cognition.html#cb413-42" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb413-43"><a href="bayesian-models-of-cognition.html#cb413-43" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Maybe Red&quot;</span>, <span class="st">&quot;Maybe Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>))</span></code></pre></div>
</div>
<div id="visualizing-bayesian-integration" class="section level3 hasAnchor" number="10.8.6">
<h3><span class="header-section-number">10.8.6</span> Visualizing Bayesian Integration<a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine how expected proportion and uncertainty vary across different evidence combinations:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="bayesian-models-of-cognition.html#cb414-1" tabindex="-1"></a><span class="co"># Create two plot panels to visualize model behavior across all evidence combinations</span></span>
<span id="cb414-2"><a href="bayesian-models-of-cognition.html#cb414-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sim_data, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> expected_rate, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb414-3"><a href="bayesian-models-of-cognition.html#cb414-3" tabindex="-1"></a>  <span class="co"># Add credible intervals to show uncertainty</span></span>
<span id="cb414-4"><a href="bayesian-models-of-cognition.html#cb414-4" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper, <span class="at">fill =</span> social_evidence), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb414-5"><a href="bayesian-models-of-cognition.html#cb414-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb414-6"><a href="bayesian-models-of-cognition.html#cb414-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb414-7"><a href="bayesian-models-of-cognition.html#cb414-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-8"><a href="bayesian-models-of-cognition.html#cb414-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb414-9"><a href="bayesian-models-of-cognition.html#cb414-9" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-10"><a href="bayesian-models-of-cognition.html#cb414-10" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-11"><a href="bayesian-models-of-cognition.html#cb414-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bayesian Integration of Direct and Social Evidence&quot;</span>,</span>
<span id="cb414-12"><a href="bayesian-models-of-cognition.html#cb414-12" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Expected proportion with 95% credible intervals&quot;</span>,</span>
<span id="cb414-13"><a href="bayesian-models-of-cognition.html#cb414-13" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Sample (out of 8)&quot;</span>,</span>
<span id="cb414-14"><a href="bayesian-models-of-cognition.html#cb414-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Expected Proportion of Blue Marbles&quot;</span>,</span>
<span id="cb414-15"><a href="bayesian-models-of-cognition.html#cb414-15" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span>,</span>
<span id="cb414-16"><a href="bayesian-models-of-cognition.html#cb414-16" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Social Evidence&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-17"><a href="bayesian-models-of-cognition.html#cb414-17" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb414-18"><a href="bayesian-models-of-cognition.html#cb414-18" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb414-19"><a href="bayesian-models-of-cognition.html#cb414-19" tabindex="-1"></a></span>
<span id="cb414-20"><a href="bayesian-models-of-cognition.html#cb414-20" tabindex="-1"></a><span class="co"># Display plot</span></span>
<span id="cb414-21"><a href="bayesian-models-of-cognition.html#cb414-21" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/09%20visualizing%20bayesian%20integration-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>A few notes about the plot:</p>
<ul>
<li><p>Evidence integration: The expected proportion of blue marbles (top plot) varies with both direct and social evidence. I would normally expect a non-linear interaction: when direct evidence is ambiguous (e.g., 4 blue out of 8), social evidence should have a stronger effect on the final belief. However, the effect is subtle if any.</p></li>
<li><p>Evidence Interaction: It may be hard to see, but the influence of social evidence is strongest when direct evidence is ambiguous (around 4 blue marbles) and weakest at the extremes (0 or 8 blue marbles). This reflects the Bayesian property that stronger evidence dominates weaker evidence.</p></li>
<li><p>Credible intervals: The 95% credible intervals (shaded regions) show our uncertainty about the true proportion. These intervals narrow with more evidence, indicating increased confidence in our estimates. This is better seen in the lower plot than in the upper one. Notice how the variance is highest when direct evidence is ambiguous (around 4 blue marbles) and lowest at the extremes (as they combine congruent evidence from both sources).</p></li>
</ul>
</div>
</div>
<div id="examining-belief-distributions-for-selected-scenarios" class="section level2 hasAnchor" number="10.9">
<h2><span class="header-section-number">10.9</span> Examining Belief Distributions for Selected Scenarios<a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While the summary statistics give us a high-level view, examining the full posterior distributions provides deeper insight into how evidence is combined. Let’s visualize the complete probability distributions for a selected subset of scenarios:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="bayesian-models-of-cognition.html#cb415-1" tabindex="-1"></a><span class="co"># Function to generate Beta distributions for all components of a Bayesian model</span></span>
<span id="cb415-2"><a href="bayesian-models-of-cognition.html#cb415-2" tabindex="-1"></a><span class="co"># This function returns the prior, likelihood, and posterior distributions</span></span>
<span id="cb415-3"><a href="bayesian-models-of-cognition.html#cb415-3" tabindex="-1"></a><span class="co"># for a given scenario of blue and red marbles</span></span>
<span id="cb415-4"><a href="bayesian-models-of-cognition.html#cb415-4" tabindex="-1"></a>simpleBayesianModel_f <span class="ot">&lt;-</span> <span class="cf">function</span>(blue1, red1, blue2, red2) {</span>
<span id="cb415-5"><a href="bayesian-models-of-cognition.html#cb415-5" tabindex="-1"></a>  <span class="co"># Prior parameters (uniform prior)</span></span>
<span id="cb415-6"><a href="bayesian-models-of-cognition.html#cb415-6" tabindex="-1"></a>  alpha_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb415-7"><a href="bayesian-models-of-cognition.html#cb415-7" tabindex="-1"></a>  beta_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb415-8"><a href="bayesian-models-of-cognition.html#cb415-8" tabindex="-1"></a>  </span>
<span id="cb415-9"><a href="bayesian-models-of-cognition.html#cb415-9" tabindex="-1"></a>  <span class="co"># Calculate parameters for each distribution</span></span>
<span id="cb415-10"><a href="bayesian-models-of-cognition.html#cb415-10" tabindex="-1"></a>  <span class="co"># Direct evidence distribution</span></span>
<span id="cb415-11"><a href="bayesian-models-of-cognition.html#cb415-11" tabindex="-1"></a>  alpha_direct <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue1</span>
<span id="cb415-12"><a href="bayesian-models-of-cognition.html#cb415-12" tabindex="-1"></a>  beta_direct <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red1</span>
<span id="cb415-13"><a href="bayesian-models-of-cognition.html#cb415-13" tabindex="-1"></a>  </span>
<span id="cb415-14"><a href="bayesian-models-of-cognition.html#cb415-14" tabindex="-1"></a>  <span class="co"># Social evidence distribution</span></span>
<span id="cb415-15"><a href="bayesian-models-of-cognition.html#cb415-15" tabindex="-1"></a>  alpha_social <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue2</span>
<span id="cb415-16"><a href="bayesian-models-of-cognition.html#cb415-16" tabindex="-1"></a>  beta_social <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red2</span>
<span id="cb415-17"><a href="bayesian-models-of-cognition.html#cb415-17" tabindex="-1"></a>  </span>
<span id="cb415-18"><a href="bayesian-models-of-cognition.html#cb415-18" tabindex="-1"></a>  <span class="co"># Posterior distribution (combined evidence)</span></span>
<span id="cb415-19"><a href="bayesian-models-of-cognition.html#cb415-19" tabindex="-1"></a>  alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue1 <span class="sc">+</span> blue2</span>
<span id="cb415-20"><a href="bayesian-models-of-cognition.html#cb415-20" tabindex="-1"></a>  beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red1 <span class="sc">+</span> red2</span>
<span id="cb415-21"><a href="bayesian-models-of-cognition.html#cb415-21" tabindex="-1"></a>  </span>
<span id="cb415-22"><a href="bayesian-models-of-cognition.html#cb415-22" tabindex="-1"></a>  <span class="co"># Create a grid of theta values (possible proportions of blue marbles)</span></span>
<span id="cb415-23"><a href="bayesian-models-of-cognition.html#cb415-23" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.999</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb415-24"><a href="bayesian-models-of-cognition.html#cb415-24" tabindex="-1"></a>  </span>
<span id="cb415-25"><a href="bayesian-models-of-cognition.html#cb415-25" tabindex="-1"></a>  <span class="co"># Calculate densities for each distribution</span></span>
<span id="cb415-26"><a href="bayesian-models-of-cognition.html#cb415-26" tabindex="-1"></a>  prior_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_prior, beta_prior)</span>
<span id="cb415-27"><a href="bayesian-models-of-cognition.html#cb415-27" tabindex="-1"></a>  direct_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_direct, beta_direct)</span>
<span id="cb415-28"><a href="bayesian-models-of-cognition.html#cb415-28" tabindex="-1"></a>  social_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_social, beta_social)</span>
<span id="cb415-29"><a href="bayesian-models-of-cognition.html#cb415-29" tabindex="-1"></a>  posterior_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_post, beta_post)</span>
<span id="cb415-30"><a href="bayesian-models-of-cognition.html#cb415-30" tabindex="-1"></a>  </span>
<span id="cb415-31"><a href="bayesian-models-of-cognition.html#cb415-31" tabindex="-1"></a>  <span class="co"># Return dataframe with all distributions</span></span>
<span id="cb415-32"><a href="bayesian-models-of-cognition.html#cb415-32" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb415-33"><a href="bayesian-models-of-cognition.html#cb415-33" tabindex="-1"></a>    <span class="at">theta =</span> theta,</span>
<span id="cb415-34"><a href="bayesian-models-of-cognition.html#cb415-34" tabindex="-1"></a>    <span class="at">prior =</span> prior_density,</span>
<span id="cb415-35"><a href="bayesian-models-of-cognition.html#cb415-35" tabindex="-1"></a>    <span class="at">direct =</span> direct_density,</span>
<span id="cb415-36"><a href="bayesian-models-of-cognition.html#cb415-36" tabindex="-1"></a>    <span class="at">social =</span> social_density,</span>
<span id="cb415-37"><a href="bayesian-models-of-cognition.html#cb415-37" tabindex="-1"></a>    <span class="at">posterior =</span> posterior_density</span>
<span id="cb415-38"><a href="bayesian-models-of-cognition.html#cb415-38" tabindex="-1"></a>  ))</span>
<span id="cb415-39"><a href="bayesian-models-of-cognition.html#cb415-39" tabindex="-1"></a>}</span>
<span id="cb415-40"><a href="bayesian-models-of-cognition.html#cb415-40" tabindex="-1"></a></span>
<span id="cb415-41"><a href="bayesian-models-of-cognition.html#cb415-41" tabindex="-1"></a><span class="co"># Select a few representative scenarios</span></span>
<span id="cb415-42"><a href="bayesian-models-of-cognition.html#cb415-42" tabindex="-1"></a>selected_scenarios <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb415-43"><a href="bayesian-models-of-cognition.html#cb415-43" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>),     <span class="co"># Different levels of direct evidence</span></span>
<span id="cb415-44"><a href="bayesian-models-of-cognition.html#cb415-44" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)   <span class="co"># Different levels of social evidence</span></span>
<span id="cb415-45"><a href="bayesian-models-of-cognition.html#cb415-45" tabindex="-1"></a>)</span>
<span id="cb415-46"><a href="bayesian-models-of-cognition.html#cb415-46" tabindex="-1"></a></span>
<span id="cb415-47"><a href="bayesian-models-of-cognition.html#cb415-47" tabindex="-1"></a><span class="co"># Generate distributions for each scenario</span></span>
<span id="cb415-48"><a href="bayesian-models-of-cognition.html#cb415-48" tabindex="-1"></a>distribution_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(selected_scenarios), <span class="cf">function</span>(i) {</span>
<span id="cb415-49"><a href="bayesian-models-of-cognition.html#cb415-49" tabindex="-1"></a>  blue1 <span class="ot">&lt;-</span> selected_scenarios<span class="sc">$</span>blue1[i]</span>
<span id="cb415-50"><a href="bayesian-models-of-cognition.html#cb415-50" tabindex="-1"></a>  blue2 <span class="ot">&lt;-</span> selected_scenarios<span class="sc">$</span>blue2[i]</span>
<span id="cb415-51"><a href="bayesian-models-of-cognition.html#cb415-51" tabindex="-1"></a>  </span>
<span id="cb415-52"><a href="bayesian-models-of-cognition.html#cb415-52" tabindex="-1"></a>  <span class="co"># Generate distributions</span></span>
<span id="cb415-53"><a href="bayesian-models-of-cognition.html#cb415-53" tabindex="-1"></a>  dist_df <span class="ot">&lt;-</span> <span class="fu">simpleBayesianModel_f</span>(blue1, total1 <span class="sc">-</span> blue1, blue2, total2 <span class="sc">-</span> blue2)</span>
<span id="cb415-54"><a href="bayesian-models-of-cognition.html#cb415-54" tabindex="-1"></a>  </span>
<span id="cb415-55"><a href="bayesian-models-of-cognition.html#cb415-55" tabindex="-1"></a>  <span class="co"># Add scenario information</span></span>
<span id="cb415-56"><a href="bayesian-models-of-cognition.html#cb415-56" tabindex="-1"></a>  dist_df<span class="sc">$</span>blue1 <span class="ot">&lt;-</span> blue1</span>
<span id="cb415-57"><a href="bayesian-models-of-cognition.html#cb415-57" tabindex="-1"></a>  dist_df<span class="sc">$</span>blue2 <span class="ot">&lt;-</span> blue2</span>
<span id="cb415-58"><a href="bayesian-models-of-cognition.html#cb415-58" tabindex="-1"></a>  dist_df<span class="sc">$</span>social_evidence <span class="ot">&lt;-</span> <span class="fu">factor</span>(blue2,</span>
<span id="cb415-59"><a href="bayesian-models-of-cognition.html#cb415-59" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb415-60"><a href="bayesian-models-of-cognition.html#cb415-60" tabindex="-1"></a>                                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Maybe Red&quot;</span>, <span class="st">&quot;Maybe Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>))</span>
<span id="cb415-61"><a href="bayesian-models-of-cognition.html#cb415-61" tabindex="-1"></a>  <span class="fu">return</span>(dist_df)</span>
<span id="cb415-62"><a href="bayesian-models-of-cognition.html#cb415-62" tabindex="-1"></a>}))</span>
<span id="cb415-63"><a href="bayesian-models-of-cognition.html#cb415-63" tabindex="-1"></a></span>
<span id="cb415-64"><a href="bayesian-models-of-cognition.html#cb415-64" tabindex="-1"></a><span class="co"># Modify the plotting function</span></span>
<span id="cb415-65"><a href="bayesian-models-of-cognition.html#cb415-65" tabindex="-1"></a>p_evidence_combination <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(distribution_data) <span class="sc">+</span></span>
<span id="cb415-66"><a href="bayesian-models-of-cognition.html#cb415-66" tabindex="-1"></a>  <span class="co"># Prior distribution with clear emphasis</span></span>
<span id="cb415-67"><a href="bayesian-models-of-cognition.html#cb415-67" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> prior), <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb415-68"><a href="bayesian-models-of-cognition.html#cb415-68" tabindex="-1"></a>  </span>
<span id="cb415-69"><a href="bayesian-models-of-cognition.html#cb415-69" tabindex="-1"></a>  <span class="co"># Posterior distribution with consistent coloring</span></span>
<span id="cb415-70"><a href="bayesian-models-of-cognition.html#cb415-70" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> posterior), </span>
<span id="cb415-71"><a href="bayesian-models-of-cognition.html#cb415-71" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>, </span>
<span id="cb415-72"><a href="bayesian-models-of-cognition.html#cb415-72" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb415-73"><a href="bayesian-models-of-cognition.html#cb415-73" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> posterior), </span>
<span id="cb415-74"><a href="bayesian-models-of-cognition.html#cb415-74" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, </span>
<span id="cb415-75"><a href="bayesian-models-of-cognition.html#cb415-75" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb415-76"><a href="bayesian-models-of-cognition.html#cb415-76" tabindex="-1"></a>  </span>
<span id="cb415-77"><a href="bayesian-models-of-cognition.html#cb415-77" tabindex="-1"></a>  <span class="co"># Direct and social evidence distributions</span></span>
<span id="cb415-78"><a href="bayesian-models-of-cognition.html#cb415-78" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> direct, <span class="at">color =</span> <span class="st">&quot;Direct Evidence&quot;</span>), </span>
<span id="cb415-79"><a href="bayesian-models-of-cognition.html#cb415-79" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb415-80"><a href="bayesian-models-of-cognition.html#cb415-80" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb415-81"><a href="bayesian-models-of-cognition.html#cb415-81" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb415-82"><a href="bayesian-models-of-cognition.html#cb415-82" tabindex="-1"></a>  </span>
<span id="cb415-83"><a href="bayesian-models-of-cognition.html#cb415-83" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> social, <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span>), </span>
<span id="cb415-84"><a href="bayesian-models-of-cognition.html#cb415-84" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb415-85"><a href="bayesian-models-of-cognition.html#cb415-85" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb415-86"><a href="bayesian-models-of-cognition.html#cb415-86" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb415-87"><a href="bayesian-models-of-cognition.html#cb415-87" tabindex="-1"></a>  </span>
<span id="cb415-88"><a href="bayesian-models-of-cognition.html#cb415-88" tabindex="-1"></a>  <span class="co"># Facet by direct and social evidence levels</span></span>
<span id="cb415-89"><a href="bayesian-models-of-cognition.html#cb415-89" tabindex="-1"></a>  <span class="fu">facet_grid</span>(blue2 <span class="sc">~</span> blue1, </span>
<span id="cb415-90"><a href="bayesian-models-of-cognition.html#cb415-90" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb415-91"><a href="bayesian-models-of-cognition.html#cb415-91" tabindex="-1"></a>               <span class="at">blue1 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Direct: &quot;</span>, x, <span class="st">&quot; Blue&quot;</span>),</span>
<span id="cb415-92"><a href="bayesian-models-of-cognition.html#cb415-92" tabindex="-1"></a>               <span class="at">blue2 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Social: &quot;</span>, x, <span class="st">&quot; Blue&quot;</span>)</span>
<span id="cb415-93"><a href="bayesian-models-of-cognition.html#cb415-93" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb415-94"><a href="bayesian-models-of-cognition.html#cb415-94" tabindex="-1"></a>  </span>
<span id="cb415-95"><a href="bayesian-models-of-cognition.html#cb415-95" tabindex="-1"></a>  <span class="co"># Aesthetics</span></span>
<span id="cb415-96"><a href="bayesian-models-of-cognition.html#cb415-96" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb415-97"><a href="bayesian-models-of-cognition.html#cb415-97" tabindex="-1"></a>    <span class="st">&quot;Direct Evidence&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb415-98"><a href="bayesian-models-of-cognition.html#cb415-98" tabindex="-1"></a>    <span class="st">&quot;Social Evidence&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb415-99"><a href="bayesian-models-of-cognition.html#cb415-99" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb415-100"><a href="bayesian-models-of-cognition.html#cb415-100" tabindex="-1"></a>  </span>
<span id="cb415-101"><a href="bayesian-models-of-cognition.html#cb415-101" tabindex="-1"></a>  <span class="co"># Labels and theme</span></span>
<span id="cb415-102"><a href="bayesian-models-of-cognition.html#cb415-102" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb415-103"><a href="bayesian-models-of-cognition.html#cb415-103" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Bayesian Evidence Integration: Distribution Combination&quot;</span>,</span>
<span id="cb415-104"><a href="bayesian-models-of-cognition.html#cb415-104" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Merging direct and social evidence into a posterior belief&quot;</span>,</span>
<span id="cb415-105"><a href="bayesian-models-of-cognition.html#cb415-105" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Proportion of Blue Marbles&quot;</span>,</span>
<span id="cb415-106"><a href="bayesian-models-of-cognition.html#cb415-106" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Probability Density&quot;</span>,</span>
<span id="cb415-107"><a href="bayesian-models-of-cognition.html#cb415-107" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Evidence Type&quot;</span></span>
<span id="cb415-108"><a href="bayesian-models-of-cognition.html#cb415-108" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb415-109"><a href="bayesian-models-of-cognition.html#cb415-109" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb415-110"><a href="bayesian-models-of-cognition.html#cb415-110" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb415-111"><a href="bayesian-models-of-cognition.html#cb415-111" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb415-112"><a href="bayesian-models-of-cognition.html#cb415-112" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb415-113"><a href="bayesian-models-of-cognition.html#cb415-113" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb415-114"><a href="bayesian-models-of-cognition.html#cb415-114" tabindex="-1"></a>  )</span>
<span id="cb415-115"><a href="bayesian-models-of-cognition.html#cb415-115" tabindex="-1"></a></span>
<span id="cb415-116"><a href="bayesian-models-of-cognition.html#cb415-116" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb415-117"><a href="bayesian-models-of-cognition.html#cb415-117" tabindex="-1"></a><span class="fu">print</span>(p_evidence_combination)</span></code></pre></div>
<p><img src="series_files/figure-html/09%20zoom%20in%20specific%20scenarios-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This comprehensive visualization shows how the different probability distributions interact:</p>
<ul>
<li><p>Prior distribution (gray line): Our initial uniform belief about the proportion of blue marbles.</p></li>
<li><p>Direct evidence distribution (blue dashed line): Belief based solely on our direct observation of marbles. Notice how it becomes more concentrated with more extreme evidence (e.g., 1 or 7 blue marbles).</p></li>
<li><p>Social evidence distribution (red dashed line): Belief based solely on social information. This is generally less concentrated than the direct evidence distribution since it’s based on lower evidence (0-3 vs. 0-8).</p></li>
<li><p>Posterior distribution (purple area): The final belief that results from combining all information sources. Notice how it tends to lie between the direct and social evidence distributions, but is typically narrower than either, reflecting increased certainty from combining information, unless the evidence is in conflict.</p></li>
</ul>
</div>
<div id="weighted-bayesian-integration" class="section level2 hasAnchor" number="10.10">
<h2><span class="header-section-number">10.10</span> Weighted Bayesian Integration<a href="bayesian-models-of-cognition.html#weighted-bayesian-integration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In real cognitive systems, people often weight information sources differently based on their reliability or relevance. Let’s implement a weighted Bayesian model that allows for differential weighting of evidence sources.</p>
<div id="the-mathematical-model-1" class="section level3 hasAnchor" number="10.10.1">
<h3><span class="header-section-number">10.10.1</span> The Mathematical Model<a href="bayesian-models-of-cognition.html#the-mathematical-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our weighted Bayesian integration model extends the simple model by introducing weight parameters for each information source:</p>
<ul>
<li><p>Start with prior: Beta(α₀, β₀)</p></li>
<li><p>Observe direct evidence: k₁ blue marbles out of n₁ total</p></li>
<li><p>Observe social evidence: k₂ blue marbles out of n₂ total</p></li>
<li><p>Apply weights: w₁ for direct evidence, w₂ for social evidence</p></li>
<li><p>Posterior: Beta(α₀ + w₁·k₁ + w₂·k₂, β₀ + w₁·(n₁-k₁) + w₂·(n₂-k₂))</p></li>
</ul>
<p>The weights represent the degree to which each information source influences the final belief. A weight of 2.0 means you treat that evidence as if you had observed twice as many marbles as you actually did (as more reliable than what the current evidence would warrant), while a weight of 0.5 means you treat it as half as informative. From a cognitive perspective, they might reflect judgments about reliability, relevance, or attentional focus.</p>
</div>
<div id="implementation" class="section level3 hasAnchor" number="10.10.2">
<h3><span class="header-section-number">10.10.2</span> Implementation<a href="bayesian-models-of-cognition.html#implementation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="bayesian-models-of-cognition.html#cb416-1" tabindex="-1"></a><span class="co"># Weighted Beta-Binomial model for evidence integration</span></span>
<span id="cb416-2"><a href="bayesian-models-of-cognition.html#cb416-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb416-3"><a href="bayesian-models-of-cognition.html#cb416-3" tabindex="-1"></a><span class="co"># This function extends our basic model by allowing different weights for each</span></span>
<span id="cb416-4"><a href="bayesian-models-of-cognition.html#cb416-4" tabindex="-1"></a><span class="co"># evidence source. This can represent differences in perceived reliability,</span></span>
<span id="cb416-5"><a href="bayesian-models-of-cognition.html#cb416-5" tabindex="-1"></a><span class="co"># attention, or individual cognitive tendencies.</span></span>
<span id="cb416-6"><a href="bayesian-models-of-cognition.html#cb416-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb416-7"><a href="bayesian-models-of-cognition.html#cb416-7" tabindex="-1"></a><span class="co"># Parameters:</span></span>
<span id="cb416-8"><a href="bayesian-models-of-cognition.html#cb416-8" tabindex="-1"></a><span class="co">#   alpha_prior, beta_prior: Prior parameters (typically 1,1 for uniform prior)</span></span>
<span id="cb416-9"><a href="bayesian-models-of-cognition.html#cb416-9" tabindex="-1"></a><span class="co">#   blue1, total1: Direct evidence (blue marbles and total)</span></span>
<span id="cb416-10"><a href="bayesian-models-of-cognition.html#cb416-10" tabindex="-1"></a><span class="co">#   blue2, total2: Social evidence (blue signals and total)</span></span>
<span id="cb416-11"><a href="bayesian-models-of-cognition.html#cb416-11" tabindex="-1"></a><span class="co">#   weight_direct, weight_social: Relative weights for each evidence source</span></span>
<span id="cb416-12"><a href="bayesian-models-of-cognition.html#cb416-12" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb416-13"><a href="bayesian-models-of-cognition.html#cb416-13" tabindex="-1"></a><span class="co"># Returns:</span></span>
<span id="cb416-14"><a href="bayesian-models-of-cognition.html#cb416-14" tabindex="-1"></a><span class="co">#   List with model results and statistics</span></span>
<span id="cb416-15"><a href="bayesian-models-of-cognition.html#cb416-15" tabindex="-1"></a>weightedBetaBinomial <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha_prior, beta_prior, </span>
<span id="cb416-16"><a href="bayesian-models-of-cognition.html#cb416-16" tabindex="-1"></a>                                blue1, total1, </span>
<span id="cb416-17"><a href="bayesian-models-of-cognition.html#cb416-17" tabindex="-1"></a>                                blue2, total2,</span>
<span id="cb416-18"><a href="bayesian-models-of-cognition.html#cb416-18" tabindex="-1"></a>                                weight_direct, weight_social) {</span>
<span id="cb416-19"><a href="bayesian-models-of-cognition.html#cb416-19" tabindex="-1"></a>  </span>
<span id="cb416-20"><a href="bayesian-models-of-cognition.html#cb416-20" tabindex="-1"></a>  <span class="co"># Calculate red marbles for each source</span></span>
<span id="cb416-21"><a href="bayesian-models-of-cognition.html#cb416-21" tabindex="-1"></a>  red1 <span class="ot">&lt;-</span> total1 <span class="sc">-</span> blue1   <span class="co"># Number of red marbles in direct evidence</span></span>
<span id="cb416-22"><a href="bayesian-models-of-cognition.html#cb416-22" tabindex="-1"></a>  red2 <span class="ot">&lt;-</span> total2 <span class="sc">-</span> blue2   <span class="co"># Number of red signals in social evidence</span></span>
<span id="cb416-23"><a href="bayesian-models-of-cognition.html#cb416-23" tabindex="-1"></a>  </span>
<span id="cb416-24"><a href="bayesian-models-of-cognition.html#cb416-24" tabindex="-1"></a>  <span class="co"># Apply weights to evidence (this is the key step)</span></span>
<span id="cb416-25"><a href="bayesian-models-of-cognition.html#cb416-25" tabindex="-1"></a>  <span class="co"># Weighting effectively scales the &quot;sample size&quot; of each information source</span></span>
<span id="cb416-26"><a href="bayesian-models-of-cognition.html#cb416-26" tabindex="-1"></a>  weighted_blue1 <span class="ot">&lt;-</span> blue1 <span class="sc">*</span> weight_direct    <span class="co"># Weighted blue count from direct evidence</span></span>
<span id="cb416-27"><a href="bayesian-models-of-cognition.html#cb416-27" tabindex="-1"></a>  weighted_red1 <span class="ot">&lt;-</span> red1 <span class="sc">*</span> weight_direct      <span class="co"># Weighted red count from direct evidence</span></span>
<span id="cb416-28"><a href="bayesian-models-of-cognition.html#cb416-28" tabindex="-1"></a>  weighted_blue2 <span class="ot">&lt;-</span> blue2 <span class="sc">*</span> weight_social    <span class="co"># Weighted blue count from social evidence</span></span>
<span id="cb416-29"><a href="bayesian-models-of-cognition.html#cb416-29" tabindex="-1"></a>  weighted_red2 <span class="ot">&lt;-</span> red2 <span class="sc">*</span> weight_social      <span class="co"># Weighted red count from social evidence</span></span>
<span id="cb416-30"><a href="bayesian-models-of-cognition.html#cb416-30" tabindex="-1"></a>  </span>
<span id="cb416-31"><a href="bayesian-models-of-cognition.html#cb416-31" tabindex="-1"></a>  <span class="co"># Calculate posterior parameters by adding weighted evidence</span></span>
<span id="cb416-32"><a href="bayesian-models-of-cognition.html#cb416-32" tabindex="-1"></a>  alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> weighted_blue1 <span class="sc">+</span> weighted_blue2  <span class="co"># Posterior alpha parameter</span></span>
<span id="cb416-33"><a href="bayesian-models-of-cognition.html#cb416-33" tabindex="-1"></a>  beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> weighted_red1 <span class="sc">+</span> weighted_red2      <span class="co"># Posterior beta parameter</span></span>
<span id="cb416-34"><a href="bayesian-models-of-cognition.html#cb416-34" tabindex="-1"></a>  </span>
<span id="cb416-35"><a href="bayesian-models-of-cognition.html#cb416-35" tabindex="-1"></a>  <span class="co"># Calculate statistics from posterior beta distribution</span></span>
<span id="cb416-36"><a href="bayesian-models-of-cognition.html#cb416-36" tabindex="-1"></a>  expected_rate <span class="ot">&lt;-</span> alpha_post <span class="sc">/</span> (alpha_post <span class="sc">+</span> beta_post)   <span class="co"># Mean of beta distribution</span></span>
<span id="cb416-37"><a href="bayesian-models-of-cognition.html#cb416-37" tabindex="-1"></a>  </span>
<span id="cb416-38"><a href="bayesian-models-of-cognition.html#cb416-38" tabindex="-1"></a>  <span class="co"># Calculate variance (lower variance = higher confidence)</span></span>
<span id="cb416-39"><a href="bayesian-models-of-cognition.html#cb416-39" tabindex="-1"></a>  variance <span class="ot">&lt;-</span> (alpha_post <span class="sc">*</span> beta_post) <span class="sc">/</span> </span>
<span id="cb416-40"><a href="bayesian-models-of-cognition.html#cb416-40" tabindex="-1"></a>              ((alpha_post <span class="sc">+</span> beta_post)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (alpha_post <span class="sc">+</span> beta_post <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb416-41"><a href="bayesian-models-of-cognition.html#cb416-41" tabindex="-1"></a>  </span>
<span id="cb416-42"><a href="bayesian-models-of-cognition.html#cb416-42" tabindex="-1"></a>  <span class="co"># Calculate 95% credible interval</span></span>
<span id="cb416-43"><a href="bayesian-models-of-cognition.html#cb416-43" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.025</span>, alpha_post, beta_post)</span>
<span id="cb416-44"><a href="bayesian-models-of-cognition.html#cb416-44" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.975</span>, alpha_post, beta_post)</span>
<span id="cb416-45"><a href="bayesian-models-of-cognition.html#cb416-45" tabindex="-1"></a>  </span>
<span id="cb416-46"><a href="bayesian-models-of-cognition.html#cb416-46" tabindex="-1"></a>  <span class="co"># Calculate decision and confidence</span></span>
<span id="cb416-47"><a href="bayesian-models-of-cognition.html#cb416-47" tabindex="-1"></a>  decision <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, expected_rate) <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Blue&quot;</span>, <span class="st">&quot;Red&quot;</span>)   <span class="co"># Decision based on most likely color</span></span>
<span id="cb416-48"><a href="bayesian-models-of-cognition.html#cb416-48" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(variance))                  <span class="co"># Confidence based on certainty</span></span>
<span id="cb416-49"><a href="bayesian-models-of-cognition.html#cb416-49" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, <span class="fu">min</span>(<span class="dv">1</span>, confidence))                <span class="co"># Bound between 0 and 1</span></span>
<span id="cb416-50"><a href="bayesian-models-of-cognition.html#cb416-50" tabindex="-1"></a>  </span>
<span id="cb416-51"><a href="bayesian-models-of-cognition.html#cb416-51" tabindex="-1"></a>  <span class="co"># Return all calculated parameters in a structured list</span></span>
<span id="cb416-52"><a href="bayesian-models-of-cognition.html#cb416-52" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb416-53"><a href="bayesian-models-of-cognition.html#cb416-53" tabindex="-1"></a>    <span class="at">alpha_post =</span> alpha_post,</span>
<span id="cb416-54"><a href="bayesian-models-of-cognition.html#cb416-54" tabindex="-1"></a>    <span class="at">beta_post =</span> beta_post,</span>
<span id="cb416-55"><a href="bayesian-models-of-cognition.html#cb416-55" tabindex="-1"></a>    <span class="at">expected_rate =</span> expected_rate,</span>
<span id="cb416-56"><a href="bayesian-models-of-cognition.html#cb416-56" tabindex="-1"></a>    <span class="at">variance =</span> variance,</span>
<span id="cb416-57"><a href="bayesian-models-of-cognition.html#cb416-57" tabindex="-1"></a>    <span class="at">ci_lower =</span> ci_lower,</span>
<span id="cb416-58"><a href="bayesian-models-of-cognition.html#cb416-58" tabindex="-1"></a>    <span class="at">ci_upper =</span> ci_upper,</span>
<span id="cb416-59"><a href="bayesian-models-of-cognition.html#cb416-59" tabindex="-1"></a>    <span class="at">decision =</span> decision,</span>
<span id="cb416-60"><a href="bayesian-models-of-cognition.html#cb416-60" tabindex="-1"></a>    <span class="at">confidence =</span> confidence</span>
<span id="cb416-61"><a href="bayesian-models-of-cognition.html#cb416-61" tabindex="-1"></a>  ))</span>
<span id="cb416-62"><a href="bayesian-models-of-cognition.html#cb416-62" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="visualizing-weighted-bayesian-integration" class="section level3 hasAnchor" number="10.10.3">
<h3><span class="header-section-number">10.10.3</span> Visualizing Weighted Bayesian Integration<a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s create a comprehensive visualization showing how different weights affect belief formation:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="bayesian-models-of-cognition.html#cb417-1" tabindex="-1"></a><span class="co"># Create improved visualization using small multiples</span></span>
<span id="cb417-2"><a href="bayesian-models-of-cognition.html#cb417-2" tabindex="-1"></a>weighted_belief_plot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb417-3"><a href="bayesian-models-of-cognition.html#cb417-3" tabindex="-1"></a>  <span class="co"># Define grid of parameters to visualize</span></span>
<span id="cb417-4"><a href="bayesian-models-of-cognition.html#cb417-4" tabindex="-1"></a>  w1_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)  <span class="co"># Weight for source 1</span></span>
<span id="cb417-5"><a href="bayesian-models-of-cognition.html#cb417-5" tabindex="-1"></a>  w2_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)  <span class="co"># Weight for source 2</span></span>
<span id="cb417-6"><a href="bayesian-models-of-cognition.html#cb417-6" tabindex="-1"></a>  source1_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="dv">1</span>)  <span class="co"># Source 1 values</span></span>
<span id="cb417-7"><a href="bayesian-models-of-cognition.html#cb417-7" tabindex="-1"></a>  source2_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="dv">1</span>)  <span class="co"># Source 2 values </span></span>
<span id="cb417-8"><a href="bayesian-models-of-cognition.html#cb417-8" tabindex="-1"></a>  </span>
<span id="cb417-9"><a href="bayesian-models-of-cognition.html#cb417-9" tabindex="-1"></a>  <span class="co"># Generate data</span></span>
<span id="cb417-10"><a href="bayesian-models-of-cognition.html#cb417-10" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb417-11"><a href="bayesian-models-of-cognition.html#cb417-11" tabindex="-1"></a>    <span class="at">w1 =</span> w1_values,</span>
<span id="cb417-12"><a href="bayesian-models-of-cognition.html#cb417-12" tabindex="-1"></a>    <span class="at">w2 =</span> w2_values,</span>
<span id="cb417-13"><a href="bayesian-models-of-cognition.html#cb417-13" tabindex="-1"></a>    <span class="at">Source1 =</span> source1_values,</span>
<span id="cb417-14"><a href="bayesian-models-of-cognition.html#cb417-14" tabindex="-1"></a>    <span class="at">Source2 =</span> source2_values</span>
<span id="cb417-15"><a href="bayesian-models-of-cognition.html#cb417-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb417-16"><a href="bayesian-models-of-cognition.html#cb417-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb417-17"><a href="bayesian-models-of-cognition.html#cb417-17" tabindex="-1"></a>    <span class="at">belief =</span> <span class="fu">pmap_dbl</span>(<span class="fu">list</span>(w1, w2, Source1, Source2), <span class="cf">function</span>(w1, w2, s1, s2) {</span>
<span id="cb417-18"><a href="bayesian-models-of-cognition.html#cb417-18" tabindex="-1"></a>      </span>
<span id="cb417-19"><a href="bayesian-models-of-cognition.html#cb417-19" tabindex="-1"></a>      <span class="co"># Calculate Beta parameters</span></span>
<span id="cb417-20"><a href="bayesian-models-of-cognition.html#cb417-20" tabindex="-1"></a>      alpha_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb417-21"><a href="bayesian-models-of-cognition.html#cb417-21" tabindex="-1"></a>      beta_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb417-22"><a href="bayesian-models-of-cognition.html#cb417-22" tabindex="-1"></a>      alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> w1 <span class="sc">*</span> s1 <span class="sc">+</span> w2 <span class="sc">*</span> s2</span>
<span id="cb417-23"><a href="bayesian-models-of-cognition.html#cb417-23" tabindex="-1"></a>      beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> w1 <span class="sc">*</span> (<span class="dv">8</span> <span class="sc">-</span> s1) <span class="sc">+</span> w2<span class="sc">*</span>(<span class="dv">3</span> <span class="sc">-</span> s2)</span>
<span id="cb417-24"><a href="bayesian-models-of-cognition.html#cb417-24" tabindex="-1"></a>      </span>
<span id="cb417-25"><a href="bayesian-models-of-cognition.html#cb417-25" tabindex="-1"></a>      <span class="co"># Return expected value</span></span>
<span id="cb417-26"><a href="bayesian-models-of-cognition.html#cb417-26" tabindex="-1"></a>      alpha_post <span class="sc">/</span> (alpha_post <span class="sc">+</span> beta_post)</span>
<span id="cb417-27"><a href="bayesian-models-of-cognition.html#cb417-27" tabindex="-1"></a>    })</span>
<span id="cb417-28"><a href="bayesian-models-of-cognition.html#cb417-28" tabindex="-1"></a>  )</span>
<span id="cb417-29"><a href="bayesian-models-of-cognition.html#cb417-29" tabindex="-1"></a>  </span>
<span id="cb417-30"><a href="bayesian-models-of-cognition.html#cb417-30" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb417-31"><a href="bayesian-models-of-cognition.html#cb417-31" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Source1, <span class="at">y =</span> belief, <span class="at">color =</span> Source2, <span class="at">group =</span> Source2)) <span class="sc">+</span></span>
<span id="cb417-32"><a href="bayesian-models-of-cognition.html#cb417-32" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb417-33"><a href="bayesian-models-of-cognition.html#cb417-33" tabindex="-1"></a>    <span class="fu">facet_grid</span>(w1 <span class="sc">~</span> w2, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb417-34"><a href="bayesian-models-of-cognition.html#cb417-34" tabindex="-1"></a>      <span class="at">w1 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;w1 =&quot;</span>, x),</span>
<span id="cb417-35"><a href="bayesian-models-of-cognition.html#cb417-35" tabindex="-1"></a>      <span class="at">w2 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;w2 =&quot;</span>, x)</span>
<span id="cb417-36"><a href="bayesian-models-of-cognition.html#cb417-36" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb417-37"><a href="bayesian-models-of-cognition.html#cb417-37" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="sc">+</span></span>
<span id="cb417-38"><a href="bayesian-models-of-cognition.html#cb417-38" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb417-39"><a href="bayesian-models-of-cognition.html#cb417-39" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Weighted Bayesian Integration of Two Evidence Sources&quot;</span>,</span>
<span id="cb417-40"><a href="bayesian-models-of-cognition.html#cb417-40" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;Direct Evidence (Blue Marbles)&quot;</span>,</span>
<span id="cb417-41"><a href="bayesian-models-of-cognition.html#cb417-41" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;Belief in the next pick being a blue marble&quot;</span>,</span>
<span id="cb417-42"><a href="bayesian-models-of-cognition.html#cb417-42" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;Social Evidence (Blue Marbles)&quot;</span></span>
<span id="cb417-43"><a href="bayesian-models-of-cognition.html#cb417-43" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb417-44"><a href="bayesian-models-of-cognition.html#cb417-44" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb417-45"><a href="bayesian-models-of-cognition.html#cb417-45" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb417-46"><a href="bayesian-models-of-cognition.html#cb417-46" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;gray90&quot;</span>),</span>
<span id="cb417-47"><a href="bayesian-models-of-cognition.html#cb417-47" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb417-48"><a href="bayesian-models-of-cognition.html#cb417-48" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb417-49"><a href="bayesian-models-of-cognition.html#cb417-49" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>)</span>
<span id="cb417-50"><a href="bayesian-models-of-cognition.html#cb417-50" tabindex="-1"></a>    )</span>
<span id="cb417-51"><a href="bayesian-models-of-cognition.html#cb417-51" tabindex="-1"></a>  </span>
<span id="cb417-52"><a href="bayesian-models-of-cognition.html#cb417-52" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb417-53"><a href="bayesian-models-of-cognition.html#cb417-53" tabindex="-1"></a>}</span>
<span id="cb417-54"><a href="bayesian-models-of-cognition.html#cb417-54" tabindex="-1"></a></span>
<span id="cb417-55"><a href="bayesian-models-of-cognition.html#cb417-55" tabindex="-1"></a><span class="co"># Generate and display the plot</span></span>
<span id="cb417-56"><a href="bayesian-models-of-cognition.html#cb417-56" tabindex="-1"></a><span class="fu">weighted_belief_plot</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/09%20visualizing%20weighted%20bayes-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The visualization showcases weighted Bayesian integration:</p>
<ul>
<li><p>First, when both weights (w1 and w2) are low (top left panels), beliefs remain moderate regardless of the evidence values, representing high uncertainty. As weights increase (moving right and down), beliefs become more extreme, showing increased confidence in the integrated evidence.</p></li>
<li><p>Second, the slope of the lines indicates the relative influence of each source. Steeper slopes (bottom right panels) demonstrate that Source1 has stronger influence on belief when both weights are high, while the spacing between lines shows the impact of Source2.</p></li>
<li><p>Third, when weights are asymmetric (e.g., high w1 and low w2), the belief is dominated by the source with the higher weight, essentially ignoring evidence from the other source. This illustrates how selective attention to certain evidence sources can be modeled as differential weighting in a Bayesian framework.</p></li>
</ul>
</div>
<div id="resolving-conflicting-evidence" class="section level3 hasAnchor" number="10.10.4">
<h3><span class="header-section-number">10.10.4</span> Resolving Conflicting Evidence<a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To further understand how weighted Bayesian integration resolves conflicts between evidence sources, let’s examine two specific conflict scenarios:</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="bayesian-models-of-cognition.html#cb418-1" tabindex="-1"></a><span class="co"># Define conflict scenarios</span></span>
<span id="cb418-2"><a href="bayesian-models-of-cognition.html#cb418-2" tabindex="-1"></a>scenario1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">blue1 =</span> <span class="dv">7</span>, <span class="at">total1 =</span> <span class="dv">8</span>, <span class="at">blue2 =</span> <span class="dv">0</span>, <span class="at">total2 =</span> <span class="dv">3</span>)  <span class="co"># Direct: blue, Social: red</span></span>
<span id="cb418-3"><a href="bayesian-models-of-cognition.html#cb418-3" tabindex="-1"></a>scenario2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">blue1 =</span> <span class="dv">5</span>, <span class="at">total1 =</span> <span class="dv">8</span>, <span class="at">blue2 =</span> <span class="dv">0</span>, <span class="at">total2 =</span> <span class="dv">3</span>)  <span class="co"># Direct: red, Social: blue</span></span>
<span id="cb418-4"><a href="bayesian-models-of-cognition.html#cb418-4" tabindex="-1"></a></span>
<span id="cb418-5"><a href="bayesian-models-of-cognition.html#cb418-5" tabindex="-1"></a><span class="co"># Create function to evaluate scenarios across weight combinations</span></span>
<span id="cb418-6"><a href="bayesian-models-of-cognition.html#cb418-6" tabindex="-1"></a>evaluate_conflict <span class="ot">&lt;-</span> <span class="cf">function</span>(scenario) {</span>
<span id="cb418-7"><a href="bayesian-models-of-cognition.html#cb418-7" tabindex="-1"></a>  weight_grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb418-8"><a href="bayesian-models-of-cognition.html#cb418-8" tabindex="-1"></a>    <span class="at">weight_direct =</span>  <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb418-9"><a href="bayesian-models-of-cognition.html#cb418-9" tabindex="-1"></a>    <span class="at">weight_social =</span>  <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb418-10"><a href="bayesian-models-of-cognition.html#cb418-10" tabindex="-1"></a>  )</span>
<span id="cb418-11"><a href="bayesian-models-of-cognition.html#cb418-11" tabindex="-1"></a>  </span>
<span id="cb418-12"><a href="bayesian-models-of-cognition.html#cb418-12" tabindex="-1"></a>  <span class="co"># Calculate results for each weight combination</span></span>
<span id="cb418-13"><a href="bayesian-models-of-cognition.html#cb418-13" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(weight_grid, <span class="cf">function</span>(weight_direct, weight_social) {</span>
<span id="cb418-14"><a href="bayesian-models-of-cognition.html#cb418-14" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">weightedBetaBinomial</span>(</span>
<span id="cb418-15"><a href="bayesian-models-of-cognition.html#cb418-15" tabindex="-1"></a>      <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb418-16"><a href="bayesian-models-of-cognition.html#cb418-16" tabindex="-1"></a>      scenario<span class="sc">$</span>blue1, scenario<span class="sc">$</span>total1, </span>
<span id="cb418-17"><a href="bayesian-models-of-cognition.html#cb418-17" tabindex="-1"></a>      scenario<span class="sc">$</span>blue2, scenario<span class="sc">$</span>total2, </span>
<span id="cb418-18"><a href="bayesian-models-of-cognition.html#cb418-18" tabindex="-1"></a>      weight_direct, weight_social</span>
<span id="cb418-19"><a href="bayesian-models-of-cognition.html#cb418-19" tabindex="-1"></a>    )</span>
<span id="cb418-20"><a href="bayesian-models-of-cognition.html#cb418-20" tabindex="-1"></a>    </span>
<span id="cb418-21"><a href="bayesian-models-of-cognition.html#cb418-21" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb418-22"><a href="bayesian-models-of-cognition.html#cb418-22" tabindex="-1"></a>      <span class="at">weight_direct =</span> weight_direct,</span>
<span id="cb418-23"><a href="bayesian-models-of-cognition.html#cb418-23" tabindex="-1"></a>      <span class="at">weight_social =</span> weight_social,</span>
<span id="cb418-24"><a href="bayesian-models-of-cognition.html#cb418-24" tabindex="-1"></a>      <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,</span>
<span id="cb418-25"><a href="bayesian-models-of-cognition.html#cb418-25" tabindex="-1"></a>      <span class="at">decision =</span> result<span class="sc">$</span>decision</span>
<span id="cb418-26"><a href="bayesian-models-of-cognition.html#cb418-26" tabindex="-1"></a>    )</span>
<span id="cb418-27"><a href="bayesian-models-of-cognition.html#cb418-27" tabindex="-1"></a>  })</span>
<span id="cb418-28"><a href="bayesian-models-of-cognition.html#cb418-28" tabindex="-1"></a>  </span>
<span id="cb418-29"><a href="bayesian-models-of-cognition.html#cb418-29" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb418-30"><a href="bayesian-models-of-cognition.html#cb418-30" tabindex="-1"></a>}</span>
<span id="cb418-31"><a href="bayesian-models-of-cognition.html#cb418-31" tabindex="-1"></a></span>
<span id="cb418-32"><a href="bayesian-models-of-cognition.html#cb418-32" tabindex="-1"></a><span class="co"># Calculate results</span></span>
<span id="cb418-33"><a href="bayesian-models-of-cognition.html#cb418-33" tabindex="-1"></a>conflict1_results <span class="ot">&lt;-</span> <span class="fu">evaluate_conflict</span>(scenario1)</span>
<span id="cb418-34"><a href="bayesian-models-of-cognition.html#cb418-34" tabindex="-1"></a>conflict2_results <span class="ot">&lt;-</span> <span class="fu">evaluate_conflict</span>(scenario2)</span>
<span id="cb418-35"><a href="bayesian-models-of-cognition.html#cb418-35" tabindex="-1"></a></span>
<span id="cb418-36"><a href="bayesian-models-of-cognition.html#cb418-36" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb418-37"><a href="bayesian-models-of-cognition.html#cb418-37" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(conflict1_results, <span class="fu">aes</span>(<span class="at">x =</span> weight_direct, <span class="at">y =</span> weight_social)) <span class="sc">+</span></span>
<span id="cb418-38"><a href="bayesian-models-of-cognition.html#cb418-38" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> expected_rate)) <span class="sc">+</span></span>
<span id="cb418-39"><a href="bayesian-models-of-cognition.html#cb418-39" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> expected_rate), <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb418-40"><a href="bayesian-models-of-cognition.html#cb418-40" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb418-41"><a href="bayesian-models-of-cognition.html#cb418-41" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb418-42"><a href="bayesian-models-of-cognition.html#cb418-42" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb418-43"><a href="bayesian-models-of-cognition.html#cb418-43" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb418-44"><a href="bayesian-models-of-cognition.html#cb418-44" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb418-45"><a href="bayesian-models-of-cognition.html#cb418-45" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scenario 1: Strong Direct Evidence for Blue (7 out of 8) </span><span class="sc">\n</span><span class="st">vs. Strong Social Evidence for Red (0/3)&quot;</span>,</span>
<span id="cb418-46"><a href="bayesian-models-of-cognition.html#cb418-46" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Black line shows decision boundary (expected rate = 0.5)&quot;</span>,</span>
<span id="cb418-47"><a href="bayesian-models-of-cognition.html#cb418-47" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Weight for Direct Evidence&quot;</span>,</span>
<span id="cb418-48"><a href="bayesian-models-of-cognition.html#cb418-48" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight for Social Evidence&quot;</span>,</span>
<span id="cb418-49"><a href="bayesian-models-of-cognition.html#cb418-49" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Expected</span><span class="sc">\n</span><span class="st">Rate&quot;</span></span>
<span id="cb418-50"><a href="bayesian-models-of-cognition.html#cb418-50" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb418-51"><a href="bayesian-models-of-cognition.html#cb418-51" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb418-52"><a href="bayesian-models-of-cognition.html#cb418-52" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb418-53"><a href="bayesian-models-of-cognition.html#cb418-53" tabindex="-1"></a></span>
<span id="cb418-54"><a href="bayesian-models-of-cognition.html#cb418-54" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(conflict2_results, <span class="fu">aes</span>(<span class="at">x =</span> weight_direct, <span class="at">y =</span> weight_social)) <span class="sc">+</span></span>
<span id="cb418-55"><a href="bayesian-models-of-cognition.html#cb418-55" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> expected_rate)) <span class="sc">+</span></span>
<span id="cb418-56"><a href="bayesian-models-of-cognition.html#cb418-56" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> expected_rate), <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb418-57"><a href="bayesian-models-of-cognition.html#cb418-57" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb418-58"><a href="bayesian-models-of-cognition.html#cb418-58" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb418-59"><a href="bayesian-models-of-cognition.html#cb418-59" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb418-60"><a href="bayesian-models-of-cognition.html#cb418-60" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb418-61"><a href="bayesian-models-of-cognition.html#cb418-61" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb418-62"><a href="bayesian-models-of-cognition.html#cb418-62" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scenario 1: Weak Direct Evidence for Blue (5 out of 8) </span><span class="sc">\n</span><span class="st">vs. Strong Social Evidence for Red (0/3)&quot;</span>,</span>
<span id="cb418-63"><a href="bayesian-models-of-cognition.html#cb418-63" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Black line shows decision boundary (expected rate = 0.5)&quot;</span>,</span>
<span id="cb418-64"><a href="bayesian-models-of-cognition.html#cb418-64" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Weight for Direct Evidence&quot;</span>,</span>
<span id="cb418-65"><a href="bayesian-models-of-cognition.html#cb418-65" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight for Social Evidence&quot;</span>,</span>
<span id="cb418-66"><a href="bayesian-models-of-cognition.html#cb418-66" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Expected</span><span class="sc">\n</span><span class="st">Rate&quot;</span></span>
<span id="cb418-67"><a href="bayesian-models-of-cognition.html#cb418-67" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb418-68"><a href="bayesian-models-of-cognition.html#cb418-68" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb418-69"><a href="bayesian-models-of-cognition.html#cb418-69" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb418-70"><a href="bayesian-models-of-cognition.html#cb418-70" tabindex="-1"></a></span>
<span id="cb418-71"><a href="bayesian-models-of-cognition.html#cb418-71" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb418-72"><a href="bayesian-models-of-cognition.html#cb418-72" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/09%20conflicting%20scenarios-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>These visualizations illustrate how different weight combinations resolve conflicts between evidence sources:</p>
<ul>
<li><p>Decision boundary: The black line represents combinations of weights that lead to equal evidence for red and blue (expected rate = 0.5). Weight combinations above this line lead to a “blue” decision, while those below lead to a “red” decision.</p></li>
<li><p>Relative evidence strength: The slope of the decision boundary reflects the relative strength of the evidence sources. A steeper slope indicates that direct evidence is stronger relative to social evidence.</p></li>
<li><p>Individual differences: Different individuals might give different weights to evidence sources, leading to different decisions even when faced with identical evidence. This provides a mechanistic explanation for individual variation in decision-making.</p></li>
</ul>
</div>
</div>
<div id="common-misinterpretations" class="section level2 hasAnchor" number="10.11">
<h2><span class="header-section-number">10.11</span> Common Misinterpretations<a href="bayesian-models-of-cognition.html#common-misinterpretations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="weight-interpretation" class="section level3 hasAnchor" number="10.11.1">
<h3><span class="header-section-number">10.11.1</span> Weight Interpretation<a href="bayesian-models-of-cognition.html#weight-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Weights effectively scale the relative importance of each source of evidence. A weight of 0 means ignoring that evidence source entirely. A weight of 1 means treating the evidence as observed, at face value. Weights above 1 amplify the evidence, while weights below 1 dampen it. A negative weight would make the agent invert the direction of the evidence (if more evidence for red, they’d tend to pick blue).
Remember that weights moderate the evidence, so a strong weight doesn’t guarantee a strong influence if the evidence itself is weak.</p>
</div>
<div id="integration-vs.-averaging" class="section level3 hasAnchor" number="10.11.2">
<h3><span class="header-section-number">10.11.2</span> Integration vs. Averaging<a href="bayesian-models-of-cognition.html#integration-vs.-averaging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bayesian integration is not simply the averaging of evidence across sources, because it naturally includes how precise the evidence is (how narrow the distribution). Normally, this would happen when we multiply the distributions involved. The Beta-Binomial model handles this automatically by incorporating sample sizes (the n of marbles).</p>
</div>
<div id="interpreting-confidence" class="section level3 hasAnchor" number="10.11.3">
<h3><span class="header-section-number">10.11.3</span> Interpreting Confidence<a href="bayesian-models-of-cognition.html#interpreting-confidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is something tricky in this model when it comes to confidence. We can say that a belief that the next sample is going to be blue with a 0.8 (average) probability more confident than one with a 0.6 (average) probability. We can also say that a belief that the next sample is going to be blue with a 0.8 (95% CIs 0.5-1) probability is less confident than a belief with a 0.6 (95% CIs 0.55-0.65) probability.
We need to keep these two aspects separate. The first one is about the average probability, the second one is about the uncertainty around that average probability.
In the code above we only call the second confidence and use entropy of the posterior distribution to quantify it.</p>
</div>
</div>
<div id="simulating-agents-with-different-evidence-weighting-strategies" class="section level2 hasAnchor" number="10.12">
<h2><span class="header-section-number">10.12</span> Simulating Agents with Different Evidence Weighting Strategies<a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To prepare for our model fitting, we’ll simulate three distinct agents:</p>
<ul>
<li><p>Balanced Agent: This agent treats both direct and social evidence at face value, applying equal weights (w_direct = 1.0, w_social = 1.0). This represents an unbiased integration of information.</p></li>
<li><p>Self-Focused Agent: This agent overweights their own direct evidence (w_direct = 1.5) while underweighting social evidence (w_social = 0.5). This represents someone who trusts their own observations more than information from others.</p></li>
<li><p>Socially-Influenced Agent: This agent does the opposite, overweighting social evidence (w_social = 2.0) while underweighting their own direct evidence (w_direct = 0.7). This might represent someone who is highly responsive to social information.</p></li>
</ul>
<p>Let’s generate decisions for these three agents in an experiment exposing them to all possible evidence combinations and visualize how their different weighting strategies affect their beliefs and choices.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="bayesian-models-of-cognition.html#cb419-1" tabindex="-1"></a><span class="co"># Simulation of agents with different weighting strategies</span></span>
<span id="cb419-2"><a href="bayesian-models-of-cognition.html#cb419-2" tabindex="-1"></a><span class="co"># This code generates decisions for three agents with different approaches to weighting evidence</span></span>
<span id="cb419-3"><a href="bayesian-models-of-cognition.html#cb419-3" tabindex="-1"></a></span>
<span id="cb419-4"><a href="bayesian-models-of-cognition.html#cb419-4" tabindex="-1"></a><span class="co"># Define our three agent types with their respective weights</span></span>
<span id="cb419-5"><a href="bayesian-models-of-cognition.html#cb419-5" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb419-6"><a href="bayesian-models-of-cognition.html#cb419-6" tabindex="-1"></a>  <span class="at">agent_type =</span> <span class="fu">c</span>(<span class="st">&quot;Balanced&quot;</span>, <span class="st">&quot;Self-Focused&quot;</span>, <span class="st">&quot;Socially-Influenced&quot;</span>),</span>
<span id="cb419-7"><a href="bayesian-models-of-cognition.html#cb419-7" tabindex="-1"></a>  <span class="at">weight_direct =</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="fl">0.7</span>),   <span class="co"># Weight for direct evidence</span></span>
<span id="cb419-8"><a href="bayesian-models-of-cognition.html#cb419-8" tabindex="-1"></a>  <span class="at">weight_social =</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">2.0</span>)    <span class="co"># Weight for social evidence</span></span>
<span id="cb419-9"><a href="bayesian-models-of-cognition.html#cb419-9" tabindex="-1"></a>)</span>
<span id="cb419-10"><a href="bayesian-models-of-cognition.html#cb419-10" tabindex="-1"></a></span>
<span id="cb419-11"><a href="bayesian-models-of-cognition.html#cb419-11" tabindex="-1"></a><span class="co"># Create all possible evidence combinations</span></span>
<span id="cb419-12"><a href="bayesian-models-of-cognition.html#cb419-12" tabindex="-1"></a><span class="co"># Direct evidence: 0-8 blue marbles out of 8 total</span></span>
<span id="cb419-13"><a href="bayesian-models-of-cognition.html#cb419-13" tabindex="-1"></a><span class="co"># Social evidence: 0-3 signals (representing confidence levels)</span></span>
<span id="cb419-14"><a href="bayesian-models-of-cognition.html#cb419-14" tabindex="-1"></a>evidence_combinations <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb419-15"><a href="bayesian-models-of-cognition.html#cb419-15" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,     <span class="co"># Direct evidence: number of blue marbles seen</span></span>
<span id="cb419-16"><a href="bayesian-models-of-cognition.html#cb419-16" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>      <span class="co"># Social evidence: strength of blue evidence</span></span>
<span id="cb419-17"><a href="bayesian-models-of-cognition.html#cb419-17" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb419-18"><a href="bayesian-models-of-cognition.html#cb419-18" tabindex="-1"></a>  <span class="at">total1 =</span> <span class="dv">8</span>,      <span class="co"># Total marbles in direct evidence</span></span>
<span id="cb419-19"><a href="bayesian-models-of-cognition.html#cb419-19" tabindex="-1"></a>  <span class="at">total2 =</span> <span class="dv">3</span>       <span class="co"># Total strength units in social evidence</span></span>
<span id="cb419-20"><a href="bayesian-models-of-cognition.html#cb419-20" tabindex="-1"></a>)</span>
<span id="cb419-21"><a href="bayesian-models-of-cognition.html#cb419-21" tabindex="-1"></a></span>
<span id="cb419-22"><a href="bayesian-models-of-cognition.html#cb419-22" tabindex="-1"></a><span class="co"># Function to generate decisions across all evidence combinations for a given agent</span></span>
<span id="cb419-23"><a href="bayesian-models-of-cognition.html#cb419-23" tabindex="-1"></a>generate_agent_decisions <span class="ot">&lt;-</span> <span class="cf">function</span>(weight_direct, weight_social, evidence_df) {</span>
<span id="cb419-24"><a href="bayesian-models-of-cognition.html#cb419-24" tabindex="-1"></a>  <span class="co"># Apply our weighted Bayesian model to each evidence combination</span></span>
<span id="cb419-25"><a href="bayesian-models-of-cognition.html#cb419-25" tabindex="-1"></a>  decisions <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(evidence_df, <span class="cf">function</span>(blue1, blue2, total1, total2) {</span>
<span id="cb419-26"><a href="bayesian-models-of-cognition.html#cb419-26" tabindex="-1"></a>    <span class="co"># Calculate Bayesian integration with the agent&#39;s specific weights</span></span>
<span id="cb419-27"><a href="bayesian-models-of-cognition.html#cb419-27" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">weightedBetaBinomial</span>(</span>
<span id="cb419-28"><a href="bayesian-models-of-cognition.html#cb419-28" tabindex="-1"></a>      <span class="at">alpha_prior =</span> <span class="dv">1</span>, <span class="at">beta_prior =</span> <span class="dv">1</span>,</span>
<span id="cb419-29"><a href="bayesian-models-of-cognition.html#cb419-29" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1, <span class="at">total1 =</span> total1,</span>
<span id="cb419-30"><a href="bayesian-models-of-cognition.html#cb419-30" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2, <span class="at">total2 =</span> total2,</span>
<span id="cb419-31"><a href="bayesian-models-of-cognition.html#cb419-31" tabindex="-1"></a>      <span class="at">weight_direct =</span> weight_direct,</span>
<span id="cb419-32"><a href="bayesian-models-of-cognition.html#cb419-32" tabindex="-1"></a>      <span class="at">weight_social =</span> weight_social</span>
<span id="cb419-33"><a href="bayesian-models-of-cognition.html#cb419-33" tabindex="-1"></a>    )</span>
<span id="cb419-34"><a href="bayesian-models-of-cognition.html#cb419-34" tabindex="-1"></a>    </span>
<span id="cb419-35"><a href="bayesian-models-of-cognition.html#cb419-35" tabindex="-1"></a>    <span class="co"># Return key decision metrics</span></span>
<span id="cb419-36"><a href="bayesian-models-of-cognition.html#cb419-36" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb419-37"><a href="bayesian-models-of-cognition.html#cb419-37" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1,</span>
<span id="cb419-38"><a href="bayesian-models-of-cognition.html#cb419-38" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2,</span>
<span id="cb419-39"><a href="bayesian-models-of-cognition.html#cb419-39" tabindex="-1"></a>      <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,   <span class="co"># Probability the next marble is blue</span></span>
<span id="cb419-40"><a href="bayesian-models-of-cognition.html#cb419-40" tabindex="-1"></a>      <span class="at">choice =</span> result<span class="sc">$</span>decision,               <span class="co"># Final decision (Blue or Red)</span></span>
<span id="cb419-41"><a href="bayesian-models-of-cognition.html#cb419-41" tabindex="-1"></a>      <span class="at">confidence =</span> result<span class="sc">$</span>confidence          <span class="co"># Confidence in decision</span></span>
<span id="cb419-42"><a href="bayesian-models-of-cognition.html#cb419-42" tabindex="-1"></a>    )</span>
<span id="cb419-43"><a href="bayesian-models-of-cognition.html#cb419-43" tabindex="-1"></a>  })</span>
<span id="cb419-44"><a href="bayesian-models-of-cognition.html#cb419-44" tabindex="-1"></a>  </span>
<span id="cb419-45"><a href="bayesian-models-of-cognition.html#cb419-45" tabindex="-1"></a>  <span class="fu">return</span>(decisions)</span>
<span id="cb419-46"><a href="bayesian-models-of-cognition.html#cb419-46" tabindex="-1"></a>}</span>
<span id="cb419-47"><a href="bayesian-models-of-cognition.html#cb419-47" tabindex="-1"></a></span>
<span id="cb419-48"><a href="bayesian-models-of-cognition.html#cb419-48" tabindex="-1"></a><span class="co"># Generate decisions for all agents across all evidence combinations</span></span>
<span id="cb419-49"><a href="bayesian-models-of-cognition.html#cb419-49" tabindex="-1"></a>simulation_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(agents), <span class="cf">function</span>(i) {</span>
<span id="cb419-50"><a href="bayesian-models-of-cognition.html#cb419-50" tabindex="-1"></a>  <span class="co"># Extract this agent&#39;s parameters</span></span>
<span id="cb419-51"><a href="bayesian-models-of-cognition.html#cb419-51" tabindex="-1"></a>  agent_data <span class="ot">&lt;-</span> agents[i, ]</span>
<span id="cb419-52"><a href="bayesian-models-of-cognition.html#cb419-52" tabindex="-1"></a>  </span>
<span id="cb419-53"><a href="bayesian-models-of-cognition.html#cb419-53" tabindex="-1"></a>  <span class="co"># Generate decisions for this agent</span></span>
<span id="cb419-54"><a href="bayesian-models-of-cognition.html#cb419-54" tabindex="-1"></a>  decisions <span class="ot">&lt;-</span> <span class="fu">generate_agent_decisions</span>(</span>
<span id="cb419-55"><a href="bayesian-models-of-cognition.html#cb419-55" tabindex="-1"></a>    agent_data<span class="sc">$</span>weight_direct,</span>
<span id="cb419-56"><a href="bayesian-models-of-cognition.html#cb419-56" tabindex="-1"></a>    agent_data<span class="sc">$</span>weight_social,</span>
<span id="cb419-57"><a href="bayesian-models-of-cognition.html#cb419-57" tabindex="-1"></a>    evidence_combinations</span>
<span id="cb419-58"><a href="bayesian-models-of-cognition.html#cb419-58" tabindex="-1"></a>  )</span>
<span id="cb419-59"><a href="bayesian-models-of-cognition.html#cb419-59" tabindex="-1"></a>  </span>
<span id="cb419-60"><a href="bayesian-models-of-cognition.html#cb419-60" tabindex="-1"></a>  <span class="co"># Add agent identifier</span></span>
<span id="cb419-61"><a href="bayesian-models-of-cognition.html#cb419-61" tabindex="-1"></a>  decisions<span class="sc">$</span>agent_type <span class="ot">&lt;-</span> agent_data<span class="sc">$</span>agent_type</span>
<span id="cb419-62"><a href="bayesian-models-of-cognition.html#cb419-62" tabindex="-1"></a>  </span>
<span id="cb419-63"><a href="bayesian-models-of-cognition.html#cb419-63" tabindex="-1"></a>  <span class="fu">return</span>(decisions)</span>
<span id="cb419-64"><a href="bayesian-models-of-cognition.html#cb419-64" tabindex="-1"></a>})</span>
<span id="cb419-65"><a href="bayesian-models-of-cognition.html#cb419-65" tabindex="-1"></a></span>
<span id="cb419-66"><a href="bayesian-models-of-cognition.html#cb419-66" tabindex="-1"></a><span class="co"># Add descriptive labels for visualization</span></span>
<span id="cb419-67"><a href="bayesian-models-of-cognition.html#cb419-67" tabindex="-1"></a>simulation_results <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb419-68"><a href="bayesian-models-of-cognition.html#cb419-68" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-69"><a href="bayesian-models-of-cognition.html#cb419-69" tabindex="-1"></a>    <span class="co"># Create descriptive labels for social evidence</span></span>
<span id="cb419-70"><a href="bayesian-models-of-cognition.html#cb419-70" tabindex="-1"></a>    <span class="at">social_evidence =</span> <span class="fu">factor</span>(</span>
<span id="cb419-71"><a href="bayesian-models-of-cognition.html#cb419-71" tabindex="-1"></a>      blue2,</span>
<span id="cb419-72"><a href="bayesian-models-of-cognition.html#cb419-72" tabindex="-1"></a>      <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb419-73"><a href="bayesian-models-of-cognition.html#cb419-73" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Maybe Red&quot;</span>, <span class="st">&quot;Maybe Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>)</span>
<span id="cb419-74"><a href="bayesian-models-of-cognition.html#cb419-74" tabindex="-1"></a>    ),</span>
<span id="cb419-75"><a href="bayesian-models-of-cognition.html#cb419-75" tabindex="-1"></a>    <span class="co"># Create factor for agent type to control plotting order</span></span>
<span id="cb419-76"><a href="bayesian-models-of-cognition.html#cb419-76" tabindex="-1"></a>    <span class="at">agent_type =</span> <span class="fu">factor</span>(</span>
<span id="cb419-77"><a href="bayesian-models-of-cognition.html#cb419-77" tabindex="-1"></a>      agent_type,</span>
<span id="cb419-78"><a href="bayesian-models-of-cognition.html#cb419-78" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Balanced&quot;</span>, <span class="st">&quot;Self-Focused&quot;</span>, <span class="st">&quot;Socially-Influenced&quot;</span>)</span>
<span id="cb419-79"><a href="bayesian-models-of-cognition.html#cb419-79" tabindex="-1"></a>    )</span>
<span id="cb419-80"><a href="bayesian-models-of-cognition.html#cb419-80" tabindex="-1"></a>  )</span>
<span id="cb419-81"><a href="bayesian-models-of-cognition.html#cb419-81" tabindex="-1"></a></span>
<span id="cb419-82"><a href="bayesian-models-of-cognition.html#cb419-82" tabindex="-1"></a><span class="co"># Let&#39;s examine a sample of the generated data</span></span>
<span id="cb419-83"><a href="bayesian-models-of-cognition.html#cb419-83" tabindex="-1"></a><span class="fu">head</span>(simulation_results)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   blue1 blue2 expected_rate choice confidence agent_type social_evidence
##   &lt;int&gt; &lt;int&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;fct&gt;      &lt;fct&gt;          
## 1     0     0        0.0769 Blue        0.858 Balanced   Clear Red      
## 2     0     1        0.154  Red         0.807 Balanced   Maybe Red      
## 3     0     2        0.231  Blue        0.775 Balanced   Maybe Blue     
## 4     0     3        0.308  Red         0.753 Balanced   Clear Blue     
## 5     1     0        0.154  Red         0.807 Balanced   Clear Red      
## 6     1     1        0.231  Red         0.775 Balanced   Maybe Red</code></pre>
<p>Now let’s create visualizations to compare how these different agents make decisions based on the same evidence:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="bayesian-models-of-cognition.html#cb421-1" tabindex="-1"></a><span class="co"># Visualization 1: Expected probability across evidence combinations</span></span>
<span id="cb421-2"><a href="bayesian-models-of-cognition.html#cb421-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(simulation_results, </span>
<span id="cb421-3"><a href="bayesian-models-of-cognition.html#cb421-3" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> expected_rate, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb421-4"><a href="bayesian-models-of-cognition.html#cb421-4" tabindex="-1"></a>  <span class="co"># Draw a line for each social evidence level</span></span>
<span id="cb421-5"><a href="bayesian-models-of-cognition.html#cb421-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb421-6"><a href="bayesian-models-of-cognition.html#cb421-6" tabindex="-1"></a>  <span class="co"># Add points to show discrete evidence combinations</span></span>
<span id="cb421-7"><a href="bayesian-models-of-cognition.html#cb421-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb421-8"><a href="bayesian-models-of-cognition.html#cb421-8" tabindex="-1"></a>  <span class="co"># Add a reference line at 0.5 (decision boundary)</span></span>
<span id="cb421-9"><a href="bayesian-models-of-cognition.html#cb421-9" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-10"><a href="bayesian-models-of-cognition.html#cb421-10" tabindex="-1"></a>  <span class="co"># Facet by agent type</span></span>
<span id="cb421-11"><a href="bayesian-models-of-cognition.html#cb421-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_type, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb421-12"><a href="bayesian-models-of-cognition.html#cb421-12" tabindex="-1"></a>  <span class="co"># Customize colors and labels</span></span>
<span id="cb421-13"><a href="bayesian-models-of-cognition.html#cb421-13" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-14"><a href="bayesian-models-of-cognition.html#cb421-14" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb421-15"><a href="bayesian-models-of-cognition.html#cb421-15" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb421-16"><a href="bayesian-models-of-cognition.html#cb421-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;How Different Agents Integrate Evidence&quot;</span>,</span>
<span id="cb421-17"><a href="bayesian-models-of-cognition.html#cb421-17" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Expected probability of blue marble across evidence combinations&quot;</span>,</span>
<span id="cb421-18"><a href="bayesian-models-of-cognition.html#cb421-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Sample (out of 8)&quot;</span>,</span>
<span id="cb421-19"><a href="bayesian-models-of-cognition.html#cb421-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Expected Probability of Blue&quot;</span>,</span>
<span id="cb421-20"><a href="bayesian-models-of-cognition.html#cb421-20" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span></span>
<span id="cb421-21"><a href="bayesian-models-of-cognition.html#cb421-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb421-22"><a href="bayesian-models-of-cognition.html#cb421-22" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb421-23"><a href="bayesian-models-of-cognition.html#cb421-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb421-24"><a href="bayesian-models-of-cognition.html#cb421-24" tabindex="-1"></a></span>
<span id="cb421-25"><a href="bayesian-models-of-cognition.html#cb421-25" tabindex="-1"></a><span class="co"># Visualization 2: Decision boundaries for each agent</span></span>
<span id="cb421-26"><a href="bayesian-models-of-cognition.html#cb421-26" tabindex="-1"></a><span class="co"># Create a simplified dataset showing just the decision (Blue/Red)</span></span>
<span id="cb421-27"><a href="bayesian-models-of-cognition.html#cb421-27" tabindex="-1"></a>decision_data <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb421-28"><a href="bayesian-models-of-cognition.html#cb421-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decision_value =</span> <span class="fu">ifelse</span>(choice <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb421-29"><a href="bayesian-models-of-cognition.html#cb421-29" tabindex="-1"></a></span>
<span id="cb421-30"><a href="bayesian-models-of-cognition.html#cb421-30" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(decision_data, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> blue2)) <span class="sc">+</span></span>
<span id="cb421-31"><a href="bayesian-models-of-cognition.html#cb421-31" tabindex="-1"></a>  <span class="co"># Create tiles colored by decision</span></span>
<span id="cb421-32"><a href="bayesian-models-of-cognition.html#cb421-32" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> choice)) <span class="sc">+</span></span>
<span id="cb421-33"><a href="bayesian-models-of-cognition.html#cb421-33" tabindex="-1"></a>  <span class="co"># Add decision boundary contour line</span></span>
<span id="cb421-34"><a href="bayesian-models-of-cognition.html#cb421-34" tabindex="-1"></a>  <span class="fu">stat_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> decision_value), <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb421-35"><a href="bayesian-models-of-cognition.html#cb421-35" tabindex="-1"></a>  <span class="co"># Facet by agent type</span></span>
<span id="cb421-36"><a href="bayesian-models-of-cognition.html#cb421-36" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_type) <span class="sc">+</span></span>
<span id="cb421-37"><a href="bayesian-models-of-cognition.html#cb421-37" tabindex="-1"></a>  <span class="co"># Customize colors and labels</span></span>
<span id="cb421-38"><a href="bayesian-models-of-cognition.html#cb421-38" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Red&quot;</span> <span class="ot">=</span> <span class="st">&quot;firebrick&quot;</span>, <span class="st">&quot;Blue&quot;</span> <span class="ot">=</span> <span class="st">&quot;royalblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb421-39"><a href="bayesian-models-of-cognition.html#cb421-39" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb421-40"><a href="bayesian-models-of-cognition.html#cb421-40" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb421-41"><a href="bayesian-models-of-cognition.html#cb421-41" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb421-42"><a href="bayesian-models-of-cognition.html#cb421-42" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Decision Boundaries Across Agents&quot;</span>,</span>
<span id="cb421-43"><a href="bayesian-models-of-cognition.html#cb421-43" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Black line shows where agents switch from choosing red to blue&quot;</span>,</span>
<span id="cb421-44"><a href="bayesian-models-of-cognition.html#cb421-44" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Evidence (out of 8)&quot;</span>,</span>
<span id="cb421-45"><a href="bayesian-models-of-cognition.html#cb421-45" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Number of Blue Signals in Social Evidence (out of 3)&quot;</span>,</span>
<span id="cb421-46"><a href="bayesian-models-of-cognition.html#cb421-46" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Decision&quot;</span></span>
<span id="cb421-47"><a href="bayesian-models-of-cognition.html#cb421-47" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb421-48"><a href="bayesian-models-of-cognition.html#cb421-48" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb421-49"><a href="bayesian-models-of-cognition.html#cb421-49" tabindex="-1"></a></span>
<span id="cb421-50"><a href="bayesian-models-of-cognition.html#cb421-50" tabindex="-1"></a><span class="co"># Visualization 3: Confidence levels</span></span>
<span id="cb421-51"><a href="bayesian-models-of-cognition.html#cb421-51" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(simulation_results, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> confidence, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb421-52"><a href="bayesian-models-of-cognition.html#cb421-52" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb421-53"><a href="bayesian-models-of-cognition.html#cb421-53" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb421-54"><a href="bayesian-models-of-cognition.html#cb421-54" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_type, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb421-55"><a href="bayesian-models-of-cognition.html#cb421-55" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-56"><a href="bayesian-models-of-cognition.html#cb421-56" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb421-57"><a href="bayesian-models-of-cognition.html#cb421-57" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb421-58"><a href="bayesian-models-of-cognition.html#cb421-58" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Confidence Across Evidence Combinations&quot;</span>,</span>
<span id="cb421-59"><a href="bayesian-models-of-cognition.html#cb421-59" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher values indicate greater confidence in decision&quot;</span>,</span>
<span id="cb421-60"><a href="bayesian-models-of-cognition.html#cb421-60" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Sample (out of 8)&quot;</span>,</span>
<span id="cb421-61"><a href="bayesian-models-of-cognition.html#cb421-61" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Decision Confidence&quot;</span>,</span>
<span id="cb421-62"><a href="bayesian-models-of-cognition.html#cb421-62" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span></span>
<span id="cb421-63"><a href="bayesian-models-of-cognition.html#cb421-63" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb421-64"><a href="bayesian-models-of-cognition.html#cb421-64" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb421-65"><a href="bayesian-models-of-cognition.html#cb421-65" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb421-66"><a href="bayesian-models-of-cognition.html#cb421-66" tabindex="-1"></a></span>
<span id="cb421-67"><a href="bayesian-models-of-cognition.html#cb421-67" tabindex="-1"></a><span class="co"># Display the visualizations</span></span>
<span id="cb421-68"><a href="bayesian-models-of-cognition.html#cb421-68" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/09%20visualizing%20agents%20with%20different%20strategies-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="bayesian-models-of-cognition.html#cb422-1" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="series_files/figure-html/09%20visualizing%20agents%20with%20different%20strategies-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="bayesian-models-of-cognition.html#cb423-1" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="series_files/figure-html/09%20visualizing%20agents%20with%20different%20strategies-3.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="key-observations-from-the-simulation" class="section level2 hasAnchor" number="10.13">
<h2><span class="header-section-number">10.13</span> Key Observations from the Simulation<a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our simulation highlights several important aspects of Bayesian evidence integration with different weighting strategies:</p>
<ul>
<li><p>Evidence Thresholds: The decision boundaries (Visualization 2) clearly show how much evidence each agent requires to switch from choosing red to blue. The Self-Focused agent needs less direct evidence when social evidence supports blue, compared to the Socially-Influenced agent.</p></li>
<li><p>Influence of Social Evidence: In the first visualization, we can observe how the lines for different social evidence levels are spaced. For the Socially-Influenced agent, these lines are widely spaced, indicating that social evidence strongly affects their beliefs. For the Self-Focused agent, the lines are closer together, showing less impact from social evidence.</p></li>
<li><p>Confidence Patterns: The third visualization reveals how confidence varies across evidence combinations and agent types. All agents are most confident when evidence is strong and consistent across sources, but they differ in how they handle conflicting evidence.</p></li>
<li><p>Decision Regions: The Self-Focused agent has a larger region where they choose blue based primarily on direct evidence, while the Socially-Influenced agent has more regions where social evidence can override moderate direct evidence.</p></li>
</ul>
<p>These patterns highlight the profound impact that evidence weighting can have on decision-making, even when agents are all using the same underlying Bayesian integration mechanism. In the next section, we’ll implement these agents in Stan to perform more sophisticated parameter estimation.</p>
<p>Now, let’s define our Stan models to implement: a simple bayesian agent (equivalent to assuming both weights to be 1); and a weighted bayesian agent (explicitly inferring weights for direct and social evidence).</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="bayesian-models-of-cognition.html#cb424-1" tabindex="-1"></a><span class="co"># Simple Beta-Binomial Stan model (no weights)</span></span>
<span id="cb424-2"><a href="bayesian-models-of-cognition.html#cb424-2" tabindex="-1"></a>SimpleAgent_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb424-3"><a href="bayesian-models-of-cognition.html#cb424-3" tabindex="-1"></a><span class="st">// Bayesian integration model with separate theta parameters for each evidence source</span></span>
<span id="cb424-4"><a href="bayesian-models-of-cognition.html#cb424-4" tabindex="-1"></a><span class="st">// All evidence is taken at face value (equal weights)</span></span>
<span id="cb424-5"><a href="bayesian-models-of-cognition.html#cb424-5" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb424-6"><a href="bayesian-models-of-cognition.html#cb424-6" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Number of decisions</span></span>
<span id="cb424-7"><a href="bayesian-models-of-cognition.html#cb424-7" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb424-8"><a href="bayesian-models-of-cognition.html#cb424-8" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles)</span></span>
<span id="cb424-9"><a href="bayesian-models-of-cognition.html#cb424-9" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;          // Total direct evidence (total marbles)</span></span>
<span id="cb424-10"><a href="bayesian-models-of-cognition.html#cb424-10" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals)</span></span>
<span id="cb424-11"><a href="bayesian-models-of-cognition.html#cb424-11" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;          // Total social evidence (total signals)</span></span>
<span id="cb424-12"><a href="bayesian-models-of-cognition.html#cb424-12" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb424-13"><a href="bayesian-models-of-cognition.html#cb424-13" tabindex="-1"></a></span>
<span id="cb424-14"><a href="bayesian-models-of-cognition.html#cb424-14" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb424-15"><a href="bayesian-models-of-cognition.html#cb424-15" tabindex="-1"></a><span class="st">  // Each observation is a separate decision</span></span>
<span id="cb424-16"><a href="bayesian-models-of-cognition.html#cb424-16" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb424-17"><a href="bayesian-models-of-cognition.html#cb424-17" tabindex="-1"></a><span class="st">    // Calculate Beta parameters for this decision only (including a flat prior)</span></span>
<span id="cb424-18"><a href="bayesian-models-of-cognition.html#cb424-18" tabindex="-1"></a><span class="st">    real alpha_post = 1 + blue1[i] + blue2[i];</span></span>
<span id="cb424-19"><a href="bayesian-models-of-cognition.html#cb424-19" tabindex="-1"></a><span class="st">    real beta_post = 1 + (total1[i] - blue1[i]) + (total2[i] - blue2[i]);</span></span>
<span id="cb424-20"><a href="bayesian-models-of-cognition.html#cb424-20" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-21"><a href="bayesian-models-of-cognition.html#cb424-21" tabindex="-1"></a><span class="st">    // Expected probability for this specific decision</span></span>
<span id="cb424-22"><a href="bayesian-models-of-cognition.html#cb424-22" tabindex="-1"></a><span class="st">    real expected_prob = alpha_post / (alpha_post + beta_post);</span></span>
<span id="cb424-23"><a href="bayesian-models-of-cognition.html#cb424-23" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-24"><a href="bayesian-models-of-cognition.html#cb424-24" tabindex="-1"></a><span class="st">    // Model choice for this decision</span></span>
<span id="cb424-25"><a href="bayesian-models-of-cognition.html#cb424-25" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(choice[i] | expected_prob);</span></span>
<span id="cb424-26"><a href="bayesian-models-of-cognition.html#cb424-26" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb424-27"><a href="bayesian-models-of-cognition.html#cb424-27" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb424-28"><a href="bayesian-models-of-cognition.html#cb424-28" tabindex="-1"></a></span>
<span id="cb424-29"><a href="bayesian-models-of-cognition.html#cb424-29" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb424-30"><a href="bayesian-models-of-cognition.html#cb424-30" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb424-31"><a href="bayesian-models-of-cognition.html#cb424-31" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb424-32"><a href="bayesian-models-of-cognition.html#cb424-32" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb424-33"><a href="bayesian-models-of-cognition.html#cb424-33" tabindex="-1"></a><span class="st">  // Prior samples for model checking</span></span>
<span id="cb424-34"><a href="bayesian-models-of-cognition.html#cb424-34" tabindex="-1"></a><span class="st">  array[N] int prior_pred_choice;</span></span>
<span id="cb424-35"><a href="bayesian-models-of-cognition.html#cb424-35" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb424-36"><a href="bayesian-models-of-cognition.html#cb424-36" tabindex="-1"></a><span class="st">  // Predictive checks</span></span>
<span id="cb424-37"><a href="bayesian-models-of-cognition.html#cb424-37" tabindex="-1"></a><span class="st">  array[N] int posterior_pred_choice;</span></span>
<span id="cb424-38"><a href="bayesian-models-of-cognition.html#cb424-38" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb424-39"><a href="bayesian-models-of-cognition.html#cb424-39" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb424-40"><a href="bayesian-models-of-cognition.html#cb424-40" tabindex="-1"></a><span class="st">    // For prior predictions, use uniform prior (Beta(1,1))</span></span>
<span id="cb424-41"><a href="bayesian-models-of-cognition.html#cb424-41" tabindex="-1"></a><span class="st">    real prior_prob = 0.5;  // Expected value of Beta(1,1)</span></span>
<span id="cb424-42"><a href="bayesian-models-of-cognition.html#cb424-42" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-43"><a href="bayesian-models-of-cognition.html#cb424-43" tabindex="-1"></a><span class="st">    // For posterior predictions, use integrated evidence</span></span>
<span id="cb424-44"><a href="bayesian-models-of-cognition.html#cb424-44" tabindex="-1"></a><span class="st">    real alpha_post = 1 + blue1[i] + blue2[i];</span></span>
<span id="cb424-45"><a href="bayesian-models-of-cognition.html#cb424-45" tabindex="-1"></a><span class="st">    real beta_post = 1 + (total1[i] - blue1[i]) + (total2[i] - blue2[i]);</span></span>
<span id="cb424-46"><a href="bayesian-models-of-cognition.html#cb424-46" tabindex="-1"></a><span class="st">    real expected_prob = alpha_post / (alpha_post + beta_post);</span></span>
<span id="cb424-47"><a href="bayesian-models-of-cognition.html#cb424-47" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-48"><a href="bayesian-models-of-cognition.html#cb424-48" tabindex="-1"></a><span class="st">    // Generate predictions</span></span>
<span id="cb424-49"><a href="bayesian-models-of-cognition.html#cb424-49" tabindex="-1"></a><span class="st">    prior_pred_choice[i] = bernoulli_rng(prior_prob);</span></span>
<span id="cb424-50"><a href="bayesian-models-of-cognition.html#cb424-50" tabindex="-1"></a><span class="st">    posterior_pred_choice[i] = bernoulli_rng(expected_prob);</span></span>
<span id="cb424-51"><a href="bayesian-models-of-cognition.html#cb424-51" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-52"><a href="bayesian-models-of-cognition.html#cb424-52" tabindex="-1"></a><span class="st">    // Log likelihood calculation</span></span>
<span id="cb424-53"><a href="bayesian-models-of-cognition.html#cb424-53" tabindex="-1"></a><span class="st">    log_lik[i] = bernoulli_lpmf(choice[i] | expected_prob);</span></span>
<span id="cb424-54"><a href="bayesian-models-of-cognition.html#cb424-54" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb424-55"><a href="bayesian-models-of-cognition.html#cb424-55" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb424-56"><a href="bayesian-models-of-cognition.html#cb424-56" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb424-57"><a href="bayesian-models-of-cognition.html#cb424-57" tabindex="-1"></a></span>
<span id="cb424-58"><a href="bayesian-models-of-cognition.html#cb424-58" tabindex="-1"></a><span class="co"># Weighted Beta-Binomial Stan model</span></span>
<span id="cb424-59"><a href="bayesian-models-of-cognition.html#cb424-59" tabindex="-1"></a>WeightedAgent_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb424-60"><a href="bayesian-models-of-cognition.html#cb424-60" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb424-61"><a href="bayesian-models-of-cognition.html#cb424-61" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Number of decisions</span></span>
<span id="cb424-62"><a href="bayesian-models-of-cognition.html#cb424-62" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb424-63"><a href="bayesian-models-of-cognition.html#cb424-63" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles)</span></span>
<span id="cb424-64"><a href="bayesian-models-of-cognition.html#cb424-64" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;          // Total direct evidence</span></span>
<span id="cb424-65"><a href="bayesian-models-of-cognition.html#cb424-65" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals)</span></span>
<span id="cb424-66"><a href="bayesian-models-of-cognition.html#cb424-66" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;          // Total social evidence</span></span>
<span id="cb424-67"><a href="bayesian-models-of-cognition.html#cb424-67" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb424-68"><a href="bayesian-models-of-cognition.html#cb424-68" tabindex="-1"></a></span>
<span id="cb424-69"><a href="bayesian-models-of-cognition.html#cb424-69" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb424-70"><a href="bayesian-models-of-cognition.html#cb424-70" tabindex="-1"></a><span class="st">  // Using inverse logit for better numeric properties</span></span>
<span id="cb424-71"><a href="bayesian-models-of-cognition.html#cb424-71" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; weight_direct;           // Direct evidence weight</span></span>
<span id="cb424-72"><a href="bayesian-models-of-cognition.html#cb424-72" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; weight_social;           // Social evidence weight</span></span>
<span id="cb424-73"><a href="bayesian-models-of-cognition.html#cb424-73" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb424-74"><a href="bayesian-models-of-cognition.html#cb424-74" tabindex="-1"></a></span>
<span id="cb424-75"><a href="bayesian-models-of-cognition.html#cb424-75" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb424-76"><a href="bayesian-models-of-cognition.html#cb424-76" tabindex="-1"></a><span class="st">  // Priors</span></span>
<span id="cb424-77"><a href="bayesian-models-of-cognition.html#cb424-77" tabindex="-1"></a><span class="st">  target += normal_lpdf(weight_direct | 1, 0.3);  // Exponential prior with mean 1</span></span>
<span id="cb424-78"><a href="bayesian-models-of-cognition.html#cb424-78" tabindex="-1"></a><span class="st">  target += normal_lpdf(weight_social | 1, 0.3);  // Exponential prior with mean 1</span></span>
<span id="cb424-79"><a href="bayesian-models-of-cognition.html#cb424-79" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb424-80"><a href="bayesian-models-of-cognition.html#cb424-80" tabindex="-1"></a><span class="st">  // Each observation is a separate decision</span></span>
<span id="cb424-81"><a href="bayesian-models-of-cognition.html#cb424-81" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb424-82"><a href="bayesian-models-of-cognition.html#cb424-82" tabindex="-1"></a><span class="st">    // For this specific decision:</span></span>
<span id="cb424-83"><a href="bayesian-models-of-cognition.html#cb424-83" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * weight_direct;</span></span>
<span id="cb424-84"><a href="bayesian-models-of-cognition.html#cb424-84" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * weight_direct;</span></span>
<span id="cb424-85"><a href="bayesian-models-of-cognition.html#cb424-85" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * weight_social;</span></span>
<span id="cb424-86"><a href="bayesian-models-of-cognition.html#cb424-86" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * weight_social;</span></span>
<span id="cb424-87"><a href="bayesian-models-of-cognition.html#cb424-87" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-88"><a href="bayesian-models-of-cognition.html#cb424-88" tabindex="-1"></a><span class="st">    // Calculate Beta parameters for this decision only</span></span>
<span id="cb424-89"><a href="bayesian-models-of-cognition.html#cb424-89" tabindex="-1"></a><span class="st">    real alpha_post = 1 + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb424-90"><a href="bayesian-models-of-cognition.html#cb424-90" tabindex="-1"></a><span class="st">    real beta_post = 1 + weighted_red1 + weighted_red2;</span></span>
<span id="cb424-91"><a href="bayesian-models-of-cognition.html#cb424-91" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-92"><a href="bayesian-models-of-cognition.html#cb424-92" tabindex="-1"></a><span class="st">    // Expected probability for this specific decision</span></span>
<span id="cb424-93"><a href="bayesian-models-of-cognition.html#cb424-93" tabindex="-1"></a><span class="st">    real expected_prob = alpha_post / (alpha_post + beta_post);</span></span>
<span id="cb424-94"><a href="bayesian-models-of-cognition.html#cb424-94" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-95"><a href="bayesian-models-of-cognition.html#cb424-95" tabindex="-1"></a><span class="st">    // Model choice for this decision</span></span>
<span id="cb424-96"><a href="bayesian-models-of-cognition.html#cb424-96" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(choice[i] | expected_prob);</span></span>
<span id="cb424-97"><a href="bayesian-models-of-cognition.html#cb424-97" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb424-98"><a href="bayesian-models-of-cognition.html#cb424-98" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb424-99"><a href="bayesian-models-of-cognition.html#cb424-99" tabindex="-1"></a></span>
<span id="cb424-100"><a href="bayesian-models-of-cognition.html#cb424-100" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb424-101"><a href="bayesian-models-of-cognition.html#cb424-101" tabindex="-1"></a><span class="st">  // Log likelihood and predictions</span></span>
<span id="cb424-102"><a href="bayesian-models-of-cognition.html#cb424-102" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb424-103"><a href="bayesian-models-of-cognition.html#cb424-103" tabindex="-1"></a><span class="st">  array[N] int posterior_pred_choice;</span></span>
<span id="cb424-104"><a href="bayesian-models-of-cognition.html#cb424-104" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb424-105"><a href="bayesian-models-of-cognition.html#cb424-105" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb424-106"><a href="bayesian-models-of-cognition.html#cb424-106" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * weight_direct;</span></span>
<span id="cb424-107"><a href="bayesian-models-of-cognition.html#cb424-107" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * weight_direct;</span></span>
<span id="cb424-108"><a href="bayesian-models-of-cognition.html#cb424-108" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * weight_social;</span></span>
<span id="cb424-109"><a href="bayesian-models-of-cognition.html#cb424-109" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * weight_social;</span></span>
<span id="cb424-110"><a href="bayesian-models-of-cognition.html#cb424-110" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-111"><a href="bayesian-models-of-cognition.html#cb424-111" tabindex="-1"></a><span class="st">    real alpha_post = 1 + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb424-112"><a href="bayesian-models-of-cognition.html#cb424-112" tabindex="-1"></a><span class="st">    real beta_post = 1 + weighted_red1 + weighted_red2;</span></span>
<span id="cb424-113"><a href="bayesian-models-of-cognition.html#cb424-113" tabindex="-1"></a><span class="st">    real expected_prob = alpha_post / (alpha_post + beta_post);</span></span>
<span id="cb424-114"><a href="bayesian-models-of-cognition.html#cb424-114" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb424-115"><a href="bayesian-models-of-cognition.html#cb424-115" tabindex="-1"></a><span class="st">    log_lik[i] = bernoulli_lpmf(choice[i] | expected_prob);</span></span>
<span id="cb424-116"><a href="bayesian-models-of-cognition.html#cb424-116" tabindex="-1"></a><span class="st">    posterior_pred_choice[i] = bernoulli_rng(expected_prob);</span></span>
<span id="cb424-117"><a href="bayesian-models-of-cognition.html#cb424-117" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb424-118"><a href="bayesian-models-of-cognition.html#cb424-118" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb424-119"><a href="bayesian-models-of-cognition.html#cb424-119" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb424-120"><a href="bayesian-models-of-cognition.html#cb424-120" tabindex="-1"></a></span>
<span id="cb424-121"><a href="bayesian-models-of-cognition.html#cb424-121" tabindex="-1"></a><span class="co"># Write the models to files</span></span>
<span id="cb424-122"><a href="bayesian-models-of-cognition.html#cb424-122" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb424-123"><a href="bayesian-models-of-cognition.html#cb424-123" tabindex="-1"></a>  SimpleAgent_stan,</span>
<span id="cb424-124"><a href="bayesian-models-of-cognition.html#cb424-124" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb424-125"><a href="bayesian-models-of-cognition.html#cb424-125" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W9_beta_binomial.stan&quot;</span></span>
<span id="cb424-126"><a href="bayesian-models-of-cognition.html#cb424-126" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W9_beta_binomial.stan&quot;</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="bayesian-models-of-cognition.html#cb426-1" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb426-2"><a href="bayesian-models-of-cognition.html#cb426-2" tabindex="-1"></a>  WeightedAgent_stan,</span>
<span id="cb426-3"><a href="bayesian-models-of-cognition.html#cb426-3" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb426-4"><a href="bayesian-models-of-cognition.html#cb426-4" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W9_weighted_beta_binomial.stan&quot;</span></span>
<span id="cb426-5"><a href="bayesian-models-of-cognition.html#cb426-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W9_weighted_beta_binomial.stan&quot;</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="bayesian-models-of-cognition.html#cb428-1" tabindex="-1"></a><span class="co"># Prepare simulation data for Stan fitting</span></span>
<span id="cb428-2"><a href="bayesian-models-of-cognition.html#cb428-2" tabindex="-1"></a><span class="co"># Convert &#39;Blue&#39; and &#39;Red&#39; choices to binary format (1 for Blue, 0 for Red)</span></span>
<span id="cb428-3"><a href="bayesian-models-of-cognition.html#cb428-3" tabindex="-1"></a>sim_data_for_stan <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb428-4"><a href="bayesian-models-of-cognition.html#cb428-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb428-5"><a href="bayesian-models-of-cognition.html#cb428-5" tabindex="-1"></a>    <span class="at">choice_binary =</span> <span class="fu">as.integer</span>(choice <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>),</span>
<span id="cb428-6"><a href="bayesian-models-of-cognition.html#cb428-6" tabindex="-1"></a>    <span class="at">total1 =</span> <span class="dv">8</span>,  <span class="co"># Total marbles in direct evidence (constant)</span></span>
<span id="cb428-7"><a href="bayesian-models-of-cognition.html#cb428-7" tabindex="-1"></a>    <span class="at">total2 =</span> <span class="dv">3</span>   <span class="co"># Total signals in social evidence (constant)</span></span>
<span id="cb428-8"><a href="bayesian-models-of-cognition.html#cb428-8" tabindex="-1"></a>  )</span>
<span id="cb428-9"><a href="bayesian-models-of-cognition.html#cb428-9" tabindex="-1"></a></span>
<span id="cb428-10"><a href="bayesian-models-of-cognition.html#cb428-10" tabindex="-1"></a><span class="co"># Split data by agent type</span></span>
<span id="cb428-11"><a href="bayesian-models-of-cognition.html#cb428-11" tabindex="-1"></a>balanced_data <span class="ot">&lt;-</span> sim_data_for_stan <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_type <span class="sc">==</span> <span class="st">&quot;Balanced&quot;</span>)</span>
<span id="cb428-12"><a href="bayesian-models-of-cognition.html#cb428-12" tabindex="-1"></a>self_focused_data <span class="ot">&lt;-</span> sim_data_for_stan <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_type <span class="sc">==</span> <span class="st">&quot;Self-Focused&quot;</span>)</span>
<span id="cb428-13"><a href="bayesian-models-of-cognition.html#cb428-13" tabindex="-1"></a>socially_influenced_data <span class="ot">&lt;-</span> sim_data_for_stan <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_type <span class="sc">==</span> <span class="st">&quot;Socially-Influenced&quot;</span>)</span>
<span id="cb428-14"><a href="bayesian-models-of-cognition.html#cb428-14" tabindex="-1"></a></span>
<span id="cb428-15"><a href="bayesian-models-of-cognition.html#cb428-15" tabindex="-1"></a><span class="co"># Function to prepare data for Stan</span></span>
<span id="cb428-16"><a href="bayesian-models-of-cognition.html#cb428-16" tabindex="-1"></a>prepare_stan_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb428-17"><a href="bayesian-models-of-cognition.html#cb428-17" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb428-18"><a href="bayesian-models-of-cognition.html#cb428-18" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb428-19"><a href="bayesian-models-of-cognition.html#cb428-19" tabindex="-1"></a>    <span class="at">choice =</span> df<span class="sc">$</span>choice_binary,</span>
<span id="cb428-20"><a href="bayesian-models-of-cognition.html#cb428-20" tabindex="-1"></a>    <span class="at">blue1 =</span> df<span class="sc">$</span>blue1,</span>
<span id="cb428-21"><a href="bayesian-models-of-cognition.html#cb428-21" tabindex="-1"></a>    <span class="at">total1 =</span> df<span class="sc">$</span>total1,</span>
<span id="cb428-22"><a href="bayesian-models-of-cognition.html#cb428-22" tabindex="-1"></a>    <span class="at">blue2 =</span> df<span class="sc">$</span>blue2,</span>
<span id="cb428-23"><a href="bayesian-models-of-cognition.html#cb428-23" tabindex="-1"></a>    <span class="at">total2 =</span> df<span class="sc">$</span>total2</span>
<span id="cb428-24"><a href="bayesian-models-of-cognition.html#cb428-24" tabindex="-1"></a>  )</span>
<span id="cb428-25"><a href="bayesian-models-of-cognition.html#cb428-25" tabindex="-1"></a>}</span>
<span id="cb428-26"><a href="bayesian-models-of-cognition.html#cb428-26" tabindex="-1"></a></span>
<span id="cb428-27"><a href="bayesian-models-of-cognition.html#cb428-27" tabindex="-1"></a><span class="co"># Prepare Stan data for each agent</span></span>
<span id="cb428-28"><a href="bayesian-models-of-cognition.html#cb428-28" tabindex="-1"></a>stan_data_balanced <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(balanced_data)</span>
<span id="cb428-29"><a href="bayesian-models-of-cognition.html#cb428-29" tabindex="-1"></a>stan_data_self_focused <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(self_focused_data)</span>
<span id="cb428-30"><a href="bayesian-models-of-cognition.html#cb428-30" tabindex="-1"></a>stan_data_socially_influenced <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(socially_influenced_data)</span>
<span id="cb428-31"><a href="bayesian-models-of-cognition.html#cb428-31" tabindex="-1"></a></span>
<span id="cb428-32"><a href="bayesian-models-of-cognition.html#cb428-32" tabindex="-1"></a><span class="co"># Compile the Stan models</span></span>
<span id="cb428-33"><a href="bayesian-models-of-cognition.html#cb428-33" tabindex="-1"></a>file_simple <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W9_beta_binomial.stan&quot;</span>)</span>
<span id="cb428-34"><a href="bayesian-models-of-cognition.html#cb428-34" tabindex="-1"></a>file_weighted <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W9_weighted_beta_binomial.stan&quot;</span>)</span>
<span id="cb428-35"><a href="bayesian-models-of-cognition.html#cb428-35" tabindex="-1"></a></span>
<span id="cb428-36"><a href="bayesian-models-of-cognition.html#cb428-36" tabindex="-1"></a><span class="co"># Check if we need to regenerate simulation results</span></span>
<span id="cb428-37"><a href="bayesian-models-of-cognition.html#cb428-37" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb428-38"><a href="bayesian-models-of-cognition.html#cb428-38" tabindex="-1"></a>  <span class="co"># Compile models</span></span>
<span id="cb428-39"><a href="bayesian-models-of-cognition.html#cb428-39" tabindex="-1"></a>  mod_simple <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_simple, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb428-40"><a href="bayesian-models-of-cognition.html#cb428-40" tabindex="-1"></a>  mod_weighted <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_weighted, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb428-41"><a href="bayesian-models-of-cognition.html#cb428-41" tabindex="-1"></a>  </span>
<span id="cb428-42"><a href="bayesian-models-of-cognition.html#cb428-42" tabindex="-1"></a>  <span class="co"># Fit simple model to each agent&#39;s data</span></span>
<span id="cb428-43"><a href="bayesian-models-of-cognition.html#cb428-43" tabindex="-1"></a>  fit_simple_balanced <span class="ot">&lt;-</span> mod_simple<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb428-44"><a href="bayesian-models-of-cognition.html#cb428-44" tabindex="-1"></a>    <span class="at">data =</span> stan_data_balanced,</span>
<span id="cb428-45"><a href="bayesian-models-of-cognition.html#cb428-45" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb428-46"><a href="bayesian-models-of-cognition.html#cb428-46" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-47"><a href="bayesian-models-of-cognition.html#cb428-47" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-48"><a href="bayesian-models-of-cognition.html#cb428-48" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb428-49"><a href="bayesian-models-of-cognition.html#cb428-49" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb428-50"><a href="bayesian-models-of-cognition.html#cb428-50" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb428-51"><a href="bayesian-models-of-cognition.html#cb428-51" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span>  <span class="co"># Set to 500 or so to see progress</span></span>
<span id="cb428-52"><a href="bayesian-models-of-cognition.html#cb428-52" tabindex="-1"></a>  )</span>
<span id="cb428-53"><a href="bayesian-models-of-cognition.html#cb428-53" tabindex="-1"></a>  </span>
<span id="cb428-54"><a href="bayesian-models-of-cognition.html#cb428-54" tabindex="-1"></a>  fit_simple_self_focused <span class="ot">&lt;-</span> mod_simple<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb428-55"><a href="bayesian-models-of-cognition.html#cb428-55" tabindex="-1"></a>    <span class="at">data =</span> stan_data_self_focused,</span>
<span id="cb428-56"><a href="bayesian-models-of-cognition.html#cb428-56" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">124</span>,</span>
<span id="cb428-57"><a href="bayesian-models-of-cognition.html#cb428-57" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-58"><a href="bayesian-models-of-cognition.html#cb428-58" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-59"><a href="bayesian-models-of-cognition.html#cb428-59" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb428-60"><a href="bayesian-models-of-cognition.html#cb428-60" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb428-61"><a href="bayesian-models-of-cognition.html#cb428-61" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb428-62"><a href="bayesian-models-of-cognition.html#cb428-62" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb428-63"><a href="bayesian-models-of-cognition.html#cb428-63" tabindex="-1"></a>  )</span>
<span id="cb428-64"><a href="bayesian-models-of-cognition.html#cb428-64" tabindex="-1"></a>  </span>
<span id="cb428-65"><a href="bayesian-models-of-cognition.html#cb428-65" tabindex="-1"></a>  fit_simple_socially_influenced <span class="ot">&lt;-</span> mod_simple<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb428-66"><a href="bayesian-models-of-cognition.html#cb428-66" tabindex="-1"></a>    <span class="at">data =</span> stan_data_socially_influenced,</span>
<span id="cb428-67"><a href="bayesian-models-of-cognition.html#cb428-67" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">125</span>,</span>
<span id="cb428-68"><a href="bayesian-models-of-cognition.html#cb428-68" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-69"><a href="bayesian-models-of-cognition.html#cb428-69" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-70"><a href="bayesian-models-of-cognition.html#cb428-70" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb428-71"><a href="bayesian-models-of-cognition.html#cb428-71" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb428-72"><a href="bayesian-models-of-cognition.html#cb428-72" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb428-73"><a href="bayesian-models-of-cognition.html#cb428-73" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb428-74"><a href="bayesian-models-of-cognition.html#cb428-74" tabindex="-1"></a>  )</span>
<span id="cb428-75"><a href="bayesian-models-of-cognition.html#cb428-75" tabindex="-1"></a>  </span>
<span id="cb428-76"><a href="bayesian-models-of-cognition.html#cb428-76" tabindex="-1"></a>  <span class="co"># Fit weighted model to each agent&#39;s data</span></span>
<span id="cb428-77"><a href="bayesian-models-of-cognition.html#cb428-77" tabindex="-1"></a>  fit_weighted_balanced <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb428-78"><a href="bayesian-models-of-cognition.html#cb428-78" tabindex="-1"></a>    <span class="at">data =</span> stan_data_balanced,</span>
<span id="cb428-79"><a href="bayesian-models-of-cognition.html#cb428-79" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">126</span>,</span>
<span id="cb428-80"><a href="bayesian-models-of-cognition.html#cb428-80" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-81"><a href="bayesian-models-of-cognition.html#cb428-81" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-82"><a href="bayesian-models-of-cognition.html#cb428-82" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb428-83"><a href="bayesian-models-of-cognition.html#cb428-83" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb428-84"><a href="bayesian-models-of-cognition.html#cb428-84" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb428-85"><a href="bayesian-models-of-cognition.html#cb428-85" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb428-86"><a href="bayesian-models-of-cognition.html#cb428-86" tabindex="-1"></a>  )</span>
<span id="cb428-87"><a href="bayesian-models-of-cognition.html#cb428-87" tabindex="-1"></a>  </span>
<span id="cb428-88"><a href="bayesian-models-of-cognition.html#cb428-88" tabindex="-1"></a>  fit_weighted_self_focused <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb428-89"><a href="bayesian-models-of-cognition.html#cb428-89" tabindex="-1"></a>    <span class="at">data =</span> stan_data_self_focused,</span>
<span id="cb428-90"><a href="bayesian-models-of-cognition.html#cb428-90" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">127</span>,</span>
<span id="cb428-91"><a href="bayesian-models-of-cognition.html#cb428-91" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-92"><a href="bayesian-models-of-cognition.html#cb428-92" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-93"><a href="bayesian-models-of-cognition.html#cb428-93" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb428-94"><a href="bayesian-models-of-cognition.html#cb428-94" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb428-95"><a href="bayesian-models-of-cognition.html#cb428-95" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb428-96"><a href="bayesian-models-of-cognition.html#cb428-96" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb428-97"><a href="bayesian-models-of-cognition.html#cb428-97" tabindex="-1"></a>  )</span>
<span id="cb428-98"><a href="bayesian-models-of-cognition.html#cb428-98" tabindex="-1"></a>  </span>
<span id="cb428-99"><a href="bayesian-models-of-cognition.html#cb428-99" tabindex="-1"></a>  fit_weighted_socially_influenced <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb428-100"><a href="bayesian-models-of-cognition.html#cb428-100" tabindex="-1"></a>    <span class="at">data =</span> stan_data_socially_influenced,</span>
<span id="cb428-101"><a href="bayesian-models-of-cognition.html#cb428-101" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">128</span>,</span>
<span id="cb428-102"><a href="bayesian-models-of-cognition.html#cb428-102" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-103"><a href="bayesian-models-of-cognition.html#cb428-103" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb428-104"><a href="bayesian-models-of-cognition.html#cb428-104" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb428-105"><a href="bayesian-models-of-cognition.html#cb428-105" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb428-106"><a href="bayesian-models-of-cognition.html#cb428-106" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb428-107"><a href="bayesian-models-of-cognition.html#cb428-107" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb428-108"><a href="bayesian-models-of-cognition.html#cb428-108" tabindex="-1"></a>  )</span>
<span id="cb428-109"><a href="bayesian-models-of-cognition.html#cb428-109" tabindex="-1"></a>  </span>
<span id="cb428-110"><a href="bayesian-models-of-cognition.html#cb428-110" tabindex="-1"></a>  <span class="co"># Save model fits for future use</span></span>
<span id="cb428-111"><a href="bayesian-models-of-cognition.html#cb428-111" tabindex="-1"></a>  fit_simple_balanced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_simple_balanced.rds&quot;</span>)</span>
<span id="cb428-112"><a href="bayesian-models-of-cognition.html#cb428-112" tabindex="-1"></a>  fit_simple_self_focused<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_simple_self_focused.rds&quot;</span>)</span>
<span id="cb428-113"><a href="bayesian-models-of-cognition.html#cb428-113" tabindex="-1"></a>  fit_simple_socially_influenced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_simple_socially_influenced.rds&quot;</span>)</span>
<span id="cb428-114"><a href="bayesian-models-of-cognition.html#cb428-114" tabindex="-1"></a>  fit_weighted_balanced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_weighted_balanced.rds&quot;</span>)</span>
<span id="cb428-115"><a href="bayesian-models-of-cognition.html#cb428-115" tabindex="-1"></a>  fit_weighted_self_focused<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_weighted_self_focused.rds&quot;</span>)</span>
<span id="cb428-116"><a href="bayesian-models-of-cognition.html#cb428-116" tabindex="-1"></a>  fit_weighted_socially_influenced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_weighted_socially_influenced.rds&quot;</span>)</span>
<span id="cb428-117"><a href="bayesian-models-of-cognition.html#cb428-117" tabindex="-1"></a>  </span>
<span id="cb428-118"><a href="bayesian-models-of-cognition.html#cb428-118" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Generated and saved new model fits</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb428-119"><a href="bayesian-models-of-cognition.html#cb428-119" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb428-120"><a href="bayesian-models-of-cognition.html#cb428-120" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb428-121"><a href="bayesian-models-of-cognition.html#cb428-121" tabindex="-1"></a>  fit_simple_balanced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_simple_balanced.rds&quot;</span>)</span>
<span id="cb428-122"><a href="bayesian-models-of-cognition.html#cb428-122" tabindex="-1"></a>  fit_simple_self_focused <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_simple_self_focused.rds&quot;</span>)</span>
<span id="cb428-123"><a href="bayesian-models-of-cognition.html#cb428-123" tabindex="-1"></a>  fit_simple_socially_influenced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_simple_socially_influenced.rds&quot;</span>)</span>
<span id="cb428-124"><a href="bayesian-models-of-cognition.html#cb428-124" tabindex="-1"></a>  fit_weighted_balanced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_weighted_balanced.rds&quot;</span>)</span>
<span id="cb428-125"><a href="bayesian-models-of-cognition.html#cb428-125" tabindex="-1"></a>  fit_weighted_self_focused <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_weighted_self_focused.rds&quot;</span>)</span>
<span id="cb428-126"><a href="bayesian-models-of-cognition.html#cb428-126" tabindex="-1"></a>  fit_weighted_socially_influenced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_weighted_socially_influenced.rds&quot;</span>)</span>
<span id="cb428-127"><a href="bayesian-models-of-cognition.html#cb428-127" tabindex="-1"></a>  </span>
<span id="cb428-128"><a href="bayesian-models-of-cognition.html#cb428-128" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb428-129"><a href="bayesian-models-of-cognition.html#cb428-129" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.0 seconds.
## Chain 2 finished in 0.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.0 seconds.
## Total execution time: 0.4 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.0 seconds.
## Chain 2 finished in 0.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.0 seconds.
## Total execution time: 0.5 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.0 seconds.
## Chain 2 finished in 0.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.0 seconds.
## Total execution time: 0.5 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...</code></pre>
<pre><code>## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.5 seconds.
## 
## Generated and saved new model fits</code></pre>
</div>
<div id="model-quality-checks" class="section level2 hasAnchor" number="10.14">
<h2><span class="header-section-number">10.14</span> Model Quality Checks<a href="bayesian-models-of-cognition.html#model-quality-checks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="overview" class="section level3 hasAnchor" number="10.14.1">
<h3><span class="header-section-number">10.14.1</span> Overview<a href="bayesian-models-of-cognition.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Model quality checks are crucial for understanding how well our Bayesian models capture the underlying data-generating process. We’ll use three primary techniques:</p>
<ol style="list-style-type: decimal">
<li>Prior Predictive Checks</li>
<li>Posterior Predictive Checks</li>
<li>Prior-Posterior Update Visualization</li>
</ol>
</div>
<div id="prior-and-posterior-predictive-checks" class="section level3 hasAnchor" number="10.14.2">
<h3><span class="header-section-number">10.14.2</span> Prior and Posterior Predictive Checks<a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prior predictive checks help us understand what our model assumes about the world before seeing any data. They answer the question: “What kind of data would we expect to see if we only used our prior beliefs?” Posterior predictive checks are the same, but after having seen the data. This helps us assess whether the model can generate data that looks similar to our observed data.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="bayesian-models-of-cognition.html#cb434-1" tabindex="-1"></a>plot_predictive_checks <span class="ot">&lt;-</span> <span class="cf">function</span>(stan_fit, </span>
<span id="cb434-2"><a href="bayesian-models-of-cognition.html#cb434-2" tabindex="-1"></a>                                   simulation_results, </span>
<span id="cb434-3"><a href="bayesian-models-of-cognition.html#cb434-3" tabindex="-1"></a>                                   <span class="at">model_name =</span> <span class="st">&quot;Simple Balanced&quot;</span>, </span>
<span id="cb434-4"><a href="bayesian-models-of-cognition.html#cb434-4" tabindex="-1"></a>                                   <span class="at">param_name =</span> <span class="st">&quot;prior_pred_choice&quot;</span>) {</span>
<span id="cb434-5"><a href="bayesian-models-of-cognition.html#cb434-5" tabindex="-1"></a>  <span class="co"># Extract predictive samples</span></span>
<span id="cb434-6"><a href="bayesian-models-of-cognition.html#cb434-6" tabindex="-1"></a>  pred_samples <span class="ot">&lt;-</span> stan_fit<span class="sc">$</span><span class="fu">draws</span>(param_name, <span class="at">format =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb434-7"><a href="bayesian-models-of-cognition.html#cb434-7" tabindex="-1"></a>  </span>
<span id="cb434-8"><a href="bayesian-models-of-cognition.html#cb434-8" tabindex="-1"></a>  <span class="co"># Get the number of samples and observations</span></span>
<span id="cb434-9"><a href="bayesian-models-of-cognition.html#cb434-9" tabindex="-1"></a>  n_samples <span class="ot">&lt;-</span> <span class="fu">nrow</span>(pred_samples)</span>
<span id="cb434-10"><a href="bayesian-models-of-cognition.html#cb434-10" tabindex="-1"></a>  n_obs <span class="ot">&lt;-</span> <span class="fu">ncol</span>(pred_samples) <span class="sc">-</span> <span class="dv">3</span>  <span class="co"># Subtract chain, iteration, and draw columns</span></span>
<span id="cb434-11"><a href="bayesian-models-of-cognition.html#cb434-11" tabindex="-1"></a>  </span>
<span id="cb434-12"><a href="bayesian-models-of-cognition.html#cb434-12" tabindex="-1"></a>  <span class="co"># Convert to long format</span></span>
<span id="cb434-13"><a href="bayesian-models-of-cognition.html#cb434-13" tabindex="-1"></a>  long_pred <span class="ot">&lt;-</span> pred_samples <span class="sc">%&gt;%</span></span>
<span id="cb434-14"><a href="bayesian-models-of-cognition.html#cb434-14" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.chain, <span class="sc">-</span>.iteration, <span class="sc">-</span>.draw) <span class="sc">%&gt;%</span>  <span class="co"># Remove metadata columns</span></span>
<span id="cb434-15"><a href="bayesian-models-of-cognition.html#cb434-15" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb434-16"><a href="bayesian-models-of-cognition.html#cb434-16" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb434-17"><a href="bayesian-models-of-cognition.html#cb434-17" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">&quot;obs_id&quot;</span>,</span>
<span id="cb434-18"><a href="bayesian-models-of-cognition.html#cb434-18" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">&quot;choice&quot;</span></span>
<span id="cb434-19"><a href="bayesian-models-of-cognition.html#cb434-19" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb434-20"><a href="bayesian-models-of-cognition.html#cb434-20" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">obs_id =</span> <span class="fu">parse_number</span>(obs_id))  <span class="co"># Extract observation number</span></span>
<span id="cb434-21"><a href="bayesian-models-of-cognition.html#cb434-21" tabindex="-1"></a>  </span>
<span id="cb434-22"><a href="bayesian-models-of-cognition.html#cb434-22" tabindex="-1"></a>  <span class="co"># Join with the original simulation data to get evidence levels</span></span>
<span id="cb434-23"><a href="bayesian-models-of-cognition.html#cb434-23" tabindex="-1"></a>  <span class="co"># First, add an observation ID to the simulation data</span></span>
<span id="cb434-24"><a href="bayesian-models-of-cognition.html#cb434-24" tabindex="-1"></a>  sim_with_id <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb434-25"><a href="bayesian-models-of-cognition.html#cb434-25" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">obs_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb434-26"><a href="bayesian-models-of-cognition.html#cb434-26" tabindex="-1"></a>  </span>
<span id="cb434-27"><a href="bayesian-models-of-cognition.html#cb434-27" tabindex="-1"></a>  <span class="co"># Join predictions with evidence levels</span></span>
<span id="cb434-28"><a href="bayesian-models-of-cognition.html#cb434-28" tabindex="-1"></a>  long_pred_with_evidence <span class="ot">&lt;-</span> long_pred <span class="sc">%&gt;%</span></span>
<span id="cb434-29"><a href="bayesian-models-of-cognition.html#cb434-29" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb434-30"><a href="bayesian-models-of-cognition.html#cb434-30" tabindex="-1"></a>      sim_with_id <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(obs_id, blue1, blue2),</span>
<span id="cb434-31"><a href="bayesian-models-of-cognition.html#cb434-31" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">&quot;obs_id&quot;</span></span>
<span id="cb434-32"><a href="bayesian-models-of-cognition.html#cb434-32" tabindex="-1"></a>    )</span>
<span id="cb434-33"><a href="bayesian-models-of-cognition.html#cb434-33" tabindex="-1"></a>  </span>
<span id="cb434-34"><a href="bayesian-models-of-cognition.html#cb434-34" tabindex="-1"></a>  <span class="co"># Summarize proportion of 1s per evidence combination</span></span>
<span id="cb434-35"><a href="bayesian-models-of-cognition.html#cb434-35" tabindex="-1"></a>  pred_summary <span class="ot">&lt;-</span> long_pred_with_evidence <span class="sc">%&gt;%</span></span>
<span id="cb434-36"><a href="bayesian-models-of-cognition.html#cb434-36" tabindex="-1"></a>    <span class="fu">group_by</span>(blue1, blue2) <span class="sc">%&gt;%</span></span>
<span id="cb434-37"><a href="bayesian-models-of-cognition.html#cb434-37" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb434-38"><a href="bayesian-models-of-cognition.html#cb434-38" tabindex="-1"></a>      <span class="at">proportion =</span> <span class="fu">mean</span>(choice, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb434-39"><a href="bayesian-models-of-cognition.html#cb434-39" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>(),  </span>
<span id="cb434-40"><a href="bayesian-models-of-cognition.html#cb434-40" tabindex="-1"></a>      <span class="at">se =</span> <span class="fu">sqrt</span>((proportion <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> proportion)) <span class="sc">/</span> n),  <span class="co"># Binomial SE</span></span>
<span id="cb434-41"><a href="bayesian-models-of-cognition.html#cb434-41" tabindex="-1"></a>      <span class="at">lower =</span> proportion <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,  </span>
<span id="cb434-42"><a href="bayesian-models-of-cognition.html#cb434-42" tabindex="-1"></a>      <span class="at">upper =</span> proportion <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se,  </span>
<span id="cb434-43"><a href="bayesian-models-of-cognition.html#cb434-43" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb434-44"><a href="bayesian-models-of-cognition.html#cb434-44" tabindex="-1"></a>    )</span>
<span id="cb434-45"><a href="bayesian-models-of-cognition.html#cb434-45" tabindex="-1"></a></span>
<span id="cb434-46"><a href="bayesian-models-of-cognition.html#cb434-46" tabindex="-1"></a>  <span class="co"># Generate title based on parameter name</span></span>
<span id="cb434-47"><a href="bayesian-models-of-cognition.html#cb434-47" tabindex="-1"></a>  title <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(param_name <span class="sc">==</span> <span class="st">&quot;prior_pred_choice&quot;</span>, </span>
<span id="cb434-48"><a href="bayesian-models-of-cognition.html#cb434-48" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">&quot;Prior Predictive Check for &quot;</span>, model_name),</span>
<span id="cb434-49"><a href="bayesian-models-of-cognition.html#cb434-49" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">&quot;Posterior Predictive Check for &quot;</span>, model_name))</span>
<span id="cb434-50"><a href="bayesian-models-of-cognition.html#cb434-50" tabindex="-1"></a>  </span>
<span id="cb434-51"><a href="bayesian-models-of-cognition.html#cb434-51" tabindex="-1"></a>  <span class="co"># Create plot</span></span>
<span id="cb434-52"><a href="bayesian-models-of-cognition.html#cb434-52" tabindex="-1"></a>  <span class="fu">ggplot</span>(pred_summary, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> proportion, <span class="at">color =</span> <span class="fu">factor</span>(blue2), <span class="at">group =</span> blue2)) <span class="sc">+</span></span>
<span id="cb434-53"><a href="bayesian-models-of-cognition.html#cb434-53" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb434-54"><a href="bayesian-models-of-cognition.html#cb434-54" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb434-55"><a href="bayesian-models-of-cognition.html#cb434-55" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, <span class="at">fill =</span> <span class="fu">factor</span>(blue2)), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb434-56"><a href="bayesian-models-of-cognition.html#cb434-56" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb434-57"><a href="bayesian-models-of-cognition.html#cb434-57" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title,</span>
<span id="cb434-58"><a href="bayesian-models-of-cognition.html#cb434-58" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Direct Evidence (Blue Marbles)&quot;</span>,</span>
<span id="cb434-59"><a href="bayesian-models-of-cognition.html#cb434-59" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion of Choice = Blue&quot;</span>,</span>
<span id="cb434-60"><a href="bayesian-models-of-cognition.html#cb434-60" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span>,</span>
<span id="cb434-61"><a href="bayesian-models-of-cognition.html#cb434-61" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Social Evidence&quot;</span>) <span class="sc">+</span></span>
<span id="cb434-62"><a href="bayesian-models-of-cognition.html#cb434-62" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb434-63"><a href="bayesian-models-of-cognition.html#cb434-63" tabindex="-1"></a>}</span>
<span id="cb434-64"><a href="bayesian-models-of-cognition.html#cb434-64" tabindex="-1"></a></span>
<span id="cb434-65"><a href="bayesian-models-of-cognition.html#cb434-65" tabindex="-1"></a><span class="co"># Generate all plots</span></span>
<span id="cb434-66"><a href="bayesian-models-of-cognition.html#cb434-66" tabindex="-1"></a>prior_simple_balanced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_balanced, simulation_results, <span class="st">&quot;Simple Balanced&quot;</span>, <span class="st">&quot;prior_pred_choice&quot;</span>)</span>
<span id="cb434-67"><a href="bayesian-models-of-cognition.html#cb434-67" tabindex="-1"></a>prior_simple_self_focused <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_self_focused, simulation_results, <span class="st">&quot;Simple Self Focused&quot;</span>, <span class="st">&quot;prior_pred_choice&quot;</span>)</span>
<span id="cb434-68"><a href="bayesian-models-of-cognition.html#cb434-68" tabindex="-1"></a>prior_simple_socially_influenced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_socially_influenced, simulation_results, <span class="st">&quot;Simple Socially Influenced&quot;</span>, <span class="st">&quot;prior_pred_choice&quot;</span>)</span>
<span id="cb434-69"><a href="bayesian-models-of-cognition.html#cb434-69" tabindex="-1"></a></span>
<span id="cb434-70"><a href="bayesian-models-of-cognition.html#cb434-70" tabindex="-1"></a><span class="co">#prior_weighted_balanced &lt;- plot_predictive_checks(fit_weighted_balanced, simulation_results, &quot;Weighted Balanced&quot;, &quot;prior_pred_choice&quot;)</span></span>
<span id="cb434-71"><a href="bayesian-models-of-cognition.html#cb434-71" tabindex="-1"></a><span class="co">#prior_weighted_self_focused &lt;- plot_predictive_checks(fit_weighted_self_focused, simulation_results, &quot;Weighted Self Focused&quot;, &quot;prior_pred_choice&quot;)</span></span>
<span id="cb434-72"><a href="bayesian-models-of-cognition.html#cb434-72" tabindex="-1"></a><span class="co">#prior_weighted_socially_influenced &lt;- plot_predictive_checks(fit_weighted_socially_influenced, simulation_results, &quot;Weighted Socially Influenced&quot;, &quot;prior_pred_choice&quot;)</span></span>
<span id="cb434-73"><a href="bayesian-models-of-cognition.html#cb434-73" tabindex="-1"></a></span>
<span id="cb434-74"><a href="bayesian-models-of-cognition.html#cb434-74" tabindex="-1"></a>posterior_simple_balanced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_balanced, simulation_results, <span class="st">&quot;Simple Balanced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb434-75"><a href="bayesian-models-of-cognition.html#cb434-75" tabindex="-1"></a>posterior_simple_self_focused <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_self_focused, simulation_results, <span class="st">&quot;Simple Self Focused&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb434-76"><a href="bayesian-models-of-cognition.html#cb434-76" tabindex="-1"></a>posterior_simple_socially_influenced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_socially_influenced, simulation_results, <span class="st">&quot;Simple Socially Influenced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb434-77"><a href="bayesian-models-of-cognition.html#cb434-77" tabindex="-1"></a></span>
<span id="cb434-78"><a href="bayesian-models-of-cognition.html#cb434-78" tabindex="-1"></a>posterior_weighted_balanced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_weighted_balanced, simulation_results, <span class="st">&quot;Weighted Balanced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb434-79"><a href="bayesian-models-of-cognition.html#cb434-79" tabindex="-1"></a>posterior_weighted_self_focused <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_weighted_self_focused, simulation_results, <span class="st">&quot;Weighted Self Focused&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb434-80"><a href="bayesian-models-of-cognition.html#cb434-80" tabindex="-1"></a>posterior_weighted_socially_influenced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_weighted_socially_influenced, simulation_results, <span class="st">&quot;Weighted Socially Influenced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb434-81"><a href="bayesian-models-of-cognition.html#cb434-81" tabindex="-1"></a></span>
<span id="cb434-82"><a href="bayesian-models-of-cognition.html#cb434-82" tabindex="-1"></a><span class="co"># Arrange Prior Predictive Checks in a Grid</span></span>
<span id="cb434-83"><a href="bayesian-models-of-cognition.html#cb434-83" tabindex="-1"></a>prior_grid <span class="ot">&lt;-</span> (prior_simple_balanced <span class="sc">+</span> prior_simple_self_focused <span class="sc">+</span> prior_simple_socially_influenced) <span class="sc">+</span><span class="co">#/  (prior_weighted_balanced + prior_weighted_self_focused + prior_weighted_socially_influenced) +</span></span>
<span id="cb434-84"><a href="bayesian-models-of-cognition.html#cb434-84" tabindex="-1"></a>              <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Prior Predictive Checks&quot;</span>)</span>
<span id="cb434-85"><a href="bayesian-models-of-cognition.html#cb434-85" tabindex="-1"></a></span>
<span id="cb434-86"><a href="bayesian-models-of-cognition.html#cb434-86" tabindex="-1"></a><span class="co"># Arrange Posterior Predictive Checks in a Grid</span></span>
<span id="cb434-87"><a href="bayesian-models-of-cognition.html#cb434-87" tabindex="-1"></a>posterior_grid <span class="ot">&lt;-</span> (posterior_simple_balanced <span class="sc">+</span> posterior_simple_self_focused <span class="sc">+</span> posterior_simple_socially_influenced) <span class="sc">/</span></span>
<span id="cb434-88"><a href="bayesian-models-of-cognition.html#cb434-88" tabindex="-1"></a>                  (posterior_weighted_balanced <span class="sc">+</span> posterior_weighted_self_focused <span class="sc">+</span> posterior_weighted_socially_influenced) <span class="sc">+</span></span>
<span id="cb434-89"><a href="bayesian-models-of-cognition.html#cb434-89" tabindex="-1"></a>                  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Posterior Predictive Checks&quot;</span>)</span>
<span id="cb434-90"><a href="bayesian-models-of-cognition.html#cb434-90" tabindex="-1"></a></span>
<span id="cb434-91"><a href="bayesian-models-of-cognition.html#cb434-91" tabindex="-1"></a><span class="co"># Display the grids</span></span>
<span id="cb434-92"><a href="bayesian-models-of-cognition.html#cb434-92" tabindex="-1"></a><span class="fu">print</span>(prior_grid)</span></code></pre></div>
<p><img src="series_files/figure-html/09%20prior%20and%20posterior%20predictive%20checks%7D-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="bayesian-models-of-cognition.html#cb435-1" tabindex="-1"></a><span class="fu">print</span>(posterior_grid)</span></code></pre></div>
<p><img src="series_files/figure-html/09%20prior%20and%20posterior%20predictive%20checks%7D-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="prior-posterior-update-visualization" class="section level2 hasAnchor" number="10.15">
<h2><span class="header-section-number">10.15</span> Prior-Posterior Update Visualization<a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This visualization shows how our beliefs change after observing data, comparing the prior and posterior distributions for key parameters.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="bayesian-models-of-cognition.html#cb436-1" tabindex="-1"></a>prior_posterior_update_grid <span class="ot">&lt;-</span> <span class="cf">function</span>(fit_list, true_params_list, model_names) {</span>
<span id="cb436-2"><a href="bayesian-models-of-cognition.html#cb436-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(fit_list) <span class="sc">!=</span> <span class="fu">length</span>(true_params_list) <span class="sc">||</span> <span class="fu">length</span>(fit_list) <span class="sc">!=</span> <span class="fu">length</span>(model_names)) {</span>
<span id="cb436-3"><a href="bayesian-models-of-cognition.html#cb436-3" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;fit_list, true_params_list, and model_names must have the same length!&quot;</span>)</span>
<span id="cb436-4"><a href="bayesian-models-of-cognition.html#cb436-4" tabindex="-1"></a>  }</span>
<span id="cb436-5"><a href="bayesian-models-of-cognition.html#cb436-5" tabindex="-1"></a>  </span>
<span id="cb436-6"><a href="bayesian-models-of-cognition.html#cb436-6" tabindex="-1"></a>  <span class="co"># Extract prior and posterior samples for all models</span></span>
<span id="cb436-7"><a href="bayesian-models-of-cognition.html#cb436-7" tabindex="-1"></a>  prior_posterior_df <span class="ot">&lt;-</span> <span class="fu">map2_dfr</span>(fit_list, model_names, <span class="cf">function</span>(fit, model_name) {</span>
<span id="cb436-8"><a href="bayesian-models-of-cognition.html#cb436-8" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb436-9"><a href="bayesian-models-of-cognition.html#cb436-9" tabindex="-1"></a>    param_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;weight_direct&quot;</span>, <span class="st">&quot;weight_social&quot;</span>)</span>
<span id="cb436-10"><a href="bayesian-models-of-cognition.html#cb436-10" tabindex="-1"></a>    </span>
<span id="cb436-11"><a href="bayesian-models-of-cognition.html#cb436-11" tabindex="-1"></a>    <span class="fu">map_dfr</span>(param_names, <span class="cf">function</span>(param) {</span>
<span id="cb436-12"><a href="bayesian-models-of-cognition.html#cb436-12" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb436-13"><a href="bayesian-models-of-cognition.html#cb436-13" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb436-14"><a href="bayesian-models-of-cognition.html#cb436-14" tabindex="-1"></a>        <span class="at">parameter =</span> param,</span>
<span id="cb436-15"><a href="bayesian-models-of-cognition.html#cb436-15" tabindex="-1"></a>        <span class="at">value =</span> <span class="fu">c</span>(draws_df[[<span class="fu">paste0</span>(param, <span class="st">&quot;_prior&quot;</span>)]], draws_df[[param]]),</span>
<span id="cb436-16"><a href="bayesian-models-of-cognition.html#cb436-16" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Posterior&quot;</span>), <span class="at">each =</span> <span class="fu">nrow</span>(draws_df))</span>
<span id="cb436-17"><a href="bayesian-models-of-cognition.html#cb436-17" tabindex="-1"></a>      )</span>
<span id="cb436-18"><a href="bayesian-models-of-cognition.html#cb436-18" tabindex="-1"></a>    })</span>
<span id="cb436-19"><a href="bayesian-models-of-cognition.html#cb436-19" tabindex="-1"></a>  })</span>
<span id="cb436-20"><a href="bayesian-models-of-cognition.html#cb436-20" tabindex="-1"></a></span>
<span id="cb436-21"><a href="bayesian-models-of-cognition.html#cb436-21" tabindex="-1"></a>  <span class="co"># Combine true parameter values into a single dataframe</span></span>
<span id="cb436-22"><a href="bayesian-models-of-cognition.html#cb436-22" tabindex="-1"></a>  true_values_df <span class="ot">&lt;-</span> <span class="fu">map2_dfr</span>(true_params_list, model_names, <span class="cf">function</span>(params, model_name) {</span>
<span id="cb436-23"><a href="bayesian-models-of-cognition.html#cb436-23" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb436-24"><a href="bayesian-models-of-cognition.html#cb436-24" tabindex="-1"></a>      <span class="at">model_name =</span> model_name,</span>
<span id="cb436-25"><a href="bayesian-models-of-cognition.html#cb436-25" tabindex="-1"></a>      <span class="at">parameter =</span> <span class="fu">names</span>(params),</span>
<span id="cb436-26"><a href="bayesian-models-of-cognition.html#cb436-26" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">unlist</span>(params)</span>
<span id="cb436-27"><a href="bayesian-models-of-cognition.html#cb436-27" tabindex="-1"></a>    )</span>
<span id="cb436-28"><a href="bayesian-models-of-cognition.html#cb436-28" tabindex="-1"></a>  })</span>
<span id="cb436-29"><a href="bayesian-models-of-cognition.html#cb436-29" tabindex="-1"></a>  </span>
<span id="cb436-30"><a href="bayesian-models-of-cognition.html#cb436-30" tabindex="-1"></a>  <span class="co"># Base plot with facet grid</span></span>
<span id="cb436-31"><a href="bayesian-models-of-cognition.html#cb436-31" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior_posterior_df, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> distribution, <span class="at">color =</span> distribution)) <span class="sc">+</span></span>
<span id="cb436-32"><a href="bayesian-models-of-cognition.html#cb436-32" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb436-33"><a href="bayesian-models-of-cognition.html#cb436-33" tabindex="-1"></a>    <span class="fu">facet_grid</span>(model_name <span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span>  <span class="co"># Arrange models in rows, parameters in columns</span></span>
<span id="cb436-34"><a href="bayesian-models-of-cognition.html#cb436-34" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E63946&quot;</span>, <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D3557&quot;</span>)) <span class="sc">+</span>  </span>
<span id="cb436-35"><a href="bayesian-models-of-cognition.html#cb436-35" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E63946&quot;</span>, <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D3557&quot;</span>)) <span class="sc">+</span></span>
<span id="cb436-36"><a href="bayesian-models-of-cognition.html#cb436-36" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Prior vs. Posterior Distributions Across Models&quot;</span>,</span>
<span id="cb436-37"><a href="bayesian-models-of-cognition.html#cb436-37" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Parameter Value&quot;</span>,</span>
<span id="cb436-38"><a href="bayesian-models-of-cognition.html#cb436-38" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb436-39"><a href="bayesian-models-of-cognition.html#cb436-39" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Distribution&quot;</span>,</span>
<span id="cb436-40"><a href="bayesian-models-of-cognition.html#cb436-40" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb436-41"><a href="bayesian-models-of-cognition.html#cb436-41" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb436-42"><a href="bayesian-models-of-cognition.html#cb436-42" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb436-43"><a href="bayesian-models-of-cognition.html#cb436-43" tabindex="-1"></a></span>
<span id="cb436-44"><a href="bayesian-models-of-cognition.html#cb436-44" tabindex="-1"></a>  <span class="co"># Add true parameter values</span></span>
<span id="cb436-45"><a href="bayesian-models-of-cognition.html#cb436-45" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(true_params_list)) {</span>
<span id="cb436-46"><a href="bayesian-models-of-cognition.html#cb436-46" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb436-47"><a href="bayesian-models-of-cognition.html#cb436-47" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">data =</span> true_values_df,</span>
<span id="cb436-48"><a href="bayesian-models-of-cognition.html#cb436-48" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xintercept =</span> value),</span>
<span id="cb436-49"><a href="bayesian-models-of-cognition.html#cb436-49" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;#2A9D8F&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>)</span>
<span id="cb436-50"><a href="bayesian-models-of-cognition.html#cb436-50" tabindex="-1"></a>  }</span>
<span id="cb436-51"><a href="bayesian-models-of-cognition.html#cb436-51" tabindex="-1"></a></span>
<span id="cb436-52"><a href="bayesian-models-of-cognition.html#cb436-52" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb436-53"><a href="bayesian-models-of-cognition.html#cb436-53" tabindex="-1"></a>}</span>
<span id="cb436-54"><a href="bayesian-models-of-cognition.html#cb436-54" tabindex="-1"></a></span>
<span id="cb436-55"><a href="bayesian-models-of-cognition.html#cb436-55" tabindex="-1"></a><span class="co"># Define models and true parameter values</span></span>
<span id="cb436-56"><a href="bayesian-models-of-cognition.html#cb436-56" tabindex="-1"></a>fit_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb436-57"><a href="bayesian-models-of-cognition.html#cb436-57" tabindex="-1"></a>  fit_weighted_balanced,</span>
<span id="cb436-58"><a href="bayesian-models-of-cognition.html#cb436-58" tabindex="-1"></a>  fit_weighted_self_focused,</span>
<span id="cb436-59"><a href="bayesian-models-of-cognition.html#cb436-59" tabindex="-1"></a>  fit_weighted_socially_influenced</span>
<span id="cb436-60"><a href="bayesian-models-of-cognition.html#cb436-60" tabindex="-1"></a>)</span>
<span id="cb436-61"><a href="bayesian-models-of-cognition.html#cb436-61" tabindex="-1"></a></span>
<span id="cb436-62"><a href="bayesian-models-of-cognition.html#cb436-62" tabindex="-1"></a>true_params_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb436-63"><a href="bayesian-models-of-cognition.html#cb436-63" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">weight_direct =</span> <span class="dv">1</span>, <span class="at">weight_social =</span> <span class="dv">1</span>),</span>
<span id="cb436-64"><a href="bayesian-models-of-cognition.html#cb436-64" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">weight_direct =</span> <span class="fl">1.5</span>, <span class="at">weight_social =</span> <span class="fl">0.5</span>),</span>
<span id="cb436-65"><a href="bayesian-models-of-cognition.html#cb436-65" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">weight_direct =</span> <span class="fl">0.7</span>, <span class="at">weight_social =</span> <span class="dv">2</span>)</span>
<span id="cb436-66"><a href="bayesian-models-of-cognition.html#cb436-66" tabindex="-1"></a>)</span>
<span id="cb436-67"><a href="bayesian-models-of-cognition.html#cb436-67" tabindex="-1"></a></span>
<span id="cb436-68"><a href="bayesian-models-of-cognition.html#cb436-68" tabindex="-1"></a>model_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Weighted Balanced&quot;</span>, <span class="st">&quot;Weighted Self-Focused&quot;</span>, <span class="st">&quot;Weighted Socially Influenced&quot;</span>)</span>
<span id="cb436-69"><a href="bayesian-models-of-cognition.html#cb436-69" tabindex="-1"></a></span>
<span id="cb436-70"><a href="bayesian-models-of-cognition.html#cb436-70" tabindex="-1"></a><span class="co"># Generate the plot</span></span>
<span id="cb436-71"><a href="bayesian-models-of-cognition.html#cb436-71" tabindex="-1"></a><span class="co"># prior_posterior_update_grid(fit_list, true_params_list, model_names)</span></span></code></pre></div>
</div>
<div id="parameter-recovery-2" class="section level2 hasAnchor" number="10.16">
<h2><span class="header-section-number">10.16</span> Parameter recovery<a href="bayesian-models-of-cognition.html#parameter-recovery-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="bayesian-models-of-cognition.html#cb437-1" tabindex="-1"></a><span class="do">## Set up parallel processing</span></span>
<span id="cb437-2"><a href="bayesian-models-of-cognition.html#cb437-2" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(multisession, <span class="at">workers =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb437-3"><a href="bayesian-models-of-cognition.html#cb437-3" tabindex="-1"></a></span>
<span id="cb437-4"><a href="bayesian-models-of-cognition.html#cb437-4" tabindex="-1"></a><span class="co"># Define parameter grid</span></span>
<span id="cb437-5"><a href="bayesian-models-of-cognition.html#cb437-5" tabindex="-1"></a>weight_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="dv">1</span>)</span>
<span id="cb437-6"><a href="bayesian-models-of-cognition.html#cb437-6" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="co"># Number of times full combination of levels is repeated</span></span>
<span id="cb437-7"><a href="bayesian-models-of-cognition.html#cb437-7" tabindex="-1"></a></span>
<span id="cb437-8"><a href="bayesian-models-of-cognition.html#cb437-8" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">w1 =</span> weight_values, <span class="at">w2 =</span> weight_values, <span class="at">trials =</span> n_trials)</span>
<span id="cb437-9"><a href="bayesian-models-of-cognition.html#cb437-9" tabindex="-1"></a></span>
<span id="cb437-10"><a href="bayesian-models-of-cognition.html#cb437-10" tabindex="-1"></a><span class="co"># Define evidence combinations</span></span>
<span id="cb437-11"><a href="bayesian-models-of-cognition.html#cb437-11" tabindex="-1"></a>evidence_combinations <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb437-12"><a href="bayesian-models-of-cognition.html#cb437-12" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,     <span class="co"># Direct evidence: number of blue marbles seen</span></span>
<span id="cb437-13"><a href="bayesian-models-of-cognition.html#cb437-13" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>      <span class="co"># Social evidence: strength of blue evidence</span></span>
<span id="cb437-14"><a href="bayesian-models-of-cognition.html#cb437-14" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb437-15"><a href="bayesian-models-of-cognition.html#cb437-15" tabindex="-1"></a>  <span class="at">total1 =</span> <span class="dv">8</span>,      <span class="co"># Total marbles in direct evidence</span></span>
<span id="cb437-16"><a href="bayesian-models-of-cognition.html#cb437-16" tabindex="-1"></a>  <span class="at">total2 =</span> <span class="dv">3</span>       <span class="co"># Total strength units in social evidence</span></span>
<span id="cb437-17"><a href="bayesian-models-of-cognition.html#cb437-17" tabindex="-1"></a>)</span>
<span id="cb437-18"><a href="bayesian-models-of-cognition.html#cb437-18" tabindex="-1"></a></span>
<span id="cb437-19"><a href="bayesian-models-of-cognition.html#cb437-19" tabindex="-1"></a><span class="co"># Function to generate decisions across all evidence combinations for a given agent</span></span>
<span id="cb437-20"><a href="bayesian-models-of-cognition.html#cb437-20" tabindex="-1"></a>generate_agent_decisions <span class="ot">&lt;-</span> <span class="cf">function</span>(weight_direct, weight_social, evidence_df, trials) {</span>
<span id="cb437-21"><a href="bayesian-models-of-cognition.html#cb437-21" tabindex="-1"></a>  <span class="co"># Expand dataset to account for multiple trials</span></span>
<span id="cb437-22"><a href="bayesian-models-of-cognition.html#cb437-22" tabindex="-1"></a>  expanded_data <span class="ot">&lt;-</span> evidence_df <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), <span class="at">each =</span> trials))</span>
<span id="cb437-23"><a href="bayesian-models-of-cognition.html#cb437-23" tabindex="-1"></a>  </span>
<span id="cb437-24"><a href="bayesian-models-of-cognition.html#cb437-24" tabindex="-1"></a>  <span class="co"># Apply our weighted Bayesian model to each evidence combination</span></span>
<span id="cb437-25"><a href="bayesian-models-of-cognition.html#cb437-25" tabindex="-1"></a>  decisions <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(expanded_data, <span class="cf">function</span>(blue1, blue2, total1, total2) {</span>
<span id="cb437-26"><a href="bayesian-models-of-cognition.html#cb437-26" tabindex="-1"></a>    <span class="co"># Calculate Bayesian integration with the agent&#39;s specific weights</span></span>
<span id="cb437-27"><a href="bayesian-models-of-cognition.html#cb437-27" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">weightedBetaBinomial</span>(</span>
<span id="cb437-28"><a href="bayesian-models-of-cognition.html#cb437-28" tabindex="-1"></a>      <span class="at">alpha_prior =</span> <span class="dv">1</span>, <span class="at">beta_prior =</span> <span class="dv">1</span>,</span>
<span id="cb437-29"><a href="bayesian-models-of-cognition.html#cb437-29" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1, <span class="at">total1 =</span> total1,</span>
<span id="cb437-30"><a href="bayesian-models-of-cognition.html#cb437-30" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2, <span class="at">total2 =</span> total2,</span>
<span id="cb437-31"><a href="bayesian-models-of-cognition.html#cb437-31" tabindex="-1"></a>      <span class="at">weight_direct =</span> weight_direct,</span>
<span id="cb437-32"><a href="bayesian-models-of-cognition.html#cb437-32" tabindex="-1"></a>      <span class="at">weight_social =</span> weight_social</span>
<span id="cb437-33"><a href="bayesian-models-of-cognition.html#cb437-33" tabindex="-1"></a>    )</span>
<span id="cb437-34"><a href="bayesian-models-of-cognition.html#cb437-34" tabindex="-1"></a>    </span>
<span id="cb437-35"><a href="bayesian-models-of-cognition.html#cb437-35" tabindex="-1"></a>    <span class="co"># Return key decision metrics</span></span>
<span id="cb437-36"><a href="bayesian-models-of-cognition.html#cb437-36" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb437-37"><a href="bayesian-models-of-cognition.html#cb437-37" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1,</span>
<span id="cb437-38"><a href="bayesian-models-of-cognition.html#cb437-38" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2,</span>
<span id="cb437-39"><a href="bayesian-models-of-cognition.html#cb437-39" tabindex="-1"></a>      <span class="at">total1 =</span> total1,</span>
<span id="cb437-40"><a href="bayesian-models-of-cognition.html#cb437-40" tabindex="-1"></a>      <span class="at">total2 =</span> total2,</span>
<span id="cb437-41"><a href="bayesian-models-of-cognition.html#cb437-41" tabindex="-1"></a>      <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,   <span class="co"># Probability the next marble is blue</span></span>
<span id="cb437-42"><a href="bayesian-models-of-cognition.html#cb437-42" tabindex="-1"></a>      <span class="at">choice =</span> result<span class="sc">$</span>decision,               <span class="co"># Final decision (Blue or Red)</span></span>
<span id="cb437-43"><a href="bayesian-models-of-cognition.html#cb437-43" tabindex="-1"></a>      <span class="at">confidence =</span> result<span class="sc">$</span>confidence          <span class="co"># Confidence in decision</span></span>
<span id="cb437-44"><a href="bayesian-models-of-cognition.html#cb437-44" tabindex="-1"></a>    )</span>
<span id="cb437-45"><a href="bayesian-models-of-cognition.html#cb437-45" tabindex="-1"></a>  })</span>
<span id="cb437-46"><a href="bayesian-models-of-cognition.html#cb437-46" tabindex="-1"></a>  </span>
<span id="cb437-47"><a href="bayesian-models-of-cognition.html#cb437-47" tabindex="-1"></a>  <span class="fu">return</span>(decisions)</span>
<span id="cb437-48"><a href="bayesian-models-of-cognition.html#cb437-48" tabindex="-1"></a>}</span>
<span id="cb437-49"><a href="bayesian-models-of-cognition.html#cb437-49" tabindex="-1"></a></span>
<span id="cb437-50"><a href="bayesian-models-of-cognition.html#cb437-50" tabindex="-1"></a><span class="co"># Function to prepare Stan data</span></span>
<span id="cb437-51"><a href="bayesian-models-of-cognition.html#cb437-51" tabindex="-1"></a>prepare_stan_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb437-52"><a href="bayesian-models-of-cognition.html#cb437-52" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb437-53"><a href="bayesian-models-of-cognition.html#cb437-53" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb437-54"><a href="bayesian-models-of-cognition.html#cb437-54" tabindex="-1"></a>    <span class="at">choice =</span> <span class="fu">as.integer</span>(df<span class="sc">$</span>choice <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>),</span>
<span id="cb437-55"><a href="bayesian-models-of-cognition.html#cb437-55" tabindex="-1"></a>    <span class="at">blue1 =</span> df<span class="sc">$</span>blue1,</span>
<span id="cb437-56"><a href="bayesian-models-of-cognition.html#cb437-56" tabindex="-1"></a>    <span class="at">total1 =</span> df<span class="sc">$</span>total1,</span>
<span id="cb437-57"><a href="bayesian-models-of-cognition.html#cb437-57" tabindex="-1"></a>    <span class="at">blue2 =</span> df<span class="sc">$</span>blue2,</span>
<span id="cb437-58"><a href="bayesian-models-of-cognition.html#cb437-58" tabindex="-1"></a>    <span class="at">total2 =</span> df<span class="sc">$</span>total2</span>
<span id="cb437-59"><a href="bayesian-models-of-cognition.html#cb437-59" tabindex="-1"></a>  )</span>
<span id="cb437-60"><a href="bayesian-models-of-cognition.html#cb437-60" tabindex="-1"></a>}</span>
<span id="cb437-61"><a href="bayesian-models-of-cognition.html#cb437-61" tabindex="-1"></a></span>
<span id="cb437-62"><a href="bayesian-models-of-cognition.html#cb437-62" tabindex="-1"></a><span class="co"># Compile the Stan model </span></span>
<span id="cb437-63"><a href="bayesian-models-of-cognition.html#cb437-63" tabindex="-1"></a>file_weighted <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W9_weighted_beta_binomial.stan&quot;</span>)</span>
<span id="cb437-64"><a href="bayesian-models-of-cognition.html#cb437-64" tabindex="-1"></a>mod_weighted <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_weighted, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb437-65"><a href="bayesian-models-of-cognition.html#cb437-65" tabindex="-1"></a></span>
<span id="cb437-66"><a href="bayesian-models-of-cognition.html#cb437-66" tabindex="-1"></a><span class="co"># Function to fit model using cmdstanr</span></span>
<span id="cb437-67"><a href="bayesian-models-of-cognition.html#cb437-67" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb437-68"><a href="bayesian-models-of-cognition.html#cb437-68" tabindex="-1"></a>  stan_data <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(data)</span>
<span id="cb437-69"><a href="bayesian-models-of-cognition.html#cb437-69" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb437-70"><a href="bayesian-models-of-cognition.html#cb437-70" tabindex="-1"></a>    <span class="at">data =</span> stan_data,</span>
<span id="cb437-71"><a href="bayesian-models-of-cognition.html#cb437-71" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">126</span>,</span>
<span id="cb437-72"><a href="bayesian-models-of-cognition.html#cb437-72" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb437-73"><a href="bayesian-models-of-cognition.html#cb437-73" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb437-74"><a href="bayesian-models-of-cognition.html#cb437-74" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb437-75"><a href="bayesian-models-of-cognition.html#cb437-75" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb437-76"><a href="bayesian-models-of-cognition.html#cb437-76" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb437-77"><a href="bayesian-models-of-cognition.html#cb437-77" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb437-78"><a href="bayesian-models-of-cognition.html#cb437-78" tabindex="-1"></a>  )</span>
<span id="cb437-79"><a href="bayesian-models-of-cognition.html#cb437-79" tabindex="-1"></a>  <span class="fu">return</span>(fit)</span>
<span id="cb437-80"><a href="bayesian-models-of-cognition.html#cb437-80" tabindex="-1"></a>}</span>
<span id="cb437-81"><a href="bayesian-models-of-cognition.html#cb437-81" tabindex="-1"></a></span>
<span id="cb437-82"><a href="bayesian-models-of-cognition.html#cb437-82" tabindex="-1"></a><span class="co"># Run simulations and model fitting in parallel</span></span>
<span id="cb437-83"><a href="bayesian-models-of-cognition.html#cb437-83" tabindex="-1"></a>results <span class="ot">&lt;-</span> param_grid <span class="sc">%&gt;%</span></span>
<span id="cb437-84"><a href="bayesian-models-of-cognition.html#cb437-84" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb437-85"><a href="bayesian-models-of-cognition.html#cb437-85" tabindex="-1"></a>    <span class="co"># Generate synthetic data for each parameter combination</span></span>
<span id="cb437-86"><a href="bayesian-models-of-cognition.html#cb437-86" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">future_pmap</span>(<span class="fu">list</span>(w1, w2, trials), <span class="cf">function</span>(w1, w2, t) {</span>
<span id="cb437-87"><a href="bayesian-models-of-cognition.html#cb437-87" tabindex="-1"></a>      <span class="fu">generate_agent_decisions</span>(w1, w2, evidence_combinations, t)</span>
<span id="cb437-88"><a href="bayesian-models-of-cognition.html#cb437-88" tabindex="-1"></a>    }, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb437-89"><a href="bayesian-models-of-cognition.html#cb437-89" tabindex="-1"></a>    </span>
<span id="cb437-90"><a href="bayesian-models-of-cognition.html#cb437-90" tabindex="-1"></a>    <span class="co"># Fit model to each dataset</span></span>
<span id="cb437-91"><a href="bayesian-models-of-cognition.html#cb437-91" tabindex="-1"></a>    <span class="at">fit =</span> <span class="fu">future_map</span>(data, fit_model, <span class="at">.progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb437-92"><a href="bayesian-models-of-cognition.html#cb437-92" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.1 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.1 seconds.
## Chain 1 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.1 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="bayesian-models-of-cognition.html#cb447-1" tabindex="-1"></a><span class="co"># Extract estimated coefficients - proper parameter names</span></span>
<span id="cb447-2"><a href="bayesian-models-of-cognition.html#cb447-2" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb447-3"><a href="bayesian-models-of-cognition.html#cb447-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb447-4"><a href="bayesian-models-of-cognition.html#cb447-4" tabindex="-1"></a>    <span class="co"># Extract weight parameters properly - names from Stan model</span></span>
<span id="cb447-5"><a href="bayesian-models-of-cognition.html#cb447-5" tabindex="-1"></a>    <span class="at">weight_direct_est =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>weight_direct)),</span>
<span id="cb447-6"><a href="bayesian-models-of-cognition.html#cb447-6" tabindex="-1"></a>    <span class="at">weight_social_est =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>weight_social)),</span>
<span id="cb447-7"><a href="bayesian-models-of-cognition.html#cb447-7" tabindex="-1"></a>    </span>
<span id="cb447-8"><a href="bayesian-models-of-cognition.html#cb447-8" tabindex="-1"></a>    <span class="co"># Extract uncertainty estimates</span></span>
<span id="cb447-9"><a href="bayesian-models-of-cognition.html#cb447-9" tabindex="-1"></a>    <span class="at">weight_direct_sd =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">sd</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>weight_direct)),</span>
<span id="cb447-10"><a href="bayesian-models-of-cognition.html#cb447-10" tabindex="-1"></a>    <span class="at">weight_social_sd =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">sd</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>weight_social))</span>
<span id="cb447-11"><a href="bayesian-models-of-cognition.html#cb447-11" tabindex="-1"></a>  )</span>
<span id="cb447-12"><a href="bayesian-models-of-cognition.html#cb447-12" tabindex="-1"></a></span>
<span id="cb447-13"><a href="bayesian-models-of-cognition.html#cb447-13" tabindex="-1"></a><span class="co"># Visualize direct weight recovery</span></span>
<span id="cb447-14"><a href="bayesian-models-of-cognition.html#cb447-14" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb447-15"><a href="bayesian-models-of-cognition.html#cb447-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> w1, <span class="at">y =</span> weight_direct_est, <span class="at">color =</span> <span class="fu">factor</span>(trials))) <span class="sc">+</span></span>
<span id="cb447-16"><a href="bayesian-models-of-cognition.html#cb447-16" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb447-17"><a href="bayesian-models-of-cognition.html#cb447-17" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> weight_direct_est <span class="sc">-</span> weight_direct_sd, </span>
<span id="cb447-18"><a href="bayesian-models-of-cognition.html#cb447-18" tabindex="-1"></a>                    <span class="at">ymax =</span> weight_direct_est <span class="sc">+</span> weight_direct_sd), </span>
<span id="cb447-19"><a href="bayesian-models-of-cognition.html#cb447-19" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb447-20"><a href="bayesian-models-of-cognition.html#cb447-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb447-21"><a href="bayesian-models-of-cognition.html#cb447-21" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> w2) <span class="sc">+</span></span>
<span id="cb447-22"><a href="bayesian-models-of-cognition.html#cb447-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Direct Weight Parameter Recovery&quot;</span>, </span>
<span id="cb447-23"><a href="bayesian-models-of-cognition.html#cb447-23" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;True Direct Weight&quot;</span>, </span>
<span id="cb447-24"><a href="bayesian-models-of-cognition.html#cb447-24" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Estimated Direct Weight&quot;</span>,</span>
<span id="cb447-25"><a href="bayesian-models-of-cognition.html#cb447-25" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Number of Trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb447-26"><a href="bayesian-models-of-cognition.html#cb447-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb447-27"><a href="bayesian-models-of-cognition.html#cb447-27" tabindex="-1"></a></span>
<span id="cb447-28"><a href="bayesian-models-of-cognition.html#cb447-28" tabindex="-1"></a><span class="co"># Visualize social weight recovery</span></span>
<span id="cb447-29"><a href="bayesian-models-of-cognition.html#cb447-29" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb447-30"><a href="bayesian-models-of-cognition.html#cb447-30" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> w2, <span class="at">y =</span> weight_social_est, <span class="at">color =</span> <span class="fu">factor</span>(trials))) <span class="sc">+</span></span>
<span id="cb447-31"><a href="bayesian-models-of-cognition.html#cb447-31" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb447-32"><a href="bayesian-models-of-cognition.html#cb447-32" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> weight_social_est <span class="sc">-</span> weight_social_sd, </span>
<span id="cb447-33"><a href="bayesian-models-of-cognition.html#cb447-33" tabindex="-1"></a>                    <span class="at">ymax =</span> weight_social_est <span class="sc">+</span> weight_social_sd), </span>
<span id="cb447-34"><a href="bayesian-models-of-cognition.html#cb447-34" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb447-35"><a href="bayesian-models-of-cognition.html#cb447-35" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb447-36"><a href="bayesian-models-of-cognition.html#cb447-36" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> w1) <span class="sc">+</span></span>
<span id="cb447-37"><a href="bayesian-models-of-cognition.html#cb447-37" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Social Weight Parameter Recovery&quot;</span>, </span>
<span id="cb447-38"><a href="bayesian-models-of-cognition.html#cb447-38" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;True Social Weight&quot;</span>, </span>
<span id="cb447-39"><a href="bayesian-models-of-cognition.html#cb447-39" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Estimated Social Weight&quot;</span>,</span>
<span id="cb447-40"><a href="bayesian-models-of-cognition.html#cb447-40" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Number of Trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb447-41"><a href="bayesian-models-of-cognition.html#cb447-41" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb447-42"><a href="bayesian-models-of-cognition.html#cb447-42" tabindex="-1"></a></span>
<span id="cb447-43"><a href="bayesian-models-of-cognition.html#cb447-43" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb447-44"><a href="bayesian-models-of-cognition.html#cb447-44" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-55-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="bayesian-models-of-cognition.html#cb448-1" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-55-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="multilevel-bayesian-models" class="section level2 hasAnchor" number="10.17">
<h2><span class="header-section-number">10.17</span> Multilevel Bayesian Models<a href="bayesian-models-of-cognition.html#multilevel-bayesian-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous sections, we explored how individuals integrate direct and social evidence using Bayesian principles. However, our models assumed that all individuals use the same weighting strategy. In reality, people vary in how they weigh different sources of information - some may trust their own observations more, while others may be more influenced by social information.</p>
<p>Multilevel (hierarchical) models allow us to capture this individual variation while still leveraging the commonalities across individuals. They offer several advantages:</p>
<ol style="list-style-type: decimal">
<li>They model individual differences explicitly</li>
<li>They improve parameter estimation for individuals with limited data</li>
<li>They allow us to examine correlations between individual parameters</li>
<li>They provide population-level insights about general tendencies</li>
</ol>
<p>In this section, we’ll develop multilevel versions of both our simple beta-binomial and weighted beta-binomial models.</p>
<div id="simulating-data-from-multiple-agents" class="section level3 hasAnchor" number="10.17.1">
<h3><span class="header-section-number">10.17.1</span> Simulating Data from Multiple Agents<a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, let’s simulate a population of agents with varying evidence-weighting parameters:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="bayesian-models-of-cognition.html#cb449-1" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb449-2"><a href="bayesian-models-of-cognition.html#cb449-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8675309</span>)</span>
<span id="cb449-3"><a href="bayesian-models-of-cognition.html#cb449-3" tabindex="-1"></a></span>
<span id="cb449-4"><a href="bayesian-models-of-cognition.html#cb449-4" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb449-5"><a href="bayesian-models-of-cognition.html#cb449-5" tabindex="-1"></a>n_agents <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># Number of agents</span></span>
<span id="cb449-6"><a href="bayesian-models-of-cognition.html#cb449-6" tabindex="-1"></a>n_scenarios_per_agent <span class="ot">&lt;-</span> <span class="dv">36</span>  <span class="co"># Number of evidence combinations (all possible combinations)</span></span>
<span id="cb449-7"><a href="bayesian-models-of-cognition.html#cb449-7" tabindex="-1"></a></span>
<span id="cb449-8"><a href="bayesian-models-of-cognition.html#cb449-8" tabindex="-1"></a><span class="co"># Population-level parameters</span></span>
<span id="cb449-9"><a href="bayesian-models-of-cognition.html#cb449-9" tabindex="-1"></a><span class="co"># For the weighted model</span></span>
<span id="cb449-10"><a href="bayesian-models-of-cognition.html#cb449-10" tabindex="-1"></a>population_mean_direct <span class="ot">&lt;-</span> <span class="fl">1.0</span>  <span class="co"># Mean weight for direct evidence</span></span>
<span id="cb449-11"><a href="bayesian-models-of-cognition.html#cb449-11" tabindex="-1"></a>population_sd_direct <span class="ot">&lt;-</span> <span class="fl">0.1</span>    <span class="co"># SD of individual variation in direct evidence weight</span></span>
<span id="cb449-12"><a href="bayesian-models-of-cognition.html#cb449-12" tabindex="-1"></a>population_mean_social <span class="ot">&lt;-</span> <span class="fl">0.6</span>  <span class="co"># Mean weight for social evidence</span></span>
<span id="cb449-13"><a href="bayesian-models-of-cognition.html#cb449-13" tabindex="-1"></a>population_sd_social <span class="ot">&lt;-</span> <span class="fl">0.1</span>    <span class="co"># SD of individual variation in social evidence weight</span></span>
<span id="cb449-14"><a href="bayesian-models-of-cognition.html#cb449-14" tabindex="-1"></a></span>
<span id="cb449-15"><a href="bayesian-models-of-cognition.html#cb449-15" tabindex="-1"></a><span class="co"># Sample individual agent parameters from population distributions</span></span>
<span id="cb449-16"><a href="bayesian-models-of-cognition.html#cb449-16" tabindex="-1"></a>agent_params <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb449-17"><a href="bayesian-models-of-cognition.html#cb449-17" tabindex="-1"></a>  <span class="at">agent_id =</span> <span class="dv">1</span><span class="sc">:</span>n_agents,</span>
<span id="cb449-18"><a href="bayesian-models-of-cognition.html#cb449-18" tabindex="-1"></a>  <span class="co"># For weighted models - individual weights</span></span>
<span id="cb449-19"><a href="bayesian-models-of-cognition.html#cb449-19" tabindex="-1"></a>  <span class="at">weight_direct =</span> <span class="fu">rnorm</span>(n_agents, population_mean_direct, population_sd_direct),</span>
<span id="cb449-20"><a href="bayesian-models-of-cognition.html#cb449-20" tabindex="-1"></a>  <span class="at">weight_social =</span> <span class="fu">rnorm</span>(n_agents, population_mean_social, population_sd_social)</span>
<span id="cb449-21"><a href="bayesian-models-of-cognition.html#cb449-21" tabindex="-1"></a>)</span>
<span id="cb449-22"><a href="bayesian-models-of-cognition.html#cb449-22" tabindex="-1"></a></span>
<span id="cb449-23"><a href="bayesian-models-of-cognition.html#cb449-23" tabindex="-1"></a><span class="co"># Display the distribution of agent parameters</span></span>
<span id="cb449-24"><a href="bayesian-models-of-cognition.html#cb449-24" tabindex="-1"></a><span class="fu">summary</span>(agent_params)</span></code></pre></div>
<pre><code>##     agent_id     weight_direct    weight_social   
##  Min.   : 1.00   Min.   :0.8450   Min.   :0.5385  
##  1st Qu.: 5.75   1st Qu.:0.9298   1st Qu.:0.5735  
##  Median :10.50   Median :1.0089   Median :0.6054  
##  Mean   :10.50   Mean   :1.0149   Mean   :0.6252  
##  3rd Qu.:15.25   3rd Qu.:1.0925   3rd Qu.:0.6612  
##  Max.   :20.00   Max.   :1.2029   Max.   :0.7986</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="bayesian-models-of-cognition.html#cb451-1" tabindex="-1"></a><span class="co"># Create all possible evidence combinations</span></span>
<span id="cb451-2"><a href="bayesian-models-of-cognition.html#cb451-2" tabindex="-1"></a>evidence_combinations <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb451-3"><a href="bayesian-models-of-cognition.html#cb451-3" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,     <span class="co"># Direct evidence: number of blue marbles seen (0-8 blue out of 8)</span></span>
<span id="cb451-4"><a href="bayesian-models-of-cognition.html#cb451-4" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,     <span class="co"># Social evidence: strength of blue evidence (0-3 blue signals)</span></span>
<span id="cb451-5"><a href="bayesian-models-of-cognition.html#cb451-5" tabindex="-1"></a>  <span class="at">total1 =</span> <span class="dv">8</span>,      <span class="co"># Total marbles in direct evidence (constant) </span></span>
<span id="cb451-6"><a href="bayesian-models-of-cognition.html#cb451-6" tabindex="-1"></a>  <span class="at">total2 =</span> <span class="dv">3</span>       <span class="co"># Total signals in social evidence (constant)</span></span>
<span id="cb451-7"><a href="bayesian-models-of-cognition.html#cb451-7" tabindex="-1"></a>)</span>
<span id="cb451-8"><a href="bayesian-models-of-cognition.html#cb451-8" tabindex="-1"></a></span>
<span id="cb451-9"><a href="bayesian-models-of-cognition.html#cb451-9" tabindex="-1"></a><span class="co"># Generate data for each agent across all evidence combinations</span></span>
<span id="cb451-10"><a href="bayesian-models-of-cognition.html#cb451-10" tabindex="-1"></a>multilevel_sim_data <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>n_agents, <span class="cf">function</span>(agent_idx) {</span>
<span id="cb451-11"><a href="bayesian-models-of-cognition.html#cb451-11" tabindex="-1"></a>  <span class="co"># Get this agent&#39;s parameters</span></span>
<span id="cb451-12"><a href="bayesian-models-of-cognition.html#cb451-12" tabindex="-1"></a>  agent_data <span class="ot">&lt;-</span> agent_params[agent_params<span class="sc">$</span>agent_id <span class="sc">==</span> agent_idx, ]</span>
<span id="cb451-13"><a href="bayesian-models-of-cognition.html#cb451-13" tabindex="-1"></a>  </span>
<span id="cb451-14"><a href="bayesian-models-of-cognition.html#cb451-14" tabindex="-1"></a>  <span class="co"># Apply our weighted Bayesian model to each evidence combination</span></span>
<span id="cb451-15"><a href="bayesian-models-of-cognition.html#cb451-15" tabindex="-1"></a>  agent_decisions <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(evidence_combinations, <span class="cf">function</span>(blue1, blue2, total1, total2) {</span>
<span id="cb451-16"><a href="bayesian-models-of-cognition.html#cb451-16" tabindex="-1"></a>    <span class="co"># Calculate Bayesian integration with this agent&#39;s specific weights</span></span>
<span id="cb451-17"><a href="bayesian-models-of-cognition.html#cb451-17" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">weightedBetaBinomial</span>(</span>
<span id="cb451-18"><a href="bayesian-models-of-cognition.html#cb451-18" tabindex="-1"></a>      <span class="at">alpha_prior =</span> <span class="dv">1</span>, <span class="at">beta_prior =</span> <span class="dv">1</span>,</span>
<span id="cb451-19"><a href="bayesian-models-of-cognition.html#cb451-19" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1, <span class="at">total1 =</span> total1,</span>
<span id="cb451-20"><a href="bayesian-models-of-cognition.html#cb451-20" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2, <span class="at">total2 =</span> total2,</span>
<span id="cb451-21"><a href="bayesian-models-of-cognition.html#cb451-21" tabindex="-1"></a>      <span class="at">weight_direct =</span> agent_data<span class="sc">$</span>weight_direct,</span>
<span id="cb451-22"><a href="bayesian-models-of-cognition.html#cb451-22" tabindex="-1"></a>      <span class="at">weight_social =</span> agent_data<span class="sc">$</span>weight_social</span>
<span id="cb451-23"><a href="bayesian-models-of-cognition.html#cb451-23" tabindex="-1"></a>    )</span>
<span id="cb451-24"><a href="bayesian-models-of-cognition.html#cb451-24" tabindex="-1"></a>    </span>
<span id="cb451-25"><a href="bayesian-models-of-cognition.html#cb451-25" tabindex="-1"></a>    <span class="co"># Return decision for this evidence combination</span></span>
<span id="cb451-26"><a href="bayesian-models-of-cognition.html#cb451-26" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb451-27"><a href="bayesian-models-of-cognition.html#cb451-27" tabindex="-1"></a>      <span class="at">agent_id =</span> agent_idx,</span>
<span id="cb451-28"><a href="bayesian-models-of-cognition.html#cb451-28" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1,</span>
<span id="cb451-29"><a href="bayesian-models-of-cognition.html#cb451-29" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2,</span>
<span id="cb451-30"><a href="bayesian-models-of-cognition.html#cb451-30" tabindex="-1"></a>      <span class="at">total1 =</span> total1,</span>
<span id="cb451-31"><a href="bayesian-models-of-cognition.html#cb451-31" tabindex="-1"></a>      <span class="at">total2 =</span> total2,</span>
<span id="cb451-32"><a href="bayesian-models-of-cognition.html#cb451-32" tabindex="-1"></a>      <span class="at">choice =</span> result<span class="sc">$</span>decision,</span>
<span id="cb451-33"><a href="bayesian-models-of-cognition.html#cb451-33" tabindex="-1"></a>      <span class="at">choice_binary =</span> <span class="fu">as.integer</span>(result<span class="sc">$</span>decision <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>),</span>
<span id="cb451-34"><a href="bayesian-models-of-cognition.html#cb451-34" tabindex="-1"></a>      <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,</span>
<span id="cb451-35"><a href="bayesian-models-of-cognition.html#cb451-35" tabindex="-1"></a>      <span class="at">confidence =</span> result<span class="sc">$</span>confidence</span>
<span id="cb451-36"><a href="bayesian-models-of-cognition.html#cb451-36" tabindex="-1"></a>    )</span>
<span id="cb451-37"><a href="bayesian-models-of-cognition.html#cb451-37" tabindex="-1"></a>  })</span>
<span id="cb451-38"><a href="bayesian-models-of-cognition.html#cb451-38" tabindex="-1"></a>  </span>
<span id="cb451-39"><a href="bayesian-models-of-cognition.html#cb451-39" tabindex="-1"></a>  <span class="fu">return</span>(agent_decisions)</span>
<span id="cb451-40"><a href="bayesian-models-of-cognition.html#cb451-40" tabindex="-1"></a>})</span>
<span id="cb451-41"><a href="bayesian-models-of-cognition.html#cb451-41" tabindex="-1"></a></span>
<span id="cb451-42"><a href="bayesian-models-of-cognition.html#cb451-42" tabindex="-1"></a><span class="co"># Add true parameter values to the dataset</span></span>
<span id="cb451-43"><a href="bayesian-models-of-cognition.html#cb451-43" tabindex="-1"></a>multilevel_sim_data <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb451-44"><a href="bayesian-models-of-cognition.html#cb451-44" tabindex="-1"></a>  <span class="fu">left_join</span>(agent_params, <span class="at">by =</span> <span class="st">&quot;agent_id&quot;</span>)</span>
<span id="cb451-45"><a href="bayesian-models-of-cognition.html#cb451-45" tabindex="-1"></a></span>
<span id="cb451-46"><a href="bayesian-models-of-cognition.html#cb451-46" tabindex="-1"></a><span class="co"># Add descriptive labels</span></span>
<span id="cb451-47"><a href="bayesian-models-of-cognition.html#cb451-47" tabindex="-1"></a>multilevel_sim_data <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb451-48"><a href="bayesian-models-of-cognition.html#cb451-48" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb451-49"><a href="bayesian-models-of-cognition.html#cb451-49" tabindex="-1"></a>    <span class="at">social_evidence =</span> <span class="fu">factor</span>(blue2,</span>
<span id="cb451-50"><a href="bayesian-models-of-cognition.html#cb451-50" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb451-51"><a href="bayesian-models-of-cognition.html#cb451-51" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Weak Red&quot;</span>, <span class="st">&quot;Weak Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>))</span>
<span id="cb451-52"><a href="bayesian-models-of-cognition.html#cb451-52" tabindex="-1"></a>  )</span>
<span id="cb451-53"><a href="bayesian-models-of-cognition.html#cb451-53" tabindex="-1"></a></span>
<span id="cb451-54"><a href="bayesian-models-of-cognition.html#cb451-54" tabindex="-1"></a><span class="co"># Examine a sample of the data</span></span>
<span id="cb451-55"><a href="bayesian-models-of-cognition.html#cb451-55" tabindex="-1"></a><span class="fu">head</span>(multilevel_sim_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   agent_id blue1 blue2 total1 total2 choice choice_binary expected_rate confidence weight_direct weight_social
##      &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;          &lt;int&gt;         &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
## 1        1     0     0      8      3 Red                0        0.0862      0.842         0.900         0.799
## 2        1     0     1      8      3 Red                0        0.155       0.796         0.900         0.799
## 3        1     0     2      8      3 Red                0        0.224       0.765         0.900         0.799
## 4        1     0     3      8      3 Blue               1        0.293       0.744         0.900         0.799
## 5        1     1     0      8      3 Red                0        0.164       0.791         0.900         0.799
## 6        1     1     1      8      3 Red                0        0.233       0.762         0.900         0.799
## # ℹ 1 more variable: social_evidence &lt;fct&gt;</code></pre>
</div>
<div id="visualizing-individual-differences-in-decision-patterns" class="section level3 hasAnchor" number="10.17.2">
<h3><span class="header-section-number">10.17.2</span> Visualizing Individual Differences in Decision Patterns<a href="bayesian-models-of-cognition.html#visualizing-individual-differences-in-decision-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s visualize how different agents make decisions based on the same evidence:</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="bayesian-models-of-cognition.html#cb453-1" tabindex="-1"></a><span class="co"># Select a subset of agents to visualize</span></span>
<span id="cb453-2"><a href="bayesian-models-of-cognition.html#cb453-2" tabindex="-1"></a>viz_agents <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_agents, <span class="dv">6</span>)</span>
<span id="cb453-3"><a href="bayesian-models-of-cognition.html#cb453-3" tabindex="-1"></a></span>
<span id="cb453-4"><a href="bayesian-models-of-cognition.html#cb453-4" tabindex="-1"></a><span class="co"># Create decision curves for selected agents</span></span>
<span id="cb453-5"><a href="bayesian-models-of-cognition.html#cb453-5" tabindex="-1"></a>p_decision_curves <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb453-6"><a href="bayesian-models-of-cognition.html#cb453-6" tabindex="-1"></a>  <span class="fu">filter</span>(agent_id <span class="sc">%in%</span> viz_agents) <span class="sc">%&gt;%</span></span>
<span id="cb453-7"><a href="bayesian-models-of-cognition.html#cb453-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> expected_rate, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb453-8"><a href="bayesian-models-of-cognition.html#cb453-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb453-9"><a href="bayesian-models-of-cognition.html#cb453-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb453-10"><a href="bayesian-models-of-cognition.html#cb453-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb453-11"><a href="bayesian-models-of-cognition.html#cb453-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_id, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb453-12"><a href="bayesian-models-of-cognition.html#cb453-12" tabindex="-1"></a>    <span class="at">agent_id =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Agent&quot;</span>, x, </span>
<span id="cb453-13"><a href="bayesian-models-of-cognition.html#cb453-13" tabindex="-1"></a>                              <span class="st">&quot;</span><span class="sc">\n</span><span class="st">w₁=&quot;</span>, <span class="fu">round</span>(agent_params<span class="sc">$</span>weight_direct[<span class="fu">as.numeric</span>(x)], <span class="dv">2</span>),</span>
<span id="cb453-14"><a href="bayesian-models-of-cognition.html#cb453-14" tabindex="-1"></a>                              <span class="st">&quot;, w₂=&quot;</span>, <span class="fu">round</span>(agent_params<span class="sc">$</span>weight_social[<span class="fu">as.numeric</span>(x)], <span class="dv">2</span>))</span>
<span id="cb453-15"><a href="bayesian-models-of-cognition.html#cb453-15" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb453-16"><a href="bayesian-models-of-cognition.html#cb453-16" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb453-17"><a href="bayesian-models-of-cognition.html#cb453-17" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb453-18"><a href="bayesian-models-of-cognition.html#cb453-18" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb453-19"><a href="bayesian-models-of-cognition.html#cb453-19" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Individual Differences in Evidence Integration&quot;</span>,</span>
<span id="cb453-20"><a href="bayesian-models-of-cognition.html#cb453-20" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Expected probability of blue marble across evidence combinations&quot;</span>,</span>
<span id="cb453-21"><a href="bayesian-models-of-cognition.html#cb453-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Evidence (out of 8)&quot;</span>,</span>
<span id="cb453-22"><a href="bayesian-models-of-cognition.html#cb453-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Expected Probability of Blue&quot;</span>,</span>
<span id="cb453-23"><a href="bayesian-models-of-cognition.html#cb453-23" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span></span>
<span id="cb453-24"><a href="bayesian-models-of-cognition.html#cb453-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb453-25"><a href="bayesian-models-of-cognition.html#cb453-25" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb453-26"><a href="bayesian-models-of-cognition.html#cb453-26" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb453-27"><a href="bayesian-models-of-cognition.html#cb453-27" tabindex="-1"></a></span>
<span id="cb453-28"><a href="bayesian-models-of-cognition.html#cb453-28" tabindex="-1"></a><span class="co"># Create decision boundary plot</span></span>
<span id="cb453-29"><a href="bayesian-models-of-cognition.html#cb453-29" tabindex="-1"></a>p_decision_boundaries <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb453-30"><a href="bayesian-models-of-cognition.html#cb453-30" tabindex="-1"></a>  <span class="fu">filter</span>(agent_id <span class="sc">%in%</span> viz_agents) <span class="sc">%&gt;%</span></span>
<span id="cb453-31"><a href="bayesian-models-of-cognition.html#cb453-31" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> blue2)) <span class="sc">+</span></span>
<span id="cb453-32"><a href="bayesian-models-of-cognition.html#cb453-32" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> choice)) <span class="sc">+</span></span>
<span id="cb453-33"><a href="bayesian-models-of-cognition.html#cb453-33" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_id, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb453-34"><a href="bayesian-models-of-cognition.html#cb453-34" tabindex="-1"></a>    <span class="at">agent_id =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Agent&quot;</span>, x, </span>
<span id="cb453-35"><a href="bayesian-models-of-cognition.html#cb453-35" tabindex="-1"></a>                              <span class="st">&quot;</span><span class="sc">\n</span><span class="st">w₁=&quot;</span>, <span class="fu">round</span>(agent_params<span class="sc">$</span>weight_direct[<span class="fu">as.numeric</span>(x)], <span class="dv">2</span>),</span>
<span id="cb453-36"><a href="bayesian-models-of-cognition.html#cb453-36" tabindex="-1"></a>                              <span class="st">&quot;, w₂=&quot;</span>, <span class="fu">round</span>(agent_params<span class="sc">$</span>weight_social[<span class="fu">as.numeric</span>(x)], <span class="dv">2</span>))</span>
<span id="cb453-37"><a href="bayesian-models-of-cognition.html#cb453-37" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb453-38"><a href="bayesian-models-of-cognition.html#cb453-38" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Red&quot;</span> <span class="ot">=</span> <span class="st">&quot;firebrick&quot;</span>, <span class="st">&quot;Blue&quot;</span> <span class="ot">=</span> <span class="st">&quot;royalblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb453-39"><a href="bayesian-models-of-cognition.html#cb453-39" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb453-40"><a href="bayesian-models-of-cognition.html#cb453-40" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb453-41"><a href="bayesian-models-of-cognition.html#cb453-41" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb453-42"><a href="bayesian-models-of-cognition.html#cb453-42" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Decision Boundaries Across Individuals&quot;</span>,</span>
<span id="cb453-43"><a href="bayesian-models-of-cognition.html#cb453-43" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Color shows whether agent chooses blue or red&quot;</span>,</span>
<span id="cb453-44"><a href="bayesian-models-of-cognition.html#cb453-44" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Evidence (out of 8)&quot;</span>,</span>
<span id="cb453-45"><a href="bayesian-models-of-cognition.html#cb453-45" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Number of Blue Signals in Social Evidence (out of 3)&quot;</span>,</span>
<span id="cb453-46"><a href="bayesian-models-of-cognition.html#cb453-46" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Decision&quot;</span></span>
<span id="cb453-47"><a href="bayesian-models-of-cognition.html#cb453-47" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb453-48"><a href="bayesian-models-of-cognition.html#cb453-48" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb453-49"><a href="bayesian-models-of-cognition.html#cb453-49" tabindex="-1"></a></span>
<span id="cb453-50"><a href="bayesian-models-of-cognition.html#cb453-50" tabindex="-1"></a><span class="co"># Display the visualizations</span></span>
<span id="cb453-51"><a href="bayesian-models-of-cognition.html#cb453-51" tabindex="-1"></a>p_decision_curves</span></code></pre></div>
<p><img src="series_files/figure-html/multilevel_viz-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="bayesian-models-of-cognition.html#cb454-1" tabindex="-1"></a>p_decision_boundaries</span></code></pre></div>
<p><img src="series_files/figure-html/multilevel_viz-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="bayesian-models-of-cognition.html#cb455-1" tabindex="-1"></a><span class="co"># Plot the distribution of agent parameters</span></span>
<span id="cb455-2"><a href="bayesian-models-of-cognition.html#cb455-2" tabindex="-1"></a>p_param_distribution <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agent_params, <span class="fu">aes</span>(<span class="at">x =</span> weight_direct, <span class="at">y =</span> weight_social)) <span class="sc">+</span></span>
<span id="cb455-3"><a href="bayesian-models-of-cognition.html#cb455-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb455-4"><a href="bayesian-models-of-cognition.html#cb455-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> agent_id), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb455-5"><a href="bayesian-models-of-cognition.html#cb455-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> population_mean_social, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb455-6"><a href="bayesian-models-of-cognition.html#cb455-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> population_mean_direct, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb455-7"><a href="bayesian-models-of-cognition.html#cb455-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb455-8"><a href="bayesian-models-of-cognition.html#cb455-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Distribution of Agent Parameters&quot;</span>,</span>
<span id="cb455-9"><a href="bayesian-models-of-cognition.html#cb455-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Each point represents one agent; dashed lines show population means&quot;</span>,</span>
<span id="cb455-10"><a href="bayesian-models-of-cognition.html#cb455-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Weight for Direct Evidence (w₁)&quot;</span>,</span>
<span id="cb455-11"><a href="bayesian-models-of-cognition.html#cb455-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight for Social Evidence (w₂)&quot;</span></span>
<span id="cb455-12"><a href="bayesian-models-of-cognition.html#cb455-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb455-13"><a href="bayesian-models-of-cognition.html#cb455-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb455-14"><a href="bayesian-models-of-cognition.html#cb455-14" tabindex="-1"></a></span>
<span id="cb455-15"><a href="bayesian-models-of-cognition.html#cb455-15" tabindex="-1"></a>p_param_distribution</span></code></pre></div>
<p><img src="series_files/figure-html/multilevel_viz-3.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Looking at these visualizations, we can see clear individual differences in how agents integrate evidence:</p>
<ul>
<li>Some agents give more weight to direct evidence, requiring less direct evidence to choose “blue” regardless of social evidence</li>
<li>Others are more influenced by social information, showing greater spacing between the different social evidence lines</li>
<li>These differences create unique decision boundaries for each agent, where they transition from choosing red to blue</li>
</ul>
</div>
<div id="implementing-the-multilevel-simple-beta-binomial-model-in-stan" class="section level3 hasAnchor" number="10.17.3">
<h3><span class="header-section-number">10.17.3</span> Implementing the Multilevel Simple Beta-Binomial Model in Stan<a href="bayesian-models-of-cognition.html#implementing-the-multilevel-simple-beta-binomial-model-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, let’s implement a multilevel version of our simple beta-binomial model. This model assumes equal weights (1.0) for both evidence sources but allows individuals to have different baseline tendencies to choose blue versus red.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="bayesian-models-of-cognition.html#cb456-1" tabindex="-1"></a><span class="co"># Stan model for multilevel simple beta-binomial</span></span>
<span id="cb456-2"><a href="bayesian-models-of-cognition.html#cb456-2" tabindex="-1"></a>multilevel_simple_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb456-3"><a href="bayesian-models-of-cognition.html#cb456-3" tabindex="-1"></a><span class="st">// Multilevel Simple Beta-Binomial Model</span></span>
<span id="cb456-4"><a href="bayesian-models-of-cognition.html#cb456-4" tabindex="-1"></a><span class="st">// This model assumes equal weights for evidence sources but allows </span></span>
<span id="cb456-5"><a href="bayesian-models-of-cognition.html#cb456-5" tabindex="-1"></a><span class="st">// individual variation in baseline tendencies</span></span>
<span id="cb456-6"><a href="bayesian-models-of-cognition.html#cb456-6" tabindex="-1"></a></span>
<span id="cb456-7"><a href="bayesian-models-of-cognition.html#cb456-7" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb456-8"><a href="bayesian-models-of-cognition.html#cb456-8" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Total number of observations</span></span>
<span id="cb456-9"><a href="bayesian-models-of-cognition.html#cb456-9" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; J;                        // Number of subjects</span></span>
<span id="cb456-10"><a href="bayesian-models-of-cognition.html#cb456-10" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1, upper=J&gt; agent_id;  // Agent ID for each observation</span></span>
<span id="cb456-11"><a href="bayesian-models-of-cognition.html#cb456-11" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb456-12"><a href="bayesian-models-of-cognition.html#cb456-12" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles)</span></span>
<span id="cb456-13"><a href="bayesian-models-of-cognition.html#cb456-13" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;          // Total direct evidence</span></span>
<span id="cb456-14"><a href="bayesian-models-of-cognition.html#cb456-14" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals)</span></span>
<span id="cb456-15"><a href="bayesian-models-of-cognition.html#cb456-15" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;          // Total social evidence</span></span>
<span id="cb456-16"><a href="bayesian-models-of-cognition.html#cb456-16" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-17"><a href="bayesian-models-of-cognition.html#cb456-17" tabindex="-1"></a></span>
<span id="cb456-18"><a href="bayesian-models-of-cognition.html#cb456-18" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb456-19"><a href="bayesian-models-of-cognition.html#cb456-19" tabindex="-1"></a><span class="st">  // Population-level (fixed) effects</span></span>
<span id="cb456-20"><a href="bayesian-models-of-cognition.html#cb456-20" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; population_theta; // Population average probability</span></span>
<span id="cb456-21"><a href="bayesian-models-of-cognition.html#cb456-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-22"><a href="bayesian-models-of-cognition.html#cb456-22" tabindex="-1"></a><span class="st">  // Individual-level (random) effects</span></span>
<span id="cb456-23"><a href="bayesian-models-of-cognition.html#cb456-23" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; tau;                      // Between-subject variability</span></span>
<span id="cb456-24"><a href="bayesian-models-of-cognition.html#cb456-24" tabindex="-1"></a><span class="st">  vector[J] z;                            // Standardized individual deviations</span></span>
<span id="cb456-25"><a href="bayesian-models-of-cognition.html#cb456-25" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-26"><a href="bayesian-models-of-cognition.html#cb456-26" tabindex="-1"></a></span>
<span id="cb456-27"><a href="bayesian-models-of-cognition.html#cb456-27" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb456-28"><a href="bayesian-models-of-cognition.html#cb456-28" tabindex="-1"></a><span class="st">  // Individual-level parameters</span></span>
<span id="cb456-29"><a href="bayesian-models-of-cognition.html#cb456-29" tabindex="-1"></a><span class="st">  vector&lt;lower=0, upper=1&gt;[J] theta;      // Individual probabilities</span></span>
<span id="cb456-30"><a href="bayesian-models-of-cognition.html#cb456-30" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-31"><a href="bayesian-models-of-cognition.html#cb456-31" tabindex="-1"></a><span class="st">  // Non-centered parameterization</span></span>
<span id="cb456-32"><a href="bayesian-models-of-cognition.html#cb456-32" tabindex="-1"></a><span class="st">  for (j in 1:J) {</span></span>
<span id="cb456-33"><a href="bayesian-models-of-cognition.html#cb456-33" tabindex="-1"></a><span class="st">    // Transform z to probability space via logit</span></span>
<span id="cb456-34"><a href="bayesian-models-of-cognition.html#cb456-34" tabindex="-1"></a><span class="st">    real logit_population = logit(population_theta);</span></span>
<span id="cb456-35"><a href="bayesian-models-of-cognition.html#cb456-35" tabindex="-1"></a><span class="st">    real logit_individual = logit_population + z[j] * tau;</span></span>
<span id="cb456-36"><a href="bayesian-models-of-cognition.html#cb456-36" tabindex="-1"></a><span class="st">    theta[j] = inv_logit(logit_individual);</span></span>
<span id="cb456-37"><a href="bayesian-models-of-cognition.html#cb456-37" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb456-38"><a href="bayesian-models-of-cognition.html#cb456-38" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-39"><a href="bayesian-models-of-cognition.html#cb456-39" tabindex="-1"></a></span>
<span id="cb456-40"><a href="bayesian-models-of-cognition.html#cb456-40" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb456-41"><a href="bayesian-models-of-cognition.html#cb456-41" tabindex="-1"></a><span class="st">  // Priors for population parameters</span></span>
<span id="cb456-42"><a href="bayesian-models-of-cognition.html#cb456-42" tabindex="-1"></a><span class="st">  population_theta ~ beta(1, 1);        // Uniform prior</span></span>
<span id="cb456-43"><a href="bayesian-models-of-cognition.html#cb456-43" tabindex="-1"></a><span class="st">  tau ~ exponential(1);                 // Prior for between-subject variability</span></span>
<span id="cb456-44"><a href="bayesian-models-of-cognition.html#cb456-44" tabindex="-1"></a><span class="st">  z ~ std_normal();                     // Prior for standardized random effects</span></span>
<span id="cb456-45"><a href="bayesian-models-of-cognition.html#cb456-45" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-46"><a href="bayesian-models-of-cognition.html#cb456-46" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb456-47"><a href="bayesian-models-of-cognition.html#cb456-47" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb456-48"><a href="bayesian-models-of-cognition.html#cb456-48" tabindex="-1"></a><span class="st">    // Calculate combined theta for this specific decision</span></span>
<span id="cb456-49"><a href="bayesian-models-of-cognition.html#cb456-49" tabindex="-1"></a><span class="st">    real p_blue1 = (blue1[i] + 1.0) / (total1[i] + 2.0); // Beta-binomial posterior</span></span>
<span id="cb456-50"><a href="bayesian-models-of-cognition.html#cb456-50" tabindex="-1"></a><span class="st">    real p_blue2 = (blue2[i] + 1.0) / (total2[i] + 2.0); // Beta-binomial posterior</span></span>
<span id="cb456-51"><a href="bayesian-models-of-cognition.html#cb456-51" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb456-52"><a href="bayesian-models-of-cognition.html#cb456-52" tabindex="-1"></a><span class="st">    // Simple average of the two probabilities</span></span>
<span id="cb456-53"><a href="bayesian-models-of-cognition.html#cb456-53" tabindex="-1"></a><span class="st">    real combined_theta = (p_blue1 + p_blue2) / 2.0;</span></span>
<span id="cb456-54"><a href="bayesian-models-of-cognition.html#cb456-54" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb456-55"><a href="bayesian-models-of-cognition.html#cb456-55" tabindex="-1"></a><span class="st">    // Individual adjustment to the combined theta</span></span>
<span id="cb456-56"><a href="bayesian-models-of-cognition.html#cb456-56" tabindex="-1"></a><span class="st">    real adjusted_theta = theta[agent_id[i]] * combined_theta;</span></span>
<span id="cb456-57"><a href="bayesian-models-of-cognition.html#cb456-57" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb456-58"><a href="bayesian-models-of-cognition.html#cb456-58" tabindex="-1"></a><span class="st">    // Bound probability between 0 and 1</span></span>
<span id="cb456-59"><a href="bayesian-models-of-cognition.html#cb456-59" tabindex="-1"></a><span class="st">    adjusted_theta = fmin(fmax(adjusted_theta, 0.001), 0.999);</span></span>
<span id="cb456-60"><a href="bayesian-models-of-cognition.html#cb456-60" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb456-61"><a href="bayesian-models-of-cognition.html#cb456-61" tabindex="-1"></a><span class="st">    // Model choice</span></span>
<span id="cb456-62"><a href="bayesian-models-of-cognition.html#cb456-62" tabindex="-1"></a><span class="st">    choice[i] ~ bernoulli(adjusted_theta);</span></span>
<span id="cb456-63"><a href="bayesian-models-of-cognition.html#cb456-63" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb456-64"><a href="bayesian-models-of-cognition.html#cb456-64" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-65"><a href="bayesian-models-of-cognition.html#cb456-65" tabindex="-1"></a></span>
<span id="cb456-66"><a href="bayesian-models-of-cognition.html#cb456-66" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb456-67"><a href="bayesian-models-of-cognition.html#cb456-67" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb456-68"><a href="bayesian-models-of-cognition.html#cb456-68" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb456-69"><a href="bayesian-models-of-cognition.html#cb456-69" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-70"><a href="bayesian-models-of-cognition.html#cb456-70" tabindex="-1"></a><span class="st">  // Population and individual predictions</span></span>
<span id="cb456-71"><a href="bayesian-models-of-cognition.html#cb456-71" tabindex="-1"></a><span class="st">  array[N] int pred_choice;</span></span>
<span id="cb456-72"><a href="bayesian-models-of-cognition.html#cb456-72" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-73"><a href="bayesian-models-of-cognition.html#cb456-73" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb456-74"><a href="bayesian-models-of-cognition.html#cb456-74" tabindex="-1"></a><span class="st">    // Calculate the same combined theta as in the model block</span></span>
<span id="cb456-75"><a href="bayesian-models-of-cognition.html#cb456-75" tabindex="-1"></a><span class="st">    real p_blue1 = (blue1[i] + 1.0) / (total1[i] + 2.0);</span></span>
<span id="cb456-76"><a href="bayesian-models-of-cognition.html#cb456-76" tabindex="-1"></a><span class="st">    real p_blue2 = (blue2[i] + 1.0) / (total2[i] + 2.0);</span></span>
<span id="cb456-77"><a href="bayesian-models-of-cognition.html#cb456-77" tabindex="-1"></a><span class="st">    real combined_theta = (p_blue1 + p_blue2) / 2.0;</span></span>
<span id="cb456-78"><a href="bayesian-models-of-cognition.html#cb456-78" tabindex="-1"></a><span class="st">    real adjusted_theta = theta[agent_id[i]] * combined_theta;</span></span>
<span id="cb456-79"><a href="bayesian-models-of-cognition.html#cb456-79" tabindex="-1"></a><span class="st">    adjusted_theta = fmin(fmax(adjusted_theta, 0.001), 0.999);</span></span>
<span id="cb456-80"><a href="bayesian-models-of-cognition.html#cb456-80" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb456-81"><a href="bayesian-models-of-cognition.html#cb456-81" tabindex="-1"></a><span class="st">    // Generate predictions</span></span>
<span id="cb456-82"><a href="bayesian-models-of-cognition.html#cb456-82" tabindex="-1"></a><span class="st">    pred_choice[i] = bernoulli_rng(adjusted_theta);</span></span>
<span id="cb456-83"><a href="bayesian-models-of-cognition.html#cb456-83" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb456-84"><a href="bayesian-models-of-cognition.html#cb456-84" tabindex="-1"></a><span class="st">    // Calculate log likelihood</span></span>
<span id="cb456-85"><a href="bayesian-models-of-cognition.html#cb456-85" tabindex="-1"></a><span class="st">    log_lik[i] = bernoulli_lpmf(choice[i] | adjusted_theta);</span></span>
<span id="cb456-86"><a href="bayesian-models-of-cognition.html#cb456-86" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb456-87"><a href="bayesian-models-of-cognition.html#cb456-87" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-88"><a href="bayesian-models-of-cognition.html#cb456-88" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb456-89"><a href="bayesian-models-of-cognition.html#cb456-89" tabindex="-1"></a></span>
<span id="cb456-90"><a href="bayesian-models-of-cognition.html#cb456-90" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb456-91"><a href="bayesian-models-of-cognition.html#cb456-91" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb456-92"><a href="bayesian-models-of-cognition.html#cb456-92" tabindex="-1"></a>  multilevel_simple_stan,</span>
<span id="cb456-93"><a href="bayesian-models-of-cognition.html#cb456-93" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb456-94"><a href="bayesian-models-of-cognition.html#cb456-94" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W9_multilevel_simple_beta_binomial.stan&quot;</span></span>
<span id="cb456-95"><a href="bayesian-models-of-cognition.html#cb456-95" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W9_multilevel_simple_beta_binomial.stan&quot;</code></pre>
</div>
<div id="implementing-the-multilevel-weighted-beta-binomial-model-in-stan" class="section level3 hasAnchor" number="10.17.4">
<h3><span class="header-section-number">10.17.4</span> Implementing the Multilevel Weighted Beta-Binomial Model in Stan<a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s implement the multilevel weighted beta-binomial model, which allows both population-level estimates of evidence weights and individual variations around these population means.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="bayesian-models-of-cognition.html#cb458-1" tabindex="-1"></a>multilevel_weighted_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb458-2"><a href="bayesian-models-of-cognition.html#cb458-2" tabindex="-1"></a><span class="st">// Multilevel Weighted Beta-Binomial Model with Relative Weighting</span></span>
<span id="cb458-3"><a href="bayesian-models-of-cognition.html#cb458-3" tabindex="-1"></a><span class="st">// This model parameterizes weights in relation to each other for better identifiability</span></span>
<span id="cb458-4"><a href="bayesian-models-of-cognition.html#cb458-4" tabindex="-1"></a></span>
<span id="cb458-5"><a href="bayesian-models-of-cognition.html#cb458-5" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb458-6"><a href="bayesian-models-of-cognition.html#cb458-6" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Total number of observations</span></span>
<span id="cb458-7"><a href="bayesian-models-of-cognition.html#cb458-7" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; J;                        // Number of subjects</span></span>
<span id="cb458-8"><a href="bayesian-models-of-cognition.html#cb458-8" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1, upper=J&gt; agent_id;  // Agent ID for each observation</span></span>
<span id="cb458-9"><a href="bayesian-models-of-cognition.html#cb458-9" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb458-10"><a href="bayesian-models-of-cognition.html#cb458-10" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles)</span></span>
<span id="cb458-11"><a href="bayesian-models-of-cognition.html#cb458-11" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;          // Total direct evidence</span></span>
<span id="cb458-12"><a href="bayesian-models-of-cognition.html#cb458-12" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals)</span></span>
<span id="cb458-13"><a href="bayesian-models-of-cognition.html#cb458-13" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;          // Total social evidence</span></span>
<span id="cb458-14"><a href="bayesian-models-of-cognition.html#cb458-14" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb458-15"><a href="bayesian-models-of-cognition.html#cb458-15" tabindex="-1"></a></span>
<span id="cb458-16"><a href="bayesian-models-of-cognition.html#cb458-16" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb458-17"><a href="bayesian-models-of-cognition.html#cb458-17" tabindex="-1"></a><span class="st">  // Population-level (fixed) effects</span></span>
<span id="cb458-18"><a href="bayesian-models-of-cognition.html#cb458-18" tabindex="-1"></a><span class="st">  real mu_weight_ratio;                  // Population mean for relative weight (direct/social)</span></span>
<span id="cb458-19"><a href="bayesian-models-of-cognition.html#cb458-19" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-20"><a href="bayesian-models-of-cognition.html#cb458-20" tabindex="-1"></a><span class="st">  // Population-level standard deviation</span></span>
<span id="cb458-21"><a href="bayesian-models-of-cognition.html#cb458-21" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_weight_ratio;      // Between-subject variability in relative weighting</span></span>
<span id="cb458-22"><a href="bayesian-models-of-cognition.html#cb458-22" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-23"><a href="bayesian-models-of-cognition.html#cb458-23" tabindex="-1"></a><span class="st">  // Individual-level (random) effects</span></span>
<span id="cb458-24"><a href="bayesian-models-of-cognition.html#cb458-24" tabindex="-1"></a><span class="st">  vector[J] z;                           // Standardized individual deviations</span></span>
<span id="cb458-25"><a href="bayesian-models-of-cognition.html#cb458-25" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-26"><a href="bayesian-models-of-cognition.html#cb458-26" tabindex="-1"></a><span class="st">  // Overall evidence scaling factor (shared across both sources)</span></span>
<span id="cb458-27"><a href="bayesian-models-of-cognition.html#cb458-27" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; mu_scaling;              // Population mean for overall scaling</span></span>
<span id="cb458-28"><a href="bayesian-models-of-cognition.html#cb458-28" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_scaling;           // Between-subject variability in scaling</span></span>
<span id="cb458-29"><a href="bayesian-models-of-cognition.html#cb458-29" tabindex="-1"></a><span class="st">  vector[J] z_scaling;                   // Individual scaling factors (standardized)</span></span>
<span id="cb458-30"><a href="bayesian-models-of-cognition.html#cb458-30" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb458-31"><a href="bayesian-models-of-cognition.html#cb458-31" tabindex="-1"></a></span>
<span id="cb458-32"><a href="bayesian-models-of-cognition.html#cb458-32" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb458-33"><a href="bayesian-models-of-cognition.html#cb458-33" tabindex="-1"></a><span class="st">  // Individual-level parameters</span></span>
<span id="cb458-34"><a href="bayesian-models-of-cognition.html#cb458-34" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_ratio;       // Individual relative weights (direct/social)</span></span>
<span id="cb458-35"><a href="bayesian-models-of-cognition.html#cb458-35" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] scaling_factor;     // Individual overall scaling factors</span></span>
<span id="cb458-36"><a href="bayesian-models-of-cognition.html#cb458-36" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_direct;      // Individual weights for direct evidence</span></span>
<span id="cb458-37"><a href="bayesian-models-of-cognition.html#cb458-37" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_social;      // Individual weights for social evidence</span></span>
<span id="cb458-38"><a href="bayesian-models-of-cognition.html#cb458-38" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-39"><a href="bayesian-models-of-cognition.html#cb458-39" tabindex="-1"></a><span class="st">  // Non-centered parameterization for weight ratio</span></span>
<span id="cb458-40"><a href="bayesian-models-of-cognition.html#cb458-40" tabindex="-1"></a><span class="st">  for (j in 1:J) {</span></span>
<span id="cb458-41"><a href="bayesian-models-of-cognition.html#cb458-41" tabindex="-1"></a><span class="st">    // Transform standardized parameters to natural scale</span></span>
<span id="cb458-42"><a href="bayesian-models-of-cognition.html#cb458-42" tabindex="-1"></a><span class="st">    weight_ratio[j] = exp(mu_weight_ratio + z[j] * sigma_weight_ratio);</span></span>
<span id="cb458-43"><a href="bayesian-models-of-cognition.html#cb458-43" tabindex="-1"></a><span class="st">    scaling_factor[j] = exp(mu_scaling + z_scaling[j] * sigma_scaling);</span></span>
<span id="cb458-44"><a href="bayesian-models-of-cognition.html#cb458-44" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-45"><a href="bayesian-models-of-cognition.html#cb458-45" tabindex="-1"></a><span class="st">    // Calculate individual weights</span></span>
<span id="cb458-46"><a href="bayesian-models-of-cognition.html#cb458-46" tabindex="-1"></a><span class="st">    // The sum of weights is determined by the scaling factor</span></span>
<span id="cb458-47"><a href="bayesian-models-of-cognition.html#cb458-47" tabindex="-1"></a><span class="st">    // The ratio between weights is determined by weight_ratio</span></span>
<span id="cb458-48"><a href="bayesian-models-of-cognition.html#cb458-48" tabindex="-1"></a><span class="st">    weight_direct[j] = scaling_factor[j] * weight_ratio[j] / (1 + weight_ratio[j]);</span></span>
<span id="cb458-49"><a href="bayesian-models-of-cognition.html#cb458-49" tabindex="-1"></a><span class="st">    weight_social[j] = scaling_factor[j] / (1 + weight_ratio[j]);</span></span>
<span id="cb458-50"><a href="bayesian-models-of-cognition.html#cb458-50" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb458-51"><a href="bayesian-models-of-cognition.html#cb458-51" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb458-52"><a href="bayesian-models-of-cognition.html#cb458-52" tabindex="-1"></a></span>
<span id="cb458-53"><a href="bayesian-models-of-cognition.html#cb458-53" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb458-54"><a href="bayesian-models-of-cognition.html#cb458-54" tabindex="-1"></a><span class="st">  // Priors for population parameters</span></span>
<span id="cb458-55"><a href="bayesian-models-of-cognition.html#cb458-55" tabindex="-1"></a><span class="st">  mu_weight_ratio ~ normal(0, 1);        // Prior for log weight ratio centered at 0 (equal weights)</span></span>
<span id="cb458-56"><a href="bayesian-models-of-cognition.html#cb458-56" tabindex="-1"></a><span class="st">  sigma_weight_ratio ~ exponential(2);   // Prior for between-subject variability</span></span>
<span id="cb458-57"><a href="bayesian-models-of-cognition.html#cb458-57" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-58"><a href="bayesian-models-of-cognition.html#cb458-58" tabindex="-1"></a><span class="st">  mu_scaling ~ normal(0, 1);             // Prior for log scaling factor</span></span>
<span id="cb458-59"><a href="bayesian-models-of-cognition.html#cb458-59" tabindex="-1"></a><span class="st">  sigma_scaling ~ exponential(2);        // Prior for scaling variability</span></span>
<span id="cb458-60"><a href="bayesian-models-of-cognition.html#cb458-60" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-61"><a href="bayesian-models-of-cognition.html#cb458-61" tabindex="-1"></a><span class="st">  // Priors for individual random effects</span></span>
<span id="cb458-62"><a href="bayesian-models-of-cognition.html#cb458-62" tabindex="-1"></a><span class="st">  z ~ std_normal();                      // Standard normal prior for weight ratio z-scores</span></span>
<span id="cb458-63"><a href="bayesian-models-of-cognition.html#cb458-63" tabindex="-1"></a><span class="st">  z_scaling ~ std_normal();              // Standard normal prior for scaling z-scores</span></span>
<span id="cb458-64"><a href="bayesian-models-of-cognition.html#cb458-64" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-65"><a href="bayesian-models-of-cognition.html#cb458-65" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb458-66"><a href="bayesian-models-of-cognition.html#cb458-66" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb458-67"><a href="bayesian-models-of-cognition.html#cb458-67" tabindex="-1"></a><span class="st">    // Get weights for this person</span></span>
<span id="cb458-68"><a href="bayesian-models-of-cognition.html#cb458-68" tabindex="-1"></a><span class="st">    real w_direct = weight_direct[agent_id[i]];</span></span>
<span id="cb458-69"><a href="bayesian-models-of-cognition.html#cb458-69" tabindex="-1"></a><span class="st">    real w_social = weight_social[agent_id[i]];</span></span>
<span id="cb458-70"><a href="bayesian-models-of-cognition.html#cb458-70" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-71"><a href="bayesian-models-of-cognition.html#cb458-71" tabindex="-1"></a><span class="st">    // Calculate weighted evidence</span></span>
<span id="cb458-72"><a href="bayesian-models-of-cognition.html#cb458-72" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * w_direct;</span></span>
<span id="cb458-73"><a href="bayesian-models-of-cognition.html#cb458-73" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * w_direct;</span></span>
<span id="cb458-74"><a href="bayesian-models-of-cognition.html#cb458-74" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * w_social;</span></span>
<span id="cb458-75"><a href="bayesian-models-of-cognition.html#cb458-75" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * w_social;</span></span>
<span id="cb458-76"><a href="bayesian-models-of-cognition.html#cb458-76" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-77"><a href="bayesian-models-of-cognition.html#cb458-77" tabindex="-1"></a><span class="st">    // Calculate Beta parameters for Bayesian integration</span></span>
<span id="cb458-78"><a href="bayesian-models-of-cognition.html#cb458-78" tabindex="-1"></a><span class="st">    real alpha_post = 1 + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb458-79"><a href="bayesian-models-of-cognition.html#cb458-79" tabindex="-1"></a><span class="st">    real beta_post = 1 + weighted_red1 + weighted_red2;</span></span>
<span id="cb458-80"><a href="bayesian-models-of-cognition.html#cb458-80" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-81"><a href="bayesian-models-of-cognition.html#cb458-81" tabindex="-1"></a><span class="st">    // Expected probability from integrated evidence</span></span>
<span id="cb458-82"><a href="bayesian-models-of-cognition.html#cb458-82" tabindex="-1"></a><span class="st">    real expected_prob = alpha_post / (alpha_post + beta_post);</span></span>
<span id="cb458-83"><a href="bayesian-models-of-cognition.html#cb458-83" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-84"><a href="bayesian-models-of-cognition.html#cb458-84" tabindex="-1"></a><span class="st">    // Model choice</span></span>
<span id="cb458-85"><a href="bayesian-models-of-cognition.html#cb458-85" tabindex="-1"></a><span class="st">    choice[i] ~ bernoulli(expected_prob);</span></span>
<span id="cb458-86"><a href="bayesian-models-of-cognition.html#cb458-86" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb458-87"><a href="bayesian-models-of-cognition.html#cb458-87" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb458-88"><a href="bayesian-models-of-cognition.html#cb458-88" tabindex="-1"></a></span>
<span id="cb458-89"><a href="bayesian-models-of-cognition.html#cb458-89" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb458-90"><a href="bayesian-models-of-cognition.html#cb458-90" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb458-91"><a href="bayesian-models-of-cognition.html#cb458-91" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb458-92"><a href="bayesian-models-of-cognition.html#cb458-92" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-93"><a href="bayesian-models-of-cognition.html#cb458-93" tabindex="-1"></a><span class="st">  // Population and individual predictions</span></span>
<span id="cb458-94"><a href="bayesian-models-of-cognition.html#cb458-94" tabindex="-1"></a><span class="st">  array[N] int pred_choice;</span></span>
<span id="cb458-95"><a href="bayesian-models-of-cognition.html#cb458-95" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-96"><a href="bayesian-models-of-cognition.html#cb458-96" tabindex="-1"></a><span class="st">  // Convert population parameters to original weight scale for interpretation</span></span>
<span id="cb458-97"><a href="bayesian-models-of-cognition.html#cb458-97" tabindex="-1"></a><span class="st">  real population_ratio = exp(mu_weight_ratio);</span></span>
<span id="cb458-98"><a href="bayesian-models-of-cognition.html#cb458-98" tabindex="-1"></a><span class="st">  real population_scaling = exp(mu_scaling);</span></span>
<span id="cb458-99"><a href="bayesian-models-of-cognition.html#cb458-99" tabindex="-1"></a><span class="st">  real population_weight_direct = population_scaling * population_ratio / (1 + population_ratio);</span></span>
<span id="cb458-100"><a href="bayesian-models-of-cognition.html#cb458-100" tabindex="-1"></a><span class="st">  real population_weight_social = population_scaling / (1 + population_ratio);</span></span>
<span id="cb458-101"><a href="bayesian-models-of-cognition.html#cb458-101" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb458-102"><a href="bayesian-models-of-cognition.html#cb458-102" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb458-103"><a href="bayesian-models-of-cognition.html#cb458-103" tabindex="-1"></a><span class="st">    // Get weights for this person</span></span>
<span id="cb458-104"><a href="bayesian-models-of-cognition.html#cb458-104" tabindex="-1"></a><span class="st">    real w_direct = weight_direct[agent_id[i]];</span></span>
<span id="cb458-105"><a href="bayesian-models-of-cognition.html#cb458-105" tabindex="-1"></a><span class="st">    real w_social = weight_social[agent_id[i]];</span></span>
<span id="cb458-106"><a href="bayesian-models-of-cognition.html#cb458-106" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-107"><a href="bayesian-models-of-cognition.html#cb458-107" tabindex="-1"></a><span class="st">    // Calculate weighted evidence</span></span>
<span id="cb458-108"><a href="bayesian-models-of-cognition.html#cb458-108" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * w_direct;</span></span>
<span id="cb458-109"><a href="bayesian-models-of-cognition.html#cb458-109" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * w_direct;</span></span>
<span id="cb458-110"><a href="bayesian-models-of-cognition.html#cb458-110" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * w_social;</span></span>
<span id="cb458-111"><a href="bayesian-models-of-cognition.html#cb458-111" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * w_social;</span></span>
<span id="cb458-112"><a href="bayesian-models-of-cognition.html#cb458-112" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-113"><a href="bayesian-models-of-cognition.html#cb458-113" tabindex="-1"></a><span class="st">    // Calculate Beta parameters</span></span>
<span id="cb458-114"><a href="bayesian-models-of-cognition.html#cb458-114" tabindex="-1"></a><span class="st">    real alpha_post = 1 + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb458-115"><a href="bayesian-models-of-cognition.html#cb458-115" tabindex="-1"></a><span class="st">    real beta_post = 1 + weighted_red1 + weighted_red2;</span></span>
<span id="cb458-116"><a href="bayesian-models-of-cognition.html#cb458-116" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-117"><a href="bayesian-models-of-cognition.html#cb458-117" tabindex="-1"></a><span class="st">    // Expected probability</span></span>
<span id="cb458-118"><a href="bayesian-models-of-cognition.html#cb458-118" tabindex="-1"></a><span class="st">    real expected_prob = alpha_post / (alpha_post + beta_post);</span></span>
<span id="cb458-119"><a href="bayesian-models-of-cognition.html#cb458-119" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb458-120"><a href="bayesian-models-of-cognition.html#cb458-120" tabindex="-1"></a><span class="st">    // Generate predictions and calculate log likelihood</span></span>
<span id="cb458-121"><a href="bayesian-models-of-cognition.html#cb458-121" tabindex="-1"></a><span class="st">    pred_choice[i] = bernoulli_rng(expected_prob);</span></span>
<span id="cb458-122"><a href="bayesian-models-of-cognition.html#cb458-122" tabindex="-1"></a><span class="st">    log_lik[i] = bernoulli_lpmf(choice[i] | expected_prob);</span></span>
<span id="cb458-123"><a href="bayesian-models-of-cognition.html#cb458-123" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb458-124"><a href="bayesian-models-of-cognition.html#cb458-124" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb458-125"><a href="bayesian-models-of-cognition.html#cb458-125" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb458-126"><a href="bayesian-models-of-cognition.html#cb458-126" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb458-127"><a href="bayesian-models-of-cognition.html#cb458-127" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb458-128"><a href="bayesian-models-of-cognition.html#cb458-128" tabindex="-1"></a>  multilevel_weighted_stan,</span>
<span id="cb458-129"><a href="bayesian-models-of-cognition.html#cb458-129" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb458-130"><a href="bayesian-models-of-cognition.html#cb458-130" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W9_multilevel_weighted_beta_binomial.stan&quot;</span></span>
<span id="cb458-131"><a href="bayesian-models-of-cognition.html#cb458-131" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W9_multilevel_weighted_beta_binomial.stan&quot;</code></pre>
</div>
<div id="preparing-data-for-stan-fitting" class="section level3 hasAnchor" number="10.17.5">
<h3><span class="header-section-number">10.17.5</span> Preparing Data for Stan Fitting<a href="bayesian-models-of-cognition.html#preparing-data-for-stan-fitting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="bayesian-models-of-cognition.html#cb460-1" tabindex="-1"></a><span class="co"># Create data for Stan in the correct format</span></span>
<span id="cb460-2"><a href="bayesian-models-of-cognition.html#cb460-2" tabindex="-1"></a>stan_data_multilevel <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb460-3"><a href="bayesian-models-of-cognition.html#cb460-3" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(multilevel_sim_data),</span>
<span id="cb460-4"><a href="bayesian-models-of-cognition.html#cb460-4" tabindex="-1"></a>  <span class="at">J =</span> n_agents,</span>
<span id="cb460-5"><a href="bayesian-models-of-cognition.html#cb460-5" tabindex="-1"></a>  <span class="at">agent_id =</span> multilevel_sim_data<span class="sc">$</span>agent_id,</span>
<span id="cb460-6"><a href="bayesian-models-of-cognition.html#cb460-6" tabindex="-1"></a>  <span class="at">choice =</span> multilevel_sim_data<span class="sc">$</span>choice_binary,</span>
<span id="cb460-7"><a href="bayesian-models-of-cognition.html#cb460-7" tabindex="-1"></a>  <span class="at">blue1 =</span> multilevel_sim_data<span class="sc">$</span>blue1,</span>
<span id="cb460-8"><a href="bayesian-models-of-cognition.html#cb460-8" tabindex="-1"></a>  <span class="at">total1 =</span> multilevel_sim_data<span class="sc">$</span>total1,</span>
<span id="cb460-9"><a href="bayesian-models-of-cognition.html#cb460-9" tabindex="-1"></a>  <span class="at">blue2 =</span> multilevel_sim_data<span class="sc">$</span>blue2,</span>
<span id="cb460-10"><a href="bayesian-models-of-cognition.html#cb460-10" tabindex="-1"></a>  <span class="at">total2 =</span> multilevel_sim_data<span class="sc">$</span>total2</span>
<span id="cb460-11"><a href="bayesian-models-of-cognition.html#cb460-11" tabindex="-1"></a>)</span>
<span id="cb460-12"><a href="bayesian-models-of-cognition.html#cb460-12" tabindex="-1"></a></span>
<span id="cb460-13"><a href="bayesian-models-of-cognition.html#cb460-13" tabindex="-1"></a><span class="co"># Compile the Stan models</span></span>
<span id="cb460-14"><a href="bayesian-models-of-cognition.html#cb460-14" tabindex="-1"></a>file_simple_ml <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W9_multilevel_simple_beta_binomial.stan&quot;</span>)</span>
<span id="cb460-15"><a href="bayesian-models-of-cognition.html#cb460-15" tabindex="-1"></a>file_weighted_ml <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W9_multilevel_weighted_beta_binomial.stan&quot;</span>)</span>
<span id="cb460-16"><a href="bayesian-models-of-cognition.html#cb460-16" tabindex="-1"></a></span>
<span id="cb460-17"><a href="bayesian-models-of-cognition.html#cb460-17" tabindex="-1"></a><span class="co"># Check if we need to regenerate simulation results</span></span>
<span id="cb460-18"><a href="bayesian-models-of-cognition.html#cb460-18" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb460-19"><a href="bayesian-models-of-cognition.html#cb460-19" tabindex="-1"></a>  <span class="co"># Compile models</span></span>
<span id="cb460-20"><a href="bayesian-models-of-cognition.html#cb460-20" tabindex="-1"></a>  mod_simple_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_simple_ml, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb460-21"><a href="bayesian-models-of-cognition.html#cb460-21" tabindex="-1"></a>  mod_weighted_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_weighted_ml, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb460-22"><a href="bayesian-models-of-cognition.html#cb460-22" tabindex="-1"></a>  </span>
<span id="cb460-23"><a href="bayesian-models-of-cognition.html#cb460-23" tabindex="-1"></a>  <span class="co"># Fit the simple multilevel model</span></span>
<span id="cb460-24"><a href="bayesian-models-of-cognition.html#cb460-24" tabindex="-1"></a>  fit_simple_ml <span class="ot">&lt;-</span> mod_simple_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb460-25"><a href="bayesian-models-of-cognition.html#cb460-25" tabindex="-1"></a>    <span class="at">data =</span> stan_data_multilevel,</span>
<span id="cb460-26"><a href="bayesian-models-of-cognition.html#cb460-26" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb460-27"><a href="bayesian-models-of-cognition.html#cb460-27" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb460-28"><a href="bayesian-models-of-cognition.html#cb460-28" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb460-29"><a href="bayesian-models-of-cognition.html#cb460-29" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb460-30"><a href="bayesian-models-of-cognition.html#cb460-30" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb460-31"><a href="bayesian-models-of-cognition.html#cb460-31" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb460-32"><a href="bayesian-models-of-cognition.html#cb460-32" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">100</span>,</span>
<span id="cb460-33"><a href="bayesian-models-of-cognition.html#cb460-33" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.9</span></span>
<span id="cb460-34"><a href="bayesian-models-of-cognition.html#cb460-34" tabindex="-1"></a>  )</span>
<span id="cb460-35"><a href="bayesian-models-of-cognition.html#cb460-35" tabindex="-1"></a>  </span>
<span id="cb460-36"><a href="bayesian-models-of-cognition.html#cb460-36" tabindex="-1"></a>  <span class="co"># Fit the weighted multilevel model</span></span>
<span id="cb460-37"><a href="bayesian-models-of-cognition.html#cb460-37" tabindex="-1"></a>  fit_weighted_ml <span class="ot">&lt;-</span> mod_weighted_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb460-38"><a href="bayesian-models-of-cognition.html#cb460-38" tabindex="-1"></a>    <span class="at">data =</span> stan_data_multilevel,</span>
<span id="cb460-39"><a href="bayesian-models-of-cognition.html#cb460-39" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">43</span>,</span>
<span id="cb460-40"><a href="bayesian-models-of-cognition.html#cb460-40" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb460-41"><a href="bayesian-models-of-cognition.html#cb460-41" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb460-42"><a href="bayesian-models-of-cognition.html#cb460-42" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb460-43"><a href="bayesian-models-of-cognition.html#cb460-43" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb460-44"><a href="bayesian-models-of-cognition.html#cb460-44" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb460-45"><a href="bayesian-models-of-cognition.html#cb460-45" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">100</span>,</span>
<span id="cb460-46"><a href="bayesian-models-of-cognition.html#cb460-46" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.95</span></span>
<span id="cb460-47"><a href="bayesian-models-of-cognition.html#cb460-47" tabindex="-1"></a>  )</span>
<span id="cb460-48"><a href="bayesian-models-of-cognition.html#cb460-48" tabindex="-1"></a>  </span>
<span id="cb460-49"><a href="bayesian-models-of-cognition.html#cb460-49" tabindex="-1"></a>  <span class="co"># Save model fits for future use</span></span>
<span id="cb460-50"><a href="bayesian-models-of-cognition.html#cb460-50" tabindex="-1"></a>  fit_simple_ml<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_multilevel_simple.rds&quot;</span>)</span>
<span id="cb460-51"><a href="bayesian-models-of-cognition.html#cb460-51" tabindex="-1"></a>  fit_weighted_ml<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_multilevel_weighted.rds&quot;</span>)</span>
<span id="cb460-52"><a href="bayesian-models-of-cognition.html#cb460-52" tabindex="-1"></a>  </span>
<span id="cb460-53"><a href="bayesian-models-of-cognition.html#cb460-53" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Generated and saved new multilevel model fits</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb460-54"><a href="bayesian-models-of-cognition.html#cb460-54" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb460-55"><a href="bayesian-models-of-cognition.html#cb460-55" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb460-56"><a href="bayesian-models-of-cognition.html#cb460-56" tabindex="-1"></a>  fit_simple_ml <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_multilevel_simple.rds&quot;</span>)</span>
<span id="cb460-57"><a href="bayesian-models-of-cognition.html#cb460-57" tabindex="-1"></a>  fit_weighted_ml <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_multilevel_weighted.rds&quot;</span>)</span>
<span id="cb460-58"><a href="bayesian-models-of-cognition.html#cb460-58" tabindex="-1"></a>  </span>
<span id="cb460-59"><a href="bayesian-models-of-cognition.html#cb460-59" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing multilevel model fits</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb460-60"><a href="bayesian-models-of-cognition.html#cb460-60" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
## Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
## Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
## Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
## Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
## Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
## Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
## Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
## Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
## Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
## Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
## Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
## Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
## Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
## Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
## Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
## Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
## Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
## Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
## Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
## Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
## Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
## Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
## Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
## Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
## Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
## Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
## Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
## Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 2 finished in 1.7 seconds.
## Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
## Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
## Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 2.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 2.1 seconds.
## Total execution time: 2.9 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
## Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)</code></pre>
<pre><code>## Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup)</code></pre>
<pre><code>## Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)</code></pre>
<pre><code>## Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)</code></pre>
<pre><code>## Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
## Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)</code></pre>
<pre><code>## Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
## Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
## Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
## Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
## Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
## Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
## Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
## Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)</code></pre>
<pre><code>## Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
## Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
## Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
## Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
## Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
## Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
## Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
## Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
## Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
## Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
## Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
## Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
## Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
## Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
## Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
## Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
## Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
## Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 2 finished in 2.9 seconds.
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 3.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 3.1 seconds.
## Total execution time: 3.7 seconds.
## 
## Generated and saved new multilevel model fits</code></pre>
</div>
<div id="model-diagnostics-and-quality-checks" class="section level3 hasAnchor" number="10.17.6">
<h3><span class="header-section-number">10.17.6</span> Model Diagnostics and Quality Checks<a href="bayesian-models-of-cognition.html#model-diagnostics-and-quality-checks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine the model diagnostics to ensure our models have converged properly:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="bayesian-models-of-cognition.html#cb469-1" tabindex="-1"></a><span class="co"># Examine trace plots for key parameters</span></span>
<span id="cb469-2"><a href="bayesian-models-of-cognition.html#cb469-2" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb469-3"><a href="bayesian-models-of-cognition.html#cb469-3" tabindex="-1"></a><span class="fu">mcmc_trace</span>(<span class="fu">as_draws_df</span>(fit_simple_ml<span class="sc">$</span><span class="fu">draws</span>()), </span>
<span id="cb469-4"><a href="bayesian-models-of-cognition.html#cb469-4" tabindex="-1"></a>           <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;population_theta&quot;</span>, <span class="st">&quot;tau&quot;</span>), </span>
<span id="cb469-5"><a href="bayesian-models-of-cognition.html#cb469-5" tabindex="-1"></a>           <span class="at">facet_args =</span> <span class="fu">list</span>(<span class="at">ncol =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb469-6"><a href="bayesian-models-of-cognition.html#cb469-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Trace Plots for Simple Multilevel Model&quot;</span>) <span class="sc">+</span></span>
<span id="cb469-7"><a href="bayesian-models-of-cognition.html#cb469-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/model_diagnostics-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="bayesian-models-of-cognition.html#cb470-1" tabindex="-1"></a><span class="co"># Weighted model (revised parameterization)</span></span>
<span id="cb470-2"><a href="bayesian-models-of-cognition.html#cb470-2" tabindex="-1"></a><span class="fu">mcmc_trace</span>(<span class="fu">as_draws_df</span>(fit_weighted_ml<span class="sc">$</span><span class="fu">draws</span>()), </span>
<span id="cb470-3"><a href="bayesian-models-of-cognition.html#cb470-3" tabindex="-1"></a>           <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;mu_weight_ratio&quot;</span>, <span class="st">&quot;mu_scaling&quot;</span>, <span class="st">&quot;sigma_weight_ratio&quot;</span>, <span class="st">&quot;sigma_scaling&quot;</span>), </span>
<span id="cb470-4"><a href="bayesian-models-of-cognition.html#cb470-4" tabindex="-1"></a>           <span class="at">facet_args =</span> <span class="fu">list</span>(<span class="at">ncol =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb470-5"><a href="bayesian-models-of-cognition.html#cb470-5" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Trace Plots for Weighted Multilevel Model&quot;</span>) <span class="sc">+</span></span>
<span id="cb470-6"><a href="bayesian-models-of-cognition.html#cb470-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/model_diagnostics-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="parameter-recovery-analysis-1" class="section level3 hasAnchor" number="10.17.7">
<h3><span class="header-section-number">10.17.7</span> Parameter Recovery Analysis<a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s examine how well our multilevel models recovered the true individual parameters:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="bayesian-models-of-cognition.html#cb471-1" tabindex="-1"></a><span class="co"># Extract individual parameter estimates from the models</span></span>
<span id="cb471-2"><a href="bayesian-models-of-cognition.html#cb471-2" tabindex="-1"></a><span class="co"># For weighted model</span></span>
<span id="cb471-3"><a href="bayesian-models-of-cognition.html#cb471-3" tabindex="-1"></a>draws_weighted_ml <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_weighted_ml<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb471-4"><a href="bayesian-models-of-cognition.html#cb471-4" tabindex="-1"></a></span>
<span id="cb471-5"><a href="bayesian-models-of-cognition.html#cb471-5" tabindex="-1"></a><span class="co"># Extract the individual weight parameters for each agent</span></span>
<span id="cb471-6"><a href="bayesian-models-of-cognition.html#cb471-6" tabindex="-1"></a>weight_direct_samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_weighted_ml), <span class="at">ncol =</span> n_agents)</span>
<span id="cb471-7"><a href="bayesian-models-of-cognition.html#cb471-7" tabindex="-1"></a>weight_social_samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_weighted_ml), <span class="at">ncol =</span> n_agents)</span>
<span id="cb471-8"><a href="bayesian-models-of-cognition.html#cb471-8" tabindex="-1"></a>weight_ratio_samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_weighted_ml), <span class="at">ncol =</span> n_agents)</span>
<span id="cb471-9"><a href="bayesian-models-of-cognition.html#cb471-9" tabindex="-1"></a></span>
<span id="cb471-10"><a href="bayesian-models-of-cognition.html#cb471-10" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_agents) {</span>
<span id="cb471-11"><a href="bayesian-models-of-cognition.html#cb471-11" tabindex="-1"></a>  weight_direct_samples[, j] <span class="ot">&lt;-</span> draws_weighted_ml[[<span class="fu">paste0</span>(<span class="st">&quot;weight_direct[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb471-12"><a href="bayesian-models-of-cognition.html#cb471-12" tabindex="-1"></a>  weight_social_samples[, j] <span class="ot">&lt;-</span> draws_weighted_ml[[<span class="fu">paste0</span>(<span class="st">&quot;weight_social[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb471-13"><a href="bayesian-models-of-cognition.html#cb471-13" tabindex="-1"></a>  weight_ratio_samples[, j] <span class="ot">&lt;-</span> draws_weighted_ml[[<span class="fu">paste0</span>(<span class="st">&quot;weight_ratio[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb471-14"><a href="bayesian-models-of-cognition.html#cb471-14" tabindex="-1"></a>}</span>
<span id="cb471-15"><a href="bayesian-models-of-cognition.html#cb471-15" tabindex="-1"></a></span>
<span id="cb471-16"><a href="bayesian-models-of-cognition.html#cb471-16" tabindex="-1"></a><span class="co"># Calculate posterior means for each agent</span></span>
<span id="cb471-17"><a href="bayesian-models-of-cognition.html#cb471-17" tabindex="-1"></a>weight_direct_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_direct_samples)</span>
<span id="cb471-18"><a href="bayesian-models-of-cognition.html#cb471-18" tabindex="-1"></a>weight_social_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_social_samples)</span>
<span id="cb471-19"><a href="bayesian-models-of-cognition.html#cb471-19" tabindex="-1"></a>weight_ratio_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_ratio_samples)</span>
<span id="cb471-20"><a href="bayesian-models-of-cognition.html#cb471-20" tabindex="-1"></a></span>
<span id="cb471-21"><a href="bayesian-models-of-cognition.html#cb471-21" tabindex="-1"></a><span class="co"># Create dataframe for recovery analysis</span></span>
<span id="cb471-22"><a href="bayesian-models-of-cognition.html#cb471-22" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb471-23"><a href="bayesian-models-of-cognition.html#cb471-23" tabindex="-1"></a>  <span class="at">agent_id =</span> <span class="dv">1</span><span class="sc">:</span>n_agents,</span>
<span id="cb471-24"><a href="bayesian-models-of-cognition.html#cb471-24" tabindex="-1"></a>  <span class="co"># True parameter values</span></span>
<span id="cb471-25"><a href="bayesian-models-of-cognition.html#cb471-25" tabindex="-1"></a>  <span class="at">true_weight_direct =</span> agent_params<span class="sc">$</span>weight_direct,</span>
<span id="cb471-26"><a href="bayesian-models-of-cognition.html#cb471-26" tabindex="-1"></a>  <span class="at">true_weight_social =</span> agent_params<span class="sc">$</span>weight_social,</span>
<span id="cb471-27"><a href="bayesian-models-of-cognition.html#cb471-27" tabindex="-1"></a>  <span class="at">true_weight_ratio =</span> agent_params<span class="sc">$</span>weight_direct <span class="sc">/</span> agent_params<span class="sc">$</span>weight_social,</span>
<span id="cb471-28"><a href="bayesian-models-of-cognition.html#cb471-28" tabindex="-1"></a>  <span class="co"># Estimated values</span></span>
<span id="cb471-29"><a href="bayesian-models-of-cognition.html#cb471-29" tabindex="-1"></a>  <span class="at">est_weight_direct =</span> weight_direct_est,</span>
<span id="cb471-30"><a href="bayesian-models-of-cognition.html#cb471-30" tabindex="-1"></a>  <span class="at">est_weight_social =</span> weight_social_est,</span>
<span id="cb471-31"><a href="bayesian-models-of-cognition.html#cb471-31" tabindex="-1"></a>  <span class="at">est_weight_ratio =</span> weight_ratio_est</span>
<span id="cb471-32"><a href="bayesian-models-of-cognition.html#cb471-32" tabindex="-1"></a>)</span>
<span id="cb471-33"><a href="bayesian-models-of-cognition.html#cb471-33" tabindex="-1"></a></span>
<span id="cb471-34"><a href="bayesian-models-of-cognition.html#cb471-34" tabindex="-1"></a><span class="co"># Calculate estimation errors</span></span>
<span id="cb471-35"><a href="bayesian-models-of-cognition.html#cb471-35" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb471-36"><a href="bayesian-models-of-cognition.html#cb471-36" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb471-37"><a href="bayesian-models-of-cognition.html#cb471-37" tabindex="-1"></a>    <span class="at">error_direct =</span> est_weight_direct <span class="sc">-</span> true_weight_direct,</span>
<span id="cb471-38"><a href="bayesian-models-of-cognition.html#cb471-38" tabindex="-1"></a>    <span class="at">error_social =</span> est_weight_social <span class="sc">-</span> true_weight_social,</span>
<span id="cb471-39"><a href="bayesian-models-of-cognition.html#cb471-39" tabindex="-1"></a>    <span class="at">error_ratio =</span> est_weight_ratio <span class="sc">-</span> true_weight_ratio,</span>
<span id="cb471-40"><a href="bayesian-models-of-cognition.html#cb471-40" tabindex="-1"></a>    <span class="at">error_direct_pct =</span> <span class="dv">100</span> <span class="sc">*</span> error_direct <span class="sc">/</span> true_weight_direct,</span>
<span id="cb471-41"><a href="bayesian-models-of-cognition.html#cb471-41" tabindex="-1"></a>    <span class="at">error_social_pct =</span> <span class="dv">100</span> <span class="sc">*</span> error_social <span class="sc">/</span> true_weight_social,</span>
<span id="cb471-42"><a href="bayesian-models-of-cognition.html#cb471-42" tabindex="-1"></a>    <span class="at">error_ratio_pct =</span> <span class="dv">100</span> <span class="sc">*</span> error_ratio <span class="sc">/</span> true_weight_ratio</span>
<span id="cb471-43"><a href="bayesian-models-of-cognition.html#cb471-43" tabindex="-1"></a>  )</span>
<span id="cb471-44"><a href="bayesian-models-of-cognition.html#cb471-44" tabindex="-1"></a></span>
<span id="cb471-45"><a href="bayesian-models-of-cognition.html#cb471-45" tabindex="-1"></a><span class="co"># Summarize recovery errors</span></span>
<span id="cb471-46"><a href="bayesian-models-of-cognition.html#cb471-46" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Parameter Recovery Summary:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Parameter Recovery Summary:</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="bayesian-models-of-cognition.html#cb473-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Direct Weight - Mean Absolute Error:&quot;</span>, <span class="fu">mean</span>(<span class="fu">abs</span>(recovery_data<span class="sc">$</span>error_direct)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Direct Weight - Mean Absolute Error: 0.8779322</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="bayesian-models-of-cognition.html#cb475-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Social Weight - Mean Absolute Error:&quot;</span>, <span class="fu">mean</span>(<span class="fu">abs</span>(recovery_data<span class="sc">$</span>error_social)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Social Weight - Mean Absolute Error: 0.4621289</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="bayesian-models-of-cognition.html#cb477-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weight Ratio - Mean Absolute Error:&quot;</span>, <span class="fu">mean</span>(<span class="fu">abs</span>(recovery_data<span class="sc">$</span>error_ratio)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weight Ratio - Mean Absolute Error: 0.5473129</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="bayesian-models-of-cognition.html#cb479-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Direct Weight - Mean Absolute Percentage Error:&quot;</span>, <span class="fu">mean</span>(<span class="fu">abs</span>(recovery_data<span class="sc">$</span>error_direct_pct)), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Direct Weight - Mean Absolute Percentage Error: 89.79965 %</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="bayesian-models-of-cognition.html#cb481-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Social Weight - Mean Absolute Percentage Error:&quot;</span>, <span class="fu">mean</span>(<span class="fu">abs</span>(recovery_data<span class="sc">$</span>error_social_pct)), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Social Weight - Mean Absolute Percentage Error: 76.71017 %</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="bayesian-models-of-cognition.html#cb483-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weight Ratio - Mean Absolute Percentage Error:&quot;</span>, <span class="fu">mean</span>(<span class="fu">abs</span>(recovery_data<span class="sc">$</span>error_ratio_pct)), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weight Ratio - Mean Absolute Percentage Error: 36.12176 %</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="bayesian-models-of-cognition.html#cb485-1" tabindex="-1"></a><span class="co"># Visualize parameter recovery</span></span>
<span id="cb485-2"><a href="bayesian-models-of-cognition.html#cb485-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> true_weight_direct, <span class="at">y =</span> est_weight_direct)) <span class="sc">+</span></span>
<span id="cb485-3"><a href="bayesian-models-of-cognition.html#cb485-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb485-4"><a href="bayesian-models-of-cognition.html#cb485-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> agent_id), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb485-5"><a href="bayesian-models-of-cognition.html#cb485-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb485-6"><a href="bayesian-models-of-cognition.html#cb485-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb485-7"><a href="bayesian-models-of-cognition.html#cb485-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Recovery of Direct Evidence Weights&quot;</span>,</span>
<span id="cb485-8"><a href="bayesian-models-of-cognition.html#cb485-8" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Perfect recovery would place all points on the dashed line&quot;</span>,</span>
<span id="cb485-9"><a href="bayesian-models-of-cognition.html#cb485-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Weight&quot;</span>,</span>
<span id="cb485-10"><a href="bayesian-models-of-cognition.html#cb485-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Weight&quot;</span></span>
<span id="cb485-11"><a href="bayesian-models-of-cognition.html#cb485-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb485-12"><a href="bayesian-models-of-cognition.html#cb485-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb485-13"><a href="bayesian-models-of-cognition.html#cb485-13" tabindex="-1"></a></span>
<span id="cb485-14"><a href="bayesian-models-of-cognition.html#cb485-14" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> true_weight_social, <span class="at">y =</span> est_weight_social)) <span class="sc">+</span></span>
<span id="cb485-15"><a href="bayesian-models-of-cognition.html#cb485-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb485-16"><a href="bayesian-models-of-cognition.html#cb485-16" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> agent_id), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb485-17"><a href="bayesian-models-of-cognition.html#cb485-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb485-18"><a href="bayesian-models-of-cognition.html#cb485-18" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb485-19"><a href="bayesian-models-of-cognition.html#cb485-19" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Recovery of Social Evidence Weights&quot;</span>,</span>
<span id="cb485-20"><a href="bayesian-models-of-cognition.html#cb485-20" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Perfect recovery would place all points on the dashed line&quot;</span>,</span>
<span id="cb485-21"><a href="bayesian-models-of-cognition.html#cb485-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Weight&quot;</span>,</span>
<span id="cb485-22"><a href="bayesian-models-of-cognition.html#cb485-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Weight&quot;</span></span>
<span id="cb485-23"><a href="bayesian-models-of-cognition.html#cb485-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb485-24"><a href="bayesian-models-of-cognition.html#cb485-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb485-25"><a href="bayesian-models-of-cognition.html#cb485-25" tabindex="-1"></a></span>
<span id="cb485-26"><a href="bayesian-models-of-cognition.html#cb485-26" tabindex="-1"></a><span class="co"># Add visualization of weight ratio recovery</span></span>
<span id="cb485-27"><a href="bayesian-models-of-cognition.html#cb485-27" tabindex="-1"></a>p_ratio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> true_weight_ratio, <span class="at">y =</span> est_weight_ratio)) <span class="sc">+</span></span>
<span id="cb485-28"><a href="bayesian-models-of-cognition.html#cb485-28" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb485-29"><a href="bayesian-models-of-cognition.html#cb485-29" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> agent_id), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb485-30"><a href="bayesian-models-of-cognition.html#cb485-30" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb485-31"><a href="bayesian-models-of-cognition.html#cb485-31" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb485-32"><a href="bayesian-models-of-cognition.html#cb485-32" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Recovery of Weight Ratio (Direct/Social)&quot;</span>,</span>
<span id="cb485-33"><a href="bayesian-models-of-cognition.html#cb485-33" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Perfect recovery would place all points on the dashed line&quot;</span>,</span>
<span id="cb485-34"><a href="bayesian-models-of-cognition.html#cb485-34" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Weight Ratio&quot;</span>,</span>
<span id="cb485-35"><a href="bayesian-models-of-cognition.html#cb485-35" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Weight Ratio&quot;</span></span>
<span id="cb485-36"><a href="bayesian-models-of-cognition.html#cb485-36" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb485-37"><a href="bayesian-models-of-cognition.html#cb485-37" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb485-38"><a href="bayesian-models-of-cognition.html#cb485-38" tabindex="-1"></a></span>
<span id="cb485-39"><a href="bayesian-models-of-cognition.html#cb485-39" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb485-40"><a href="bayesian-models-of-cognition.html#cb485-40" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/parameter_recovery-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="bayesian-models-of-cognition.html#cb486-1" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="series_files/figure-html/parameter_recovery-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="bayesian-models-of-cognition.html#cb487-1" tabindex="-1"></a>p_ratio</span></code></pre></div>
<p><img src="series_files/figure-html/parameter_recovery-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="bayesian-models-of-cognition.html#cb488-1" tabindex="-1"></a><span class="co"># Visualize relationship between weights</span></span>
<span id="cb488-2"><a href="bayesian-models-of-cognition.html#cb488-2" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> est_weight_direct, <span class="at">y =</span> est_weight_social)) <span class="sc">+</span></span>
<span id="cb488-3"><a href="bayesian-models-of-cognition.html#cb488-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb488-4"><a href="bayesian-models-of-cognition.html#cb488-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> agent_id), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb488-5"><a href="bayesian-models-of-cognition.html#cb488-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb488-6"><a href="bayesian-models-of-cognition.html#cb488-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Relationship Between Estimated Parameters&quot;</span>,</span>
<span id="cb488-7"><a href="bayesian-models-of-cognition.html#cb488-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Estimated Direct Weight&quot;</span>,</span>
<span id="cb488-8"><a href="bayesian-models-of-cognition.html#cb488-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Social Weight&quot;</span></span>
<span id="cb488-9"><a href="bayesian-models-of-cognition.html#cb488-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb488-10"><a href="bayesian-models-of-cognition.html#cb488-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb488-11"><a href="bayesian-models-of-cognition.html#cb488-11" tabindex="-1"></a></span>
<span id="cb488-12"><a href="bayesian-models-of-cognition.html#cb488-12" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="series_files/figure-html/parameter_recovery-4.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="population-level-parameter-analysis" class="section level3 hasAnchor" number="10.17.8">
<h3><span class="header-section-number">10.17.8</span> Population-Level Parameter Analysis<a href="bayesian-models-of-cognition.html#population-level-parameter-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine the population-level parameters from our multilevel models:</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="bayesian-models-of-cognition.html#cb489-1" tabindex="-1"></a><span class="co"># Extract population-level parameters</span></span>
<span id="cb489-2"><a href="bayesian-models-of-cognition.html#cb489-2" tabindex="-1"></a><span class="co"># From simple model</span></span>
<span id="cb489-3"><a href="bayesian-models-of-cognition.html#cb489-3" tabindex="-1"></a>simple_pop_theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as_draws_df</span>(fit_simple_ml<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>population_theta)</span>
<span id="cb489-4"><a href="bayesian-models-of-cognition.html#cb489-4" tabindex="-1"></a>simple_tau <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as_draws_df</span>(fit_simple_ml<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>tau)</span>
<span id="cb489-5"><a href="bayesian-models-of-cognition.html#cb489-5" tabindex="-1"></a></span>
<span id="cb489-6"><a href="bayesian-models-of-cognition.html#cb489-6" tabindex="-1"></a><span class="co"># From weighted model (revised parameterization)</span></span>
<span id="cb489-7"><a href="bayesian-models-of-cognition.html#cb489-7" tabindex="-1"></a>population_ratio <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted_ml<span class="sc">$</span>population_ratio)</span>
<span id="cb489-8"><a href="bayesian-models-of-cognition.html#cb489-8" tabindex="-1"></a>population_scaling <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted_ml<span class="sc">$</span>population_scaling)</span>
<span id="cb489-9"><a href="bayesian-models-of-cognition.html#cb489-9" tabindex="-1"></a>population_weight_direct <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted_ml<span class="sc">$</span>population_weight_direct)</span>
<span id="cb489-10"><a href="bayesian-models-of-cognition.html#cb489-10" tabindex="-1"></a>population_weight_social <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted_ml<span class="sc">$</span>population_weight_social)</span>
<span id="cb489-11"><a href="bayesian-models-of-cognition.html#cb489-11" tabindex="-1"></a>sigma_weight_ratio <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted_ml<span class="sc">$</span>sigma_weight_ratio)</span>
<span id="cb489-12"><a href="bayesian-models-of-cognition.html#cb489-12" tabindex="-1"></a>sigma_scaling <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted_ml<span class="sc">$</span>sigma_scaling)</span>
<span id="cb489-13"><a href="bayesian-models-of-cognition.html#cb489-13" tabindex="-1"></a></span>
<span id="cb489-14"><a href="bayesian-models-of-cognition.html#cb489-14" tabindex="-1"></a><span class="co"># True population values</span></span>
<span id="cb489-15"><a href="bayesian-models-of-cognition.html#cb489-15" tabindex="-1"></a>true_ratio <span class="ot">&lt;-</span> population_mean_direct <span class="sc">/</span> population_mean_social</span>
<span id="cb489-16"><a href="bayesian-models-of-cognition.html#cb489-16" tabindex="-1"></a>true_scaling <span class="ot">&lt;-</span> population_mean_direct <span class="sc">+</span> population_mean_social</span>
<span id="cb489-17"><a href="bayesian-models-of-cognition.html#cb489-17" tabindex="-1"></a></span>
<span id="cb489-18"><a href="bayesian-models-of-cognition.html#cb489-18" tabindex="-1"></a><span class="co"># Create a summary table</span></span>
<span id="cb489-19"><a href="bayesian-models-of-cognition.html#cb489-19" tabindex="-1"></a>population_params <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb489-20"><a href="bayesian-models-of-cognition.html#cb489-20" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">&quot;Population Mean (Direct)&quot;</span>, <span class="st">&quot;Population Mean (Social)&quot;</span>,</span>
<span id="cb489-21"><a href="bayesian-models-of-cognition.html#cb489-21" tabindex="-1"></a>               <span class="st">&quot;Population Ratio (Direct/Social)&quot;</span>, <span class="st">&quot;Population Scaling Factor&quot;</span>,</span>
<span id="cb489-22"><a href="bayesian-models-of-cognition.html#cb489-22" tabindex="-1"></a>               <span class="st">&quot;Population SD (Ratio)&quot;</span>, <span class="st">&quot;Population SD (Scaling)&quot;</span>),</span>
<span id="cb489-23"><a href="bayesian-models-of-cognition.html#cb489-23" tabindex="-1"></a>  <span class="at">true_value =</span> <span class="fu">c</span>(population_mean_direct, population_mean_social,</span>
<span id="cb489-24"><a href="bayesian-models-of-cognition.html#cb489-24" tabindex="-1"></a>                true_ratio, true_scaling,</span>
<span id="cb489-25"><a href="bayesian-models-of-cognition.html#cb489-25" tabindex="-1"></a>                population_sd_direct<span class="sc">/</span>population_sd_social, <span class="co"># approx ratio SD</span></span>
<span id="cb489-26"><a href="bayesian-models-of-cognition.html#cb489-26" tabindex="-1"></a>                <span class="fu">sqrt</span>(population_sd_direct<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> population_sd_social<span class="sc">^</span><span class="dv">2</span>)), <span class="co"># approx scaling SD</span></span>
<span id="cb489-27"><a href="bayesian-models-of-cognition.html#cb489-27" tabindex="-1"></a>  <span class="at">estimated =</span> <span class="fu">c</span>(population_weight_direct, population_weight_social,</span>
<span id="cb489-28"><a href="bayesian-models-of-cognition.html#cb489-28" tabindex="-1"></a>              population_ratio, population_scaling,</span>
<span id="cb489-29"><a href="bayesian-models-of-cognition.html#cb489-29" tabindex="-1"></a>              sigma_weight_ratio, sigma_scaling)</span>
<span id="cb489-30"><a href="bayesian-models-of-cognition.html#cb489-30" tabindex="-1"></a>)</span>
<span id="cb489-31"><a href="bayesian-models-of-cognition.html#cb489-31" tabindex="-1"></a></span>
<span id="cb489-32"><a href="bayesian-models-of-cognition.html#cb489-32" tabindex="-1"></a><span class="co"># Calculate error and percent error</span></span>
<span id="cb489-33"><a href="bayesian-models-of-cognition.html#cb489-33" tabindex="-1"></a>population_params <span class="ot">&lt;-</span> population_params <span class="sc">%&gt;%</span></span>
<span id="cb489-34"><a href="bayesian-models-of-cognition.html#cb489-34" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb489-35"><a href="bayesian-models-of-cognition.html#cb489-35" tabindex="-1"></a>    <span class="at">absolute_error =</span> <span class="fu">abs</span>(estimated <span class="sc">-</span> true_value),</span>
<span id="cb489-36"><a href="bayesian-models-of-cognition.html#cb489-36" tabindex="-1"></a>    <span class="at">percent_error =</span> <span class="dv">100</span> <span class="sc">*</span> absolute_error <span class="sc">/</span> <span class="fu">abs</span>(true_value)</span>
<span id="cb489-37"><a href="bayesian-models-of-cognition.html#cb489-37" tabindex="-1"></a>  )</span>
<span id="cb489-38"><a href="bayesian-models-of-cognition.html#cb489-38" tabindex="-1"></a></span>
<span id="cb489-39"><a href="bayesian-models-of-cognition.html#cb489-39" tabindex="-1"></a><span class="co"># Display table</span></span>
<span id="cb489-40"><a href="bayesian-models-of-cognition.html#cb489-40" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(population_params, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb489-41"><a href="bayesian-models-of-cognition.html#cb489-41" tabindex="-1"></a>            <span class="at">caption =</span> <span class="st">&quot;Recovery of Population-Level Parameters&quot;</span>)</span></code></pre></div>
<table>
<caption>(#tab:population_parameters)Recovery of Population-Level Parameters</caption>
<colgroup>
<col width="39%" />
<col width="13%" />
<col width="12%" />
<col width="18%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">parameter</th>
<th align="right">true_value</th>
<th align="right">estimated</th>
<th align="right">absolute_error</th>
<th align="right">percent_error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Population Mean (Direct)</td>
<td align="right">1.000</td>
<td align="right">1.369</td>
<td align="right">0.369</td>
<td align="right">36.851</td>
</tr>
<tr class="even">
<td align="left">Population Mean (Social)</td>
<td align="right">0.600</td>
<td align="right">0.737</td>
<td align="right">0.137</td>
<td align="right">22.847</td>
</tr>
<tr class="odd">
<td align="left">Population Ratio (Direct/Social)</td>
<td align="right">1.667</td>
<td align="right">2.098</td>
<td align="right">0.432</td>
<td align="right">25.892</td>
</tr>
<tr class="even">
<td align="left">Population Scaling Factor</td>
<td align="right">1.600</td>
<td align="right">2.106</td>
<td align="right">0.506</td>
<td align="right">31.600</td>
</tr>
<tr class="odd">
<td align="left">Population SD (Ratio)</td>
<td align="right">1.000</td>
<td align="right">0.215</td>
<td align="right">0.785</td>
<td align="right">78.505</td>
</tr>
<tr class="even">
<td align="left">Population SD (Scaling)</td>
<td align="right">0.141</td>
<td align="right">0.359</td>
<td align="right">0.217</td>
<td align="right">153.605</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="bayesian-models-of-cognition.html#cb490-1" tabindex="-1"></a><span class="co"># Visualize population distribution based on ratio and scaling</span></span>
<span id="cb490-2"><a href="bayesian-models-of-cognition.html#cb490-2" tabindex="-1"></a><span class="co"># Create a grid of values for plotting</span></span>
<span id="cb490-3"><a href="bayesian-models-of-cognition.html#cb490-3" tabindex="-1"></a>ratio_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb490-4"><a href="bayesian-models-of-cognition.html#cb490-4" tabindex="-1"></a>scaling_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb490-5"><a href="bayesian-models-of-cognition.html#cb490-5" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">ratio =</span> ratio_range, <span class="at">scaling =</span> scaling_range)</span>
<span id="cb490-6"><a href="bayesian-models-of-cognition.html#cb490-6" tabindex="-1"></a></span>
<span id="cb490-7"><a href="bayesian-models-of-cognition.html#cb490-7" tabindex="-1"></a><span class="co"># Calculate weights from ratio and scaling</span></span>
<span id="cb490-8"><a href="bayesian-models-of-cognition.html#cb490-8" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> grid_values <span class="sc">%&gt;%</span></span>
<span id="cb490-9"><a href="bayesian-models-of-cognition.html#cb490-9" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb490-10"><a href="bayesian-models-of-cognition.html#cb490-10" tabindex="-1"></a>    <span class="at">weight_direct =</span> scaling <span class="sc">*</span> ratio <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> ratio),</span>
<span id="cb490-11"><a href="bayesian-models-of-cognition.html#cb490-11" tabindex="-1"></a>    <span class="at">weight_social =</span> scaling <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> ratio)</span>
<span id="cb490-12"><a href="bayesian-models-of-cognition.html#cb490-12" tabindex="-1"></a>  )</span>
<span id="cb490-13"><a href="bayesian-models-of-cognition.html#cb490-13" tabindex="-1"></a></span>
<span id="cb490-14"><a href="bayesian-models-of-cognition.html#cb490-14" tabindex="-1"></a><span class="co"># Estimate density based on population parameters (using bivariate normal approximation in log space)</span></span>
<span id="cb490-15"><a href="bayesian-models-of-cognition.html#cb490-15" tabindex="-1"></a>grid_values<span class="sc">$</span>density <span class="ot">&lt;-</span> <span class="fu">with</span>(grid_values, {</span>
<span id="cb490-16"><a href="bayesian-models-of-cognition.html#cb490-16" tabindex="-1"></a>  <span class="co"># Transform to log space</span></span>
<span id="cb490-17"><a href="bayesian-models-of-cognition.html#cb490-17" tabindex="-1"></a>  log_ratio <span class="ot">&lt;-</span> <span class="fu">log</span>(ratio)</span>
<span id="cb490-18"><a href="bayesian-models-of-cognition.html#cb490-18" tabindex="-1"></a>  log_scaling <span class="ot">&lt;-</span> <span class="fu">log</span>(scaling)</span>
<span id="cb490-19"><a href="bayesian-models-of-cognition.html#cb490-19" tabindex="-1"></a>  </span>
<span id="cb490-20"><a href="bayesian-models-of-cognition.html#cb490-20" tabindex="-1"></a>  <span class="co"># Parameters from fitted model</span></span>
<span id="cb490-21"><a href="bayesian-models-of-cognition.html#cb490-21" tabindex="-1"></a>  mu_log_ratio <span class="ot">&lt;-</span> <span class="fu">log</span>(population_ratio)</span>
<span id="cb490-22"><a href="bayesian-models-of-cognition.html#cb490-22" tabindex="-1"></a>  mu_log_scaling <span class="ot">&lt;-</span> <span class="fu">log</span>(population_scaling)</span>
<span id="cb490-23"><a href="bayesian-models-of-cognition.html#cb490-23" tabindex="-1"></a>  sigma_log_ratio <span class="ot">&lt;-</span> sigma_weight_ratio</span>
<span id="cb490-24"><a href="bayesian-models-of-cognition.html#cb490-24" tabindex="-1"></a>  sigma_log_scaling <span class="ot">&lt;-</span> sigma_scaling</span>
<span id="cb490-25"><a href="bayesian-models-of-cognition.html#cb490-25" tabindex="-1"></a>  </span>
<span id="cb490-26"><a href="bayesian-models-of-cognition.html#cb490-26" tabindex="-1"></a>  <span class="co"># Calculate density in log space (independent normal for simplicity)</span></span>
<span id="cb490-27"><a href="bayesian-models-of-cognition.html#cb490-27" tabindex="-1"></a>  <span class="fu">dnorm</span>(log_ratio, mu_log_ratio, sigma_log_ratio) <span class="sc">*</span> </span>
<span id="cb490-28"><a href="bayesian-models-of-cognition.html#cb490-28" tabindex="-1"></a>    <span class="fu">dnorm</span>(log_scaling, mu_log_scaling, sigma_log_scaling)</span>
<span id="cb490-29"><a href="bayesian-models-of-cognition.html#cb490-29" tabindex="-1"></a>})</span>
<span id="cb490-30"><a href="bayesian-models-of-cognition.html#cb490-30" tabindex="-1"></a></span>
<span id="cb490-31"><a href="bayesian-models-of-cognition.html#cb490-31" tabindex="-1"></a><span class="co"># Plot population distribution</span></span>
<span id="cb490-32"><a href="bayesian-models-of-cognition.html#cb490-32" tabindex="-1"></a>p_pop_distribution <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb490-33"><a href="bayesian-models-of-cognition.html#cb490-33" tabindex="-1"></a>  <span class="co"># Add contour plot of estimated distribution</span></span>
<span id="cb490-34"><a href="bayesian-models-of-cognition.html#cb490-34" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">data =</span> grid_values, </span>
<span id="cb490-35"><a href="bayesian-models-of-cognition.html#cb490-35" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x =</span> weight_direct, <span class="at">y =</span> weight_social, <span class="at">z =</span> density),</span>
<span id="cb490-36"><a href="bayesian-models-of-cognition.html#cb490-36" tabindex="-1"></a>                    <span class="at">bins =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb490-37"><a href="bayesian-models-of-cognition.html#cb490-37" tabindex="-1"></a>  <span class="co"># Add true parameter values</span></span>
<span id="cb490-38"><a href="bayesian-models-of-cognition.html#cb490-38" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> agent_params, </span>
<span id="cb490-39"><a href="bayesian-models-of-cognition.html#cb490-39" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> weight_direct, <span class="at">y =</span> weight_social),</span>
<span id="cb490-40"><a href="bayesian-models-of-cognition.html#cb490-40" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb490-41"><a href="bayesian-models-of-cognition.html#cb490-41" tabindex="-1"></a>  <span class="co"># Add estimated parameter values</span></span>
<span id="cb490-42"><a href="bayesian-models-of-cognition.html#cb490-42" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> recovery_data, </span>
<span id="cb490-43"><a href="bayesian-models-of-cognition.html#cb490-43" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> est_weight_direct, <span class="at">y =</span> est_weight_social),</span>
<span id="cb490-44"><a href="bayesian-models-of-cognition.html#cb490-44" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb490-45"><a href="bayesian-models-of-cognition.html#cb490-45" tabindex="-1"></a>  <span class="co"># Add population means (true and estimated)</span></span>
<span id="cb490-46"><a href="bayesian-models-of-cognition.html#cb490-46" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population_mean_direct, <span class="at">y =</span> population_mean_social),</span>
<span id="cb490-47"><a href="bayesian-models-of-cognition.html#cb490-47" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb490-48"><a href="bayesian-models-of-cognition.html#cb490-48" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population_weight_direct, <span class="at">y =</span> population_weight_social),</span>
<span id="cb490-49"><a href="bayesian-models-of-cognition.html#cb490-49" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb490-50"><a href="bayesian-models-of-cognition.html#cb490-50" tabindex="-1"></a>  <span class="co"># Add reference lines showing constant ratio and scaling</span></span>
<span id="cb490-51"><a href="bayesian-models-of-cognition.html#cb490-51" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb490-52"><a href="bayesian-models-of-cognition.html#cb490-52" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Estimated Population Distribution of Evidence Weights&quot;</span>,</span>
<span id="cb490-53"><a href="bayesian-models-of-cognition.html#cb490-53" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Weight for Direct Evidence&quot;</span>,</span>
<span id="cb490-54"><a href="bayesian-models-of-cognition.html#cb490-54" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight for Social Evidence&quot;</span>,</span>
<span id="cb490-55"><a href="bayesian-models-of-cognition.html#cb490-55" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Density&quot;</span></span>
<span id="cb490-56"><a href="bayesian-models-of-cognition.html#cb490-56" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb490-57"><a href="bayesian-models-of-cognition.html#cb490-57" tabindex="-1"></a>  <span class="co">#scale_x_continuous(limits = c(0, 2)) +</span></span>
<span id="cb490-58"><a href="bayesian-models-of-cognition.html#cb490-58" tabindex="-1"></a>  <span class="co">#scale_y_continuous(limits = c(0, 2)) +</span></span>
<span id="cb490-59"><a href="bayesian-models-of-cognition.html#cb490-59" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb490-60"><a href="bayesian-models-of-cognition.html#cb490-60" tabindex="-1"></a>  <span class="co"># Add a legend explaining the points</span></span>
<span id="cb490-61"><a href="bayesian-models-of-cognition.html#cb490-61" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="fl">1.9</span>, </span>
<span id="cb490-62"><a href="bayesian-models-of-cognition.html#cb490-62" tabindex="-1"></a>          <span class="at">label =</span> <span class="st">&quot;Red: True individual parameters</span><span class="sc">\n</span><span class="st">Blue: Estimated individual parameters</span><span class="sc">\n</span><span class="st">X: Population means (red=true, blue=estimated)&quot;</span>,</span>
<span id="cb490-63"><a href="bayesian-models-of-cognition.html#cb490-63" tabindex="-1"></a>          <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb490-64"><a href="bayesian-models-of-cognition.html#cb490-64" tabindex="-1"></a></span>
<span id="cb490-65"><a href="bayesian-models-of-cognition.html#cb490-65" tabindex="-1"></a><span class="co"># Display the population distribution plot</span></span>
<span id="cb490-66"><a href="bayesian-models-of-cognition.html#cb490-66" tabindex="-1"></a><span class="co">#p_pop_distribution</span></span></code></pre></div>
</div>
<div id="posterior-predictive-checks-2" class="section level3 hasAnchor" number="10.17.9">
<h3><span class="header-section-number">10.17.9</span> Posterior Predictive Checks<a href="bayesian-models-of-cognition.html#posterior-predictive-checks-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine how well our multilevel models can reproduce the observed choices:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="bayesian-models-of-cognition.html#cb491-1" tabindex="-1"></a><span class="co"># Extract posterior predictions</span></span>
<span id="cb491-2"><a href="bayesian-models-of-cognition.html#cb491-2" tabindex="-1"></a>pred_choice_samples <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_weighted_ml<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;pred_choice&quot;</span>))</span>
<span id="cb491-3"><a href="bayesian-models-of-cognition.html#cb491-3" tabindex="-1"></a></span>
<span id="cb491-4"><a href="bayesian-models-of-cognition.html#cb491-4" tabindex="-1"></a><span class="co"># Calculate the probability of choosing blue for each observation</span></span>
<span id="cb491-5"><a href="bayesian-models-of-cognition.html#cb491-5" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> stan_data_multilevel<span class="sc">$</span>N, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb491-6"><a href="bayesian-models-of-cognition.html#cb491-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>stan_data_multilevel<span class="sc">$</span>N) {</span>
<span id="cb491-7"><a href="bayesian-models-of-cognition.html#cb491-7" tabindex="-1"></a>  <span class="co"># Parameter name in the format pred_choice[i]</span></span>
<span id="cb491-8"><a href="bayesian-models-of-cognition.html#cb491-8" tabindex="-1"></a>  param_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;pred_choice[&quot;</span>, i, <span class="st">&quot;]&quot;</span>)</span>
<span id="cb491-9"><a href="bayesian-models-of-cognition.html#cb491-9" tabindex="-1"></a>  <span class="co"># Calculate probability as mean of binary predictions</span></span>
<span id="cb491-10"><a href="bayesian-models-of-cognition.html#cb491-10" tabindex="-1"></a>  pred_probs[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pred_choice_samples[[param_name]])</span>
<span id="cb491-11"><a href="bayesian-models-of-cognition.html#cb491-11" tabindex="-1"></a>}</span>
<span id="cb491-12"><a href="bayesian-models-of-cognition.html#cb491-12" tabindex="-1"></a></span>
<span id="cb491-13"><a href="bayesian-models-of-cognition.html#cb491-13" tabindex="-1"></a><span class="co"># Create dataframe for predictions</span></span>
<span id="cb491-14"><a href="bayesian-models-of-cognition.html#cb491-14" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb491-15"><a href="bayesian-models-of-cognition.html#cb491-15" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb491-16"><a href="bayesian-models-of-cognition.html#cb491-16" tabindex="-1"></a>    <span class="at">pred_prob =</span> pred_probs,</span>
<span id="cb491-17"><a href="bayesian-models-of-cognition.html#cb491-17" tabindex="-1"></a>    <span class="at">binned_direct =</span> <span class="fu">cut</span>(blue1, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>), </span>
<span id="cb491-18"><a href="bayesian-models-of-cognition.html#cb491-18" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Low (0-2)&quot;</span>, <span class="st">&quot;Medium (3-5)&quot;</span>, <span class="st">&quot;High (6-8)&quot;</span>)),</span>
<span id="cb491-19"><a href="bayesian-models-of-cognition.html#cb491-19" tabindex="-1"></a>    <span class="at">binned_social =</span> <span class="fu">cut</span>(blue2, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), </span>
<span id="cb491-20"><a href="bayesian-models-of-cognition.html#cb491-20" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Low (0-1)&quot;</span>, <span class="st">&quot;High (2-3)&quot;</span>))</span>
<span id="cb491-21"><a href="bayesian-models-of-cognition.html#cb491-21" tabindex="-1"></a>  )</span>
<span id="cb491-22"><a href="bayesian-models-of-cognition.html#cb491-22" tabindex="-1"></a></span>
<span id="cb491-23"><a href="bayesian-models-of-cognition.html#cb491-23" tabindex="-1"></a><span class="co"># Group-level posterior predictive check</span></span>
<span id="cb491-24"><a href="bayesian-models-of-cognition.html#cb491-24" tabindex="-1"></a>p_group_ppc <span class="ot">&lt;-</span> prediction_data <span class="sc">%&gt;%</span></span>
<span id="cb491-25"><a href="bayesian-models-of-cognition.html#cb491-25" tabindex="-1"></a>  <span class="co"># Group by evidence levels</span></span>
<span id="cb491-26"><a href="bayesian-models-of-cognition.html#cb491-26" tabindex="-1"></a>  <span class="fu">group_by</span>(binned_direct, binned_social) <span class="sc">%&gt;%</span></span>
<span id="cb491-27"><a href="bayesian-models-of-cognition.html#cb491-27" tabindex="-1"></a>  <span class="co"># Calculate observed and predicted probabilities</span></span>
<span id="cb491-28"><a href="bayesian-models-of-cognition.html#cb491-28" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb491-29"><a href="bayesian-models-of-cognition.html#cb491-29" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb491-30"><a href="bayesian-models-of-cognition.html#cb491-30" tabindex="-1"></a>    <span class="at">observed_prob =</span> <span class="fu">mean</span>(choice_binary),</span>
<span id="cb491-31"><a href="bayesian-models-of-cognition.html#cb491-31" tabindex="-1"></a>    <span class="at">predicted_prob =</span> <span class="fu">mean</span>(pred_prob),</span>
<span id="cb491-32"><a href="bayesian-models-of-cognition.html#cb491-32" tabindex="-1"></a>    <span class="at">error =</span> predicted_prob <span class="sc">-</span> observed_prob,</span>
<span id="cb491-33"><a href="bayesian-models-of-cognition.html#cb491-33" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb491-34"><a href="bayesian-models-of-cognition.html#cb491-34" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb491-35"><a href="bayesian-models-of-cognition.html#cb491-35" tabindex="-1"></a>  <span class="co"># Create plot</span></span>
<span id="cb491-36"><a href="bayesian-models-of-cognition.html#cb491-36" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> observed_prob, <span class="at">y =</span> predicted_prob, <span class="at">size =</span> n)) <span class="sc">+</span></span>
<span id="cb491-37"><a href="bayesian-models-of-cognition.html#cb491-37" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb491-38"><a href="bayesian-models-of-cognition.html#cb491-38" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(binned_direct, <span class="st">&quot;-&quot;</span>, binned_social)), </span>
<span id="cb491-39"><a href="bayesian-models-of-cognition.html#cb491-39" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb491-40"><a href="bayesian-models-of-cognition.html#cb491-40" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb491-41"><a href="bayesian-models-of-cognition.html#cb491-41" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb491-42"><a href="bayesian-models-of-cognition.html#cb491-42" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Group-Level Posterior Predictive Check&quot;</span>,</span>
<span id="cb491-43"><a href="bayesian-models-of-cognition.html#cb491-43" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Each point represents a combination of evidence levels&quot;</span>,</span>
<span id="cb491-44"><a href="bayesian-models-of-cognition.html#cb491-44" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Observed Probability of Blue Choice&quot;</span>,</span>
<span id="cb491-45"><a href="bayesian-models-of-cognition.html#cb491-45" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Predicted Probability of Blue Choice&quot;</span>,</span>
<span id="cb491-46"><a href="bayesian-models-of-cognition.html#cb491-46" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">&quot;Number of</span><span class="sc">\n</span><span class="st">Observations&quot;</span></span>
<span id="cb491-47"><a href="bayesian-models-of-cognition.html#cb491-47" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb491-48"><a href="bayesian-models-of-cognition.html#cb491-48" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb491-49"><a href="bayesian-models-of-cognition.html#cb491-49" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb491-50"><a href="bayesian-models-of-cognition.html#cb491-50" tabindex="-1"></a></span>
<span id="cb491-51"><a href="bayesian-models-of-cognition.html#cb491-51" tabindex="-1"></a><span class="co"># Individual-level posterior predictive check</span></span>
<span id="cb491-52"><a href="bayesian-models-of-cognition.html#cb491-52" tabindex="-1"></a>p_individual_ppc <span class="ot">&lt;-</span> prediction_data <span class="sc">%&gt;%</span></span>
<span id="cb491-53"><a href="bayesian-models-of-cognition.html#cb491-53" tabindex="-1"></a>  <span class="co"># Group by agent and evidence levels</span></span>
<span id="cb491-54"><a href="bayesian-models-of-cognition.html#cb491-54" tabindex="-1"></a>  <span class="fu">group_by</span>(agent_id, binned_direct, binned_social) <span class="sc">%&gt;%</span></span>
<span id="cb491-55"><a href="bayesian-models-of-cognition.html#cb491-55" tabindex="-1"></a>  <span class="co"># Calculate observed and predicted probabilities</span></span>
<span id="cb491-56"><a href="bayesian-models-of-cognition.html#cb491-56" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb491-57"><a href="bayesian-models-of-cognition.html#cb491-57" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb491-58"><a href="bayesian-models-of-cognition.html#cb491-58" tabindex="-1"></a>    <span class="at">observed_prob =</span> <span class="fu">mean</span>(choice_binary),</span>
<span id="cb491-59"><a href="bayesian-models-of-cognition.html#cb491-59" tabindex="-1"></a>    <span class="at">predicted_prob =</span> <span class="fu">mean</span>(pred_prob),</span>
<span id="cb491-60"><a href="bayesian-models-of-cognition.html#cb491-60" tabindex="-1"></a>    <span class="at">error =</span> predicted_prob <span class="sc">-</span> observed_prob,</span>
<span id="cb491-61"><a href="bayesian-models-of-cognition.html#cb491-61" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb491-62"><a href="bayesian-models-of-cognition.html#cb491-62" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb491-63"><a href="bayesian-models-of-cognition.html#cb491-63" tabindex="-1"></a>  <span class="co"># Create plot</span></span>
<span id="cb491-64"><a href="bayesian-models-of-cognition.html#cb491-64" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> observed_prob, <span class="at">y =</span> predicted_prob, <span class="at">color =</span> <span class="fu">factor</span>(agent_id))) <span class="sc">+</span></span>
<span id="cb491-65"><a href="bayesian-models-of-cognition.html#cb491-65" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb491-66"><a href="bayesian-models-of-cognition.html#cb491-66" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb491-67"><a href="bayesian-models-of-cognition.html#cb491-67" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb491-68"><a href="bayesian-models-of-cognition.html#cb491-68" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Individual-Level Posterior Predictive Check&quot;</span>,</span>
<span id="cb491-69"><a href="bayesian-models-of-cognition.html#cb491-69" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Each point represents an agent&#39;s behavior for a specific evidence combination&quot;</span>,</span>
<span id="cb491-70"><a href="bayesian-models-of-cognition.html#cb491-70" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Observed Probability of Blue Choice&quot;</span>,</span>
<span id="cb491-71"><a href="bayesian-models-of-cognition.html#cb491-71" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Predicted Probability of Blue Choice&quot;</span>,</span>
<span id="cb491-72"><a href="bayesian-models-of-cognition.html#cb491-72" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent ID&quot;</span></span>
<span id="cb491-73"><a href="bayesian-models-of-cognition.html#cb491-73" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb491-74"><a href="bayesian-models-of-cognition.html#cb491-74" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb491-75"><a href="bayesian-models-of-cognition.html#cb491-75" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb491-76"><a href="bayesian-models-of-cognition.html#cb491-76" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co"># Hide legend due to many agents</span></span>
<span id="cb491-77"><a href="bayesian-models-of-cognition.html#cb491-77" tabindex="-1"></a></span>
<span id="cb491-78"><a href="bayesian-models-of-cognition.html#cb491-78" tabindex="-1"></a><span class="co"># Display posterior predictive checks</span></span>
<span id="cb491-79"><a href="bayesian-models-of-cognition.html#cb491-79" tabindex="-1"></a>p_group_ppc</span></code></pre></div>
<p><img src="series_files/figure-html/posterior_checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="bayesian-models-of-cognition.html#cb492-1" tabindex="-1"></a>p_individual_ppc</span></code></pre></div>
<p><img src="series_files/figure-html/posterior_checks-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="bayesian-models-of-cognition.html#cb493-1" tabindex="-1"></a><span class="co"># Calculate overall prediction accuracy</span></span>
<span id="cb493-2"><a href="bayesian-models-of-cognition.html#cb493-2" tabindex="-1"></a>prediction_accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_probs <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">==</span> multilevel_sim_data<span class="sc">$</span>choice_binary)</span>
<span id="cb493-3"><a href="bayesian-models-of-cognition.html#cb493-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall prediction accuracy:&quot;</span>, <span class="fu">round</span>(prediction_accuracy <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Overall prediction accuracy: 71 %</code></pre>
</div>
</div>
<div id="model-comparison-1" class="section level2 hasAnchor" number="10.18">
<h2><span class="header-section-number">10.18</span> Model Comparison<a href="bayesian-models-of-cognition.html#model-comparison-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, let’s compare our models to determine which one better captures the data:</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="bayesian-models-of-cognition.html#cb495-1" tabindex="-1"></a><span class="co"># Calculate LOO-CV for model comparison</span></span>
<span id="cb495-2"><a href="bayesian-models-of-cognition.html#cb495-2" tabindex="-1"></a>loo_simple <span class="ot">&lt;-</span> fit_simple_ml<span class="sc">$</span><span class="fu">loo</span>()</span>
<span id="cb495-3"><a href="bayesian-models-of-cognition.html#cb495-3" tabindex="-1"></a>loo_weighted <span class="ot">&lt;-</span> fit_weighted_ml<span class="sc">$</span><span class="fu">loo</span>()</span>
<span id="cb495-4"><a href="bayesian-models-of-cognition.html#cb495-4" tabindex="-1"></a></span>
<span id="cb495-5"><a href="bayesian-models-of-cognition.html#cb495-5" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb495-6"><a href="bayesian-models-of-cognition.html#cb495-6" tabindex="-1"></a>loo_comparison <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(loo_simple, loo_weighted)</span>
<span id="cb495-7"><a href="bayesian-models-of-cognition.html#cb495-7" tabindex="-1"></a><span class="fu">print</span>(loo_comparison)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff
## model2   0.0       0.0  
## model1 -21.1       6.5</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="bayesian-models-of-cognition.html#cb497-1" tabindex="-1"></a><span class="co"># Calculate model weights</span></span>
<span id="cb497-2"><a href="bayesian-models-of-cognition.html#cb497-2" tabindex="-1"></a>model_weights <span class="ot">&lt;-</span> <span class="fu">loo_model_weights</span>(<span class="fu">list</span>(</span>
<span id="cb497-3"><a href="bayesian-models-of-cognition.html#cb497-3" tabindex="-1"></a>  <span class="st">&quot;Simple Beta-Binomial&quot;</span> <span class="ot">=</span> loo_simple,</span>
<span id="cb497-4"><a href="bayesian-models-of-cognition.html#cb497-4" tabindex="-1"></a>  <span class="st">&quot;Weighted Beta-Binomial&quot;</span> <span class="ot">=</span> loo_weighted</span>
<span id="cb497-5"><a href="bayesian-models-of-cognition.html#cb497-5" tabindex="-1"></a>))</span>
<span id="cb497-6"><a href="bayesian-models-of-cognition.html#cb497-6" tabindex="-1"></a></span>
<span id="cb497-7"><a href="bayesian-models-of-cognition.html#cb497-7" tabindex="-1"></a><span class="co"># Create comparison visualization</span></span>
<span id="cb497-8"><a href="bayesian-models-of-cognition.html#cb497-8" tabindex="-1"></a>comparison_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb497-9"><a href="bayesian-models-of-cognition.html#cb497-9" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">names</span>(model_weights),</span>
<span id="cb497-10"><a href="bayesian-models-of-cognition.html#cb497-10" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">as.numeric</span>(model_weights)</span>
<span id="cb497-11"><a href="bayesian-models-of-cognition.html#cb497-11" tabindex="-1"></a>)</span>
<span id="cb497-12"><a href="bayesian-models-of-cognition.html#cb497-12" tabindex="-1"></a></span>
<span id="cb497-13"><a href="bayesian-models-of-cognition.html#cb497-13" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> weight, <span class="at">fill =</span> model)) <span class="sc">+</span></span>
<span id="cb497-14"><a href="bayesian-models-of-cognition.html#cb497-14" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb497-15"><a href="bayesian-models-of-cognition.html#cb497-15" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(weight, <span class="at">accuracy =</span> <span class="fl">0.1</span>)), </span>
<span id="cb497-16"><a href="bayesian-models-of-cognition.html#cb497-16" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb497-17"><a href="bayesian-models-of-cognition.html#cb497-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb497-18"><a href="bayesian-models-of-cognition.html#cb497-18" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb497-19"><a href="bayesian-models-of-cognition.html#cb497-19" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Model Comparison via LOO-CV&quot;</span>,</span>
<span id="cb497-20"><a href="bayesian-models-of-cognition.html#cb497-20" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher weights indicate better predictive performance&quot;</span>,</span>
<span id="cb497-21"><a href="bayesian-models-of-cognition.html#cb497-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb497-22"><a href="bayesian-models-of-cognition.html#cb497-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Model Weight&quot;</span></span>
<span id="cb497-23"><a href="bayesian-models-of-cognition.html#cb497-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb497-24"><a href="bayesian-models-of-cognition.html#cb497-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb497-25"><a href="bayesian-models-of-cognition.html#cb497-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-56-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="extensions-and-applications" class="section level2 hasAnchor" number="10.19">
<h2><span class="header-section-number">10.19</span> Extensions and Applications<a href="bayesian-models-of-cognition.html#extensions-and-applications" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The multilevel Bayesian framework we’ve developed can be extended in several important ways:</p>
<div id="time-varying-weights" class="section level3 hasAnchor" number="10.19.1">
<h3><span class="header-section-number">10.19.1</span> Time-Varying Weights<a href="bayesian-models-of-cognition.html#time-varying-weights" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Evidence weights might change over time as participants learn about the reliability of different sources:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="bayesian-models-of-cognition.html#cb498-1" tabindex="-1"></a><span class="co">#// Dynamically updated weights</span></span>
<span id="cb498-2"><a href="bayesian-models-of-cognition.html#cb498-2" tabindex="-1"></a><span class="co">#weight_direct[j, t] = weight_direct_baseline[j] * (1 + learning_rate * prediction_error[j, t-1]);</span></span></code></pre></div>
</div>
<div id="group-comparisons" class="section level3 hasAnchor" number="10.19.2">
<h3><span class="header-section-number">10.19.2</span> Group Comparisons<a href="bayesian-models-of-cognition.html#group-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The framework allows for comparing different populations (e.g., clinical vs. control groups):</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="bayesian-models-of-cognition.html#cb499-1" tabindex="-1"></a><span class="co"># // In the parameters block</span></span>
<span id="cb499-2"><a href="bayesian-models-of-cognition.html#cb499-2" tabindex="-1"></a><span class="co"># real mu_direct_group1;</span></span>
<span id="cb499-3"><a href="bayesian-models-of-cognition.html#cb499-3" tabindex="-1"></a><span class="co"># real mu_direct_group2;</span></span>
<span id="cb499-4"><a href="bayesian-models-of-cognition.html#cb499-4" tabindex="-1"></a><span class="co"># real&lt;lower=0&gt; sigma_direct_group1;</span></span>
<span id="cb499-5"><a href="bayesian-models-of-cognition.html#cb499-5" tabindex="-1"></a><span class="co"># real&lt;lower=0&gt; sigma_direct_group2;</span></span>
<span id="cb499-6"><a href="bayesian-models-of-cognition.html#cb499-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb499-7"><a href="bayesian-models-of-cognition.html#cb499-7" tabindex="-1"></a><span class="co"># // In the model block</span></span>
<span id="cb499-8"><a href="bayesian-models-of-cognition.html#cb499-8" tabindex="-1"></a><span class="co"># for (j in 1:J1) {  // Group 1</span></span>
<span id="cb499-9"><a href="bayesian-models-of-cognition.html#cb499-9" tabindex="-1"></a><span class="co">#   theta_j[j] ~ normal(mu_direct_group1, sigma_direct_group1);</span></span>
<span id="cb499-10"><a href="bayesian-models-of-cognition.html#cb499-10" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb499-11"><a href="bayesian-models-of-cognition.html#cb499-11" tabindex="-1"></a><span class="co"># for (j in (J1+1):(J1+J2)) {  // Group 2</span></span>
<span id="cb499-12"><a href="bayesian-models-of-cognition.html#cb499-12" tabindex="-1"></a><span class="co">#   theta_j[j] ~ normal(mu_direct_group2, sigma_direct_group2);</span></span>
<span id="cb499-13"><a href="bayesian-models-of-cognition.html#cb499-13" tabindex="-1"></a><span class="co"># }</span></span></code></pre></div>
</div>
</div>
<div id="cognitive-implications-of-multilevel-bayesian-models" class="section level2 hasAnchor" number="10.20">
<h2><span class="header-section-number">10.20</span> Cognitive Implications of Multilevel Bayesian Models<a href="bayesian-models-of-cognition.html#cognitive-implications-of-multilevel-bayesian-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our multilevel models reveal several important insights about cognitive processing:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Individual Variability</strong>: There are substantial individual differences in how people weigh direct versus social evidence, suggesting different cognitive “styles” or strategies.</p></li>
<li><p><strong>Population Regularities</strong>: Despite individual variation, there are identifiable population-level patterns in evidence integration.</p></li>
<li><p><strong>Parameter Correlations</strong>: The correlation between direct and social evidence weights suggests potential cognitive constraints or trade-offs in information processing.</p></li>
<li><p><strong>Source Reliability Assessment</strong>: Different weightings may reflect individuals’ implicit judgments about the reliability of different information sources.</p></li>
<li><p><strong>Prediction Accuracy</strong>: The ability of our models to predict individual choices confirms that Bayesian integration is a plausible mechanism for human decision-making under uncertainty.</p></li>
</ol>
</div>
<div id="conclusion-3" class="section level2 hasAnchor" number="10.21">
<h2><span class="header-section-number">10.21</span> Conclusion<a href="bayesian-models-of-cognition.html#conclusion-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Multilevel Bayesian models provide a powerful framework for understanding individual differences in cognitive processes. By simultaneously modeling both population-level trends and individual variations, these models allow us to:</p>
<ol style="list-style-type: decimal">
<li>Identify common cognitive mechanisms across individuals</li>
<li>Quantify individual differences in strategy and information weighting</li>
<li>Make predictions about new individuals from the same population</li>
<li>Test hypotheses about the factors that influence evidence integration</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mixture-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/10-BayesianModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
