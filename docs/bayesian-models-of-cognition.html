<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Bayesian Models of Cognition | 12-CategorizationModelsPrototypes</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Bayesian Models of Cognition | 12-CategorizationModelsPrototypes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Bayesian Models of Cognition | 12-CategorizationModelsPrototypes" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="win-stay-lose-shift-a-heuristic-decision-strategy.html"/>
<link rel="next" href="introduction-to-categorization-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.4</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.5</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
<li class="chapter" data-level="5.7.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.7.2</b> Connection to Kalman Filters</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.2</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#bayesian-memory-agent"><i class="fa fa-check"></i><b>5.9</b> Bayesian memory agent</a></li>
<li class="chapter" data-level="5.10" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.10</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#complete-pooling"><i class="fa fa-check"></i><b>7.3.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="7.3.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#no-pooling"><i class="fa fa-check"></i><b>7.3.2</b> No Pooling</a></li>
<li class="chapter" data-level="7.3.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#partial-pooling-multilevel-modeling"><i class="fa fa-check"></i><b>7.3.3</b> Partial Pooling (Multilevel Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#graphical-model-visualization"><i class="fa fa-check"></i><b>7.4</b> Graphical Model Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#biased-agent-model"><i class="fa fa-check"></i><b>7.4.1</b> Biased Agent Model</a></li>
<li class="chapter" data-level="7.4.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#memory-agent-model"><i class="fa fa-check"></i><b>7.4.2</b> Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random-agent-model"><i class="fa fa-check"></i><b>7.8</b> Multilevel Random Agent Model</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.8.1</b> Assessing multilevel random agents</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#lets-look-at-individuals"><i class="fa fa-check"></i><b>7.9</b> Let’s look at individuals</a></li>
<li class="chapter" data-level="7.10" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-sensitivity-checks"><i class="fa fa-check"></i><b>7.10</b> Prior sensitivity checks</a></li>
<li class="chapter" data-level="7.11" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-1"><i class="fa fa-check"></i><b>7.11</b> Parameter recovery</a></li>
<li class="chapter" data-level="7.12" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-agent-model"><i class="fa fa-check"></i><b>7.12</b> Multilevel Memory Agent Model</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.12.1</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#diagnosing-the-issue-with-bias-and-beta"><i class="fa fa-check"></i><b>7.12.2</b> Diagnosing the issue with bias and beta</a></li>
<li class="chapter" data-level="7.12.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.12.3</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.12.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.12.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.12.5</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.12.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.12.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#section"><i class="fa fa-check"></i><b>7.12.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches"><i class="fa fa-check"></i><b>7.13</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.14" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches-1"><i class="fa fa-check"></i><b>7.14</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.15" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-modeling-cheatsheet"><i class="fa fa-check"></i><b>7.15</b> Multilevel Modeling Cheatsheet</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#when-to-use-each-pooling-approach"><i class="fa fa-check"></i><b>7.15.1</b> When to Use Each Pooling Approach:</a></li>
<li class="chapter" data-level="7.15.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-rules-of-thumb"><i class="fa fa-check"></i><b>7.15.2</b> Parameter Recovery Rules of Thumb:</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#conclusion-the-power-and-challenges-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.16</b> Conclusion: The Power and Challenges of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.17" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#exercises-just-some-ideas"><i class="fa fa-check"></i><b>7.17</b> Exercises (just some ideas)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-challenge-of-model-selection"><i class="fa fa-check"></i><b>8.2.1</b> The Challenge of Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-the-foundation-of-model-comparison"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation: The Foundation of Model Comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-problem-of-overfitting"><i class="fa fa-check"></i><b>8.3.1</b> The Problem of Overfitting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-cross-validation-works"><i class="fa fa-check"></i><b>8.3.2</b> How Cross-Validation Works</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-in-bayesian-models"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation in Bayesian Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#expected-log-predictive-density-elpd"><i class="fa fa-check"></i><b>8.3.4</b> Expected Log Predictive Density (ELPD)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-an-efficient-approximation-to-loo-cv"><i class="fa fa-check"></i><b>8.4</b> PSIS-LOO: An Efficient Approximation to LOO-CV</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-importance-sampling-works"><i class="fa fa-check"></i><b>8.4.1</b> How Importance Sampling Works</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#pareto-smoothing-for-stability"><i class="fa fa-check"></i><b>8.4.2</b> Pareto Smoothing for Stability</a></li>
<li class="chapter" data-level="8.4.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-complete-psis-loo-process"><i class="fa fa-check"></i><b>8.4.3</b> The Complete PSIS-LOO Process</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#simulation-based-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Simulation-Based Model Comparison</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-simulation-parameters"><i class="fa fa-check"></i><b>8.5.1</b> Define Simulation Parameters</a></li>
<li class="chapter" data-level="8.5.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-agent-functions"><i class="fa fa-check"></i><b>8.5.2</b> Define Agent Functions</a></li>
<li class="chapter" data-level="8.5.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generate-simulation-data"><i class="fa fa-check"></i><b>8.5.3</b> Generate Simulation Data</a></li>
<li class="chapter" data-level="8.5.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualize-the-simulation-data"><i class="fa fa-check"></i><b>8.5.4</b> Visualize the Simulation Data</a></li>
<li class="chapter" data-level="8.5.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prepare-data-for-stan-models"><i class="fa fa-check"></i><b>8.5.5</b> Prepare Data for Stan Models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-models-for-comparison"><i class="fa fa-check"></i><b>8.6</b> Implementing Models for Comparison</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#understanding-log-likelihood-in-model-comparison"><i class="fa fa-check"></i><b>8.6.1</b> Understanding Log-Likelihood in Model Comparison</a></li>
<li class="chapter" data-level="8.6.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-biased-agent-model"><i class="fa fa-check"></i><b>8.6.2</b> Multilevel Biased Agent Model</a></li>
<li class="chapter" data-level="8.6.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-agent-model-1"><i class="fa fa-check"></i><b>8.6.3</b> Multilevel Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-models-and-calculating-expected-log-predictive-density"><i class="fa fa-check"></i><b>8.7</b> Fitting Models and Calculating Expected Log Predictive Density</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-for-model-comparison"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation for Model Comparison</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-comparison"><i class="fa fa-check"></i><b>8.9.1</b> PSIS-LOO Comparison</a></li>
<li class="chapter" data-level="8.9.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualizing-loo-cv-results"><i class="fa fa-check"></i><b>8.9.2</b> Visualizing LOO-CV Results</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#formal-model-comparison"><i class="fa fa-check"></i><b>8.10</b> Formal Model Comparison</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#k-fold-cross-validation-for-validation"><i class="fa fa-check"></i><b>8.10.1</b> K-Fold Cross-Validation for Validation</a></li>
<li class="chapter" data-level="8.10.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#comparing-loo-and-k-fold-results"><i class="fa fa-check"></i><b>8.10.2</b> Comparing LOO and K-Fold Results</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-approaches"><i class="fa fa-check"></i><b>8.11</b> Limitations of Model Comparison Approaches</a></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#exercises"><i class="fa fa-check"></i><b>8.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.12.1</b> Rant on internal vs external validity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>9</b> Mixture models</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="mixture-models.html"><a href="mixture-models.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.0.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.0.2" data-path="mixture-models.html"><a href="mixture-models.html#chapter-roadmap"><i class="fa fa-check"></i><b>9.0.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="9.1" data-path="mixture-models.html"><a href="mixture-models.html#visualizing-mixture-distributions-reaction-time-example"><i class="fa fa-check"></i><b>9.1</b> Visualizing Mixture Distributions: Reaction Time Example</a></li>
<li class="chapter" data-level="9.2" data-path="mixture-models.html"><a href="mixture-models.html#theoretical-foundation-for-mixture-models"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation for Mixture Models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mixture-models.html"><a href="mixture-models.html#the-mixture-model-framework"><i class="fa fa-check"></i><b>9.2.1</b> The Mixture Model Framework</a></li>
<li class="chapter" data-level="9.2.2" data-path="mixture-models.html"><a href="mixture-models.html#mixture-models-and-latent-variables"><i class="fa fa-check"></i><b>9.2.2</b> Mixture Models and Latent Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-in-cognitive-modeling"><i class="fa fa-check"></i><b>9.2.3</b> Applications in Cognitive Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mixture-models.html"><a href="mixture-models.html#implementing-a-basic-mixture-model"><i class="fa fa-check"></i><b>9.3</b> Implementing a Basic Mixture Model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixture-models.html"><a href="mixture-models.html#simulating-mixed-strategy-data"><i class="fa fa-check"></i><b>9.3.1</b> Simulating Mixed Strategy Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation-of-a-mixture-model"><i class="fa fa-check"></i><b>9.3.2</b> Stan Implementation of a Mixture Model</a></li>
<li class="chapter" data-level="9.3.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-mixture-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting and Evaluating the Mixture Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="mixture-models.html"><a href="mixture-models.html#model-diagnostics"><i class="fa fa-check"></i><b>9.3.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="9.3.5" data-path="mixture-models.html"><a href="mixture-models.html#parameter-recovery-analysis"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="9.3.6" data-path="mixture-models.html"><a href="mixture-models.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>9.3.6</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixture-models.html"><a href="mixture-models.html#parameter-interpretation"><i class="fa fa-check"></i><b>9.4</b> Parameter Interpretation</a></li>
<li class="chapter" data-level="9.5" data-path="mixture-models.html"><a href="mixture-models.html#multilevel-mixture-models"><i class="fa fa-check"></i><b>9.5</b> Multilevel Mixture Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation"><i class="fa fa-check"></i><b>9.5.1</b> Stan Implementation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mixture-models.html"><a href="mixture-models.html#preparing-data-for-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.2</b> Preparing Data for the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.3</b> Fitting and Evaluating the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.4" data-path="mixture-models.html"><a href="mixture-models.html#examining-individual-differences"><i class="fa fa-check"></i><b>9.5.4</b> Examining Individual Differences</a></li>
<li class="chapter" data-level="9.5.5" data-path="mixture-models.html"><a href="mixture-models.html#interpreting-parameter-correlations"><i class="fa fa-check"></i><b>9.5.5</b> Interpreting Parameter Correlations</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mixture-models.html"><a href="mixture-models.html#comparing-single-process-and-mixture-models"><i class="fa fa-check"></i><b>9.6</b> Comparing Single-Process and Mixture Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mixture-models.html"><a href="mixture-models.html#single-process-model"><i class="fa fa-check"></i><b>9.6.1</b> Single-Process Model</a></li>
<li class="chapter" data-level="9.6.2" data-path="mixture-models.html"><a href="mixture-models.html#model-comparison"><i class="fa fa-check"></i><b>9.6.2</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-of-mixture-models-in-cognitive-science"><i class="fa fa-check"></i><b>9.6.3</b> Applications of Mixture Models in Cognitive Science</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mixture-models.html"><a href="mixture-models.html#conclusion-2"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html"><i class="fa fa-check"></i><b>10</b> Win-Stay-Lose-Shift: A Heuristic Decision Strategy</a>
<ul>
<li class="chapter" data-level="10.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#loading-required-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading Required Packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#generating-data-simulating-wsls-agents"><i class="fa fa-check"></i><b>10.2</b> Generating Data: Simulating WSLS Agents</a></li>
<li class="chapter" data-level="10.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#data-processing-and-initial-visualization"><i class="fa fa-check"></i><b>10.3</b> Data Processing and Initial Visualization</a></li>
<li class="chapter" data-level="10.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#verifying-model-properties-and-assumptions"><i class="fa fa-check"></i><b>10.4</b> Verifying Model Properties and Assumptions</a></li>
<li class="chapter" data-level="10.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#modeling-a-single-wsls-agent"><i class="fa fa-check"></i><b>10.5</b> Modeling a Single WSLS Agent</a></li>
<li class="chapter" data-level="10.6" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#multilevel-wsls-model"><i class="fa fa-check"></i><b>10.6</b> Multilevel WSLS Model</a></li>
<li class="chapter" data-level="10.7" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#quality-checks-and-parameter-recovery"><i class="fa fa-check"></i><b>10.7</b> Quality Checks and Parameter Recovery</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#convergence-diagnostics"><i class="fa fa-check"></i><b>10.7.1</b> Convergence Diagnostics</a></li>
<li class="chapter" data-level="10.7.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#prior-posterior-update-visualization"><i class="fa fa-check"></i><b>10.7.2</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="10.7.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#individual-level-parameter-recovery"><i class="fa fa-check"></i><b>10.7.3</b> Individual-Level Parameter Recovery</a></li>
<li class="chapter" data-level="10.7.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#posterior-predictive-checks-2"><i class="fa fa-check"></i><b>10.7.4</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="10.7.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#model-comparison-with-loo-cv"><i class="fa fa-check"></i><b>10.7.5</b> Model Comparison with LOO-CV</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>11</b> Bayesian Models of Cognition</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#introduction-4"><i class="fa fa-check"></i><b>11.0.1</b> Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#learning-objectives-4"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#chapter-roadmap-1"><i class="fa fa-check"></i><b>11.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition"><i class="fa fa-check"></i><b>11.3</b> The Bayesian Framework for Cognition</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating"><i class="fa fa-check"></i><b>11.4</b> Visualizing Bayesian Updating</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science"><i class="fa fa-check"></i><b>11.5</b> Bayesian Models in Cognitive Science</a></li>
<li class="chapter" data-level="11.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making"><i class="fa fa-check"></i><b>11.6</b> Example: Social Influence in Perceptual Decision-Making</a></li>
<li class="chapter" data-level="11.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task"><i class="fa fa-check"></i><b>11.7</b> A Bayesian Integration Model for the Marble Task</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions"><i class="fa fa-check"></i><b>11.7.1</b> Intuitive Explanation Using Beta Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model"><i class="fa fa-check"></i><b>11.8</b> The Mathematical Model</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evidence-representation"><i class="fa fa-check"></i><b>11.8.1</b> Evidence Representation</a></li>
<li class="chapter" data-level="11.8.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration"><i class="fa fa-check"></i><b>11.8.2</b> Integration</a></li>
<li class="chapter" data-level="11.8.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#decision"><i class="fa fa-check"></i><b>11.8.3</b> Decision</a></li>
<li class="chapter" data-level="11.8.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation-in-r"><i class="fa fa-check"></i><b>11.8.4</b> Implementation in R</a></li>
<li class="chapter" data-level="11.8.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios"><i class="fa fa-check"></i><b>11.8.5</b> Simulating Experimental Scenarios</a></li>
<li class="chapter" data-level="11.8.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration"><i class="fa fa-check"></i><b>11.8.6</b> Visualizing Bayesian Integration</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios"><i class="fa fa-check"></i><b>11.9</b> Examining Belief Distributions for Selected Scenarios</a></li>
<li class="chapter" data-level="11.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10</b> Weighted Bayesian Integration</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model-1"><i class="fa fa-check"></i><b>11.10.1</b> The Mathematical Model</a></li>
<li class="chapter" data-level="11.10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation"><i class="fa fa-check"></i><b>11.10.2</b> Implementation</a></li>
<li class="chapter" data-level="11.10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10.3</b> Visualizing Weighted Bayesian Integration</a></li>
<li class="chapter" data-level="11.10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence"><i class="fa fa-check"></i><b>11.10.4</b> Resolving Conflicting Evidence</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#common-misinterpretations"><i class="fa fa-check"></i><b>11.11</b> Common Misinterpretations</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weight-interpretation"><i class="fa fa-check"></i><b>11.11.1</b> Weight Interpretation</a></li>
<li class="chapter" data-level="11.11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration-vs.-averaging"><i class="fa fa-check"></i><b>11.11.2</b> Integration vs. Averaging</a></li>
<li class="chapter" data-level="11.11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#interpreting-confidence"><i class="fa fa-check"></i><b>11.11.3</b> Interpreting Confidence</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies"><i class="fa fa-check"></i><b>11.12</b> Simulating Agents with Different Evidence Weighting Strategies</a></li>
<li class="chapter" data-level="11.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation"><i class="fa fa-check"></i><b>11.13</b> Key Observations from the Simulation</a></li>
<li class="chapter" data-level="11.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-quality-checks"><i class="fa fa-check"></i><b>11.14</b> Model Quality Checks</a>
<ul>
<li class="chapter" data-level="11.14.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#overview"><i class="fa fa-check"></i><b>11.14.1</b> Overview</a></li>
<li class="chapter" data-level="11.14.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks"><i class="fa fa-check"></i><b>11.14.2</b> Prior and Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="11.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization-1"><i class="fa fa-check"></i><b>11.15</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="11.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-2"><i class="fa fa-check"></i><b>11.16</b> Parameter recovery</a></li>
<li class="chapter" data-level="11.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-1"><i class="fa fa-check"></i><b>11.17</b> Model comparison</a></li>
<li class="chapter" data-level="11.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#leave-one-out-cross-validation-and-model-comparison"><i class="fa fa-check"></i><b>11.18</b> Leave-One-Out Cross-Validation and Model Comparison</a>
<ul>
<li class="chapter" data-level="11.18.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-loo-cross-validation-in-bayesian-framework"><i class="fa fa-check"></i><b>11.18.1</b> Understanding LOO Cross-Validation in Bayesian Framework</a></li>
<li class="chapter" data-level="11.18.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#step-by-step-implementation-of-loo-cv"><i class="fa fa-check"></i><b>11.18.2</b> Step-by-Step Implementation of LOO-CV</a></li>
<li class="chapter" data-level="11.18.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-psis-loo-diagnostics"><i class="fa fa-check"></i><b>11.18.3</b> Understanding PSIS-LOO Diagnostics</a></li>
<li class="chapter" data-level="11.18.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-for-each-scenario"><i class="fa fa-check"></i><b>11.18.4</b> Model Comparison for Each Scenario</a></li>
<li class="chapter" data-level="11.18.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-the-comparison-results"><i class="fa fa-check"></i><b>11.18.5</b> Visualizing the Comparison Results</a></li>
<li class="chapter" data-level="11.18.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-results"><i class="fa fa-check"></i><b>11.18.6</b> Understanding the Results</a></li>
<li class="chapter" data-level="11.18.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematics-behind-loo-cv"><i class="fa fa-check"></i><b>11.18.7</b> The Mathematics Behind LOO-CV</a></li>
<li class="chapter" data-level="11.18.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-pointwise-contributions-to-loo"><i class="fa fa-check"></i><b>11.18.8</b> Examining Pointwise Contributions to LOO</a></li>
</ul></li>
<li class="chapter" data-level="11.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models"><i class="fa fa-check"></i><b>11.19</b> Multilevel Bayesian Models</a>
<ul>
<li class="chapter" data-level="11.19.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents"><i class="fa fa-check"></i><b>11.19.1</b> Simulating Data from Multiple Agents</a></li>
<li class="chapter" data-level="11.19.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-simulated-data"><i class="fa fa-check"></i><b>11.19.2</b> Understanding the Simulated Data</a></li>
</ul></li>
<li class="chapter" data-level="11.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models-for-evidence-integration"><i class="fa fa-check"></i><b>11.20</b> Multilevel Bayesian Models for Evidence Integration</a>
<ul>
<li class="chapter" data-level="11.20.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-1-simple-evidence-integration-with-individual-scaling"><i class="fa fa-check"></i><b>11.20.1</b> Model 1: Simple Evidence Integration with Individual Scaling</a></li>
<li class="chapter" data-level="11.20.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-2-weighted-evidence-integration"><i class="fa fa-check"></i><b>11.20.2</b> Model 2: Weighted Evidence Integration</a></li>
<li class="chapter" data-level="11.20.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-allow-scaling-to-vary-in-the-simple-model"><i class="fa fa-check"></i><b>11.20.3</b> Why Allow Scaling to Vary in the Simple Model?</a></li>
</ul></li>
<li class="chapter" data-level="11.21" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#from-single-agent-to-multilevel-extending-bayesian-cognitive-models"><i class="fa fa-check"></i><b>11.21</b> From Single-Agent to Multilevel: Extending Bayesian Cognitive Models</a>
<ul>
<li class="chapter" data-level="11.21.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-components-of-the-multilevel-extension"><i class="fa fa-check"></i><b>11.21.1</b> Key Components of the Multilevel Extension</a></li>
<li class="chapter" data-level="11.21.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#hierarchical-prior-structure"><i class="fa fa-check"></i><b>11.21.2</b> 2. Hierarchical Prior Structure</a></li>
<li class="chapter" data-level="11.21.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#handling-data-from-multiple-individuals"><i class="fa fa-check"></i><b>11.21.3</b> 3. Handling Data from Multiple Individuals</a></li>
<li class="chapter" data-level="11.21.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#likelihood-specification"><i class="fa fa-check"></i><b>11.21.4</b> 4. Likelihood Specification</a></li>
<li class="chapter" data-level="11.21.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-these-changes-matter"><i class="fa fa-check"></i><b>11.21.5</b> Why These Changes Matter</a></li>
<li class="chapter" data-level="11.21.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>11.21.6</b> Implementing the Multilevel Weighted Beta-Binomial Model in Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.22" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-multilevel-models"><i class="fa fa-check"></i><b>11.22</b> Fitting the Multilevel Models</a>
<ul>
<li class="chapter" data-level="11.22.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1"><i class="fa fa-check"></i><b>11.22.1</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="11.22.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-2"><i class="fa fa-check"></i><b>11.22.2</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11.23" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#dynamic-bayesian-evidence-integration-sequential-updating-models"><i class="fa fa-check"></i><b>11.23</b> Dynamic Bayesian Evidence Integration: Sequential Updating Models</a>
<ul>
<li class="chapter" data-level="11.23.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-updating-the-theoretical-framework"><i class="fa fa-check"></i><b>11.23.1</b> Sequential Bayesian Updating: The Theoretical Framework</a></li>
<li class="chapter" data-level="11.23.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#single-agent-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.2</b> Single-Agent Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.3</b> Multilevel Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#generating-data-for-the-sequential-model"><i class="fa fa-check"></i><b>11.23.4</b> Generating Data for the Sequential Model</a></li>
<li class="chapter" data-level="11.23.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-and-evaluating-the-sequential-models"><i class="fa fa-check"></i><b>11.23.5</b> Fitting and Evaluating the Sequential Models</a></li>
</ul></li>
<li class="chapter" data-level="11.24" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-evidence-integration-models"><i class="fa fa-check"></i><b>11.24</b> Sequential Bayesian Evidence Integration Models</a>
<ul>
<li class="chapter" data-level="11.24.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-belief-updating-over-time"><i class="fa fa-check"></i><b>11.24.1</b> Understanding Belief Updating Over Time</a></li>
<li class="chapter" data-level="11.24.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-sequential-updating-framework"><i class="fa fa-check"></i><b>11.24.2</b> The Sequential Updating Framework</a></li>
<li class="chapter" data-level="11.24.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#mathematical-formulation"><i class="fa fa-check"></i><b>11.24.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="11.24.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#moving-from-single-agent-to-multilevel"><i class="fa fa-check"></i><b>11.24.4</b> Moving from Single-Agent to Multilevel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html"><i class="fa fa-check"></i><b>12</b> Introduction to Categorization Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-fundamental-problem-of-categorization"><i class="fa fa-check"></i><b>12.1</b> The Fundamental Problem of Categorization</a></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#why-model-categorization"><i class="fa fa-check"></i><b>12.2</b> Why Model Categorization?</a></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#historical-development-of-categorization-models"><i class="fa fa-check"></i><b>12.3</b> Historical Development of Categorization Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#early-views-the-classical-approach"><i class="fa fa-check"></i><b>12.3.1</b> Early Views: The Classical Approach</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-prototype-revolution"><i class="fa fa-check"></i><b>12.3.2</b> The Prototype Revolution</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-exemplar-alternative"><i class="fa fa-check"></i><b>12.3.3</b> The Exemplar Alternative</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models"><i class="fa fa-check"></i><b>12.3.4</b> Rule-Based Models</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-three-model-classes-core-assumptions-and-predictions"><i class="fa fa-check"></i><b>12.4</b> The Three Model Classes: Core Assumptions and Predictions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#exemplar-models-individual-instances-as-category-representations"><i class="fa fa-check"></i><b>12.4.1</b> Exemplar Models: Individual Instances as Category Representations</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#prototype-models-categories-as-central-tendencies"><i class="fa fa-check"></i><b>12.4.2</b> Prototype Models: Categories as Central Tendencies</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models-categories-as-decision-boundaries"><i class="fa fa-check"></i><b>12.4.3</b> Rule-Based Models: Categories as Decision Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#our-implementation-approach"><i class="fa fa-check"></i><b>12.5</b> Our Implementation Approach</a></li>
<li class="chapter" data-level="12.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.6</b> The Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-foundations-and-cognitive-principles"><i class="fa fa-check"></i><b>12.6.1</b> Mathematical Foundations and Cognitive Principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#core-assumptions-of-the-gcm"><i class="fa fa-check"></i><b>12.6.2</b> Core Assumptions of the GCM</a></li>
<li class="chapter" data-level="12.6.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-1"><i class="fa fa-check"></i><b>12.6.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="12.6.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-gcm-agent-implementation"><i class="fa fa-check"></i><b>12.6.4</b> The GCM Agent Implementation</a></li>
<li class="chapter" data-level="12.6.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-behavior-with-the-gcm"><i class="fa fa-check"></i><b>12.6.5</b> Simulating Behavior with the GCM</a></li>
<li class="chapter" data-level="12.6.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-gcm-in-stan-for-parameter-estimation"><i class="fa fa-check"></i><b>12.6.6</b> Implementing the GCM in Stan for Parameter Estimation</a></li>
<li class="chapter" data-level="12.6.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#key-parameters-and-their-cognitive-interpretations"><i class="fa fa-check"></i><b>12.6.7</b> Key Parameters and Their Cognitive Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#multilevel-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.7</b> Multilevel Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-need-for-a-multilevel-approach"><i class="fa fa-check"></i><b>12.7.1</b> The Need for a Multilevel Approach</a></li>
<li class="chapter" data-level="12.7.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-of-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.2</b> Mathematical Formulation of the Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-data-for-a-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.3</b> Simulating Data for a Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-multilevel-gcm-in-stan"><i class="fa fa-check"></i><b>12.7.4</b> Implementing the Multilevel GCM in Stan</a></li>
<li class="chapter" data-level="12.7.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#fitting-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.5</b> Fitting the Multilevel GCM</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#gcm-in-context-strengths-and-limitations"><i class="fa fa-check"></i><b>12.8</b> GCM in Context: Strengths and Limitations</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#strengths"><i class="fa fa-check"></i><b>12.8.1</b> Strengths</a></li>
<li class="chapter" data-level="12.8.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#limitations"><i class="fa fa-check"></i><b>12.8.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#some-notes-about-student-produced-models-of-categorization"><i class="fa fa-check"></i><b>12.9</b> Some notes about student-produced models of categorization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html"><i class="fa fa-check"></i><b>13</b> Prototype-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="13.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#theoretical-foundations"><i class="fa fa-check"></i><b>13.1</b> Theoretical Foundations</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#core-assumptions-of-prototype-models"><i class="fa fa-check"></i><b>13.1.1</b> Core Assumptions of Prototype Models</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#prototype-models-vs.-exemplar-models"><i class="fa fa-check"></i><b>13.2</b> Prototype Models vs. Exemplar Models</a></li>
<li class="chapter" data-level="13.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-kalman-filter-approach-to-prototype-learning"><i class="fa fa-check"></i><b>13.3</b> The Kalman Filter Approach to Prototype Learning</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#mathematical-formulation-of-the-kalman-filter-prototype-model"><i class="fa fa-check"></i><b>13.3.1</b> Mathematical Formulation of the Kalman Filter Prototype Model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-kalman-filter-prototype-model"><i class="fa fa-check"></i><b>13.4</b> Implementing the Kalman Filter Prototype Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#univariate-kalman-filter-for-clear-explanation"><i class="fa fa-check"></i><b>13.4.1</b> Univariate Kalman Filter (for clear explanation)</a></li>
<li class="chapter" data-level="13.4.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#multivariate-kalman-filter-for-categorization"><i class="fa fa-check"></i><b>13.4.2</b> Multivariate Kalman Filter for Categorization</a></li>
<li class="chapter" data-level="13.4.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-observation-noise-parameter"><i class="fa fa-check"></i><b>13.4.3</b> The Observation Noise Parameter</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior-with-the-prototype-model"><i class="fa fa-check"></i><b>13.5</b> Simulating Categorization Behavior with the Prototype Model</a></li>
<li class="chapter" data-level="13.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#visualizing-prototype-learning"><i class="fa fa-check"></i><b>13.6</b> Visualizing Prototype Learning</a></li>
<li class="chapter" data-level="13.7" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#comparing-prototype-and-exemplar-models"><i class="fa fa-check"></i><b>13.7</b> Comparing Prototype and Exemplar Models</a></li>
<li class="chapter" data-level="13.8" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-prototype-model-in-stan"><i class="fa fa-check"></i><b>13.8</b> Implementing the Prototype Model in Stan</a></li>
<li class="chapter" data-level="13.9" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#parameter-recovery-analysis-for-the-prototype-model"><i class="fa fa-check"></i><b>13.9</b> Parameter Recovery Analysis for the Prototype Model</a></li>
<li class="chapter" data-level="13.10" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#cognitive-insights-from-the-prototype-model"><i class="fa fa-check"></i><b>13.10</b> Cognitive Insights from the Prototype Model</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#incremental-learning"><i class="fa fa-check"></i><b>13.10.1</b> 1. Incremental Learning</a></li>
<li class="chapter" data-level="13.10.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#uncertainty-driven-learning"><i class="fa fa-check"></i><b>13.10.2</b> 2. Uncertainty-Driven Learning</a></li>
<li class="chapter" data-level="13.10.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#selective-attention-emerges-naturally"><i class="fa fa-check"></i><b>13.10.3</b> 3. Selective Attention Emerges Naturally</a></li>
<li class="chapter" data-level="13.10.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#memory-efficiency"><i class="fa fa-check"></i><b>13.10.4</b> 4. Memory Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#contrasting-with-exemplar-models"><i class="fa fa-check"></i><b>13.11</b> Contrasting with Exemplar Models</a></li>
<li class="chapter" data-level="13.12" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#strengths-of-the-prototype-approach"><i class="fa fa-check"></i><b>13.12</b> Strengths of the Prototype Approach</a></li>
<li class="chapter" data-level="13.13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#limitations-of-the-prototype-approach"><i class="fa fa-check"></i><b>13.13</b> Limitations of the Prototype Approach</a></li>
<li class="chapter" data-level="13.14" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#extensions-to-the-basic-model"><i class="fa fa-check"></i><b>13.14</b> Extensions to the Basic Model</a></li>
<li class="chapter" data-level="13.15" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#conclusion-the-prototype-and-exemplar-debate"><i class="fa fa-check"></i><b>13.15</b> Conclusion: The Prototype and Exemplar Debate</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">12-CategorizationModelsPrototypes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-models-of-cognition" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Bayesian Models of Cognition<a href="bayesian-models-of-cognition.html#bayesian-models-of-cognition" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-4" class="section level3 hasAnchor" number="11.0.1">
<h3><span class="header-section-number">11.0.1</span> Introduction<a href="bayesian-models-of-cognition.html#introduction-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The impressive power of Bayes theorem and Bayesian approaches to modeling has tempted cognitive scientists into exploring how far they could get in thinking the mind and brain as Bayesian machines. The idea is that the mind is a probabilistic machine that updates its beliefs based on the evidence it receives. The human mind constantly receives input from various sources – direct personal experience, social information from others, prior knowledge, and sensory input. A fundamental question in cognitive science is how these disparate pieces of information are combined to produce coherent beliefs about the world.
The Bayesian framework offers a powerful approach to modeling this process. Under this framework, the mind is conceptualized as a probabilistic machine that continuously updates its beliefs based on new evidence. This contrasts with rule-based or purely associative models by emphasizing:</p>
<ul>
<li><p>Representations of uncertainty: Beliefs are represented as probability distributions, not single values</p></li>
<li><p>Optimal integration: Information is combined according to its reliability</p></li>
<li><p>Prior knowledge: New evidence is interpreted in light of existing beliefs</p></li>
</ul>
<p>In this chapter, we will explore how Bayesian integration can be formalized and used to model cognitive processes. We’ll start with simple models that give equal weight to different information sources, then develop more sophisticated models that allow for differential weighting based on source reliability, and finally consider how beliefs might update over time.</p>
<p>This chapter is not a comprehensive review of Bayesian cognitive modeling, but rather a practical introduction to the topic. We’ll focus on simple models that illustrate key concepts and provide a foundation for more advanced applications.</p>
<p>To go further in your learning check on Bayesian models of cognition check:</p>
<ul>
<li><p>Ma, W. J., Kording, K. P., &amp; Goldreich, D. (2023). Bayesian models of perception and action: An introduction. MIT press.</p></li>
<li><p>Griffiths, T. L., Chater, N., &amp; Tenenbaum, J. B. (Eds.). (2024). Bayesian models of cognition: reverse engineering the mind. MIT Press.</p></li>
<li><p>N. D. Goodman, J. B. Tenenbaum, and The ProbMods Contributors (2016). Probabilistic Models of Cognition (2nd ed.). Retrieved 2025-3-10 from <a href="https://probmods.org/" class="uri">https://probmods.org/</a></p></li>
</ul>
</div>
<div id="learning-objectives-4" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Learning Objectives<a href="bayesian-models-of-cognition.html#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After completing this chapter, you will be able to:</p>
<ul>
<li><p>Understand the basic principles of Bayesian information integration</p></li>
<li><p>Implement models that combine multiple sources of information in a principled Bayesian way</p></li>
<li><p>Fit and evaluate these models using Stan</p></li>
<li><p>Differentiate between alternative Bayesian updating schemes</p></li>
<li><p>Apply Bayesian cognitive models to decision-making data</p></li>
</ul>
</div>
<div id="chapter-roadmap-1" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Chapter Roadmap<a href="bayesian-models-of-cognition.html#chapter-roadmap-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will:</p>
<ul>
<li><p>Introduce the Bayesian framework for cognitive modeling</p></li>
<li><p>Implement a simple Bayesian integration model</p></li>
<li><p>Develop and test a weighted Bayesian model that allows for different source reliability</p></li>
<li><p>Explore temporal Bayesian updating</p></li>
<li><p>Extend our models to multilevel structures that capture individual differences</p></li>
<li><p>Compare alternative Bayesian models and evaluate their cognitive implications</p></li>
</ul>
</div>
<div id="the-bayesian-framework-for-cognition" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> The Bayesian Framework for Cognition<a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian models of cognition explore the idea that the mind operates according to principles similar to Bayes’ theorem, combining different sources of evidence to form updated beliefs. Most commonly this is framed in terms of prior beliefs being updated with new evidence to form updated posterior beliefs. Formally:</p>
<p>P(belief | evidence) ∝ P(evidence | belief) × P(belief)</p>
<p>Where:</p>
<ul>
<li><p>P(belief | evidence) is the posterior belief after observing evidence</p></li>
<li><p>P(evidence | belief) is the likelihood of observing the evidence given a belief</p></li>
<li><p>P(belief) is the prior belief before observing evidence</p></li>
</ul>
<p>In cognitive terms, this means people integrate new information with existing knowledge, giving more weight to reliable information sources and less weight to unreliable ones. Yet, there is nothing mathematically special about the prior and the likelihood. They are just two sources of information that are combined in a way that is consistent with the rules of probability. Any other combination of information sources can be modeled with the same theorem.</p>
<hr />
<p>Note that a more traditional formula for Bayes Theorem would be</p>
<p>P(belief | evidence) = [P(evidence | belief) × P(belief)] / P(evidence)</p>
<p>where the product of prior and likelihood is normalized by P(evidence) (bringing it back to a probability scale).
That’s why we used a ∝ symbol in the formula above, to indicate that we are not considering the normalization constant, and that the posterior is only proportional (and not exactly equal) to the multiplication of the two sources of information. Nevertheless, this is a first useful approximation of the theorem, which we can build on in the rest of the chapter.
***</p>
</div>
<div id="visualizing-bayesian-updating" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Visualizing Bayesian Updating<a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To better understand Bayesian updating, let’s create a conceptual diagram:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="bayesian-models-of-cognition.html#cb458-1" tabindex="-1"></a><span class="co"># Create a visualization of Bayesian updating process</span></span>
<span id="cb458-2"><a href="bayesian-models-of-cognition.html#cb458-2" tabindex="-1"></a></span>
<span id="cb458-3"><a href="bayesian-models-of-cognition.html#cb458-3" tabindex="-1"></a><span class="co"># Function to create Bayesian updating visualization</span></span>
<span id="cb458-4"><a href="bayesian-models-of-cognition.html#cb458-4" tabindex="-1"></a>create_bayesian_updating_diagram <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb458-5"><a href="bayesian-models-of-cognition.html#cb458-5" tabindex="-1"></a>  <span class="co"># Create example data</span></span>
<span id="cb458-6"><a href="bayesian-models-of-cognition.html#cb458-6" tabindex="-1"></a>  <span class="co"># Prior (starting with uniform distribution)</span></span>
<span id="cb458-7"><a href="bayesian-models-of-cognition.html#cb458-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb458-8"><a href="bayesian-models-of-cognition.html#cb458-8" tabindex="-1"></a>  prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb458-9"><a href="bayesian-models-of-cognition.html#cb458-9" tabindex="-1"></a>  </span>
<span id="cb458-10"><a href="bayesian-models-of-cognition.html#cb458-10" tabindex="-1"></a>  <span class="co"># Likelihood (evidence suggesting higher probability)</span></span>
<span id="cb458-11"><a href="bayesian-models-of-cognition.html#cb458-11" tabindex="-1"></a>  likelihood <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="dv">7</span>, <span class="dv">3</span>)</span>
<span id="cb458-12"><a href="bayesian-models-of-cognition.html#cb458-12" tabindex="-1"></a>  </span>
<span id="cb458-13"><a href="bayesian-models-of-cognition.html#cb458-13" tabindex="-1"></a>  <span class="co"># Posterior (combines prior and likelihood)</span></span>
<span id="cb458-14"><a href="bayesian-models-of-cognition.html#cb458-14" tabindex="-1"></a>  posterior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="dv">8</span>, <span class="dv">4</span>)  <span class="co"># 1+7, 1+3</span></span>
<span id="cb458-15"><a href="bayesian-models-of-cognition.html#cb458-15" tabindex="-1"></a>  </span>
<span id="cb458-16"><a href="bayesian-models-of-cognition.html#cb458-16" tabindex="-1"></a>  <span class="co"># Create data frame for plotting</span></span>
<span id="cb458-17"><a href="bayesian-models-of-cognition.html#cb458-17" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb458-18"><a href="bayesian-models-of-cognition.html#cb458-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb458-19"><a href="bayesian-models-of-cognition.html#cb458-19" tabindex="-1"></a>    <span class="at">density =</span> <span class="fu">c</span>(prior, likelihood, posterior),</span>
<span id="cb458-20"><a href="bayesian-models-of-cognition.html#cb458-20" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Likelihood&quot;</span>, <span class="st">&quot;Posterior&quot;</span>), <span class="at">each =</span> <span class="fu">length</span>(x)),</span>
<span id="cb458-21"><a href="bayesian-models-of-cognition.html#cb458-21" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Likelihood&quot;</span>, <span class="st">&quot;Posterior&quot;</span>))</span>
<span id="cb458-22"><a href="bayesian-models-of-cognition.html#cb458-22" tabindex="-1"></a>  )</span>
<span id="cb458-23"><a href="bayesian-models-of-cognition.html#cb458-23" tabindex="-1"></a>  </span>
<span id="cb458-24"><a href="bayesian-models-of-cognition.html#cb458-24" tabindex="-1"></a>  <span class="co"># Create main plot showing distributions</span></span>
<span id="cb458-25"><a href="bayesian-models-of-cognition.html#cb458-25" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">color =</span> distribution, <span class="at">linetype =</span> distribution)) <span class="sc">+</span></span>
<span id="cb458-26"><a href="bayesian-models-of-cognition.html#cb458-26" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb458-27"><a href="bayesian-models-of-cognition.html#cb458-27" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Likelihood&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;purple&quot;</span>)) <span class="sc">+</span></span>
<span id="cb458-28"><a href="bayesian-models-of-cognition.html#cb458-28" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;Likelihood&quot;</span> <span class="ot">=</span> <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;solid&quot;</span>)) <span class="sc">+</span></span>
<span id="cb458-29"><a href="bayesian-models-of-cognition.html#cb458-29" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bayesian Updating Process&quot;</span>,</span>
<span id="cb458-30"><a href="bayesian-models-of-cognition.html#cb458-30" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Combining prior beliefs with new evidence&quot;</span>,</span>
<span id="cb458-31"><a href="bayesian-models-of-cognition.html#cb458-31" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Belief (probability)&quot;</span>,</span>
<span id="cb458-32"><a href="bayesian-models-of-cognition.html#cb458-32" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Probability Density&quot;</span>,</span>
<span id="cb458-33"><a href="bayesian-models-of-cognition.html#cb458-33" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Distribution&quot;</span>,</span>
<span id="cb458-34"><a href="bayesian-models-of-cognition.html#cb458-34" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="st">&quot;Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb458-35"><a href="bayesian-models-of-cognition.html#cb458-35" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb458-36"><a href="bayesian-models-of-cognition.html#cb458-36" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb458-37"><a href="bayesian-models-of-cognition.html#cb458-37" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="fl">0.9</span>, <span class="at">label =</span> <span class="st">&quot;Low certainty</span><span class="sc">\n</span><span class="st">prior belief&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb458-38"><a href="bayesian-models-of-cognition.html#cb458-38" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">&quot;New evidence</span><span class="sc">\n</span><span class="st">suggests high</span><span class="sc">\n</span><span class="st">probability&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb458-39"><a href="bayesian-models-of-cognition.html#cb458-39" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">2.2</span>, <span class="at">label =</span> <span class="st">&quot;Updated belief</span><span class="sc">\n</span><span class="st">combines both</span><span class="sc">\n</span><span class="st">sources&quot;</span>, <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb458-40"><a href="bayesian-models-of-cognition.html#cb458-40" tabindex="-1"></a>  </span>
<span id="cb458-41"><a href="bayesian-models-of-cognition.html#cb458-41" tabindex="-1"></a>  <span class="co"># Create flow diagram to illustrate process</span></span>
<span id="cb458-42"><a href="bayesian-models-of-cognition.html#cb458-42" tabindex="-1"></a>  flow_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb458-43"><a href="bayesian-models-of-cognition.html#cb458-43" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb458-44"><a href="bayesian-models-of-cognition.html#cb458-44" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb458-45"><a href="bayesian-models-of-cognition.html#cb458-45" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Prior</span><span class="sc">\n</span><span class="st">Belief&quot;</span>, <span class="st">&quot;Evidence&quot;</span>, <span class="st">&quot;Posterior</span><span class="sc">\n</span><span class="st">Belief&quot;</span>),</span>
<span id="cb458-46"><a href="bayesian-models-of-cognition.html#cb458-46" tabindex="-1"></a>    <span class="at">box_color =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb458-47"><a href="bayesian-models-of-cognition.html#cb458-47" tabindex="-1"></a>  )</span>
<span id="cb458-48"><a href="bayesian-models-of-cognition.html#cb458-48" tabindex="-1"></a>  </span>
<span id="cb458-49"><a href="bayesian-models-of-cognition.html#cb458-49" tabindex="-1"></a>  arrow_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb458-50"><a href="bayesian-models-of-cognition.html#cb458-50" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="fl">2.3</span>),</span>
<span id="cb458-51"><a href="bayesian-models-of-cognition.html#cb458-51" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">2.7</span>),</span>
<span id="cb458-52"><a href="bayesian-models-of-cognition.html#cb458-52" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb458-53"><a href="bayesian-models-of-cognition.html#cb458-53" tabindex="-1"></a>    <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb458-54"><a href="bayesian-models-of-cognition.html#cb458-54" tabindex="-1"></a>  )</span>
<span id="cb458-55"><a href="bayesian-models-of-cognition.html#cb458-55" tabindex="-1"></a>  </span>
<span id="cb458-56"><a href="bayesian-models-of-cognition.html#cb458-56" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb458-57"><a href="bayesian-models-of-cognition.html#cb458-57" tabindex="-1"></a>    <span class="co"># Add boxes for process stages</span></span>
<span id="cb458-58"><a href="bayesian-models-of-cognition.html#cb458-58" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> flow_data, <span class="fu">aes</span>(<span class="at">xmin =</span> x <span class="sc">-</span> <span class="fl">0.3</span>, <span class="at">xmax =</span> x <span class="sc">+</span> <span class="fl">0.3</span>, </span>
<span id="cb458-59"><a href="bayesian-models-of-cognition.html#cb458-59" tabindex="-1"></a>                                   <span class="at">ymin =</span> y <span class="sc">-</span> <span class="fl">0.3</span>, <span class="at">ymax =</span> y <span class="sc">+</span> <span class="fl">0.3</span>,</span>
<span id="cb458-60"><a href="bayesian-models-of-cognition.html#cb458-60" tabindex="-1"></a>                                   <span class="at">fill =</span> box_color), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb458-61"><a href="bayesian-models-of-cognition.html#cb458-61" tabindex="-1"></a>    <span class="co"># Add text labels</span></span>
<span id="cb458-62"><a href="bayesian-models-of-cognition.html#cb458-62" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> flow_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb458-63"><a href="bayesian-models-of-cognition.html#cb458-63" tabindex="-1"></a>    <span class="co"># Add arrows</span></span>
<span id="cb458-64"><a href="bayesian-models-of-cognition.html#cb458-64" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> arrow_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend),</span>
<span id="cb458-65"><a href="bayesian-models-of-cognition.html#cb458-65" tabindex="-1"></a>                <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>)) <span class="sc">+</span></span>
<span id="cb458-66"><a href="bayesian-models-of-cognition.html#cb458-66" tabindex="-1"></a>    <span class="co"># Add the operation being performed</span></span>
<span id="cb458-67"><a href="bayesian-models-of-cognition.html#cb458-67" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">label =</span> <span class="st">&quot;×&quot;</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb458-68"><a href="bayesian-models-of-cognition.html#cb458-68" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">label =</span> <span class="st">&quot;∝&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb458-69"><a href="bayesian-models-of-cognition.html#cb458-69" tabindex="-1"></a>    <span class="co"># Formatting</span></span>
<span id="cb458-70"><a href="bayesian-models-of-cognition.html#cb458-70" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>)) <span class="sc">+</span></span>
<span id="cb458-71"><a href="bayesian-models-of-cognition.html#cb458-71" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb458-72"><a href="bayesian-models-of-cognition.html#cb458-72" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb458-73"><a href="bayesian-models-of-cognition.html#cb458-73" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bayesian Inference Flow&quot;</span>)</span>
<span id="cb458-74"><a href="bayesian-models-of-cognition.html#cb458-74" tabindex="-1"></a>  </span>
<span id="cb458-75"><a href="bayesian-models-of-cognition.html#cb458-75" tabindex="-1"></a>  <span class="co"># Combine plots vertically</span></span>
<span id="cb458-76"><a href="bayesian-models-of-cognition.html#cb458-76" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb458-77"><a href="bayesian-models-of-cognition.html#cb458-77" tabindex="-1"></a>  </span>
<span id="cb458-78"><a href="bayesian-models-of-cognition.html#cb458-78" tabindex="-1"></a>  <span class="fu">return</span>(combined_plot)</span>
<span id="cb458-79"><a href="bayesian-models-of-cognition.html#cb458-79" tabindex="-1"></a>}</span>
<span id="cb458-80"><a href="bayesian-models-of-cognition.html#cb458-80" tabindex="-1"></a></span>
<span id="cb458-81"><a href="bayesian-models-of-cognition.html#cb458-81" tabindex="-1"></a><span class="co"># Generate and display the diagram</span></span>
<span id="cb458-82"><a href="bayesian-models-of-cognition.html#cb458-82" tabindex="-1"></a><span class="fu">create_bayesian_updating_diagram</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/10%20visualizing%20bayesian%20updating-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This diagram illustrates the key elements of Bayesian updating:</p>
<ul>
<li><p>Prior belief (blue dashed line): Our initial uncertainty about a phenomenon, before seeing evidence</p></li>
<li><p>Likelihood (red dotted line): The pattern of evidence we observe</p></li>
<li><p>Posterior belief (purple solid line): Our updated belief after combining prior and evidence</p></li>
</ul>
<p>Notice how the posterior distribution:</p>
<ul>
<li><p>Is narrower than either the prior or likelihood alone (indicating increased certainty)</p></li>
<li><p>Sits between the prior and likelihood, but closer to the likelihood (as the evidence was fairly strong)</p></li>
<li><p>Has its peak shifted from the prior toward the likelihood (reflecting belief updating)</p></li>
</ul>
<p>The bottom diagram shows the algebraic process: we multiply the prior by the likelihood, then normalize to get the posterior belief.</p>
</div>
<div id="bayesian-models-in-cognitive-science" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Bayesian Models in Cognitive Science<a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian cognitive models have been successfully applied to a wide range of phenomena:</p>
<ul>
<li><p>Perception: How we combine multiple sensory cues (visual, auditory, tactile) to form a unified percept</p></li>
<li><p>Learning: How we update our knowledge from observation and instruction</p></li>
<li><p>Decision-making: How we weigh different sources of evidence when making choices</p></li>
<li><p>Social cognition: How we integrate others’ opinions with our own knowledge</p></li>
<li><p>Language: How we disambiguate words and sentences based on context</p></li>
<li><p>Psychopathology: How crucial aspects of conditions like schizophrenia and autism can be understood in terms of atypical Bayesian inference (e.g. atypical weights given to different sources of information, or hyper-precise priors or hyper-precise likelihood).</p></li>
</ul>
</div>
<div id="example-social-influence-in-perceptual-decision-making" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Example: Social Influence in Perceptual Decision-Making<a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To ground our discussion in a cognitive science context, let’s consider a simplified version of a recent study examining how people with and without schizophrenia integrate information from different sources (Simonsen et al., 2021).</p>
<p>In this task, participants needed to guess the color of the next marble drawn from a jar. They received information from two sources:</p>
<ul>
<li><p>Direct evidence: A small sample of 8 marbles drawn from the jar (e.g., 6 blue and 2 red marbles)</p></li>
<li><p>Social evidence: The choices and confidence ratings of four other people who had seen their own independent samples from the jar</p></li>
</ul>
<p>This paradigm allows researchers to examine how individuals integrate their own direct perceptual evidence with socially transmitted information — a fundamental process in human cognition that may be altered in certain clinical conditions and be involved in generating some aspects of their psychopathology.</p>
<p>For simplicity, we’ll focus on a binary version where participants must guess whether the next marble will be blue or red, and we’ll examine how they integrate their direct sample with social information from just what one other person has chosen. Further, at every trial the participants are given a new jar with a potentially different proportion of blue and red marbles, so there is no learning involved.</p>
</div>
<div id="a-bayesian-integration-model-for-the-marble-task" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> A Bayesian Integration Model for the Marble Task<a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In a fully Bayesian approach, participants would:</p>
<ul>
<li><p>Use direct evidence to form a belief about the proportion of blue marbles in the jar</p></li>
<li><p>Use social evidence to form another belief about the same proportion</p></li>
<li><p>Combine these beliefs in a principled way to make their final judgment</p></li>
</ul>
<div id="intuitive-explanation-using-beta-distributions" class="section level3 hasAnchor" number="11.7.1">
<h3><span class="header-section-number">11.7.1</span> Intuitive Explanation Using Beta Distributions<a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The beta distribution provides an elegant way to represent beliefs about proportions (like the proportion of blue marbles in a jar):</p>
<ul>
<li><p>The beta distribution is defined by two parameters, traditionally called α (alpha) and β (beta).</p></li>
<li><p>These parameters have an intuitive interpretation: you can think of α as the number of “successes” you’ve observed (e.g., blue marbles) plus 1, and β as the number of “failures” (e.g., red marbles) plus 1.</p></li>
<li><p>So a Beta(1,1) distribution represents a uniform belief - no prior knowledge about the proportion.</p></li>
<li><p>After observing evidence, you simply add the counts to these parameters:</p>
<ul>
<li>If you see 6 blue and 2 red marbles, your updated belief is Beta(1+6, 1+2) = Beta(7, 3)</li>
<li>This distribution has its peak at 7/(7+3) = 0.7, reflecting your belief that the true proportion is around 70% blue</li>
</ul></li>
<li><p>To combine multiple sources of evidence, you simply add all the counts together:</p>
<ul>
<li><p>If direct evidence gives Beta(7, 3) and social evidence suggests Beta(2, 4)</p></li>
<li><p>Your combined belief is Beta(7+2, 3+4) = Beta(9, 7)</p></li>
<li><p>This has its peak at 9/(9+7) = 0.56, reflecting a compromise between the two sources</p></li>
</ul></li>
</ul>
<p>The beauty of this approach is that it automatically weights evidence by its strength (amount of data) and properly represents uncertainty through the width of the distribution.</p>
</div>
</div>
<div id="the-mathematical-model" class="section level2 hasAnchor" number="11.8">
<h2><span class="header-section-number">11.8</span> The Mathematical Model<a href="bayesian-models-of-cognition.html#the-mathematical-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For our marble task, the Bayesian inference process involves:</p>
<div id="evidence-representation" class="section level3 hasAnchor" number="11.8.1">
<h3><span class="header-section-number">11.8.1</span> Evidence Representation<a href="bayesian-models-of-cognition.html#evidence-representation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Direct evidence: Observing blue1 blue marbles and red1 red marbles out of total1 trials</p></li>
<li><p>Social evidence: Inferring blue2 blue marbles and red2 red marbles from social information. If we consider only their choice: red corresponds to the sampling of one red marble; blue corresponds to the sampling of one blue marble. If we consider their confidence, we might try to make this correspond to the marbles the sampled: “Clear blue” might imply 8 blue marbles; maybe blue might imply 6 blue and 2 red marbles; “maybe red” might imply 6 red and 2 blue marbles; “clear red” might imply 8 red marbles. Alternatively we can keep it more uncertain and reduce the assumed sample to 0 blue out of 3, 1 blue out of 3, 2 blue marbles out of 3, or 3 blue marbles out of 3. This intrinsically models the added uncertainty in observing the other’s choice and not their samples.</p></li>
</ul>
</div>
<div id="integration" class="section level3 hasAnchor" number="11.8.2">
<h3><span class="header-section-number">11.8.2</span> Integration<a href="bayesian-models-of-cognition.html#integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The integrated belief is represented by a posterior beta distribution:</p>
<p>Beta(α + blue1 + blue2, β + red1 + red2)</p>
<p>Where α and β are prior parameters (typically 1 each for a uniform prior)</p>
</div>
<div id="decision" class="section level3 hasAnchor" number="11.8.3">
<h3><span class="header-section-number">11.8.3</span> Decision<a href="bayesian-models-of-cognition.html#decision" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Final choice (blue or red) depends on whether the expected value of this distribution is above 0.5</p></li>
<li><p>Confidence depends on the concentration of the distribution</p></li>
</ul>
</div>
<div id="implementation-in-r" class="section level3 hasAnchor" number="11.8.4">
<h3><span class="header-section-number">11.8.4</span> Implementation in R<a href="bayesian-models-of-cognition.html#implementation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="bayesian-models-of-cognition.html#cb459-1" tabindex="-1"></a><span class="co"># Beta-binomial model for Bayesian integration in the marble task</span></span>
<span id="cb459-2"><a href="bayesian-models-of-cognition.html#cb459-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb459-3"><a href="bayesian-models-of-cognition.html#cb459-3" tabindex="-1"></a><span class="co"># This function implements a Bayesian integration model for combining direct and social evidence</span></span>
<span id="cb459-4"><a href="bayesian-models-of-cognition.html#cb459-4" tabindex="-1"></a><span class="co"># about the proportion of blue marbles in a jar. It uses the beta-binomial model, which is</span></span>
<span id="cb459-5"><a href="bayesian-models-of-cognition.html#cb459-5" tabindex="-1"></a><span class="co"># particularly suitable for reasoning about proportions.</span></span>
<span id="cb459-6"><a href="bayesian-models-of-cognition.html#cb459-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb459-7"><a href="bayesian-models-of-cognition.html#cb459-7" tabindex="-1"></a><span class="co"># Parameters:</span></span>
<span id="cb459-8"><a href="bayesian-models-of-cognition.html#cb459-8" tabindex="-1"></a><span class="co">#   alpha_prior: Prior alpha parameter (conceptually: prior blue marbles + 1)</span></span>
<span id="cb459-9"><a href="bayesian-models-of-cognition.html#cb459-9" tabindex="-1"></a><span class="co">#   beta_prior: Prior beta parameter (conceptually: prior red marbles + 1)</span></span>
<span id="cb459-10"><a href="bayesian-models-of-cognition.html#cb459-10" tabindex="-1"></a><span class="co">#   blue1: Number of blue marbles in direct evidence</span></span>
<span id="cb459-11"><a href="bayesian-models-of-cognition.html#cb459-11" tabindex="-1"></a><span class="co">#   total1: Total marbles in direct evidence</span></span>
<span id="cb459-12"><a href="bayesian-models-of-cognition.html#cb459-12" tabindex="-1"></a><span class="co">#   blue2: Effective blue marbles from social evidence</span></span>
<span id="cb459-13"><a href="bayesian-models-of-cognition.html#cb459-13" tabindex="-1"></a><span class="co">#   total2: Effective total marbles from social evidence</span></span>
<span id="cb459-14"><a href="bayesian-models-of-cognition.html#cb459-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb459-15"><a href="bayesian-models-of-cognition.html#cb459-15" tabindex="-1"></a><span class="co"># Returns:</span></span>
<span id="cb459-16"><a href="bayesian-models-of-cognition.html#cb459-16" tabindex="-1"></a><span class="co">#   List with posterior parameters and statistics for decision-making</span></span>
<span id="cb459-17"><a href="bayesian-models-of-cognition.html#cb459-17" tabindex="-1"></a>betaBinomialModel <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha_prior, beta_prior, blue1, total1, blue2, total2) {</span>
<span id="cb459-18"><a href="bayesian-models-of-cognition.html#cb459-18" tabindex="-1"></a>  <span class="co"># Calculate red marbles for each source</span></span>
<span id="cb459-19"><a href="bayesian-models-of-cognition.html#cb459-19" tabindex="-1"></a>  red1 <span class="ot">&lt;-</span> total1 <span class="sc">-</span> blue1  <span class="co"># Number of red marbles in direct evidence</span></span>
<span id="cb459-20"><a href="bayesian-models-of-cognition.html#cb459-20" tabindex="-1"></a>  red2 <span class="ot">&lt;-</span> total2 <span class="sc">-</span> blue2  <span class="co"># Inferred number of red marbles from social evidence</span></span>
<span id="cb459-21"><a href="bayesian-models-of-cognition.html#cb459-21" tabindex="-1"></a>  </span>
<span id="cb459-22"><a href="bayesian-models-of-cognition.html#cb459-22" tabindex="-1"></a>  <span class="co"># The key insight of Bayesian integration: simply add up all evidence counts</span></span>
<span id="cb459-23"><a href="bayesian-models-of-cognition.html#cb459-23" tabindex="-1"></a>  <span class="co"># This automatically gives more weight to sources with more data</span></span>
<span id="cb459-24"><a href="bayesian-models-of-cognition.html#cb459-24" tabindex="-1"></a>  alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue1 <span class="sc">+</span> blue2  <span class="co"># Posterior alpha (total blues + prior)</span></span>
<span id="cb459-25"><a href="bayesian-models-of-cognition.html#cb459-25" tabindex="-1"></a>  beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red1 <span class="sc">+</span> red2      <span class="co"># Posterior beta (total reds + prior)</span></span>
<span id="cb459-26"><a href="bayesian-models-of-cognition.html#cb459-26" tabindex="-1"></a>  </span>
<span id="cb459-27"><a href="bayesian-models-of-cognition.html#cb459-27" tabindex="-1"></a>  <span class="co"># Calculate posterior statistics</span></span>
<span id="cb459-28"><a href="bayesian-models-of-cognition.html#cb459-28" tabindex="-1"></a>  expected_rate <span class="ot">&lt;-</span> alpha_post <span class="sc">/</span> (alpha_post <span class="sc">+</span> beta_post)  <span class="co"># Mean of beta distribution</span></span>
<span id="cb459-29"><a href="bayesian-models-of-cognition.html#cb459-29" tabindex="-1"></a>  </span>
<span id="cb459-30"><a href="bayesian-models-of-cognition.html#cb459-30" tabindex="-1"></a>  <span class="co"># Variance has a simple formula for beta distributions</span></span>
<span id="cb459-31"><a href="bayesian-models-of-cognition.html#cb459-31" tabindex="-1"></a>  <span class="co"># Lower variance = higher confidence in our estimate</span></span>
<span id="cb459-32"><a href="bayesian-models-of-cognition.html#cb459-32" tabindex="-1"></a>  variance <span class="ot">&lt;-</span> (alpha_post <span class="sc">*</span> beta_post) <span class="sc">/</span> </span>
<span id="cb459-33"><a href="bayesian-models-of-cognition.html#cb459-33" tabindex="-1"></a>             ((alpha_post <span class="sc">+</span> beta_post)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (alpha_post <span class="sc">+</span> beta_post <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb459-34"><a href="bayesian-models-of-cognition.html#cb459-34" tabindex="-1"></a>  </span>
<span id="cb459-35"><a href="bayesian-models-of-cognition.html#cb459-35" tabindex="-1"></a>  <span class="co"># Calculate 95% credible interval using beta quantile functions</span></span>
<span id="cb459-36"><a href="bayesian-models-of-cognition.html#cb459-36" tabindex="-1"></a>  <span class="co"># This gives us bounds within which we believe the true proportion lies</span></span>
<span id="cb459-37"><a href="bayesian-models-of-cognition.html#cb459-37" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.025</span>, alpha_post, beta_post)</span>
<span id="cb459-38"><a href="bayesian-models-of-cognition.html#cb459-38" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.975</span>, alpha_post, beta_post)</span>
<span id="cb459-39"><a href="bayesian-models-of-cognition.html#cb459-39" tabindex="-1"></a>  </span>
<span id="cb459-40"><a href="bayesian-models-of-cognition.html#cb459-40" tabindex="-1"></a>  <span class="co"># Calculate confidence based on variance</span></span>
<span id="cb459-41"><a href="bayesian-models-of-cognition.html#cb459-41" tabindex="-1"></a>  <span class="co"># Higher variance = lower confidence; transform to 0-1 scale</span></span>
<span id="cb459-42"><a href="bayesian-models-of-cognition.html#cb459-42" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(variance))</span>
<span id="cb459-43"><a href="bayesian-models-of-cognition.html#cb459-43" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, <span class="fu">min</span>(<span class="dv">1</span>, confidence))  <span class="co"># Bound between 0 and 1</span></span>
<span id="cb459-44"><a href="bayesian-models-of-cognition.html#cb459-44" tabindex="-1"></a>  </span>
<span id="cb459-45"><a href="bayesian-models-of-cognition.html#cb459-45" tabindex="-1"></a>  <span class="co"># Make decision based on whether expected rate exceeds 0.5</span></span>
<span id="cb459-46"><a href="bayesian-models-of-cognition.html#cb459-46" tabindex="-1"></a>  <span class="co"># If P(blue) &gt; 0.5, choose blue; otherwise choose red</span></span>
<span id="cb459-47"><a href="bayesian-models-of-cognition.html#cb459-47" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(expected_rate <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">&quot;Blue&quot;</span>, <span class="st">&quot;Red&quot;</span>)</span>
<span id="cb459-48"><a href="bayesian-models-of-cognition.html#cb459-48" tabindex="-1"></a>  </span>
<span id="cb459-49"><a href="bayesian-models-of-cognition.html#cb459-49" tabindex="-1"></a>  <span class="co"># Return all calculated parameters in a structured list</span></span>
<span id="cb459-50"><a href="bayesian-models-of-cognition.html#cb459-50" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb459-51"><a href="bayesian-models-of-cognition.html#cb459-51" tabindex="-1"></a>    <span class="at">alpha_post =</span> alpha_post,</span>
<span id="cb459-52"><a href="bayesian-models-of-cognition.html#cb459-52" tabindex="-1"></a>    <span class="at">beta_post =</span> beta_post,</span>
<span id="cb459-53"><a href="bayesian-models-of-cognition.html#cb459-53" tabindex="-1"></a>    <span class="at">expected_rate =</span> expected_rate,</span>
<span id="cb459-54"><a href="bayesian-models-of-cognition.html#cb459-54" tabindex="-1"></a>    <span class="at">variance =</span> variance,</span>
<span id="cb459-55"><a href="bayesian-models-of-cognition.html#cb459-55" tabindex="-1"></a>    <span class="at">ci_lower =</span> ci_lower,</span>
<span id="cb459-56"><a href="bayesian-models-of-cognition.html#cb459-56" tabindex="-1"></a>    <span class="at">ci_upper =</span> ci_upper,</span>
<span id="cb459-57"><a href="bayesian-models-of-cognition.html#cb459-57" tabindex="-1"></a>    <span class="at">confidence =</span> confidence,</span>
<span id="cb459-58"><a href="bayesian-models-of-cognition.html#cb459-58" tabindex="-1"></a>    <span class="at">choice =</span> choice</span>
<span id="cb459-59"><a href="bayesian-models-of-cognition.html#cb459-59" tabindex="-1"></a>  ))</span>
<span id="cb459-60"><a href="bayesian-models-of-cognition.html#cb459-60" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="simulating-experimental-scenarios" class="section level3 hasAnchor" number="11.8.5">
<h3><span class="header-section-number">11.8.5</span> Simulating Experimental Scenarios<a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll create a comprehensive set of scenarios by varying both direct evidence (number of blue marbles observed directly) and social evidence (number of blue marbles inferred from social information).</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="bayesian-models-of-cognition.html#cb460-1" tabindex="-1"></a><span class="co"># Set total counts for direct and social evidence</span></span>
<span id="cb460-2"><a href="bayesian-models-of-cognition.html#cb460-2" tabindex="-1"></a>total1 <span class="ot">&lt;-</span> <span class="dv">8</span>  <span class="co"># Total marbles in direct evidence</span></span>
<span id="cb460-3"><a href="bayesian-models-of-cognition.html#cb460-3" tabindex="-1"></a>total2 <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Total evidence units in social evidence</span></span>
<span id="cb460-4"><a href="bayesian-models-of-cognition.html#cb460-4" tabindex="-1"></a></span>
<span id="cb460-5"><a href="bayesian-models-of-cognition.html#cb460-5" tabindex="-1"></a><span class="co"># Create all possible combinations of direct and social evidence</span></span>
<span id="cb460-6"><a href="bayesian-models-of-cognition.html#cb460-6" tabindex="-1"></a>scenarios <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb460-7"><a href="bayesian-models-of-cognition.html#cb460-7" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>),  <span class="co"># Direct evidence: 0 to 8 blue marbles</span></span>
<span id="cb460-8"><a href="bayesian-models-of-cognition.html#cb460-8" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>)   <span class="co"># Social evidence: 0 to 3 blue marbles (confidence levels)</span></span>
<span id="cb460-9"><a href="bayesian-models-of-cognition.html#cb460-9" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb460-10"><a href="bayesian-models-of-cognition.html#cb460-10" tabindex="-1"></a>  <span class="at">red1 =</span> total1 <span class="sc">-</span> blue1,  <span class="co"># Calculate red marbles for direct evidence</span></span>
<span id="cb460-11"><a href="bayesian-models-of-cognition.html#cb460-11" tabindex="-1"></a>  <span class="at">red2 =</span> total2 <span class="sc">-</span> blue2   <span class="co"># Calculate implied red marbles for social evidence</span></span>
<span id="cb460-12"><a href="bayesian-models-of-cognition.html#cb460-12" tabindex="-1"></a>)</span>
<span id="cb460-13"><a href="bayesian-models-of-cognition.html#cb460-13" tabindex="-1"></a></span>
<span id="cb460-14"><a href="bayesian-models-of-cognition.html#cb460-14" tabindex="-1"></a><span class="co"># Process all scenarios to generate summary statistics</span></span>
<span id="cb460-15"><a href="bayesian-models-of-cognition.html#cb460-15" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(scenarios), <span class="cf">function</span>(i) {</span>
<span id="cb460-16"><a href="bayesian-models-of-cognition.html#cb460-16" tabindex="-1"></a>  <span class="co"># Extract scenario parameters</span></span>
<span id="cb460-17"><a href="bayesian-models-of-cognition.html#cb460-17" tabindex="-1"></a>  blue1 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>blue1[i]</span>
<span id="cb460-18"><a href="bayesian-models-of-cognition.html#cb460-18" tabindex="-1"></a>  red1 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>red1[i]</span>
<span id="cb460-19"><a href="bayesian-models-of-cognition.html#cb460-19" tabindex="-1"></a>  blue2 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>blue2[i]</span>
<span id="cb460-20"><a href="bayesian-models-of-cognition.html#cb460-20" tabindex="-1"></a>  red2 <span class="ot">&lt;-</span> scenarios<span class="sc">$</span>red2[i]</span>
<span id="cb460-21"><a href="bayesian-models-of-cognition.html#cb460-21" tabindex="-1"></a>  </span>
<span id="cb460-22"><a href="bayesian-models-of-cognition.html#cb460-22" tabindex="-1"></a>  <span class="co"># Calculate Bayesian integration using our model</span></span>
<span id="cb460-23"><a href="bayesian-models-of-cognition.html#cb460-23" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">betaBinomialModel</span>(<span class="dv">1</span>, <span class="dv">1</span>, blue1, total1, blue2, total2)</span>
<span id="cb460-24"><a href="bayesian-models-of-cognition.html#cb460-24" tabindex="-1"></a>  </span>
<span id="cb460-25"><a href="bayesian-models-of-cognition.html#cb460-25" tabindex="-1"></a>  <span class="co"># Return summary data for this scenario</span></span>
<span id="cb460-26"><a href="bayesian-models-of-cognition.html#cb460-26" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb460-27"><a href="bayesian-models-of-cognition.html#cb460-27" tabindex="-1"></a>    <span class="at">blue1 =</span> blue1,</span>
<span id="cb460-28"><a href="bayesian-models-of-cognition.html#cb460-28" tabindex="-1"></a>    <span class="at">red1 =</span> red1,</span>
<span id="cb460-29"><a href="bayesian-models-of-cognition.html#cb460-29" tabindex="-1"></a>    <span class="at">blue2 =</span> blue2,</span>
<span id="cb460-30"><a href="bayesian-models-of-cognition.html#cb460-30" tabindex="-1"></a>    <span class="at">red2 =</span> red2,</span>
<span id="cb460-31"><a href="bayesian-models-of-cognition.html#cb460-31" tabindex="-1"></a>    <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,</span>
<span id="cb460-32"><a href="bayesian-models-of-cognition.html#cb460-32" tabindex="-1"></a>    <span class="at">variance =</span> result<span class="sc">$</span>variance,</span>
<span id="cb460-33"><a href="bayesian-models-of-cognition.html#cb460-33" tabindex="-1"></a>    <span class="at">ci_lower =</span> result<span class="sc">$</span>ci_lower,</span>
<span id="cb460-34"><a href="bayesian-models-of-cognition.html#cb460-34" tabindex="-1"></a>    <span class="at">ci_upper =</span> result<span class="sc">$</span>ci_upper,</span>
<span id="cb460-35"><a href="bayesian-models-of-cognition.html#cb460-35" tabindex="-1"></a>    <span class="at">choice =</span> result<span class="sc">$</span>choice,</span>
<span id="cb460-36"><a href="bayesian-models-of-cognition.html#cb460-36" tabindex="-1"></a>    <span class="at">confidence =</span> result<span class="sc">$</span>confidence</span>
<span id="cb460-37"><a href="bayesian-models-of-cognition.html#cb460-37" tabindex="-1"></a>  )</span>
<span id="cb460-38"><a href="bayesian-models-of-cognition.html#cb460-38" tabindex="-1"></a>})</span>
<span id="cb460-39"><a href="bayesian-models-of-cognition.html#cb460-39" tabindex="-1"></a></span>
<span id="cb460-40"><a href="bayesian-models-of-cognition.html#cb460-40" tabindex="-1"></a><span class="co"># Convert social evidence to meaningful labels for better visualization</span></span>
<span id="cb460-41"><a href="bayesian-models-of-cognition.html#cb460-41" tabindex="-1"></a>sim_data<span class="sc">$</span>social_evidence <span class="ot">&lt;-</span> <span class="fu">factor</span>(sim_data<span class="sc">$</span>blue2,</span>
<span id="cb460-42"><a href="bayesian-models-of-cognition.html#cb460-42" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb460-43"><a href="bayesian-models-of-cognition.html#cb460-43" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Maybe Red&quot;</span>, <span class="st">&quot;Maybe Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>))</span></code></pre></div>
</div>
<div id="visualizing-bayesian-integration" class="section level3 hasAnchor" number="11.8.6">
<h3><span class="header-section-number">11.8.6</span> Visualizing Bayesian Integration<a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine how expected proportion and uncertainty vary across different evidence combinations:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="bayesian-models-of-cognition.html#cb461-1" tabindex="-1"></a><span class="co"># Create two plot panels to visualize model behavior across all evidence combinations</span></span>
<span id="cb461-2"><a href="bayesian-models-of-cognition.html#cb461-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sim_data, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> expected_rate, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb461-3"><a href="bayesian-models-of-cognition.html#cb461-3" tabindex="-1"></a>  <span class="co"># Add credible intervals to show uncertainty</span></span>
<span id="cb461-4"><a href="bayesian-models-of-cognition.html#cb461-4" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper, <span class="at">fill =</span> social_evidence), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb461-5"><a href="bayesian-models-of-cognition.html#cb461-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb461-6"><a href="bayesian-models-of-cognition.html#cb461-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb461-7"><a href="bayesian-models-of-cognition.html#cb461-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb461-8"><a href="bayesian-models-of-cognition.html#cb461-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb461-9"><a href="bayesian-models-of-cognition.html#cb461-9" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb461-10"><a href="bayesian-models-of-cognition.html#cb461-10" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb461-11"><a href="bayesian-models-of-cognition.html#cb461-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bayesian Integration of Direct and Social Evidence&quot;</span>,</span>
<span id="cb461-12"><a href="bayesian-models-of-cognition.html#cb461-12" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Expected proportion with 95% credible intervals&quot;</span>,</span>
<span id="cb461-13"><a href="bayesian-models-of-cognition.html#cb461-13" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Sample (out of 8)&quot;</span>,</span>
<span id="cb461-14"><a href="bayesian-models-of-cognition.html#cb461-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Expected Proportion of Blue Marbles&quot;</span>,</span>
<span id="cb461-15"><a href="bayesian-models-of-cognition.html#cb461-15" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span>,</span>
<span id="cb461-16"><a href="bayesian-models-of-cognition.html#cb461-16" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Social Evidence&quot;</span>) <span class="sc">+</span></span>
<span id="cb461-17"><a href="bayesian-models-of-cognition.html#cb461-17" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb461-18"><a href="bayesian-models-of-cognition.html#cb461-18" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb461-19"><a href="bayesian-models-of-cognition.html#cb461-19" tabindex="-1"></a></span>
<span id="cb461-20"><a href="bayesian-models-of-cognition.html#cb461-20" tabindex="-1"></a><span class="co"># Display plot</span></span>
<span id="cb461-21"><a href="bayesian-models-of-cognition.html#cb461-21" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/10%20visualizing%20bayesian%20integration-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>A few notes about the plot:</p>
<ul>
<li><p>Evidence integration: The expected proportion of blue marbles (top plot) varies with both direct and social evidence. I would normally expect a non-linear interaction: when direct evidence is ambiguous (e.g., 4 blue out of 8), social evidence should have a stronger effect on the final belief. However, the effect is subtle if any.</p></li>
<li><p>Evidence Interaction: It may be hard to see, but the influence of social evidence is strongest when direct evidence is ambiguous (around 4 blue marbles) and weakest at the extremes (0 or 8 blue marbles). This reflects the Bayesian property that stronger evidence dominates weaker evidence.</p></li>
<li><p>Credible intervals: The 95% credible intervals (shaded regions) show our uncertainty about the true proportion. These intervals narrow with more evidence, indicating increased confidence in our estimates. This is better seen in the lower plot than in the upper one. Notice how the variance is highest when direct evidence is ambiguous (around 4 blue marbles) and lowest at the extremes (as they combine congruent evidence from both sources).</p></li>
</ul>
</div>
</div>
<div id="examining-belief-distributions-for-selected-scenarios" class="section level2 hasAnchor" number="11.9">
<h2><span class="header-section-number">11.9</span> Examining Belief Distributions for Selected Scenarios<a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While the summary statistics give us a high-level view, examining the full posterior distributions provides deeper insight into how evidence is combined. Let’s visualize the complete probability distributions for a selected subset of scenarios:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="bayesian-models-of-cognition.html#cb462-1" tabindex="-1"></a><span class="co"># Function to generate Beta distributions for all components of a Bayesian model</span></span>
<span id="cb462-2"><a href="bayesian-models-of-cognition.html#cb462-2" tabindex="-1"></a><span class="co"># This function returns the prior, likelihood, and posterior distributions</span></span>
<span id="cb462-3"><a href="bayesian-models-of-cognition.html#cb462-3" tabindex="-1"></a><span class="co"># for a given scenario of blue and red marbles</span></span>
<span id="cb462-4"><a href="bayesian-models-of-cognition.html#cb462-4" tabindex="-1"></a>simpleBayesianModel_f <span class="ot">&lt;-</span> <span class="cf">function</span>(blue1, red1, blue2, red2) {</span>
<span id="cb462-5"><a href="bayesian-models-of-cognition.html#cb462-5" tabindex="-1"></a>  <span class="co"># Prior parameters (uniform prior)</span></span>
<span id="cb462-6"><a href="bayesian-models-of-cognition.html#cb462-6" tabindex="-1"></a>  alpha_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb462-7"><a href="bayesian-models-of-cognition.html#cb462-7" tabindex="-1"></a>  beta_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb462-8"><a href="bayesian-models-of-cognition.html#cb462-8" tabindex="-1"></a>  </span>
<span id="cb462-9"><a href="bayesian-models-of-cognition.html#cb462-9" tabindex="-1"></a>  <span class="co"># Calculate parameters for each distribution</span></span>
<span id="cb462-10"><a href="bayesian-models-of-cognition.html#cb462-10" tabindex="-1"></a>  <span class="co"># Direct evidence distribution</span></span>
<span id="cb462-11"><a href="bayesian-models-of-cognition.html#cb462-11" tabindex="-1"></a>  alpha_direct <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue1</span>
<span id="cb462-12"><a href="bayesian-models-of-cognition.html#cb462-12" tabindex="-1"></a>  beta_direct <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red1</span>
<span id="cb462-13"><a href="bayesian-models-of-cognition.html#cb462-13" tabindex="-1"></a>  </span>
<span id="cb462-14"><a href="bayesian-models-of-cognition.html#cb462-14" tabindex="-1"></a>  <span class="co"># Social evidence distribution</span></span>
<span id="cb462-15"><a href="bayesian-models-of-cognition.html#cb462-15" tabindex="-1"></a>  alpha_social <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue2</span>
<span id="cb462-16"><a href="bayesian-models-of-cognition.html#cb462-16" tabindex="-1"></a>  beta_social <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red2</span>
<span id="cb462-17"><a href="bayesian-models-of-cognition.html#cb462-17" tabindex="-1"></a>  </span>
<span id="cb462-18"><a href="bayesian-models-of-cognition.html#cb462-18" tabindex="-1"></a>  <span class="co"># Posterior distribution (combined evidence)</span></span>
<span id="cb462-19"><a href="bayesian-models-of-cognition.html#cb462-19" tabindex="-1"></a>  alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> blue1 <span class="sc">+</span> blue2</span>
<span id="cb462-20"><a href="bayesian-models-of-cognition.html#cb462-20" tabindex="-1"></a>  beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> red1 <span class="sc">+</span> red2</span>
<span id="cb462-21"><a href="bayesian-models-of-cognition.html#cb462-21" tabindex="-1"></a>  </span>
<span id="cb462-22"><a href="bayesian-models-of-cognition.html#cb462-22" tabindex="-1"></a>  <span class="co"># Create a grid of theta values (possible proportions of blue marbles)</span></span>
<span id="cb462-23"><a href="bayesian-models-of-cognition.html#cb462-23" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.999</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb462-24"><a href="bayesian-models-of-cognition.html#cb462-24" tabindex="-1"></a>  </span>
<span id="cb462-25"><a href="bayesian-models-of-cognition.html#cb462-25" tabindex="-1"></a>  <span class="co"># Calculate densities for each distribution</span></span>
<span id="cb462-26"><a href="bayesian-models-of-cognition.html#cb462-26" tabindex="-1"></a>  prior_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_prior, beta_prior)</span>
<span id="cb462-27"><a href="bayesian-models-of-cognition.html#cb462-27" tabindex="-1"></a>  direct_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_direct, beta_direct)</span>
<span id="cb462-28"><a href="bayesian-models-of-cognition.html#cb462-28" tabindex="-1"></a>  social_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_social, beta_social)</span>
<span id="cb462-29"><a href="bayesian-models-of-cognition.html#cb462-29" tabindex="-1"></a>  posterior_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, alpha_post, beta_post)</span>
<span id="cb462-30"><a href="bayesian-models-of-cognition.html#cb462-30" tabindex="-1"></a>  </span>
<span id="cb462-31"><a href="bayesian-models-of-cognition.html#cb462-31" tabindex="-1"></a>  <span class="co"># Return dataframe with all distributions</span></span>
<span id="cb462-32"><a href="bayesian-models-of-cognition.html#cb462-32" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb462-33"><a href="bayesian-models-of-cognition.html#cb462-33" tabindex="-1"></a>    <span class="at">theta =</span> theta,</span>
<span id="cb462-34"><a href="bayesian-models-of-cognition.html#cb462-34" tabindex="-1"></a>    <span class="at">prior =</span> prior_density,</span>
<span id="cb462-35"><a href="bayesian-models-of-cognition.html#cb462-35" tabindex="-1"></a>    <span class="at">direct =</span> direct_density,</span>
<span id="cb462-36"><a href="bayesian-models-of-cognition.html#cb462-36" tabindex="-1"></a>    <span class="at">social =</span> social_density,</span>
<span id="cb462-37"><a href="bayesian-models-of-cognition.html#cb462-37" tabindex="-1"></a>    <span class="at">posterior =</span> posterior_density</span>
<span id="cb462-38"><a href="bayesian-models-of-cognition.html#cb462-38" tabindex="-1"></a>  ))</span>
<span id="cb462-39"><a href="bayesian-models-of-cognition.html#cb462-39" tabindex="-1"></a>}</span>
<span id="cb462-40"><a href="bayesian-models-of-cognition.html#cb462-40" tabindex="-1"></a></span>
<span id="cb462-41"><a href="bayesian-models-of-cognition.html#cb462-41" tabindex="-1"></a><span class="co"># Select a few representative scenarios</span></span>
<span id="cb462-42"><a href="bayesian-models-of-cognition.html#cb462-42" tabindex="-1"></a>selected_scenarios <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb462-43"><a href="bayesian-models-of-cognition.html#cb462-43" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>),     <span class="co"># Different levels of direct evidence</span></span>
<span id="cb462-44"><a href="bayesian-models-of-cognition.html#cb462-44" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)   <span class="co"># Different levels of social evidence</span></span>
<span id="cb462-45"><a href="bayesian-models-of-cognition.html#cb462-45" tabindex="-1"></a>)</span>
<span id="cb462-46"><a href="bayesian-models-of-cognition.html#cb462-46" tabindex="-1"></a></span>
<span id="cb462-47"><a href="bayesian-models-of-cognition.html#cb462-47" tabindex="-1"></a><span class="co"># Generate distributions for each scenario</span></span>
<span id="cb462-48"><a href="bayesian-models-of-cognition.html#cb462-48" tabindex="-1"></a>distribution_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(selected_scenarios), <span class="cf">function</span>(i) {</span>
<span id="cb462-49"><a href="bayesian-models-of-cognition.html#cb462-49" tabindex="-1"></a>  blue1 <span class="ot">&lt;-</span> selected_scenarios<span class="sc">$</span>blue1[i]</span>
<span id="cb462-50"><a href="bayesian-models-of-cognition.html#cb462-50" tabindex="-1"></a>  blue2 <span class="ot">&lt;-</span> selected_scenarios<span class="sc">$</span>blue2[i]</span>
<span id="cb462-51"><a href="bayesian-models-of-cognition.html#cb462-51" tabindex="-1"></a>  </span>
<span id="cb462-52"><a href="bayesian-models-of-cognition.html#cb462-52" tabindex="-1"></a>  <span class="co"># Generate distributions</span></span>
<span id="cb462-53"><a href="bayesian-models-of-cognition.html#cb462-53" tabindex="-1"></a>  dist_df <span class="ot">&lt;-</span> <span class="fu">simpleBayesianModel_f</span>(blue1, total1 <span class="sc">-</span> blue1, blue2, total2 <span class="sc">-</span> blue2)</span>
<span id="cb462-54"><a href="bayesian-models-of-cognition.html#cb462-54" tabindex="-1"></a>  </span>
<span id="cb462-55"><a href="bayesian-models-of-cognition.html#cb462-55" tabindex="-1"></a>  <span class="co"># Add scenario information</span></span>
<span id="cb462-56"><a href="bayesian-models-of-cognition.html#cb462-56" tabindex="-1"></a>  dist_df<span class="sc">$</span>blue1 <span class="ot">&lt;-</span> blue1</span>
<span id="cb462-57"><a href="bayesian-models-of-cognition.html#cb462-57" tabindex="-1"></a>  dist_df<span class="sc">$</span>blue2 <span class="ot">&lt;-</span> blue2</span>
<span id="cb462-58"><a href="bayesian-models-of-cognition.html#cb462-58" tabindex="-1"></a>  dist_df<span class="sc">$</span>social_evidence <span class="ot">&lt;-</span> <span class="fu">factor</span>(blue2,</span>
<span id="cb462-59"><a href="bayesian-models-of-cognition.html#cb462-59" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb462-60"><a href="bayesian-models-of-cognition.html#cb462-60" tabindex="-1"></a>                                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Maybe Red&quot;</span>, <span class="st">&quot;Maybe Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>))</span>
<span id="cb462-61"><a href="bayesian-models-of-cognition.html#cb462-61" tabindex="-1"></a>  <span class="fu">return</span>(dist_df)</span>
<span id="cb462-62"><a href="bayesian-models-of-cognition.html#cb462-62" tabindex="-1"></a>}))</span>
<span id="cb462-63"><a href="bayesian-models-of-cognition.html#cb462-63" tabindex="-1"></a></span>
<span id="cb462-64"><a href="bayesian-models-of-cognition.html#cb462-64" tabindex="-1"></a><span class="co"># Modify the plotting function</span></span>
<span id="cb462-65"><a href="bayesian-models-of-cognition.html#cb462-65" tabindex="-1"></a>p_evidence_combination <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(distribution_data) <span class="sc">+</span></span>
<span id="cb462-66"><a href="bayesian-models-of-cognition.html#cb462-66" tabindex="-1"></a>  <span class="co"># Prior distribution with clear emphasis</span></span>
<span id="cb462-67"><a href="bayesian-models-of-cognition.html#cb462-67" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> prior), <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb462-68"><a href="bayesian-models-of-cognition.html#cb462-68" tabindex="-1"></a>  </span>
<span id="cb462-69"><a href="bayesian-models-of-cognition.html#cb462-69" tabindex="-1"></a>  <span class="co"># Posterior distribution with consistent coloring</span></span>
<span id="cb462-70"><a href="bayesian-models-of-cognition.html#cb462-70" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> posterior), </span>
<span id="cb462-71"><a href="bayesian-models-of-cognition.html#cb462-71" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>, </span>
<span id="cb462-72"><a href="bayesian-models-of-cognition.html#cb462-72" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb462-73"><a href="bayesian-models-of-cognition.html#cb462-73" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> posterior), </span>
<span id="cb462-74"><a href="bayesian-models-of-cognition.html#cb462-74" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, </span>
<span id="cb462-75"><a href="bayesian-models-of-cognition.html#cb462-75" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb462-76"><a href="bayesian-models-of-cognition.html#cb462-76" tabindex="-1"></a>  </span>
<span id="cb462-77"><a href="bayesian-models-of-cognition.html#cb462-77" tabindex="-1"></a>  <span class="co"># Direct and social evidence distributions</span></span>
<span id="cb462-78"><a href="bayesian-models-of-cognition.html#cb462-78" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> direct, <span class="at">color =</span> <span class="st">&quot;Direct Evidence&quot;</span>), </span>
<span id="cb462-79"><a href="bayesian-models-of-cognition.html#cb462-79" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb462-80"><a href="bayesian-models-of-cognition.html#cb462-80" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb462-81"><a href="bayesian-models-of-cognition.html#cb462-81" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb462-82"><a href="bayesian-models-of-cognition.html#cb462-82" tabindex="-1"></a>  </span>
<span id="cb462-83"><a href="bayesian-models-of-cognition.html#cb462-83" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> social, <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span>), </span>
<span id="cb462-84"><a href="bayesian-models-of-cognition.html#cb462-84" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb462-85"><a href="bayesian-models-of-cognition.html#cb462-85" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb462-86"><a href="bayesian-models-of-cognition.html#cb462-86" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb462-87"><a href="bayesian-models-of-cognition.html#cb462-87" tabindex="-1"></a>  </span>
<span id="cb462-88"><a href="bayesian-models-of-cognition.html#cb462-88" tabindex="-1"></a>  <span class="co"># Facet by direct and social evidence levels</span></span>
<span id="cb462-89"><a href="bayesian-models-of-cognition.html#cb462-89" tabindex="-1"></a>  <span class="fu">facet_grid</span>(blue2 <span class="sc">~</span> blue1, </span>
<span id="cb462-90"><a href="bayesian-models-of-cognition.html#cb462-90" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb462-91"><a href="bayesian-models-of-cognition.html#cb462-91" tabindex="-1"></a>               <span class="at">blue1 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Direct: &quot;</span>, x, <span class="st">&quot; Blue&quot;</span>),</span>
<span id="cb462-92"><a href="bayesian-models-of-cognition.html#cb462-92" tabindex="-1"></a>               <span class="at">blue2 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Social: &quot;</span>, x, <span class="st">&quot; Blue&quot;</span>)</span>
<span id="cb462-93"><a href="bayesian-models-of-cognition.html#cb462-93" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb462-94"><a href="bayesian-models-of-cognition.html#cb462-94" tabindex="-1"></a>  </span>
<span id="cb462-95"><a href="bayesian-models-of-cognition.html#cb462-95" tabindex="-1"></a>  <span class="co"># Aesthetics</span></span>
<span id="cb462-96"><a href="bayesian-models-of-cognition.html#cb462-96" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb462-97"><a href="bayesian-models-of-cognition.html#cb462-97" tabindex="-1"></a>    <span class="st">&quot;Direct Evidence&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb462-98"><a href="bayesian-models-of-cognition.html#cb462-98" tabindex="-1"></a>    <span class="st">&quot;Social Evidence&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb462-99"><a href="bayesian-models-of-cognition.html#cb462-99" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb462-100"><a href="bayesian-models-of-cognition.html#cb462-100" tabindex="-1"></a>  </span>
<span id="cb462-101"><a href="bayesian-models-of-cognition.html#cb462-101" tabindex="-1"></a>  <span class="co"># Labels and theme</span></span>
<span id="cb462-102"><a href="bayesian-models-of-cognition.html#cb462-102" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb462-103"><a href="bayesian-models-of-cognition.html#cb462-103" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Bayesian Evidence Integration: Distribution Combination&quot;</span>,</span>
<span id="cb462-104"><a href="bayesian-models-of-cognition.html#cb462-104" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Merging direct and social evidence into a posterior belief&quot;</span>,</span>
<span id="cb462-105"><a href="bayesian-models-of-cognition.html#cb462-105" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Proportion of Blue Marbles&quot;</span>,</span>
<span id="cb462-106"><a href="bayesian-models-of-cognition.html#cb462-106" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Probability Density&quot;</span>,</span>
<span id="cb462-107"><a href="bayesian-models-of-cognition.html#cb462-107" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Evidence Type&quot;</span></span>
<span id="cb462-108"><a href="bayesian-models-of-cognition.html#cb462-108" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb462-109"><a href="bayesian-models-of-cognition.html#cb462-109" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb462-110"><a href="bayesian-models-of-cognition.html#cb462-110" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb462-111"><a href="bayesian-models-of-cognition.html#cb462-111" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb462-112"><a href="bayesian-models-of-cognition.html#cb462-112" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb462-113"><a href="bayesian-models-of-cognition.html#cb462-113" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb462-114"><a href="bayesian-models-of-cognition.html#cb462-114" tabindex="-1"></a>  )</span>
<span id="cb462-115"><a href="bayesian-models-of-cognition.html#cb462-115" tabindex="-1"></a></span>
<span id="cb462-116"><a href="bayesian-models-of-cognition.html#cb462-116" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb462-117"><a href="bayesian-models-of-cognition.html#cb462-117" tabindex="-1"></a><span class="fu">print</span>(p_evidence_combination)</span></code></pre></div>
<p><img src="series_files/figure-html/10%20zoom%20in%20specific%20scenarios-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This comprehensive visualization shows how the different probability distributions interact:</p>
<ul>
<li><p>Prior distribution (gray line): Our initial uniform belief about the proportion of blue marbles.</p></li>
<li><p>Direct evidence distribution (blue dashed line): Belief based solely on our direct observation of marbles. Notice how it becomes more concentrated with more extreme evidence (e.g., 1 or 7 blue marbles).</p></li>
<li><p>Social evidence distribution (red dashed line): Belief based solely on social information. This is generally less concentrated than the direct evidence distribution since it’s based on lower evidence (0-3 vs. 0-8).</p></li>
<li><p>Posterior distribution (purple area): The final belief that results from combining all information sources. Notice how it tends to lie between the direct and social evidence distributions, but is typically narrower than either, reflecting increased certainty from combining information, unless the evidence is in conflict.</p></li>
</ul>
</div>
<div id="weighted-bayesian-integration" class="section level2 hasAnchor" number="11.10">
<h2><span class="header-section-number">11.10</span> Weighted Bayesian Integration<a href="bayesian-models-of-cognition.html#weighted-bayesian-integration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In real cognitive systems, people often weight information sources differently based on their reliability or relevance. Let’s implement a weighted Bayesian model that allows for differential weighting of evidence sources.</p>
<div id="the-mathematical-model-1" class="section level3 hasAnchor" number="11.10.1">
<h3><span class="header-section-number">11.10.1</span> The Mathematical Model<a href="bayesian-models-of-cognition.html#the-mathematical-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our weighted Bayesian integration model extends the simple model by introducing weight parameters for each information source:</p>
<ul>
<li><p>Start with prior: Beta(α₀, β₀)</p></li>
<li><p>Observe direct evidence: k₁ blue marbles out of n₁ total</p></li>
<li><p>Observe social evidence: k₂ blue marbles out of n₂ total</p></li>
<li><p>Apply weights: w₁ for direct evidence, w₂ for social evidence</p></li>
<li><p>Posterior: Beta(α₀ + w₁·k₁ + w₂·k₂, β₀ + w₁·(n₁-k₁) + w₂·(n₂-k₂))</p></li>
</ul>
<p>The weights represent the degree to which each information source influences the final belief. A weight of 2.0 means you treat that evidence as if you had observed twice as many marbles as you actually did (as more reliable than what the current evidence would warrant), while a weight of 0.5 means you treat it as half as informative. From a cognitive perspective, they might reflect judgments about reliability, relevance, or attentional focus.</p>
</div>
<div id="implementation" class="section level3 hasAnchor" number="11.10.2">
<h3><span class="header-section-number">11.10.2</span> Implementation<a href="bayesian-models-of-cognition.html#implementation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="bayesian-models-of-cognition.html#cb463-1" tabindex="-1"></a><span class="co"># Weighted Beta-Binomial model for evidence integration</span></span>
<span id="cb463-2"><a href="bayesian-models-of-cognition.html#cb463-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb463-3"><a href="bayesian-models-of-cognition.html#cb463-3" tabindex="-1"></a><span class="co"># This function extends our basic model by allowing different weights for each</span></span>
<span id="cb463-4"><a href="bayesian-models-of-cognition.html#cb463-4" tabindex="-1"></a><span class="co"># evidence source. This can represent differences in perceived reliability,</span></span>
<span id="cb463-5"><a href="bayesian-models-of-cognition.html#cb463-5" tabindex="-1"></a><span class="co"># attention, or individual cognitive tendencies.</span></span>
<span id="cb463-6"><a href="bayesian-models-of-cognition.html#cb463-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb463-7"><a href="bayesian-models-of-cognition.html#cb463-7" tabindex="-1"></a><span class="co"># Parameters:</span></span>
<span id="cb463-8"><a href="bayesian-models-of-cognition.html#cb463-8" tabindex="-1"></a><span class="co">#   alpha_prior, beta_prior: Prior parameters (typically 1,1 for uniform prior)</span></span>
<span id="cb463-9"><a href="bayesian-models-of-cognition.html#cb463-9" tabindex="-1"></a><span class="co">#   blue1, total1: Direct evidence (blue marbles and total)</span></span>
<span id="cb463-10"><a href="bayesian-models-of-cognition.html#cb463-10" tabindex="-1"></a><span class="co">#   blue2, total2: Social evidence (blue signals and total)</span></span>
<span id="cb463-11"><a href="bayesian-models-of-cognition.html#cb463-11" tabindex="-1"></a><span class="co">#   weight_direct, weight_social: Relative weights for each evidence source</span></span>
<span id="cb463-12"><a href="bayesian-models-of-cognition.html#cb463-12" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb463-13"><a href="bayesian-models-of-cognition.html#cb463-13" tabindex="-1"></a><span class="co"># Returns:</span></span>
<span id="cb463-14"><a href="bayesian-models-of-cognition.html#cb463-14" tabindex="-1"></a><span class="co">#   List with model results and statistics</span></span>
<span id="cb463-15"><a href="bayesian-models-of-cognition.html#cb463-15" tabindex="-1"></a>weightedBetaBinomial <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha_prior, beta_prior, </span>
<span id="cb463-16"><a href="bayesian-models-of-cognition.html#cb463-16" tabindex="-1"></a>                                blue1, total1, </span>
<span id="cb463-17"><a href="bayesian-models-of-cognition.html#cb463-17" tabindex="-1"></a>                                blue2, total2,</span>
<span id="cb463-18"><a href="bayesian-models-of-cognition.html#cb463-18" tabindex="-1"></a>                                weight_direct, weight_social) {</span>
<span id="cb463-19"><a href="bayesian-models-of-cognition.html#cb463-19" tabindex="-1"></a>  </span>
<span id="cb463-20"><a href="bayesian-models-of-cognition.html#cb463-20" tabindex="-1"></a>  <span class="co"># Calculate red marbles for each source</span></span>
<span id="cb463-21"><a href="bayesian-models-of-cognition.html#cb463-21" tabindex="-1"></a>  red1 <span class="ot">&lt;-</span> total1 <span class="sc">-</span> blue1   <span class="co"># Number of red marbles in direct evidence</span></span>
<span id="cb463-22"><a href="bayesian-models-of-cognition.html#cb463-22" tabindex="-1"></a>  red2 <span class="ot">&lt;-</span> total2 <span class="sc">-</span> blue2   <span class="co"># Number of red signals in social evidence</span></span>
<span id="cb463-23"><a href="bayesian-models-of-cognition.html#cb463-23" tabindex="-1"></a>  </span>
<span id="cb463-24"><a href="bayesian-models-of-cognition.html#cb463-24" tabindex="-1"></a>  <span class="co"># Apply weights to evidence (this is the key step)</span></span>
<span id="cb463-25"><a href="bayesian-models-of-cognition.html#cb463-25" tabindex="-1"></a>  <span class="co"># Weighting effectively scales the &quot;sample size&quot; of each information source</span></span>
<span id="cb463-26"><a href="bayesian-models-of-cognition.html#cb463-26" tabindex="-1"></a>  weighted_blue1 <span class="ot">&lt;-</span> blue1 <span class="sc">*</span> weight_direct    <span class="co"># Weighted blue count from direct evidence</span></span>
<span id="cb463-27"><a href="bayesian-models-of-cognition.html#cb463-27" tabindex="-1"></a>  weighted_red1 <span class="ot">&lt;-</span> red1 <span class="sc">*</span> weight_direct      <span class="co"># Weighted red count from direct evidence</span></span>
<span id="cb463-28"><a href="bayesian-models-of-cognition.html#cb463-28" tabindex="-1"></a>  weighted_blue2 <span class="ot">&lt;-</span> blue2 <span class="sc">*</span> weight_social    <span class="co"># Weighted blue count from social evidence</span></span>
<span id="cb463-29"><a href="bayesian-models-of-cognition.html#cb463-29" tabindex="-1"></a>  weighted_red2 <span class="ot">&lt;-</span> red2 <span class="sc">*</span> weight_social      <span class="co"># Weighted red count from social evidence</span></span>
<span id="cb463-30"><a href="bayesian-models-of-cognition.html#cb463-30" tabindex="-1"></a>  </span>
<span id="cb463-31"><a href="bayesian-models-of-cognition.html#cb463-31" tabindex="-1"></a>  <span class="co"># Calculate posterior parameters by adding weighted evidence</span></span>
<span id="cb463-32"><a href="bayesian-models-of-cognition.html#cb463-32" tabindex="-1"></a>  alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> weighted_blue1 <span class="sc">+</span> weighted_blue2  <span class="co"># Posterior alpha parameter</span></span>
<span id="cb463-33"><a href="bayesian-models-of-cognition.html#cb463-33" tabindex="-1"></a>  beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> weighted_red1 <span class="sc">+</span> weighted_red2      <span class="co"># Posterior beta parameter</span></span>
<span id="cb463-34"><a href="bayesian-models-of-cognition.html#cb463-34" tabindex="-1"></a>  </span>
<span id="cb463-35"><a href="bayesian-models-of-cognition.html#cb463-35" tabindex="-1"></a>  <span class="co"># Calculate statistics from posterior beta distribution</span></span>
<span id="cb463-36"><a href="bayesian-models-of-cognition.html#cb463-36" tabindex="-1"></a>  expected_rate <span class="ot">&lt;-</span> alpha_post <span class="sc">/</span> (alpha_post <span class="sc">+</span> beta_post)   <span class="co"># Mean of beta distribution</span></span>
<span id="cb463-37"><a href="bayesian-models-of-cognition.html#cb463-37" tabindex="-1"></a>  </span>
<span id="cb463-38"><a href="bayesian-models-of-cognition.html#cb463-38" tabindex="-1"></a>  <span class="co"># Calculate variance (lower variance = higher confidence)</span></span>
<span id="cb463-39"><a href="bayesian-models-of-cognition.html#cb463-39" tabindex="-1"></a>  variance <span class="ot">&lt;-</span> (alpha_post <span class="sc">*</span> beta_post) <span class="sc">/</span> </span>
<span id="cb463-40"><a href="bayesian-models-of-cognition.html#cb463-40" tabindex="-1"></a>              ((alpha_post <span class="sc">+</span> beta_post)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (alpha_post <span class="sc">+</span> beta_post <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb463-41"><a href="bayesian-models-of-cognition.html#cb463-41" tabindex="-1"></a>  </span>
<span id="cb463-42"><a href="bayesian-models-of-cognition.html#cb463-42" tabindex="-1"></a>  <span class="co"># Calculate 95% credible interval</span></span>
<span id="cb463-43"><a href="bayesian-models-of-cognition.html#cb463-43" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.025</span>, alpha_post, beta_post)</span>
<span id="cb463-44"><a href="bayesian-models-of-cognition.html#cb463-44" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.975</span>, alpha_post, beta_post)</span>
<span id="cb463-45"><a href="bayesian-models-of-cognition.html#cb463-45" tabindex="-1"></a>  </span>
<span id="cb463-46"><a href="bayesian-models-of-cognition.html#cb463-46" tabindex="-1"></a>  <span class="co"># Calculate decision and confidence</span></span>
<span id="cb463-47"><a href="bayesian-models-of-cognition.html#cb463-47" tabindex="-1"></a>  decision <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, expected_rate) <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Blue&quot;</span>, <span class="st">&quot;Red&quot;</span>)   <span class="co"># Decision based on most likely color</span></span>
<span id="cb463-48"><a href="bayesian-models-of-cognition.html#cb463-48" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(variance))                  <span class="co"># Confidence based on certainty</span></span>
<span id="cb463-49"><a href="bayesian-models-of-cognition.html#cb463-49" tabindex="-1"></a>  confidence <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, <span class="fu">min</span>(<span class="dv">1</span>, confidence))                <span class="co"># Bound between 0 and 1</span></span>
<span id="cb463-50"><a href="bayesian-models-of-cognition.html#cb463-50" tabindex="-1"></a>  </span>
<span id="cb463-51"><a href="bayesian-models-of-cognition.html#cb463-51" tabindex="-1"></a>  <span class="co"># Return all calculated parameters in a structured list</span></span>
<span id="cb463-52"><a href="bayesian-models-of-cognition.html#cb463-52" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb463-53"><a href="bayesian-models-of-cognition.html#cb463-53" tabindex="-1"></a>    <span class="at">alpha_post =</span> alpha_post,</span>
<span id="cb463-54"><a href="bayesian-models-of-cognition.html#cb463-54" tabindex="-1"></a>    <span class="at">beta_post =</span> beta_post,</span>
<span id="cb463-55"><a href="bayesian-models-of-cognition.html#cb463-55" tabindex="-1"></a>    <span class="at">expected_rate =</span> expected_rate,</span>
<span id="cb463-56"><a href="bayesian-models-of-cognition.html#cb463-56" tabindex="-1"></a>    <span class="at">variance =</span> variance,</span>
<span id="cb463-57"><a href="bayesian-models-of-cognition.html#cb463-57" tabindex="-1"></a>    <span class="at">ci_lower =</span> ci_lower,</span>
<span id="cb463-58"><a href="bayesian-models-of-cognition.html#cb463-58" tabindex="-1"></a>    <span class="at">ci_upper =</span> ci_upper,</span>
<span id="cb463-59"><a href="bayesian-models-of-cognition.html#cb463-59" tabindex="-1"></a>    <span class="at">decision =</span> decision,</span>
<span id="cb463-60"><a href="bayesian-models-of-cognition.html#cb463-60" tabindex="-1"></a>    <span class="at">confidence =</span> confidence</span>
<span id="cb463-61"><a href="bayesian-models-of-cognition.html#cb463-61" tabindex="-1"></a>  ))</span>
<span id="cb463-62"><a href="bayesian-models-of-cognition.html#cb463-62" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="visualizing-weighted-bayesian-integration" class="section level3 hasAnchor" number="11.10.3">
<h3><span class="header-section-number">11.10.3</span> Visualizing Weighted Bayesian Integration<a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s create a comprehensive visualization showing how different weights affect belief formation:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="bayesian-models-of-cognition.html#cb464-1" tabindex="-1"></a><span class="co"># Create improved visualization using small multiples</span></span>
<span id="cb464-2"><a href="bayesian-models-of-cognition.html#cb464-2" tabindex="-1"></a>weighted_belief_plot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb464-3"><a href="bayesian-models-of-cognition.html#cb464-3" tabindex="-1"></a>  <span class="co"># Define grid of parameters to visualize</span></span>
<span id="cb464-4"><a href="bayesian-models-of-cognition.html#cb464-4" tabindex="-1"></a>  w1_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)  <span class="co"># Weight for source 1</span></span>
<span id="cb464-5"><a href="bayesian-models-of-cognition.html#cb464-5" tabindex="-1"></a>  w2_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)  <span class="co"># Weight for source 2</span></span>
<span id="cb464-6"><a href="bayesian-models-of-cognition.html#cb464-6" tabindex="-1"></a>  source1_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="dv">1</span>)  <span class="co"># Source 1 values</span></span>
<span id="cb464-7"><a href="bayesian-models-of-cognition.html#cb464-7" tabindex="-1"></a>  source2_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="dv">1</span>)  <span class="co"># Source 2 values </span></span>
<span id="cb464-8"><a href="bayesian-models-of-cognition.html#cb464-8" tabindex="-1"></a>  </span>
<span id="cb464-9"><a href="bayesian-models-of-cognition.html#cb464-9" tabindex="-1"></a>  <span class="co"># Generate data</span></span>
<span id="cb464-10"><a href="bayesian-models-of-cognition.html#cb464-10" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb464-11"><a href="bayesian-models-of-cognition.html#cb464-11" tabindex="-1"></a>    <span class="at">w1 =</span> w1_values,</span>
<span id="cb464-12"><a href="bayesian-models-of-cognition.html#cb464-12" tabindex="-1"></a>    <span class="at">w2 =</span> w2_values,</span>
<span id="cb464-13"><a href="bayesian-models-of-cognition.html#cb464-13" tabindex="-1"></a>    <span class="at">Source1 =</span> source1_values,</span>
<span id="cb464-14"><a href="bayesian-models-of-cognition.html#cb464-14" tabindex="-1"></a>    <span class="at">Source2 =</span> source2_values</span>
<span id="cb464-15"><a href="bayesian-models-of-cognition.html#cb464-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb464-16"><a href="bayesian-models-of-cognition.html#cb464-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb464-17"><a href="bayesian-models-of-cognition.html#cb464-17" tabindex="-1"></a>    <span class="at">belief =</span> <span class="fu">pmap_dbl</span>(<span class="fu">list</span>(w1, w2, Source1, Source2), <span class="cf">function</span>(w1, w2, s1, s2) {</span>
<span id="cb464-18"><a href="bayesian-models-of-cognition.html#cb464-18" tabindex="-1"></a>      </span>
<span id="cb464-19"><a href="bayesian-models-of-cognition.html#cb464-19" tabindex="-1"></a>      <span class="co"># Calculate Beta parameters</span></span>
<span id="cb464-20"><a href="bayesian-models-of-cognition.html#cb464-20" tabindex="-1"></a>      alpha_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb464-21"><a href="bayesian-models-of-cognition.html#cb464-21" tabindex="-1"></a>      beta_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb464-22"><a href="bayesian-models-of-cognition.html#cb464-22" tabindex="-1"></a>      alpha_post <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> w1 <span class="sc">*</span> s1 <span class="sc">+</span> w2 <span class="sc">*</span> s2</span>
<span id="cb464-23"><a href="bayesian-models-of-cognition.html#cb464-23" tabindex="-1"></a>      beta_post <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> w1 <span class="sc">*</span> (<span class="dv">8</span> <span class="sc">-</span> s1) <span class="sc">+</span> w2<span class="sc">*</span>(<span class="dv">3</span> <span class="sc">-</span> s2)</span>
<span id="cb464-24"><a href="bayesian-models-of-cognition.html#cb464-24" tabindex="-1"></a>      </span>
<span id="cb464-25"><a href="bayesian-models-of-cognition.html#cb464-25" tabindex="-1"></a>      <span class="co"># Return expected value</span></span>
<span id="cb464-26"><a href="bayesian-models-of-cognition.html#cb464-26" tabindex="-1"></a>      alpha_post <span class="sc">/</span> (alpha_post <span class="sc">+</span> beta_post)</span>
<span id="cb464-27"><a href="bayesian-models-of-cognition.html#cb464-27" tabindex="-1"></a>    })</span>
<span id="cb464-28"><a href="bayesian-models-of-cognition.html#cb464-28" tabindex="-1"></a>  )</span>
<span id="cb464-29"><a href="bayesian-models-of-cognition.html#cb464-29" tabindex="-1"></a>  </span>
<span id="cb464-30"><a href="bayesian-models-of-cognition.html#cb464-30" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb464-31"><a href="bayesian-models-of-cognition.html#cb464-31" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Source1, <span class="at">y =</span> belief, <span class="at">color =</span> Source2, <span class="at">group =</span> Source2)) <span class="sc">+</span></span>
<span id="cb464-32"><a href="bayesian-models-of-cognition.html#cb464-32" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb464-33"><a href="bayesian-models-of-cognition.html#cb464-33" tabindex="-1"></a>    <span class="fu">facet_grid</span>(w1 <span class="sc">~</span> w2, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb464-34"><a href="bayesian-models-of-cognition.html#cb464-34" tabindex="-1"></a>      <span class="at">w1 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;w1 =&quot;</span>, x),</span>
<span id="cb464-35"><a href="bayesian-models-of-cognition.html#cb464-35" tabindex="-1"></a>      <span class="at">w2 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;w2 =&quot;</span>, x)</span>
<span id="cb464-36"><a href="bayesian-models-of-cognition.html#cb464-36" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb464-37"><a href="bayesian-models-of-cognition.html#cb464-37" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-38"><a href="bayesian-models-of-cognition.html#cb464-38" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb464-39"><a href="bayesian-models-of-cognition.html#cb464-39" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Weighted Bayesian Integration of Two Evidence Sources&quot;</span>,</span>
<span id="cb464-40"><a href="bayesian-models-of-cognition.html#cb464-40" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;Direct Evidence (Blue Marbles)&quot;</span>,</span>
<span id="cb464-41"><a href="bayesian-models-of-cognition.html#cb464-41" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;Belief in the next pick being a blue marble&quot;</span>,</span>
<span id="cb464-42"><a href="bayesian-models-of-cognition.html#cb464-42" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;Social Evidence (Blue Marbles)&quot;</span></span>
<span id="cb464-43"><a href="bayesian-models-of-cognition.html#cb464-43" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb464-44"><a href="bayesian-models-of-cognition.html#cb464-44" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb464-45"><a href="bayesian-models-of-cognition.html#cb464-45" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb464-46"><a href="bayesian-models-of-cognition.html#cb464-46" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;gray90&quot;</span>),</span>
<span id="cb464-47"><a href="bayesian-models-of-cognition.html#cb464-47" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb464-48"><a href="bayesian-models-of-cognition.html#cb464-48" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb464-49"><a href="bayesian-models-of-cognition.html#cb464-49" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>)</span>
<span id="cb464-50"><a href="bayesian-models-of-cognition.html#cb464-50" tabindex="-1"></a>    )</span>
<span id="cb464-51"><a href="bayesian-models-of-cognition.html#cb464-51" tabindex="-1"></a>  </span>
<span id="cb464-52"><a href="bayesian-models-of-cognition.html#cb464-52" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb464-53"><a href="bayesian-models-of-cognition.html#cb464-53" tabindex="-1"></a>}</span>
<span id="cb464-54"><a href="bayesian-models-of-cognition.html#cb464-54" tabindex="-1"></a></span>
<span id="cb464-55"><a href="bayesian-models-of-cognition.html#cb464-55" tabindex="-1"></a><span class="co"># Generate and display the plot</span></span>
<span id="cb464-56"><a href="bayesian-models-of-cognition.html#cb464-56" tabindex="-1"></a><span class="fu">weighted_belief_plot</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/10%20visualizing%20weighted%20bayes-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The visualization showcases weighted Bayesian integration:</p>
<ul>
<li><p>First, when both weights (w1 and w2) are low (top left panels), beliefs remain moderate regardless of the evidence values, representing high uncertainty. As weights increase (moving right and down), beliefs become more extreme, showing increased confidence in the integrated evidence.</p></li>
<li><p>Second, the slope of the lines indicates the relative influence of each source. Steeper slopes (bottom right panels) demonstrate that Source1 has stronger influence on belief when both weights are high, while the spacing between lines shows the impact of Source2.</p></li>
<li><p>Third, when weights are asymmetric (e.g., high w1 and low w2), the belief is dominated by the source with the higher weight, essentially ignoring evidence from the other source. This illustrates how selective attention to certain evidence sources can be modeled as differential weighting in a Bayesian framework.</p></li>
</ul>
</div>
<div id="resolving-conflicting-evidence" class="section level3 hasAnchor" number="11.10.4">
<h3><span class="header-section-number">11.10.4</span> Resolving Conflicting Evidence<a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To further understand how weighted Bayesian integration resolves conflicts between evidence sources, let’s examine two specific conflict scenarios:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="bayesian-models-of-cognition.html#cb465-1" tabindex="-1"></a><span class="co"># Define conflict scenarios</span></span>
<span id="cb465-2"><a href="bayesian-models-of-cognition.html#cb465-2" tabindex="-1"></a>scenario1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">blue1 =</span> <span class="dv">7</span>, <span class="at">total1 =</span> <span class="dv">8</span>, <span class="at">blue2 =</span> <span class="dv">0</span>, <span class="at">total2 =</span> <span class="dv">3</span>)  <span class="co"># Direct: blue, Social: red</span></span>
<span id="cb465-3"><a href="bayesian-models-of-cognition.html#cb465-3" tabindex="-1"></a>scenario2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">blue1 =</span> <span class="dv">5</span>, <span class="at">total1 =</span> <span class="dv">8</span>, <span class="at">blue2 =</span> <span class="dv">0</span>, <span class="at">total2 =</span> <span class="dv">3</span>)  <span class="co"># Direct: red, Social: blue</span></span>
<span id="cb465-4"><a href="bayesian-models-of-cognition.html#cb465-4" tabindex="-1"></a></span>
<span id="cb465-5"><a href="bayesian-models-of-cognition.html#cb465-5" tabindex="-1"></a><span class="co"># Create function to evaluate scenarios across weight combinations</span></span>
<span id="cb465-6"><a href="bayesian-models-of-cognition.html#cb465-6" tabindex="-1"></a>evaluate_conflict <span class="ot">&lt;-</span> <span class="cf">function</span>(scenario) {</span>
<span id="cb465-7"><a href="bayesian-models-of-cognition.html#cb465-7" tabindex="-1"></a>  weight_grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb465-8"><a href="bayesian-models-of-cognition.html#cb465-8" tabindex="-1"></a>    <span class="at">weight_direct =</span>  <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb465-9"><a href="bayesian-models-of-cognition.html#cb465-9" tabindex="-1"></a>    <span class="at">weight_social =</span>  <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb465-10"><a href="bayesian-models-of-cognition.html#cb465-10" tabindex="-1"></a>  )</span>
<span id="cb465-11"><a href="bayesian-models-of-cognition.html#cb465-11" tabindex="-1"></a>  </span>
<span id="cb465-12"><a href="bayesian-models-of-cognition.html#cb465-12" tabindex="-1"></a>  <span class="co"># Calculate results for each weight combination</span></span>
<span id="cb465-13"><a href="bayesian-models-of-cognition.html#cb465-13" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(weight_grid, <span class="cf">function</span>(weight_direct, weight_social) {</span>
<span id="cb465-14"><a href="bayesian-models-of-cognition.html#cb465-14" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">weightedBetaBinomial</span>(</span>
<span id="cb465-15"><a href="bayesian-models-of-cognition.html#cb465-15" tabindex="-1"></a>      <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb465-16"><a href="bayesian-models-of-cognition.html#cb465-16" tabindex="-1"></a>      scenario<span class="sc">$</span>blue1, scenario<span class="sc">$</span>total1, </span>
<span id="cb465-17"><a href="bayesian-models-of-cognition.html#cb465-17" tabindex="-1"></a>      scenario<span class="sc">$</span>blue2, scenario<span class="sc">$</span>total2, </span>
<span id="cb465-18"><a href="bayesian-models-of-cognition.html#cb465-18" tabindex="-1"></a>      weight_direct, weight_social</span>
<span id="cb465-19"><a href="bayesian-models-of-cognition.html#cb465-19" tabindex="-1"></a>    )</span>
<span id="cb465-20"><a href="bayesian-models-of-cognition.html#cb465-20" tabindex="-1"></a>    </span>
<span id="cb465-21"><a href="bayesian-models-of-cognition.html#cb465-21" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb465-22"><a href="bayesian-models-of-cognition.html#cb465-22" tabindex="-1"></a>      <span class="at">weight_direct =</span> weight_direct,</span>
<span id="cb465-23"><a href="bayesian-models-of-cognition.html#cb465-23" tabindex="-1"></a>      <span class="at">weight_social =</span> weight_social,</span>
<span id="cb465-24"><a href="bayesian-models-of-cognition.html#cb465-24" tabindex="-1"></a>      <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,</span>
<span id="cb465-25"><a href="bayesian-models-of-cognition.html#cb465-25" tabindex="-1"></a>      <span class="at">decision =</span> result<span class="sc">$</span>decision</span>
<span id="cb465-26"><a href="bayesian-models-of-cognition.html#cb465-26" tabindex="-1"></a>    )</span>
<span id="cb465-27"><a href="bayesian-models-of-cognition.html#cb465-27" tabindex="-1"></a>  })</span>
<span id="cb465-28"><a href="bayesian-models-of-cognition.html#cb465-28" tabindex="-1"></a>  </span>
<span id="cb465-29"><a href="bayesian-models-of-cognition.html#cb465-29" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb465-30"><a href="bayesian-models-of-cognition.html#cb465-30" tabindex="-1"></a>}</span>
<span id="cb465-31"><a href="bayesian-models-of-cognition.html#cb465-31" tabindex="-1"></a></span>
<span id="cb465-32"><a href="bayesian-models-of-cognition.html#cb465-32" tabindex="-1"></a><span class="co"># Calculate results</span></span>
<span id="cb465-33"><a href="bayesian-models-of-cognition.html#cb465-33" tabindex="-1"></a>conflict1_results <span class="ot">&lt;-</span> <span class="fu">evaluate_conflict</span>(scenario1)</span>
<span id="cb465-34"><a href="bayesian-models-of-cognition.html#cb465-34" tabindex="-1"></a>conflict2_results <span class="ot">&lt;-</span> <span class="fu">evaluate_conflict</span>(scenario2)</span>
<span id="cb465-35"><a href="bayesian-models-of-cognition.html#cb465-35" tabindex="-1"></a></span>
<span id="cb465-36"><a href="bayesian-models-of-cognition.html#cb465-36" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb465-37"><a href="bayesian-models-of-cognition.html#cb465-37" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(conflict1_results, <span class="fu">aes</span>(<span class="at">x =</span> weight_direct, <span class="at">y =</span> weight_social)) <span class="sc">+</span></span>
<span id="cb465-38"><a href="bayesian-models-of-cognition.html#cb465-38" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> expected_rate)) <span class="sc">+</span></span>
<span id="cb465-39"><a href="bayesian-models-of-cognition.html#cb465-39" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> expected_rate), <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb465-40"><a href="bayesian-models-of-cognition.html#cb465-40" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb465-41"><a href="bayesian-models-of-cognition.html#cb465-41" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb465-42"><a href="bayesian-models-of-cognition.html#cb465-42" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb465-43"><a href="bayesian-models-of-cognition.html#cb465-43" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-44"><a href="bayesian-models-of-cognition.html#cb465-44" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb465-45"><a href="bayesian-models-of-cognition.html#cb465-45" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scenario 1: Strong Direct Evidence for Blue (7 out of 8) </span><span class="sc">\n</span><span class="st">vs. Strong Social Evidence for Red (0/3)&quot;</span>,</span>
<span id="cb465-46"><a href="bayesian-models-of-cognition.html#cb465-46" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Black line shows decision boundary (expected rate = 0.5)&quot;</span>,</span>
<span id="cb465-47"><a href="bayesian-models-of-cognition.html#cb465-47" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Weight for Direct Evidence&quot;</span>,</span>
<span id="cb465-48"><a href="bayesian-models-of-cognition.html#cb465-48" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight for Social Evidence&quot;</span>,</span>
<span id="cb465-49"><a href="bayesian-models-of-cognition.html#cb465-49" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Expected</span><span class="sc">\n</span><span class="st">Rate&quot;</span></span>
<span id="cb465-50"><a href="bayesian-models-of-cognition.html#cb465-50" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-51"><a href="bayesian-models-of-cognition.html#cb465-51" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb465-52"><a href="bayesian-models-of-cognition.html#cb465-52" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb465-53"><a href="bayesian-models-of-cognition.html#cb465-53" tabindex="-1"></a></span>
<span id="cb465-54"><a href="bayesian-models-of-cognition.html#cb465-54" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(conflict2_results, <span class="fu">aes</span>(<span class="at">x =</span> weight_direct, <span class="at">y =</span> weight_social)) <span class="sc">+</span></span>
<span id="cb465-55"><a href="bayesian-models-of-cognition.html#cb465-55" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> expected_rate)) <span class="sc">+</span></span>
<span id="cb465-56"><a href="bayesian-models-of-cognition.html#cb465-56" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> expected_rate), <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb465-57"><a href="bayesian-models-of-cognition.html#cb465-57" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb465-58"><a href="bayesian-models-of-cognition.html#cb465-58" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb465-59"><a href="bayesian-models-of-cognition.html#cb465-59" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb465-60"><a href="bayesian-models-of-cognition.html#cb465-60" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-61"><a href="bayesian-models-of-cognition.html#cb465-61" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb465-62"><a href="bayesian-models-of-cognition.html#cb465-62" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scenario 1: Weak Direct Evidence for Blue (5 out of 8) </span><span class="sc">\n</span><span class="st">vs. Strong Social Evidence for Red (0/3)&quot;</span>,</span>
<span id="cb465-63"><a href="bayesian-models-of-cognition.html#cb465-63" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Black line shows decision boundary (expected rate = 0.5)&quot;</span>,</span>
<span id="cb465-64"><a href="bayesian-models-of-cognition.html#cb465-64" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Weight for Direct Evidence&quot;</span>,</span>
<span id="cb465-65"><a href="bayesian-models-of-cognition.html#cb465-65" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight for Social Evidence&quot;</span>,</span>
<span id="cb465-66"><a href="bayesian-models-of-cognition.html#cb465-66" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Expected</span><span class="sc">\n</span><span class="st">Rate&quot;</span></span>
<span id="cb465-67"><a href="bayesian-models-of-cognition.html#cb465-67" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-68"><a href="bayesian-models-of-cognition.html#cb465-68" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb465-69"><a href="bayesian-models-of-cognition.html#cb465-69" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb465-70"><a href="bayesian-models-of-cognition.html#cb465-70" tabindex="-1"></a></span>
<span id="cb465-71"><a href="bayesian-models-of-cognition.html#cb465-71" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb465-72"><a href="bayesian-models-of-cognition.html#cb465-72" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/10%20conflicting%20scenarios-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>These visualizations illustrate how different weight combinations resolve conflicts between evidence sources:</p>
<ul>
<li><p>Decision boundary: The black line represents combinations of weights that lead to equal evidence for red and blue (expected rate = 0.5). Weight combinations above this line lead to a “blue” decision, while those below lead to a “red” decision.</p></li>
<li><p>Relative evidence strength: The slope of the decision boundary reflects the relative strength of the evidence sources. A steeper slope indicates that direct evidence is stronger relative to social evidence.</p></li>
<li><p>Individual differences: Different individuals might give different weights to evidence sources, leading to different decisions even when faced with identical evidence. This provides a mechanistic explanation for individual variation in decision-making.</p></li>
</ul>
</div>
</div>
<div id="common-misinterpretations" class="section level2 hasAnchor" number="11.11">
<h2><span class="header-section-number">11.11</span> Common Misinterpretations<a href="bayesian-models-of-cognition.html#common-misinterpretations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="weight-interpretation" class="section level3 hasAnchor" number="11.11.1">
<h3><span class="header-section-number">11.11.1</span> Weight Interpretation<a href="bayesian-models-of-cognition.html#weight-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Weights effectively scale the relative importance of each source of evidence. A weight of 0 means ignoring that evidence source entirely. A weight of 1 means treating the evidence as observed, at face value. Weights above 1 amplify the evidence, while weights below 1 dampen it. A negative weight would make the agent invert the direction of the evidence (if more evidence for red, they’d tend to pick blue).
Remember that weights moderate the evidence, so a strong weight doesn’t guarantee a strong influence if the evidence itself is weak.</p>
</div>
<div id="integration-vs.-averaging" class="section level3 hasAnchor" number="11.11.2">
<h3><span class="header-section-number">11.11.2</span> Integration vs. Averaging<a href="bayesian-models-of-cognition.html#integration-vs.-averaging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bayesian integration is not simply the averaging of evidence across sources, because it naturally includes how precise the evidence is (how narrow the distribution). Normally, this would happen when we multiply the distributions involved. The Beta-Binomial model handles this automatically by incorporating sample sizes (the n of marbles).</p>
</div>
<div id="interpreting-confidence" class="section level3 hasAnchor" number="11.11.3">
<h3><span class="header-section-number">11.11.3</span> Interpreting Confidence<a href="bayesian-models-of-cognition.html#interpreting-confidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is something tricky in this model when it comes to confidence. We can say that a belief that the next sample is going to be blue with a 0.8 (average) probability more confident than one with a 0.6 (average) probability. We can also say that a belief that the next sample is going to be blue with a 0.8 (95% CIs 0.5-1) probability is less confident than a belief with a 0.6 (95% CIs 0.55-0.65) probability.
We need to keep these two aspects separate. The first one is about the average probability, the second one is about the uncertainty around that average probability.
In the code above we only call the second confidence and use entropy of the posterior distribution to quantify it.</p>
</div>
</div>
<div id="simulating-agents-with-different-evidence-weighting-strategies" class="section level2 hasAnchor" number="11.12">
<h2><span class="header-section-number">11.12</span> Simulating Agents with Different Evidence Weighting Strategies<a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To prepare for our model fitting, we’ll simulate three distinct agents:</p>
<ul>
<li><p>Balanced Agent: This agent treats both direct and social evidence at face value, applying equal weights (w_direct = 1.0, w_social = 1.0). This represents an unbiased integration of information.</p></li>
<li><p>Self-Focused Agent: This agent overweights their own direct evidence (w_direct = 1.5) while underweighting social evidence (w_social = 0.5). This represents someone who trusts their own observations more than information from others.</p></li>
<li><p>Socially-Influenced Agent: This agent does the opposite, overweighting social evidence (w_social = 2.0) while underweighting their own direct evidence (w_direct = 0.7). This might represent someone who is highly responsive to social information.</p></li>
</ul>
<p>Let’s generate decisions for these three agents in an experiment exposing them to all possible evidence combinations and visualize how their different weighting strategies affect their beliefs and choices.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="bayesian-models-of-cognition.html#cb466-1" tabindex="-1"></a><span class="co"># Simulation of agents with different weighting strategies</span></span>
<span id="cb466-2"><a href="bayesian-models-of-cognition.html#cb466-2" tabindex="-1"></a><span class="co"># This code generates decisions for three agents with different approaches to weighting evidence</span></span>
<span id="cb466-3"><a href="bayesian-models-of-cognition.html#cb466-3" tabindex="-1"></a></span>
<span id="cb466-4"><a href="bayesian-models-of-cognition.html#cb466-4" tabindex="-1"></a><span class="co"># Define our three agent types with their respective weights</span></span>
<span id="cb466-5"><a href="bayesian-models-of-cognition.html#cb466-5" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb466-6"><a href="bayesian-models-of-cognition.html#cb466-6" tabindex="-1"></a>  <span class="at">agent_type =</span> <span class="fu">c</span>(<span class="st">&quot;Balanced&quot;</span>, <span class="st">&quot;Self-Focused&quot;</span>, <span class="st">&quot;Socially-Influenced&quot;</span>),</span>
<span id="cb466-7"><a href="bayesian-models-of-cognition.html#cb466-7" tabindex="-1"></a>  <span class="at">weight_direct =</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="fl">0.7</span>),   <span class="co"># Weight for direct evidence</span></span>
<span id="cb466-8"><a href="bayesian-models-of-cognition.html#cb466-8" tabindex="-1"></a>  <span class="at">weight_social =</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">2.0</span>)    <span class="co"># Weight for social evidence</span></span>
<span id="cb466-9"><a href="bayesian-models-of-cognition.html#cb466-9" tabindex="-1"></a>)</span>
<span id="cb466-10"><a href="bayesian-models-of-cognition.html#cb466-10" tabindex="-1"></a></span>
<span id="cb466-11"><a href="bayesian-models-of-cognition.html#cb466-11" tabindex="-1"></a><span class="co"># Create all possible evidence combinations</span></span>
<span id="cb466-12"><a href="bayesian-models-of-cognition.html#cb466-12" tabindex="-1"></a><span class="co"># Direct evidence: 0-8 blue marbles out of 8 total</span></span>
<span id="cb466-13"><a href="bayesian-models-of-cognition.html#cb466-13" tabindex="-1"></a><span class="co"># Social evidence: 0-3 signals (representing confidence levels)</span></span>
<span id="cb466-14"><a href="bayesian-models-of-cognition.html#cb466-14" tabindex="-1"></a>evidence_combinations <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb466-15"><a href="bayesian-models-of-cognition.html#cb466-15" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,     <span class="co"># Direct evidence: number of blue marbles seen</span></span>
<span id="cb466-16"><a href="bayesian-models-of-cognition.html#cb466-16" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>      <span class="co"># Social evidence: strength of blue evidence</span></span>
<span id="cb466-17"><a href="bayesian-models-of-cognition.html#cb466-17" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb466-18"><a href="bayesian-models-of-cognition.html#cb466-18" tabindex="-1"></a>  <span class="at">total1 =</span> <span class="dv">8</span>,      <span class="co"># Total marbles in direct evidence</span></span>
<span id="cb466-19"><a href="bayesian-models-of-cognition.html#cb466-19" tabindex="-1"></a>  <span class="at">total2 =</span> <span class="dv">3</span>       <span class="co"># Total strength units in social evidence</span></span>
<span id="cb466-20"><a href="bayesian-models-of-cognition.html#cb466-20" tabindex="-1"></a>)</span>
<span id="cb466-21"><a href="bayesian-models-of-cognition.html#cb466-21" tabindex="-1"></a></span>
<span id="cb466-22"><a href="bayesian-models-of-cognition.html#cb466-22" tabindex="-1"></a>generate_agent_decisions <span class="ot">&lt;-</span> <span class="cf">function</span>(weight_direct, weight_social, evidence_df, <span class="at">n_samples =</span> <span class="dv">5</span>) {</span>
<span id="cb466-23"><a href="bayesian-models-of-cognition.html#cb466-23" tabindex="-1"></a>  <span class="co"># Create a data frame that repeats each evidence combination n_samples times</span></span>
<span id="cb466-24"><a href="bayesian-models-of-cognition.html#cb466-24" tabindex="-1"></a>  repeated_evidence <span class="ot">&lt;-</span> evidence_df <span class="sc">%&gt;%</span></span>
<span id="cb466-25"><a href="bayesian-models-of-cognition.html#cb466-25" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), <span class="at">each =</span> n_samples)) <span class="sc">%&gt;%</span></span>
<span id="cb466-26"><a href="bayesian-models-of-cognition.html#cb466-26" tabindex="-1"></a>    <span class="co"># Add a sample_id to distinguish between repetitions of the same combination</span></span>
<span id="cb466-27"><a href="bayesian-models-of-cognition.html#cb466-27" tabindex="-1"></a>    <span class="fu">group_by</span>(blue1, blue2, total1, total2) <span class="sc">%&gt;%</span></span>
<span id="cb466-28"><a href="bayesian-models-of-cognition.html#cb466-28" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb466-29"><a href="bayesian-models-of-cognition.html#cb466-29" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb466-30"><a href="bayesian-models-of-cognition.html#cb466-30" tabindex="-1"></a>  </span>
<span id="cb466-31"><a href="bayesian-models-of-cognition.html#cb466-31" tabindex="-1"></a>  <span class="co"># Apply our weighted Bayesian model to each evidence combination</span></span>
<span id="cb466-32"><a href="bayesian-models-of-cognition.html#cb466-32" tabindex="-1"></a>  decisions <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(repeated_evidence, <span class="cf">function</span>(blue1, blue2, total1, total2, sample_id) {</span>
<span id="cb466-33"><a href="bayesian-models-of-cognition.html#cb466-33" tabindex="-1"></a>    <span class="co"># Calculate Bayesian integration with the agent&#39;s specific weights</span></span>
<span id="cb466-34"><a href="bayesian-models-of-cognition.html#cb466-34" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">weightedBetaBinomial</span>(</span>
<span id="cb466-35"><a href="bayesian-models-of-cognition.html#cb466-35" tabindex="-1"></a>      <span class="at">alpha_prior =</span> <span class="dv">1</span>, <span class="at">beta_prior =</span> <span class="dv">1</span>,</span>
<span id="cb466-36"><a href="bayesian-models-of-cognition.html#cb466-36" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1, <span class="at">total1 =</span> total1,</span>
<span id="cb466-37"><a href="bayesian-models-of-cognition.html#cb466-37" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2, <span class="at">total2 =</span> total2,</span>
<span id="cb466-38"><a href="bayesian-models-of-cognition.html#cb466-38" tabindex="-1"></a>      <span class="at">weight_direct =</span> weight_direct,</span>
<span id="cb466-39"><a href="bayesian-models-of-cognition.html#cb466-39" tabindex="-1"></a>      <span class="at">weight_social =</span> weight_social</span>
<span id="cb466-40"><a href="bayesian-models-of-cognition.html#cb466-40" tabindex="-1"></a>    )</span>
<span id="cb466-41"><a href="bayesian-models-of-cognition.html#cb466-41" tabindex="-1"></a>    </span>
<span id="cb466-42"><a href="bayesian-models-of-cognition.html#cb466-42" tabindex="-1"></a>    <span class="co"># Return key decision metrics</span></span>
<span id="cb466-43"><a href="bayesian-models-of-cognition.html#cb466-43" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb466-44"><a href="bayesian-models-of-cognition.html#cb466-44" tabindex="-1"></a>      <span class="at">sample_id =</span> sample_id,</span>
<span id="cb466-45"><a href="bayesian-models-of-cognition.html#cb466-45" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1,</span>
<span id="cb466-46"><a href="bayesian-models-of-cognition.html#cb466-46" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2,</span>
<span id="cb466-47"><a href="bayesian-models-of-cognition.html#cb466-47" tabindex="-1"></a>      <span class="at">total1 =</span> total1,</span>
<span id="cb466-48"><a href="bayesian-models-of-cognition.html#cb466-48" tabindex="-1"></a>      <span class="at">total2 =</span> total2,</span>
<span id="cb466-49"><a href="bayesian-models-of-cognition.html#cb466-49" tabindex="-1"></a>      <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,   <span class="co"># Probability the next marble is blue</span></span>
<span id="cb466-50"><a href="bayesian-models-of-cognition.html#cb466-50" tabindex="-1"></a>      <span class="at">choice =</span> result<span class="sc">$</span>decision,               <span class="co"># Final decision (Blue or Red)</span></span>
<span id="cb466-51"><a href="bayesian-models-of-cognition.html#cb466-51" tabindex="-1"></a>      <span class="at">choice_binary =</span> <span class="fu">ifelse</span>(result<span class="sc">$</span>decision <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb466-52"><a href="bayesian-models-of-cognition.html#cb466-52" tabindex="-1"></a>      <span class="at">confidence =</span> result<span class="sc">$</span>confidence          <span class="co"># Confidence in decision</span></span>
<span id="cb466-53"><a href="bayesian-models-of-cognition.html#cb466-53" tabindex="-1"></a>    )</span>
<span id="cb466-54"><a href="bayesian-models-of-cognition.html#cb466-54" tabindex="-1"></a>  })</span>
<span id="cb466-55"><a href="bayesian-models-of-cognition.html#cb466-55" tabindex="-1"></a>  </span>
<span id="cb466-56"><a href="bayesian-models-of-cognition.html#cb466-56" tabindex="-1"></a>  <span class="fu">return</span>(decisions)</span>
<span id="cb466-57"><a href="bayesian-models-of-cognition.html#cb466-57" tabindex="-1"></a>}</span>
<span id="cb466-58"><a href="bayesian-models-of-cognition.html#cb466-58" tabindex="-1"></a></span>
<span id="cb466-59"><a href="bayesian-models-of-cognition.html#cb466-59" tabindex="-1"></a><span class="co"># When generating data for weighted Bayesian model simulation</span></span>
<span id="cb466-60"><a href="bayesian-models-of-cognition.html#cb466-60" tabindex="-1"></a>simulation_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(agents), <span class="cf">function</span>(i) {</span>
<span id="cb466-61"><a href="bayesian-models-of-cognition.html#cb466-61" tabindex="-1"></a>  <span class="co"># Extract this agent&#39;s parameters</span></span>
<span id="cb466-62"><a href="bayesian-models-of-cognition.html#cb466-62" tabindex="-1"></a>  agent_data <span class="ot">&lt;-</span> agents[i, ]</span>
<span id="cb466-63"><a href="bayesian-models-of-cognition.html#cb466-63" tabindex="-1"></a>  </span>
<span id="cb466-64"><a href="bayesian-models-of-cognition.html#cb466-64" tabindex="-1"></a>  <span class="co"># Generate decisions for this agent with multiple samples</span></span>
<span id="cb466-65"><a href="bayesian-models-of-cognition.html#cb466-65" tabindex="-1"></a>  decisions <span class="ot">&lt;-</span> <span class="fu">generate_agent_decisions</span>(</span>
<span id="cb466-66"><a href="bayesian-models-of-cognition.html#cb466-66" tabindex="-1"></a>    agent_data<span class="sc">$</span>weight_direct,</span>
<span id="cb466-67"><a href="bayesian-models-of-cognition.html#cb466-67" tabindex="-1"></a>    agent_data<span class="sc">$</span>weight_social,</span>
<span id="cb466-68"><a href="bayesian-models-of-cognition.html#cb466-68" tabindex="-1"></a>    evidence_combinations,</span>
<span id="cb466-69"><a href="bayesian-models-of-cognition.html#cb466-69" tabindex="-1"></a>    <span class="at">n_samples =</span> <span class="dv">5</span>  <span class="co"># Generate 5 samples per evidence combination</span></span>
<span id="cb466-70"><a href="bayesian-models-of-cognition.html#cb466-70" tabindex="-1"></a>  )</span>
<span id="cb466-71"><a href="bayesian-models-of-cognition.html#cb466-71" tabindex="-1"></a>  </span>
<span id="cb466-72"><a href="bayesian-models-of-cognition.html#cb466-72" tabindex="-1"></a>  <span class="co"># Add agent identifier</span></span>
<span id="cb466-73"><a href="bayesian-models-of-cognition.html#cb466-73" tabindex="-1"></a>  decisions<span class="sc">$</span>agent_type <span class="ot">&lt;-</span> agent_data<span class="sc">$</span>agent_type</span>
<span id="cb466-74"><a href="bayesian-models-of-cognition.html#cb466-74" tabindex="-1"></a>  </span>
<span id="cb466-75"><a href="bayesian-models-of-cognition.html#cb466-75" tabindex="-1"></a>  <span class="fu">return</span>(decisions)</span>
<span id="cb466-76"><a href="bayesian-models-of-cognition.html#cb466-76" tabindex="-1"></a>})</span>
<span id="cb466-77"><a href="bayesian-models-of-cognition.html#cb466-77" tabindex="-1"></a></span>
<span id="cb466-78"><a href="bayesian-models-of-cognition.html#cb466-78" tabindex="-1"></a><span class="co"># Add descriptive labels for visualization</span></span>
<span id="cb466-79"><a href="bayesian-models-of-cognition.html#cb466-79" tabindex="-1"></a>simulation_results <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb466-80"><a href="bayesian-models-of-cognition.html#cb466-80" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb466-81"><a href="bayesian-models-of-cognition.html#cb466-81" tabindex="-1"></a>    <span class="co"># Create descriptive labels for social evidence</span></span>
<span id="cb466-82"><a href="bayesian-models-of-cognition.html#cb466-82" tabindex="-1"></a>    <span class="at">social_evidence =</span> <span class="fu">factor</span>(</span>
<span id="cb466-83"><a href="bayesian-models-of-cognition.html#cb466-83" tabindex="-1"></a>      blue2,</span>
<span id="cb466-84"><a href="bayesian-models-of-cognition.html#cb466-84" tabindex="-1"></a>      <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb466-85"><a href="bayesian-models-of-cognition.html#cb466-85" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Maybe Red&quot;</span>, <span class="st">&quot;Maybe Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>)</span>
<span id="cb466-86"><a href="bayesian-models-of-cognition.html#cb466-86" tabindex="-1"></a>    ),</span>
<span id="cb466-87"><a href="bayesian-models-of-cognition.html#cb466-87" tabindex="-1"></a>    <span class="co"># Create factor for agent type to control plotting order</span></span>
<span id="cb466-88"><a href="bayesian-models-of-cognition.html#cb466-88" tabindex="-1"></a>    <span class="at">agent_type =</span> <span class="fu">factor</span>(</span>
<span id="cb466-89"><a href="bayesian-models-of-cognition.html#cb466-89" tabindex="-1"></a>      agent_type,</span>
<span id="cb466-90"><a href="bayesian-models-of-cognition.html#cb466-90" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Balanced&quot;</span>, <span class="st">&quot;Self-Focused&quot;</span>, <span class="st">&quot;Socially-Influenced&quot;</span>)</span>
<span id="cb466-91"><a href="bayesian-models-of-cognition.html#cb466-91" tabindex="-1"></a>    )</span>
<span id="cb466-92"><a href="bayesian-models-of-cognition.html#cb466-92" tabindex="-1"></a>  )</span>
<span id="cb466-93"><a href="bayesian-models-of-cognition.html#cb466-93" tabindex="-1"></a></span>
<span id="cb466-94"><a href="bayesian-models-of-cognition.html#cb466-94" tabindex="-1"></a><span class="co"># Let&#39;s examine a sample of the generated data</span></span>
<span id="cb466-95"><a href="bayesian-models-of-cognition.html#cb466-95" tabindex="-1"></a><span class="fu">head</span>(simulation_results)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##   sample_id blue1 blue2 total1 total2 expected_rate choice choice_binary confidence
##       &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;
## 1         1     0     0      8      3        0.0769 Red                0      0.858
## 2         2     0     0      8      3        0.0769 Red                0      0.858
## 3         3     0     0      8      3        0.0769 Red                0      0.858
## 4         4     0     0      8      3        0.0769 Red                0      0.858
## 5         5     0     0      8      3        0.0769 Red                0      0.858
## 6         1     0     1      8      3        0.154  Red                0      0.807
## # ℹ 2 more variables: agent_type &lt;fct&gt;, social_evidence &lt;fct&gt;</code></pre>
<p>Now let’s create visualizations to compare how these different agents make decisions based on the same evidence:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="bayesian-models-of-cognition.html#cb468-1" tabindex="-1"></a><span class="co"># Visualization 1: Expected probability across evidence combinations</span></span>
<span id="cb468-2"><a href="bayesian-models-of-cognition.html#cb468-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(simulation_results, </span>
<span id="cb468-3"><a href="bayesian-models-of-cognition.html#cb468-3" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> expected_rate, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb468-4"><a href="bayesian-models-of-cognition.html#cb468-4" tabindex="-1"></a>  <span class="co"># Draw a line for each social evidence level</span></span>
<span id="cb468-5"><a href="bayesian-models-of-cognition.html#cb468-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb468-6"><a href="bayesian-models-of-cognition.html#cb468-6" tabindex="-1"></a>  <span class="co"># Add points to show discrete evidence combinations</span></span>
<span id="cb468-7"><a href="bayesian-models-of-cognition.html#cb468-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb468-8"><a href="bayesian-models-of-cognition.html#cb468-8" tabindex="-1"></a>  <span class="co"># Add a reference line at 0.5 (decision boundary)</span></span>
<span id="cb468-9"><a href="bayesian-models-of-cognition.html#cb468-9" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb468-10"><a href="bayesian-models-of-cognition.html#cb468-10" tabindex="-1"></a>  <span class="co"># Facet by agent type</span></span>
<span id="cb468-11"><a href="bayesian-models-of-cognition.html#cb468-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_type, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb468-12"><a href="bayesian-models-of-cognition.html#cb468-12" tabindex="-1"></a>  <span class="co"># Customize colors and labels</span></span>
<span id="cb468-13"><a href="bayesian-models-of-cognition.html#cb468-13" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb468-14"><a href="bayesian-models-of-cognition.html#cb468-14" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb468-15"><a href="bayesian-models-of-cognition.html#cb468-15" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb468-16"><a href="bayesian-models-of-cognition.html#cb468-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;How Different Agents Integrate Evidence&quot;</span>,</span>
<span id="cb468-17"><a href="bayesian-models-of-cognition.html#cb468-17" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Expected probability of blue marble across evidence combinations&quot;</span>,</span>
<span id="cb468-18"><a href="bayesian-models-of-cognition.html#cb468-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Sample (out of 8)&quot;</span>,</span>
<span id="cb468-19"><a href="bayesian-models-of-cognition.html#cb468-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Expected Probability of Blue&quot;</span>,</span>
<span id="cb468-20"><a href="bayesian-models-of-cognition.html#cb468-20" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span></span>
<span id="cb468-21"><a href="bayesian-models-of-cognition.html#cb468-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb468-22"><a href="bayesian-models-of-cognition.html#cb468-22" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb468-23"><a href="bayesian-models-of-cognition.html#cb468-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb468-24"><a href="bayesian-models-of-cognition.html#cb468-24" tabindex="-1"></a></span>
<span id="cb468-25"><a href="bayesian-models-of-cognition.html#cb468-25" tabindex="-1"></a><span class="co"># Visualization 2: Decision boundaries for each agent</span></span>
<span id="cb468-26"><a href="bayesian-models-of-cognition.html#cb468-26" tabindex="-1"></a><span class="co"># Create a simplified dataset showing just the decision (Blue/Red)</span></span>
<span id="cb468-27"><a href="bayesian-models-of-cognition.html#cb468-27" tabindex="-1"></a>decision_data <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb468-28"><a href="bayesian-models-of-cognition.html#cb468-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decision_value =</span> <span class="fu">ifelse</span>(choice <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb468-29"><a href="bayesian-models-of-cognition.html#cb468-29" tabindex="-1"></a></span>
<span id="cb468-30"><a href="bayesian-models-of-cognition.html#cb468-30" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(decision_data, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> blue2)) <span class="sc">+</span></span>
<span id="cb468-31"><a href="bayesian-models-of-cognition.html#cb468-31" tabindex="-1"></a>  <span class="co"># Create tiles colored by decision</span></span>
<span id="cb468-32"><a href="bayesian-models-of-cognition.html#cb468-32" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> choice)) <span class="sc">+</span></span>
<span id="cb468-33"><a href="bayesian-models-of-cognition.html#cb468-33" tabindex="-1"></a>  <span class="co"># Add decision boundary contour line</span></span>
<span id="cb468-34"><a href="bayesian-models-of-cognition.html#cb468-34" tabindex="-1"></a>  <span class="fu">stat_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> decision_value), <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb468-35"><a href="bayesian-models-of-cognition.html#cb468-35" tabindex="-1"></a>  <span class="co"># Facet by agent type</span></span>
<span id="cb468-36"><a href="bayesian-models-of-cognition.html#cb468-36" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_type) <span class="sc">+</span></span>
<span id="cb468-37"><a href="bayesian-models-of-cognition.html#cb468-37" tabindex="-1"></a>  <span class="co"># Customize colors and labels</span></span>
<span id="cb468-38"><a href="bayesian-models-of-cognition.html#cb468-38" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Red&quot;</span> <span class="ot">=</span> <span class="st">&quot;firebrick&quot;</span>, <span class="st">&quot;Blue&quot;</span> <span class="ot">=</span> <span class="st">&quot;royalblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb468-39"><a href="bayesian-models-of-cognition.html#cb468-39" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb468-40"><a href="bayesian-models-of-cognition.html#cb468-40" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb468-41"><a href="bayesian-models-of-cognition.html#cb468-41" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb468-42"><a href="bayesian-models-of-cognition.html#cb468-42" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Decision Boundaries Across Agents&quot;</span>,</span>
<span id="cb468-43"><a href="bayesian-models-of-cognition.html#cb468-43" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Black line shows where agents switch from choosing red to blue&quot;</span>,</span>
<span id="cb468-44"><a href="bayesian-models-of-cognition.html#cb468-44" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Evidence (out of 8)&quot;</span>,</span>
<span id="cb468-45"><a href="bayesian-models-of-cognition.html#cb468-45" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Number of Blue Signals in Social Evidence (out of 3)&quot;</span>,</span>
<span id="cb468-46"><a href="bayesian-models-of-cognition.html#cb468-46" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Decision&quot;</span></span>
<span id="cb468-47"><a href="bayesian-models-of-cognition.html#cb468-47" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb468-48"><a href="bayesian-models-of-cognition.html#cb468-48" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb468-49"><a href="bayesian-models-of-cognition.html#cb468-49" tabindex="-1"></a></span>
<span id="cb468-50"><a href="bayesian-models-of-cognition.html#cb468-50" tabindex="-1"></a><span class="co"># Visualization 3: Confidence levels</span></span>
<span id="cb468-51"><a href="bayesian-models-of-cognition.html#cb468-51" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(simulation_results, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> confidence, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb468-52"><a href="bayesian-models-of-cognition.html#cb468-52" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb468-53"><a href="bayesian-models-of-cognition.html#cb468-53" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb468-54"><a href="bayesian-models-of-cognition.html#cb468-54" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_type, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb468-55"><a href="bayesian-models-of-cognition.html#cb468-55" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb468-56"><a href="bayesian-models-of-cognition.html#cb468-56" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb468-57"><a href="bayesian-models-of-cognition.html#cb468-57" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb468-58"><a href="bayesian-models-of-cognition.html#cb468-58" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Confidence Across Evidence Combinations&quot;</span>,</span>
<span id="cb468-59"><a href="bayesian-models-of-cognition.html#cb468-59" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher values indicate greater confidence in decision&quot;</span>,</span>
<span id="cb468-60"><a href="bayesian-models-of-cognition.html#cb468-60" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Blue Marbles in Direct Sample (out of 8)&quot;</span>,</span>
<span id="cb468-61"><a href="bayesian-models-of-cognition.html#cb468-61" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Decision Confidence&quot;</span>,</span>
<span id="cb468-62"><a href="bayesian-models-of-cognition.html#cb468-62" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span></span>
<span id="cb468-63"><a href="bayesian-models-of-cognition.html#cb468-63" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb468-64"><a href="bayesian-models-of-cognition.html#cb468-64" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb468-65"><a href="bayesian-models-of-cognition.html#cb468-65" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb468-66"><a href="bayesian-models-of-cognition.html#cb468-66" tabindex="-1"></a></span>
<span id="cb468-67"><a href="bayesian-models-of-cognition.html#cb468-67" tabindex="-1"></a><span class="co"># Display the visualizations</span></span>
<span id="cb468-68"><a href="bayesian-models-of-cognition.html#cb468-68" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/10%20visualizing%20agents%20with%20different%20strategies-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="bayesian-models-of-cognition.html#cb469-1" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="series_files/figure-html/10%20visualizing%20agents%20with%20different%20strategies-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="bayesian-models-of-cognition.html#cb470-1" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="series_files/figure-html/10%20visualizing%20agents%20with%20different%20strategies-3.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="key-observations-from-the-simulation" class="section level2 hasAnchor" number="11.13">
<h2><span class="header-section-number">11.13</span> Key Observations from the Simulation<a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our simulation highlights several important aspects of Bayesian evidence integration with different weighting strategies:</p>
<ul>
<li><p>Evidence Thresholds: The decision boundaries (Visualization 2) clearly show how much evidence each agent requires to switch from choosing red to blue. The Self-Focused agent needs less direct evidence when social evidence supports blue, compared to the Socially-Influenced agent.</p></li>
<li><p>Influence of Social Evidence: In the first visualization, we can observe how the lines for different social evidence levels are spaced. For the Socially-Influenced agent, these lines are widely spaced, indicating that social evidence strongly affects their beliefs. For the Self-Focused agent, the lines are closer together, showing less impact from social evidence.</p></li>
<li><p>Confidence Patterns: The third visualization reveals how confidence varies across evidence combinations and agent types. All agents are most confident when evidence is strong and consistent across sources, but they differ in how they handle conflicting evidence.</p></li>
<li><p>Decision Regions: The Self-Focused agent has a larger region where they choose blue based primarily on direct evidence, while the Socially-Influenced agent has more regions where social evidence can override moderate direct evidence.</p></li>
</ul>
<p>These patterns highlight the profound impact that evidence weighting can have on decision-making, even when agents are all using the same underlying Bayesian integration mechanism. In the next section, we’ll implement these agents in Stan to perform more sophisticated parameter estimation.</p>
<p>Now, let’s define our Stan models to implement: a simple bayesian agent (equivalent to assuming both weights to be 1); and a weighted bayesian agent (explicitly inferring weights for direct and social evidence).</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="bayesian-models-of-cognition.html#cb471-1" tabindex="-1"></a><span class="co"># Simple Beta-Binomial Stan model (no weights)</span></span>
<span id="cb471-2"><a href="bayesian-models-of-cognition.html#cb471-2" tabindex="-1"></a>SimpleAgent_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb471-3"><a href="bayesian-models-of-cognition.html#cb471-3" tabindex="-1"></a><span class="st">// Bayesian integration model relying on a beta-binomial distribution</span></span>
<span id="cb471-4"><a href="bayesian-models-of-cognition.html#cb471-4" tabindex="-1"></a><span class="st">// to preserve all uncertainty</span></span>
<span id="cb471-5"><a href="bayesian-models-of-cognition.html#cb471-5" tabindex="-1"></a><span class="st">// All evidence is taken at face value (equal weights)</span></span>
<span id="cb471-6"><a href="bayesian-models-of-cognition.html#cb471-6" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb471-7"><a href="bayesian-models-of-cognition.html#cb471-7" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                      // Number of decisions</span></span>
<span id="cb471-8"><a href="bayesian-models-of-cognition.html#cb471-8" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb471-9"><a href="bayesian-models-of-cognition.html#cb471-9" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;         // Direct evidence (blue marbles)</span></span>
<span id="cb471-10"><a href="bayesian-models-of-cognition.html#cb471-10" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;        // Total direct evidence (total marbles)</span></span>
<span id="cb471-11"><a href="bayesian-models-of-cognition.html#cb471-11" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;         // Social evidence (blue signals)</span></span>
<span id="cb471-12"><a href="bayesian-models-of-cognition.html#cb471-12" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;        // Total social evidence (total signals)</span></span>
<span id="cb471-13"><a href="bayesian-models-of-cognition.html#cb471-13" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-14"><a href="bayesian-models-of-cognition.html#cb471-14" tabindex="-1"></a></span>
<span id="cb471-15"><a href="bayesian-models-of-cognition.html#cb471-15" tabindex="-1"></a><span class="st">parameters{</span></span>
<span id="cb471-16"><a href="bayesian-models-of-cognition.html#cb471-16" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; alpha_prior;                    // Prior alpha parameter</span></span>
<span id="cb471-17"><a href="bayesian-models-of-cognition.html#cb471-17" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; beta_prior;                     // Prior beta parameter</span></span>
<span id="cb471-18"><a href="bayesian-models-of-cognition.html#cb471-18" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-19"><a href="bayesian-models-of-cognition.html#cb471-19" tabindex="-1"></a></span>
<span id="cb471-20"><a href="bayesian-models-of-cognition.html#cb471-20" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb471-21"><a href="bayesian-models-of-cognition.html#cb471-21" tabindex="-1"></a></span>
<span id="cb471-22"><a href="bayesian-models-of-cognition.html#cb471-22" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(alpha_prior | 0, 1); // Prior on alpha_prior, the agent bias towards blue</span></span>
<span id="cb471-23"><a href="bayesian-models-of-cognition.html#cb471-23" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(beta_prior | 0, 1);  // Prior on beta_prior, the agent bias towards red</span></span>
<span id="cb471-24"><a href="bayesian-models-of-cognition.html#cb471-24" tabindex="-1"></a></span>
<span id="cb471-25"><a href="bayesian-models-of-cognition.html#cb471-25" tabindex="-1"></a><span class="st">  // Each observation is a separate decision</span></span>
<span id="cb471-26"><a href="bayesian-models-of-cognition.html#cb471-26" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb471-27"><a href="bayesian-models-of-cognition.html#cb471-27" tabindex="-1"></a><span class="st">    // Calculate Beta parameters for posterior belief distribution</span></span>
<span id="cb471-28"><a href="bayesian-models-of-cognition.html#cb471-28" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior + blue1[i] + blue2[i];</span></span>
<span id="cb471-29"><a href="bayesian-models-of-cognition.html#cb471-29" tabindex="-1"></a><span class="st">    real beta_post = beta_prior + (total1[i] - blue1[i]) + (total2[i] - blue2[i]);</span></span>
<span id="cb471-30"><a href="bayesian-models-of-cognition.html#cb471-30" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-31"><a href="bayesian-models-of-cognition.html#cb471-31" tabindex="-1"></a><span class="st">    // Use beta_binomial distribution which integrates over all possible values</span></span>
<span id="cb471-32"><a href="bayesian-models-of-cognition.html#cb471-32" tabindex="-1"></a><span class="st">    // of the rate parameter weighted by their posterior probability</span></span>
<span id="cb471-33"><a href="bayesian-models-of-cognition.html#cb471-33" tabindex="-1"></a><span class="st">    target += beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb471-34"><a href="bayesian-models-of-cognition.html#cb471-34" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb471-35"><a href="bayesian-models-of-cognition.html#cb471-35" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-36"><a href="bayesian-models-of-cognition.html#cb471-36" tabindex="-1"></a></span>
<span id="cb471-37"><a href="bayesian-models-of-cognition.html#cb471-37" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb471-38"><a href="bayesian-models-of-cognition.html#cb471-38" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb471-39"><a href="bayesian-models-of-cognition.html#cb471-39" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb471-40"><a href="bayesian-models-of-cognition.html#cb471-40" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb471-41"><a href="bayesian-models-of-cognition.html#cb471-41" tabindex="-1"></a><span class="st">  // Prior and posterior predictive checks</span></span>
<span id="cb471-42"><a href="bayesian-models-of-cognition.html#cb471-42" tabindex="-1"></a><span class="st">  array[N] int prior_pred_choice;</span></span>
<span id="cb471-43"><a href="bayesian-models-of-cognition.html#cb471-43" tabindex="-1"></a><span class="st">  array[N] int posterior_pred_choice;</span></span>
<span id="cb471-44"><a href="bayesian-models-of-cognition.html#cb471-44" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb471-45"><a href="bayesian-models-of-cognition.html#cb471-45" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb471-46"><a href="bayesian-models-of-cognition.html#cb471-46" tabindex="-1"></a><span class="st">    // For prior predictions, use uniform prior (Beta(1,1))</span></span>
<span id="cb471-47"><a href="bayesian-models-of-cognition.html#cb471-47" tabindex="-1"></a><span class="st">    prior_pred_choice[i] = beta_binomial_rng(1, 1, 1);</span></span>
<span id="cb471-48"><a href="bayesian-models-of-cognition.html#cb471-48" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-49"><a href="bayesian-models-of-cognition.html#cb471-49" tabindex="-1"></a><span class="st">    // For posterior predictions, use integrated evidence</span></span>
<span id="cb471-50"><a href="bayesian-models-of-cognition.html#cb471-50" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior + blue1[i] + blue2[i];</span></span>
<span id="cb471-51"><a href="bayesian-models-of-cognition.html#cb471-51" tabindex="-1"></a><span class="st">    real beta_post = beta_prior + (total1[i] - blue1[i]) + (total2[i] - blue2[i]);</span></span>
<span id="cb471-52"><a href="bayesian-models-of-cognition.html#cb471-52" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-53"><a href="bayesian-models-of-cognition.html#cb471-53" tabindex="-1"></a><span class="st">    // Generate predictions using the complete beta-binomial model</span></span>
<span id="cb471-54"><a href="bayesian-models-of-cognition.html#cb471-54" tabindex="-1"></a><span class="st">    posterior_pred_choice[i] = beta_binomial_rng(1, alpha_post, beta_post);</span></span>
<span id="cb471-55"><a href="bayesian-models-of-cognition.html#cb471-55" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-56"><a href="bayesian-models-of-cognition.html#cb471-56" tabindex="-1"></a><span class="st">    // Log likelihood calculation using beta-binomial</span></span>
<span id="cb471-57"><a href="bayesian-models-of-cognition.html#cb471-57" tabindex="-1"></a><span class="st">    log_lik[i] = beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb471-58"><a href="bayesian-models-of-cognition.html#cb471-58" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb471-59"><a href="bayesian-models-of-cognition.html#cb471-59" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-60"><a href="bayesian-models-of-cognition.html#cb471-60" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb471-61"><a href="bayesian-models-of-cognition.html#cb471-61" tabindex="-1"></a></span>
<span id="cb471-62"><a href="bayesian-models-of-cognition.html#cb471-62" tabindex="-1"></a><span class="co"># Weighted Beta-Binomial Stan model</span></span>
<span id="cb471-63"><a href="bayesian-models-of-cognition.html#cb471-63" tabindex="-1"></a>WeightedAgent_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb471-64"><a href="bayesian-models-of-cognition.html#cb471-64" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb471-65"><a href="bayesian-models-of-cognition.html#cb471-65" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Number of decisions</span></span>
<span id="cb471-66"><a href="bayesian-models-of-cognition.html#cb471-66" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb471-67"><a href="bayesian-models-of-cognition.html#cb471-67" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles)</span></span>
<span id="cb471-68"><a href="bayesian-models-of-cognition.html#cb471-68" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;          // Total direct evidence</span></span>
<span id="cb471-69"><a href="bayesian-models-of-cognition.html#cb471-69" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals)</span></span>
<span id="cb471-70"><a href="bayesian-models-of-cognition.html#cb471-70" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;          // Total social evidence</span></span>
<span id="cb471-71"><a href="bayesian-models-of-cognition.html#cb471-71" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-72"><a href="bayesian-models-of-cognition.html#cb471-72" tabindex="-1"></a></span>
<span id="cb471-73"><a href="bayesian-models-of-cognition.html#cb471-73" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb471-74"><a href="bayesian-models-of-cognition.html#cb471-74" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; alpha_prior;                    // Prior alpha parameter</span></span>
<span id="cb471-75"><a href="bayesian-models-of-cognition.html#cb471-75" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; beta_prior;                     // Prior beta parameter</span></span>
<span id="cb471-76"><a href="bayesian-models-of-cognition.html#cb471-76" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; total_weight;         // Total influence of all evidence</span></span>
<span id="cb471-77"><a href="bayesian-models-of-cognition.html#cb471-77" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; weight_prop; // Proportion of weight for direct evidence</span></span>
<span id="cb471-78"><a href="bayesian-models-of-cognition.html#cb471-78" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-79"><a href="bayesian-models-of-cognition.html#cb471-79" tabindex="-1"></a></span>
<span id="cb471-80"><a href="bayesian-models-of-cognition.html#cb471-80" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb471-81"><a href="bayesian-models-of-cognition.html#cb471-81" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; weight_direct = total_weight * weight_prop;</span></span>
<span id="cb471-82"><a href="bayesian-models-of-cognition.html#cb471-82" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; weight_social = total_weight * (1 - weight_prop);</span></span>
<span id="cb471-83"><a href="bayesian-models-of-cognition.html#cb471-83" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-84"><a href="bayesian-models-of-cognition.html#cb471-84" tabindex="-1"></a></span>
<span id="cb471-85"><a href="bayesian-models-of-cognition.html#cb471-85" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb471-86"><a href="bayesian-models-of-cognition.html#cb471-86" tabindex="-1"></a><span class="st">  // Priors</span></span>
<span id="cb471-87"><a href="bayesian-models-of-cognition.html#cb471-87" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(alpha_prior | 0, 1); // Prior on alpha_prior</span></span>
<span id="cb471-88"><a href="bayesian-models-of-cognition.html#cb471-88" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(beta_prior | 0, 1);  // Prior on beta_prior</span></span>
<span id="cb471-89"><a href="bayesian-models-of-cognition.html#cb471-89" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(total_weight | .8, .4);  // Centered around 2 with reasonable spread and always positive</span></span>
<span id="cb471-90"><a href="bayesian-models-of-cognition.html#cb471-90" tabindex="-1"></a><span class="st">  target += beta_lpdf(weight_prop | 1, 1);    // Uniform prior on proportion</span></span>
<span id="cb471-91"><a href="bayesian-models-of-cognition.html#cb471-91" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb471-92"><a href="bayesian-models-of-cognition.html#cb471-92" tabindex="-1"></a><span class="st">  // Each observation is a separate decision</span></span>
<span id="cb471-93"><a href="bayesian-models-of-cognition.html#cb471-93" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb471-94"><a href="bayesian-models-of-cognition.html#cb471-94" tabindex="-1"></a><span class="st">    // For this specific decision:</span></span>
<span id="cb471-95"><a href="bayesian-models-of-cognition.html#cb471-95" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * weight_direct;</span></span>
<span id="cb471-96"><a href="bayesian-models-of-cognition.html#cb471-96" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * weight_direct;</span></span>
<span id="cb471-97"><a href="bayesian-models-of-cognition.html#cb471-97" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * weight_social;</span></span>
<span id="cb471-98"><a href="bayesian-models-of-cognition.html#cb471-98" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * weight_social;</span></span>
<span id="cb471-99"><a href="bayesian-models-of-cognition.html#cb471-99" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-100"><a href="bayesian-models-of-cognition.html#cb471-100" tabindex="-1"></a><span class="st">    // Calculate Beta parameters for this decision</span></span>
<span id="cb471-101"><a href="bayesian-models-of-cognition.html#cb471-101" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb471-102"><a href="bayesian-models-of-cognition.html#cb471-102" tabindex="-1"></a><span class="st">    real beta_post = beta_prior + weighted_red1 + weighted_red2;</span></span>
<span id="cb471-103"><a href="bayesian-models-of-cognition.html#cb471-103" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-104"><a href="bayesian-models-of-cognition.html#cb471-104" tabindex="-1"></a><span class="st">    // Use beta_binomial distribution to integrate over the full posterior</span></span>
<span id="cb471-105"><a href="bayesian-models-of-cognition.html#cb471-105" tabindex="-1"></a><span class="st">    target += beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb471-106"><a href="bayesian-models-of-cognition.html#cb471-106" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb471-107"><a href="bayesian-models-of-cognition.html#cb471-107" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-108"><a href="bayesian-models-of-cognition.html#cb471-108" tabindex="-1"></a></span>
<span id="cb471-109"><a href="bayesian-models-of-cognition.html#cb471-109" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb471-110"><a href="bayesian-models-of-cognition.html#cb471-110" tabindex="-1"></a><span class="st">  // Log likelihood and predictions</span></span>
<span id="cb471-111"><a href="bayesian-models-of-cognition.html#cb471-111" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb471-112"><a href="bayesian-models-of-cognition.html#cb471-112" tabindex="-1"></a><span class="st">  array[N] int posterior_pred_choice;</span></span>
<span id="cb471-113"><a href="bayesian-models-of-cognition.html#cb471-113" tabindex="-1"></a><span class="st">  array[N] int prior_pred_choice;</span></span>
<span id="cb471-114"><a href="bayesian-models-of-cognition.html#cb471-114" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb471-115"><a href="bayesian-models-of-cognition.html#cb471-115" tabindex="-1"></a><span class="st">  // Sample the agent&#39;s preconceptions</span></span>
<span id="cb471-116"><a href="bayesian-models-of-cognition.html#cb471-116" tabindex="-1"></a><span class="st">  real alpha_prior_prior = lognormal_rng(0, 1);</span></span>
<span id="cb471-117"><a href="bayesian-models-of-cognition.html#cb471-117" tabindex="-1"></a><span class="st">  real beta_prior_prior = lognormal_rng(0, 1);</span></span>
<span id="cb471-118"><a href="bayesian-models-of-cognition.html#cb471-118" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb471-119"><a href="bayesian-models-of-cognition.html#cb471-119" tabindex="-1"></a><span class="st">  // Sample from priors for the reparameterized model</span></span>
<span id="cb471-120"><a href="bayesian-models-of-cognition.html#cb471-120" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; total_weight_prior = lognormal_rng(.8, .4);</span></span>
<span id="cb471-121"><a href="bayesian-models-of-cognition.html#cb471-121" tabindex="-1"></a><span class="st">  real weight_prop_prior = beta_rng(1, 1);</span></span>
<span id="cb471-122"><a href="bayesian-models-of-cognition.html#cb471-122" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb471-123"><a href="bayesian-models-of-cognition.html#cb471-123" tabindex="-1"></a><span class="st">  // Derive the implied direct and social weights from the prior samples</span></span>
<span id="cb471-124"><a href="bayesian-models-of-cognition.html#cb471-124" tabindex="-1"></a><span class="st">  real weight_direct_prior = total_weight_prior * weight_prop_prior;</span></span>
<span id="cb471-125"><a href="bayesian-models-of-cognition.html#cb471-125" tabindex="-1"></a><span class="st">  real weight_social_prior = total_weight_prior * (1 - weight_prop_prior);</span></span>
<span id="cb471-126"><a href="bayesian-models-of-cognition.html#cb471-126" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb471-127"><a href="bayesian-models-of-cognition.html#cb471-127" tabindex="-1"></a><span class="st">  // Posterior predictions and log-likelihood</span></span>
<span id="cb471-128"><a href="bayesian-models-of-cognition.html#cb471-128" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb471-129"><a href="bayesian-models-of-cognition.html#cb471-129" tabindex="-1"></a><span class="st">    // Posterior predictions using the weighted evidence</span></span>
<span id="cb471-130"><a href="bayesian-models-of-cognition.html#cb471-130" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * weight_direct;</span></span>
<span id="cb471-131"><a href="bayesian-models-of-cognition.html#cb471-131" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * weight_direct;</span></span>
<span id="cb471-132"><a href="bayesian-models-of-cognition.html#cb471-132" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * weight_social;</span></span>
<span id="cb471-133"><a href="bayesian-models-of-cognition.html#cb471-133" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * weight_social;</span></span>
<span id="cb471-134"><a href="bayesian-models-of-cognition.html#cb471-134" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-135"><a href="bayesian-models-of-cognition.html#cb471-135" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb471-136"><a href="bayesian-models-of-cognition.html#cb471-136" tabindex="-1"></a><span class="st">    real beta_post = beta_prior + weighted_red1 + weighted_red2;</span></span>
<span id="cb471-137"><a href="bayesian-models-of-cognition.html#cb471-137" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-138"><a href="bayesian-models-of-cognition.html#cb471-138" tabindex="-1"></a><span class="st">    // Log likelihood using beta_binomial</span></span>
<span id="cb471-139"><a href="bayesian-models-of-cognition.html#cb471-139" tabindex="-1"></a><span class="st">    log_lik[i] = beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb471-140"><a href="bayesian-models-of-cognition.html#cb471-140" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-141"><a href="bayesian-models-of-cognition.html#cb471-141" tabindex="-1"></a><span class="st">    // Generate predictions from the full posterior</span></span>
<span id="cb471-142"><a href="bayesian-models-of-cognition.html#cb471-142" tabindex="-1"></a><span class="st">    posterior_pred_choice[i] = beta_binomial_rng(1, alpha_post, beta_post);</span></span>
<span id="cb471-143"><a href="bayesian-models-of-cognition.html#cb471-143" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-144"><a href="bayesian-models-of-cognition.html#cb471-144" tabindex="-1"></a><span class="st">    // Prior predictions using the prior-derived weights</span></span>
<span id="cb471-145"><a href="bayesian-models-of-cognition.html#cb471-145" tabindex="-1"></a><span class="st">    real prior_weighted_blue1 = blue1[i] * weight_direct_prior;</span></span>
<span id="cb471-146"><a href="bayesian-models-of-cognition.html#cb471-146" tabindex="-1"></a><span class="st">    real prior_weighted_red1 = (total1[i] - blue1[i]) * weight_direct_prior;</span></span>
<span id="cb471-147"><a href="bayesian-models-of-cognition.html#cb471-147" tabindex="-1"></a><span class="st">    real prior_weighted_blue2 = blue2[i] * weight_social_prior;</span></span>
<span id="cb471-148"><a href="bayesian-models-of-cognition.html#cb471-148" tabindex="-1"></a><span class="st">    real prior_weighted_red2 = (total2[i] - blue2[i]) * weight_social_prior;</span></span>
<span id="cb471-149"><a href="bayesian-models-of-cognition.html#cb471-149" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-150"><a href="bayesian-models-of-cognition.html#cb471-150" tabindex="-1"></a><span class="st">    real alpha_prior_preds = alpha_prior + prior_weighted_blue1 + prior_weighted_blue2;</span></span>
<span id="cb471-151"><a href="bayesian-models-of-cognition.html#cb471-151" tabindex="-1"></a><span class="st">    real beta_prior_preds = beta_prior + prior_weighted_red1 + prior_weighted_red2;</span></span>
<span id="cb471-152"><a href="bayesian-models-of-cognition.html#cb471-152" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb471-153"><a href="bayesian-models-of-cognition.html#cb471-153" tabindex="-1"></a><span class="st">    // Generate predictions from the prior</span></span>
<span id="cb471-154"><a href="bayesian-models-of-cognition.html#cb471-154" tabindex="-1"></a><span class="st">    prior_pred_choice[i] = beta_binomial_rng(1, alpha_prior, beta_prior);</span></span>
<span id="cb471-155"><a href="bayesian-models-of-cognition.html#cb471-155" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb471-156"><a href="bayesian-models-of-cognition.html#cb471-156" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb471-157"><a href="bayesian-models-of-cognition.html#cb471-157" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb471-158"><a href="bayesian-models-of-cognition.html#cb471-158" tabindex="-1"></a></span>
<span id="cb471-159"><a href="bayesian-models-of-cognition.html#cb471-159" tabindex="-1"></a><span class="co"># Write the models to files</span></span>
<span id="cb471-160"><a href="bayesian-models-of-cognition.html#cb471-160" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb471-161"><a href="bayesian-models-of-cognition.html#cb471-161" tabindex="-1"></a>  SimpleAgent_stan,</span>
<span id="cb471-162"><a href="bayesian-models-of-cognition.html#cb471-162" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb471-163"><a href="bayesian-models-of-cognition.html#cb471-163" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10 _beta_binomial.stan&quot;</span></span>
<span id="cb471-164"><a href="bayesian-models-of-cognition.html#cb471-164" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10 _beta_binomial.stan&quot;</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="bayesian-models-of-cognition.html#cb473-1" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb473-2"><a href="bayesian-models-of-cognition.html#cb473-2" tabindex="-1"></a>  WeightedAgent_stan,</span>
<span id="cb473-3"><a href="bayesian-models-of-cognition.html#cb473-3" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb473-4"><a href="bayesian-models-of-cognition.html#cb473-4" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10 _weighted_beta_binomial.stan&quot;</span></span>
<span id="cb473-5"><a href="bayesian-models-of-cognition.html#cb473-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10 _weighted_beta_binomial.stan&quot;</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="bayesian-models-of-cognition.html#cb475-1" tabindex="-1"></a><span class="co"># Prepare simulation data for Stan fitting</span></span>
<span id="cb475-2"><a href="bayesian-models-of-cognition.html#cb475-2" tabindex="-1"></a><span class="co"># Convert &#39;Blue&#39; and &#39;Red&#39; choices to binary format (1 for Blue, 0 for Red)</span></span>
<span id="cb475-3"><a href="bayesian-models-of-cognition.html#cb475-3" tabindex="-1"></a>sim_data_for_stan <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb475-4"><a href="bayesian-models-of-cognition.html#cb475-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb475-5"><a href="bayesian-models-of-cognition.html#cb475-5" tabindex="-1"></a>    <span class="at">choice_binary =</span> <span class="fu">as.integer</span>(choice <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>),</span>
<span id="cb475-6"><a href="bayesian-models-of-cognition.html#cb475-6" tabindex="-1"></a>    <span class="at">total1 =</span> <span class="dv">8</span>,  <span class="co"># Total marbles in direct evidence (constant)</span></span>
<span id="cb475-7"><a href="bayesian-models-of-cognition.html#cb475-7" tabindex="-1"></a>    <span class="at">total2 =</span> <span class="dv">3</span>   <span class="co"># Total signals in social evidence (constant)</span></span>
<span id="cb475-8"><a href="bayesian-models-of-cognition.html#cb475-8" tabindex="-1"></a>  )</span>
<span id="cb475-9"><a href="bayesian-models-of-cognition.html#cb475-9" tabindex="-1"></a></span>
<span id="cb475-10"><a href="bayesian-models-of-cognition.html#cb475-10" tabindex="-1"></a><span class="co"># Split data by agent type</span></span>
<span id="cb475-11"><a href="bayesian-models-of-cognition.html#cb475-11" tabindex="-1"></a>balanced_data <span class="ot">&lt;-</span> sim_data_for_stan <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_type <span class="sc">==</span> <span class="st">&quot;Balanced&quot;</span>)</span>
<span id="cb475-12"><a href="bayesian-models-of-cognition.html#cb475-12" tabindex="-1"></a>self_focused_data <span class="ot">&lt;-</span> sim_data_for_stan <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_type <span class="sc">==</span> <span class="st">&quot;Self-Focused&quot;</span>)</span>
<span id="cb475-13"><a href="bayesian-models-of-cognition.html#cb475-13" tabindex="-1"></a>socially_influenced_data <span class="ot">&lt;-</span> sim_data_for_stan <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_type <span class="sc">==</span> <span class="st">&quot;Socially-Influenced&quot;</span>)</span>
<span id="cb475-14"><a href="bayesian-models-of-cognition.html#cb475-14" tabindex="-1"></a></span>
<span id="cb475-15"><a href="bayesian-models-of-cognition.html#cb475-15" tabindex="-1"></a><span class="co"># Function to prepare data for Stan</span></span>
<span id="cb475-16"><a href="bayesian-models-of-cognition.html#cb475-16" tabindex="-1"></a>prepare_stan_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb475-17"><a href="bayesian-models-of-cognition.html#cb475-17" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb475-18"><a href="bayesian-models-of-cognition.html#cb475-18" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb475-19"><a href="bayesian-models-of-cognition.html#cb475-19" tabindex="-1"></a>    <span class="at">choice =</span> df<span class="sc">$</span>choice_binary,</span>
<span id="cb475-20"><a href="bayesian-models-of-cognition.html#cb475-20" tabindex="-1"></a>    <span class="at">blue1 =</span> df<span class="sc">$</span>blue1,</span>
<span id="cb475-21"><a href="bayesian-models-of-cognition.html#cb475-21" tabindex="-1"></a>    <span class="at">total1 =</span> df<span class="sc">$</span>total1,</span>
<span id="cb475-22"><a href="bayesian-models-of-cognition.html#cb475-22" tabindex="-1"></a>    <span class="at">blue2 =</span> df<span class="sc">$</span>blue2,</span>
<span id="cb475-23"><a href="bayesian-models-of-cognition.html#cb475-23" tabindex="-1"></a>    <span class="at">total2 =</span> df<span class="sc">$</span>total2</span>
<span id="cb475-24"><a href="bayesian-models-of-cognition.html#cb475-24" tabindex="-1"></a>  )</span>
<span id="cb475-25"><a href="bayesian-models-of-cognition.html#cb475-25" tabindex="-1"></a>}</span>
<span id="cb475-26"><a href="bayesian-models-of-cognition.html#cb475-26" tabindex="-1"></a></span>
<span id="cb475-27"><a href="bayesian-models-of-cognition.html#cb475-27" tabindex="-1"></a><span class="co"># Prepare Stan data for each agent</span></span>
<span id="cb475-28"><a href="bayesian-models-of-cognition.html#cb475-28" tabindex="-1"></a>stan_data_balanced <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(balanced_data)</span>
<span id="cb475-29"><a href="bayesian-models-of-cognition.html#cb475-29" tabindex="-1"></a>stan_data_self_focused <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(self_focused_data)</span>
<span id="cb475-30"><a href="bayesian-models-of-cognition.html#cb475-30" tabindex="-1"></a>stan_data_socially_influenced <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(socially_influenced_data)</span>
<span id="cb475-31"><a href="bayesian-models-of-cognition.html#cb475-31" tabindex="-1"></a></span>
<span id="cb475-32"><a href="bayesian-models-of-cognition.html#cb475-32" tabindex="-1"></a><span class="co"># Compile the Stan models</span></span>
<span id="cb475-33"><a href="bayesian-models-of-cognition.html#cb475-33" tabindex="-1"></a>file_simple <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10 _beta_binomial.stan&quot;</span>)</span>
<span id="cb475-34"><a href="bayesian-models-of-cognition.html#cb475-34" tabindex="-1"></a>file_weighted <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10 _weighted_beta_binomial.stan&quot;</span>)</span>
<span id="cb475-35"><a href="bayesian-models-of-cognition.html#cb475-35" tabindex="-1"></a></span>
<span id="cb475-36"><a href="bayesian-models-of-cognition.html#cb475-36" tabindex="-1"></a><span class="co"># Check if we need to regenerate simulation results</span></span>
<span id="cb475-37"><a href="bayesian-models-of-cognition.html#cb475-37" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb475-38"><a href="bayesian-models-of-cognition.html#cb475-38" tabindex="-1"></a>  <span class="co"># Compile models</span></span>
<span id="cb475-39"><a href="bayesian-models-of-cognition.html#cb475-39" tabindex="-1"></a>  mod_simple <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_simple, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb475-40"><a href="bayesian-models-of-cognition.html#cb475-40" tabindex="-1"></a>  mod_weighted <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_weighted, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb475-41"><a href="bayesian-models-of-cognition.html#cb475-41" tabindex="-1"></a>  </span>
<span id="cb475-42"><a href="bayesian-models-of-cognition.html#cb475-42" tabindex="-1"></a>  <span class="co"># Fit simple model to each agent&#39;s data</span></span>
<span id="cb475-43"><a href="bayesian-models-of-cognition.html#cb475-43" tabindex="-1"></a>  fit_simple_balanced <span class="ot">&lt;-</span> mod_simple<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb475-44"><a href="bayesian-models-of-cognition.html#cb475-44" tabindex="-1"></a>    <span class="at">data =</span> stan_data_balanced,</span>
<span id="cb475-45"><a href="bayesian-models-of-cognition.html#cb475-45" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb475-46"><a href="bayesian-models-of-cognition.html#cb475-46" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-47"><a href="bayesian-models-of-cognition.html#cb475-47" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-48"><a href="bayesian-models-of-cognition.html#cb475-48" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb475-49"><a href="bayesian-models-of-cognition.html#cb475-49" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb475-50"><a href="bayesian-models-of-cognition.html#cb475-50" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb475-51"><a href="bayesian-models-of-cognition.html#cb475-51" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span>  <span class="co"># Set to 500 or so to see progress</span></span>
<span id="cb475-52"><a href="bayesian-models-of-cognition.html#cb475-52" tabindex="-1"></a>  )</span>
<span id="cb475-53"><a href="bayesian-models-of-cognition.html#cb475-53" tabindex="-1"></a>  </span>
<span id="cb475-54"><a href="bayesian-models-of-cognition.html#cb475-54" tabindex="-1"></a>  fit_simple_self_focused <span class="ot">&lt;-</span> mod_simple<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb475-55"><a href="bayesian-models-of-cognition.html#cb475-55" tabindex="-1"></a>    <span class="at">data =</span> stan_data_self_focused,</span>
<span id="cb475-56"><a href="bayesian-models-of-cognition.html#cb475-56" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">124</span>,</span>
<span id="cb475-57"><a href="bayesian-models-of-cognition.html#cb475-57" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-58"><a href="bayesian-models-of-cognition.html#cb475-58" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-59"><a href="bayesian-models-of-cognition.html#cb475-59" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb475-60"><a href="bayesian-models-of-cognition.html#cb475-60" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb475-61"><a href="bayesian-models-of-cognition.html#cb475-61" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb475-62"><a href="bayesian-models-of-cognition.html#cb475-62" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb475-63"><a href="bayesian-models-of-cognition.html#cb475-63" tabindex="-1"></a>  )</span>
<span id="cb475-64"><a href="bayesian-models-of-cognition.html#cb475-64" tabindex="-1"></a>  </span>
<span id="cb475-65"><a href="bayesian-models-of-cognition.html#cb475-65" tabindex="-1"></a>  fit_simple_socially_influenced <span class="ot">&lt;-</span> mod_simple<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb475-66"><a href="bayesian-models-of-cognition.html#cb475-66" tabindex="-1"></a>    <span class="at">data =</span> stan_data_socially_influenced,</span>
<span id="cb475-67"><a href="bayesian-models-of-cognition.html#cb475-67" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">125</span>,</span>
<span id="cb475-68"><a href="bayesian-models-of-cognition.html#cb475-68" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-69"><a href="bayesian-models-of-cognition.html#cb475-69" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-70"><a href="bayesian-models-of-cognition.html#cb475-70" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb475-71"><a href="bayesian-models-of-cognition.html#cb475-71" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb475-72"><a href="bayesian-models-of-cognition.html#cb475-72" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb475-73"><a href="bayesian-models-of-cognition.html#cb475-73" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb475-74"><a href="bayesian-models-of-cognition.html#cb475-74" tabindex="-1"></a>  )</span>
<span id="cb475-75"><a href="bayesian-models-of-cognition.html#cb475-75" tabindex="-1"></a>  </span>
<span id="cb475-76"><a href="bayesian-models-of-cognition.html#cb475-76" tabindex="-1"></a>  <span class="co"># Fit weighted model to each agent&#39;s data</span></span>
<span id="cb475-77"><a href="bayesian-models-of-cognition.html#cb475-77" tabindex="-1"></a>  fit_weighted_balanced <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb475-78"><a href="bayesian-models-of-cognition.html#cb475-78" tabindex="-1"></a>    <span class="at">data =</span> stan_data_balanced,</span>
<span id="cb475-79"><a href="bayesian-models-of-cognition.html#cb475-79" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">124</span>,</span>
<span id="cb475-80"><a href="bayesian-models-of-cognition.html#cb475-80" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-81"><a href="bayesian-models-of-cognition.html#cb475-81" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-82"><a href="bayesian-models-of-cognition.html#cb475-82" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb475-83"><a href="bayesian-models-of-cognition.html#cb475-83" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb475-84"><a href="bayesian-models-of-cognition.html#cb475-84" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb475-85"><a href="bayesian-models-of-cognition.html#cb475-85" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb475-86"><a href="bayesian-models-of-cognition.html#cb475-86" tabindex="-1"></a>  )</span>
<span id="cb475-87"><a href="bayesian-models-of-cognition.html#cb475-87" tabindex="-1"></a>  </span>
<span id="cb475-88"><a href="bayesian-models-of-cognition.html#cb475-88" tabindex="-1"></a>  fit_weighted_self_focused <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb475-89"><a href="bayesian-models-of-cognition.html#cb475-89" tabindex="-1"></a>    <span class="at">data =</span> stan_data_self_focused,</span>
<span id="cb475-90"><a href="bayesian-models-of-cognition.html#cb475-90" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">127</span>,</span>
<span id="cb475-91"><a href="bayesian-models-of-cognition.html#cb475-91" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-92"><a href="bayesian-models-of-cognition.html#cb475-92" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-93"><a href="bayesian-models-of-cognition.html#cb475-93" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb475-94"><a href="bayesian-models-of-cognition.html#cb475-94" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb475-95"><a href="bayesian-models-of-cognition.html#cb475-95" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb475-96"><a href="bayesian-models-of-cognition.html#cb475-96" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb475-97"><a href="bayesian-models-of-cognition.html#cb475-97" tabindex="-1"></a>  )</span>
<span id="cb475-98"><a href="bayesian-models-of-cognition.html#cb475-98" tabindex="-1"></a>  </span>
<span id="cb475-99"><a href="bayesian-models-of-cognition.html#cb475-99" tabindex="-1"></a>  fit_weighted_socially_influenced <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb475-100"><a href="bayesian-models-of-cognition.html#cb475-100" tabindex="-1"></a>    <span class="at">data =</span> stan_data_socially_influenced,</span>
<span id="cb475-101"><a href="bayesian-models-of-cognition.html#cb475-101" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">128</span>,</span>
<span id="cb475-102"><a href="bayesian-models-of-cognition.html#cb475-102" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-103"><a href="bayesian-models-of-cognition.html#cb475-103" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb475-104"><a href="bayesian-models-of-cognition.html#cb475-104" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb475-105"><a href="bayesian-models-of-cognition.html#cb475-105" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb475-106"><a href="bayesian-models-of-cognition.html#cb475-106" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb475-107"><a href="bayesian-models-of-cognition.html#cb475-107" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb475-108"><a href="bayesian-models-of-cognition.html#cb475-108" tabindex="-1"></a>  )</span>
<span id="cb475-109"><a href="bayesian-models-of-cognition.html#cb475-109" tabindex="-1"></a>  </span>
<span id="cb475-110"><a href="bayesian-models-of-cognition.html#cb475-110" tabindex="-1"></a>  <span class="co"># Save model fits for future use</span></span>
<span id="cb475-111"><a href="bayesian-models-of-cognition.html#cb475-111" tabindex="-1"></a>  fit_simple_balanced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_simple_balanced.rds&quot;</span>)</span>
<span id="cb475-112"><a href="bayesian-models-of-cognition.html#cb475-112" tabindex="-1"></a>  fit_simple_self_focused<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_simple_self_focused.rds&quot;</span>)</span>
<span id="cb475-113"><a href="bayesian-models-of-cognition.html#cb475-113" tabindex="-1"></a>  fit_simple_socially_influenced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_simple_socially_influenced.rds&quot;</span>)</span>
<span id="cb475-114"><a href="bayesian-models-of-cognition.html#cb475-114" tabindex="-1"></a>  fit_weighted_balanced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_weighted_balanced.rds&quot;</span>)</span>
<span id="cb475-115"><a href="bayesian-models-of-cognition.html#cb475-115" tabindex="-1"></a>  fit_weighted_self_focused<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_weighted_self_focused.rds&quot;</span>)</span>
<span id="cb475-116"><a href="bayesian-models-of-cognition.html#cb475-116" tabindex="-1"></a>  fit_weighted_socially_influenced<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_weighted_socially_influenced.rds&quot;</span>)</span>
<span id="cb475-117"><a href="bayesian-models-of-cognition.html#cb475-117" tabindex="-1"></a>  </span>
<span id="cb475-118"><a href="bayesian-models-of-cognition.html#cb475-118" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Generated and saved new model fits</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb475-119"><a href="bayesian-models-of-cognition.html#cb475-119" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb475-120"><a href="bayesian-models-of-cognition.html#cb475-120" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb475-121"><a href="bayesian-models-of-cognition.html#cb475-121" tabindex="-1"></a>  fit_simple_balanced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_simple_balanced.rds&quot;</span>)</span>
<span id="cb475-122"><a href="bayesian-models-of-cognition.html#cb475-122" tabindex="-1"></a>  fit_simple_self_focused <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_simple_self_focused.rds&quot;</span>)</span>
<span id="cb475-123"><a href="bayesian-models-of-cognition.html#cb475-123" tabindex="-1"></a>  fit_simple_socially_influenced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_simple_socially_influenced.rds&quot;</span>)</span>
<span id="cb475-124"><a href="bayesian-models-of-cognition.html#cb475-124" tabindex="-1"></a>  fit_weighted_balanced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_weighted_balanced.rds&quot;</span>)</span>
<span id="cb475-125"><a href="bayesian-models-of-cognition.html#cb475-125" tabindex="-1"></a>  fit_weighted_self_focused <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_weighted_self_focused.rds&quot;</span>)</span>
<span id="cb475-126"><a href="bayesian-models-of-cognition.html#cb475-126" tabindex="-1"></a>  fit_weighted_socially_influenced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_weighted_socially_influenced.rds&quot;</span>)</span>
<span id="cb475-127"><a href="bayesian-models-of-cognition.html#cb475-127" tabindex="-1"></a>  </span>
<span id="cb475-128"><a href="bayesian-models-of-cognition.html#cb475-128" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb475-129"><a href="bayesian-models-of-cognition.html#cb475-129" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing model fits</code></pre>
</div>
<div id="model-quality-checks" class="section level2 hasAnchor" number="11.14">
<h2><span class="header-section-number">11.14</span> Model Quality Checks<a href="bayesian-models-of-cognition.html#model-quality-checks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="overview" class="section level3 hasAnchor" number="11.14.1">
<h3><span class="header-section-number">11.14.1</span> Overview<a href="bayesian-models-of-cognition.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Model quality checks are crucial for understanding how well our Bayesian models capture the underlying data-generating process. We’ll use three primary techniques:</p>
<ol style="list-style-type: decimal">
<li>Prior Predictive Checks</li>
<li>Posterior Predictive Checks</li>
<li>Prior-Posterior Update Visualization</li>
</ol>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="bayesian-models-of-cognition.html#cb477-1" tabindex="-1"></a><span class="co"># Function to create trace and rank plots for a model</span></span>
<span id="cb477-2"><a href="bayesian-models-of-cognition.html#cb477-2" tabindex="-1"></a>create_diagnostic_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, model_name) {</span>
<span id="cb477-3"><a href="bayesian-models-of-cognition.html#cb477-3" tabindex="-1"></a>  <span class="co"># Extract posterior draws</span></span>
<span id="cb477-4"><a href="bayesian-models-of-cognition.html#cb477-4" tabindex="-1"></a>  draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb477-5"><a href="bayesian-models-of-cognition.html#cb477-5" tabindex="-1"></a>  </span>
<span id="cb477-6"><a href="bayesian-models-of-cognition.html#cb477-6" tabindex="-1"></a>  trace_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb477-7"><a href="bayesian-models-of-cognition.html#cb477-7" tabindex="-1"></a>    <span class="at">Iteration =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(draws)<span class="sc">/</span><span class="fu">length</span>(<span class="fu">unique</span>(draws<span class="sc">$</span>.chain))), </span>
<span id="cb477-8"><a href="bayesian-models-of-cognition.html#cb477-8" tabindex="-1"></a>                    <span class="fu">length</span>(<span class="fu">unique</span>(draws<span class="sc">$</span>.chain))),</span>
<span id="cb477-9"><a href="bayesian-models-of-cognition.html#cb477-9" tabindex="-1"></a>    <span class="at">Chain =</span> draws<span class="sc">$</span>.chain,</span>
<span id="cb477-10"><a href="bayesian-models-of-cognition.html#cb477-10" tabindex="-1"></a>    <span class="at">weight_direct =</span> draws<span class="sc">$</span>weight_direct,</span>
<span id="cb477-11"><a href="bayesian-models-of-cognition.html#cb477-11" tabindex="-1"></a>    <span class="at">weight_social =</span> draws<span class="sc">$</span>weight_social,</span>
<span id="cb477-12"><a href="bayesian-models-of-cognition.html#cb477-12" tabindex="-1"></a>    <span class="at">total_weight =</span> draws<span class="sc">$</span>total_weight,</span>
<span id="cb477-13"><a href="bayesian-models-of-cognition.html#cb477-13" tabindex="-1"></a>    <span class="at">weight_prop =</span> draws<span class="sc">$</span>weight_prop</span>
<span id="cb477-14"><a href="bayesian-models-of-cognition.html#cb477-14" tabindex="-1"></a>  )</span>
<span id="cb477-15"><a href="bayesian-models-of-cognition.html#cb477-15" tabindex="-1"></a>  </span>
<span id="cb477-16"><a href="bayesian-models-of-cognition.html#cb477-16" tabindex="-1"></a>  <span class="co"># Create trace plot</span></span>
<span id="cb477-17"><a href="bayesian-models-of-cognition.html#cb477-17" tabindex="-1"></a>  trace_plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trace_data, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> weight_direct, <span class="at">color =</span> <span class="fu">factor</span>(Chain))) <span class="sc">+</span></span>
<span id="cb477-18"><a href="bayesian-models-of-cognition.html#cb477-18" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb477-19"><a href="bayesian-models-of-cognition.html#cb477-19" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Trace Plot for weight_direct&quot;</span>),</span>
<span id="cb477-20"><a href="bayesian-models-of-cognition.html#cb477-20" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb477-21"><a href="bayesian-models-of-cognition.html#cb477-21" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;weight_direct&quot;</span>,</span>
<span id="cb477-22"><a href="bayesian-models-of-cognition.html#cb477-22" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Chain&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-23"><a href="bayesian-models-of-cognition.html#cb477-23" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb477-24"><a href="bayesian-models-of-cognition.html#cb477-24" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb477-25"><a href="bayesian-models-of-cognition.html#cb477-25" tabindex="-1"></a>  </span>
<span id="cb477-26"><a href="bayesian-models-of-cognition.html#cb477-26" tabindex="-1"></a>  trace_plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trace_data, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> weight_social, <span class="at">color =</span> <span class="fu">factor</span>(Chain))) <span class="sc">+</span></span>
<span id="cb477-27"><a href="bayesian-models-of-cognition.html#cb477-27" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb477-28"><a href="bayesian-models-of-cognition.html#cb477-28" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Trace Plot for weight_social&quot;</span>),</span>
<span id="cb477-29"><a href="bayesian-models-of-cognition.html#cb477-29" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb477-30"><a href="bayesian-models-of-cognition.html#cb477-30" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;weight_direct&quot;</span>,</span>
<span id="cb477-31"><a href="bayesian-models-of-cognition.html#cb477-31" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Chain&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-32"><a href="bayesian-models-of-cognition.html#cb477-32" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb477-33"><a href="bayesian-models-of-cognition.html#cb477-33" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb477-34"><a href="bayesian-models-of-cognition.html#cb477-34" tabindex="-1"></a>  </span>
<span id="cb477-35"><a href="bayesian-models-of-cognition.html#cb477-35" tabindex="-1"></a>  trace_plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trace_data, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> total_weight, <span class="at">color =</span> <span class="fu">factor</span>(Chain))) <span class="sc">+</span></span>
<span id="cb477-36"><a href="bayesian-models-of-cognition.html#cb477-36" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb477-37"><a href="bayesian-models-of-cognition.html#cb477-37" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Trace Plot for total_weight&quot;</span>),</span>
<span id="cb477-38"><a href="bayesian-models-of-cognition.html#cb477-38" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb477-39"><a href="bayesian-models-of-cognition.html#cb477-39" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;weight_direct&quot;</span>,</span>
<span id="cb477-40"><a href="bayesian-models-of-cognition.html#cb477-40" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Chain&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-41"><a href="bayesian-models-of-cognition.html#cb477-41" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb477-42"><a href="bayesian-models-of-cognition.html#cb477-42" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb477-43"><a href="bayesian-models-of-cognition.html#cb477-43" tabindex="-1"></a>  </span>
<span id="cb477-44"><a href="bayesian-models-of-cognition.html#cb477-44" tabindex="-1"></a>  trace_plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trace_data, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> weight_prop, <span class="at">color =</span> <span class="fu">factor</span>(Chain))) <span class="sc">+</span></span>
<span id="cb477-45"><a href="bayesian-models-of-cognition.html#cb477-45" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb477-46"><a href="bayesian-models-of-cognition.html#cb477-46" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Trace Plot for weight_prop&quot;</span>),</span>
<span id="cb477-47"><a href="bayesian-models-of-cognition.html#cb477-47" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb477-48"><a href="bayesian-models-of-cognition.html#cb477-48" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;weight_direct&quot;</span>,</span>
<span id="cb477-49"><a href="bayesian-models-of-cognition.html#cb477-49" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Chain&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-50"><a href="bayesian-models-of-cognition.html#cb477-50" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb477-51"><a href="bayesian-models-of-cognition.html#cb477-51" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb477-52"><a href="bayesian-models-of-cognition.html#cb477-52" tabindex="-1"></a>  </span>
<span id="cb477-53"><a href="bayesian-models-of-cognition.html#cb477-53" tabindex="-1"></a>  <span class="co"># Combine plots using patchwork</span></span>
<span id="cb477-54"><a href="bayesian-models-of-cognition.html#cb477-54" tabindex="-1"></a>  combined_trace_plot <span class="ot">&lt;-</span> (trace_plot1 <span class="sc">+</span> trace_plot2) <span class="sc">/</span> (trace_plot3 <span class="sc">+</span> trace_plot4) <span class="sc">+</span></span>
<span id="cb477-55"><a href="bayesian-models-of-cognition.html#cb477-55" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Trace Plots for&quot;</span>, model_name))</span>
<span id="cb477-56"><a href="bayesian-models-of-cognition.html#cb477-56" tabindex="-1"></a>  </span>
<span id="cb477-57"><a href="bayesian-models-of-cognition.html#cb477-57" tabindex="-1"></a>  </span>
<span id="cb477-58"><a href="bayesian-models-of-cognition.html#cb477-58" tabindex="-1"></a>  <span class="co"># Return the plots</span></span>
<span id="cb477-59"><a href="bayesian-models-of-cognition.html#cb477-59" tabindex="-1"></a>  <span class="fu">return</span>(combined_trace_plot)</span>
<span id="cb477-60"><a href="bayesian-models-of-cognition.html#cb477-60" tabindex="-1"></a>}</span>
<span id="cb477-61"><a href="bayesian-models-of-cognition.html#cb477-61" tabindex="-1"></a></span>
<span id="cb477-62"><a href="bayesian-models-of-cognition.html#cb477-62" tabindex="-1"></a><span class="co"># Generate diagnostic plots for each model</span></span>
<span id="cb477-63"><a href="bayesian-models-of-cognition.html#cb477-63" tabindex="-1"></a><span class="fu">create_diagnostic_plots</span>(fit_weighted_balanced, <span class="st">&quot;Balanced Model&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/10%20fit%20quality-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="bayesian-models-of-cognition.html#cb478-1" tabindex="-1"></a><span class="fu">create_diagnostic_plots</span>(fit_weighted_self_focused, <span class="st">&quot;Self-Focused Model&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/10%20fit%20quality-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="bayesian-models-of-cognition.html#cb479-1" tabindex="-1"></a><span class="fu">create_diagnostic_plots</span>(fit_weighted_socially_influenced, <span class="st">&quot;Socially-Influenced Model&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/10%20fit%20quality-3.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="prior-and-posterior-predictive-checks" class="section level3 hasAnchor" number="11.14.2">
<h3><span class="header-section-number">11.14.2</span> Prior and Posterior Predictive Checks<a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prior predictive checks help us understand what our model assumes about the world before seeing any data. They answer the question: “What kind of data would we expect to see if we only used our prior beliefs?” Posterior predictive checks are the same, but after having seen the data. This helps us assess whether the model can generate data that looks similar to our observed data.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="bayesian-models-of-cognition.html#cb480-1" tabindex="-1"></a>plot_predictive_checks <span class="ot">&lt;-</span> <span class="cf">function</span>(stan_fit, </span>
<span id="cb480-2"><a href="bayesian-models-of-cognition.html#cb480-2" tabindex="-1"></a>                                   simulation_results, </span>
<span id="cb480-3"><a href="bayesian-models-of-cognition.html#cb480-3" tabindex="-1"></a>                                   <span class="at">model_name =</span> <span class="st">&quot;Simple Balanced&quot;</span>, </span>
<span id="cb480-4"><a href="bayesian-models-of-cognition.html#cb480-4" tabindex="-1"></a>                                   <span class="at">param_name =</span> <span class="st">&quot;prior_pred_choice&quot;</span>) {</span>
<span id="cb480-5"><a href="bayesian-models-of-cognition.html#cb480-5" tabindex="-1"></a>  <span class="co"># Extract predictive samples</span></span>
<span id="cb480-6"><a href="bayesian-models-of-cognition.html#cb480-6" tabindex="-1"></a>  pred_samples <span class="ot">&lt;-</span> stan_fit<span class="sc">$</span><span class="fu">draws</span>(param_name, <span class="at">format =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb480-7"><a href="bayesian-models-of-cognition.html#cb480-7" tabindex="-1"></a>  </span>
<span id="cb480-8"><a href="bayesian-models-of-cognition.html#cb480-8" tabindex="-1"></a>  <span class="co"># Get the number of samples and observations</span></span>
<span id="cb480-9"><a href="bayesian-models-of-cognition.html#cb480-9" tabindex="-1"></a>  n_samples <span class="ot">&lt;-</span> <span class="fu">nrow</span>(pred_samples)</span>
<span id="cb480-10"><a href="bayesian-models-of-cognition.html#cb480-10" tabindex="-1"></a>  n_obs <span class="ot">&lt;-</span> <span class="fu">ncol</span>(pred_samples) <span class="sc">-</span> <span class="dv">3</span>  <span class="co"># Subtract chain, iteration, and draw columns</span></span>
<span id="cb480-11"><a href="bayesian-models-of-cognition.html#cb480-11" tabindex="-1"></a>  </span>
<span id="cb480-12"><a href="bayesian-models-of-cognition.html#cb480-12" tabindex="-1"></a>  <span class="co"># Convert to long format</span></span>
<span id="cb480-13"><a href="bayesian-models-of-cognition.html#cb480-13" tabindex="-1"></a>  long_pred <span class="ot">&lt;-</span> pred_samples <span class="sc">%&gt;%</span></span>
<span id="cb480-14"><a href="bayesian-models-of-cognition.html#cb480-14" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.chain, <span class="sc">-</span>.iteration, <span class="sc">-</span>.draw) <span class="sc">%&gt;%</span>  <span class="co"># Remove metadata columns</span></span>
<span id="cb480-15"><a href="bayesian-models-of-cognition.html#cb480-15" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb480-16"><a href="bayesian-models-of-cognition.html#cb480-16" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb480-17"><a href="bayesian-models-of-cognition.html#cb480-17" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">&quot;obs_id&quot;</span>,</span>
<span id="cb480-18"><a href="bayesian-models-of-cognition.html#cb480-18" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">&quot;choice&quot;</span></span>
<span id="cb480-19"><a href="bayesian-models-of-cognition.html#cb480-19" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb480-20"><a href="bayesian-models-of-cognition.html#cb480-20" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">obs_id =</span> <span class="fu">parse_number</span>(obs_id))  <span class="co"># Extract observation number</span></span>
<span id="cb480-21"><a href="bayesian-models-of-cognition.html#cb480-21" tabindex="-1"></a>  </span>
<span id="cb480-22"><a href="bayesian-models-of-cognition.html#cb480-22" tabindex="-1"></a>  <span class="co"># Join with the original simulation data to get evidence levels</span></span>
<span id="cb480-23"><a href="bayesian-models-of-cognition.html#cb480-23" tabindex="-1"></a>  <span class="co"># First, add an observation ID to the simulation data</span></span>
<span id="cb480-24"><a href="bayesian-models-of-cognition.html#cb480-24" tabindex="-1"></a>  sim_with_id <span class="ot">&lt;-</span> simulation_results <span class="sc">%&gt;%</span></span>
<span id="cb480-25"><a href="bayesian-models-of-cognition.html#cb480-25" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">obs_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb480-26"><a href="bayesian-models-of-cognition.html#cb480-26" tabindex="-1"></a>  </span>
<span id="cb480-27"><a href="bayesian-models-of-cognition.html#cb480-27" tabindex="-1"></a>  <span class="co"># Join predictions with evidence levels</span></span>
<span id="cb480-28"><a href="bayesian-models-of-cognition.html#cb480-28" tabindex="-1"></a>  long_pred_with_evidence <span class="ot">&lt;-</span> long_pred <span class="sc">%&gt;%</span></span>
<span id="cb480-29"><a href="bayesian-models-of-cognition.html#cb480-29" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb480-30"><a href="bayesian-models-of-cognition.html#cb480-30" tabindex="-1"></a>      sim_with_id <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(obs_id, blue1, blue2),</span>
<span id="cb480-31"><a href="bayesian-models-of-cognition.html#cb480-31" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">&quot;obs_id&quot;</span></span>
<span id="cb480-32"><a href="bayesian-models-of-cognition.html#cb480-32" tabindex="-1"></a>    )</span>
<span id="cb480-33"><a href="bayesian-models-of-cognition.html#cb480-33" tabindex="-1"></a>  </span>
<span id="cb480-34"><a href="bayesian-models-of-cognition.html#cb480-34" tabindex="-1"></a>  <span class="co"># Summarize proportion of 1s per evidence combination</span></span>
<span id="cb480-35"><a href="bayesian-models-of-cognition.html#cb480-35" tabindex="-1"></a>  pred_summary <span class="ot">&lt;-</span> long_pred_with_evidence <span class="sc">%&gt;%</span></span>
<span id="cb480-36"><a href="bayesian-models-of-cognition.html#cb480-36" tabindex="-1"></a>    <span class="fu">group_by</span>(blue1, blue2) <span class="sc">%&gt;%</span></span>
<span id="cb480-37"><a href="bayesian-models-of-cognition.html#cb480-37" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb480-38"><a href="bayesian-models-of-cognition.html#cb480-38" tabindex="-1"></a>      <span class="at">proportion =</span> <span class="fu">mean</span>(choice, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb480-39"><a href="bayesian-models-of-cognition.html#cb480-39" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>(),  </span>
<span id="cb480-40"><a href="bayesian-models-of-cognition.html#cb480-40" tabindex="-1"></a>      <span class="at">se =</span> <span class="fu">sqrt</span>((proportion <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> proportion)) <span class="sc">/</span> n),  <span class="co"># Binomial SE</span></span>
<span id="cb480-41"><a href="bayesian-models-of-cognition.html#cb480-41" tabindex="-1"></a>      <span class="at">lower =</span> proportion <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,  </span>
<span id="cb480-42"><a href="bayesian-models-of-cognition.html#cb480-42" tabindex="-1"></a>      <span class="at">upper =</span> proportion <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se,  </span>
<span id="cb480-43"><a href="bayesian-models-of-cognition.html#cb480-43" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb480-44"><a href="bayesian-models-of-cognition.html#cb480-44" tabindex="-1"></a>    )</span>
<span id="cb480-45"><a href="bayesian-models-of-cognition.html#cb480-45" tabindex="-1"></a></span>
<span id="cb480-46"><a href="bayesian-models-of-cognition.html#cb480-46" tabindex="-1"></a>  <span class="co"># Generate title based on parameter name</span></span>
<span id="cb480-47"><a href="bayesian-models-of-cognition.html#cb480-47" tabindex="-1"></a>  title <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(param_name <span class="sc">==</span> <span class="st">&quot;prior_pred_choice&quot;</span>, </span>
<span id="cb480-48"><a href="bayesian-models-of-cognition.html#cb480-48" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">&quot;Prior Predictive Check for &quot;</span>, model_name),</span>
<span id="cb480-49"><a href="bayesian-models-of-cognition.html#cb480-49" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">&quot;Posterior Predictive Check for &quot;</span>, model_name))</span>
<span id="cb480-50"><a href="bayesian-models-of-cognition.html#cb480-50" tabindex="-1"></a>  </span>
<span id="cb480-51"><a href="bayesian-models-of-cognition.html#cb480-51" tabindex="-1"></a>  <span class="co"># Create plot</span></span>
<span id="cb480-52"><a href="bayesian-models-of-cognition.html#cb480-52" tabindex="-1"></a>  <span class="fu">ggplot</span>(pred_summary, <span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> proportion, <span class="at">color =</span> <span class="fu">factor</span>(blue2), <span class="at">group =</span> blue2)) <span class="sc">+</span></span>
<span id="cb480-53"><a href="bayesian-models-of-cognition.html#cb480-53" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb480-54"><a href="bayesian-models-of-cognition.html#cb480-54" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb480-55"><a href="bayesian-models-of-cognition.html#cb480-55" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, <span class="at">fill =</span> <span class="fu">factor</span>(blue2)), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb480-56"><a href="bayesian-models-of-cognition.html#cb480-56" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb480-57"><a href="bayesian-models-of-cognition.html#cb480-57" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title,</span>
<span id="cb480-58"><a href="bayesian-models-of-cognition.html#cb480-58" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Direct Evidence (Blue Marbles)&quot;</span>,</span>
<span id="cb480-59"><a href="bayesian-models-of-cognition.html#cb480-59" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion of Choice = Blue&quot;</span>,</span>
<span id="cb480-60"><a href="bayesian-models-of-cognition.html#cb480-60" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span>,</span>
<span id="cb480-61"><a href="bayesian-models-of-cognition.html#cb480-61" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Social Evidence&quot;</span>) <span class="sc">+</span></span>
<span id="cb480-62"><a href="bayesian-models-of-cognition.html#cb480-62" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb480-63"><a href="bayesian-models-of-cognition.html#cb480-63" tabindex="-1"></a>}</span>
<span id="cb480-64"><a href="bayesian-models-of-cognition.html#cb480-64" tabindex="-1"></a></span>
<span id="cb480-65"><a href="bayesian-models-of-cognition.html#cb480-65" tabindex="-1"></a><span class="co"># Generate all plots</span></span>
<span id="cb480-66"><a href="bayesian-models-of-cognition.html#cb480-66" tabindex="-1"></a>prior_simple_balanced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_balanced, simulation_results, <span class="st">&quot;Simple Balanced&quot;</span>, <span class="st">&quot;prior_pred_choice&quot;</span>)</span>
<span id="cb480-67"><a href="bayesian-models-of-cognition.html#cb480-67" tabindex="-1"></a>prior_simple_self_focused <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_self_focused, simulation_results, <span class="st">&quot;Simple Self Focused&quot;</span>, <span class="st">&quot;prior_pred_choice&quot;</span>)</span>
<span id="cb480-68"><a href="bayesian-models-of-cognition.html#cb480-68" tabindex="-1"></a>prior_simple_socially_influenced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_socially_influenced, simulation_results, <span class="st">&quot;Simple Socially Influenced&quot;</span>, <span class="st">&quot;prior_pred_choice&quot;</span>)</span>
<span id="cb480-69"><a href="bayesian-models-of-cognition.html#cb480-69" tabindex="-1"></a></span>
<span id="cb480-70"><a href="bayesian-models-of-cognition.html#cb480-70" tabindex="-1"></a><span class="co">#prior_weighted_balanced &lt;- plot_predictive_checks(fit_weighted_balanced, simulation_results, &quot;Weighted Balanced&quot;, &quot;prior_pred_choice&quot;)</span></span>
<span id="cb480-71"><a href="bayesian-models-of-cognition.html#cb480-71" tabindex="-1"></a><span class="co">#prior_weighted_self_focused &lt;- plot_predictive_checks(fit_weighted_self_focused, simulation_results, &quot;Weighted Self Focused&quot;, &quot;prior_pred_choice&quot;)</span></span>
<span id="cb480-72"><a href="bayesian-models-of-cognition.html#cb480-72" tabindex="-1"></a><span class="co">#prior_weighted_socially_influenced &lt;- plot_predictive_checks(fit_weighted_socially_influenced, simulation_results, &quot;Weighted Socially Influenced&quot;, &quot;prior_pred_choice&quot;)</span></span>
<span id="cb480-73"><a href="bayesian-models-of-cognition.html#cb480-73" tabindex="-1"></a></span>
<span id="cb480-74"><a href="bayesian-models-of-cognition.html#cb480-74" tabindex="-1"></a>posterior_simple_balanced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_balanced, simulation_results, <span class="st">&quot;Simple Balanced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb480-75"><a href="bayesian-models-of-cognition.html#cb480-75" tabindex="-1"></a>posterior_simple_self_focused <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_self_focused, simulation_results, <span class="st">&quot;Simple Self Focused&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb480-76"><a href="bayesian-models-of-cognition.html#cb480-76" tabindex="-1"></a>posterior_simple_socially_influenced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_simple_socially_influenced, simulation_results, <span class="st">&quot;Simple Socially Influenced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb480-77"><a href="bayesian-models-of-cognition.html#cb480-77" tabindex="-1"></a></span>
<span id="cb480-78"><a href="bayesian-models-of-cognition.html#cb480-78" tabindex="-1"></a>posterior_weighted_balanced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_weighted_balanced, simulation_results, <span class="st">&quot;Weighted Balanced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb480-79"><a href="bayesian-models-of-cognition.html#cb480-79" tabindex="-1"></a>posterior_weighted_self_focused <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_weighted_self_focused, simulation_results, <span class="st">&quot;Weighted Self Focused&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb480-80"><a href="bayesian-models-of-cognition.html#cb480-80" tabindex="-1"></a>posterior_weighted_socially_influenced <span class="ot">&lt;-</span> <span class="fu">plot_predictive_checks</span>(fit_weighted_socially_influenced, simulation_results, <span class="st">&quot;Weighted Socially Influenced&quot;</span>, <span class="st">&quot;posterior_pred_choice&quot;</span>)</span>
<span id="cb480-81"><a href="bayesian-models-of-cognition.html#cb480-81" tabindex="-1"></a></span>
<span id="cb480-82"><a href="bayesian-models-of-cognition.html#cb480-82" tabindex="-1"></a><span class="co"># Arrange Prior Predictive Checks in a Grid</span></span>
<span id="cb480-83"><a href="bayesian-models-of-cognition.html#cb480-83" tabindex="-1"></a>prior_grid <span class="ot">&lt;-</span> (prior_simple_balanced <span class="sc">+</span> prior_simple_self_focused <span class="sc">+</span> prior_simple_socially_influenced) <span class="sc">+</span><span class="co">#/  (prior_weighted_balanced + prior_weighted_self_focused + prior_weighted_socially_influenced) +</span></span>
<span id="cb480-84"><a href="bayesian-models-of-cognition.html#cb480-84" tabindex="-1"></a>              <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Prior Predictive Checks&quot;</span>)</span>
<span id="cb480-85"><a href="bayesian-models-of-cognition.html#cb480-85" tabindex="-1"></a></span>
<span id="cb480-86"><a href="bayesian-models-of-cognition.html#cb480-86" tabindex="-1"></a><span class="co"># Arrange Posterior Predictive Checks in a Grid</span></span>
<span id="cb480-87"><a href="bayesian-models-of-cognition.html#cb480-87" tabindex="-1"></a>posterior_grid <span class="ot">&lt;-</span> (posterior_simple_balanced <span class="sc">+</span> posterior_simple_self_focused <span class="sc">+</span> posterior_simple_socially_influenced) <span class="sc">/</span></span>
<span id="cb480-88"><a href="bayesian-models-of-cognition.html#cb480-88" tabindex="-1"></a>                  (posterior_weighted_balanced <span class="sc">+</span> posterior_weighted_self_focused <span class="sc">+</span> posterior_weighted_socially_influenced) <span class="sc">+</span></span>
<span id="cb480-89"><a href="bayesian-models-of-cognition.html#cb480-89" tabindex="-1"></a>                  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Posterior Predictive Checks&quot;</span>)</span>
<span id="cb480-90"><a href="bayesian-models-of-cognition.html#cb480-90" tabindex="-1"></a></span>
<span id="cb480-91"><a href="bayesian-models-of-cognition.html#cb480-91" tabindex="-1"></a><span class="co"># Display the grids</span></span>
<span id="cb480-92"><a href="bayesian-models-of-cognition.html#cb480-92" tabindex="-1"></a><span class="fu">print</span>(prior_grid)</span></code></pre></div>
<p><img src="series_files/figure-html/10%20prior%20and%20posterior%20predictive%20checks%7D-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="bayesian-models-of-cognition.html#cb481-1" tabindex="-1"></a><span class="fu">print</span>(posterior_grid)</span></code></pre></div>
<p><img src="series_files/figure-html/10%20prior%20and%20posterior%20predictive%20checks%7D-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="prior-posterior-update-visualization-1" class="section level2 hasAnchor" number="11.15">
<h2><span class="header-section-number">11.15</span> Prior-Posterior Update Visualization<a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This visualization shows how our beliefs change after observing data, comparing the prior and posterior distributions for key parameters.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="bayesian-models-of-cognition.html#cb482-1" tabindex="-1"></a><span class="co"># Function to plot prior-posterior updates for reparameterized model</span></span>
<span id="cb482-2"><a href="bayesian-models-of-cognition.html#cb482-2" tabindex="-1"></a>plot_reparameterized_updates <span class="ot">&lt;-</span> <span class="cf">function</span>(fit_list, true_params_list, model_names) {</span>
<span id="cb482-3"><a href="bayesian-models-of-cognition.html#cb482-3" tabindex="-1"></a>  <span class="co"># Create dataframe for posterior values</span></span>
<span id="cb482-4"><a href="bayesian-models-of-cognition.html#cb482-4" tabindex="-1"></a>  posterior_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb482-5"><a href="bayesian-models-of-cognition.html#cb482-5" tabindex="-1"></a>  </span>
<span id="cb482-6"><a href="bayesian-models-of-cognition.html#cb482-6" tabindex="-1"></a>  <span class="co"># Process each model</span></span>
<span id="cb482-7"><a href="bayesian-models-of-cognition.html#cb482-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(fit_list)) {</span>
<span id="cb482-8"><a href="bayesian-models-of-cognition.html#cb482-8" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> fit_list[[i]]</span>
<span id="cb482-9"><a href="bayesian-models-of-cognition.html#cb482-9" tabindex="-1"></a>    model_name <span class="ot">&lt;-</span> model_names[i]</span>
<span id="cb482-10"><a href="bayesian-models-of-cognition.html#cb482-10" tabindex="-1"></a>    </span>
<span id="cb482-11"><a href="bayesian-models-of-cognition.html#cb482-11" tabindex="-1"></a>    <span class="co"># Extract posterior draws</span></span>
<span id="cb482-12"><a href="bayesian-models-of-cognition.html#cb482-12" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb482-13"><a href="bayesian-models-of-cognition.html#cb482-13" tabindex="-1"></a>    </span>
<span id="cb482-14"><a href="bayesian-models-of-cognition.html#cb482-14" tabindex="-1"></a>    <span class="co"># Check which parameterization is used (old or new)</span></span>
<span id="cb482-15"><a href="bayesian-models-of-cognition.html#cb482-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">&quot;total_weight&quot;</span>, <span class="st">&quot;weight_prop&quot;</span>) <span class="sc">%in%</span> <span class="fu">names</span>(draws_df))) {</span>
<span id="cb482-16"><a href="bayesian-models-of-cognition.html#cb482-16" tabindex="-1"></a>      <span class="co"># New parameterization - extract parameters directly</span></span>
<span id="cb482-17"><a href="bayesian-models-of-cognition.html#cb482-17" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-18"><a href="bayesian-models-of-cognition.html#cb482-18" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-19"><a href="bayesian-models-of-cognition.html#cb482-19" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;total_weight&quot;</span>,</span>
<span id="cb482-20"><a href="bayesian-models-of-cognition.html#cb482-20" tabindex="-1"></a>        <span class="at">value =</span> draws_df<span class="sc">$</span>total_weight,</span>
<span id="cb482-21"><a href="bayesian-models-of-cognition.html#cb482-21" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior&quot;</span></span>
<span id="cb482-22"><a href="bayesian-models-of-cognition.html#cb482-22" tabindex="-1"></a>      )</span>
<span id="cb482-23"><a href="bayesian-models-of-cognition.html#cb482-23" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-24"><a href="bayesian-models-of-cognition.html#cb482-24" tabindex="-1"></a>      </span>
<span id="cb482-25"><a href="bayesian-models-of-cognition.html#cb482-25" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-26"><a href="bayesian-models-of-cognition.html#cb482-26" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-27"><a href="bayesian-models-of-cognition.html#cb482-27" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;weight_prop&quot;</span>,</span>
<span id="cb482-28"><a href="bayesian-models-of-cognition.html#cb482-28" tabindex="-1"></a>        <span class="at">value =</span> draws_df<span class="sc">$</span>weight_prop,</span>
<span id="cb482-29"><a href="bayesian-models-of-cognition.html#cb482-29" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior&quot;</span></span>
<span id="cb482-30"><a href="bayesian-models-of-cognition.html#cb482-30" tabindex="-1"></a>      )</span>
<span id="cb482-31"><a href="bayesian-models-of-cognition.html#cb482-31" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-32"><a href="bayesian-models-of-cognition.html#cb482-32" tabindex="-1"></a>      </span>
<span id="cb482-33"><a href="bayesian-models-of-cognition.html#cb482-33" tabindex="-1"></a>      <span class="co"># Also calculate the derived parameters for comparison with true values</span></span>
<span id="cb482-34"><a href="bayesian-models-of-cognition.html#cb482-34" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-35"><a href="bayesian-models-of-cognition.html#cb482-35" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-36"><a href="bayesian-models-of-cognition.html#cb482-36" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;weight_direct&quot;</span>,</span>
<span id="cb482-37"><a href="bayesian-models-of-cognition.html#cb482-37" tabindex="-1"></a>        <span class="at">value =</span> draws_df<span class="sc">$</span>total_weight <span class="sc">*</span> draws_df<span class="sc">$</span>weight_prop,</span>
<span id="cb482-38"><a href="bayesian-models-of-cognition.html#cb482-38" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior (derived)&quot;</span></span>
<span id="cb482-39"><a href="bayesian-models-of-cognition.html#cb482-39" tabindex="-1"></a>      )</span>
<span id="cb482-40"><a href="bayesian-models-of-cognition.html#cb482-40" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-41"><a href="bayesian-models-of-cognition.html#cb482-41" tabindex="-1"></a>      </span>
<span id="cb482-42"><a href="bayesian-models-of-cognition.html#cb482-42" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-43"><a href="bayesian-models-of-cognition.html#cb482-43" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-44"><a href="bayesian-models-of-cognition.html#cb482-44" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;weight_social&quot;</span>,</span>
<span id="cb482-45"><a href="bayesian-models-of-cognition.html#cb482-45" tabindex="-1"></a>        <span class="at">value =</span> draws_df<span class="sc">$</span>total_weight <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> draws_df<span class="sc">$</span>weight_prop),</span>
<span id="cb482-46"><a href="bayesian-models-of-cognition.html#cb482-46" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior (derived)&quot;</span></span>
<span id="cb482-47"><a href="bayesian-models-of-cognition.html#cb482-47" tabindex="-1"></a>      )</span>
<span id="cb482-48"><a href="bayesian-models-of-cognition.html#cb482-48" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-49"><a href="bayesian-models-of-cognition.html#cb482-49" tabindex="-1"></a>      </span>
<span id="cb482-50"><a href="bayesian-models-of-cognition.html#cb482-50" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">&quot;weight_direct&quot;</span>, <span class="st">&quot;weight_social&quot;</span>) <span class="sc">%in%</span> <span class="fu">names</span>(draws_df))) {</span>
<span id="cb482-51"><a href="bayesian-models-of-cognition.html#cb482-51" tabindex="-1"></a>      <span class="co"># Old parameterization - extract and calculate equivalent new parameters</span></span>
<span id="cb482-52"><a href="bayesian-models-of-cognition.html#cb482-52" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-53"><a href="bayesian-models-of-cognition.html#cb482-53" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-54"><a href="bayesian-models-of-cognition.html#cb482-54" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;weight_direct&quot;</span>,</span>
<span id="cb482-55"><a href="bayesian-models-of-cognition.html#cb482-55" tabindex="-1"></a>        <span class="at">value =</span> draws_df<span class="sc">$</span>weight_direct,</span>
<span id="cb482-56"><a href="bayesian-models-of-cognition.html#cb482-56" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior&quot;</span></span>
<span id="cb482-57"><a href="bayesian-models-of-cognition.html#cb482-57" tabindex="-1"></a>      )</span>
<span id="cb482-58"><a href="bayesian-models-of-cognition.html#cb482-58" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-59"><a href="bayesian-models-of-cognition.html#cb482-59" tabindex="-1"></a>      </span>
<span id="cb482-60"><a href="bayesian-models-of-cognition.html#cb482-60" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-61"><a href="bayesian-models-of-cognition.html#cb482-61" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-62"><a href="bayesian-models-of-cognition.html#cb482-62" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;weight_social&quot;</span>,</span>
<span id="cb482-63"><a href="bayesian-models-of-cognition.html#cb482-63" tabindex="-1"></a>        <span class="at">value =</span> draws_df<span class="sc">$</span>weight_social,</span>
<span id="cb482-64"><a href="bayesian-models-of-cognition.html#cb482-64" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior&quot;</span></span>
<span id="cb482-65"><a href="bayesian-models-of-cognition.html#cb482-65" tabindex="-1"></a>      )</span>
<span id="cb482-66"><a href="bayesian-models-of-cognition.html#cb482-66" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-67"><a href="bayesian-models-of-cognition.html#cb482-67" tabindex="-1"></a>      </span>
<span id="cb482-68"><a href="bayesian-models-of-cognition.html#cb482-68" tabindex="-1"></a>      <span class="co"># Calculate the equivalent new parameters</span></span>
<span id="cb482-69"><a href="bayesian-models-of-cognition.html#cb482-69" tabindex="-1"></a>      total_weight <span class="ot">&lt;-</span> draws_df<span class="sc">$</span>weight_direct <span class="sc">+</span> draws_df<span class="sc">$</span>weight_social</span>
<span id="cb482-70"><a href="bayesian-models-of-cognition.html#cb482-70" tabindex="-1"></a>      weight_prop <span class="ot">&lt;-</span> draws_df<span class="sc">$</span>weight_direct <span class="sc">/</span> total_weight</span>
<span id="cb482-71"><a href="bayesian-models-of-cognition.html#cb482-71" tabindex="-1"></a>      </span>
<span id="cb482-72"><a href="bayesian-models-of-cognition.html#cb482-72" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-73"><a href="bayesian-models-of-cognition.html#cb482-73" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-74"><a href="bayesian-models-of-cognition.html#cb482-74" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;total_weight&quot;</span>,</span>
<span id="cb482-75"><a href="bayesian-models-of-cognition.html#cb482-75" tabindex="-1"></a>        <span class="at">value =</span> total_weight,</span>
<span id="cb482-76"><a href="bayesian-models-of-cognition.html#cb482-76" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior (derived)&quot;</span></span>
<span id="cb482-77"><a href="bayesian-models-of-cognition.html#cb482-77" tabindex="-1"></a>      )</span>
<span id="cb482-78"><a href="bayesian-models-of-cognition.html#cb482-78" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-79"><a href="bayesian-models-of-cognition.html#cb482-79" tabindex="-1"></a>      </span>
<span id="cb482-80"><a href="bayesian-models-of-cognition.html#cb482-80" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-81"><a href="bayesian-models-of-cognition.html#cb482-81" tabindex="-1"></a>        <span class="at">model_name =</span> model_name,</span>
<span id="cb482-82"><a href="bayesian-models-of-cognition.html#cb482-82" tabindex="-1"></a>        <span class="at">parameter =</span> <span class="st">&quot;weight_prop&quot;</span>,</span>
<span id="cb482-83"><a href="bayesian-models-of-cognition.html#cb482-83" tabindex="-1"></a>        <span class="at">value =</span> weight_prop,</span>
<span id="cb482-84"><a href="bayesian-models-of-cognition.html#cb482-84" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="st">&quot;Posterior (derived)&quot;</span></span>
<span id="cb482-85"><a href="bayesian-models-of-cognition.html#cb482-85" tabindex="-1"></a>      )</span>
<span id="cb482-86"><a href="bayesian-models-of-cognition.html#cb482-86" tabindex="-1"></a>      posterior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(posterior_df, temp_df)</span>
<span id="cb482-87"><a href="bayesian-models-of-cognition.html#cb482-87" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb482-88"><a href="bayesian-models-of-cognition.html#cb482-88" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Unknown parameterization in model&quot;</span>, model_name))</span>
<span id="cb482-89"><a href="bayesian-models-of-cognition.html#cb482-89" tabindex="-1"></a>    }</span>
<span id="cb482-90"><a href="bayesian-models-of-cognition.html#cb482-90" tabindex="-1"></a>  }</span>
<span id="cb482-91"><a href="bayesian-models-of-cognition.html#cb482-91" tabindex="-1"></a>  </span>
<span id="cb482-92"><a href="bayesian-models-of-cognition.html#cb482-92" tabindex="-1"></a>  <span class="co"># Generate prior samples based on recommended priors for new parameterization</span></span>
<span id="cb482-93"><a href="bayesian-models-of-cognition.html#cb482-93" tabindex="-1"></a>  prior_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb482-94"><a href="bayesian-models-of-cognition.html#cb482-94" tabindex="-1"></a>  </span>
<span id="cb482-95"><a href="bayesian-models-of-cognition.html#cb482-95" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(model_names)) {</span>
<span id="cb482-96"><a href="bayesian-models-of-cognition.html#cb482-96" tabindex="-1"></a>    model_name <span class="ot">&lt;-</span> model_names[i]</span>
<span id="cb482-97"><a href="bayesian-models-of-cognition.html#cb482-97" tabindex="-1"></a>    </span>
<span id="cb482-98"><a href="bayesian-models-of-cognition.html#cb482-98" tabindex="-1"></a>    <span class="co"># Number of prior samples to match posterior</span></span>
<span id="cb482-99"><a href="bayesian-models-of-cognition.html#cb482-99" tabindex="-1"></a>    n_samples <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb482-100"><a href="bayesian-models-of-cognition.html#cb482-100" tabindex="-1"></a>    </span>
<span id="cb482-101"><a href="bayesian-models-of-cognition.html#cb482-101" tabindex="-1"></a>    <span class="co"># Generate prior samples - gamma(2,1) for total_weight and beta(1,1) for weight_prop</span></span>
<span id="cb482-102"><a href="bayesian-models-of-cognition.html#cb482-102" tabindex="-1"></a>    total_weight_prior <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n_samples, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb482-103"><a href="bayesian-models-of-cognition.html#cb482-103" tabindex="-1"></a>    weight_prop_prior <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_samples, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb482-104"><a href="bayesian-models-of-cognition.html#cb482-104" tabindex="-1"></a>    </span>
<span id="cb482-105"><a href="bayesian-models-of-cognition.html#cb482-105" tabindex="-1"></a>    <span class="co"># For the new parameterization</span></span>
<span id="cb482-106"><a href="bayesian-models-of-cognition.html#cb482-106" tabindex="-1"></a>    temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-107"><a href="bayesian-models-of-cognition.html#cb482-107" tabindex="-1"></a>      <span class="at">model_name =</span> model_name,</span>
<span id="cb482-108"><a href="bayesian-models-of-cognition.html#cb482-108" tabindex="-1"></a>      <span class="at">parameter =</span> <span class="st">&quot;total_weight&quot;</span>,</span>
<span id="cb482-109"><a href="bayesian-models-of-cognition.html#cb482-109" tabindex="-1"></a>      <span class="at">value =</span> total_weight_prior,</span>
<span id="cb482-110"><a href="bayesian-models-of-cognition.html#cb482-110" tabindex="-1"></a>      <span class="at">distribution =</span> <span class="st">&quot;Prior&quot;</span></span>
<span id="cb482-111"><a href="bayesian-models-of-cognition.html#cb482-111" tabindex="-1"></a>    )</span>
<span id="cb482-112"><a href="bayesian-models-of-cognition.html#cb482-112" tabindex="-1"></a>    prior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_df, temp_df)</span>
<span id="cb482-113"><a href="bayesian-models-of-cognition.html#cb482-113" tabindex="-1"></a>    </span>
<span id="cb482-114"><a href="bayesian-models-of-cognition.html#cb482-114" tabindex="-1"></a>    temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-115"><a href="bayesian-models-of-cognition.html#cb482-115" tabindex="-1"></a>      <span class="at">model_name =</span> model_name,</span>
<span id="cb482-116"><a href="bayesian-models-of-cognition.html#cb482-116" tabindex="-1"></a>      <span class="at">parameter =</span> <span class="st">&quot;weight_prop&quot;</span>,</span>
<span id="cb482-117"><a href="bayesian-models-of-cognition.html#cb482-117" tabindex="-1"></a>      <span class="at">value =</span> weight_prop_prior,</span>
<span id="cb482-118"><a href="bayesian-models-of-cognition.html#cb482-118" tabindex="-1"></a>      <span class="at">distribution =</span> <span class="st">&quot;Prior&quot;</span></span>
<span id="cb482-119"><a href="bayesian-models-of-cognition.html#cb482-119" tabindex="-1"></a>    )</span>
<span id="cb482-120"><a href="bayesian-models-of-cognition.html#cb482-120" tabindex="-1"></a>    prior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_df, temp_df)</span>
<span id="cb482-121"><a href="bayesian-models-of-cognition.html#cb482-121" tabindex="-1"></a>    </span>
<span id="cb482-122"><a href="bayesian-models-of-cognition.html#cb482-122" tabindex="-1"></a>    <span class="co"># Calculate derived parameters for the old parameterization</span></span>
<span id="cb482-123"><a href="bayesian-models-of-cognition.html#cb482-123" tabindex="-1"></a>    weight_direct_prior <span class="ot">&lt;-</span> total_weight_prior <span class="sc">*</span> weight_prop_prior</span>
<span id="cb482-124"><a href="bayesian-models-of-cognition.html#cb482-124" tabindex="-1"></a>    weight_social_prior <span class="ot">&lt;-</span> total_weight_prior <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> weight_prop_prior)</span>
<span id="cb482-125"><a href="bayesian-models-of-cognition.html#cb482-125" tabindex="-1"></a>    </span>
<span id="cb482-126"><a href="bayesian-models-of-cognition.html#cb482-126" tabindex="-1"></a>    temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-127"><a href="bayesian-models-of-cognition.html#cb482-127" tabindex="-1"></a>      <span class="at">model_name =</span> model_name,</span>
<span id="cb482-128"><a href="bayesian-models-of-cognition.html#cb482-128" tabindex="-1"></a>      <span class="at">parameter =</span> <span class="st">&quot;weight_direct&quot;</span>,</span>
<span id="cb482-129"><a href="bayesian-models-of-cognition.html#cb482-129" tabindex="-1"></a>      <span class="at">value =</span> weight_direct_prior,</span>
<span id="cb482-130"><a href="bayesian-models-of-cognition.html#cb482-130" tabindex="-1"></a>      <span class="at">distribution =</span> <span class="st">&quot;Prior (derived)&quot;</span></span>
<span id="cb482-131"><a href="bayesian-models-of-cognition.html#cb482-131" tabindex="-1"></a>    )</span>
<span id="cb482-132"><a href="bayesian-models-of-cognition.html#cb482-132" tabindex="-1"></a>    prior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_df, temp_df)</span>
<span id="cb482-133"><a href="bayesian-models-of-cognition.html#cb482-133" tabindex="-1"></a>    </span>
<span id="cb482-134"><a href="bayesian-models-of-cognition.html#cb482-134" tabindex="-1"></a>    temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb482-135"><a href="bayesian-models-of-cognition.html#cb482-135" tabindex="-1"></a>      <span class="at">model_name =</span> model_name,</span>
<span id="cb482-136"><a href="bayesian-models-of-cognition.html#cb482-136" tabindex="-1"></a>      <span class="at">parameter =</span> <span class="st">&quot;weight_social&quot;</span>,</span>
<span id="cb482-137"><a href="bayesian-models-of-cognition.html#cb482-137" tabindex="-1"></a>      <span class="at">value =</span> weight_social_prior,</span>
<span id="cb482-138"><a href="bayesian-models-of-cognition.html#cb482-138" tabindex="-1"></a>      <span class="at">distribution =</span> <span class="st">&quot;Prior (derived)&quot;</span></span>
<span id="cb482-139"><a href="bayesian-models-of-cognition.html#cb482-139" tabindex="-1"></a>    )</span>
<span id="cb482-140"><a href="bayesian-models-of-cognition.html#cb482-140" tabindex="-1"></a>    prior_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_df, temp_df)</span>
<span id="cb482-141"><a href="bayesian-models-of-cognition.html#cb482-141" tabindex="-1"></a>  }</span>
<span id="cb482-142"><a href="bayesian-models-of-cognition.html#cb482-142" tabindex="-1"></a>  </span>
<span id="cb482-143"><a href="bayesian-models-of-cognition.html#cb482-143" tabindex="-1"></a>  <span class="co"># Combine prior and posterior</span></span>
<span id="cb482-144"><a href="bayesian-models-of-cognition.html#cb482-144" tabindex="-1"></a>  combined_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_df, posterior_df)</span>
<span id="cb482-145"><a href="bayesian-models-of-cognition.html#cb482-145" tabindex="-1"></a>  </span>
<span id="cb482-146"><a href="bayesian-models-of-cognition.html#cb482-146" tabindex="-1"></a>  <span class="co"># Convert true parameter values</span></span>
<span id="cb482-147"><a href="bayesian-models-of-cognition.html#cb482-147" tabindex="-1"></a>  true_values_df <span class="ot">&lt;-</span> <span class="fu">map2_dfr</span>(true_params_list, model_names, <span class="cf">function</span>(params, model_name) {</span>
<span id="cb482-148"><a href="bayesian-models-of-cognition.html#cb482-148" tabindex="-1"></a>    <span class="co"># Extract original parameters</span></span>
<span id="cb482-149"><a href="bayesian-models-of-cognition.html#cb482-149" tabindex="-1"></a>    weight_direct <span class="ot">&lt;-</span> params<span class="sc">$</span>weight_direct</span>
<span id="cb482-150"><a href="bayesian-models-of-cognition.html#cb482-150" tabindex="-1"></a>    weight_social <span class="ot">&lt;-</span> params<span class="sc">$</span>weight_social</span>
<span id="cb482-151"><a href="bayesian-models-of-cognition.html#cb482-151" tabindex="-1"></a>    </span>
<span id="cb482-152"><a href="bayesian-models-of-cognition.html#cb482-152" tabindex="-1"></a>    <span class="co"># Calculate new parameterization</span></span>
<span id="cb482-153"><a href="bayesian-models-of-cognition.html#cb482-153" tabindex="-1"></a>    total_weight <span class="ot">&lt;-</span> weight_direct <span class="sc">+</span> weight_social</span>
<span id="cb482-154"><a href="bayesian-models-of-cognition.html#cb482-154" tabindex="-1"></a>    weight_prop <span class="ot">&lt;-</span> weight_direct <span class="sc">/</span> total_weight</span>
<span id="cb482-155"><a href="bayesian-models-of-cognition.html#cb482-155" tabindex="-1"></a>    </span>
<span id="cb482-156"><a href="bayesian-models-of-cognition.html#cb482-156" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb482-157"><a href="bayesian-models-of-cognition.html#cb482-157" tabindex="-1"></a>      <span class="at">model_name =</span> model_name,</span>
<span id="cb482-158"><a href="bayesian-models-of-cognition.html#cb482-158" tabindex="-1"></a>      <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">&quot;weight_direct&quot;</span>, <span class="st">&quot;weight_social&quot;</span>, <span class="st">&quot;total_weight&quot;</span>, <span class="st">&quot;weight_prop&quot;</span>),</span>
<span id="cb482-159"><a href="bayesian-models-of-cognition.html#cb482-159" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">c</span>(weight_direct, weight_social, total_weight, weight_prop)</span>
<span id="cb482-160"><a href="bayesian-models-of-cognition.html#cb482-160" tabindex="-1"></a>    )</span>
<span id="cb482-161"><a href="bayesian-models-of-cognition.html#cb482-161" tabindex="-1"></a>  })</span>
<span id="cb482-162"><a href="bayesian-models-of-cognition.html#cb482-162" tabindex="-1"></a>  </span>
<span id="cb482-163"><a href="bayesian-models-of-cognition.html#cb482-163" tabindex="-1"></a>  <span class="co"># Create plots for different parameter sets</span></span>
<span id="cb482-164"><a href="bayesian-models-of-cognition.html#cb482-164" tabindex="-1"></a>  </span>
<span id="cb482-165"><a href="bayesian-models-of-cognition.html#cb482-165" tabindex="-1"></a>  <span class="co"># 1. New parameterization (total_weight and weight_prop)</span></span>
<span id="cb482-166"><a href="bayesian-models-of-cognition.html#cb482-166" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span> </span>
<span id="cb482-167"><a href="bayesian-models-of-cognition.html#cb482-167" tabindex="-1"></a>    <span class="fu">filter</span>(parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;total_weight&quot;</span>, <span class="st">&quot;weight_prop&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb482-168"><a href="bayesian-models-of-cognition.html#cb482-168" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> distribution, <span class="at">color =</span> distribution)) <span class="sc">+</span></span>
<span id="cb482-169"><a href="bayesian-models-of-cognition.html#cb482-169" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb482-170"><a href="bayesian-models-of-cognition.html#cb482-170" tabindex="-1"></a>    <span class="fu">facet_grid</span>(model_name <span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb482-171"><a href="bayesian-models-of-cognition.html#cb482-171" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E63946&quot;</span>, </span>
<span id="cb482-172"><a href="bayesian-models-of-cognition.html#cb482-172" tabindex="-1"></a>                                <span class="st">&quot;Prior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E67946&quot;</span>,</span>
<span id="cb482-173"><a href="bayesian-models-of-cognition.html#cb482-173" tabindex="-1"></a>                                <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D3557&quot;</span>, </span>
<span id="cb482-174"><a href="bayesian-models-of-cognition.html#cb482-174" tabindex="-1"></a>                                <span class="st">&quot;Posterior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D5587&quot;</span>)) <span class="sc">+</span>  </span>
<span id="cb482-175"><a href="bayesian-models-of-cognition.html#cb482-175" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E63946&quot;</span>, </span>
<span id="cb482-176"><a href="bayesian-models-of-cognition.html#cb482-176" tabindex="-1"></a>                                 <span class="st">&quot;Prior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E67946&quot;</span>, </span>
<span id="cb482-177"><a href="bayesian-models-of-cognition.html#cb482-177" tabindex="-1"></a>                                 <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D3557&quot;</span>, </span>
<span id="cb482-178"><a href="bayesian-models-of-cognition.html#cb482-178" tabindex="-1"></a>                                 <span class="st">&quot;Posterior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D5587&quot;</span>)) <span class="sc">+</span></span>
<span id="cb482-179"><a href="bayesian-models-of-cognition.html#cb482-179" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">data =</span> true_values_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;total_weight&quot;</span>, <span class="st">&quot;weight_prop&quot;</span>)),</span>
<span id="cb482-180"><a href="bayesian-models-of-cognition.html#cb482-180" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xintercept =</span> value),</span>
<span id="cb482-181"><a href="bayesian-models-of-cognition.html#cb482-181" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;#2A9D8F&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb482-182"><a href="bayesian-models-of-cognition.html#cb482-182" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Prior vs. Posterior: New Parameterization&quot;</span>,</span>
<span id="cb482-183"><a href="bayesian-models-of-cognition.html#cb482-183" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Green dashed lines indicate true parameter values&quot;</span>,</span>
<span id="cb482-184"><a href="bayesian-models-of-cognition.html#cb482-184" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Parameter Value&quot;</span>,</span>
<span id="cb482-185"><a href="bayesian-models-of-cognition.html#cb482-185" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb482-186"><a href="bayesian-models-of-cognition.html#cb482-186" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Distribution&quot;</span>,</span>
<span id="cb482-187"><a href="bayesian-models-of-cognition.html#cb482-187" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb482-188"><a href="bayesian-models-of-cognition.html#cb482-188" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb482-189"><a href="bayesian-models-of-cognition.html#cb482-189" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb482-190"><a href="bayesian-models-of-cognition.html#cb482-190" tabindex="-1"></a>  </span>
<span id="cb482-191"><a href="bayesian-models-of-cognition.html#cb482-191" tabindex="-1"></a>  <span class="co"># 2. Original parameterization (weight_direct and weight_social)</span></span>
<span id="cb482-192"><a href="bayesian-models-of-cognition.html#cb482-192" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span> </span>
<span id="cb482-193"><a href="bayesian-models-of-cognition.html#cb482-193" tabindex="-1"></a>    <span class="fu">filter</span>(parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;weight_direct&quot;</span>, <span class="st">&quot;weight_social&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb482-194"><a href="bayesian-models-of-cognition.html#cb482-194" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> distribution, <span class="at">color =</span> distribution)) <span class="sc">+</span></span>
<span id="cb482-195"><a href="bayesian-models-of-cognition.html#cb482-195" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb482-196"><a href="bayesian-models-of-cognition.html#cb482-196" tabindex="-1"></a>    <span class="fu">facet_grid</span>(model_name <span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb482-197"><a href="bayesian-models-of-cognition.html#cb482-197" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E63946&quot;</span>, </span>
<span id="cb482-198"><a href="bayesian-models-of-cognition.html#cb482-198" tabindex="-1"></a>                                <span class="st">&quot;Prior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E67946&quot;</span>,</span>
<span id="cb482-199"><a href="bayesian-models-of-cognition.html#cb482-199" tabindex="-1"></a>                                <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D3557&quot;</span>, </span>
<span id="cb482-200"><a href="bayesian-models-of-cognition.html#cb482-200" tabindex="-1"></a>                                <span class="st">&quot;Posterior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D5587&quot;</span>)) <span class="sc">+</span>  </span>
<span id="cb482-201"><a href="bayesian-models-of-cognition.html#cb482-201" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E63946&quot;</span>, </span>
<span id="cb482-202"><a href="bayesian-models-of-cognition.html#cb482-202" tabindex="-1"></a>                                 <span class="st">&quot;Prior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#E67946&quot;</span>, </span>
<span id="cb482-203"><a href="bayesian-models-of-cognition.html#cb482-203" tabindex="-1"></a>                                 <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D3557&quot;</span>, </span>
<span id="cb482-204"><a href="bayesian-models-of-cognition.html#cb482-204" tabindex="-1"></a>                                 <span class="st">&quot;Posterior (derived)&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1D5587&quot;</span>)) <span class="sc">+</span></span>
<span id="cb482-205"><a href="bayesian-models-of-cognition.html#cb482-205" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">data =</span> true_values_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;weight_direct&quot;</span>, <span class="st">&quot;weight_social&quot;</span>)),</span>
<span id="cb482-206"><a href="bayesian-models-of-cognition.html#cb482-206" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xintercept =</span> value),</span>
<span id="cb482-207"><a href="bayesian-models-of-cognition.html#cb482-207" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;#2A9D8F&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb482-208"><a href="bayesian-models-of-cognition.html#cb482-208" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Prior vs. Posterior: Original Parameterization&quot;</span>,</span>
<span id="cb482-209"><a href="bayesian-models-of-cognition.html#cb482-209" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Green dashed lines indicate true parameter values&quot;</span>,</span>
<span id="cb482-210"><a href="bayesian-models-of-cognition.html#cb482-210" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Parameter Value&quot;</span>,</span>
<span id="cb482-211"><a href="bayesian-models-of-cognition.html#cb482-211" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb482-212"><a href="bayesian-models-of-cognition.html#cb482-212" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Distribution&quot;</span>,</span>
<span id="cb482-213"><a href="bayesian-models-of-cognition.html#cb482-213" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb482-214"><a href="bayesian-models-of-cognition.html#cb482-214" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb482-215"><a href="bayesian-models-of-cognition.html#cb482-215" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb482-216"><a href="bayesian-models-of-cognition.html#cb482-216" tabindex="-1"></a>  </span>
<span id="cb482-217"><a href="bayesian-models-of-cognition.html#cb482-217" tabindex="-1"></a>  <span class="co"># Return both plots</span></span>
<span id="cb482-218"><a href="bayesian-models-of-cognition.html#cb482-218" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">new_params =</span> p1, <span class="at">old_params =</span> p2))</span>
<span id="cb482-219"><a href="bayesian-models-of-cognition.html#cb482-219" tabindex="-1"></a>}</span>
<span id="cb482-220"><a href="bayesian-models-of-cognition.html#cb482-220" tabindex="-1"></a></span>
<span id="cb482-221"><a href="bayesian-models-of-cognition.html#cb482-221" tabindex="-1"></a>fit_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb482-222"><a href="bayesian-models-of-cognition.html#cb482-222" tabindex="-1"></a>  fit_weighted_balanced,</span>
<span id="cb482-223"><a href="bayesian-models-of-cognition.html#cb482-223" tabindex="-1"></a>  fit_weighted_self_focused,</span>
<span id="cb482-224"><a href="bayesian-models-of-cognition.html#cb482-224" tabindex="-1"></a>  fit_weighted_socially_influenced</span>
<span id="cb482-225"><a href="bayesian-models-of-cognition.html#cb482-225" tabindex="-1"></a>)</span>
<span id="cb482-226"><a href="bayesian-models-of-cognition.html#cb482-226" tabindex="-1"></a></span>
<span id="cb482-227"><a href="bayesian-models-of-cognition.html#cb482-227" tabindex="-1"></a>true_params_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb482-228"><a href="bayesian-models-of-cognition.html#cb482-228" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">weight_direct =</span> <span class="dv">1</span>, <span class="at">weight_social =</span> <span class="dv">1</span>),</span>
<span id="cb482-229"><a href="bayesian-models-of-cognition.html#cb482-229" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">weight_direct =</span> <span class="fl">1.5</span>, <span class="at">weight_social =</span> <span class="fl">0.5</span>),</span>
<span id="cb482-230"><a href="bayesian-models-of-cognition.html#cb482-230" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">weight_direct =</span> <span class="fl">0.7</span>, <span class="at">weight_social =</span> <span class="dv">2</span>)</span>
<span id="cb482-231"><a href="bayesian-models-of-cognition.html#cb482-231" tabindex="-1"></a>)</span>
<span id="cb482-232"><a href="bayesian-models-of-cognition.html#cb482-232" tabindex="-1"></a></span>
<span id="cb482-233"><a href="bayesian-models-of-cognition.html#cb482-233" tabindex="-1"></a>model_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Weighted Balanced&quot;</span>, <span class="st">&quot;Weighted Self-Focused&quot;</span>, <span class="st">&quot;Weighted Socially Influenced&quot;</span>)</span>
<span id="cb482-234"><a href="bayesian-models-of-cognition.html#cb482-234" tabindex="-1"></a></span>
<span id="cb482-235"><a href="bayesian-models-of-cognition.html#cb482-235" tabindex="-1"></a><span class="co"># Generate the plots</span></span>
<span id="cb482-236"><a href="bayesian-models-of-cognition.html#cb482-236" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">plot_reparameterized_updates</span>(fit_list, true_params_list, model_names)</span>
<span id="cb482-237"><a href="bayesian-models-of-cognition.html#cb482-237" tabindex="-1"></a></span>
<span id="cb482-238"><a href="bayesian-models-of-cognition.html#cb482-238" tabindex="-1"></a><span class="co"># Display the plots</span></span>
<span id="cb482-239"><a href="bayesian-models-of-cognition.html#cb482-239" tabindex="-1"></a><span class="fu">print</span>(plots<span class="sc">$</span>new_params)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-55-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="bayesian-models-of-cognition.html#cb483-1" tabindex="-1"></a><span class="fu">print</span>(plots<span class="sc">$</span>old_params)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-55-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="bayesian-models-of-cognition.html#cb484-1" tabindex="-1"></a><span class="co"># Save the plots</span></span>
<span id="cb484-2"><a href="bayesian-models-of-cognition.html#cb484-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;prior_posterior_new_params.pdf&quot;</span>, plots<span class="sc">$</span>new_params, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb484-3"><a href="bayesian-models-of-cognition.html#cb484-3" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;prior_posterior_old_params.pdf&quot;</span>, plots<span class="sc">$</span>old_params, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="parameter-recovery-2" class="section level2 hasAnchor" number="11.16">
<h2><span class="header-section-number">11.16</span> Parameter recovery<a href="bayesian-models-of-cognition.html#parameter-recovery-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="bayesian-models-of-cognition.html#cb485-1" tabindex="-1"></a><span class="do">## Parameter recovery</span></span>
<span id="cb485-2"><a href="bayesian-models-of-cognition.html#cb485-2" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb485-3"><a href="bayesian-models-of-cognition.html#cb485-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb485-4"><a href="bayesian-models-of-cognition.html#cb485-4" tabindex="-1"></a></span>
<span id="cb485-5"><a href="bayesian-models-of-cognition.html#cb485-5" tabindex="-1"></a><span class="do">## Set up parallel processing</span></span>
<span id="cb485-6"><a href="bayesian-models-of-cognition.html#cb485-6" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(multisession, <span class="at">workers =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb485-7"><a href="bayesian-models-of-cognition.html#cb485-7" tabindex="-1"></a></span>
<span id="cb485-8"><a href="bayesian-models-of-cognition.html#cb485-8" tabindex="-1"></a><span class="co"># Define parameter grid for thorough testing</span></span>
<span id="cb485-9"><a href="bayesian-models-of-cognition.html#cb485-9" tabindex="-1"></a>weight_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, <span class="fl">1.8</span>, <span class="dv">2</span>)</span>
<span id="cb485-10"><a href="bayesian-models-of-cognition.html#cb485-10" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="co"># Number of times full combination of levels is repeated</span></span>
<span id="cb485-11"><a href="bayesian-models-of-cognition.html#cb485-11" tabindex="-1"></a></span>
<span id="cb485-12"><a href="bayesian-models-of-cognition.html#cb485-12" tabindex="-1"></a><span class="co"># Create a grid of all parameter combinations to test</span></span>
<span id="cb485-13"><a href="bayesian-models-of-cognition.html#cb485-13" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">w1 =</span> weight_values, <span class="at">w2 =</span> weight_values, <span class="at">trials =</span> n_trials)</span>
<span id="cb485-14"><a href="bayesian-models-of-cognition.html#cb485-14" tabindex="-1"></a></span>
<span id="cb485-15"><a href="bayesian-models-of-cognition.html#cb485-15" tabindex="-1"></a><span class="co"># Define evidence combinations</span></span>
<span id="cb485-16"><a href="bayesian-models-of-cognition.html#cb485-16" tabindex="-1"></a>evidence_combinations <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb485-17"><a href="bayesian-models-of-cognition.html#cb485-17" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,     <span class="co"># Direct evidence: number of blue marbles seen</span></span>
<span id="cb485-18"><a href="bayesian-models-of-cognition.html#cb485-18" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,     <span class="co"># Social evidence: strength of blue evidence</span></span>
<span id="cb485-19"><a href="bayesian-models-of-cognition.html#cb485-19" tabindex="-1"></a>  <span class="at">total1 =</span> <span class="dv">8</span>,      <span class="co"># Total marbles in direct evidence (constant)</span></span>
<span id="cb485-20"><a href="bayesian-models-of-cognition.html#cb485-20" tabindex="-1"></a>  <span class="at">total2 =</span> <span class="dv">3</span>       <span class="co"># Total strength units in social evidence (constant)</span></span>
<span id="cb485-21"><a href="bayesian-models-of-cognition.html#cb485-21" tabindex="-1"></a>)</span>
<span id="cb485-22"><a href="bayesian-models-of-cognition.html#cb485-22" tabindex="-1"></a></span>
<span id="cb485-23"><a href="bayesian-models-of-cognition.html#cb485-23" tabindex="-1"></a><span class="co"># Function to generate decisions across all evidence combinations for a given agent</span></span>
<span id="cb485-24"><a href="bayesian-models-of-cognition.html#cb485-24" tabindex="-1"></a>generate_agent_decisions <span class="ot">&lt;-</span> <span class="cf">function</span>(weight_direct, weight_social, evidence_df, <span class="at">n_samples =</span> <span class="dv">5</span>) {</span>
<span id="cb485-25"><a href="bayesian-models-of-cognition.html#cb485-25" tabindex="-1"></a>  <span class="co"># Create a data frame that repeats each evidence combination n_samples times</span></span>
<span id="cb485-26"><a href="bayesian-models-of-cognition.html#cb485-26" tabindex="-1"></a>  repeated_evidence <span class="ot">&lt;-</span> evidence_df <span class="sc">%&gt;%</span></span>
<span id="cb485-27"><a href="bayesian-models-of-cognition.html#cb485-27" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), <span class="at">each =</span> n_samples)) <span class="sc">%&gt;%</span></span>
<span id="cb485-28"><a href="bayesian-models-of-cognition.html#cb485-28" tabindex="-1"></a>    <span class="co"># Add a sample_id to distinguish between repetitions of the same combination</span></span>
<span id="cb485-29"><a href="bayesian-models-of-cognition.html#cb485-29" tabindex="-1"></a>    <span class="fu">group_by</span>(blue1, blue2, total1, total2) <span class="sc">%&gt;%</span></span>
<span id="cb485-30"><a href="bayesian-models-of-cognition.html#cb485-30" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb485-31"><a href="bayesian-models-of-cognition.html#cb485-31" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb485-32"><a href="bayesian-models-of-cognition.html#cb485-32" tabindex="-1"></a>  </span>
<span id="cb485-33"><a href="bayesian-models-of-cognition.html#cb485-33" tabindex="-1"></a>  <span class="co"># Apply our weighted Bayesian model to each evidence combination</span></span>
<span id="cb485-34"><a href="bayesian-models-of-cognition.html#cb485-34" tabindex="-1"></a>  decisions <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(repeated_evidence, <span class="cf">function</span>(blue1, blue2, total1, total2, sample_id) {</span>
<span id="cb485-35"><a href="bayesian-models-of-cognition.html#cb485-35" tabindex="-1"></a>    <span class="co"># Calculate Bayesian integration with the agent&#39;s specific weights</span></span>
<span id="cb485-36"><a href="bayesian-models-of-cognition.html#cb485-36" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">weightedBetaBinomial</span>(</span>
<span id="cb485-37"><a href="bayesian-models-of-cognition.html#cb485-37" tabindex="-1"></a>      <span class="at">alpha_prior =</span> <span class="dv">1</span>, <span class="at">beta_prior =</span> <span class="dv">1</span>,</span>
<span id="cb485-38"><a href="bayesian-models-of-cognition.html#cb485-38" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1, <span class="at">total1 =</span> total1,</span>
<span id="cb485-39"><a href="bayesian-models-of-cognition.html#cb485-39" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2, <span class="at">total2 =</span> total2,</span>
<span id="cb485-40"><a href="bayesian-models-of-cognition.html#cb485-40" tabindex="-1"></a>      <span class="at">weight_direct =</span> weight_direct,</span>
<span id="cb485-41"><a href="bayesian-models-of-cognition.html#cb485-41" tabindex="-1"></a>      <span class="at">weight_social =</span> weight_social</span>
<span id="cb485-42"><a href="bayesian-models-of-cognition.html#cb485-42" tabindex="-1"></a>    )</span>
<span id="cb485-43"><a href="bayesian-models-of-cognition.html#cb485-43" tabindex="-1"></a>    </span>
<span id="cb485-44"><a href="bayesian-models-of-cognition.html#cb485-44" tabindex="-1"></a>    <span class="co"># Return key decision metrics</span></span>
<span id="cb485-45"><a href="bayesian-models-of-cognition.html#cb485-45" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb485-46"><a href="bayesian-models-of-cognition.html#cb485-46" tabindex="-1"></a>      <span class="at">sample_id =</span> sample_id,</span>
<span id="cb485-47"><a href="bayesian-models-of-cognition.html#cb485-47" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1,</span>
<span id="cb485-48"><a href="bayesian-models-of-cognition.html#cb485-48" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2,</span>
<span id="cb485-49"><a href="bayesian-models-of-cognition.html#cb485-49" tabindex="-1"></a>      <span class="at">total1 =</span> total1,</span>
<span id="cb485-50"><a href="bayesian-models-of-cognition.html#cb485-50" tabindex="-1"></a>      <span class="at">total2 =</span> total2,</span>
<span id="cb485-51"><a href="bayesian-models-of-cognition.html#cb485-51" tabindex="-1"></a>      <span class="at">expected_rate =</span> result<span class="sc">$</span>expected_rate,   <span class="co"># Probability the next marble is blue</span></span>
<span id="cb485-52"><a href="bayesian-models-of-cognition.html#cb485-52" tabindex="-1"></a>      <span class="at">choice =</span> result<span class="sc">$</span>decision,               <span class="co"># Final decision (Blue or Red)</span></span>
<span id="cb485-53"><a href="bayesian-models-of-cognition.html#cb485-53" tabindex="-1"></a>      <span class="at">choice_binary =</span> <span class="fu">ifelse</span>(result<span class="sc">$</span>decision <span class="sc">==</span> <span class="st">&quot;Blue&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb485-54"><a href="bayesian-models-of-cognition.html#cb485-54" tabindex="-1"></a>      <span class="at">confidence =</span> result<span class="sc">$</span>confidence          <span class="co"># Confidence in decision</span></span>
<span id="cb485-55"><a href="bayesian-models-of-cognition.html#cb485-55" tabindex="-1"></a>    )</span>
<span id="cb485-56"><a href="bayesian-models-of-cognition.html#cb485-56" tabindex="-1"></a>  })</span>
<span id="cb485-57"><a href="bayesian-models-of-cognition.html#cb485-57" tabindex="-1"></a>  </span>
<span id="cb485-58"><a href="bayesian-models-of-cognition.html#cb485-58" tabindex="-1"></a>  <span class="fu">return</span>(decisions)</span>
<span id="cb485-59"><a href="bayesian-models-of-cognition.html#cb485-59" tabindex="-1"></a>}</span>
<span id="cb485-60"><a href="bayesian-models-of-cognition.html#cb485-60" tabindex="-1"></a></span>
<span id="cb485-61"><a href="bayesian-models-of-cognition.html#cb485-61" tabindex="-1"></a><span class="co"># Function to prepare Stan data</span></span>
<span id="cb485-62"><a href="bayesian-models-of-cognition.html#cb485-62" tabindex="-1"></a>prepare_stan_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb485-63"><a href="bayesian-models-of-cognition.html#cb485-63" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb485-64"><a href="bayesian-models-of-cognition.html#cb485-64" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb485-65"><a href="bayesian-models-of-cognition.html#cb485-65" tabindex="-1"></a>    <span class="at">choice =</span> df<span class="sc">$</span>choice_binary,</span>
<span id="cb485-66"><a href="bayesian-models-of-cognition.html#cb485-66" tabindex="-1"></a>    <span class="at">blue1 =</span> df<span class="sc">$</span>blue1,</span>
<span id="cb485-67"><a href="bayesian-models-of-cognition.html#cb485-67" tabindex="-1"></a>    <span class="at">total1 =</span> df<span class="sc">$</span>total1,</span>
<span id="cb485-68"><a href="bayesian-models-of-cognition.html#cb485-68" tabindex="-1"></a>    <span class="at">blue2 =</span> df<span class="sc">$</span>blue2,</span>
<span id="cb485-69"><a href="bayesian-models-of-cognition.html#cb485-69" tabindex="-1"></a>    <span class="at">total2 =</span> df<span class="sc">$</span>total2</span>
<span id="cb485-70"><a href="bayesian-models-of-cognition.html#cb485-70" tabindex="-1"></a>  )</span>
<span id="cb485-71"><a href="bayesian-models-of-cognition.html#cb485-71" tabindex="-1"></a>}</span>
<span id="cb485-72"><a href="bayesian-models-of-cognition.html#cb485-72" tabindex="-1"></a></span>
<span id="cb485-73"><a href="bayesian-models-of-cognition.html#cb485-73" tabindex="-1"></a><span class="co"># Compile the Stan model </span></span>
<span id="cb485-74"><a href="bayesian-models-of-cognition.html#cb485-74" tabindex="-1"></a>file_weighted <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10 _weighted_beta_binomial.stan&quot;</span>)</span>
<span id="cb485-75"><a href="bayesian-models-of-cognition.html#cb485-75" tabindex="-1"></a>mod_weighted <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file_weighted, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb485-76"><a href="bayesian-models-of-cognition.html#cb485-76" tabindex="-1"></a></span>
<span id="cb485-77"><a href="bayesian-models-of-cognition.html#cb485-77" tabindex="-1"></a><span class="co"># Function to fit model using cmdstanr</span></span>
<span id="cb485-78"><a href="bayesian-models-of-cognition.html#cb485-78" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb485-79"><a href="bayesian-models-of-cognition.html#cb485-79" tabindex="-1"></a>  stan_data <span class="ot">&lt;-</span> <span class="fu">prepare_stan_data</span>(data)</span>
<span id="cb485-80"><a href="bayesian-models-of-cognition.html#cb485-80" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> mod_weighted<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb485-81"><a href="bayesian-models-of-cognition.html#cb485-81" tabindex="-1"></a>    <span class="at">data =</span> stan_data,</span>
<span id="cb485-82"><a href="bayesian-models-of-cognition.html#cb485-82" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">126</span>,</span>
<span id="cb485-83"><a href="bayesian-models-of-cognition.html#cb485-83" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb485-84"><a href="bayesian-models-of-cognition.html#cb485-84" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb485-85"><a href="bayesian-models-of-cognition.html#cb485-85" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb485-86"><a href="bayesian-models-of-cognition.html#cb485-86" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb485-87"><a href="bayesian-models-of-cognition.html#cb485-87" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb485-88"><a href="bayesian-models-of-cognition.html#cb485-88" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb485-89"><a href="bayesian-models-of-cognition.html#cb485-89" tabindex="-1"></a>  )</span>
<span id="cb485-90"><a href="bayesian-models-of-cognition.html#cb485-90" tabindex="-1"></a>  <span class="fu">return</span>(fit)</span>
<span id="cb485-91"><a href="bayesian-models-of-cognition.html#cb485-91" tabindex="-1"></a>}</span>
<span id="cb485-92"><a href="bayesian-models-of-cognition.html#cb485-92" tabindex="-1"></a></span>
<span id="cb485-93"><a href="bayesian-models-of-cognition.html#cb485-93" tabindex="-1"></a><span class="co"># Run simulations and model fitting in parallel</span></span>
<span id="cb485-94"><a href="bayesian-models-of-cognition.html#cb485-94" tabindex="-1"></a>results <span class="ot">&lt;-</span> param_grid <span class="sc">%&gt;%</span></span>
<span id="cb485-95"><a href="bayesian-models-of-cognition.html#cb485-95" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb485-96"><a href="bayesian-models-of-cognition.html#cb485-96" tabindex="-1"></a>    <span class="co"># Generate synthetic data for each parameter combination</span></span>
<span id="cb485-97"><a href="bayesian-models-of-cognition.html#cb485-97" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">future_pmap</span>(<span class="fu">list</span>(w1, w2, trials), <span class="cf">function</span>(w1, w2, t) {</span>
<span id="cb485-98"><a href="bayesian-models-of-cognition.html#cb485-98" tabindex="-1"></a>      <span class="fu">generate_agent_decisions</span>(w1, w2, evidence_combinations, t)</span>
<span id="cb485-99"><a href="bayesian-models-of-cognition.html#cb485-99" tabindex="-1"></a>    }, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb485-100"><a href="bayesian-models-of-cognition.html#cb485-100" tabindex="-1"></a>    </span>
<span id="cb485-101"><a href="bayesian-models-of-cognition.html#cb485-101" tabindex="-1"></a>    <span class="co"># Fit model to each dataset</span></span>
<span id="cb485-102"><a href="bayesian-models-of-cognition.html#cb485-102" tabindex="-1"></a>    <span class="at">fit =</span> <span class="fu">future_map</span>(data, fit_model, <span class="at">.progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb485-103"><a href="bayesian-models-of-cognition.html#cb485-103" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.4 seconds.
## Chain 2 finished in 1.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.3 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 1.0 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.2 seconds.
## Chain 2 finished in 1.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.2 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.4 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.2 seconds.
## Chain 2 finished in 1.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.3 seconds.
## Total execution time: 1.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.2 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.6 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.4 seconds.
## Chain 1 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 1.0 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 1.0 seconds.
## Chain 1 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.6 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.4 seconds.
## Chain 2 finished in 1.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.4 seconds.
## Total execution time: 1.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 1.0 seconds.
## Chain 1 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 1.0 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.4 seconds.
## Chain 1 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.6 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 1.0 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.3 seconds.
## Chain 1 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.6 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.4 seconds.
## Chain 1 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.2 seconds.
## Chain 1 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.4 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.3 seconds.
## Chain 2 finished in 1.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.2 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.9 seconds.
## Chain 1 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.6 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.1 seconds.
## Chain 2 finished in 1.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.1 seconds.
## Total execution time: 1.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.8 seconds.</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.7 seconds.
## Chain 1 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.3 seconds.
## Chain 2 finished in 1.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.3 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 1.0 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.2 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 1.1 seconds.
## Chain 1 finished in 1.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.2 seconds.
## Total execution time: 1.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 1.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.0 seconds.
## Total execution time: 1.1 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.6 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.9 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.5 seconds.
## Chain 1 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.3 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.3 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.3 seconds.
## Total execution time: 0.5 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.6 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.6 seconds.
## Total execution time: 0.7 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.9 seconds.
## Chain 2 finished in 0.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.9 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 2 finished in 0.8 seconds.
## Chain 1 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 1.0 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.2 seconds.
## Chain 2 finished in 0.2 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.2 seconds.
## Total execution time: 0.4 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.4 seconds.
## Chain 2 finished in 0.4 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.4 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.5 seconds.
## Chain 2 finished in 0.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.5 seconds.
## Total execution time: 0.6 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.7 seconds.
## Chain 2 finished in 0.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.7 seconds.
## Total execution time: 0.8 seconds.
## 
## Running MCMC with 2 parallel chains, with 1 thread(s) per chain...
## 
## Chain 1 finished in 0.8 seconds.
## Chain 2 finished in 0.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.8 seconds.
## Total execution time: 0.9 seconds.</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="bayesian-models-of-cognition.html#cb494-1" tabindex="-1"></a><span class="co"># Extract both old and new parameterization results</span></span>
<span id="cb494-2"><a href="bayesian-models-of-cognition.html#cb494-2" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb494-3"><a href="bayesian-models-of-cognition.html#cb494-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb494-4"><a href="bayesian-models-of-cognition.html#cb494-4" tabindex="-1"></a>    <span class="co"># First extract parameters in the new parameterization</span></span>
<span id="cb494-5"><a href="bayesian-models-of-cognition.html#cb494-5" tabindex="-1"></a>    <span class="at">total_weight_est =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>total_weight)),</span>
<span id="cb494-6"><a href="bayesian-models-of-cognition.html#cb494-6" tabindex="-1"></a>    <span class="at">weight_prop_est =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>weight_prop)),</span>
<span id="cb494-7"><a href="bayesian-models-of-cognition.html#cb494-7" tabindex="-1"></a>    </span>
<span id="cb494-8"><a href="bayesian-models-of-cognition.html#cb494-8" tabindex="-1"></a>    <span class="co"># Calculate the traditional parameters from the new parameterization</span></span>
<span id="cb494-9"><a href="bayesian-models-of-cognition.html#cb494-9" tabindex="-1"></a>    <span class="at">weight_direct_est =</span> total_weight_est <span class="sc">*</span> weight_prop_est,</span>
<span id="cb494-10"><a href="bayesian-models-of-cognition.html#cb494-10" tabindex="-1"></a>    <span class="at">weight_social_est =</span> total_weight_est <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> weight_prop_est),</span>
<span id="cb494-11"><a href="bayesian-models-of-cognition.html#cb494-11" tabindex="-1"></a>    </span>
<span id="cb494-12"><a href="bayesian-models-of-cognition.html#cb494-12" tabindex="-1"></a>    <span class="co"># Calculate the true parameters in the new parameterization </span></span>
<span id="cb494-13"><a href="bayesian-models-of-cognition.html#cb494-13" tabindex="-1"></a>    <span class="at">true_total_weight =</span> w1 <span class="sc">+</span> w2,</span>
<span id="cb494-14"><a href="bayesian-models-of-cognition.html#cb494-14" tabindex="-1"></a>    <span class="at">true_weight_prop =</span> w1 <span class="sc">/</span> (w1 <span class="sc">+</span> w2),</span>
<span id="cb494-15"><a href="bayesian-models-of-cognition.html#cb494-15" tabindex="-1"></a>    </span>
<span id="cb494-16"><a href="bayesian-models-of-cognition.html#cb494-16" tabindex="-1"></a>    <span class="co"># Also extract uncertainty estimates</span></span>
<span id="cb494-17"><a href="bayesian-models-of-cognition.html#cb494-17" tabindex="-1"></a>    <span class="at">total_weight_sd =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">sd</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>total_weight)),</span>
<span id="cb494-18"><a href="bayesian-models-of-cognition.html#cb494-18" tabindex="-1"></a>    <span class="at">weight_prop_sd =</span> <span class="fu">map_dbl</span>(fit, <span class="sc">~</span><span class="fu">sd</span>(<span class="fu">as_draws_df</span>(.x<span class="sc">$</span><span class="fu">draws</span>())<span class="sc">$</span>weight_prop)),</span>
<span id="cb494-19"><a href="bayesian-models-of-cognition.html#cb494-19" tabindex="-1"></a>    <span class="at">weight_direct_sd =</span> <span class="fu">map_dbl</span>(fit, <span class="cf">function</span>(x) {</span>
<span id="cb494-20"><a href="bayesian-models-of-cognition.html#cb494-20" tabindex="-1"></a>      draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb494-21"><a href="bayesian-models-of-cognition.html#cb494-21" tabindex="-1"></a>      <span class="fu">sd</span>(draws<span class="sc">$</span>total_weight <span class="sc">*</span> draws<span class="sc">$</span>weight_prop)</span>
<span id="cb494-22"><a href="bayesian-models-of-cognition.html#cb494-22" tabindex="-1"></a>    }),</span>
<span id="cb494-23"><a href="bayesian-models-of-cognition.html#cb494-23" tabindex="-1"></a>    <span class="at">weight_social_sd =</span> <span class="fu">map_dbl</span>(fit, <span class="cf">function</span>(x) {</span>
<span id="cb494-24"><a href="bayesian-models-of-cognition.html#cb494-24" tabindex="-1"></a>      draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb494-25"><a href="bayesian-models-of-cognition.html#cb494-25" tabindex="-1"></a>      <span class="fu">sd</span>(draws<span class="sc">$</span>total_weight <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> draws<span class="sc">$</span>weight_prop))</span>
<span id="cb494-26"><a href="bayesian-models-of-cognition.html#cb494-26" tabindex="-1"></a>    })</span>
<span id="cb494-27"><a href="bayesian-models-of-cognition.html#cb494-27" tabindex="-1"></a>  )</span>
<span id="cb494-28"><a href="bayesian-models-of-cognition.html#cb494-28" tabindex="-1"></a></span>
<span id="cb494-29"><a href="bayesian-models-of-cognition.html#cb494-29" tabindex="-1"></a><span class="co"># Create functions to visualize parameter recovery for both parameterizations</span></span>
<span id="cb494-30"><a href="bayesian-models-of-cognition.html#cb494-30" tabindex="-1"></a>plot_recovery_original <span class="ot">&lt;-</span> <span class="cf">function</span>(results_df) {</span>
<span id="cb494-31"><a href="bayesian-models-of-cognition.html#cb494-31" tabindex="-1"></a>  <span class="co"># Visualize direct weight recovery</span></span>
<span id="cb494-32"><a href="bayesian-models-of-cognition.html#cb494-32" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> results_df <span class="sc">%&gt;%</span></span>
<span id="cb494-33"><a href="bayesian-models-of-cognition.html#cb494-33" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> w1, <span class="at">y =</span> weight_direct_est, <span class="at">color =</span> <span class="fu">factor</span>(trials))) <span class="sc">+</span></span>
<span id="cb494-34"><a href="bayesian-models-of-cognition.html#cb494-34" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb494-35"><a href="bayesian-models-of-cognition.html#cb494-35" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> weight_direct_est <span class="sc">-</span> weight_direct_sd, </span>
<span id="cb494-36"><a href="bayesian-models-of-cognition.html#cb494-36" tabindex="-1"></a>                      <span class="at">ymax =</span> weight_direct_est <span class="sc">+</span> weight_direct_sd), </span>
<span id="cb494-37"><a href="bayesian-models-of-cognition.html#cb494-37" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb494-38"><a href="bayesian-models-of-cognition.html#cb494-38" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-39"><a href="bayesian-models-of-cognition.html#cb494-39" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> w2, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">w2 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Social Weight =&quot;</span>, x))) <span class="sc">+</span></span>
<span id="cb494-40"><a href="bayesian-models-of-cognition.html#cb494-40" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Direct Weight Parameter Recovery&quot;</span>, </span>
<span id="cb494-41"><a href="bayesian-models-of-cognition.html#cb494-41" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;True Direct Weight&quot;</span>, </span>
<span id="cb494-42"><a href="bayesian-models-of-cognition.html#cb494-42" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Estimated Direct Weight&quot;</span>,</span>
<span id="cb494-43"><a href="bayesian-models-of-cognition.html#cb494-43" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Number of</span><span class="sc">\n</span><span class="st">Trials per</span><span class="sc">\n</span><span class="st">Condition&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-44"><a href="bayesian-models-of-cognition.html#cb494-44" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb494-45"><a href="bayesian-models-of-cognition.html#cb494-45" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb494-46"><a href="bayesian-models-of-cognition.html#cb494-46" tabindex="-1"></a></span>
<span id="cb494-47"><a href="bayesian-models-of-cognition.html#cb494-47" tabindex="-1"></a>  <span class="co"># Visualize social weight recovery</span></span>
<span id="cb494-48"><a href="bayesian-models-of-cognition.html#cb494-48" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> results_df <span class="sc">%&gt;%</span></span>
<span id="cb494-49"><a href="bayesian-models-of-cognition.html#cb494-49" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> w2, <span class="at">y =</span> weight_social_est, <span class="at">color =</span> <span class="fu">factor</span>(trials))) <span class="sc">+</span></span>
<span id="cb494-50"><a href="bayesian-models-of-cognition.html#cb494-50" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb494-51"><a href="bayesian-models-of-cognition.html#cb494-51" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> weight_social_est <span class="sc">-</span> weight_social_sd, </span>
<span id="cb494-52"><a href="bayesian-models-of-cognition.html#cb494-52" tabindex="-1"></a>                      <span class="at">ymax =</span> weight_social_est <span class="sc">+</span> weight_social_sd), </span>
<span id="cb494-53"><a href="bayesian-models-of-cognition.html#cb494-53" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb494-54"><a href="bayesian-models-of-cognition.html#cb494-54" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-55"><a href="bayesian-models-of-cognition.html#cb494-55" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> w1, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">w1 =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Direct Weight =&quot;</span>, x))) <span class="sc">+</span></span>
<span id="cb494-56"><a href="bayesian-models-of-cognition.html#cb494-56" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Social Weight Parameter Recovery&quot;</span>, </span>
<span id="cb494-57"><a href="bayesian-models-of-cognition.html#cb494-57" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;True Social Weight&quot;</span>, </span>
<span id="cb494-58"><a href="bayesian-models-of-cognition.html#cb494-58" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Estimated Social Weight&quot;</span>,</span>
<span id="cb494-59"><a href="bayesian-models-of-cognition.html#cb494-59" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Number of</span><span class="sc">\n</span><span class="st">Trials per</span><span class="sc">\n</span><span class="st">Condition&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-60"><a href="bayesian-models-of-cognition.html#cb494-60" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb494-61"><a href="bayesian-models-of-cognition.html#cb494-61" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb494-62"><a href="bayesian-models-of-cognition.html#cb494-62" tabindex="-1"></a>    </span>
<span id="cb494-63"><a href="bayesian-models-of-cognition.html#cb494-63" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">direct =</span> p1, <span class="at">social =</span> p2))</span>
<span id="cb494-64"><a href="bayesian-models-of-cognition.html#cb494-64" tabindex="-1"></a>}</span>
<span id="cb494-65"><a href="bayesian-models-of-cognition.html#cb494-65" tabindex="-1"></a></span>
<span id="cb494-66"><a href="bayesian-models-of-cognition.html#cb494-66" tabindex="-1"></a>plot_recovery_new <span class="ot">&lt;-</span> <span class="cf">function</span>(results_df) {</span>
<span id="cb494-67"><a href="bayesian-models-of-cognition.html#cb494-67" tabindex="-1"></a>  <span class="co"># Visualize total weight recovery</span></span>
<span id="cb494-68"><a href="bayesian-models-of-cognition.html#cb494-68" tabindex="-1"></a>  <span class="co"># First, create discrete categories for weight proportion to avoid using continuous variable in facet_wrap</span></span>
<span id="cb494-69"><a href="bayesian-models-of-cognition.html#cb494-69" tabindex="-1"></a>  results_with_categories <span class="ot">&lt;-</span> results_df <span class="sc">%&gt;%</span></span>
<span id="cb494-70"><a href="bayesian-models-of-cognition.html#cb494-70" tabindex="-1"></a>    <span class="fu">filter</span>(true_total_weight <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co"># Avoid division by zero issues</span></span>
<span id="cb494-71"><a href="bayesian-models-of-cognition.html#cb494-71" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">weight_prop_cat =</span> <span class="fu">cut</span>(true_weight_prop, </span>
<span id="cb494-72"><a href="bayesian-models-of-cognition.html#cb494-72" tabindex="-1"></a>                               <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>),</span>
<span id="cb494-73"><a href="bayesian-models-of-cognition.html#cb494-73" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0-0.25&quot;</span>, <span class="st">&quot;0.25-0.5&quot;</span>, <span class="st">&quot;0.5-0.75&quot;</span>, <span class="st">&quot;0.75-1.0&quot;</span>),</span>
<span id="cb494-74"><a href="bayesian-models-of-cognition.html#cb494-74" tabindex="-1"></a>                               <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb494-75"><a href="bayesian-models-of-cognition.html#cb494-75" tabindex="-1"></a>  </span>
<span id="cb494-76"><a href="bayesian-models-of-cognition.html#cb494-76" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> results_with_categories <span class="sc">%&gt;%</span></span>
<span id="cb494-77"><a href="bayesian-models-of-cognition.html#cb494-77" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> true_total_weight, <span class="at">y =</span> total_weight_est, <span class="at">color =</span> <span class="fu">factor</span>(trials))) <span class="sc">+</span></span>
<span id="cb494-78"><a href="bayesian-models-of-cognition.html#cb494-78" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb494-79"><a href="bayesian-models-of-cognition.html#cb494-79" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> total_weight_est <span class="sc">-</span> total_weight_sd, </span>
<span id="cb494-80"><a href="bayesian-models-of-cognition.html#cb494-80" tabindex="-1"></a>                      <span class="at">ymax =</span> total_weight_est <span class="sc">+</span> total_weight_sd), </span>
<span id="cb494-81"><a href="bayesian-models-of-cognition.html#cb494-81" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb494-82"><a href="bayesian-models-of-cognition.html#cb494-82" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-83"><a href="bayesian-models-of-cognition.html#cb494-83" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> weight_prop_cat, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb494-84"><a href="bayesian-models-of-cognition.html#cb494-84" tabindex="-1"></a>      <span class="at">weight_prop_cat =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Weight Proportion =&quot;</span>, x)</span>
<span id="cb494-85"><a href="bayesian-models-of-cognition.html#cb494-85" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb494-86"><a href="bayesian-models-of-cognition.html#cb494-86" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total Weight Parameter Recovery&quot;</span>, </span>
<span id="cb494-87"><a href="bayesian-models-of-cognition.html#cb494-87" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;True Total Weight&quot;</span>, </span>
<span id="cb494-88"><a href="bayesian-models-of-cognition.html#cb494-88" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Estimated Total Weight&quot;</span>,</span>
<span id="cb494-89"><a href="bayesian-models-of-cognition.html#cb494-89" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Number of</span><span class="sc">\n</span><span class="st">Trials per</span><span class="sc">\n</span><span class="st">Condition&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-90"><a href="bayesian-models-of-cognition.html#cb494-90" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb494-91"><a href="bayesian-models-of-cognition.html#cb494-91" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb494-92"><a href="bayesian-models-of-cognition.html#cb494-92" tabindex="-1"></a></span>
<span id="cb494-93"><a href="bayesian-models-of-cognition.html#cb494-93" tabindex="-1"></a>  <span class="co"># Visualize weight proportion recovery</span></span>
<span id="cb494-94"><a href="bayesian-models-of-cognition.html#cb494-94" tabindex="-1"></a>  <span class="co"># Create discrete categories for total weight</span></span>
<span id="cb494-95"><a href="bayesian-models-of-cognition.html#cb494-95" tabindex="-1"></a>  results_with_categories <span class="ot">&lt;-</span> results_df <span class="sc">%&gt;%</span></span>
<span id="cb494-96"><a href="bayesian-models-of-cognition.html#cb494-96" tabindex="-1"></a>    <span class="fu">filter</span>(true_total_weight <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co"># Avoid division by zero issues</span></span>
<span id="cb494-97"><a href="bayesian-models-of-cognition.html#cb494-97" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total_weight_cat =</span> <span class="fu">cut</span>(true_total_weight, </span>
<span id="cb494-98"><a href="bayesian-models-of-cognition.html#cb494-98" tabindex="-1"></a>                                <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>),</span>
<span id="cb494-99"><a href="bayesian-models-of-cognition.html#cb494-99" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0-0.5&quot;</span>, <span class="st">&quot;0.5-1.0&quot;</span>, <span class="st">&quot;1.0-1.5&quot;</span>, <span class="st">&quot;1.5-2.0&quot;</span>),</span>
<span id="cb494-100"><a href="bayesian-models-of-cognition.html#cb494-100" tabindex="-1"></a>                                <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb494-101"><a href="bayesian-models-of-cognition.html#cb494-101" tabindex="-1"></a>  </span>
<span id="cb494-102"><a href="bayesian-models-of-cognition.html#cb494-102" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> results_with_categories <span class="sc">%&gt;%</span></span>
<span id="cb494-103"><a href="bayesian-models-of-cognition.html#cb494-103" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> true_weight_prop, <span class="at">y =</span> weight_prop_est, <span class="at">color =</span> <span class="fu">factor</span>(trials))) <span class="sc">+</span></span>
<span id="cb494-104"><a href="bayesian-models-of-cognition.html#cb494-104" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb494-105"><a href="bayesian-models-of-cognition.html#cb494-105" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> weight_prop_est <span class="sc">-</span> weight_prop_sd, </span>
<span id="cb494-106"><a href="bayesian-models-of-cognition.html#cb494-106" tabindex="-1"></a>                      <span class="at">ymax =</span> weight_prop_est <span class="sc">+</span> weight_prop_sd), </span>
<span id="cb494-107"><a href="bayesian-models-of-cognition.html#cb494-107" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb494-108"><a href="bayesian-models-of-cognition.html#cb494-108" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-109"><a href="bayesian-models-of-cognition.html#cb494-109" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> total_weight_cat, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb494-110"><a href="bayesian-models-of-cognition.html#cb494-110" tabindex="-1"></a>      <span class="at">total_weight_cat =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Total Weight =&quot;</span>, x)</span>
<span id="cb494-111"><a href="bayesian-models-of-cognition.html#cb494-111" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb494-112"><a href="bayesian-models-of-cognition.html#cb494-112" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Weight Proportion Parameter Recovery&quot;</span>, </span>
<span id="cb494-113"><a href="bayesian-models-of-cognition.html#cb494-113" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;True Weight Proportion&quot;</span>, </span>
<span id="cb494-114"><a href="bayesian-models-of-cognition.html#cb494-114" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Estimated Weight Proportion&quot;</span>,</span>
<span id="cb494-115"><a href="bayesian-models-of-cognition.html#cb494-115" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Number of</span><span class="sc">\n</span><span class="st">Trials per</span><span class="sc">\n</span><span class="st">Condition&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-116"><a href="bayesian-models-of-cognition.html#cb494-116" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb494-117"><a href="bayesian-models-of-cognition.html#cb494-117" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb494-118"><a href="bayesian-models-of-cognition.html#cb494-118" tabindex="-1"></a>    </span>
<span id="cb494-119"><a href="bayesian-models-of-cognition.html#cb494-119" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">total =</span> p1, <span class="at">prop =</span> p2))</span>
<span id="cb494-120"><a href="bayesian-models-of-cognition.html#cb494-120" tabindex="-1"></a>}</span>
<span id="cb494-121"><a href="bayesian-models-of-cognition.html#cb494-121" tabindex="-1"></a></span>
<span id="cb494-122"><a href="bayesian-models-of-cognition.html#cb494-122" tabindex="-1"></a><span class="co"># Generate plots</span></span>
<span id="cb494-123"><a href="bayesian-models-of-cognition.html#cb494-123" tabindex="-1"></a>original_recovery_plots <span class="ot">&lt;-</span> <span class="fu">plot_recovery_original</span>(results)</span>
<span id="cb494-124"><a href="bayesian-models-of-cognition.html#cb494-124" tabindex="-1"></a>new_recovery_plots <span class="ot">&lt;-</span> <span class="fu">plot_recovery_new</span>(results)</span>
<span id="cb494-125"><a href="bayesian-models-of-cognition.html#cb494-125" tabindex="-1"></a></span>
<span id="cb494-126"><a href="bayesian-models-of-cognition.html#cb494-126" tabindex="-1"></a><span class="co"># Display plots for new parameterization</span></span>
<span id="cb494-127"><a href="bayesian-models-of-cognition.html#cb494-127" tabindex="-1"></a>new_recovery_plots<span class="sc">$</span>total</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-56-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="bayesian-models-of-cognition.html#cb495-1" tabindex="-1"></a>new_recovery_plots<span class="sc">$</span>prop</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-56-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="bayesian-models-of-cognition.html#cb496-1" tabindex="-1"></a><span class="co"># Display plots for original parameterization</span></span>
<span id="cb496-2"><a href="bayesian-models-of-cognition.html#cb496-2" tabindex="-1"></a>original_recovery_plots<span class="sc">$</span>direct</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-56-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="bayesian-models-of-cognition.html#cb497-1" tabindex="-1"></a>original_recovery_plots<span class="sc">$</span>social</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-56-4.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="bayesian-models-of-cognition.html#cb498-1" tabindex="-1"></a><span class="co"># Analysis of recovery quality by parameter combination</span></span>
<span id="cb498-2"><a href="bayesian-models-of-cognition.html#cb498-2" tabindex="-1"></a>recovery_summary <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb498-3"><a href="bayesian-models-of-cognition.html#cb498-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb498-4"><a href="bayesian-models-of-cognition.html#cb498-4" tabindex="-1"></a>    <span class="co"># Calculate error metrics for original parameterization</span></span>
<span id="cb498-5"><a href="bayesian-models-of-cognition.html#cb498-5" tabindex="-1"></a>    <span class="at">error_direct =</span> <span class="fu">abs</span>(weight_direct_est <span class="sc">-</span> w1),</span>
<span id="cb498-6"><a href="bayesian-models-of-cognition.html#cb498-6" tabindex="-1"></a>    <span class="at">error_social =</span> <span class="fu">abs</span>(weight_social_est <span class="sc">-</span> w2),</span>
<span id="cb498-7"><a href="bayesian-models-of-cognition.html#cb498-7" tabindex="-1"></a>    <span class="at">rel_error_direct =</span> <span class="fu">ifelse</span>(w1 <span class="sc">&gt;</span> <span class="dv">0</span>, error_direct <span class="sc">/</span> w1, <span class="cn">NA</span>),</span>
<span id="cb498-8"><a href="bayesian-models-of-cognition.html#cb498-8" tabindex="-1"></a>    <span class="at">rel_error_social =</span> <span class="fu">ifelse</span>(w2 <span class="sc">&gt;</span> <span class="dv">0</span>, error_social <span class="sc">/</span> w2, <span class="cn">NA</span>),</span>
<span id="cb498-9"><a href="bayesian-models-of-cognition.html#cb498-9" tabindex="-1"></a>    </span>
<span id="cb498-10"><a href="bayesian-models-of-cognition.html#cb498-10" tabindex="-1"></a>    <span class="co"># Calculate error metrics for new parameterization</span></span>
<span id="cb498-11"><a href="bayesian-models-of-cognition.html#cb498-11" tabindex="-1"></a>    <span class="at">error_total =</span> <span class="fu">abs</span>(total_weight_est <span class="sc">-</span> true_total_weight),</span>
<span id="cb498-12"><a href="bayesian-models-of-cognition.html#cb498-12" tabindex="-1"></a>    <span class="at">error_prop =</span> <span class="fu">abs</span>(weight_prop_est <span class="sc">-</span> true_weight_prop),</span>
<span id="cb498-13"><a href="bayesian-models-of-cognition.html#cb498-13" tabindex="-1"></a>    <span class="at">rel_error_total =</span> <span class="fu">ifelse</span>(true_total_weight <span class="sc">&gt;</span> <span class="dv">0</span>, error_total <span class="sc">/</span> true_total_weight, <span class="cn">NA</span>),</span>
<span id="cb498-14"><a href="bayesian-models-of-cognition.html#cb498-14" tabindex="-1"></a>    <span class="at">rel_error_prop =</span> <span class="fu">ifelse</span>(true_weight_prop <span class="sc">&gt;</span> <span class="dv">0</span>, error_prop <span class="sc">/</span> true_weight_prop, <span class="cn">NA</span>)</span>
<span id="cb498-15"><a href="bayesian-models-of-cognition.html#cb498-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb498-16"><a href="bayesian-models-of-cognition.html#cb498-16" tabindex="-1"></a>  <span class="fu">group_by</span>(trials) <span class="sc">%&gt;%</span></span>
<span id="cb498-17"><a href="bayesian-models-of-cognition.html#cb498-17" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb498-18"><a href="bayesian-models-of-cognition.html#cb498-18" tabindex="-1"></a>    <span class="at">mean_error_direct =</span> <span class="fu">mean</span>(error_direct, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-19"><a href="bayesian-models-of-cognition.html#cb498-19" tabindex="-1"></a>    <span class="at">mean_error_social =</span> <span class="fu">mean</span>(error_social, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-20"><a href="bayesian-models-of-cognition.html#cb498-20" tabindex="-1"></a>    <span class="at">mean_rel_error_direct =</span> <span class="fu">mean</span>(rel_error_direct, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-21"><a href="bayesian-models-of-cognition.html#cb498-21" tabindex="-1"></a>    <span class="at">mean_rel_error_social =</span> <span class="fu">mean</span>(rel_error_social, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-22"><a href="bayesian-models-of-cognition.html#cb498-22" tabindex="-1"></a>    <span class="at">mean_error_total =</span> <span class="fu">mean</span>(error_total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-23"><a href="bayesian-models-of-cognition.html#cb498-23" tabindex="-1"></a>    <span class="at">mean_error_prop =</span> <span class="fu">mean</span>(error_prop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-24"><a href="bayesian-models-of-cognition.html#cb498-24" tabindex="-1"></a>    <span class="at">mean_rel_error_total =</span> <span class="fu">mean</span>(rel_error_total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-25"><a href="bayesian-models-of-cognition.html#cb498-25" tabindex="-1"></a>    <span class="at">mean_rel_error_prop =</span> <span class="fu">mean</span>(rel_error_prop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb498-26"><a href="bayesian-models-of-cognition.html#cb498-26" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb498-27"><a href="bayesian-models-of-cognition.html#cb498-27" tabindex="-1"></a>  )</span>
<span id="cb498-28"><a href="bayesian-models-of-cognition.html#cb498-28" tabindex="-1"></a></span>
<span id="cb498-29"><a href="bayesian-models-of-cognition.html#cb498-29" tabindex="-1"></a><span class="co"># Display summary table</span></span>
<span id="cb498-30"><a href="bayesian-models-of-cognition.html#cb498-30" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(recovery_summary, </span>
<span id="cb498-31"><a href="bayesian-models-of-cognition.html#cb498-31" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb498-32"><a href="bayesian-models-of-cognition.html#cb498-32" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Parameter Recovery Quality by Number of Trials&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-56">Table 11.1: </span>Parameter Recovery Quality by Number of Trials</caption>
<colgroup>
<col width="4%" />
<col width="11%" />
<col width="11%" />
<col width="13%" />
<col width="13%" />
<col width="10%" />
<col width="9%" />
<col width="13%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">trials</th>
<th align="right">mean_error_direct</th>
<th align="right">mean_error_social</th>
<th align="right">mean_rel_error_direct</th>
<th align="right">mean_rel_error_social</th>
<th align="right">mean_error_total</th>
<th align="right">mean_error_prop</th>
<th align="right">mean_rel_error_total</th>
<th align="right">mean_rel_error_prop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.436</td>
<td align="right">0.560</td>
<td align="right">0.652</td>
<td align="right">0.833</td>
<td align="right">0.784</td>
<td align="right">0.151</td>
<td align="right">0.774</td>
<td align="right">0.339</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.431</td>
<td align="right">0.524</td>
<td align="right">0.742</td>
<td align="right">0.742</td>
<td align="right">0.795</td>
<td align="right">0.126</td>
<td align="right">0.768</td>
<td align="right">0.315</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.404</td>
<td align="right">0.487</td>
<td align="right">0.627</td>
<td align="right">0.740</td>
<td align="right">0.780</td>
<td align="right">0.102</td>
<td align="right">0.764</td>
<td align="right">0.211</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.389</td>
<td align="right">0.442</td>
<td align="right">0.611</td>
<td align="right">0.736</td>
<td align="right">0.740</td>
<td align="right">0.097</td>
<td align="right">0.719</td>
<td align="right">0.208</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.350</td>
<td align="right">0.451</td>
<td align="right">0.569</td>
<td align="right">0.666</td>
<td align="right">0.721</td>
<td align="right">0.087</td>
<td align="right">0.690</td>
<td align="right">0.184</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="bayesian-models-of-cognition.html#cb499-1" tabindex="-1"></a><span class="co"># Create a summary visualization showing how recovery improves with more trials</span></span>
<span id="cb499-2"><a href="bayesian-models-of-cognition.html#cb499-2" tabindex="-1"></a>p_summary <span class="ot">&lt;-</span> recovery_summary <span class="sc">%&gt;%</span></span>
<span id="cb499-3"><a href="bayesian-models-of-cognition.html#cb499-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb499-4"><a href="bayesian-models-of-cognition.html#cb499-4" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;mean_&quot;</span>),</span>
<span id="cb499-5"><a href="bayesian-models-of-cognition.html#cb499-5" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>,</span>
<span id="cb499-6"><a href="bayesian-models-of-cognition.html#cb499-6" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb499-7"><a href="bayesian-models-of-cognition.html#cb499-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb499-8"><a href="bayesian-models-of-cognition.html#cb499-8" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb499-9"><a href="bayesian-models-of-cognition.html#cb499-9" tabindex="-1"></a>    <span class="at">parameter_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb499-10"><a href="bayesian-models-of-cognition.html#cb499-10" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">&quot;direct&quot;</span>, metric) <span class="sc">~</span> <span class="st">&quot;Direct Weight&quot;</span>,</span>
<span id="cb499-11"><a href="bayesian-models-of-cognition.html#cb499-11" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">&quot;social&quot;</span>, metric) <span class="sc">~</span> <span class="st">&quot;Social Weight&quot;</span>,</span>
<span id="cb499-12"><a href="bayesian-models-of-cognition.html#cb499-12" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">&quot;total&quot;</span>, metric) <span class="sc">~</span> <span class="st">&quot;Total Weight&quot;</span>,</span>
<span id="cb499-13"><a href="bayesian-models-of-cognition.html#cb499-13" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">&quot;prop&quot;</span>, metric) <span class="sc">~</span> <span class="st">&quot;Weight Proportion&quot;</span></span>
<span id="cb499-14"><a href="bayesian-models-of-cognition.html#cb499-14" tabindex="-1"></a>    ),</span>
<span id="cb499-15"><a href="bayesian-models-of-cognition.html#cb499-15" tabindex="-1"></a>    <span class="at">error_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb499-16"><a href="bayesian-models-of-cognition.html#cb499-16" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">&quot;rel_error&quot;</span>, metric) <span class="sc">~</span> <span class="st">&quot;Relative Error&quot;</span>,</span>
<span id="cb499-17"><a href="bayesian-models-of-cognition.html#cb499-17" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Absolute Error&quot;</span></span>
<span id="cb499-18"><a href="bayesian-models-of-cognition.html#cb499-18" tabindex="-1"></a>    )</span>
<span id="cb499-19"><a href="bayesian-models-of-cognition.html#cb499-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb499-20"><a href="bayesian-models-of-cognition.html#cb499-20" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trials, <span class="at">y =</span> value, <span class="at">color =</span> parameter_type, <span class="at">linetype =</span> error_type)) <span class="sc">+</span></span>
<span id="cb499-21"><a href="bayesian-models-of-cognition.html#cb499-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb499-22"><a href="bayesian-models-of-cognition.html#cb499-22" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb499-23"><a href="bayesian-models-of-cognition.html#cb499-23" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> error_type, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb499-24"><a href="bayesian-models-of-cognition.html#cb499-24" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb499-25"><a href="bayesian-models-of-cognition.html#cb499-25" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Parameter Recovery Improvement with Increased Trials&quot;</span>,</span>
<span id="cb499-26"><a href="bayesian-models-of-cognition.html#cb499-26" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Number of Trials per Evidence Combination&quot;</span>,</span>
<span id="cb499-27"><a href="bayesian-models-of-cognition.html#cb499-27" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Mean Error&quot;</span>,</span>
<span id="cb499-28"><a href="bayesian-models-of-cognition.html#cb499-28" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Parameter&quot;</span>,</span>
<span id="cb499-29"><a href="bayesian-models-of-cognition.html#cb499-29" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;Error Type&quot;</span></span>
<span id="cb499-30"><a href="bayesian-models-of-cognition.html#cb499-30" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb499-31"><a href="bayesian-models-of-cognition.html#cb499-31" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb499-32"><a href="bayesian-models-of-cognition.html#cb499-32" tabindex="-1"></a></span>
<span id="cb499-33"><a href="bayesian-models-of-cognition.html#cb499-33" tabindex="-1"></a>p_summary</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-56-5.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="model-comparison-1" class="section level2 hasAnchor" number="11.17">
<h2><span class="header-section-number">11.17</span> Model comparison<a href="bayesian-models-of-cognition.html#model-comparison-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="leave-one-out-cross-validation-and-model-comparison" class="section level2 hasAnchor" number="11.18">
<h2><span class="header-section-number">11.18</span> Leave-One-Out Cross-Validation and Model Comparison<a href="bayesian-models-of-cognition.html#leave-one-out-cross-validation-and-model-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we’ll explore how to compare the simple Bayesian agent (where weights are equal) and the weighted Bayesian agent (where weights can differ) using Leave-One-Out Cross-Validation (LOO-CV). We’ll leverage the models we’ve already fitted to our three simulated agent types: Balanced, Self-Focused, and Socially-Influenced.</p>
<div id="understanding-loo-cross-validation-in-bayesian-framework" class="section level3 hasAnchor" number="11.18.1">
<h3><span class="header-section-number">11.18.1</span> Understanding LOO Cross-Validation in Bayesian Framework<a href="bayesian-models-of-cognition.html#understanding-loo-cross-validation-in-bayesian-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>LOO-CV is a powerful method for model comparison that estimates how well a model will predict new, unseen data. At its core, LOO-CV works by:</p>
<ol style="list-style-type: decimal">
<li>Leaving out one observation at a time</li>
<li>Fitting the model on all remaining observations</li>
<li>Predicting the left-out observation using that model</li>
<li>Repeating for all observations and aggregating the results</li>
</ol>
<p>In a Bayesian context, exact LOO-CV would require refitting our model N times (where N is the number of observations), which is computationally expensive. Instead, we use Pareto-Smoothed Importance Sampling (PSIS-LOO), which approximates LOO-CV from a single model fit.</p>
<p>The key insight of PSIS-LOO is that we can use importance sampling to approximate how the posterior would change if an observation were removed:</p>
<p><span class="math display">\[p(\theta | y_{-i}) \approx \frac{p(\theta | y)}{p(y_i | \theta)} \propto \frac{p(\theta | y)}{p(y_i | \theta)}\]</span></p>
<p>where <span class="math inline">\(p(\theta | y_{-i})\)</span> is the posterior without observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(p(\theta | y)\)</span> is the full posterior.</p>
</div>
<div id="step-by-step-implementation-of-loo-cv" class="section level3 hasAnchor" number="11.18.2">
<h3><span class="header-section-number">11.18.2</span> Step-by-Step Implementation of LOO-CV<a href="bayesian-models-of-cognition.html#step-by-step-implementation-of-loo-cv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s apply LOO-CV to compare our models across the three scenarios.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="bayesian-models-of-cognition.html#cb500-1" tabindex="-1"></a><span class="co"># Load the loo package</span></span>
<span id="cb500-2"><a href="bayesian-models-of-cognition.html#cb500-2" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb500-3"><a href="bayesian-models-of-cognition.html#cb500-3" tabindex="-1"></a></span>
<span id="cb500-4"><a href="bayesian-models-of-cognition.html#cb500-4" tabindex="-1"></a><span class="co"># Function to extract log-likelihood and compute LOO</span></span>
<span id="cb500-5"><a href="bayesian-models-of-cognition.html#cb500-5" tabindex="-1"></a>compute_loo <span class="ot">&lt;-</span> <span class="cf">function</span>(model_fit) {</span>
<span id="cb500-6"><a href="bayesian-models-of-cognition.html#cb500-6" tabindex="-1"></a>  <span class="co"># Extract log-likelihood values</span></span>
<span id="cb500-7"><a href="bayesian-models-of-cognition.html#cb500-7" tabindex="-1"></a>  log_lik <span class="ot">&lt;-</span> model_fit<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;log_lik&quot;</span>, <span class="at">format =</span> <span class="st">&quot;matrix&quot;</span>)</span>
<span id="cb500-8"><a href="bayesian-models-of-cognition.html#cb500-8" tabindex="-1"></a>  </span>
<span id="cb500-9"><a href="bayesian-models-of-cognition.html#cb500-9" tabindex="-1"></a>  <span class="co"># Compute LOO-CV using PSIS</span></span>
<span id="cb500-10"><a href="bayesian-models-of-cognition.html#cb500-10" tabindex="-1"></a>  loo_result <span class="ot">&lt;-</span> <span class="fu">loo</span>(log_lik)</span>
<span id="cb500-11"><a href="bayesian-models-of-cognition.html#cb500-11" tabindex="-1"></a>  <span class="fu">return</span>(loo_result)</span>
<span id="cb500-12"><a href="bayesian-models-of-cognition.html#cb500-12" tabindex="-1"></a>}</span>
<span id="cb500-13"><a href="bayesian-models-of-cognition.html#cb500-13" tabindex="-1"></a></span>
<span id="cb500-14"><a href="bayesian-models-of-cognition.html#cb500-14" tabindex="-1"></a><span class="co"># Compute LOO for each model and scenario</span></span>
<span id="cb500-15"><a href="bayesian-models-of-cognition.html#cb500-15" tabindex="-1"></a>loo_simple_balanced <span class="ot">&lt;-</span> <span class="fu">compute_loo</span>(fit_simple_balanced)</span>
<span id="cb500-16"><a href="bayesian-models-of-cognition.html#cb500-16" tabindex="-1"></a>loo_simple_self_focused <span class="ot">&lt;-</span> <span class="fu">compute_loo</span>(fit_simple_self_focused)</span>
<span id="cb500-17"><a href="bayesian-models-of-cognition.html#cb500-17" tabindex="-1"></a>loo_simple_socially_influenced <span class="ot">&lt;-</span> <span class="fu">compute_loo</span>(fit_simple_socially_influenced)</span>
<span id="cb500-18"><a href="bayesian-models-of-cognition.html#cb500-18" tabindex="-1"></a></span>
<span id="cb500-19"><a href="bayesian-models-of-cognition.html#cb500-19" tabindex="-1"></a>loo_weighted_balanced <span class="ot">&lt;-</span> <span class="fu">compute_loo</span>(fit_weighted_balanced)</span>
<span id="cb500-20"><a href="bayesian-models-of-cognition.html#cb500-20" tabindex="-1"></a>loo_weighted_self_focused <span class="ot">&lt;-</span> <span class="fu">compute_loo</span>(fit_weighted_self_focused)</span>
<span id="cb500-21"><a href="bayesian-models-of-cognition.html#cb500-21" tabindex="-1"></a>loo_weighted_socially_influenced <span class="ot">&lt;-</span> <span class="fu">compute_loo</span>(fit_weighted_socially_influenced)</span></code></pre></div>
</div>
<div id="understanding-psis-loo-diagnostics" class="section level3 hasAnchor" number="11.18.3">
<h3><span class="header-section-number">11.18.3</span> Understanding PSIS-LOO Diagnostics<a href="bayesian-models-of-cognition.html#understanding-psis-loo-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we compare models, it’s important to check the reliability of our LOO estimates. PSIS-LOO provides diagnostics through the Pareto k values:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="bayesian-models-of-cognition.html#cb501-1" tabindex="-1"></a><span class="co"># Function to check Pareto k diagnostics</span></span>
<span id="cb501-2"><a href="bayesian-models-of-cognition.html#cb501-2" tabindex="-1"></a>check_pareto_k <span class="ot">&lt;-</span> <span class="cf">function</span>(loo_result, model_name) {</span>
<span id="cb501-3"><a href="bayesian-models-of-cognition.html#cb501-3" tabindex="-1"></a>  <span class="co"># Extract Pareto k values</span></span>
<span id="cb501-4"><a href="bayesian-models-of-cognition.html#cb501-4" tabindex="-1"></a>  pareto_k <span class="ot">&lt;-</span> loo_result<span class="sc">$</span>diagnostics<span class="sc">$</span>pareto_k</span>
<span id="cb501-5"><a href="bayesian-models-of-cognition.html#cb501-5" tabindex="-1"></a>  </span>
<span id="cb501-6"><a href="bayesian-models-of-cognition.html#cb501-6" tabindex="-1"></a>  <span class="co"># Count problematic k values</span></span>
<span id="cb501-7"><a href="bayesian-models-of-cognition.html#cb501-7" tabindex="-1"></a>  n_k_high <span class="ot">&lt;-</span> <span class="fu">sum</span>(pareto_k <span class="sc">&gt;</span> <span class="fl">0.7</span>)</span>
<span id="cb501-8"><a href="bayesian-models-of-cognition.html#cb501-8" tabindex="-1"></a>  n_k_medium <span class="ot">&lt;-</span> <span class="fu">sum</span>(pareto_k <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> pareto_k <span class="sc">&lt;=</span> <span class="fl">0.7</span>)</span>
<span id="cb501-9"><a href="bayesian-models-of-cognition.html#cb501-9" tabindex="-1"></a>  </span>
<span id="cb501-10"><a href="bayesian-models-of-cognition.html#cb501-10" tabindex="-1"></a>  <span class="co"># Proportion of problematic observations</span></span>
<span id="cb501-11"><a href="bayesian-models-of-cognition.html#cb501-11" tabindex="-1"></a>  prop_problematic <span class="ot">&lt;-</span> (n_k_high <span class="sc">+</span> n_k_medium) <span class="sc">/</span> <span class="fu">length</span>(pareto_k)</span>
<span id="cb501-12"><a href="bayesian-models-of-cognition.html#cb501-12" tabindex="-1"></a>  </span>
<span id="cb501-13"><a href="bayesian-models-of-cognition.html#cb501-13" tabindex="-1"></a>  <span class="co"># Create diagnostic summary</span></span>
<span id="cb501-14"><a href="bayesian-models-of-cognition.html#cb501-14" tabindex="-1"></a>  summary_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb501-15"><a href="bayesian-models-of-cognition.html#cb501-15" tabindex="-1"></a>    <span class="at">model =</span> model_name,</span>
<span id="cb501-16"><a href="bayesian-models-of-cognition.html#cb501-16" tabindex="-1"></a>    <span class="at">total_obs =</span> <span class="fu">length</span>(pareto_k),</span>
<span id="cb501-17"><a href="bayesian-models-of-cognition.html#cb501-17" tabindex="-1"></a>    <span class="at">k_high =</span> n_k_high,</span>
<span id="cb501-18"><a href="bayesian-models-of-cognition.html#cb501-18" tabindex="-1"></a>    <span class="at">k_medium =</span> n_k_medium,</span>
<span id="cb501-19"><a href="bayesian-models-of-cognition.html#cb501-19" tabindex="-1"></a>    <span class="at">prop_problematic =</span> prop_problematic,</span>
<span id="cb501-20"><a href="bayesian-models-of-cognition.html#cb501-20" tabindex="-1"></a>    <span class="at">reliability =</span> <span class="fu">case_when</span>(</span>
<span id="cb501-21"><a href="bayesian-models-of-cognition.html#cb501-21" tabindex="-1"></a>      prop_problematic <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;Excellent&quot;</span>,</span>
<span id="cb501-22"><a href="bayesian-models-of-cognition.html#cb501-22" tabindex="-1"></a>      prop_problematic <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;Good&quot;</span>,</span>
<span id="cb501-23"><a href="bayesian-models-of-cognition.html#cb501-23" tabindex="-1"></a>      prop_problematic <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">&quot;Fair&quot;</span>,</span>
<span id="cb501-24"><a href="bayesian-models-of-cognition.html#cb501-24" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Poor&quot;</span></span>
<span id="cb501-25"><a href="bayesian-models-of-cognition.html#cb501-25" tabindex="-1"></a>    )</span>
<span id="cb501-26"><a href="bayesian-models-of-cognition.html#cb501-26" tabindex="-1"></a>  )</span>
<span id="cb501-27"><a href="bayesian-models-of-cognition.html#cb501-27" tabindex="-1"></a>  </span>
<span id="cb501-28"><a href="bayesian-models-of-cognition.html#cb501-28" tabindex="-1"></a>  <span class="fu">return</span>(summary_df)</span>
<span id="cb501-29"><a href="bayesian-models-of-cognition.html#cb501-29" tabindex="-1"></a>}</span>
<span id="cb501-30"><a href="bayesian-models-of-cognition.html#cb501-30" tabindex="-1"></a></span>
<span id="cb501-31"><a href="bayesian-models-of-cognition.html#cb501-31" tabindex="-1"></a><span class="co"># Check diagnostics for all models</span></span>
<span id="cb501-32"><a href="bayesian-models-of-cognition.html#cb501-32" tabindex="-1"></a>diagnostics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb501-33"><a href="bayesian-models-of-cognition.html#cb501-33" tabindex="-1"></a>  <span class="fu">check_pareto_k</span>(loo_simple_balanced, <span class="st">&quot;Simple - Balanced&quot;</span>),</span>
<span id="cb501-34"><a href="bayesian-models-of-cognition.html#cb501-34" tabindex="-1"></a>  <span class="fu">check_pareto_k</span>(loo_simple_self_focused, <span class="st">&quot;Simple - Self-Focused&quot;</span>),</span>
<span id="cb501-35"><a href="bayesian-models-of-cognition.html#cb501-35" tabindex="-1"></a>  <span class="fu">check_pareto_k</span>(loo_simple_socially_influenced, <span class="st">&quot;Simple - Socially-Influenced&quot;</span>),</span>
<span id="cb501-36"><a href="bayesian-models-of-cognition.html#cb501-36" tabindex="-1"></a>  <span class="fu">check_pareto_k</span>(loo_weighted_balanced, <span class="st">&quot;Weighted - Balanced&quot;</span>),</span>
<span id="cb501-37"><a href="bayesian-models-of-cognition.html#cb501-37" tabindex="-1"></a>  <span class="fu">check_pareto_k</span>(loo_weighted_self_focused, <span class="st">&quot;Weighted - Self-Focused&quot;</span>),</span>
<span id="cb501-38"><a href="bayesian-models-of-cognition.html#cb501-38" tabindex="-1"></a>  <span class="fu">check_pareto_k</span>(loo_weighted_socially_influenced, <span class="st">&quot;Weighted - Socially-Influenced&quot;</span>)</span>
<span id="cb501-39"><a href="bayesian-models-of-cognition.html#cb501-39" tabindex="-1"></a>)</span>
<span id="cb501-40"><a href="bayesian-models-of-cognition.html#cb501-40" tabindex="-1"></a></span>
<span id="cb501-41"><a href="bayesian-models-of-cognition.html#cb501-41" tabindex="-1"></a><span class="co"># Display diagnostics table</span></span>
<span id="cb501-42"><a href="bayesian-models-of-cognition.html#cb501-42" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(diagnostics, </span>
<span id="cb501-43"><a href="bayesian-models-of-cognition.html#cb501-43" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb501-44"><a href="bayesian-models-of-cognition.html#cb501-44" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;PSIS-LOO Reliability Diagnostics&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-58">Table 11.2: </span>PSIS-LOO Reliability Diagnostics</caption>
<colgroup>
<col width="36%" />
<col width="11%" />
<col width="8%" />
<col width="10%" />
<col width="19%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">total_obs</th>
<th align="right">k_high</th>
<th align="right">k_medium</th>
<th align="right">prop_problematic</th>
<th align="left">reliability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Simple - Balanced</td>
<td align="right">180</td>
<td align="right">180</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">Poor</td>
</tr>
<tr class="even">
<td align="left">Simple - Self-Focused</td>
<td align="right">180</td>
<td align="right">180</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">Poor</td>
</tr>
<tr class="odd">
<td align="left">Simple - Socially-Influenced</td>
<td align="right">180</td>
<td align="right">180</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">Poor</td>
</tr>
<tr class="even">
<td align="left">Weighted - Balanced</td>
<td align="right">180</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Excellent</td>
</tr>
<tr class="odd">
<td align="left">Weighted - Self-Focused</td>
<td align="right">180</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Excellent</td>
</tr>
<tr class="even">
<td align="left">Weighted - Socially-Influenced</td>
<td align="right">180</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Excellent</td>
</tr>
</tbody>
</table>
</div>
<div id="model-comparison-for-each-scenario" class="section level3 hasAnchor" number="11.18.4">
<h3><span class="header-section-number">11.18.4</span> Model Comparison for Each Scenario<a href="bayesian-models-of-cognition.html#model-comparison-for-each-scenario" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can compare the models within each scenario:</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="bayesian-models-of-cognition.html#cb502-1" tabindex="-1"></a><span class="co"># Function to compare models and create visualization</span></span>
<span id="cb502-2"><a href="bayesian-models-of-cognition.html#cb502-2" tabindex="-1"></a>compare_scenario_models <span class="ot">&lt;-</span> <span class="cf">function</span>(loo_simple, loo_weighted, scenario_name) {</span>
<span id="cb502-3"><a href="bayesian-models-of-cognition.html#cb502-3" tabindex="-1"></a>  <span class="co"># Compare models</span></span>
<span id="cb502-4"><a href="bayesian-models-of-cognition.html#cb502-4" tabindex="-1"></a>  comparison <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(loo_simple, loo_weighted)</span>
<span id="cb502-5"><a href="bayesian-models-of-cognition.html#cb502-5" tabindex="-1"></a>  </span>
<span id="cb502-6"><a href="bayesian-models-of-cognition.html#cb502-6" tabindex="-1"></a>  <span class="co"># Calculate model weights</span></span>
<span id="cb502-7"><a href="bayesian-models-of-cognition.html#cb502-7" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">loo_model_weights</span>(<span class="fu">list</span>(</span>
<span id="cb502-8"><a href="bayesian-models-of-cognition.html#cb502-8" tabindex="-1"></a>    <span class="st">&quot;Simple Bayesian&quot;</span> <span class="ot">=</span> loo_simple,</span>
<span id="cb502-9"><a href="bayesian-models-of-cognition.html#cb502-9" tabindex="-1"></a>    <span class="st">&quot;Weighted Bayesian&quot;</span> <span class="ot">=</span> loo_weighted</span>
<span id="cb502-10"><a href="bayesian-models-of-cognition.html#cb502-10" tabindex="-1"></a>  ))</span>
<span id="cb502-11"><a href="bayesian-models-of-cognition.html#cb502-11" tabindex="-1"></a>  </span>
<span id="cb502-12"><a href="bayesian-models-of-cognition.html#cb502-12" tabindex="-1"></a>  <span class="co"># Print comparison</span></span>
<span id="cb502-13"><a href="bayesian-models-of-cognition.html#cb502-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Model comparison for&quot;</span>, scenario_name, <span class="st">&quot;scenario:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb502-14"><a href="bayesian-models-of-cognition.html#cb502-14" tabindex="-1"></a>  <span class="fu">print</span>(comparison)</span>
<span id="cb502-15"><a href="bayesian-models-of-cognition.html#cb502-15" tabindex="-1"></a>  </span>
<span id="cb502-16"><a href="bayesian-models-of-cognition.html#cb502-16" tabindex="-1"></a>  <span class="co"># Print weights</span></span>
<span id="cb502-17"><a href="bayesian-models-of-cognition.html#cb502-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Model weights for&quot;</span>, scenario_name, <span class="st">&quot;scenario:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb502-18"><a href="bayesian-models-of-cognition.html#cb502-18" tabindex="-1"></a>  <span class="fu">print</span>(weights)</span>
<span id="cb502-19"><a href="bayesian-models-of-cognition.html#cb502-19" tabindex="-1"></a>  </span>
<span id="cb502-20"><a href="bayesian-models-of-cognition.html#cb502-20" tabindex="-1"></a>  <span class="co"># Create comparison dataframe</span></span>
<span id="cb502-21"><a href="bayesian-models-of-cognition.html#cb502-21" tabindex="-1"></a>  comparison_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(comparison)</span>
<span id="cb502-22"><a href="bayesian-models-of-cognition.html#cb502-22" tabindex="-1"></a>  comparison_df<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">rownames</span>(comparison_df)</span>
<span id="cb502-23"><a href="bayesian-models-of-cognition.html#cb502-23" tabindex="-1"></a>  <span class="fu">rownames</span>(comparison_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb502-24"><a href="bayesian-models-of-cognition.html#cb502-24" tabindex="-1"></a>  comparison_df<span class="sc">$</span>scenario <span class="ot">&lt;-</span> scenario_name</span>
<span id="cb502-25"><a href="bayesian-models-of-cognition.html#cb502-25" tabindex="-1"></a>  </span>
<span id="cb502-26"><a href="bayesian-models-of-cognition.html#cb502-26" tabindex="-1"></a>  <span class="co"># Create weights dataframe</span></span>
<span id="cb502-27"><a href="bayesian-models-of-cognition.html#cb502-27" tabindex="-1"></a>  weights_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb502-28"><a href="bayesian-models-of-cognition.html#cb502-28" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">names</span>(weights),</span>
<span id="cb502-29"><a href="bayesian-models-of-cognition.html#cb502-29" tabindex="-1"></a>    <span class="at">weight =</span> <span class="fu">as.numeric</span>(weights),</span>
<span id="cb502-30"><a href="bayesian-models-of-cognition.html#cb502-30" tabindex="-1"></a>    <span class="at">scenario =</span> scenario_name</span>
<span id="cb502-31"><a href="bayesian-models-of-cognition.html#cb502-31" tabindex="-1"></a>  )</span>
<span id="cb502-32"><a href="bayesian-models-of-cognition.html#cb502-32" tabindex="-1"></a>  </span>
<span id="cb502-33"><a href="bayesian-models-of-cognition.html#cb502-33" tabindex="-1"></a>  <span class="co"># Return both dataframes</span></span>
<span id="cb502-34"><a href="bayesian-models-of-cognition.html#cb502-34" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">comparison =</span> comparison_df, <span class="at">weights =</span> weights_df))</span>
<span id="cb502-35"><a href="bayesian-models-of-cognition.html#cb502-35" tabindex="-1"></a>}</span>
<span id="cb502-36"><a href="bayesian-models-of-cognition.html#cb502-36" tabindex="-1"></a></span>
<span id="cb502-37"><a href="bayesian-models-of-cognition.html#cb502-37" tabindex="-1"></a><span class="co"># Perform comparisons for each scenario</span></span>
<span id="cb502-38"><a href="bayesian-models-of-cognition.html#cb502-38" tabindex="-1"></a>balanced_comparison <span class="ot">&lt;-</span> <span class="fu">compare_scenario_models</span>(</span>
<span id="cb502-39"><a href="bayesian-models-of-cognition.html#cb502-39" tabindex="-1"></a>  loo_simple_balanced, loo_weighted_balanced, <span class="st">&quot;Balanced&quot;</span></span>
<span id="cb502-40"><a href="bayesian-models-of-cognition.html#cb502-40" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## Model comparison for Balanced scenario:
##        elpd_diff se_diff
## model1  0.0       0.0   
## model2 -1.0       0.3   
## 
## Model weights for Balanced scenario:
## Method: stacking
## ------
##                   weight
## Simple Bayesian   1.000 
## Weighted Bayesian 0.000</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="bayesian-models-of-cognition.html#cb504-1" tabindex="-1"></a>self_focused_comparison <span class="ot">&lt;-</span> <span class="fu">compare_scenario_models</span>(</span>
<span id="cb504-2"><a href="bayesian-models-of-cognition.html#cb504-2" tabindex="-1"></a>  loo_simple_self_focused, loo_weighted_self_focused, <span class="st">&quot;Self-Focused&quot;</span></span>
<span id="cb504-3"><a href="bayesian-models-of-cognition.html#cb504-3" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## Model comparison for Self-Focused scenario:
##        elpd_diff se_diff
## model2  0.0       0.0   
## model1 -3.1       2.6   
## 
## Model weights for Self-Focused scenario:
## Method: stacking
## ------
##                   weight
## Simple Bayesian   0.085 
## Weighted Bayesian 0.915</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="bayesian-models-of-cognition.html#cb506-1" tabindex="-1"></a>socially_influenced_comparison <span class="ot">&lt;-</span> <span class="fu">compare_scenario_models</span>(</span>
<span id="cb506-2"><a href="bayesian-models-of-cognition.html#cb506-2" tabindex="-1"></a>  loo_simple_socially_influenced, loo_weighted_socially_influenced, <span class="st">&quot;Socially-Influenced&quot;</span></span>
<span id="cb506-3"><a href="bayesian-models-of-cognition.html#cb506-3" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## Model comparison for Socially-Influenced scenario:
##        elpd_diff se_diff
## model2  0.0       0.0   
## model1 -6.2       3.5   
## 
## Model weights for Socially-Influenced scenario:
## Method: stacking
## ------
##                   weight
## Simple Bayesian   0.000 
## Weighted Bayesian 1.000</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="bayesian-models-of-cognition.html#cb508-1" tabindex="-1"></a><span class="co"># Combine comparison results</span></span>
<span id="cb508-2"><a href="bayesian-models-of-cognition.html#cb508-2" tabindex="-1"></a>all_comparisons <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb508-3"><a href="bayesian-models-of-cognition.html#cb508-3" tabindex="-1"></a>  balanced_comparison<span class="sc">$</span>comparison,</span>
<span id="cb508-4"><a href="bayesian-models-of-cognition.html#cb508-4" tabindex="-1"></a>  self_focused_comparison<span class="sc">$</span>comparison,</span>
<span id="cb508-5"><a href="bayesian-models-of-cognition.html#cb508-5" tabindex="-1"></a>  socially_influenced_comparison<span class="sc">$</span>comparison</span>
<span id="cb508-6"><a href="bayesian-models-of-cognition.html#cb508-6" tabindex="-1"></a>)</span>
<span id="cb508-7"><a href="bayesian-models-of-cognition.html#cb508-7" tabindex="-1"></a></span>
<span id="cb508-8"><a href="bayesian-models-of-cognition.html#cb508-8" tabindex="-1"></a>all_weights <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb508-9"><a href="bayesian-models-of-cognition.html#cb508-9" tabindex="-1"></a>  balanced_comparison<span class="sc">$</span>weights,</span>
<span id="cb508-10"><a href="bayesian-models-of-cognition.html#cb508-10" tabindex="-1"></a>  self_focused_comparison<span class="sc">$</span>weights,</span>
<span id="cb508-11"><a href="bayesian-models-of-cognition.html#cb508-11" tabindex="-1"></a>  socially_influenced_comparison<span class="sc">$</span>weights</span>
<span id="cb508-12"><a href="bayesian-models-of-cognition.html#cb508-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="visualizing-the-comparison-results" class="section level3 hasAnchor" number="11.18.5">
<h3><span class="header-section-number">11.18.5</span> Visualizing the Comparison Results<a href="bayesian-models-of-cognition.html#visualizing-the-comparison-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s create informative visualizations to better understand the comparison results:</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="bayesian-models-of-cognition.html#cb509-1" tabindex="-1"></a><span class="co"># Plot ELPD differences</span></span>
<span id="cb509-2"><a href="bayesian-models-of-cognition.html#cb509-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_comparisons, </span>
<span id="cb509-3"><a href="bayesian-models-of-cognition.html#cb509-3" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> elpd_diff, <span class="at">fill =</span> model)) <span class="sc">+</span></span>
<span id="cb509-4"><a href="bayesian-models-of-cognition.html#cb509-4" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb509-5"><a href="bayesian-models-of-cognition.html#cb509-5" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> elpd_diff <span class="sc">-</span> se_diff, </span>
<span id="cb509-6"><a href="bayesian-models-of-cognition.html#cb509-6" tabindex="-1"></a>                    <span class="at">ymax =</span> elpd_diff <span class="sc">+</span> se_diff), </span>
<span id="cb509-7"><a href="bayesian-models-of-cognition.html#cb509-7" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb509-8"><a href="bayesian-models-of-cognition.html#cb509-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> scenario, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb509-9"><a href="bayesian-models-of-cognition.html#cb509-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb509-10"><a href="bayesian-models-of-cognition.html#cb509-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Model Comparison via LOO-CV&quot;</span>,</span>
<span id="cb509-11"><a href="bayesian-models-of-cognition.html#cb509-11" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher ELPD difference is better; error bars show ±1 SE&quot;</span>,</span>
<span id="cb509-12"><a href="bayesian-models-of-cognition.html#cb509-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb509-13"><a href="bayesian-models-of-cognition.html#cb509-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;ELPD Difference&quot;</span></span>
<span id="cb509-14"><a href="bayesian-models-of-cognition.html#cb509-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb509-15"><a href="bayesian-models-of-cognition.html#cb509-15" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb509-16"><a href="bayesian-models-of-cognition.html#cb509-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb509-17"><a href="bayesian-models-of-cognition.html#cb509-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb509-18"><a href="bayesian-models-of-cognition.html#cb509-18" tabindex="-1"></a></span>
<span id="cb509-19"><a href="bayesian-models-of-cognition.html#cb509-19" tabindex="-1"></a><span class="co"># Plot model weights</span></span>
<span id="cb509-20"><a href="bayesian-models-of-cognition.html#cb509-20" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_weights, </span>
<span id="cb509-21"><a href="bayesian-models-of-cognition.html#cb509-21" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> weight, <span class="at">fill =</span> model)) <span class="sc">+</span></span>
<span id="cb509-22"><a href="bayesian-models-of-cognition.html#cb509-22" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb509-23"><a href="bayesian-models-of-cognition.html#cb509-23" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(weight, <span class="at">accuracy =</span> <span class="fl">0.1</span>)), </span>
<span id="cb509-24"><a href="bayesian-models-of-cognition.html#cb509-24" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb509-25"><a href="bayesian-models-of-cognition.html#cb509-25" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> scenario) <span class="sc">+</span></span>
<span id="cb509-26"><a href="bayesian-models-of-cognition.html#cb509-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb509-27"><a href="bayesian-models-of-cognition.html#cb509-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Model Weights Based on LOO-CV&quot;</span>,</span>
<span id="cb509-28"><a href="bayesian-models-of-cognition.html#cb509-28" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher weights indicate better predictive performance&quot;</span>,</span>
<span id="cb509-29"><a href="bayesian-models-of-cognition.html#cb509-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb509-30"><a href="bayesian-models-of-cognition.html#cb509-30" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Model Weight&quot;</span></span>
<span id="cb509-31"><a href="bayesian-models-of-cognition.html#cb509-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb509-32"><a href="bayesian-models-of-cognition.html#cb509-32" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb509-33"><a href="bayesian-models-of-cognition.html#cb509-33" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb509-34"><a href="bayesian-models-of-cognition.html#cb509-34" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb509-35"><a href="bayesian-models-of-cognition.html#cb509-35" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb509-36"><a href="bayesian-models-of-cognition.html#cb509-36" tabindex="-1"></a></span>
<span id="cb509-37"><a href="bayesian-models-of-cognition.html#cb509-37" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb509-38"><a href="bayesian-models-of-cognition.html#cb509-38" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-60-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="bayesian-models-of-cognition.html#cb510-1" tabindex="-1"></a><span class="co"># Create a summary table of results</span></span>
<span id="cb510-2"><a href="bayesian-models-of-cognition.html#cb510-2" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> all_weights <span class="sc">%&gt;%</span></span>
<span id="cb510-3"><a href="bayesian-models-of-cognition.html#cb510-3" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> model, <span class="at">values_from =</span> weight) <span class="sc">%&gt;%</span></span>
<span id="cb510-4"><a href="bayesian-models-of-cognition.html#cb510-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb510-5"><a href="bayesian-models-of-cognition.html#cb510-5" tabindex="-1"></a>    <span class="at">winning_model =</span> <span class="fu">case_when</span>(</span>
<span id="cb510-6"><a href="bayesian-models-of-cognition.html#cb510-6" tabindex="-1"></a>      <span class="st">`</span><span class="at">Simple Bayesian</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="st">`</span><span class="at">Weighted Bayesian</span><span class="st">`</span> <span class="sc">~</span> <span class="st">&quot;Simple Bayesian&quot;</span>,</span>
<span id="cb510-7"><a href="bayesian-models-of-cognition.html#cb510-7" tabindex="-1"></a>      <span class="st">`</span><span class="at">Weighted Bayesian</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="st">`</span><span class="at">Simple Bayesian</span><span class="st">`</span> <span class="sc">~</span> <span class="st">&quot;Weighted Bayesian&quot;</span>,</span>
<span id="cb510-8"><a href="bayesian-models-of-cognition.html#cb510-8" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Tie&quot;</span></span>
<span id="cb510-9"><a href="bayesian-models-of-cognition.html#cb510-9" tabindex="-1"></a>    ),</span>
<span id="cb510-10"><a href="bayesian-models-of-cognition.html#cb510-10" tabindex="-1"></a>    <span class="at">weight_difference =</span> <span class="fu">abs</span>(<span class="st">`</span><span class="at">Simple Bayesian</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Weighted Bayesian</span><span class="st">`</span>),</span>
<span id="cb510-11"><a href="bayesian-models-of-cognition.html#cb510-11" tabindex="-1"></a>    <span class="at">evidence_strength =</span> <span class="fu">case_when</span>(</span>
<span id="cb510-12"><a href="bayesian-models-of-cognition.html#cb510-12" tabindex="-1"></a>      weight_difference <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">&quot;Weak&quot;</span>,</span>
<span id="cb510-13"><a href="bayesian-models-of-cognition.html#cb510-13" tabindex="-1"></a>      weight_difference <span class="sc">&lt;</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">&quot;Moderate&quot;</span>,</span>
<span id="cb510-14"><a href="bayesian-models-of-cognition.html#cb510-14" tabindex="-1"></a>      weight_difference <span class="sc">&lt;</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="st">&quot;Strong&quot;</span>,</span>
<span id="cb510-15"><a href="bayesian-models-of-cognition.html#cb510-15" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Very Strong&quot;</span></span>
<span id="cb510-16"><a href="bayesian-models-of-cognition.html#cb510-16" tabindex="-1"></a>    )</span>
<span id="cb510-17"><a href="bayesian-models-of-cognition.html#cb510-17" tabindex="-1"></a>  )</span>
<span id="cb510-18"><a href="bayesian-models-of-cognition.html#cb510-18" tabindex="-1"></a></span>
<span id="cb510-19"><a href="bayesian-models-of-cognition.html#cb510-19" tabindex="-1"></a><span class="co"># Display summary table</span></span>
<span id="cb510-20"><a href="bayesian-models-of-cognition.html#cb510-20" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_table, </span>
<span id="cb510-21"><a href="bayesian-models-of-cognition.html#cb510-21" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb510-22"><a href="bayesian-models-of-cognition.html#cb510-22" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Summary of Model Comparison Results&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-60">Table 11.3: </span>Summary of Model Comparison Results</caption>
<colgroup>
<col width="18%" />
<col width="14%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">scenario</th>
<th align="right">Simple Bayesian</th>
<th align="right">Weighted Bayesian</th>
<th align="left">winning_model</th>
<th align="right">weight_difference</th>
<th align="left">evidence_strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Balanced</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
<td align="left">Simple Bayesian</td>
<td align="right">1.00</td>
<td align="left">Very Strong</td>
</tr>
<tr class="even">
<td align="left">Self-Focused</td>
<td align="right">0.085</td>
<td align="right">0.915</td>
<td align="left">Weighted Bayesian</td>
<td align="right">0.83</td>
<td align="left">Very Strong</td>
</tr>
<tr class="odd">
<td align="left">Socially-Influenced</td>
<td align="right">0.000</td>
<td align="right">1.000</td>
<td align="left">Weighted Bayesian</td>
<td align="right">1.00</td>
<td align="left">Very Strong</td>
</tr>
</tbody>
</table>
</div>
<div id="understanding-the-results" class="section level3 hasAnchor" number="11.18.6">
<h3><span class="header-section-number">11.18.6</span> Understanding the Results<a href="bayesian-models-of-cognition.html#understanding-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s take a deeper look at what these LOO comparisons tell us:</p>
<div id="balanced-agent-scenario" class="section level4 hasAnchor" number="11.18.6.1">
<h4><span class="header-section-number">11.18.6.1</span> 1. Balanced Agent Scenario<a href="bayesian-models-of-cognition.html#balanced-agent-scenario" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the Balanced Agent scenario (where both direct and social evidence are weighted equally), we expect the simple Bayesian model to perform well, since it assumes equal weights by design. If our LOO comparison shows the weighted model doesn’t provide much advantage, this confirms our expectations - the additional complexity of differential weighting isn’t justified when the true process gives equal weight to evidence sources.</p>
</div>
<div id="self-focused-agent-scenario" class="section level4 hasAnchor" number="11.18.6.2">
<h4><span class="header-section-number">11.18.6.2</span> 2. Self-Focused Agent Scenario<a href="bayesian-models-of-cognition.html#self-focused-agent-scenario" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the Self-Focused Agent (who overweights direct evidence and underweights social evidence), we expect the weighted Bayesian model to outperform the simple model. If the LOO comparison shows a substantial advantage for the weighted model, it suggests that capturing the differential weighting of evidence is important for predicting this agent’s behavior.</p>
</div>
<div id="socially-influenced-agent-scenario" class="section level4 hasAnchor" number="11.18.6.3">
<h4><span class="header-section-number">11.18.6.3</span> 3. Socially-Influenced Agent Scenario<a href="bayesian-models-of-cognition.html#socially-influenced-agent-scenario" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similarly, for the Socially-Influenced Agent (who overweights social evidence), we expect the weighted model to have an advantage. The size of this advantage indicates how crucial it is to account for the specific weighting pattern to understand this agent’s decision-making process.</p>
</div>
</div>
<div id="the-mathematics-behind-loo-cv" class="section level3 hasAnchor" number="11.18.7">
<h3><span class="header-section-number">11.18.7</span> The Mathematics Behind LOO-CV<a href="bayesian-models-of-cognition.html#the-mathematics-behind-loo-cv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s look at the mathematical foundations of LOO-CV to better understand what’s happening:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Log Predictive Density</strong>: For each observation <span class="math inline">\(i\)</span>, the log predictive density is:</p>
<p><span class="math display">\[\log p(y_i | y_{-i}) = \log \int p(y_i | \theta) p(\theta | y_{-i}) d\theta\]</span></p>
<p>This represents how well we can predict observation <span class="math inline">\(i\)</span> using a model trained on all other observations.</p></li>
<li><p><strong>PSIS-LOO Approximation</strong>: Since we don’t want to refit our model for each observation, we use importance sampling:</p>
<p><span class="math display">\[\log p(y_i | y_{-i}) \approx \log \frac{\sum_{j=1}^S w_i^j p(y_i | \theta^j)}{\sum_{j=1}^S w_i^j}\]</span></p>
<p>where <span class="math inline">\(w_i^j \propto \frac{1}{p(y_i | \theta^j)}\)</span> are importance weights and <span class="math inline">\(\theta^j\)</span> are samples from the full posterior.</p></li>
<li><p><strong>Expected Log Predictive Density (ELPD)</strong>: The overall measure of model predictive accuracy is:</p>
<p><span class="math display">\[\text{ELPD} = \sum_{i=1}^N \log p(y_i | y_{-i})\]</span></p>
<p>Higher ELPD values indicate better predictive performance.</p></li>
</ol>
</div>
<div id="examining-pointwise-contributions-to-loo" class="section level3 hasAnchor" number="11.18.8">
<h3><span class="header-section-number">11.18.8</span> Examining Pointwise Contributions to LOO<a href="bayesian-models-of-cognition.html#examining-pointwise-contributions-to-loo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To understand where model differences arise, we can look at the pointwise contributions to LOO:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="bayesian-models-of-cognition.html#cb511-1" tabindex="-1"></a><span class="co"># Extract pointwise values</span></span>
<span id="cb511-2"><a href="bayesian-models-of-cognition.html#cb511-2" tabindex="-1"></a>pointwise_balanced <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb511-3"><a href="bayesian-models-of-cognition.html#cb511-3" tabindex="-1"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loo_simple_balanced<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>]),</span>
<span id="cb511-4"><a href="bayesian-models-of-cognition.html#cb511-4" tabindex="-1"></a>  <span class="at">simple =</span> loo_simple_balanced<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>],</span>
<span id="cb511-5"><a href="bayesian-models-of-cognition.html#cb511-5" tabindex="-1"></a>  <span class="at">weighted =</span> loo_weighted_balanced<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>],</span>
<span id="cb511-6"><a href="bayesian-models-of-cognition.html#cb511-6" tabindex="-1"></a>  <span class="at">difference =</span> weighted <span class="sc">-</span> simple,</span>
<span id="cb511-7"><a href="bayesian-models-of-cognition.html#cb511-7" tabindex="-1"></a>  <span class="at">scenario =</span> <span class="st">&quot;Balanced&quot;</span></span>
<span id="cb511-8"><a href="bayesian-models-of-cognition.html#cb511-8" tabindex="-1"></a>)</span>
<span id="cb511-9"><a href="bayesian-models-of-cognition.html#cb511-9" tabindex="-1"></a></span>
<span id="cb511-10"><a href="bayesian-models-of-cognition.html#cb511-10" tabindex="-1"></a>pointwise_self_focused <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb511-11"><a href="bayesian-models-of-cognition.html#cb511-11" tabindex="-1"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loo_simple_self_focused<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>]),</span>
<span id="cb511-12"><a href="bayesian-models-of-cognition.html#cb511-12" tabindex="-1"></a>  <span class="at">simple =</span> loo_simple_self_focused<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>],</span>
<span id="cb511-13"><a href="bayesian-models-of-cognition.html#cb511-13" tabindex="-1"></a>  <span class="at">weighted =</span> loo_weighted_self_focused<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>],</span>
<span id="cb511-14"><a href="bayesian-models-of-cognition.html#cb511-14" tabindex="-1"></a>  <span class="at">difference =</span> weighted <span class="sc">-</span> simple,</span>
<span id="cb511-15"><a href="bayesian-models-of-cognition.html#cb511-15" tabindex="-1"></a>  <span class="at">scenario =</span> <span class="st">&quot;Self-Focused&quot;</span></span>
<span id="cb511-16"><a href="bayesian-models-of-cognition.html#cb511-16" tabindex="-1"></a>)</span>
<span id="cb511-17"><a href="bayesian-models-of-cognition.html#cb511-17" tabindex="-1"></a></span>
<span id="cb511-18"><a href="bayesian-models-of-cognition.html#cb511-18" tabindex="-1"></a>pointwise_socially_influenced <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb511-19"><a href="bayesian-models-of-cognition.html#cb511-19" tabindex="-1"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loo_simple_socially_influenced<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>]),</span>
<span id="cb511-20"><a href="bayesian-models-of-cognition.html#cb511-20" tabindex="-1"></a>  <span class="at">simple =</span> loo_simple_socially_influenced<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>],</span>
<span id="cb511-21"><a href="bayesian-models-of-cognition.html#cb511-21" tabindex="-1"></a>  <span class="at">weighted =</span> loo_weighted_socially_influenced<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>],</span>
<span id="cb511-22"><a href="bayesian-models-of-cognition.html#cb511-22" tabindex="-1"></a>  <span class="at">difference =</span> weighted <span class="sc">-</span> simple,</span>
<span id="cb511-23"><a href="bayesian-models-of-cognition.html#cb511-23" tabindex="-1"></a>  <span class="at">scenario =</span> <span class="st">&quot;Socially-Influenced&quot;</span></span>
<span id="cb511-24"><a href="bayesian-models-of-cognition.html#cb511-24" tabindex="-1"></a>)</span>
<span id="cb511-25"><a href="bayesian-models-of-cognition.html#cb511-25" tabindex="-1"></a></span>
<span id="cb511-26"><a href="bayesian-models-of-cognition.html#cb511-26" tabindex="-1"></a><span class="co"># Combine pointwise data</span></span>
<span id="cb511-27"><a href="bayesian-models-of-cognition.html#cb511-27" tabindex="-1"></a>all_pointwise <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb511-28"><a href="bayesian-models-of-cognition.html#cb511-28" tabindex="-1"></a>  pointwise_balanced,</span>
<span id="cb511-29"><a href="bayesian-models-of-cognition.html#cb511-29" tabindex="-1"></a>  pointwise_self_focused,</span>
<span id="cb511-30"><a href="bayesian-models-of-cognition.html#cb511-30" tabindex="-1"></a>  pointwise_socially_influenced</span>
<span id="cb511-31"><a href="bayesian-models-of-cognition.html#cb511-31" tabindex="-1"></a>)</span>
<span id="cb511-32"><a href="bayesian-models-of-cognition.html#cb511-32" tabindex="-1"></a></span>
<span id="cb511-33"><a href="bayesian-models-of-cognition.html#cb511-33" tabindex="-1"></a><span class="co"># Plot pointwise differences</span></span>
<span id="cb511-34"><a href="bayesian-models-of-cognition.html#cb511-34" tabindex="-1"></a><span class="fu">ggplot</span>(all_pointwise, <span class="fu">aes</span>(<span class="at">x =</span> observation, <span class="at">y =</span> difference)) <span class="sc">+</span></span>
<span id="cb511-35"><a href="bayesian-models-of-cognition.html#cb511-35" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> difference <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb511-36"><a href="bayesian-models-of-cognition.html#cb511-36" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb511-37"><a href="bayesian-models-of-cognition.html#cb511-37" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> scenario, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb511-38"><a href="bayesian-models-of-cognition.html#cb511-38" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;green4&quot;</span>, <span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;firebrick&quot;</span>),</span>
<span id="cb511-39"><a href="bayesian-models-of-cognition.html#cb511-39" tabindex="-1"></a>                   <span class="at">name =</span> <span class="st">&quot;Weighted Better?&quot;</span>) <span class="sc">+</span></span>
<span id="cb511-40"><a href="bayesian-models-of-cognition.html#cb511-40" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb511-41"><a href="bayesian-models-of-cognition.html#cb511-41" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Pointwise Differences in ELPD Between Models&quot;</span>,</span>
<span id="cb511-42"><a href="bayesian-models-of-cognition.html#cb511-42" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Green bars indicate observations where the weighted model performs better&quot;</span>,</span>
<span id="cb511-43"><a href="bayesian-models-of-cognition.html#cb511-43" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Observation&quot;</span>,</span>
<span id="cb511-44"><a href="bayesian-models-of-cognition.html#cb511-44" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;ELPD Difference (Weighted - Simple)&quot;</span></span>
<span id="cb511-45"><a href="bayesian-models-of-cognition.html#cb511-45" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb511-46"><a href="bayesian-models-of-cognition.html#cb511-46" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb511-47"><a href="bayesian-models-of-cognition.html#cb511-47" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-61-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multilevel-bayesian-models" class="section level2 hasAnchor" number="11.19">
<h2><span class="header-section-number">11.19</span> Multilevel Bayesian Models<a href="bayesian-models-of-cognition.html#multilevel-bayesian-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous sections, we explored how individuals integrate direct and social evidence using Bayesian principles. However, our models assumed that all individuals use the same weighting strategy. In reality, people vary in how they weigh different sources of information - some may trust their own observations more, while others may be more influenced by social information.</p>
<p>Multilevel (hierarchical) models allow us to capture this individual variation while still leveraging the commonalities across individuals. They offer several advantages:</p>
<ol style="list-style-type: decimal">
<li>They model individual differences explicitly</li>
<li>They improve parameter estimation for individuals with limited data</li>
<li>They allow us to examine correlations between individual parameters</li>
<li>They provide population-level insights about general tendencies</li>
</ol>
<p>In this section, we’ll develop multilevel versions of both our simple beta-binomial and weighted beta-binomial models.</p>
<div id="simulating-data-from-multiple-agents" class="section level3 hasAnchor" number="11.19.1">
<h3><span class="header-section-number">11.19.1</span> Simulating Data from Multiple Agents<a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, let’s simulate a population of agents with varying evidence-weighting parameters:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="bayesian-models-of-cognition.html#cb512-1" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb512-2"><a href="bayesian-models-of-cognition.html#cb512-2" tabindex="-1"></a>n_agents <span class="ot">&lt;-</span> <span class="dv">20</span>        <span class="co"># Number of agents per model</span></span>
<span id="cb512-3"><a href="bayesian-models-of-cognition.html#cb512-3" tabindex="-1"></a>n_trials_per_agent <span class="ot">&lt;-</span> <span class="dv">36</span>  <span class="co"># Number of evidence combinations per agent</span></span>
<span id="cb512-4"><a href="bayesian-models-of-cognition.html#cb512-4" tabindex="-1"></a></span>
<span id="cb512-5"><a href="bayesian-models-of-cognition.html#cb512-5" tabindex="-1"></a><span class="co"># Define population parameters for simple model (equal weights with varying scaling)</span></span>
<span id="cb512-6"><a href="bayesian-models-of-cognition.html#cb512-6" tabindex="-1"></a>simple_population_scaling_mean <span class="ot">&lt;-</span> <span class="fl">1.0</span>    <span class="co"># Mean scaling factor (log-scale)</span></span>
<span id="cb512-7"><a href="bayesian-models-of-cognition.html#cb512-7" tabindex="-1"></a>simple_population_scaling_sd <span class="ot">&lt;-</span> <span class="fl">0.3</span>      <span class="co"># SD of scaling factor (log-scale)</span></span>
<span id="cb512-8"><a href="bayesian-models-of-cognition.html#cb512-8" tabindex="-1"></a></span>
<span id="cb512-9"><a href="bayesian-models-of-cognition.html#cb512-9" tabindex="-1"></a><span class="co"># Define population parameters for weighted model</span></span>
<span id="cb512-10"><a href="bayesian-models-of-cognition.html#cb512-10" tabindex="-1"></a>weighted_population_scaling_mean <span class="ot">&lt;-</span> <span class="fl">1.5</span>   <span class="co"># Mean scaling factor (log-scale)</span></span>
<span id="cb512-11"><a href="bayesian-models-of-cognition.html#cb512-11" tabindex="-1"></a>weighted_population_scaling_sd <span class="ot">&lt;-</span> <span class="fl">0.3</span>     <span class="co"># SD of scaling factor (log-scale)</span></span>
<span id="cb512-12"><a href="bayesian-models-of-cognition.html#cb512-12" tabindex="-1"></a>weighted_population_ratio_mean <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># Mean weight ratio (log-scale, 0 = equal weights)</span></span>
<span id="cb512-13"><a href="bayesian-models-of-cognition.html#cb512-13" tabindex="-1"></a>weighted_population_ratio_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span>       <span class="co"># SD of weight ratio (log-scale)</span></span>
<span id="cb512-14"><a href="bayesian-models-of-cognition.html#cb512-14" tabindex="-1"></a></span>
<span id="cb512-15"><a href="bayesian-models-of-cognition.html#cb512-15" tabindex="-1"></a><span class="co"># Generate agent parameters for simple model</span></span>
<span id="cb512-16"><a href="bayesian-models-of-cognition.html#cb512-16" tabindex="-1"></a>simple_agents <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb512-17"><a href="bayesian-models-of-cognition.html#cb512-17" tabindex="-1"></a>  <span class="at">agent_id =</span> <span class="dv">1</span><span class="sc">:</span>n_agents,</span>
<span id="cb512-18"><a href="bayesian-models-of-cognition.html#cb512-18" tabindex="-1"></a>  <span class="at">model_type =</span> <span class="st">&quot;simple&quot;</span>,</span>
<span id="cb512-19"><a href="bayesian-models-of-cognition.html#cb512-19" tabindex="-1"></a>  <span class="co"># Generate log-normal scaling factors</span></span>
<span id="cb512-20"><a href="bayesian-models-of-cognition.html#cb512-20" tabindex="-1"></a>  <span class="at">log_scaling =</span> <span class="fu">rnorm</span>(n_agents, simple_population_scaling_mean, simple_population_scaling_sd),</span>
<span id="cb512-21"><a href="bayesian-models-of-cognition.html#cb512-21" tabindex="-1"></a>  <span class="at">scaling_factor =</span> <span class="fu">exp</span>(log_scaling),</span>
<span id="cb512-22"><a href="bayesian-models-of-cognition.html#cb512-22" tabindex="-1"></a>  <span class="co"># For simple model, weight ratio is always 1 (equal weights)</span></span>
<span id="cb512-23"><a href="bayesian-models-of-cognition.html#cb512-23" tabindex="-1"></a>  <span class="at">weight_ratio =</span> <span class="fu">rep</span>(<span class="dv">1</span>, n_agents),</span>
<span id="cb512-24"><a href="bayesian-models-of-cognition.html#cb512-24" tabindex="-1"></a>  <span class="co"># Calculate the actual weights</span></span>
<span id="cb512-25"><a href="bayesian-models-of-cognition.html#cb512-25" tabindex="-1"></a>  <span class="at">weight_direct =</span> scaling_factor <span class="sc">*</span> weight_ratio <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> weight_ratio),</span>
<span id="cb512-26"><a href="bayesian-models-of-cognition.html#cb512-26" tabindex="-1"></a>  <span class="at">weight_social =</span> scaling_factor <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> weight_ratio)</span>
<span id="cb512-27"><a href="bayesian-models-of-cognition.html#cb512-27" tabindex="-1"></a>)</span>
<span id="cb512-28"><a href="bayesian-models-of-cognition.html#cb512-28" tabindex="-1"></a></span>
<span id="cb512-29"><a href="bayesian-models-of-cognition.html#cb512-29" tabindex="-1"></a><span class="co"># Generate agent parameters for weighted model</span></span>
<span id="cb512-30"><a href="bayesian-models-of-cognition.html#cb512-30" tabindex="-1"></a>weighted_agents <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb512-31"><a href="bayesian-models-of-cognition.html#cb512-31" tabindex="-1"></a>  <span class="at">agent_id =</span> n_agents <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span>n_agents),  <span class="co"># Continue numbering from simple agents</span></span>
<span id="cb512-32"><a href="bayesian-models-of-cognition.html#cb512-32" tabindex="-1"></a>  <span class="at">model_type =</span> <span class="st">&quot;weighted&quot;</span>,</span>
<span id="cb512-33"><a href="bayesian-models-of-cognition.html#cb512-33" tabindex="-1"></a>  <span class="co"># Generate log-normal scaling factors</span></span>
<span id="cb512-34"><a href="bayesian-models-of-cognition.html#cb512-34" tabindex="-1"></a>  <span class="at">log_scaling =</span> <span class="fu">rnorm</span>(n_agents, weighted_population_scaling_mean, weighted_population_scaling_sd),</span>
<span id="cb512-35"><a href="bayesian-models-of-cognition.html#cb512-35" tabindex="-1"></a>  <span class="at">scaling_factor =</span> <span class="fu">exp</span>(log_scaling),</span>
<span id="cb512-36"><a href="bayesian-models-of-cognition.html#cb512-36" tabindex="-1"></a>  <span class="co"># Generate log-normal weight ratios</span></span>
<span id="cb512-37"><a href="bayesian-models-of-cognition.html#cb512-37" tabindex="-1"></a>  <span class="at">log_weight_ratio =</span> <span class="fu">rnorm</span>(n_agents, weighted_population_ratio_mean, weighted_population_ratio_sd),</span>
<span id="cb512-38"><a href="bayesian-models-of-cognition.html#cb512-38" tabindex="-1"></a>  <span class="at">weight_ratio =</span> <span class="fu">exp</span>(log_weight_ratio),</span>
<span id="cb512-39"><a href="bayesian-models-of-cognition.html#cb512-39" tabindex="-1"></a>  <span class="co"># Calculate the actual weights</span></span>
<span id="cb512-40"><a href="bayesian-models-of-cognition.html#cb512-40" tabindex="-1"></a>  <span class="at">weight_direct =</span> scaling_factor <span class="sc">*</span> weight_ratio <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> weight_ratio),</span>
<span id="cb512-41"><a href="bayesian-models-of-cognition.html#cb512-41" tabindex="-1"></a>  <span class="at">weight_social =</span> scaling_factor <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> weight_ratio)</span>
<span id="cb512-42"><a href="bayesian-models-of-cognition.html#cb512-42" tabindex="-1"></a>)</span>
<span id="cb512-43"><a href="bayesian-models-of-cognition.html#cb512-43" tabindex="-1"></a></span>
<span id="cb512-44"><a href="bayesian-models-of-cognition.html#cb512-44" tabindex="-1"></a><span class="co"># Combine agent parameters</span></span>
<span id="cb512-45"><a href="bayesian-models-of-cognition.html#cb512-45" tabindex="-1"></a>all_agents <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(simple_agents, weighted_agents)</span>
<span id="cb512-46"><a href="bayesian-models-of-cognition.html#cb512-46" tabindex="-1"></a></span>
<span id="cb512-47"><a href="bayesian-models-of-cognition.html#cb512-47" tabindex="-1"></a><span class="co"># Print summary of agent parameters</span></span>
<span id="cb512-48"><a href="bayesian-models-of-cognition.html#cb512-48" tabindex="-1"></a>agent_summary <span class="ot">&lt;-</span> all_agents <span class="sc">%&gt;%</span></span>
<span id="cb512-49"><a href="bayesian-models-of-cognition.html#cb512-49" tabindex="-1"></a>  <span class="fu">group_by</span>(model_type) <span class="sc">%&gt;%</span></span>
<span id="cb512-50"><a href="bayesian-models-of-cognition.html#cb512-50" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb512-51"><a href="bayesian-models-of-cognition.html#cb512-51" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb512-52"><a href="bayesian-models-of-cognition.html#cb512-52" tabindex="-1"></a>    <span class="at">mean_scaling =</span> <span class="fu">mean</span>(scaling_factor),</span>
<span id="cb512-53"><a href="bayesian-models-of-cognition.html#cb512-53" tabindex="-1"></a>    <span class="at">sd_scaling =</span> <span class="fu">sd</span>(scaling_factor),</span>
<span id="cb512-54"><a href="bayesian-models-of-cognition.html#cb512-54" tabindex="-1"></a>    <span class="at">mean_ratio =</span> <span class="fu">mean</span>(weight_ratio),</span>
<span id="cb512-55"><a href="bayesian-models-of-cognition.html#cb512-55" tabindex="-1"></a>    <span class="at">sd_ratio =</span> <span class="fu">sd</span>(weight_ratio),</span>
<span id="cb512-56"><a href="bayesian-models-of-cognition.html#cb512-56" tabindex="-1"></a>    <span class="at">mean_direct =</span> <span class="fu">mean</span>(weight_direct),</span>
<span id="cb512-57"><a href="bayesian-models-of-cognition.html#cb512-57" tabindex="-1"></a>    <span class="at">sd_direct =</span> <span class="fu">sd</span>(weight_direct),</span>
<span id="cb512-58"><a href="bayesian-models-of-cognition.html#cb512-58" tabindex="-1"></a>    <span class="at">mean_social =</span> <span class="fu">mean</span>(weight_social),</span>
<span id="cb512-59"><a href="bayesian-models-of-cognition.html#cb512-59" tabindex="-1"></a>    <span class="at">sd_social =</span> <span class="fu">sd</span>(weight_social)</span>
<span id="cb512-60"><a href="bayesian-models-of-cognition.html#cb512-60" tabindex="-1"></a>  )</span>
<span id="cb512-61"><a href="bayesian-models-of-cognition.html#cb512-61" tabindex="-1"></a></span>
<span id="cb512-62"><a href="bayesian-models-of-cognition.html#cb512-62" tabindex="-1"></a><span class="fu">print</span>(agent_summary)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 10
##   model_type     n mean_scaling sd_scaling mean_ratio sd_ratio mean_direct sd_direct
##   &lt;chr&gt;      &lt;int&gt;        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;
## 1 simple        20         2.94      0.878       1        0           1.47     0.439
## 2 weighted      20         4.56      1.08        3.28     1.67        3.37     0.881
## # ℹ 2 more variables: mean_social &lt;dbl&gt;, sd_social &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="bayesian-models-of-cognition.html#cb514-1" tabindex="-1"></a><span class="co"># Create all possible evidence combinations</span></span>
<span id="cb514-2"><a href="bayesian-models-of-cognition.html#cb514-2" tabindex="-1"></a>evidence_combinations <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb514-3"><a href="bayesian-models-of-cognition.html#cb514-3" tabindex="-1"></a>  <span class="at">blue1 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,     <span class="co"># Direct evidence: 0-8 blue marbles out of 8</span></span>
<span id="cb514-4"><a href="bayesian-models-of-cognition.html#cb514-4" tabindex="-1"></a>  <span class="at">blue2 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,     <span class="co"># Social evidence: 0-3 blue signals out of 3</span></span>
<span id="cb514-5"><a href="bayesian-models-of-cognition.html#cb514-5" tabindex="-1"></a>  <span class="at">total1 =</span> <span class="dv">8</span>,      <span class="co"># Total marbles in direct evidence (constant)</span></span>
<span id="cb514-6"><a href="bayesian-models-of-cognition.html#cb514-6" tabindex="-1"></a>  <span class="at">total2 =</span> <span class="dv">3</span>       <span class="co"># Total signals in social evidence (constant)</span></span>
<span id="cb514-7"><a href="bayesian-models-of-cognition.html#cb514-7" tabindex="-1"></a>)</span>
<span id="cb514-8"><a href="bayesian-models-of-cognition.html#cb514-8" tabindex="-1"></a></span>
<span id="cb514-9"><a href="bayesian-models-of-cognition.html#cb514-9" tabindex="-1"></a><span class="co"># Function to generate agent decisions based on their parameters</span></span>
<span id="cb514-10"><a href="bayesian-models-of-cognition.html#cb514-10" tabindex="-1"></a>generate_agent_decisions <span class="ot">&lt;-</span> <span class="cf">function</span>(agent_data, evidence_df, <span class="at">n_samples =</span> <span class="dv">5</span>) {</span>
<span id="cb514-11"><a href="bayesian-models-of-cognition.html#cb514-11" tabindex="-1"></a>  <span class="co"># Extract agent parameters</span></span>
<span id="cb514-12"><a href="bayesian-models-of-cognition.html#cb514-12" tabindex="-1"></a>  agent_id <span class="ot">&lt;-</span> agent_data<span class="sc">$</span>agent_id</span>
<span id="cb514-13"><a href="bayesian-models-of-cognition.html#cb514-13" tabindex="-1"></a>  model_type <span class="ot">&lt;-</span> agent_data<span class="sc">$</span>model_type</span>
<span id="cb514-14"><a href="bayesian-models-of-cognition.html#cb514-14" tabindex="-1"></a>  weight_direct <span class="ot">&lt;-</span> agent_data<span class="sc">$</span>weight_direct</span>
<span id="cb514-15"><a href="bayesian-models-of-cognition.html#cb514-15" tabindex="-1"></a>  weight_social <span class="ot">&lt;-</span> agent_data<span class="sc">$</span>weight_social</span>
<span id="cb514-16"><a href="bayesian-models-of-cognition.html#cb514-16" tabindex="-1"></a>  </span>
<span id="cb514-17"><a href="bayesian-models-of-cognition.html#cb514-17" tabindex="-1"></a>  <span class="co"># Create a data frame that repeats each evidence combination n_samples times</span></span>
<span id="cb514-18"><a href="bayesian-models-of-cognition.html#cb514-18" tabindex="-1"></a>  repeated_evidence <span class="ot">&lt;-</span> evidence_df <span class="sc">%&gt;%</span></span>
<span id="cb514-19"><a href="bayesian-models-of-cognition.html#cb514-19" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), <span class="at">each =</span> n_samples)) <span class="sc">%&gt;%</span></span>
<span id="cb514-20"><a href="bayesian-models-of-cognition.html#cb514-20" tabindex="-1"></a>    <span class="fu">group_by</span>(blue1, blue2, total1, total2) <span class="sc">%&gt;%</span></span>
<span id="cb514-21"><a href="bayesian-models-of-cognition.html#cb514-21" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb514-22"><a href="bayesian-models-of-cognition.html#cb514-22" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb514-23"><a href="bayesian-models-of-cognition.html#cb514-23" tabindex="-1"></a>  </span>
<span id="cb514-24"><a href="bayesian-models-of-cognition.html#cb514-24" tabindex="-1"></a>  <span class="co"># Generate decisions for each evidence combination</span></span>
<span id="cb514-25"><a href="bayesian-models-of-cognition.html#cb514-25" tabindex="-1"></a>  decisions <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(repeated_evidence, <span class="cf">function</span>(blue1, blue2, total1, total2, sample_id) {</span>
<span id="cb514-26"><a href="bayesian-models-of-cognition.html#cb514-26" tabindex="-1"></a>    <span class="co"># Calculate weighted evidence</span></span>
<span id="cb514-27"><a href="bayesian-models-of-cognition.html#cb514-27" tabindex="-1"></a>    weighted_blue1 <span class="ot">&lt;-</span> blue1 <span class="sc">*</span> weight_direct</span>
<span id="cb514-28"><a href="bayesian-models-of-cognition.html#cb514-28" tabindex="-1"></a>    weighted_red1 <span class="ot">&lt;-</span> (total1 <span class="sc">-</span> blue1) <span class="sc">*</span> weight_direct</span>
<span id="cb514-29"><a href="bayesian-models-of-cognition.html#cb514-29" tabindex="-1"></a>    weighted_blue2 <span class="ot">&lt;-</span> blue2 <span class="sc">*</span> weight_social</span>
<span id="cb514-30"><a href="bayesian-models-of-cognition.html#cb514-30" tabindex="-1"></a>    weighted_red2 <span class="ot">&lt;-</span> (total2 <span class="sc">-</span> blue2) <span class="sc">*</span> weight_social</span>
<span id="cb514-31"><a href="bayesian-models-of-cognition.html#cb514-31" tabindex="-1"></a>    </span>
<span id="cb514-32"><a href="bayesian-models-of-cognition.html#cb514-32" tabindex="-1"></a>    <span class="co"># Calculate Beta parameters</span></span>
<span id="cb514-33"><a href="bayesian-models-of-cognition.html#cb514-33" tabindex="-1"></a>    alpha_post <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> weighted_blue1 <span class="sc">+</span> weighted_blue2</span>
<span id="cb514-34"><a href="bayesian-models-of-cognition.html#cb514-34" tabindex="-1"></a>    beta_post <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> weighted_red1 <span class="sc">+</span> weighted_red2</span>
<span id="cb514-35"><a href="bayesian-models-of-cognition.html#cb514-35" tabindex="-1"></a>    </span>
<span id="cb514-36"><a href="bayesian-models-of-cognition.html#cb514-36" tabindex="-1"></a>    <span class="co"># Expected probability</span></span>
<span id="cb514-37"><a href="bayesian-models-of-cognition.html#cb514-37" tabindex="-1"></a>    expected_rate <span class="ot">&lt;-</span> alpha_post <span class="sc">/</span> (alpha_post <span class="sc">+</span> beta_post)</span>
<span id="cb514-38"><a href="bayesian-models-of-cognition.html#cb514-38" tabindex="-1"></a>    </span>
<span id="cb514-39"><a href="bayesian-models-of-cognition.html#cb514-39" tabindex="-1"></a>    <span class="co"># Make choice</span></span>
<span id="cb514-40"><a href="bayesian-models-of-cognition.html#cb514-40" tabindex="-1"></a>    choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, expected_rate)</span>
<span id="cb514-41"><a href="bayesian-models-of-cognition.html#cb514-41" tabindex="-1"></a>    </span>
<span id="cb514-42"><a href="bayesian-models-of-cognition.html#cb514-42" tabindex="-1"></a>    <span class="co"># Return decision data</span></span>
<span id="cb514-43"><a href="bayesian-models-of-cognition.html#cb514-43" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb514-44"><a href="bayesian-models-of-cognition.html#cb514-44" tabindex="-1"></a>      <span class="at">agent_id =</span> agent_id,</span>
<span id="cb514-45"><a href="bayesian-models-of-cognition.html#cb514-45" tabindex="-1"></a>      <span class="at">model_type =</span> model_type,</span>
<span id="cb514-46"><a href="bayesian-models-of-cognition.html#cb514-46" tabindex="-1"></a>      <span class="at">sample_id =</span> sample_id,</span>
<span id="cb514-47"><a href="bayesian-models-of-cognition.html#cb514-47" tabindex="-1"></a>      <span class="at">blue1 =</span> blue1,</span>
<span id="cb514-48"><a href="bayesian-models-of-cognition.html#cb514-48" tabindex="-1"></a>      <span class="at">blue2 =</span> blue2,</span>
<span id="cb514-49"><a href="bayesian-models-of-cognition.html#cb514-49" tabindex="-1"></a>      <span class="at">total1 =</span> total1,</span>
<span id="cb514-50"><a href="bayesian-models-of-cognition.html#cb514-50" tabindex="-1"></a>      <span class="at">total2 =</span> total2,</span>
<span id="cb514-51"><a href="bayesian-models-of-cognition.html#cb514-51" tabindex="-1"></a>      <span class="at">expected_rate =</span> expected_rate,</span>
<span id="cb514-52"><a href="bayesian-models-of-cognition.html#cb514-52" tabindex="-1"></a>      <span class="at">choice =</span> choice,</span>
<span id="cb514-53"><a href="bayesian-models-of-cognition.html#cb514-53" tabindex="-1"></a>      </span>
<span id="cb514-54"><a href="bayesian-models-of-cognition.html#cb514-54" tabindex="-1"></a>      <span class="co"># Include true parameter values for reference</span></span>
<span id="cb514-55"><a href="bayesian-models-of-cognition.html#cb514-55" tabindex="-1"></a>      <span class="at">true_weight_direct =</span> weight_direct,</span>
<span id="cb514-56"><a href="bayesian-models-of-cognition.html#cb514-56" tabindex="-1"></a>      <span class="at">true_weight_social =</span> weight_social,</span>
<span id="cb514-57"><a href="bayesian-models-of-cognition.html#cb514-57" tabindex="-1"></a>      <span class="at">true_weight_ratio =</span> weight_direct <span class="sc">/</span> weight_social,</span>
<span id="cb514-58"><a href="bayesian-models-of-cognition.html#cb514-58" tabindex="-1"></a>      <span class="at">true_scaling_factor =</span> weight_direct <span class="sc">+</span> weight_social</span>
<span id="cb514-59"><a href="bayesian-models-of-cognition.html#cb514-59" tabindex="-1"></a>    )</span>
<span id="cb514-60"><a href="bayesian-models-of-cognition.html#cb514-60" tabindex="-1"></a>  })</span>
<span id="cb514-61"><a href="bayesian-models-of-cognition.html#cb514-61" tabindex="-1"></a>  </span>
<span id="cb514-62"><a href="bayesian-models-of-cognition.html#cb514-62" tabindex="-1"></a>  <span class="fu">return</span>(decisions)</span>
<span id="cb514-63"><a href="bayesian-models-of-cognition.html#cb514-63" tabindex="-1"></a>}</span>
<span id="cb514-64"><a href="bayesian-models-of-cognition.html#cb514-64" tabindex="-1"></a></span>
<span id="cb514-65"><a href="bayesian-models-of-cognition.html#cb514-65" tabindex="-1"></a><span class="co"># Generate decisions for all agents</span></span>
<span id="cb514-66"><a href="bayesian-models-of-cognition.html#cb514-66" tabindex="-1"></a>multilevel_sim_data <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_agents), <span class="cf">function</span>(i) {</span>
<span id="cb514-67"><a href="bayesian-models-of-cognition.html#cb514-67" tabindex="-1"></a>  <span class="fu">generate_agent_decisions</span>(all_agents[i, ], evidence_combinations)</span>
<span id="cb514-68"><a href="bayesian-models-of-cognition.html#cb514-68" tabindex="-1"></a>})</span>
<span id="cb514-69"><a href="bayesian-models-of-cognition.html#cb514-69" tabindex="-1"></a></span>
<span id="cb514-70"><a href="bayesian-models-of-cognition.html#cb514-70" tabindex="-1"></a><span class="co"># Add descriptive labels</span></span>
<span id="cb514-71"><a href="bayesian-models-of-cognition.html#cb514-71" tabindex="-1"></a>multilevel_sim_data <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb514-72"><a href="bayesian-models-of-cognition.html#cb514-72" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb514-73"><a href="bayesian-models-of-cognition.html#cb514-73" tabindex="-1"></a>    <span class="at">social_evidence =</span> <span class="fu">factor</span>(</span>
<span id="cb514-74"><a href="bayesian-models-of-cognition.html#cb514-74" tabindex="-1"></a>      blue2,</span>
<span id="cb514-75"><a href="bayesian-models-of-cognition.html#cb514-75" tabindex="-1"></a>      <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb514-76"><a href="bayesian-models-of-cognition.html#cb514-76" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Clear Red&quot;</span>, <span class="st">&quot;Weak Red&quot;</span>, <span class="st">&quot;Weak Blue&quot;</span>, <span class="st">&quot;Clear Blue&quot;</span>)</span>
<span id="cb514-77"><a href="bayesian-models-of-cognition.html#cb514-77" tabindex="-1"></a>    )</span>
<span id="cb514-78"><a href="bayesian-models-of-cognition.html#cb514-78" tabindex="-1"></a>  )</span>
<span id="cb514-79"><a href="bayesian-models-of-cognition.html#cb514-79" tabindex="-1"></a></span>
<span id="cb514-80"><a href="bayesian-models-of-cognition.html#cb514-80" tabindex="-1"></a><span class="co"># Visualize decision patterns for selected agents</span></span>
<span id="cb514-81"><a href="bayesian-models-of-cognition.html#cb514-81" tabindex="-1"></a><span class="co"># Take a sample of agents from each model type</span></span>
<span id="cb514-82"><a href="bayesian-models-of-cognition.html#cb514-82" tabindex="-1"></a>selected_simple_agents <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(simple_agents<span class="sc">$</span>agent_id), <span class="dv">3</span>)</span>
<span id="cb514-83"><a href="bayesian-models-of-cognition.html#cb514-83" tabindex="-1"></a>selected_weighted_agents <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(weighted_agents<span class="sc">$</span>agent_id), <span class="dv">3</span>)</span>
<span id="cb514-84"><a href="bayesian-models-of-cognition.html#cb514-84" tabindex="-1"></a>selected_agents <span class="ot">&lt;-</span> <span class="fu">c</span>(selected_simple_agents, selected_weighted_agents)</span>
<span id="cb514-85"><a href="bayesian-models-of-cognition.html#cb514-85" tabindex="-1"></a></span>
<span id="cb514-86"><a href="bayesian-models-of-cognition.html#cb514-86" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb514-87"><a href="bayesian-models-of-cognition.html#cb514-87" tabindex="-1"></a>decision_plot <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb514-88"><a href="bayesian-models-of-cognition.html#cb514-88" tabindex="-1"></a>  <span class="fu">filter</span>(agent_id <span class="sc">%in%</span> selected_agents) <span class="sc">%&gt;%</span></span>
<span id="cb514-89"><a href="bayesian-models-of-cognition.html#cb514-89" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> blue1, <span class="at">y =</span> expected_rate, <span class="at">color =</span> social_evidence, <span class="at">group =</span> social_evidence)) <span class="sc">+</span></span>
<span id="cb514-90"><a href="bayesian-models-of-cognition.html#cb514-90" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb514-91"><a href="bayesian-models-of-cognition.html#cb514-91" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb514-92"><a href="bayesian-models-of-cognition.html#cb514-92" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb514-93"><a href="bayesian-models-of-cognition.html#cb514-93" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> model_type <span class="sc">+</span> agent_id, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb514-94"><a href="bayesian-models-of-cognition.html#cb514-94" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb514-95"><a href="bayesian-models-of-cognition.html#cb514-95" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Decision Patterns: Simple vs. Weighted Integration&quot;</span>,</span>
<span id="cb514-96"><a href="bayesian-models-of-cognition.html#cb514-96" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Simple model shows parallel curves (equal weights), weighted model shows varying influence of social evidence&quot;</span>,</span>
<span id="cb514-97"><a href="bayesian-models-of-cognition.html#cb514-97" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Blue Marbles in Direct Evidence (out of 8)&quot;</span>,</span>
<span id="cb514-98"><a href="bayesian-models-of-cognition.html#cb514-98" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Probability of Choosing Blue&quot;</span>,</span>
<span id="cb514-99"><a href="bayesian-models-of-cognition.html#cb514-99" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Social Evidence&quot;</span></span>
<span id="cb514-100"><a href="bayesian-models-of-cognition.html#cb514-100" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb514-101"><a href="bayesian-models-of-cognition.html#cb514-101" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb514-102"><a href="bayesian-models-of-cognition.html#cb514-102" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb514-103"><a href="bayesian-models-of-cognition.html#cb514-103" tabindex="-1"></a></span>
<span id="cb514-104"><a href="bayesian-models-of-cognition.html#cb514-104" tabindex="-1"></a><span class="co"># Display plot</span></span>
<span id="cb514-105"><a href="bayesian-models-of-cognition.html#cb514-105" tabindex="-1"></a><span class="fu">print</span>(decision_plot)</span></code></pre></div>
<p><img src="series_files/figure-html/multilevel_sim_setup-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="bayesian-models-of-cognition.html#cb515-1" tabindex="-1"></a><span class="co"># Print summary of dataset</span></span>
<span id="cb515-2"><a href="bayesian-models-of-cognition.html#cb515-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Generated&quot;</span>, <span class="fu">nrow</span>(multilevel_sim_data), <span class="st">&quot;observations from&quot;</span>, </span>
<span id="cb515-3"><a href="bayesian-models-of-cognition.html#cb515-3" tabindex="-1"></a>    n_agents <span class="sc">*</span> <span class="dv">2</span>, <span class="st">&quot;agents (&quot;</span>, n_agents, <span class="st">&quot;per model type)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Generated 7200 observations from 40 agents ( 20 per model type)</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="bayesian-models-of-cognition.html#cb517-1" tabindex="-1"></a><span class="co"># Create data structure for Stan fitting</span></span>
<span id="cb517-2"><a href="bayesian-models-of-cognition.html#cb517-2" tabindex="-1"></a>stan_data_multilevel <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb517-3"><a href="bayesian-models-of-cognition.html#cb517-3" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(multilevel_sim_data),</span>
<span id="cb517-4"><a href="bayesian-models-of-cognition.html#cb517-4" tabindex="-1"></a>  <span class="at">J =</span> n_agents <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb517-5"><a href="bayesian-models-of-cognition.html#cb517-5" tabindex="-1"></a>  <span class="at">agent_id =</span> multilevel_sim_data<span class="sc">$</span>agent_id,</span>
<span id="cb517-6"><a href="bayesian-models-of-cognition.html#cb517-6" tabindex="-1"></a>  <span class="at">choice =</span> multilevel_sim_data<span class="sc">$</span>choice,</span>
<span id="cb517-7"><a href="bayesian-models-of-cognition.html#cb517-7" tabindex="-1"></a>  <span class="at">blue1 =</span> multilevel_sim_data<span class="sc">$</span>blue1,</span>
<span id="cb517-8"><a href="bayesian-models-of-cognition.html#cb517-8" tabindex="-1"></a>  <span class="at">total1 =</span> multilevel_sim_data<span class="sc">$</span>total1,</span>
<span id="cb517-9"><a href="bayesian-models-of-cognition.html#cb517-9" tabindex="-1"></a>  <span class="at">blue2 =</span> multilevel_sim_data<span class="sc">$</span>blue2,</span>
<span id="cb517-10"><a href="bayesian-models-of-cognition.html#cb517-10" tabindex="-1"></a>  <span class="at">total2 =</span> multilevel_sim_data<span class="sc">$</span>total2</span>
<span id="cb517-11"><a href="bayesian-models-of-cognition.html#cb517-11" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="understanding-the-simulated-data" class="section level3 hasAnchor" number="11.19.2">
<h3><span class="header-section-number">11.19.2</span> Understanding the Simulated Data<a href="bayesian-models-of-cognition.html#understanding-the-simulated-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The simulation generates data from two types of agents:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Simple Integration Agents</strong>: These agents weight direct and social evidence equally, but with varying overall scaling factors. This creates individual differences in how strongly evidence affects beliefs, but without preferential weighting of sources.</p></li>
<li><p><strong>Weighted Integration Agents</strong>: These agents can weight direct and social evidence differently. Some might trust their direct evidence more, others might be more influenced by social information.</p></li>
</ol>
<p>The key visual difference in their decision patterns is:</p>
<ul>
<li><p><strong>Simple integration agents</strong> show parallel curves for different social evidence levels. The spacing between curves is consistent across all levels of direct evidence, indicating equal influence.</p></li>
<li><p><strong>Weighted integration agents</strong> show varying spacing between curves. When an agent weights social evidence more heavily, the curves are more separated; when direct evidence is weighted more, the curves converge.</p></li>
</ul>
<p>By generating data from both models, we can:</p>
<ol style="list-style-type: decimal">
<li>Verify our model-fitting procedure can recover the true parameters</li>
<li>Test whether our model comparison methods correctly identify which integration strategy generated each dataset</li>
<li>Assess how robustly we can detect differential weighting of evidence sources</li>
</ol>
<p>In the next section, we’ll fit both our multilevel models to this data and compare their performance..</p>
<p>Looking at these visualizations, we can see clear individual differences in how agents integrate evidence:</p>
<ul>
<li>Some agents give more weight to direct evidence, requiring less direct evidence to choose “blue” regardless of social evidence</li>
<li>Others are more influenced by social information, showing greater spacing between the different social evidence lines</li>
<li>These differences create unique decision boundaries for each agent, where they transition from choosing red to blue</li>
</ul>
</div>
</div>
<div id="multilevel-bayesian-models-for-evidence-integration" class="section level2 hasAnchor" number="11.20">
<h2><span class="header-section-number">11.20</span> Multilevel Bayesian Models for Evidence Integration<a href="bayesian-models-of-cognition.html#multilevel-bayesian-models-for-evidence-integration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we implement two multilevel Bayesian models that capture different hypotheses about how individuals integrate evidence from multiple sources. Both models allow for individual differences, but they differ in what aspects of evidence integration can vary across individuals.</p>
<div id="model-1-simple-evidence-integration-with-individual-scaling" class="section level3 hasAnchor" number="11.20.1">
<h3><span class="header-section-number">11.20.1</span> Model 1: Simple Evidence Integration with Individual Scaling<a href="bayesian-models-of-cognition.html#model-1-simple-evidence-integration-with-individual-scaling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our first model implements a cognitively simple integration strategy where all evidence sources are weighted equally (taken at “face value”), but the overall impact of evidence can vary across individuals:</p>
<ul>
<li>Each information source (direct and social evidence) receives <strong>equal relative weight</strong> in the integration process</li>
<li>However, the <strong>overall scaling</strong> of evidence can vary between individuals</li>
<li>This represents individuals who treat all evidence sources as equally reliable, but differ in how strongly any evidence influences their beliefs</li>
</ul>
<p>Mathematically, this means that for individual <em>j</em>:
- Direct evidence weight = scaling_factor[j] × 0.5
- Social evidence weight = scaling_factor[j] × 0.5</p>
<p>This model captures the hypothesis that individuals differ in their overall sensitivity to evidence, but not in how they relatively weight different sources. Some individuals might be more conservative (low scaling factor), requiring more evidence to shift their beliefs, while others might be more responsive to evidence overall (high scaling factor).</p>
</div>
<div id="model-2-weighted-evidence-integration" class="section level3 hasAnchor" number="11.20.2">
<h3><span class="header-section-number">11.20.2</span> Model 2: Weighted Evidence Integration<a href="bayesian-models-of-cognition.html#model-2-weighted-evidence-integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our second model implements a more complex integration strategy where both the overall impact of evidence and the relative weighting of different evidence sources can vary across individuals:</p>
<ul>
<li>Each individual can give <strong>different weights</strong> to direct versus social evidence</li>
<li>The <strong>overall scaling</strong> of evidence can also vary between individuals</li>
<li>This represents individuals who may trust certain evidence sources more than others</li>
</ul>
<p>We parameterize this model using two key parameters for each individual <em>j</em>:
- <code>scaling_factor[j]</code>: The total weight given to all evidence
- <code>weight_ratio[j]</code>: The ratio of direct evidence weight to social evidence weight</p>
<p>From these, we derive the actual weights:
- Direct evidence weight = scaling_factor[j] × weight_ratio[j] / (1 + weight_ratio[j])
- Social evidence weight = scaling_factor[j] / (1 + weight_ratio[j])</p>
<p>This parameterization ensures that the sum of weights equals the scaling factor, while the ratio between weights is determined by the weight ratio.</p>
</div>
<div id="why-allow-scaling-to-vary-in-the-simple-model" class="section level3 hasAnchor" number="11.20.3">
<h3><span class="header-section-number">11.20.3</span> Why Allow Scaling to Vary in the Simple Model?<a href="bayesian-models-of-cognition.html#why-allow-scaling-to-vary-in-the-simple-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Including individual variation in the scaling factor for the simple model serves several important purposes:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Fair Comparison</strong>: It ensures that the comparison between models focuses specifically on differential weighting rather than just the presence of individual differences. The key question becomes “Do individuals weight evidence sources differently?” rather than “Do individuals vary in how they use evidence?”</p></li>
<li><p><strong>Statistical Control</strong>: The scaling parameter serves as a statistical control, ensuring that any evidence for differential weighting isn’t just capturing overall differences in evidence sensitivity.</p></li>
<li><p><strong>Nested Model Structure</strong>: It creates a proper nested model relationship - the simple model is a special case of the weighted model where the weight ratio is constrained to be 1.0 (equal weights) for everyone.</p></li>
</ol>
<p>This approach allows us to conduct a more precise test of our cognitive hypothesis about differential weighting of evidence sources, while accounting for individual differences in overall evidence use that likely exist regardless of weighting strategy.</p>
</div>
</div>
<div id="from-single-agent-to-multilevel-extending-bayesian-cognitive-models" class="section level2 hasAnchor" number="11.21">
<h2><span class="header-section-number">11.21</span> From Single-Agent to Multilevel: Extending Bayesian Cognitive Models<a href="bayesian-models-of-cognition.html#from-single-agent-to-multilevel-extending-bayesian-cognitive-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When moving from single-agent to multilevel modeling, we need to extend our Stan code to capture both population-level patterns and individual differences. This transformation requires careful consideration of parameter structure, prior specification, and computational efficiency. Let’s explore how we adapted our single-agent models into multilevel versions.</p>
<div id="key-components-of-the-multilevel-extension" class="section level3 hasAnchor" number="11.21.1">
<h3><span class="header-section-number">11.21.1</span> Key Components of the Multilevel Extension<a href="bayesian-models-of-cognition.html#key-components-of-the-multilevel-extension" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Parameterizing Individual Differences</li>
</ol>
<p>In our single-agent models, we had straightforward parameters like total_weight and weight_prop (for the weighted model) or just a scaling factor (for the simple model). For multilevel modeling, we need to create parameters that vary across individuals while maintaining population coherence.</p>
<p>For the simple integration model:</p>
<pre><code>// Single-agent version
parameters {
  real&lt;lower=0&gt; total_weight;         // Overall scaling of evidence
}

// Multilevel version
parameters {
  real mu_scaling;                    // Population mean (log scale)
  real&lt;lower=0&gt; sigma_scaling;        // Population SD
  vector[J] z_scaling;                // Standardized individual deviations
}

transformed parameters {
  vector&lt;lower=0&gt;[J] scaling_factor;  // Individual scaling factors
  
  for (j in 1:J) {
    scaling_factor[j] = exp(mu_scaling + z_scaling[j] * sigma_scaling);
  }
}</code></pre>
<p>Note several key changes:</p>
<ul>
<li><p>We now have population-level parameters (mu_scaling, sigma_scaling) that describe the distribution from which individual parameters are drawn</p></li>
<li><p>We use non-centered parameterization with standardized z-scores to improve sampling efficiency</p></li>
<li><p>We work in log space to ensure positive scaling factors</p></li>
</ul>
</div>
<div id="hierarchical-prior-structure" class="section level3 hasAnchor" number="11.21.2">
<h3><span class="header-section-number">11.21.2</span> 2. Hierarchical Prior Structure<a href="bayesian-models-of-cognition.html#hierarchical-prior-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Priors also need to be restructured in a hierarchical fashion:</p>
<pre><code>
// Single-agent version
target += lognormal_lpdf(total_weight | .8, .4);  // Prior for scaling

// Multilevel version
target += normal_lpdf(mu_scaling | 0, 1);        // Prior for population mean
target += exponential_lpdf(sigma_scaling | 2);   // Prior for between-subject variability
target += std_normal_lpdf(z_scaling);            // Prior for standardized deviations
</code></pre>
<p>The prior structure now has:</p>
<ul>
<li>Priors on population means</li>
<li>Priors on population variances</li>
<li>Standard normal priors on the standardized individual deviations</li>
</ul>
<p>This creates a proper hierarchical structure where individual parameters are partially pooled toward the population mean, with the degree of pooling determined by the population variance.</p>
</div>
<div id="handling-data-from-multiple-individuals" class="section level3 hasAnchor" number="11.21.3">
<h3><span class="header-section-number">11.21.3</span> 3. Handling Data from Multiple Individuals<a href="bayesian-models-of-cognition.html#handling-data-from-multiple-individuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data structure must be modified to associate observations with specific individuals:</p>
<pre><code>// Single-agent version
data {
  int&lt;lower=1&gt; N;                    // Number of observations
  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)
  // Other data...
}

// Multilevel version
data {
  int&lt;lower=1&gt; N;                    // Number of observations
  int&lt;lower=1&gt; J;                    // Number of subjects
  array[N] int&lt;lower=1, upper=J&gt; agent_id; // Agent ID for each observation
  array[N] int&lt;lower=0, upper=1&gt; choice;   // Choices (0=red, 1=blue)
  // Other data...
}</code></pre>
<p>The key addition is agent_id, which maps each observation to its corresponding agent. This allows us to apply the correct individual-level parameters to each observation.</p>
</div>
<div id="likelihood-specification" class="section level3 hasAnchor" number="11.21.4">
<h3><span class="header-section-number">11.21.4</span> 4. Likelihood Specification<a href="bayesian-models-of-cognition.html#likelihood-specification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The likelihood must be adapted to use the appropriate individual-level parameters:</p>
<pre><code>// Single-agent version
for (i in 1:N) {
  real weighted_blue1 = blue1[i] * weight_direct;
  // ...additional code...
  choice[i] ~ bernoulli(expected_prob);
}

// Multilevel version
for (i in 1:N) {
  real w_direct = weight_direct[agent_id[i]];  // Get parameters for this individual
  real w_social = weight_social[agent_id[i]];
  
  real weighted_blue1 = blue1[i] * w_direct;
  // ...additional code...
  choice[i] ~ bernoulli(expected_prob);
}</code></pre>
<p>We now index individual parameters by agent_id[i] to ensure each observation uses the correct agent’s parameters.</p>
</div>
<div id="why-these-changes-matter" class="section level3 hasAnchor" number="11.21.5">
<h3><span class="header-section-number">11.21.5</span> Why These Changes Matter<a href="bayesian-models-of-cognition.html#why-these-changes-matter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="computational-efficiency-non-centered-parameterization" class="section level4 hasAnchor" number="11.21.5.1">
<h4><span class="header-section-number">11.21.5.1</span> Computational Efficiency: Non-Centered Parameterization<a href="bayesian-models-of-cognition.html#computational-efficiency-non-centered-parameterization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The non-centered parameterization (using z-scores) is critical for efficient sampling in hierarchical models. When individual parameters are close to the population mean or when population variance is small, direct parameterization can cause the sampler to get stuck in a difficult geometry called the “funnel” problem.</p>
<p>By separating the individual effects into standardized z-scores, we create better sampling geometry and improve convergence.</p>
<p>This is why we use:</p>
<pre><code>scaling_factor[j] = exp(mu_scaling + z_scaling[j] * sigma_scaling);</code></pre>
<p>instead of directly sampling individual parameters.</p>
</div>
<div id="working-in-log-space-for-bounded-parameters" class="section level4 hasAnchor" number="11.21.5.2">
<h4><span class="header-section-number">11.21.5.2</span> Working in Log Space for Bounded Parameters<a href="bayesian-models-of-cognition.html#working-in-log-space-for-bounded-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For parameters that must be positive (like scaling factors), working in log space ensures we maintain proper bounds while allowing the parameter to vary freely on the unconstrained scale:</p>
<pre><code>// This ensures scaling_factor is always positive
scaling_factor[j] = exp(mu_scaling + z_scaling[j] * sigma_scaling);</code></pre>
<p>Similarly, for parameters constrained between 0 and 1 (like weight_prop), we use the logit transformation.</p>
<p>Now we are ready for the full implementation of our multilevel Bayesian models for evidence integration.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="bayesian-models-of-cognition.html#cb524-1" tabindex="-1"></a><span class="co"># Stan model for multilevel simple beta-binomial</span></span>
<span id="cb524-2"><a href="bayesian-models-of-cognition.html#cb524-2" tabindex="-1"></a>multilevel_simple_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb524-3"><a href="bayesian-models-of-cognition.html#cb524-3" tabindex="-1"></a><span class="st">// Multilevel Simple Beta-Binomial Model</span></span>
<span id="cb524-4"><a href="bayesian-models-of-cognition.html#cb524-4" tabindex="-1"></a><span class="st">// This model assumes equal weights for evidence sources (taking evidence at face value)</span></span>
<span id="cb524-5"><a href="bayesian-models-of-cognition.html#cb524-5" tabindex="-1"></a><span class="st">// but allows for individual variation in overall responsiveness</span></span>
<span id="cb524-6"><a href="bayesian-models-of-cognition.html#cb524-6" tabindex="-1"></a></span>
<span id="cb524-7"><a href="bayesian-models-of-cognition.html#cb524-7" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb524-8"><a href="bayesian-models-of-cognition.html#cb524-8" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Total number of observations</span></span>
<span id="cb524-9"><a href="bayesian-models-of-cognition.html#cb524-9" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; J;                        // Number of subjects</span></span>
<span id="cb524-10"><a href="bayesian-models-of-cognition.html#cb524-10" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1, upper=J&gt; agent_id;  // Agent ID for each observation</span></span>
<span id="cb524-11"><a href="bayesian-models-of-cognition.html#cb524-11" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb524-12"><a href="bayesian-models-of-cognition.html#cb524-12" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles)</span></span>
<span id="cb524-13"><a href="bayesian-models-of-cognition.html#cb524-13" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;          // Total direct evidence</span></span>
<span id="cb524-14"><a href="bayesian-models-of-cognition.html#cb524-14" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals)</span></span>
<span id="cb524-15"><a href="bayesian-models-of-cognition.html#cb524-15" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;          // Total social evidence</span></span>
<span id="cb524-16"><a href="bayesian-models-of-cognition.html#cb524-16" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb524-17"><a href="bayesian-models-of-cognition.html#cb524-17" tabindex="-1"></a></span>
<span id="cb524-18"><a href="bayesian-models-of-cognition.html#cb524-18" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb524-19"><a href="bayesian-models-of-cognition.html#cb524-19" tabindex="-1"></a><span class="st">  // Population-level parameters for agents&#39; preconceptions</span></span>
<span id="cb524-20"><a href="bayesian-models-of-cognition.html#cb524-20" tabindex="-1"></a><span class="st">  real mu_alpha_prior;                   // Population mean for alpha prior</span></span>
<span id="cb524-21"><a href="bayesian-models-of-cognition.html#cb524-21" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_alpha_prior;       // Population SD for alpha prior</span></span>
<span id="cb524-22"><a href="bayesian-models-of-cognition.html#cb524-22" tabindex="-1"></a><span class="st">  real mu_beta_prior;                    // Population mean for beta prior</span></span>
<span id="cb524-23"><a href="bayesian-models-of-cognition.html#cb524-23" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_beta_prior;        // Population SD for beta prior</span></span>
<span id="cb524-24"><a href="bayesian-models-of-cognition.html#cb524-24" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-25"><a href="bayesian-models-of-cognition.html#cb524-25" tabindex="-1"></a><span class="st">  // Population-level parameter for overall scaling</span></span>
<span id="cb524-26"><a href="bayesian-models-of-cognition.html#cb524-26" tabindex="-1"></a><span class="st">  real mu_scaling;                       // Population mean scaling factor (log scale)</span></span>
<span id="cb524-27"><a href="bayesian-models-of-cognition.html#cb524-27" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_scaling;           // Population SD of scaling</span></span>
<span id="cb524-28"><a href="bayesian-models-of-cognition.html#cb524-28" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-29"><a href="bayesian-models-of-cognition.html#cb524-29" tabindex="-1"></a><span class="st">  // Individual-level (random) effects</span></span>
<span id="cb524-30"><a href="bayesian-models-of-cognition.html#cb524-30" tabindex="-1"></a><span class="st">  vector[J] z_alpha_prior;               // Standardized individual deviations for alpha prior</span></span>
<span id="cb524-31"><a href="bayesian-models-of-cognition.html#cb524-31" tabindex="-1"></a><span class="st">  vector[J] z_beta_prior;                // Standardized individual deviations for beta prior</span></span>
<span id="cb524-32"><a href="bayesian-models-of-cognition.html#cb524-32" tabindex="-1"></a><span class="st">  vector[J] z_scaling;                   // Standardized individual deviations</span></span>
<span id="cb524-33"><a href="bayesian-models-of-cognition.html#cb524-33" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-34"><a href="bayesian-models-of-cognition.html#cb524-34" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb524-35"><a href="bayesian-models-of-cognition.html#cb524-35" tabindex="-1"></a></span>
<span id="cb524-36"><a href="bayesian-models-of-cognition.html#cb524-36" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb524-37"><a href="bayesian-models-of-cognition.html#cb524-37" tabindex="-1"></a><span class="st">  // Individual-level parameters</span></span>
<span id="cb524-38"><a href="bayesian-models-of-cognition.html#cb524-38" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] scaling_factor;     // Individual scaling factors</span></span>
<span id="cb524-39"><a href="bayesian-models-of-cognition.html#cb524-39" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] alpha_prior;        // Individual alpha prior</span></span>
<span id="cb524-40"><a href="bayesian-models-of-cognition.html#cb524-40" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] beta_prior;         // Individual beta prior</span></span>
<span id="cb524-41"><a href="bayesian-models-of-cognition.html#cb524-41" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-42"><a href="bayesian-models-of-cognition.html#cb524-42" tabindex="-1"></a><span class="st">  // Non-centered parameterization for scaling factor</span></span>
<span id="cb524-43"><a href="bayesian-models-of-cognition.html#cb524-43" tabindex="-1"></a><span class="st">  for (j in 1:J) {</span></span>
<span id="cb524-44"><a href="bayesian-models-of-cognition.html#cb524-44" tabindex="-1"></a><span class="st">    alpha_prior[j] = exp(mu_alpha_prior + z_alpha_prior[j] * sigma_alpha_prior);</span></span>
<span id="cb524-45"><a href="bayesian-models-of-cognition.html#cb524-45" tabindex="-1"></a><span class="st">    beta_prior[j] = exp(mu_beta_prior + z_beta_prior[j] * sigma_beta_prior);</span></span>
<span id="cb524-46"><a href="bayesian-models-of-cognition.html#cb524-46" tabindex="-1"></a><span class="st">    scaling_factor[j] = exp(mu_scaling + z_scaling[j] * sigma_scaling);</span></span>
<span id="cb524-47"><a href="bayesian-models-of-cognition.html#cb524-47" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb524-48"><a href="bayesian-models-of-cognition.html#cb524-48" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb524-49"><a href="bayesian-models-of-cognition.html#cb524-49" tabindex="-1"></a></span>
<span id="cb524-50"><a href="bayesian-models-of-cognition.html#cb524-50" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb524-51"><a href="bayesian-models-of-cognition.html#cb524-51" tabindex="-1"></a><span class="st">  // Priors for population parameters</span></span>
<span id="cb524-52"><a href="bayesian-models-of-cognition.html#cb524-52" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(mu_alpha_prior | 0, 1);         // Prior for population mean of alpha prior</span></span>
<span id="cb524-53"><a href="bayesian-models-of-cognition.html#cb524-53" tabindex="-1"></a><span class="st">  target += exponential_lpdf(sigma_alpha_prior | 1);       // Prior for population SD of alpha prior</span></span>
<span id="cb524-54"><a href="bayesian-models-of-cognition.html#cb524-54" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(mu_beta_prior | 0, 1);          // Prior for population mean of beta prior</span></span>
<span id="cb524-55"><a href="bayesian-models-of-cognition.html#cb524-55" tabindex="-1"></a><span class="st">  target += exponential_lpdf(sigma_beta_prior | 1);        // Prior for population SD of beta prior</span></span>
<span id="cb524-56"><a href="bayesian-models-of-cognition.html#cb524-56" tabindex="-1"></a><span class="st">  target += normal_lpdf(mu_scaling | 0, 1);             // Prior for log scaling factor</span></span>
<span id="cb524-57"><a href="bayesian-models-of-cognition.html#cb524-57" tabindex="-1"></a><span class="st">  target += exponential_lpdf(sigma_scaling | 2);        // Prior for between-subject variability</span></span>
<span id="cb524-58"><a href="bayesian-models-of-cognition.html#cb524-58" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-59"><a href="bayesian-models-of-cognition.html#cb524-59" tabindex="-1"></a><span class="st">  // Prior for standardized random effects</span></span>
<span id="cb524-60"><a href="bayesian-models-of-cognition.html#cb524-60" tabindex="-1"></a><span class="st">  z_scaling ~ std_normal();              // Standard normal prior</span></span>
<span id="cb524-61"><a href="bayesian-models-of-cognition.html#cb524-61" tabindex="-1"></a><span class="st">  z_alpha_prior ~ std_normal();          // Standard normal prior</span></span>
<span id="cb524-62"><a href="bayesian-models-of-cognition.html#cb524-62" tabindex="-1"></a><span class="st">  z_beta_prior ~ std_normal();           // Standard normal prior</span></span>
<span id="cb524-63"><a href="bayesian-models-of-cognition.html#cb524-63" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-64"><a href="bayesian-models-of-cognition.html#cb524-64" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb524-65"><a href="bayesian-models-of-cognition.html#cb524-65" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb524-66"><a href="bayesian-models-of-cognition.html#cb524-66" tabindex="-1"></a><span class="st">    // Calculate the individual scaling factor</span></span>
<span id="cb524-67"><a href="bayesian-models-of-cognition.html#cb524-67" tabindex="-1"></a><span class="st">    real scale = scaling_factor[agent_id[i]];</span></span>
<span id="cb524-68"><a href="bayesian-models-of-cognition.html#cb524-68" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb524-69"><a href="bayesian-models-of-cognition.html#cb524-69" tabindex="-1"></a><span class="st">    // Simple integration - weights both evidence sources equally but applies individual scaling</span></span>
<span id="cb524-70"><a href="bayesian-models-of-cognition.html#cb524-70" tabindex="-1"></a><span class="st">    // Both direct and social evidence get weight = 1.0 * scaling_factor</span></span>
<span id="cb524-71"><a href="bayesian-models-of-cognition.html#cb524-71" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * scale;</span></span>
<span id="cb524-72"><a href="bayesian-models-of-cognition.html#cb524-72" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * scale;</span></span>
<span id="cb524-73"><a href="bayesian-models-of-cognition.html#cb524-73" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * scale;</span></span>
<span id="cb524-74"><a href="bayesian-models-of-cognition.html#cb524-74" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * scale;</span></span>
<span id="cb524-75"><a href="bayesian-models-of-cognition.html#cb524-75" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb524-76"><a href="bayesian-models-of-cognition.html#cb524-76" tabindex="-1"></a><span class="st">    // Calculate Beta parameters for posterior</span></span>
<span id="cb524-77"><a href="bayesian-models-of-cognition.html#cb524-77" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior[agent_id[i]] + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb524-78"><a href="bayesian-models-of-cognition.html#cb524-78" tabindex="-1"></a><span class="st">    real beta_post = beta_prior[agent_id[i]] + weighted_red1 + weighted_red2;</span></span>
<span id="cb524-79"><a href="bayesian-models-of-cognition.html#cb524-79" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb524-80"><a href="bayesian-models-of-cognition.html#cb524-80" tabindex="-1"></a><span class="st">    // Use beta-binomial distribution to model the choice</span></span>
<span id="cb524-81"><a href="bayesian-models-of-cognition.html#cb524-81" tabindex="-1"></a><span class="st">    target += beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb524-82"><a href="bayesian-models-of-cognition.html#cb524-82" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb524-83"><a href="bayesian-models-of-cognition.html#cb524-83" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb524-84"><a href="bayesian-models-of-cognition.html#cb524-84" tabindex="-1"></a></span>
<span id="cb524-85"><a href="bayesian-models-of-cognition.html#cb524-85" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb524-86"><a href="bayesian-models-of-cognition.html#cb524-86" tabindex="-1"></a><span class="st">  // Population parameters on natural scale</span></span>
<span id="cb524-87"><a href="bayesian-models-of-cognition.html#cb524-87" tabindex="-1"></a><span class="st">  real population_scaling = exp(mu_scaling);</span></span>
<span id="cb524-88"><a href="bayesian-models-of-cognition.html#cb524-88" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-89"><a href="bayesian-models-of-cognition.html#cb524-89" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb524-90"><a href="bayesian-models-of-cognition.html#cb524-90" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb524-91"><a href="bayesian-models-of-cognition.html#cb524-91" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-92"><a href="bayesian-models-of-cognition.html#cb524-92" tabindex="-1"></a><span class="st">  // Population and individual predictions</span></span>
<span id="cb524-93"><a href="bayesian-models-of-cognition.html#cb524-93" tabindex="-1"></a><span class="st">  array[N] int pred_choice;</span></span>
<span id="cb524-94"><a href="bayesian-models-of-cognition.html#cb524-94" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb524-95"><a href="bayesian-models-of-cognition.html#cb524-95" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb524-96"><a href="bayesian-models-of-cognition.html#cb524-96" tabindex="-1"></a><span class="st">    // Calculate the individual scaling factor</span></span>
<span id="cb524-97"><a href="bayesian-models-of-cognition.html#cb524-97" tabindex="-1"></a><span class="st">    real scale = scaling_factor[agent_id[i]];</span></span>
<span id="cb524-98"><a href="bayesian-models-of-cognition.html#cb524-98" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb524-99"><a href="bayesian-models-of-cognition.html#cb524-99" tabindex="-1"></a><span class="st">    // Calculate weighted evidence</span></span>
<span id="cb524-100"><a href="bayesian-models-of-cognition.html#cb524-100" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * scale;</span></span>
<span id="cb524-101"><a href="bayesian-models-of-cognition.html#cb524-101" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * scale;</span></span>
<span id="cb524-102"><a href="bayesian-models-of-cognition.html#cb524-102" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * scale;</span></span>
<span id="cb524-103"><a href="bayesian-models-of-cognition.html#cb524-103" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * scale;</span></span>
<span id="cb524-104"><a href="bayesian-models-of-cognition.html#cb524-104" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb524-105"><a href="bayesian-models-of-cognition.html#cb524-105" tabindex="-1"></a><span class="st">    // Calculate Beta parameters</span></span>
<span id="cb524-106"><a href="bayesian-models-of-cognition.html#cb524-106" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior[agent_id[i]] + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb524-107"><a href="bayesian-models-of-cognition.html#cb524-107" tabindex="-1"></a><span class="st">    real beta_post = beta_prior[agent_id[i]] + weighted_red1 + weighted_red2;</span></span>
<span id="cb524-108"><a href="bayesian-models-of-cognition.html#cb524-108" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb524-109"><a href="bayesian-models-of-cognition.html#cb524-109" tabindex="-1"></a><span class="st">    // Generate predictions using beta-binomial</span></span>
<span id="cb524-110"><a href="bayesian-models-of-cognition.html#cb524-110" tabindex="-1"></a><span class="st">    pred_choice[i] = beta_binomial_rng(1, alpha_post, beta_post);</span></span>
<span id="cb524-111"><a href="bayesian-models-of-cognition.html#cb524-111" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb524-112"><a href="bayesian-models-of-cognition.html#cb524-112" tabindex="-1"></a><span class="st">    // Calculate log likelihood</span></span>
<span id="cb524-113"><a href="bayesian-models-of-cognition.html#cb524-113" tabindex="-1"></a><span class="st">    log_lik[i] = beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb524-114"><a href="bayesian-models-of-cognition.html#cb524-114" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb524-115"><a href="bayesian-models-of-cognition.html#cb524-115" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb524-116"><a href="bayesian-models-of-cognition.html#cb524-116" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb524-117"><a href="bayesian-models-of-cognition.html#cb524-117" tabindex="-1"></a></span>
<span id="cb524-118"><a href="bayesian-models-of-cognition.html#cb524-118" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb524-119"><a href="bayesian-models-of-cognition.html#cb524-119" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb524-120"><a href="bayesian-models-of-cognition.html#cb524-120" tabindex="-1"></a>  multilevel_simple_stan,</span>
<span id="cb524-121"><a href="bayesian-models-of-cognition.html#cb524-121" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb524-122"><a href="bayesian-models-of-cognition.html#cb524-122" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10_multilevel_simple_beta_binomial.stan&quot;</span></span>
<span id="cb524-123"><a href="bayesian-models-of-cognition.html#cb524-123" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10_multilevel_simple_beta_binomial.stan&quot;</code></pre>
</div>
</div>
<div id="implementing-the-multilevel-weighted-beta-binomial-model-in-stan" class="section level3 hasAnchor" number="11.21.6">
<h3><span class="header-section-number">11.21.6</span> Implementing the Multilevel Weighted Beta-Binomial Model in Stan<a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s implement the multilevel weighted beta-binomial model, which allows both population-level estimates of evidence weights and individual variations around these population means.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="bayesian-models-of-cognition.html#cb526-1" tabindex="-1"></a>multilevel_weighted_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb526-2"><a href="bayesian-models-of-cognition.html#cb526-2" tabindex="-1"></a><span class="st">// Multilevel Weighted Beta-Binomial Model</span></span>
<span id="cb526-3"><a href="bayesian-models-of-cognition.html#cb526-3" tabindex="-1"></a><span class="st">// This model allows different weights for different evidence sources</span></span>
<span id="cb526-4"><a href="bayesian-models-of-cognition.html#cb526-4" tabindex="-1"></a><span class="st">// Using total_weight and weight_prop parameterization</span></span>
<span id="cb526-5"><a href="bayesian-models-of-cognition.html#cb526-5" tabindex="-1"></a></span>
<span id="cb526-6"><a href="bayesian-models-of-cognition.html#cb526-6" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb526-7"><a href="bayesian-models-of-cognition.html#cb526-7" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Total number of observations</span></span>
<span id="cb526-8"><a href="bayesian-models-of-cognition.html#cb526-8" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; J;                        // Number of subjects</span></span>
<span id="cb526-9"><a href="bayesian-models-of-cognition.html#cb526-9" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1, upper=J&gt; agent_id;  // Agent ID for each observation</span></span>
<span id="cb526-10"><a href="bayesian-models-of-cognition.html#cb526-10" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb526-11"><a href="bayesian-models-of-cognition.html#cb526-11" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles)</span></span>
<span id="cb526-12"><a href="bayesian-models-of-cognition.html#cb526-12" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;          // Total direct evidence</span></span>
<span id="cb526-13"><a href="bayesian-models-of-cognition.html#cb526-13" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals)</span></span>
<span id="cb526-14"><a href="bayesian-models-of-cognition.html#cb526-14" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;          // Total social evidence</span></span>
<span id="cb526-15"><a href="bayesian-models-of-cognition.html#cb526-15" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb526-16"><a href="bayesian-models-of-cognition.html#cb526-16" tabindex="-1"></a></span>
<span id="cb526-17"><a href="bayesian-models-of-cognition.html#cb526-17" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb526-18"><a href="bayesian-models-of-cognition.html#cb526-18" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-19"><a href="bayesian-models-of-cognition.html#cb526-19" tabindex="-1"></a><span class="st">  // Population-level parameters for agents&#39; preconceptions</span></span>
<span id="cb526-20"><a href="bayesian-models-of-cognition.html#cb526-20" tabindex="-1"></a><span class="st">  real mu_alpha_prior;                   // Population mean for alpha prior</span></span>
<span id="cb526-21"><a href="bayesian-models-of-cognition.html#cb526-21" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_alpha_prior;       // Population SD for alpha prior</span></span>
<span id="cb526-22"><a href="bayesian-models-of-cognition.html#cb526-22" tabindex="-1"></a><span class="st">  real mu_beta_prior;                    // Population mean for beta prior</span></span>
<span id="cb526-23"><a href="bayesian-models-of-cognition.html#cb526-23" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_beta_prior;        // Population SD for beta prior</span></span>
<span id="cb526-24"><a href="bayesian-models-of-cognition.html#cb526-24" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-25"><a href="bayesian-models-of-cognition.html#cb526-25" tabindex="-1"></a><span class="st">  // Population-level parameters</span></span>
<span id="cb526-26"><a href="bayesian-models-of-cognition.html#cb526-26" tabindex="-1"></a><span class="st">  real mu_weight_ratio;                  // Population mean for relative weight (direct/social) - log scale</span></span>
<span id="cb526-27"><a href="bayesian-models-of-cognition.html#cb526-27" tabindex="-1"></a><span class="st">  real mu_scaling;                       // Population mean for overall scaling - log scale</span></span>
<span id="cb526-28"><a href="bayesian-models-of-cognition.html#cb526-28" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-29"><a href="bayesian-models-of-cognition.html#cb526-29" tabindex="-1"></a><span class="st">  // Population-level standard deviations</span></span>
<span id="cb526-30"><a href="bayesian-models-of-cognition.html#cb526-30" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_weight_ratio;      // Between-subject variability in relative weighting</span></span>
<span id="cb526-31"><a href="bayesian-models-of-cognition.html#cb526-31" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_scaling;           // Between-subject variability in scaling</span></span>
<span id="cb526-32"><a href="bayesian-models-of-cognition.html#cb526-32" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-33"><a href="bayesian-models-of-cognition.html#cb526-33" tabindex="-1"></a><span class="st">  // Individual-level (random) effects</span></span>
<span id="cb526-34"><a href="bayesian-models-of-cognition.html#cb526-34" tabindex="-1"></a><span class="st">  vector[J] z_weight_ratio;              // Standardized individual weight ratio deviations</span></span>
<span id="cb526-35"><a href="bayesian-models-of-cognition.html#cb526-35" tabindex="-1"></a><span class="st">  vector[J] z_scaling;                   // Standardized individual scaling deviations</span></span>
<span id="cb526-36"><a href="bayesian-models-of-cognition.html#cb526-36" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb526-37"><a href="bayesian-models-of-cognition.html#cb526-37" tabindex="-1"></a></span>
<span id="cb526-38"><a href="bayesian-models-of-cognition.html#cb526-38" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb526-39"><a href="bayesian-models-of-cognition.html#cb526-39" tabindex="-1"></a><span class="st">  // Individual-level parameters</span></span>
<span id="cb526-40"><a href="bayesian-models-of-cognition.html#cb526-40" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_ratio;       // Individual relative weights (direct/social)</span></span>
<span id="cb526-41"><a href="bayesian-models-of-cognition.html#cb526-41" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] scaling_factor;     // Individual overall scaling factors</span></span>
<span id="cb526-42"><a href="bayesian-models-of-cognition.html#cb526-42" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_direct;      // Individual weights for direct evidence</span></span>
<span id="cb526-43"><a href="bayesian-models-of-cognition.html#cb526-43" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_social;      // Individual weights for social evidence</span></span>
<span id="cb526-44"><a href="bayesian-models-of-cognition.html#cb526-44" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-45"><a href="bayesian-models-of-cognition.html#cb526-45" tabindex="-1"></a><span class="st">  // Non-centered parameterization</span></span>
<span id="cb526-46"><a href="bayesian-models-of-cognition.html#cb526-46" tabindex="-1"></a><span class="st">  for (j in 1:J) {</span></span>
<span id="cb526-47"><a href="bayesian-models-of-cognition.html#cb526-47" tabindex="-1"></a><span class="st">    // Transform standardized parameters to natural scale</span></span>
<span id="cb526-48"><a href="bayesian-models-of-cognition.html#cb526-48" tabindex="-1"></a><span class="st">    weight_ratio[j] = exp(mu_weight_ratio + z_weight_ratio[j] * sigma_weight_ratio);</span></span>
<span id="cb526-49"><a href="bayesian-models-of-cognition.html#cb526-49" tabindex="-1"></a><span class="st">    scaling_factor[j] = exp(mu_scaling + z_scaling[j] * sigma_scaling);</span></span>
<span id="cb526-50"><a href="bayesian-models-of-cognition.html#cb526-50" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-51"><a href="bayesian-models-of-cognition.html#cb526-51" tabindex="-1"></a><span class="st">    // Calculate individual weights</span></span>
<span id="cb526-52"><a href="bayesian-models-of-cognition.html#cb526-52" tabindex="-1"></a><span class="st">    // The sum of weights is determined by the scaling factor</span></span>
<span id="cb526-53"><a href="bayesian-models-of-cognition.html#cb526-53" tabindex="-1"></a><span class="st">    // The ratio between weights is determined by weight_ratio</span></span>
<span id="cb526-54"><a href="bayesian-models-of-cognition.html#cb526-54" tabindex="-1"></a><span class="st">    weight_direct[j] = scaling_factor[j] * weight_ratio[j] / (1 + weight_ratio[j]);</span></span>
<span id="cb526-55"><a href="bayesian-models-of-cognition.html#cb526-55" tabindex="-1"></a><span class="st">    weight_social[j] = scaling_factor[j] / (1 + weight_ratio[j]);</span></span>
<span id="cb526-56"><a href="bayesian-models-of-cognition.html#cb526-56" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb526-57"><a href="bayesian-models-of-cognition.html#cb526-57" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb526-58"><a href="bayesian-models-of-cognition.html#cb526-58" tabindex="-1"></a></span>
<span id="cb526-59"><a href="bayesian-models-of-cognition.html#cb526-59" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb526-60"><a href="bayesian-models-of-cognition.html#cb526-60" tabindex="-1"></a><span class="st">  // Priors for population parameters</span></span>
<span id="cb526-61"><a href="bayesian-models-of-cognition.html#cb526-61" tabindex="-1"></a><span class="st">  mu_weight_ratio ~ normal(0, 1);        // Prior for log weight ratio centered at 0 (equal weights)</span></span>
<span id="cb526-62"><a href="bayesian-models-of-cognition.html#cb526-62" tabindex="-1"></a><span class="st">  mu_scaling ~ normal(0, 1);             // Prior for log scaling factor</span></span>
<span id="cb526-63"><a href="bayesian-models-of-cognition.html#cb526-63" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-64"><a href="bayesian-models-of-cognition.html#cb526-64" tabindex="-1"></a><span class="st">  sigma_weight_ratio ~ exponential(2);   // Prior for between-subject variability</span></span>
<span id="cb526-65"><a href="bayesian-models-of-cognition.html#cb526-65" tabindex="-1"></a><span class="st">  sigma_scaling ~ exponential(2);        // Prior for scaling variability</span></span>
<span id="cb526-66"><a href="bayesian-models-of-cognition.html#cb526-66" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-67"><a href="bayesian-models-of-cognition.html#cb526-67" tabindex="-1"></a><span class="st">  // Priors for individual random effects</span></span>
<span id="cb526-68"><a href="bayesian-models-of-cognition.html#cb526-68" tabindex="-1"></a><span class="st">  z_weight_ratio ~ std_normal();         // Standard normal prior for weight ratio z-scores</span></span>
<span id="cb526-69"><a href="bayesian-models-of-cognition.html#cb526-69" tabindex="-1"></a><span class="st">  z_scaling ~ std_normal();              // Standard normal prior for scaling z-scores</span></span>
<span id="cb526-70"><a href="bayesian-models-of-cognition.html#cb526-70" tabindex="-1"></a><span class="st">  z_alpha_prior ~ std_normal();          // Standard normal prior</span></span>
<span id="cb526-71"><a href="bayesian-models-of-cognition.html#cb526-71" tabindex="-1"></a><span class="st">  z_beta_prior ~ std_normal();           // Standard normal prior</span></span>
<span id="cb526-72"><a href="bayesian-models-of-cognition.html#cb526-72" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-73"><a href="bayesian-models-of-cognition.html#cb526-73" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb526-74"><a href="bayesian-models-of-cognition.html#cb526-74" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb526-75"><a href="bayesian-models-of-cognition.html#cb526-75" tabindex="-1"></a><span class="st">    // Get weights for this person</span></span>
<span id="cb526-76"><a href="bayesian-models-of-cognition.html#cb526-76" tabindex="-1"></a><span class="st">    real w_direct = weight_direct[agent_id[i]];</span></span>
<span id="cb526-77"><a href="bayesian-models-of-cognition.html#cb526-77" tabindex="-1"></a><span class="st">    real w_social = weight_social[agent_id[i]];</span></span>
<span id="cb526-78"><a href="bayesian-models-of-cognition.html#cb526-78" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-79"><a href="bayesian-models-of-cognition.html#cb526-79" tabindex="-1"></a><span class="st">    // Calculate weighted evidence</span></span>
<span id="cb526-80"><a href="bayesian-models-of-cognition.html#cb526-80" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * w_direct;</span></span>
<span id="cb526-81"><a href="bayesian-models-of-cognition.html#cb526-81" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * w_direct;</span></span>
<span id="cb526-82"><a href="bayesian-models-of-cognition.html#cb526-82" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * w_social;</span></span>
<span id="cb526-83"><a href="bayesian-models-of-cognition.html#cb526-83" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * w_social;</span></span>
<span id="cb526-84"><a href="bayesian-models-of-cognition.html#cb526-84" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-85"><a href="bayesian-models-of-cognition.html#cb526-85" tabindex="-1"></a><span class="st">    // Calculate Beta parameters for Bayesian integration</span></span>
<span id="cb526-86"><a href="bayesian-models-of-cognition.html#cb526-86" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior[agent_id[i]] + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb526-87"><a href="bayesian-models-of-cognition.html#cb526-87" tabindex="-1"></a><span class="st">    real beta_post = beta_prior[agent_id[i]] + weighted_red1 + weighted_red2;</span></span>
<span id="cb526-88"><a href="bayesian-models-of-cognition.html#cb526-88" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-89"><a href="bayesian-models-of-cognition.html#cb526-89" tabindex="-1"></a><span class="st">    // Use beta-binomial distribution to model the choice</span></span>
<span id="cb526-90"><a href="bayesian-models-of-cognition.html#cb526-90" tabindex="-1"></a><span class="st">    target += beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb526-91"><a href="bayesian-models-of-cognition.html#cb526-91" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb526-92"><a href="bayesian-models-of-cognition.html#cb526-92" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb526-93"><a href="bayesian-models-of-cognition.html#cb526-93" tabindex="-1"></a></span>
<span id="cb526-94"><a href="bayesian-models-of-cognition.html#cb526-94" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb526-95"><a href="bayesian-models-of-cognition.html#cb526-95" tabindex="-1"></a><span class="st">  // Convert population parameters to original weight scale for interpretation</span></span>
<span id="cb526-96"><a href="bayesian-models-of-cognition.html#cb526-96" tabindex="-1"></a><span class="st">  real population_ratio = exp(mu_weight_ratio);</span></span>
<span id="cb526-97"><a href="bayesian-models-of-cognition.html#cb526-97" tabindex="-1"></a><span class="st">  real population_scaling = exp(mu_scaling);</span></span>
<span id="cb526-98"><a href="bayesian-models-of-cognition.html#cb526-98" tabindex="-1"></a><span class="st">  real population_weight_direct = population_scaling * population_ratio / (1 + population_ratio);</span></span>
<span id="cb526-99"><a href="bayesian-models-of-cognition.html#cb526-99" tabindex="-1"></a><span class="st">  real population_weight_social = population_scaling / (1 + population_ratio);</span></span>
<span id="cb526-100"><a href="bayesian-models-of-cognition.html#cb526-100" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-101"><a href="bayesian-models-of-cognition.html#cb526-101" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb526-102"><a href="bayesian-models-of-cognition.html#cb526-102" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb526-103"><a href="bayesian-models-of-cognition.html#cb526-103" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-104"><a href="bayesian-models-of-cognition.html#cb526-104" tabindex="-1"></a><span class="st">  // Population and individual predictions</span></span>
<span id="cb526-105"><a href="bayesian-models-of-cognition.html#cb526-105" tabindex="-1"></a><span class="st">  array[N] int pred_choice;</span></span>
<span id="cb526-106"><a href="bayesian-models-of-cognition.html#cb526-106" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb526-107"><a href="bayesian-models-of-cognition.html#cb526-107" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb526-108"><a href="bayesian-models-of-cognition.html#cb526-108" tabindex="-1"></a><span class="st">    // Get weights for this person</span></span>
<span id="cb526-109"><a href="bayesian-models-of-cognition.html#cb526-109" tabindex="-1"></a><span class="st">    real w_direct = weight_direct[agent_id[i]];</span></span>
<span id="cb526-110"><a href="bayesian-models-of-cognition.html#cb526-110" tabindex="-1"></a><span class="st">    real w_social = weight_social[agent_id[i]];</span></span>
<span id="cb526-111"><a href="bayesian-models-of-cognition.html#cb526-111" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-112"><a href="bayesian-models-of-cognition.html#cb526-112" tabindex="-1"></a><span class="st">    // Calculate weighted evidence</span></span>
<span id="cb526-113"><a href="bayesian-models-of-cognition.html#cb526-113" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[i] * w_direct;</span></span>
<span id="cb526-114"><a href="bayesian-models-of-cognition.html#cb526-114" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[i] - blue1[i]) * w_direct;</span></span>
<span id="cb526-115"><a href="bayesian-models-of-cognition.html#cb526-115" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[i] * w_social;</span></span>
<span id="cb526-116"><a href="bayesian-models-of-cognition.html#cb526-116" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[i] - blue2[i]) * w_social;</span></span>
<span id="cb526-117"><a href="bayesian-models-of-cognition.html#cb526-117" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-118"><a href="bayesian-models-of-cognition.html#cb526-118" tabindex="-1"></a><span class="st">    // Calculate Beta parameters</span></span>
<span id="cb526-119"><a href="bayesian-models-of-cognition.html#cb526-119" tabindex="-1"></a><span class="st">    real alpha_post = alpha_prior[agent_id[i]] + weighted_blue1 + weighted_blue2;</span></span>
<span id="cb526-120"><a href="bayesian-models-of-cognition.html#cb526-120" tabindex="-1"></a><span class="st">    real beta_post = beta_prior[agent_id[i]] + weighted_red1 + weighted_red2;</span></span>
<span id="cb526-121"><a href="bayesian-models-of-cognition.html#cb526-121" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-122"><a href="bayesian-models-of-cognition.html#cb526-122" tabindex="-1"></a><span class="st">    // Generate predictions using beta-binomial</span></span>
<span id="cb526-123"><a href="bayesian-models-of-cognition.html#cb526-123" tabindex="-1"></a><span class="st">    pred_choice[i] = beta_binomial_rng(1, alpha_post, beta_post);</span></span>
<span id="cb526-124"><a href="bayesian-models-of-cognition.html#cb526-124" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb526-125"><a href="bayesian-models-of-cognition.html#cb526-125" tabindex="-1"></a><span class="st">    // Calculate log likelihood</span></span>
<span id="cb526-126"><a href="bayesian-models-of-cognition.html#cb526-126" tabindex="-1"></a><span class="st">    log_lik[i] = beta_binomial_lpmf(choice[i] | 1, alpha_post, beta_post);</span></span>
<span id="cb526-127"><a href="bayesian-models-of-cognition.html#cb526-127" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb526-128"><a href="bayesian-models-of-cognition.html#cb526-128" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb526-129"><a href="bayesian-models-of-cognition.html#cb526-129" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb526-130"><a href="bayesian-models-of-cognition.html#cb526-130" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb526-131"><a href="bayesian-models-of-cognition.html#cb526-131" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb526-132"><a href="bayesian-models-of-cognition.html#cb526-132" tabindex="-1"></a>  multilevel_weighted_stan,</span>
<span id="cb526-133"><a href="bayesian-models-of-cognition.html#cb526-133" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb526-134"><a href="bayesian-models-of-cognition.html#cb526-134" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10_multilevel_weighted_beta_binomial.stan&quot;</span></span>
<span id="cb526-135"><a href="bayesian-models-of-cognition.html#cb526-135" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10_multilevel_weighted_beta_binomial.stan&quot;</code></pre>
</div>
</div>
<div id="fitting-the-multilevel-models" class="section level2 hasAnchor" number="11.22">
<h2><span class="header-section-number">11.22</span> Fitting the Multilevel Models<a href="bayesian-models-of-cognition.html#fitting-the-multilevel-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we’ve generated data from both simple and weighted integration strategies, we can fit our two multilevel models to this data. This will allow us to:</p>
<ol style="list-style-type: decimal">
<li>Evaluate our ability to recover the true parameters</li>
<li>Compare the models to determine which better explains the observed decisions</li>
<li>Assess whether we can correctly identify which cognitive strategy generated each agent’s data</li>
</ol>
<p>We’ll fit both models to the full dataset, which contains a mixture of simple and weighted integration agents. This represents a realistic scenario where we don’t know in advance which strategy each individual is using.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="bayesian-models-of-cognition.html#cb528-1" tabindex="-1"></a><span class="co"># Fitting the Multilevel Models to Simulated Data</span></span>
<span id="cb528-2"><a href="bayesian-models-of-cognition.html#cb528-2" tabindex="-1"></a><span class="co"># We&#39;ll fit both the simple and weighted integration models to our simulated data</span></span>
<span id="cb528-3"><a href="bayesian-models-of-cognition.html#cb528-3" tabindex="-1"></a></span>
<span id="cb528-4"><a href="bayesian-models-of-cognition.html#cb528-4" tabindex="-1"></a><span class="co"># Create file paths for Stan models</span></span>
<span id="cb528-5"><a href="bayesian-models-of-cognition.html#cb528-5" tabindex="-1"></a>file_simple_ml <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10_multilevel_simple_beta_binomial.stan&quot;</span>)</span>
<span id="cb528-6"><a href="bayesian-models-of-cognition.html#cb528-6" tabindex="-1"></a>file_weighted_ml <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10_multilevel_weighted_beta_binomial.stan&quot;</span>)</span>
<span id="cb528-7"><a href="bayesian-models-of-cognition.html#cb528-7" tabindex="-1"></a></span>
<span id="cb528-8"><a href="bayesian-models-of-cognition.html#cb528-8" tabindex="-1"></a><span class="co"># Check if we need to regenerate model fits or load existing ones</span></span>
<span id="cb528-9"><a href="bayesian-models-of-cognition.html#cb528-9" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb528-10"><a href="bayesian-models-of-cognition.html#cb528-10" tabindex="-1"></a>  <span class="co"># Compile Stan models</span></span>
<span id="cb528-11"><a href="bayesian-models-of-cognition.html#cb528-11" tabindex="-1"></a>  mod_simple_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb528-12"><a href="bayesian-models-of-cognition.html#cb528-12" tabindex="-1"></a>    file_simple_ml, </span>
<span id="cb528-13"><a href="bayesian-models-of-cognition.html#cb528-13" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb528-14"><a href="bayesian-models-of-cognition.html#cb528-14" tabindex="-1"></a>  )</span>
<span id="cb528-15"><a href="bayesian-models-of-cognition.html#cb528-15" tabindex="-1"></a>  </span>
<span id="cb528-16"><a href="bayesian-models-of-cognition.html#cb528-16" tabindex="-1"></a>  mod_weighted_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb528-17"><a href="bayesian-models-of-cognition.html#cb528-17" tabindex="-1"></a>    file_weighted_ml, </span>
<span id="cb528-18"><a href="bayesian-models-of-cognition.html#cb528-18" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb528-19"><a href="bayesian-models-of-cognition.html#cb528-19" tabindex="-1"></a>  )</span>
<span id="cb528-20"><a href="bayesian-models-of-cognition.html#cb528-20" tabindex="-1"></a>  </span>
<span id="cb528-21"><a href="bayesian-models-of-cognition.html#cb528-21" tabindex="-1"></a>  <span class="co"># Fit the simple multilevel model</span></span>
<span id="cb528-22"><a href="bayesian-models-of-cognition.html#cb528-22" tabindex="-1"></a>  <span class="co"># This model assumes equal weights for evidence sources but allows individual scaling</span></span>
<span id="cb528-23"><a href="bayesian-models-of-cognition.html#cb528-23" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Fitting the simple multilevel model...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb528-24"><a href="bayesian-models-of-cognition.html#cb528-24" tabindex="-1"></a>  </span>
<span id="cb528-25"><a href="bayesian-models-of-cognition.html#cb528-25" tabindex="-1"></a>  fit_simple_ml <span class="ot">&lt;-</span> mod_simple_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb528-26"><a href="bayesian-models-of-cognition.html#cb528-26" tabindex="-1"></a>    <span class="at">data =</span> stan_data_multilevel,     <span class="co"># Data for all agents (both types)</span></span>
<span id="cb528-27"><a href="bayesian-models-of-cognition.html#cb528-27" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">242</span>,                       <span class="co"># Seed for reproducibility</span></span>
<span id="cb528-28"><a href="bayesian-models-of-cognition.html#cb528-28" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,                      <span class="co"># Number of MCMC chains</span></span>
<span id="cb528-29"><a href="bayesian-models-of-cognition.html#cb528-29" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,             <span class="co"># Run chains in parallel</span></span>
<span id="cb528-30"><a href="bayesian-models-of-cognition.html#cb528-30" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,           <span class="co"># Stan threading</span></span>
<span id="cb528-31"><a href="bayesian-models-of-cognition.html#cb528-31" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,              <span class="co"># Warmup iterations</span></span>
<span id="cb528-32"><a href="bayesian-models-of-cognition.html#cb528-32" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,            <span class="co"># Sampling iterations</span></span>
<span id="cb528-33"><a href="bayesian-models-of-cognition.html#cb528-33" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">100</span>,                   <span class="co"># Progress update frequency</span></span>
<span id="cb528-34"><a href="bayesian-models-of-cognition.html#cb528-34" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.9</span>,               <span class="co"># Adaptation parameter for HMC</span></span>
<span id="cb528-35"><a href="bayesian-models-of-cognition.html#cb528-35" tabindex="-1"></a>    <span class="at">max_treedepth =</span> <span class="dv">12</span>               <span class="co"># Maximum tree depth for HMC</span></span>
<span id="cb528-36"><a href="bayesian-models-of-cognition.html#cb528-36" tabindex="-1"></a>  )</span>
<span id="cb528-37"><a href="bayesian-models-of-cognition.html#cb528-37" tabindex="-1"></a>  </span>
<span id="cb528-38"><a href="bayesian-models-of-cognition.html#cb528-38" tabindex="-1"></a>  <span class="co"># Fit the weighted multilevel model</span></span>
<span id="cb528-39"><a href="bayesian-models-of-cognition.html#cb528-39" tabindex="-1"></a>  <span class="co"># This model allows different weights for different evidence sources</span></span>
<span id="cb528-40"><a href="bayesian-models-of-cognition.html#cb528-40" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Fitting the weighted multilevel model...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb528-41"><a href="bayesian-models-of-cognition.html#cb528-41" tabindex="-1"></a>  </span>
<span id="cb528-42"><a href="bayesian-models-of-cognition.html#cb528-42" tabindex="-1"></a>  fit_weighted_ml <span class="ot">&lt;-</span> mod_weighted_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb528-43"><a href="bayesian-models-of-cognition.html#cb528-43" tabindex="-1"></a>    <span class="at">data =</span> stan_data_multilevel,     <span class="co"># Same data as simple model</span></span>
<span id="cb528-44"><a href="bayesian-models-of-cognition.html#cb528-44" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">143</span>,                       <span class="co"># Different seed</span></span>
<span id="cb528-45"><a href="bayesian-models-of-cognition.html#cb528-45" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,                      <span class="co"># Number of MCMC chains</span></span>
<span id="cb528-46"><a href="bayesian-models-of-cognition.html#cb528-46" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,             <span class="co"># Run chains in parallel</span></span>
<span id="cb528-47"><a href="bayesian-models-of-cognition.html#cb528-47" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,           <span class="co"># Stan threading</span></span>
<span id="cb528-48"><a href="bayesian-models-of-cognition.html#cb528-48" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,              <span class="co"># Warmup iterations</span></span>
<span id="cb528-49"><a href="bayesian-models-of-cognition.html#cb528-49" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,            <span class="co"># Sampling iterations</span></span>
<span id="cb528-50"><a href="bayesian-models-of-cognition.html#cb528-50" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">100</span>,                   <span class="co"># Progress update frequency</span></span>
<span id="cb528-51"><a href="bayesian-models-of-cognition.html#cb528-51" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.95</span>,              <span class="co"># Higher adapt_delta for stability</span></span>
<span id="cb528-52"><a href="bayesian-models-of-cognition.html#cb528-52" tabindex="-1"></a>    <span class="at">max_treedepth =</span> <span class="dv">12</span>               <span class="co"># Maximum tree depth for HMC</span></span>
<span id="cb528-53"><a href="bayesian-models-of-cognition.html#cb528-53" tabindex="-1"></a>  )</span>
<span id="cb528-54"><a href="bayesian-models-of-cognition.html#cb528-54" tabindex="-1"></a>  </span>
<span id="cb528-55"><a href="bayesian-models-of-cognition.html#cb528-55" tabindex="-1"></a>  <span class="co"># Save model fits for future use</span></span>
<span id="cb528-56"><a href="bayesian-models-of-cognition.html#cb528-56" tabindex="-1"></a>  fit_simple_ml<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_multilevel_simple_mixed.rds&quot;</span>)</span>
<span id="cb528-57"><a href="bayesian-models-of-cognition.html#cb528-57" tabindex="-1"></a>  fit_weighted_ml<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_multilevel_weighted_mixed.rds&quot;</span>)</span>
<span id="cb528-58"><a href="bayesian-models-of-cognition.html#cb528-58" tabindex="-1"></a>  </span>
<span id="cb528-59"><a href="bayesian-models-of-cognition.html#cb528-59" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Models fitted and saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb528-60"><a href="bayesian-models-of-cognition.html#cb528-60" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb528-61"><a href="bayesian-models-of-cognition.html#cb528-61" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb528-62"><a href="bayesian-models-of-cognition.html#cb528-62" tabindex="-1"></a>  fit_simple_ml <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_multilevel_simple_mixed.rds&quot;</span>)</span>
<span id="cb528-63"><a href="bayesian-models-of-cognition.html#cb528-63" tabindex="-1"></a>  fit_weighted_ml <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_multilevel_weighted_mixed.rds&quot;</span>)</span>
<span id="cb528-64"><a href="bayesian-models-of-cognition.html#cb528-64" tabindex="-1"></a>  </span>
<span id="cb528-65"><a href="bayesian-models-of-cognition.html#cb528-65" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb528-66"><a href="bayesian-models-of-cognition.html#cb528-66" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing model fits.</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="bayesian-models-of-cognition.html#cb530-1" tabindex="-1"></a><span class="co"># Check for convergence issues</span></span>
<span id="cb530-2"><a href="bayesian-models-of-cognition.html#cb530-2" tabindex="-1"></a><span class="co"># For simple model</span></span>
<span id="cb530-3"><a href="bayesian-models-of-cognition.html#cb530-3" tabindex="-1"></a>simple_summary <span class="ot">&lt;-</span> fit_simple_ml<span class="sc">$</span><span class="fu">summary</span>()</span>
<span id="cb530-4"><a href="bayesian-models-of-cognition.html#cb530-4" tabindex="-1"></a>simple_rhat_issues <span class="ot">&lt;-</span> simple_summary <span class="sc">%&gt;%</span></span>
<span id="cb530-5"><a href="bayesian-models-of-cognition.html#cb530-5" tabindex="-1"></a>  <span class="fu">filter</span>(rhat <span class="sc">&gt;</span> <span class="fl">1.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb530-6"><a href="bayesian-models-of-cognition.html#cb530-6" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb530-7"><a href="bayesian-models-of-cognition.html#cb530-7" tabindex="-1"></a></span>
<span id="cb530-8"><a href="bayesian-models-of-cognition.html#cb530-8" tabindex="-1"></a><span class="co"># For weighted model</span></span>
<span id="cb530-9"><a href="bayesian-models-of-cognition.html#cb530-9" tabindex="-1"></a>weighted_summary <span class="ot">&lt;-</span> fit_weighted_ml<span class="sc">$</span><span class="fu">summary</span>()</span>
<span id="cb530-10"><a href="bayesian-models-of-cognition.html#cb530-10" tabindex="-1"></a>weighted_rhat_issues <span class="ot">&lt;-</span> weighted_summary <span class="sc">%&gt;%</span></span>
<span id="cb530-11"><a href="bayesian-models-of-cognition.html#cb530-11" tabindex="-1"></a>  <span class="fu">filter</span>(rhat <span class="sc">&gt;</span> <span class="fl">1.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb530-12"><a href="bayesian-models-of-cognition.html#cb530-12" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb530-13"><a href="bayesian-models-of-cognition.html#cb530-13" tabindex="-1"></a></span>
<span id="cb530-14"><a href="bayesian-models-of-cognition.html#cb530-14" tabindex="-1"></a><span class="co"># Print convergence summary</span></span>
<span id="cb530-15"><a href="bayesian-models-of-cognition.html#cb530-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Convergence check:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Convergence check:</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="bayesian-models-of-cognition.html#cb532-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simple model parameters with Rhat &gt; 1.05:&quot;</span>, simple_rhat_issues, <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(simple_summary), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simple model parameters with Rhat &gt; 1.05: 0 out of 14484</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="bayesian-models-of-cognition.html#cb534-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weighted model parameters with Rhat &gt; 1.05:&quot;</span>, weighted_rhat_issues, <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(weighted_summary), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weighted model parameters with Rhat &gt; 1.05: 0 out of 14649</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="bayesian-models-of-cognition.html#cb536-1" tabindex="-1"></a><span class="co"># Extract posterior samples for key parameters</span></span>
<span id="cb536-2"><a href="bayesian-models-of-cognition.html#cb536-2" tabindex="-1"></a><span class="co"># From simple model</span></span>
<span id="cb536-3"><a href="bayesian-models-of-cognition.html#cb536-3" tabindex="-1"></a>draws_simple <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_simple_ml<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb536-4"><a href="bayesian-models-of-cognition.html#cb536-4" tabindex="-1"></a>population_scaling_simple <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(draws_simple<span class="sc">$</span>mu_scaling))</span>
<span id="cb536-5"><a href="bayesian-models-of-cognition.html#cb536-5" tabindex="-1"></a>population_scaling_sd_simple <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_simple<span class="sc">$</span>sigma_scaling)</span>
<span id="cb536-6"><a href="bayesian-models-of-cognition.html#cb536-6" tabindex="-1"></a></span>
<span id="cb536-7"><a href="bayesian-models-of-cognition.html#cb536-7" tabindex="-1"></a><span class="co"># From weighted model</span></span>
<span id="cb536-8"><a href="bayesian-models-of-cognition.html#cb536-8" tabindex="-1"></a>draws_weighted <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_weighted_ml<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb536-9"><a href="bayesian-models-of-cognition.html#cb536-9" tabindex="-1"></a>population_ratio_weighted <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(draws_weighted<span class="sc">$</span>mu_weight_ratio))</span>
<span id="cb536-10"><a href="bayesian-models-of-cognition.html#cb536-10" tabindex="-1"></a>population_scaling_weighted <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(draws_weighted<span class="sc">$</span>mu_scaling))</span>
<span id="cb536-11"><a href="bayesian-models-of-cognition.html#cb536-11" tabindex="-1"></a>population_ratio_sd_weighted <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted<span class="sc">$</span>sigma_weight_ratio)</span>
<span id="cb536-12"><a href="bayesian-models-of-cognition.html#cb536-12" tabindex="-1"></a>population_scaling_sd_weighted <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_weighted<span class="sc">$</span>sigma_scaling)</span>
<span id="cb536-13"><a href="bayesian-models-of-cognition.html#cb536-13" tabindex="-1"></a></span>
<span id="cb536-14"><a href="bayesian-models-of-cognition.html#cb536-14" tabindex="-1"></a><span class="co"># Print population-level parameter estimates</span></span>
<span id="cb536-15"><a href="bayesian-models-of-cognition.html#cb536-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Population parameter estimates:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Population parameter estimates:</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="bayesian-models-of-cognition.html#cb538-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simple model:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simple model:</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="bayesian-models-of-cognition.html#cb540-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Mean scaling factor:&quot;</span>, <span class="fu">round</span>(population_scaling_simple, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   Mean scaling factor: 2.3</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="bayesian-models-of-cognition.html#cb542-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  SD of log scaling:&quot;</span>, <span class="fu">round</span>(population_scaling_sd_simple, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   SD of log scaling: 0.19</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="bayesian-models-of-cognition.html#cb544-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weighted model:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weighted model:</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="bayesian-models-of-cognition.html#cb546-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Mean scaling factor:&quot;</span>, <span class="fu">round</span>(population_scaling_weighted, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   Mean scaling factor: 3.29</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="bayesian-models-of-cognition.html#cb548-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Mean weight ratio (direct/social):&quot;</span>, <span class="fu">round</span>(population_ratio_weighted, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   Mean weight ratio (direct/social): 1.56</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="bayesian-models-of-cognition.html#cb550-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  SD of log scaling:&quot;</span>, <span class="fu">round</span>(population_scaling_sd_weighted, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   SD of log scaling: 0.18</code></pre>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="bayesian-models-of-cognition.html#cb552-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  SD of log weight ratio:&quot;</span>, <span class="fu">round</span>(population_ratio_sd_weighted, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   SD of log weight ratio: 0.4</code></pre>
<div id="parameter-recovery-analysis-1" class="section level3 hasAnchor" number="11.22.1">
<h3><span class="header-section-number">11.22.1</span> Parameter Recovery Analysis<a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we’ve fitted both models, let’s examine how well we can recover the true individual parameters. This is a crucial step in validating our models - if we can’t recover the parameters that generated our data, we might need to refine our models or collect more data.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="bayesian-models-of-cognition.html#cb554-1" tabindex="-1"></a><span class="co"># Extract individual parameter estimates from both models</span></span>
<span id="cb554-2"><a href="bayesian-models-of-cognition.html#cb554-2" tabindex="-1"></a><span class="co"># For simple model (scaling factor only)</span></span>
<span id="cb554-3"><a href="bayesian-models-of-cognition.html#cb554-3" tabindex="-1"></a>scaling_factor_simple <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_simple), <span class="at">ncol =</span> n_agents <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb554-4"><a href="bayesian-models-of-cognition.html#cb554-4" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_agents <span class="sc">*</span> <span class="dv">2</span>)) {</span>
<span id="cb554-5"><a href="bayesian-models-of-cognition.html#cb554-5" tabindex="-1"></a>  scaling_factor_simple[, j] <span class="ot">&lt;-</span> draws_simple[[<span class="fu">paste0</span>(<span class="st">&quot;scaling_factor[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb554-6"><a href="bayesian-models-of-cognition.html#cb554-6" tabindex="-1"></a>}</span>
<span id="cb554-7"><a href="bayesian-models-of-cognition.html#cb554-7" tabindex="-1"></a></span>
<span id="cb554-8"><a href="bayesian-models-of-cognition.html#cb554-8" tabindex="-1"></a><span class="co"># Calculate posterior means</span></span>
<span id="cb554-9"><a href="bayesian-models-of-cognition.html#cb554-9" tabindex="-1"></a>scaling_factor_simple_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(scaling_factor_simple)</span>
<span id="cb554-10"><a href="bayesian-models-of-cognition.html#cb554-10" tabindex="-1"></a></span>
<span id="cb554-11"><a href="bayesian-models-of-cognition.html#cb554-11" tabindex="-1"></a><span class="co"># For weighted model (scaling factor and weight ratio)</span></span>
<span id="cb554-12"><a href="bayesian-models-of-cognition.html#cb554-12" tabindex="-1"></a>scaling_factor_weighted <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_weighted), <span class="at">ncol =</span> n_agents <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb554-13"><a href="bayesian-models-of-cognition.html#cb554-13" tabindex="-1"></a>weight_ratio_weighted <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_weighted), <span class="at">ncol =</span> n_agents <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb554-14"><a href="bayesian-models-of-cognition.html#cb554-14" tabindex="-1"></a>weight_direct_weighted <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_weighted), <span class="at">ncol =</span> n_agents <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb554-15"><a href="bayesian-models-of-cognition.html#cb554-15" tabindex="-1"></a>weight_social_weighted <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(draws_weighted), <span class="at">ncol =</span> n_agents <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb554-16"><a href="bayesian-models-of-cognition.html#cb554-16" tabindex="-1"></a></span>
<span id="cb554-17"><a href="bayesian-models-of-cognition.html#cb554-17" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_agents <span class="sc">*</span> <span class="dv">2</span>)) {</span>
<span id="cb554-18"><a href="bayesian-models-of-cognition.html#cb554-18" tabindex="-1"></a>  scaling_factor_weighted[, j] <span class="ot">&lt;-</span> draws_weighted[[<span class="fu">paste0</span>(<span class="st">&quot;scaling_factor[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb554-19"><a href="bayesian-models-of-cognition.html#cb554-19" tabindex="-1"></a>  weight_ratio_weighted[, j] <span class="ot">&lt;-</span> draws_weighted[[<span class="fu">paste0</span>(<span class="st">&quot;weight_ratio[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb554-20"><a href="bayesian-models-of-cognition.html#cb554-20" tabindex="-1"></a>  weight_direct_weighted[, j] <span class="ot">&lt;-</span> draws_weighted[[<span class="fu">paste0</span>(<span class="st">&quot;weight_direct[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb554-21"><a href="bayesian-models-of-cognition.html#cb554-21" tabindex="-1"></a>  weight_social_weighted[, j] <span class="ot">&lt;-</span> draws_weighted[[<span class="fu">paste0</span>(<span class="st">&quot;weight_social[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb554-22"><a href="bayesian-models-of-cognition.html#cb554-22" tabindex="-1"></a>}</span>
<span id="cb554-23"><a href="bayesian-models-of-cognition.html#cb554-23" tabindex="-1"></a></span>
<span id="cb554-24"><a href="bayesian-models-of-cognition.html#cb554-24" tabindex="-1"></a><span class="co"># Calculate posterior means</span></span>
<span id="cb554-25"><a href="bayesian-models-of-cognition.html#cb554-25" tabindex="-1"></a>scaling_factor_weighted_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(scaling_factor_weighted)</span>
<span id="cb554-26"><a href="bayesian-models-of-cognition.html#cb554-26" tabindex="-1"></a>weight_ratio_weighted_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_ratio_weighted)</span>
<span id="cb554-27"><a href="bayesian-models-of-cognition.html#cb554-27" tabindex="-1"></a>weight_direct_weighted_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_direct_weighted)</span>
<span id="cb554-28"><a href="bayesian-models-of-cognition.html#cb554-28" tabindex="-1"></a>weight_social_weighted_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_social_weighted)</span>
<span id="cb554-29"><a href="bayesian-models-of-cognition.html#cb554-29" tabindex="-1"></a></span>
<span id="cb554-30"><a href="bayesian-models-of-cognition.html#cb554-30" tabindex="-1"></a><span class="co"># Create dataframe for recovery analysis</span></span>
<span id="cb554-31"><a href="bayesian-models-of-cognition.html#cb554-31" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb554-32"><a href="bayesian-models-of-cognition.html#cb554-32" tabindex="-1"></a>  <span class="at">agent_id =</span> <span class="dv">1</span><span class="sc">:</span>(n_agents <span class="sc">*</span> <span class="dv">2</span>),</span>
<span id="cb554-33"><a href="bayesian-models-of-cognition.html#cb554-33" tabindex="-1"></a>  <span class="at">model_type =</span> all_agents<span class="sc">$</span>model_type,</span>
<span id="cb554-34"><a href="bayesian-models-of-cognition.html#cb554-34" tabindex="-1"></a>  </span>
<span id="cb554-35"><a href="bayesian-models-of-cognition.html#cb554-35" tabindex="-1"></a>  <span class="co"># True parameters</span></span>
<span id="cb554-36"><a href="bayesian-models-of-cognition.html#cb554-36" tabindex="-1"></a>  <span class="at">true_scaling_factor =</span> all_agents<span class="sc">$</span>scaling_factor,</span>
<span id="cb554-37"><a href="bayesian-models-of-cognition.html#cb554-37" tabindex="-1"></a>  <span class="at">true_weight_ratio =</span> all_agents<span class="sc">$</span>weight_ratio,</span>
<span id="cb554-38"><a href="bayesian-models-of-cognition.html#cb554-38" tabindex="-1"></a>  <span class="at">true_weight_direct =</span> all_agents<span class="sc">$</span>weight_direct,</span>
<span id="cb554-39"><a href="bayesian-models-of-cognition.html#cb554-39" tabindex="-1"></a>  <span class="at">true_weight_social =</span> all_agents<span class="sc">$</span>weight_social,</span>
<span id="cb554-40"><a href="bayesian-models-of-cognition.html#cb554-40" tabindex="-1"></a>  </span>
<span id="cb554-41"><a href="bayesian-models-of-cognition.html#cb554-41" tabindex="-1"></a>  <span class="co"># Estimated from simple model</span></span>
<span id="cb554-42"><a href="bayesian-models-of-cognition.html#cb554-42" tabindex="-1"></a>  <span class="at">est_scaling_simple =</span> scaling_factor_simple_est,</span>
<span id="cb554-43"><a href="bayesian-models-of-cognition.html#cb554-43" tabindex="-1"></a>  </span>
<span id="cb554-44"><a href="bayesian-models-of-cognition.html#cb554-44" tabindex="-1"></a>  <span class="co"># Estimated from weighted model</span></span>
<span id="cb554-45"><a href="bayesian-models-of-cognition.html#cb554-45" tabindex="-1"></a>  <span class="at">est_scaling_weighted =</span> scaling_factor_weighted_est,</span>
<span id="cb554-46"><a href="bayesian-models-of-cognition.html#cb554-46" tabindex="-1"></a>  <span class="at">est_ratio_weighted =</span> weight_ratio_weighted_est,</span>
<span id="cb554-47"><a href="bayesian-models-of-cognition.html#cb554-47" tabindex="-1"></a>  <span class="at">est_direct_weighted =</span> weight_direct_weighted_est,</span>
<span id="cb554-48"><a href="bayesian-models-of-cognition.html#cb554-48" tabindex="-1"></a>  <span class="at">est_social_weighted =</span> weight_social_weighted_est</span>
<span id="cb554-49"><a href="bayesian-models-of-cognition.html#cb554-49" tabindex="-1"></a>)</span>
<span id="cb554-50"><a href="bayesian-models-of-cognition.html#cb554-50" tabindex="-1"></a></span>
<span id="cb554-51"><a href="bayesian-models-of-cognition.html#cb554-51" tabindex="-1"></a><span class="co"># Calculate recovery accuracy metrics</span></span>
<span id="cb554-52"><a href="bayesian-models-of-cognition.html#cb554-52" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb554-53"><a href="bayesian-models-of-cognition.html#cb554-53" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb554-54"><a href="bayesian-models-of-cognition.html#cb554-54" tabindex="-1"></a>    <span class="co"># Error in scaling factor estimates</span></span>
<span id="cb554-55"><a href="bayesian-models-of-cognition.html#cb554-55" tabindex="-1"></a>    <span class="at">error_scaling_simple =</span> est_scaling_simple <span class="sc">-</span> true_scaling_factor,</span>
<span id="cb554-56"><a href="bayesian-models-of-cognition.html#cb554-56" tabindex="-1"></a>    <span class="at">pct_error_scaling_simple =</span> <span class="dv">100</span> <span class="sc">*</span> error_scaling_simple <span class="sc">/</span> true_scaling_factor,</span>
<span id="cb554-57"><a href="bayesian-models-of-cognition.html#cb554-57" tabindex="-1"></a>    </span>
<span id="cb554-58"><a href="bayesian-models-of-cognition.html#cb554-58" tabindex="-1"></a>    <span class="at">error_scaling_weighted =</span> est_scaling_weighted <span class="sc">-</span> true_scaling_factor,</span>
<span id="cb554-59"><a href="bayesian-models-of-cognition.html#cb554-59" tabindex="-1"></a>    <span class="at">pct_error_scaling_weighted =</span> <span class="dv">100</span> <span class="sc">*</span> error_scaling_weighted <span class="sc">/</span> true_scaling_factor,</span>
<span id="cb554-60"><a href="bayesian-models-of-cognition.html#cb554-60" tabindex="-1"></a>    </span>
<span id="cb554-61"><a href="bayesian-models-of-cognition.html#cb554-61" tabindex="-1"></a>    <span class="co"># Error in weight ratio estimates (only for weighted model)</span></span>
<span id="cb554-62"><a href="bayesian-models-of-cognition.html#cb554-62" tabindex="-1"></a>    <span class="at">error_ratio_weighted =</span> est_ratio_weighted <span class="sc">-</span> true_weight_ratio,</span>
<span id="cb554-63"><a href="bayesian-models-of-cognition.html#cb554-63" tabindex="-1"></a>    <span class="at">pct_error_ratio_weighted =</span> <span class="dv">100</span> <span class="sc">*</span> error_ratio_weighted <span class="sc">/</span> true_weight_ratio,</span>
<span id="cb554-64"><a href="bayesian-models-of-cognition.html#cb554-64" tabindex="-1"></a>    </span>
<span id="cb554-65"><a href="bayesian-models-of-cognition.html#cb554-65" tabindex="-1"></a>    <span class="co"># Error in direct/social weight estimates</span></span>
<span id="cb554-66"><a href="bayesian-models-of-cognition.html#cb554-66" tabindex="-1"></a>    <span class="at">error_direct_weighted =</span> est_direct_weighted <span class="sc">-</span> true_weight_direct,</span>
<span id="cb554-67"><a href="bayesian-models-of-cognition.html#cb554-67" tabindex="-1"></a>    <span class="at">pct_error_direct_weighted =</span> <span class="dv">100</span> <span class="sc">*</span> error_direct_weighted <span class="sc">/</span> true_weight_direct,</span>
<span id="cb554-68"><a href="bayesian-models-of-cognition.html#cb554-68" tabindex="-1"></a>    </span>
<span id="cb554-69"><a href="bayesian-models-of-cognition.html#cb554-69" tabindex="-1"></a>    <span class="at">error_social_weighted =</span> est_social_weighted <span class="sc">-</span> true_weight_social,</span>
<span id="cb554-70"><a href="bayesian-models-of-cognition.html#cb554-70" tabindex="-1"></a>    <span class="at">pct_error_social_weighted =</span> <span class="dv">100</span> <span class="sc">*</span> error_social_weighted <span class="sc">/</span> true_weight_social</span>
<span id="cb554-71"><a href="bayesian-models-of-cognition.html#cb554-71" tabindex="-1"></a>  )</span>
<span id="cb554-72"><a href="bayesian-models-of-cognition.html#cb554-72" tabindex="-1"></a></span>
<span id="cb554-73"><a href="bayesian-models-of-cognition.html#cb554-73" tabindex="-1"></a><span class="co"># Summarize recovery errors by agent type</span></span>
<span id="cb554-74"><a href="bayesian-models-of-cognition.html#cb554-74" tabindex="-1"></a>recovery_summary <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb554-75"><a href="bayesian-models-of-cognition.html#cb554-75" tabindex="-1"></a>  <span class="fu">group_by</span>(model_type) <span class="sc">%&gt;%</span></span>
<span id="cb554-76"><a href="bayesian-models-of-cognition.html#cb554-76" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb554-77"><a href="bayesian-models-of-cognition.html#cb554-77" tabindex="-1"></a>    <span class="co"># Simple model scaling recovery</span></span>
<span id="cb554-78"><a href="bayesian-models-of-cognition.html#cb554-78" tabindex="-1"></a>    <span class="at">mean_abs_error_scaling_simple =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(error_scaling_simple)),</span>
<span id="cb554-79"><a href="bayesian-models-of-cognition.html#cb554-79" tabindex="-1"></a>    <span class="at">mean_abs_pct_error_scaling_simple =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(pct_error_scaling_simple)),</span>
<span id="cb554-80"><a href="bayesian-models-of-cognition.html#cb554-80" tabindex="-1"></a>    </span>
<span id="cb554-81"><a href="bayesian-models-of-cognition.html#cb554-81" tabindex="-1"></a>    <span class="co"># Weighted model param recovery</span></span>
<span id="cb554-82"><a href="bayesian-models-of-cognition.html#cb554-82" tabindex="-1"></a>    <span class="at">mean_abs_error_scaling_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(error_scaling_weighted)),</span>
<span id="cb554-83"><a href="bayesian-models-of-cognition.html#cb554-83" tabindex="-1"></a>    <span class="at">mean_abs_pct_error_scaling_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(pct_error_scaling_weighted)),</span>
<span id="cb554-84"><a href="bayesian-models-of-cognition.html#cb554-84" tabindex="-1"></a>    </span>
<span id="cb554-85"><a href="bayesian-models-of-cognition.html#cb554-85" tabindex="-1"></a>    <span class="at">mean_abs_error_ratio_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(error_ratio_weighted)),</span>
<span id="cb554-86"><a href="bayesian-models-of-cognition.html#cb554-86" tabindex="-1"></a>    <span class="at">mean_abs_pct_error_ratio_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(pct_error_ratio_weighted)),</span>
<span id="cb554-87"><a href="bayesian-models-of-cognition.html#cb554-87" tabindex="-1"></a>    </span>
<span id="cb554-88"><a href="bayesian-models-of-cognition.html#cb554-88" tabindex="-1"></a>    <span class="at">mean_abs_error_direct_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(error_direct_weighted)),</span>
<span id="cb554-89"><a href="bayesian-models-of-cognition.html#cb554-89" tabindex="-1"></a>    <span class="at">mean_abs_pct_error_direct_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(pct_error_direct_weighted)),</span>
<span id="cb554-90"><a href="bayesian-models-of-cognition.html#cb554-90" tabindex="-1"></a>    </span>
<span id="cb554-91"><a href="bayesian-models-of-cognition.html#cb554-91" tabindex="-1"></a>    <span class="at">mean_abs_error_social_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(error_social_weighted)),</span>
<span id="cb554-92"><a href="bayesian-models-of-cognition.html#cb554-92" tabindex="-1"></a>    <span class="at">mean_abs_pct_error_social_weighted =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(pct_error_social_weighted)),</span>
<span id="cb554-93"><a href="bayesian-models-of-cognition.html#cb554-93" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb554-94"><a href="bayesian-models-of-cognition.html#cb554-94" tabindex="-1"></a>  )</span>
<span id="cb554-95"><a href="bayesian-models-of-cognition.html#cb554-95" tabindex="-1"></a></span>
<span id="cb554-96"><a href="bayesian-models-of-cognition.html#cb554-96" tabindex="-1"></a><span class="co"># Print recovery summary</span></span>
<span id="cb554-97"><a href="bayesian-models-of-cognition.html#cb554-97" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(recovery_summary, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Parameter Recovery Accuracy by Agent Type&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-63">Table 11.4: </span>Parameter Recovery Accuracy by Agent Type</caption>
<colgroup>
<col width="3%" />
<col width="8%" />
<col width="10%" />
<col width="9%" />
<col width="10%" />
<col width="8%" />
<col width="10%" />
<col width="9%" />
<col width="10%" />
<col width="9%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model_type</th>
<th align="right">mean_abs_error_scaling_simple</th>
<th align="right">mean_abs_pct_error_scaling_simple</th>
<th align="right">mean_abs_error_scaling_weighted</th>
<th align="right">mean_abs_pct_error_scaling_weighted</th>
<th align="right">mean_abs_error_ratio_weighted</th>
<th align="right">mean_abs_pct_error_ratio_weighted</th>
<th align="right">mean_abs_error_direct_weighted</th>
<th align="right">mean_abs_pct_error_direct_weighted</th>
<th align="right">mean_abs_error_social_weighted</th>
<th align="right">mean_abs_pct_error_social_weighted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">simple</td>
<td align="right">0.80</td>
<td align="right">24.90</td>
<td align="right">0.82</td>
<td align="right">33.42</td>
<td align="right">0.45</td>
<td align="right">45.02</td>
<td align="right">0.57</td>
<td align="right">47.45</td>
<td align="right">0.35</td>
<td align="right">25.37</td>
</tr>
<tr class="even">
<td align="left">weighted</td>
<td align="right">2.15</td>
<td align="right">44.02</td>
<td align="right">1.24</td>
<td align="right">24.22</td>
<td align="right">1.49</td>
<td align="right">37.50</td>
<td align="right">1.27</td>
<td align="right">35.13</td>
<td align="right">0.41</td>
<td align="right">45.28</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="bayesian-models-of-cognition.html#cb555-1" tabindex="-1"></a><span class="co"># Create visualizations of parameter recovery</span></span>
<span id="cb555-2"><a href="bayesian-models-of-cognition.html#cb555-2" tabindex="-1"></a></span>
<span id="cb555-3"><a href="bayesian-models-of-cognition.html#cb555-3" tabindex="-1"></a><span class="co"># 1. Scaling factor recovery</span></span>
<span id="cb555-4"><a href="bayesian-models-of-cognition.html#cb555-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> true_scaling_factor, <span class="at">y =</span> est_scaling_simple, <span class="at">color =</span> model_type)) <span class="sc">+</span></span>
<span id="cb555-5"><a href="bayesian-models-of-cognition.html#cb555-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb555-6"><a href="bayesian-models-of-cognition.html#cb555-6" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb555-7"><a href="bayesian-models-of-cognition.html#cb555-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb555-8"><a href="bayesian-models-of-cognition.html#cb555-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scaling Factor Recovery (Simple Model)&quot;</span>,</span>
<span id="cb555-9"><a href="bayesian-models-of-cognition.html#cb555-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;How well can the simple model recover the true scaling factors?&quot;</span>,</span>
<span id="cb555-10"><a href="bayesian-models-of-cognition.html#cb555-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Scaling Factor&quot;</span>,</span>
<span id="cb555-11"><a href="bayesian-models-of-cognition.html#cb555-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Scaling Factor&quot;</span>,</span>
<span id="cb555-12"><a href="bayesian-models-of-cognition.html#cb555-12" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb555-13"><a href="bayesian-models-of-cognition.html#cb555-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb555-14"><a href="bayesian-models-of-cognition.html#cb555-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb555-15"><a href="bayesian-models-of-cognition.html#cb555-15" tabindex="-1"></a></span>
<span id="cb555-16"><a href="bayesian-models-of-cognition.html#cb555-16" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> true_scaling_factor, <span class="at">y =</span> est_scaling_weighted, <span class="at">color =</span> model_type)) <span class="sc">+</span></span>
<span id="cb555-17"><a href="bayesian-models-of-cognition.html#cb555-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb555-18"><a href="bayesian-models-of-cognition.html#cb555-18" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb555-19"><a href="bayesian-models-of-cognition.html#cb555-19" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb555-20"><a href="bayesian-models-of-cognition.html#cb555-20" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scaling Factor Recovery (Weighted Model)&quot;</span>,</span>
<span id="cb555-21"><a href="bayesian-models-of-cognition.html#cb555-21" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;How well can the weighted model recover the true scaling factors?&quot;</span>,</span>
<span id="cb555-22"><a href="bayesian-models-of-cognition.html#cb555-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Scaling Factor&quot;</span>,</span>
<span id="cb555-23"><a href="bayesian-models-of-cognition.html#cb555-23" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Scaling Factor&quot;</span>,</span>
<span id="cb555-24"><a href="bayesian-models-of-cognition.html#cb555-24" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb555-25"><a href="bayesian-models-of-cognition.html#cb555-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb555-26"><a href="bayesian-models-of-cognition.html#cb555-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb555-27"><a href="bayesian-models-of-cognition.html#cb555-27" tabindex="-1"></a></span>
<span id="cb555-28"><a href="bayesian-models-of-cognition.html#cb555-28" tabindex="-1"></a><span class="co"># 2. Weight ratio recovery (weighted model only)</span></span>
<span id="cb555-29"><a href="bayesian-models-of-cognition.html#cb555-29" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> true_weight_ratio, <span class="at">y =</span> est_ratio_weighted, <span class="at">color =</span> model_type)) <span class="sc">+</span></span>
<span id="cb555-30"><a href="bayesian-models-of-cognition.html#cb555-30" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb555-31"><a href="bayesian-models-of-cognition.html#cb555-31" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb555-32"><a href="bayesian-models-of-cognition.html#cb555-32" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb555-33"><a href="bayesian-models-of-cognition.html#cb555-33" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Weight Ratio Recovery (Weighted Model)&quot;</span>,</span>
<span id="cb555-34"><a href="bayesian-models-of-cognition.html#cb555-34" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;How well can the weighted model recover the true weight ratios?&quot;</span>,</span>
<span id="cb555-35"><a href="bayesian-models-of-cognition.html#cb555-35" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Weight Ratio (Direct/Social)&quot;</span>,</span>
<span id="cb555-36"><a href="bayesian-models-of-cognition.html#cb555-36" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Weight Ratio&quot;</span>,</span>
<span id="cb555-37"><a href="bayesian-models-of-cognition.html#cb555-37" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb555-38"><a href="bayesian-models-of-cognition.html#cb555-38" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb555-39"><a href="bayesian-models-of-cognition.html#cb555-39" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb555-40"><a href="bayesian-models-of-cognition.html#cb555-40" tabindex="-1"></a></span>
<span id="cb555-41"><a href="bayesian-models-of-cognition.html#cb555-41" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb555-42"><a href="bayesian-models-of-cognition.html#cb555-42" tabindex="-1"></a>recovery_plots <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb555-43"><a href="bayesian-models-of-cognition.html#cb555-43" tabindex="-1"></a><span class="fu">print</span>(recovery_plots)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-63-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="model-comparison-2" class="section level3 hasAnchor" number="11.22.2">
<h3><span class="header-section-number">11.22.2</span> Model Comparison<a href="bayesian-models-of-cognition.html#model-comparison-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we’ve fitted both models, we can formally compare them to see which better explains the observed data. We’ll use Leave-One-Out Cross-Validation (LOO-CV) to estimate each model’s predictive accuracy.</p>
<p>In a real application, we wouldn’t know in advance whether individuals use simple or weighted integration strategies. Model comparison helps us determine which cognitive model is more consistent with observed behavior.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="bayesian-models-of-cognition.html#cb556-1" tabindex="-1"></a><span class="co"># Calculate LOO-CV for model comparison</span></span>
<span id="cb556-2"><a href="bayesian-models-of-cognition.html#cb556-2" tabindex="-1"></a><span class="co"># This evaluates how well each model predicts held-out data</span></span>
<span id="cb556-3"><a href="bayesian-models-of-cognition.html#cb556-3" tabindex="-1"></a></span>
<span id="cb556-4"><a href="bayesian-models-of-cognition.html#cb556-4" tabindex="-1"></a><span class="co"># For simple model</span></span>
<span id="cb556-5"><a href="bayesian-models-of-cognition.html#cb556-5" tabindex="-1"></a>loo_simple <span class="ot">&lt;-</span> fit_simple_ml<span class="sc">$</span><span class="fu">loo</span>()</span>
<span id="cb556-6"><a href="bayesian-models-of-cognition.html#cb556-6" tabindex="-1"></a></span>
<span id="cb556-7"><a href="bayesian-models-of-cognition.html#cb556-7" tabindex="-1"></a><span class="co"># For weighted model</span></span>
<span id="cb556-8"><a href="bayesian-models-of-cognition.html#cb556-8" tabindex="-1"></a>loo_weighted <span class="ot">&lt;-</span> fit_weighted_ml<span class="sc">$</span><span class="fu">loo</span>()</span>
<span id="cb556-9"><a href="bayesian-models-of-cognition.html#cb556-9" tabindex="-1"></a></span>
<span id="cb556-10"><a href="bayesian-models-of-cognition.html#cb556-10" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb556-11"><a href="bayesian-models-of-cognition.html#cb556-11" tabindex="-1"></a>loo_comparison <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(loo_simple, loo_weighted)</span>
<span id="cb556-12"><a href="bayesian-models-of-cognition.html#cb556-12" tabindex="-1"></a><span class="fu">print</span>(loo_comparison)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff
## model2   0.0       0.0  
## model1 -21.6       6.7</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="bayesian-models-of-cognition.html#cb558-1" tabindex="-1"></a><span class="co"># Calculate model weights</span></span>
<span id="cb558-2"><a href="bayesian-models-of-cognition.html#cb558-2" tabindex="-1"></a>model_weights <span class="ot">&lt;-</span> <span class="fu">loo_model_weights</span>(<span class="fu">list</span>(</span>
<span id="cb558-3"><a href="bayesian-models-of-cognition.html#cb558-3" tabindex="-1"></a>  <span class="st">&quot;Simple Integration&quot;</span> <span class="ot">=</span> loo_simple,</span>
<span id="cb558-4"><a href="bayesian-models-of-cognition.html#cb558-4" tabindex="-1"></a>  <span class="st">&quot;Weighted Integration&quot;</span> <span class="ot">=</span> loo_weighted</span>
<span id="cb558-5"><a href="bayesian-models-of-cognition.html#cb558-5" tabindex="-1"></a>))</span>
<span id="cb558-6"><a href="bayesian-models-of-cognition.html#cb558-6" tabindex="-1"></a></span>
<span id="cb558-7"><a href="bayesian-models-of-cognition.html#cb558-7" tabindex="-1"></a><span class="co"># Print model weights</span></span>
<span id="cb558-8"><a href="bayesian-models-of-cognition.html#cb558-8" tabindex="-1"></a><span class="fu">print</span>(model_weights)</span></code></pre></div>
<pre><code>## Method: stacking
## ------
##                      weight
## Simple Integration   0.028 
## Weighted Integration 0.972</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="bayesian-models-of-cognition.html#cb560-1" tabindex="-1"></a><span class="co"># Create a visualization of model comparison</span></span>
<span id="cb560-2"><a href="bayesian-models-of-cognition.html#cb560-2" tabindex="-1"></a>model_comp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb560-3"><a href="bayesian-models-of-cognition.html#cb560-3" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">names</span>(model_weights),</span>
<span id="cb560-4"><a href="bayesian-models-of-cognition.html#cb560-4" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">as.numeric</span>(model_weights)</span>
<span id="cb560-5"><a href="bayesian-models-of-cognition.html#cb560-5" tabindex="-1"></a>)</span>
<span id="cb560-6"><a href="bayesian-models-of-cognition.html#cb560-6" tabindex="-1"></a></span>
<span id="cb560-7"><a href="bayesian-models-of-cognition.html#cb560-7" tabindex="-1"></a>p_model_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(model_comp_data, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> weight, <span class="at">fill =</span> model)) <span class="sc">+</span></span>
<span id="cb560-8"><a href="bayesian-models-of-cognition.html#cb560-8" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb560-9"><a href="bayesian-models-of-cognition.html#cb560-9" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(weight, <span class="at">accuracy =</span> <span class="fl">0.1</span>)), </span>
<span id="cb560-10"><a href="bayesian-models-of-cognition.html#cb560-10" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb560-11"><a href="bayesian-models-of-cognition.html#cb560-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb560-12"><a href="bayesian-models-of-cognition.html#cb560-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Model Comparison Using LOO-CV&quot;</span>,</span>
<span id="cb560-13"><a href="bayesian-models-of-cognition.html#cb560-13" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher weights indicate better predictive performance&quot;</span>,</span>
<span id="cb560-14"><a href="bayesian-models-of-cognition.html#cb560-14" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb560-15"><a href="bayesian-models-of-cognition.html#cb560-15" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Model Weight&quot;</span></span>
<span id="cb560-16"><a href="bayesian-models-of-cognition.html#cb560-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb560-17"><a href="bayesian-models-of-cognition.html#cb560-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb560-18"><a href="bayesian-models-of-cognition.html#cb560-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb560-19"><a href="bayesian-models-of-cognition.html#cb560-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb560-20"><a href="bayesian-models-of-cognition.html#cb560-20" tabindex="-1"></a></span>
<span id="cb560-21"><a href="bayesian-models-of-cognition.html#cb560-21" tabindex="-1"></a><span class="fu">print</span>(p_model_comp)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-64-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="bayesian-models-of-cognition.html#cb561-1" tabindex="-1"></a><span class="co"># Compare model performance by agent type</span></span>
<span id="cb561-2"><a href="bayesian-models-of-cognition.html#cb561-2" tabindex="-1"></a><span class="co"># Calculate pointwise ELPD values for each model</span></span>
<span id="cb561-3"><a href="bayesian-models-of-cognition.html#cb561-3" tabindex="-1"></a>elpd_simple <span class="ot">&lt;-</span> loo_simple<span class="sc">$</span>pointwise[, <span class="st">&quot;elpd_loo&quot;</span>]</span>
<span id="cb561-4"><a href="bayesian-models-of-cognition.html#cb561-4" tabindex="-1"></a>elpd_weighted <span class="ot">&lt;-</span> loo_weighted<span class="sc">$</span>pointwise[, <span class="st">&quot;elpd_loo&quot;</span>]</span>
<span id="cb561-5"><a href="bayesian-models-of-cognition.html#cb561-5" tabindex="-1"></a></span>
<span id="cb561-6"><a href="bayesian-models-of-cognition.html#cb561-6" tabindex="-1"></a><span class="co"># Aggregate by agent</span></span>
<span id="cb561-7"><a href="bayesian-models-of-cognition.html#cb561-7" tabindex="-1"></a>elpd_by_agent <span class="ot">&lt;-</span> multilevel_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb561-8"><a href="bayesian-models-of-cognition.html#cb561-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(agent_id, model_type) <span class="sc">%&gt;%</span></span>
<span id="cb561-9"><a href="bayesian-models-of-cognition.html#cb561-9" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb561-10"><a href="bayesian-models-of-cognition.html#cb561-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb561-11"><a href="bayesian-models-of-cognition.html#cb561-11" tabindex="-1"></a>    <span class="at">elpd_simple =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb561-12"><a href="bayesian-models-of-cognition.html#cb561-12" tabindex="-1"></a>    <span class="at">elpd_weighted =</span> <span class="cn">NA_real_</span></span>
<span id="cb561-13"><a href="bayesian-models-of-cognition.html#cb561-13" tabindex="-1"></a>  )</span>
<span id="cb561-14"><a href="bayesian-models-of-cognition.html#cb561-14" tabindex="-1"></a></span>
<span id="cb561-15"><a href="bayesian-models-of-cognition.html#cb561-15" tabindex="-1"></a><span class="co"># Calculate ELPD sums by agent</span></span>
<span id="cb561-16"><a href="bayesian-models-of-cognition.html#cb561-16" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(elpd_by_agent)) {</span>
<span id="cb561-17"><a href="bayesian-models-of-cognition.html#cb561-17" tabindex="-1"></a>  agent <span class="ot">&lt;-</span> elpd_by_agent<span class="sc">$</span>agent_id[j]</span>
<span id="cb561-18"><a href="bayesian-models-of-cognition.html#cb561-18" tabindex="-1"></a>  <span class="co"># Find rows for this agent</span></span>
<span id="cb561-19"><a href="bayesian-models-of-cognition.html#cb561-19" tabindex="-1"></a>  agent_rows <span class="ot">&lt;-</span> <span class="fu">which</span>(multilevel_sim_data<span class="sc">$</span>agent_id <span class="sc">==</span> agent)</span>
<span id="cb561-20"><a href="bayesian-models-of-cognition.html#cb561-20" tabindex="-1"></a>  <span class="co"># Sum ELPD values for this agent</span></span>
<span id="cb561-21"><a href="bayesian-models-of-cognition.html#cb561-21" tabindex="-1"></a>  elpd_by_agent<span class="sc">$</span>elpd_simple[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(elpd_simple[agent_rows])</span>
<span id="cb561-22"><a href="bayesian-models-of-cognition.html#cb561-22" tabindex="-1"></a>  elpd_by_agent<span class="sc">$</span>elpd_weighted[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(elpd_weighted[agent_rows])</span>
<span id="cb561-23"><a href="bayesian-models-of-cognition.html#cb561-23" tabindex="-1"></a>}</span>
<span id="cb561-24"><a href="bayesian-models-of-cognition.html#cb561-24" tabindex="-1"></a></span>
<span id="cb561-25"><a href="bayesian-models-of-cognition.html#cb561-25" tabindex="-1"></a><span class="co"># Calculate ELPD difference (positive = weighted model is better)</span></span>
<span id="cb561-26"><a href="bayesian-models-of-cognition.html#cb561-26" tabindex="-1"></a>elpd_by_agent <span class="ot">&lt;-</span> elpd_by_agent <span class="sc">%&gt;%</span></span>
<span id="cb561-27"><a href="bayesian-models-of-cognition.html#cb561-27" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb561-28"><a href="bayesian-models-of-cognition.html#cb561-28" tabindex="-1"></a>    <span class="at">elpd_diff =</span> elpd_weighted <span class="sc">-</span> elpd_simple,</span>
<span id="cb561-29"><a href="bayesian-models-of-cognition.html#cb561-29" tabindex="-1"></a>    <span class="at">better_model =</span> <span class="fu">ifelse</span>(elpd_diff <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;Weighted&quot;</span>, <span class="st">&quot;Simple&quot;</span>)</span>
<span id="cb561-30"><a href="bayesian-models-of-cognition.html#cb561-30" tabindex="-1"></a>  )</span>
<span id="cb561-31"><a href="bayesian-models-of-cognition.html#cb561-31" tabindex="-1"></a></span>
<span id="cb561-32"><a href="bayesian-models-of-cognition.html#cb561-32" tabindex="-1"></a><span class="co"># Create visualization of model preference by agent type</span></span>
<span id="cb561-33"><a href="bayesian-models-of-cognition.html#cb561-33" tabindex="-1"></a></span>
<span id="cb561-34"><a href="bayesian-models-of-cognition.html#cb561-34" tabindex="-1"></a>p_agent_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(elpd_by_agent, <span class="fu">aes</span>(<span class="at">x =</span> agent_id, <span class="at">y =</span> elpd_diff, <span class="at">color =</span> model_type)) <span class="sc">+</span></span>
<span id="cb561-35"><a href="bayesian-models-of-cognition.html#cb561-35" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb561-36"><a href="bayesian-models-of-cognition.html#cb561-36" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb561-37"><a href="bayesian-models-of-cognition.html#cb561-37" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb561-38"><a href="bayesian-models-of-cognition.html#cb561-38" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Model Preference by Agent Type&quot;</span>,</span>
<span id="cb561-39"><a href="bayesian-models-of-cognition.html#cb561-39" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Positive values favor the weighted model; negative values favor the simple model&quot;</span>,</span>
<span id="cb561-40"><a href="bayesian-models-of-cognition.html#cb561-40" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Agent Type&quot;</span>,</span>
<span id="cb561-41"><a href="bayesian-models-of-cognition.html#cb561-41" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;ELPD Difference (Weighted - Simple)&quot;</span>,</span>
<span id="cb561-42"><a href="bayesian-models-of-cognition.html#cb561-42" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Preferred Model&quot;</span></span>
<span id="cb561-43"><a href="bayesian-models-of-cognition.html#cb561-43" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb561-44"><a href="bayesian-models-of-cognition.html#cb561-44" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb561-45"><a href="bayesian-models-of-cognition.html#cb561-45" tabindex="-1"></a></span>
<span id="cb561-46"><a href="bayesian-models-of-cognition.html#cb561-46" tabindex="-1"></a></span>
<span id="cb561-47"><a href="bayesian-models-of-cognition.html#cb561-47" tabindex="-1"></a><span class="fu">print</span>(p_agent_comp)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-64-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="bayesian-models-of-cognition.html#cb562-1" tabindex="-1"></a><span class="co"># Calculate classification accuracy</span></span>
<span id="cb562-2"><a href="bayesian-models-of-cognition.html#cb562-2" tabindex="-1"></a><span class="co"># How often does the better-fitting model match the true generating model?</span></span>
<span id="cb562-3"><a href="bayesian-models-of-cognition.html#cb562-3" tabindex="-1"></a>classification <span class="ot">&lt;-</span> elpd_by_agent <span class="sc">%&gt;%</span></span>
<span id="cb562-4"><a href="bayesian-models-of-cognition.html#cb562-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb562-5"><a href="bayesian-models-of-cognition.html#cb562-5" tabindex="-1"></a>    <span class="co"># For simple agents, the simple model should be better</span></span>
<span id="cb562-6"><a href="bayesian-models-of-cognition.html#cb562-6" tabindex="-1"></a>    <span class="at">correct_classification =</span> <span class="fu">case_when</span>(</span>
<span id="cb562-7"><a href="bayesian-models-of-cognition.html#cb562-7" tabindex="-1"></a>      model_type <span class="sc">==</span> <span class="st">&quot;simple&quot;</span> <span class="sc">&amp;</span> better_model <span class="sc">==</span> <span class="st">&quot;Simple&quot;</span> <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-8"><a href="bayesian-models-of-cognition.html#cb562-8" tabindex="-1"></a>      model_type <span class="sc">==</span> <span class="st">&quot;weighted&quot;</span> <span class="sc">&amp;</span> better_model <span class="sc">==</span> <span class="st">&quot;Weighted&quot;</span> <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-9"><a href="bayesian-models-of-cognition.html#cb562-9" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">FALSE</span></span>
<span id="cb562-10"><a href="bayesian-models-of-cognition.html#cb562-10" tabindex="-1"></a>    )</span>
<span id="cb562-11"><a href="bayesian-models-of-cognition.html#cb562-11" tabindex="-1"></a>  )</span>
<span id="cb562-12"><a href="bayesian-models-of-cognition.html#cb562-12" tabindex="-1"></a></span>
<span id="cb562-13"><a href="bayesian-models-of-cognition.html#cb562-13" tabindex="-1"></a><span class="co"># Calculate overall accuracy and by agent type</span></span>
<span id="cb562-14"><a href="bayesian-models-of-cognition.html#cb562-14" tabindex="-1"></a>overall_accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(classification<span class="sc">$</span>correct_classification)</span>
<span id="cb562-15"><a href="bayesian-models-of-cognition.html#cb562-15" tabindex="-1"></a>accuracy_by_type <span class="ot">&lt;-</span> classification <span class="sc">%&gt;%</span></span>
<span id="cb562-16"><a href="bayesian-models-of-cognition.html#cb562-16" tabindex="-1"></a>  <span class="fu">group_by</span>(model_type) <span class="sc">%&gt;%</span></span>
<span id="cb562-17"><a href="bayesian-models-of-cognition.html#cb562-17" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb562-18"><a href="bayesian-models-of-cognition.html#cb562-18" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb562-19"><a href="bayesian-models-of-cognition.html#cb562-19" tabindex="-1"></a>    <span class="at">correct =</span> <span class="fu">sum</span>(correct_classification),</span>
<span id="cb562-20"><a href="bayesian-models-of-cognition.html#cb562-20" tabindex="-1"></a>    <span class="at">accuracy =</span> correct <span class="sc">/</span> n,</span>
<span id="cb562-21"><a href="bayesian-models-of-cognition.html#cb562-21" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb562-22"><a href="bayesian-models-of-cognition.html#cb562-22" tabindex="-1"></a>  )</span>
<span id="cb562-23"><a href="bayesian-models-of-cognition.html#cb562-23" tabindex="-1"></a></span>
<span id="cb562-24"><a href="bayesian-models-of-cognition.html#cb562-24" tabindex="-1"></a><span class="co"># Print classification results</span></span>
<span id="cb562-25"><a href="bayesian-models-of-cognition.html#cb562-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Model Classification Accuracy:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Model Classification Accuracy:</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="bayesian-models-of-cognition.html#cb564-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall accuracy:&quot;</span>, scales<span class="sc">::</span><span class="fu">percent</span>(overall_accuracy), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Overall accuracy: 70%</code></pre>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="bayesian-models-of-cognition.html#cb566-1" tabindex="-1"></a><span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(accuracy_by_type, <span class="at">caption =</span> <span class="st">&quot;Classification Accuracy by Agent Type&quot;</span>))</span></code></pre></div>
<pre><code>## 
## 
## Table: (\#tab:unnamed-chunk-64)Classification Accuracy by Agent Type
## 
## |model_type |  n| correct| accuracy|
## |:----------|--:|-------:|--------:|
## |simple     | 20|      14|      0.7|
## |weighted   | 20|      14|      0.7|</code></pre>
</div>
</div>
<div id="dynamic-bayesian-evidence-integration-sequential-updating-models" class="section level2 hasAnchor" number="11.23">
<h2><span class="header-section-number">11.23</span> Dynamic Bayesian Evidence Integration: Sequential Updating Models<a href="bayesian-models-of-cognition.html#dynamic-bayesian-evidence-integration-sequential-updating-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In real-world learning scenarios, people continuously update their beliefs as they gather new evidence. While our previous models considered decision-making based on static evidence, a more realistic approach is to incorporate sequential updating where beliefs evolve over time. Let’s develop an extension of our Bayesian evidence integration models that captures how agents dynamically update their beliefs across trials.</p>
<div id="sequential-bayesian-updating-the-theoretical-framework" class="section level3 hasAnchor" number="11.23.1">
<h3><span class="header-section-number">11.23.1</span> Sequential Bayesian Updating: The Theoretical Framework<a href="bayesian-models-of-cognition.html#sequential-bayesian-updating-the-theoretical-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In sequential Bayesian updating, an agent’s posterior belief from one trial becomes the prior for the next trial. This creates a continuous learning process where the agent’s beliefs evolve over time based on observed evidence.
The key components of a sequential updating model are:</p>
<ul>
<li><p>Initial prior belief - The agent’s belief before encountering any evidence</p></li>
<li><p>Trial-by-trial updating - How beliefs are updated after each new piece of evidence</p></li>
<li><p>Response mechanism - How updated beliefs translate into observable choices</p></li>
</ul>
<p>Let’s implement this framework in Stan, starting with the single-agent version and then extending to a multilevel model.</p>
</div>
<div id="single-agent-sequential-updating-model" class="section level3 hasAnchor" number="11.23.2">
<h3><span class="header-section-number">11.23.2</span> Single-Agent Sequential Updating Model<a href="bayesian-models-of-cognition.html#single-agent-sequential-updating-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="bayesian-models-of-cognition.html#cb568-1" tabindex="-1"></a><span class="co"># Stan code for a sequential Bayesian updating model</span></span>
<span id="cb568-2"><a href="bayesian-models-of-cognition.html#cb568-2" tabindex="-1"></a>sequential_updating_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb568-3"><a href="bayesian-models-of-cognition.html#cb568-3" tabindex="-1"></a><span class="st">// Sequential Bayesian Updating Model</span></span>
<span id="cb568-4"><a href="bayesian-models-of-cognition.html#cb568-4" tabindex="-1"></a><span class="st">// This model tracks how an agent updates beliefs across a sequence of trials</span></span>
<span id="cb568-5"><a href="bayesian-models-of-cognition.html#cb568-5" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb568-6"><a href="bayesian-models-of-cognition.html#cb568-6" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; T;                        // Number of trials</span></span>
<span id="cb568-7"><a href="bayesian-models-of-cognition.html#cb568-7" tabindex="-1"></a><span class="st">  array[T] int&lt;lower=0, upper=1&gt; choice; // Choices (0=red, 1=blue)</span></span>
<span id="cb568-8"><a href="bayesian-models-of-cognition.html#cb568-8" tabindex="-1"></a><span class="st">  array[T] int&lt;lower=0&gt; blue1;           // Direct evidence (blue marbles) on each trial</span></span>
<span id="cb568-9"><a href="bayesian-models-of-cognition.html#cb568-9" tabindex="-1"></a><span class="st">  array[T] int&lt;lower=0&gt; total1;          // Total direct evidence on each trial</span></span>
<span id="cb568-10"><a href="bayesian-models-of-cognition.html#cb568-10" tabindex="-1"></a><span class="st">  array[T] int&lt;lower=0&gt; blue2;           // Social evidence (blue signals) on each trial</span></span>
<span id="cb568-11"><a href="bayesian-models-of-cognition.html#cb568-11" tabindex="-1"></a><span class="st">  array[T] int&lt;lower=0&gt; total2;          // Total social evidence on each trial</span></span>
<span id="cb568-12"><a href="bayesian-models-of-cognition.html#cb568-12" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb568-13"><a href="bayesian-models-of-cognition.html#cb568-13" tabindex="-1"></a></span>
<span id="cb568-14"><a href="bayesian-models-of-cognition.html#cb568-14" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb568-15"><a href="bayesian-models-of-cognition.html#cb568-15" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; total_weight;             // Overall weight given to evidence</span></span>
<span id="cb568-16"><a href="bayesian-models-of-cognition.html#cb568-16" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; weight_prop;     // Proportion of weight for direct evidence</span></span>
<span id="cb568-17"><a href="bayesian-models-of-cognition.html#cb568-17" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; learning;                    // Learning rate parameter</span></span>
<span id="cb568-18"><a href="bayesian-models-of-cognition.html#cb568-18" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb568-19"><a href="bayesian-models-of-cognition.html#cb568-19" tabindex="-1"></a></span>
<span id="cb568-20"><a href="bayesian-models-of-cognition.html#cb568-20" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb568-21"><a href="bayesian-models-of-cognition.html#cb568-21" tabindex="-1"></a><span class="st">  // Calculate weights for each evidence source</span></span>
<span id="cb568-22"><a href="bayesian-models-of-cognition.html#cb568-22" tabindex="-1"></a><span class="st">  real weight_direct = total_weight * weight_prop;</span></span>
<span id="cb568-23"><a href="bayesian-models-of-cognition.html#cb568-23" tabindex="-1"></a><span class="st">  real weight_social = total_weight * (1 - weight_prop);</span></span>
<span id="cb568-24"><a href="bayesian-models-of-cognition.html#cb568-24" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb568-25"><a href="bayesian-models-of-cognition.html#cb568-25" tabindex="-1"></a><span class="st">  // Variables to track belief updating across trials</span></span>
<span id="cb568-26"><a href="bayesian-models-of-cognition.html#cb568-26" tabindex="-1"></a><span class="st">  vector&lt;lower=0, upper=1&gt;[T] belief;     // Belief in blue on each trial</span></span>
<span id="cb568-27"><a href="bayesian-models-of-cognition.html#cb568-27" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[T] alpha_param;         // Beta distribution alpha parameter</span></span>
<span id="cb568-28"><a href="bayesian-models-of-cognition.html#cb568-28" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[T] beta_param;          // Beta distribution beta parameter</span></span>
<span id="cb568-29"><a href="bayesian-models-of-cognition.html#cb568-29" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb568-30"><a href="bayesian-models-of-cognition.html#cb568-30" tabindex="-1"></a><span class="st">  // Initial belief parameters (uniform prior)</span></span>
<span id="cb568-31"><a href="bayesian-models-of-cognition.html#cb568-31" tabindex="-1"></a><span class="st">  alpha_param[1] = 1.0;</span></span>
<span id="cb568-32"><a href="bayesian-models-of-cognition.html#cb568-32" tabindex="-1"></a><span class="st">  beta_param[1] = 1.0;</span></span>
<span id="cb568-33"><a href="bayesian-models-of-cognition.html#cb568-33" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb568-34"><a href="bayesian-models-of-cognition.html#cb568-34" tabindex="-1"></a><span class="st">  // Calculate belief for first trial</span></span>
<span id="cb568-35"><a href="bayesian-models-of-cognition.html#cb568-35" tabindex="-1"></a><span class="st">  belief[1] = alpha_param[1] / (alpha_param[1] + beta_param[1]);</span></span>
<span id="cb568-36"><a href="bayesian-models-of-cognition.html#cb568-36" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb568-37"><a href="bayesian-models-of-cognition.html#cb568-37" tabindex="-1"></a><span class="st">  // Update beliefs across trials</span></span>
<span id="cb568-38"><a href="bayesian-models-of-cognition.html#cb568-38" tabindex="-1"></a><span class="st">  for (t in 2:T) {</span></span>
<span id="cb568-39"><a href="bayesian-models-of-cognition.html#cb568-39" tabindex="-1"></a><span class="st">    // Calculate weighted evidence from previous trial</span></span>
<span id="cb568-40"><a href="bayesian-models-of-cognition.html#cb568-40" tabindex="-1"></a><span class="st">    real weighted_blue1 = blue1[t-1] * weight_direct;</span></span>
<span id="cb568-41"><a href="bayesian-models-of-cognition.html#cb568-41" tabindex="-1"></a><span class="st">    real weighted_red1 = (total1[t-1] - blue1[t-1]) * weight_direct;</span></span>
<span id="cb568-42"><a href="bayesian-models-of-cognition.html#cb568-42" tabindex="-1"></a><span class="st">    real weighted_blue2 = blue2[t-1] * weight_social;</span></span>
<span id="cb568-43"><a href="bayesian-models-of-cognition.html#cb568-43" tabindex="-1"></a><span class="st">    real weighted_red2 = (total2[t-1] - blue2[t-1]) * weight_social;</span></span>
<span id="cb568-44"><a href="bayesian-models-of-cognition.html#cb568-44" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb568-45"><a href="bayesian-models-of-cognition.html#cb568-45" tabindex="-1"></a><span class="st">    // Update belief with learning rate</span></span>
<span id="cb568-46"><a href="bayesian-models-of-cognition.html#cb568-46" tabindex="-1"></a><span class="st">    // alpha controls how much new evidence affects the belief</span></span>
<span id="cb568-47"><a href="bayesian-models-of-cognition.html#cb568-47" tabindex="-1"></a><span class="st">    alpha_param[t] = alpha_param[t-1] + learning * (weighted_blue1 + weighted_blue2);</span></span>
<span id="cb568-48"><a href="bayesian-models-of-cognition.html#cb568-48" tabindex="-1"></a><span class="st">    beta_param[t] = beta_param[t-1] + learning * (weighted_red1 + weighted_red2);</span></span>
<span id="cb568-49"><a href="bayesian-models-of-cognition.html#cb568-49" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb568-50"><a href="bayesian-models-of-cognition.html#cb568-50" tabindex="-1"></a><span class="st">    // Calculate updated belief</span></span>
<span id="cb568-51"><a href="bayesian-models-of-cognition.html#cb568-51" tabindex="-1"></a><span class="st">    belief[t] = alpha_param[t] / (alpha_param[t] + beta_param[t]);</span></span>
<span id="cb568-52"><a href="bayesian-models-of-cognition.html#cb568-52" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb568-53"><a href="bayesian-models-of-cognition.html#cb568-53" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb568-54"><a href="bayesian-models-of-cognition.html#cb568-54" tabindex="-1"></a></span>
<span id="cb568-55"><a href="bayesian-models-of-cognition.html#cb568-55" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb568-56"><a href="bayesian-models-of-cognition.html#cb568-56" tabindex="-1"></a><span class="st">  // Priors for parameters</span></span>
<span id="cb568-57"><a href="bayesian-models-of-cognition.html#cb568-57" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(total_weight | 0, 0.5);  // Prior centered around 1.0</span></span>
<span id="cb568-58"><a href="bayesian-models-of-cognition.html#cb568-58" tabindex="-1"></a><span class="st">  target += beta_lpdf(weight_prop | 1, 1);          // Uniform prior on proportion</span></span>
<span id="cb568-59"><a href="bayesian-models-of-cognition.html#cb568-59" tabindex="-1"></a><span class="st">  target += lognormal_lpdf(alpha | -1, 0.5);        // Prior on learning rate (typically &lt; 1)</span></span>
<span id="cb568-60"><a href="bayesian-models-of-cognition.html#cb568-60" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb568-61"><a href="bayesian-models-of-cognition.html#cb568-61" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb568-62"><a href="bayesian-models-of-cognition.html#cb568-62" tabindex="-1"></a><span class="st">  for (t in 1:T) {</span></span>
<span id="cb568-63"><a href="bayesian-models-of-cognition.html#cb568-63" tabindex="-1"></a><span class="st">    // Model choice as a function of current belief</span></span>
<span id="cb568-64"><a href="bayesian-models-of-cognition.html#cb568-64" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(choice[t] | belief[t]);</span></span>
<span id="cb568-65"><a href="bayesian-models-of-cognition.html#cb568-65" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb568-66"><a href="bayesian-models-of-cognition.html#cb568-66" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb568-67"><a href="bayesian-models-of-cognition.html#cb568-67" tabindex="-1"></a></span>
<span id="cb568-68"><a href="bayesian-models-of-cognition.html#cb568-68" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb568-69"><a href="bayesian-models-of-cognition.html#cb568-69" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb568-70"><a href="bayesian-models-of-cognition.html#cb568-70" tabindex="-1"></a><span class="st">  vector[T] log_lik;</span></span>
<span id="cb568-71"><a href="bayesian-models-of-cognition.html#cb568-71" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb568-72"><a href="bayesian-models-of-cognition.html#cb568-72" tabindex="-1"></a><span class="st">  // Posterior predictions</span></span>
<span id="cb568-73"><a href="bayesian-models-of-cognition.html#cb568-73" tabindex="-1"></a><span class="st">  array[T] int pred_choice;</span></span>
<span id="cb568-74"><a href="bayesian-models-of-cognition.html#cb568-74" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb568-75"><a href="bayesian-models-of-cognition.html#cb568-75" tabindex="-1"></a><span class="st">  for (t in 1:T) {</span></span>
<span id="cb568-76"><a href="bayesian-models-of-cognition.html#cb568-76" tabindex="-1"></a><span class="st">    // Generate predicted choices</span></span>
<span id="cb568-77"><a href="bayesian-models-of-cognition.html#cb568-77" tabindex="-1"></a><span class="st">    pred_choice[t] = bernoulli_rng(belief[t]);</span></span>
<span id="cb568-78"><a href="bayesian-models-of-cognition.html#cb568-78" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb568-79"><a href="bayesian-models-of-cognition.html#cb568-79" tabindex="-1"></a><span class="st">    // Calculate log likelihood</span></span>
<span id="cb568-80"><a href="bayesian-models-of-cognition.html#cb568-80" tabindex="-1"></a><span class="st">    log_lik[t] = bernoulli_lpmf(choice[t] | belief[t]);</span></span>
<span id="cb568-81"><a href="bayesian-models-of-cognition.html#cb568-81" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb568-82"><a href="bayesian-models-of-cognition.html#cb568-82" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb568-83"><a href="bayesian-models-of-cognition.html#cb568-83" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb568-84"><a href="bayesian-models-of-cognition.html#cb568-84" tabindex="-1"></a></span>
<span id="cb568-85"><a href="bayesian-models-of-cognition.html#cb568-85" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb568-86"><a href="bayesian-models-of-cognition.html#cb568-86" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb568-87"><a href="bayesian-models-of-cognition.html#cb568-87" tabindex="-1"></a>  sequential_updating_stan,</span>
<span id="cb568-88"><a href="bayesian-models-of-cognition.html#cb568-88" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb568-89"><a href="bayesian-models-of-cognition.html#cb568-89" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;10_sequential_updating.stan&quot;</span></span>
<span id="cb568-90"><a href="bayesian-models-of-cognition.html#cb568-90" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/10_sequential_updating.stan&quot;</code></pre>
</div>
<div id="multilevel-sequential-updating-model" class="section level3 hasAnchor" number="11.23.3">
<h3><span class="header-section-number">11.23.3</span> Multilevel Sequential Updating Model<a href="bayesian-models-of-cognition.html#multilevel-sequential-updating-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s extend this to a multilevel model that captures individual differences in learning rates and evidence weighting:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="bayesian-models-of-cognition.html#cb570-1" tabindex="-1"></a><span class="co"># Stan code for a multilevel sequential Bayesian updating model</span></span>
<span id="cb570-2"><a href="bayesian-models-of-cognition.html#cb570-2" tabindex="-1"></a>multilevel_sequential_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb570-3"><a href="bayesian-models-of-cognition.html#cb570-3" tabindex="-1"></a><span class="st">// Multilevel Sequential Bayesian Updating Model</span></span>
<span id="cb570-4"><a href="bayesian-models-of-cognition.html#cb570-4" tabindex="-1"></a><span class="st">// This model captures individual differences in sequential belief updating</span></span>
<span id="cb570-5"><a href="bayesian-models-of-cognition.html#cb570-5" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb570-6"><a href="bayesian-models-of-cognition.html#cb570-6" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;                        // Total number of observations</span></span>
<span id="cb570-7"><a href="bayesian-models-of-cognition.html#cb570-7" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; J;                        // Number of agents</span></span>
<span id="cb570-8"><a href="bayesian-models-of-cognition.html#cb570-8" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; T;                        // Maximum number of trials per agent</span></span>
<span id="cb570-9"><a href="bayesian-models-of-cognition.html#cb570-9" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1, upper=J&gt; agent_id; // Agent ID for each observation</span></span>
<span id="cb570-10"><a href="bayesian-models-of-cognition.html#cb570-10" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1, upper=T&gt; trial_id; // Trial number for each observation</span></span>
<span id="cb570-11"><a href="bayesian-models-of-cognition.html#cb570-11" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; choice;   // Choices (0=red, 1=blue)</span></span>
<span id="cb570-12"><a href="bayesian-models-of-cognition.html#cb570-12" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue1;             // Direct evidence (blue marbles)</span></span>
<span id="cb570-13"><a href="bayesian-models-of-cognition.html#cb570-13" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total1;            // Total direct evidence</span></span>
<span id="cb570-14"><a href="bayesian-models-of-cognition.html#cb570-14" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; blue2;             // Social evidence (blue signals)</span></span>
<span id="cb570-15"><a href="bayesian-models-of-cognition.html#cb570-15" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0&gt; total2;            // Total social evidence</span></span>
<span id="cb570-16"><a href="bayesian-models-of-cognition.html#cb570-16" tabindex="-1"></a><span class="st">  // Additional data for tracking trial sequences</span></span>
<span id="cb570-17"><a href="bayesian-models-of-cognition.html#cb570-17" tabindex="-1"></a><span class="st">  array[J] int&lt;lower=1, upper=T&gt; trials_per_agent; // Number of trials for each agent</span></span>
<span id="cb570-18"><a href="bayesian-models-of-cognition.html#cb570-18" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb570-19"><a href="bayesian-models-of-cognition.html#cb570-19" tabindex="-1"></a></span>
<span id="cb570-20"><a href="bayesian-models-of-cognition.html#cb570-20" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb570-21"><a href="bayesian-models-of-cognition.html#cb570-21" tabindex="-1"></a><span class="st">  // Population-level parameters</span></span>
<span id="cb570-22"><a href="bayesian-models-of-cognition.html#cb570-22" tabindex="-1"></a><span class="st">  real mu_total_weight;                   // Population mean log total weight</span></span>
<span id="cb570-23"><a href="bayesian-models-of-cognition.html#cb570-23" tabindex="-1"></a><span class="st">  real mu_weight_prop_logit;              // Population mean logit weight proportion</span></span>
<span id="cb570-24"><a href="bayesian-models-of-cognition.html#cb570-24" tabindex="-1"></a><span class="st">  real mu_learning_log;                      // Population mean log learning rate</span></span>
<span id="cb570-25"><a href="bayesian-models-of-cognition.html#cb570-25" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-26"><a href="bayesian-models-of-cognition.html#cb570-26" tabindex="-1"></a><span class="st">  // Population-level standard deviations</span></span>
<span id="cb570-27"><a href="bayesian-models-of-cognition.html#cb570-27" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[3] tau;                 // SDs for [total_weight, weight_prop, alpha]</span></span>
<span id="cb570-28"><a href="bayesian-models-of-cognition.html#cb570-28" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-29"><a href="bayesian-models-of-cognition.html#cb570-29" tabindex="-1"></a><span class="st">  // Correlation matrix for individual parameters (optional)</span></span>
<span id="cb570-30"><a href="bayesian-models-of-cognition.html#cb570-30" tabindex="-1"></a><span class="st">  cholesky_factor_corr[3] L_Omega;        // Cholesky factor of correlation matrix</span></span>
<span id="cb570-31"><a href="bayesian-models-of-cognition.html#cb570-31" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-32"><a href="bayesian-models-of-cognition.html#cb570-32" tabindex="-1"></a><span class="st">  // Individual-level variations (non-centered parameterization)</span></span>
<span id="cb570-33"><a href="bayesian-models-of-cognition.html#cb570-33" tabindex="-1"></a><span class="st">  matrix[3, J] z;                         // Standardized individual parameters</span></span>
<span id="cb570-34"><a href="bayesian-models-of-cognition.html#cb570-34" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb570-35"><a href="bayesian-models-of-cognition.html#cb570-35" tabindex="-1"></a></span>
<span id="cb570-36"><a href="bayesian-models-of-cognition.html#cb570-36" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb570-37"><a href="bayesian-models-of-cognition.html#cb570-37" tabindex="-1"></a><span class="st">  // Individual-level parameters</span></span>
<span id="cb570-38"><a href="bayesian-models-of-cognition.html#cb570-38" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] total_weight;        // Total evidence weight for each agent</span></span>
<span id="cb570-39"><a href="bayesian-models-of-cognition.html#cb570-39" tabindex="-1"></a><span class="st">  vector&lt;lower=0, upper=1&gt;[J] weight_prop; // Weight proportion for each agent</span></span>
<span id="cb570-40"><a href="bayesian-models-of-cognition.html#cb570-40" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] learning;               // Learning rate for each agent</span></span>
<span id="cb570-41"><a href="bayesian-models-of-cognition.html#cb570-41" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_direct;       // Direct evidence weight for each agent</span></span>
<span id="cb570-42"><a href="bayesian-models-of-cognition.html#cb570-42" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[J] weight_social;       // Social evidence weight for each agent</span></span>
<span id="cb570-43"><a href="bayesian-models-of-cognition.html#cb570-43" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-44"><a href="bayesian-models-of-cognition.html#cb570-44" tabindex="-1"></a><span class="st">  // Individual beliefs for each trial</span></span>
<span id="cb570-45"><a href="bayesian-models-of-cognition.html#cb570-45" tabindex="-1"></a><span class="st">  // We&#39;ll use a ragged structure due to varying trial counts</span></span>
<span id="cb570-46"><a href="bayesian-models-of-cognition.html#cb570-46" tabindex="-1"></a><span class="st">  array[J, T] real belief;                // Belief in blue for each agent on each trial</span></span>
<span id="cb570-47"><a href="bayesian-models-of-cognition.html#cb570-47" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-48"><a href="bayesian-models-of-cognition.html#cb570-48" tabindex="-1"></a><span class="st">  // Transform parameters to natural scale</span></span>
<span id="cb570-49"><a href="bayesian-models-of-cognition.html#cb570-49" tabindex="-1"></a><span class="st">  matrix[3, J] theta = diag_pre_multiply(tau, L_Omega) * z;  // Non-centered parameterization</span></span>
<span id="cb570-50"><a href="bayesian-models-of-cognition.html#cb570-50" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-51"><a href="bayesian-models-of-cognition.html#cb570-51" tabindex="-1"></a><span class="st">  for (j in 1:J) {</span></span>
<span id="cb570-52"><a href="bayesian-models-of-cognition.html#cb570-52" tabindex="-1"></a><span class="st">    // Transform individual parameters to appropriate scales</span></span>
<span id="cb570-53"><a href="bayesian-models-of-cognition.html#cb570-53" tabindex="-1"></a><span class="st">    total_weight[j] = exp(mu_total_weight + theta[1, j]);</span></span>
<span id="cb570-54"><a href="bayesian-models-of-cognition.html#cb570-54" tabindex="-1"></a><span class="st">    weight_prop[j] = inv_logit(mu_weight_prop_logit + theta[2, j]);</span></span>
<span id="cb570-55"><a href="bayesian-models-of-cognition.html#cb570-55" tabindex="-1"></a><span class="st">    learning[j] = exp(mu_learning_log + theta[3, j]);</span></span>
<span id="cb570-56"><a href="bayesian-models-of-cognition.html#cb570-56" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb570-57"><a href="bayesian-models-of-cognition.html#cb570-57" tabindex="-1"></a><span class="st">    // Calculate derived weights</span></span>
<span id="cb570-58"><a href="bayesian-models-of-cognition.html#cb570-58" tabindex="-1"></a><span class="st">    weight_direct[j] = total_weight[j] * weight_prop[j];</span></span>
<span id="cb570-59"><a href="bayesian-models-of-cognition.html#cb570-59" tabindex="-1"></a><span class="st">    weight_social[j] = total_weight[j] * (1 - weight_prop[j]);</span></span>
<span id="cb570-60"><a href="bayesian-models-of-cognition.html#cb570-60" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb570-61"><a href="bayesian-models-of-cognition.html#cb570-61" tabindex="-1"></a><span class="st">    // Initialize belief tracking for each agent</span></span>
<span id="cb570-62"><a href="bayesian-models-of-cognition.html#cb570-62" tabindex="-1"></a><span class="st">    real alpha_param = 1.0;  // Initial beta distribution parameters</span></span>
<span id="cb570-63"><a href="bayesian-models-of-cognition.html#cb570-63" tabindex="-1"></a><span class="st">    real beta_param = 1.0;</span></span>
<span id="cb570-64"><a href="bayesian-models-of-cognition.html#cb570-64" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb570-65"><a href="bayesian-models-of-cognition.html#cb570-65" tabindex="-1"></a><span class="st">    // Calculate initial belief</span></span>
<span id="cb570-66"><a href="bayesian-models-of-cognition.html#cb570-66" tabindex="-1"></a><span class="st">    belief[j, 1] = alpha_param / (alpha_param + beta_param);</span></span>
<span id="cb570-67"><a href="bayesian-models-of-cognition.html#cb570-67" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb570-68"><a href="bayesian-models-of-cognition.html#cb570-68" tabindex="-1"></a><span class="st">    // Process trials for this agent (skipping the first trial since we initialized it above)</span></span>
<span id="cb570-69"><a href="bayesian-models-of-cognition.html#cb570-69" tabindex="-1"></a><span class="st">    for (t in 2:trials_per_agent[j]) {</span></span>
<span id="cb570-70"><a href="bayesian-models-of-cognition.html#cb570-70" tabindex="-1"></a><span class="st">      // Find the previous trial&#39;s data for this agent</span></span>
<span id="cb570-71"><a href="bayesian-models-of-cognition.html#cb570-71" tabindex="-1"></a><span class="st">      int prev_idx = 0;</span></span>
<span id="cb570-72"><a href="bayesian-models-of-cognition.html#cb570-72" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb570-73"><a href="bayesian-models-of-cognition.html#cb570-73" tabindex="-1"></a><span class="st">      // Search for previous trial (this is a simplification; more efficient approaches exist)</span></span>
<span id="cb570-74"><a href="bayesian-models-of-cognition.html#cb570-74" tabindex="-1"></a><span class="st">      for (i in 1:N) {</span></span>
<span id="cb570-75"><a href="bayesian-models-of-cognition.html#cb570-75" tabindex="-1"></a><span class="st">        if (agent_id[i] == j &amp;&amp; trial_id[i] == t-1) {</span></span>
<span id="cb570-76"><a href="bayesian-models-of-cognition.html#cb570-76" tabindex="-1"></a><span class="st">          prev_idx = i;</span></span>
<span id="cb570-77"><a href="bayesian-models-of-cognition.html#cb570-77" tabindex="-1"></a><span class="st">          break;</span></span>
<span id="cb570-78"><a href="bayesian-models-of-cognition.html#cb570-78" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb570-79"><a href="bayesian-models-of-cognition.html#cb570-79" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb570-80"><a href="bayesian-models-of-cognition.html#cb570-80" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb570-81"><a href="bayesian-models-of-cognition.html#cb570-81" tabindex="-1"></a><span class="st">      if (prev_idx &gt; 0) {</span></span>
<span id="cb570-82"><a href="bayesian-models-of-cognition.html#cb570-82" tabindex="-1"></a><span class="st">        // Calculate weighted evidence from previous trial</span></span>
<span id="cb570-83"><a href="bayesian-models-of-cognition.html#cb570-83" tabindex="-1"></a><span class="st">        real weighted_blue1 = blue1[prev_idx] * weight_direct[j];</span></span>
<span id="cb570-84"><a href="bayesian-models-of-cognition.html#cb570-84" tabindex="-1"></a><span class="st">        real weighted_red1 = (total1[prev_idx] - blue1[prev_idx]) * weight_direct[j];</span></span>
<span id="cb570-85"><a href="bayesian-models-of-cognition.html#cb570-85" tabindex="-1"></a><span class="st">        real weighted_blue2 = blue2[prev_idx] * weight_social[j];</span></span>
<span id="cb570-86"><a href="bayesian-models-of-cognition.html#cb570-86" tabindex="-1"></a><span class="st">        real weighted_red2 = (total2[prev_idx] - blue2[prev_idx]) * weight_social[j];</span></span>
<span id="cb570-87"><a href="bayesian-models-of-cognition.html#cb570-87" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb570-88"><a href="bayesian-models-of-cognition.html#cb570-88" tabindex="-1"></a><span class="st">        // Update belief parameters with learning rate</span></span>
<span id="cb570-89"><a href="bayesian-models-of-cognition.html#cb570-89" tabindex="-1"></a><span class="st">        alpha_param = alpha_param + alpha[j] * (weighted_blue1 + weighted_blue2);</span></span>
<span id="cb570-90"><a href="bayesian-models-of-cognition.html#cb570-90" tabindex="-1"></a><span class="st">        beta_param = beta_param + alpha[j] * (weighted_red1 + weighted_red2);</span></span>
<span id="cb570-91"><a href="bayesian-models-of-cognition.html#cb570-91" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb570-92"><a href="bayesian-models-of-cognition.html#cb570-92" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb570-93"><a href="bayesian-models-of-cognition.html#cb570-93" tabindex="-1"></a><span class="st">      // Calculate updated belief</span></span>
<span id="cb570-94"><a href="bayesian-models-of-cognition.html#cb570-94" tabindex="-1"></a><span class="st">      belief[j, t] = alpha_param / (alpha_param + beta_param);</span></span>
<span id="cb570-95"><a href="bayesian-models-of-cognition.html#cb570-95" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb570-96"><a href="bayesian-models-of-cognition.html#cb570-96" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb570-97"><a href="bayesian-models-of-cognition.html#cb570-97" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb570-98"><a href="bayesian-models-of-cognition.html#cb570-98" tabindex="-1"></a></span>
<span id="cb570-99"><a href="bayesian-models-of-cognition.html#cb570-99" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb570-100"><a href="bayesian-models-of-cognition.html#cb570-100" tabindex="-1"></a><span class="st">  // Priors for population parameters</span></span>
<span id="cb570-101"><a href="bayesian-models-of-cognition.html#cb570-101" tabindex="-1"></a><span class="st">  target += normal_lpdf(mu_total_weight | 0, 1);         // Population log total weight</span></span>
<span id="cb570-102"><a href="bayesian-models-of-cognition.html#cb570-102" tabindex="-1"></a><span class="st">  target += normal_lpdf(mu_weight_prop_logit | 0, 1);    // Population logit weight proportion</span></span>
<span id="cb570-103"><a href="bayesian-models-of-cognition.html#cb570-103" tabindex="-1"></a><span class="st">  target += normal_lpdf(mu_alpha_log | -1, 1);           // Population log learning rate</span></span>
<span id="cb570-104"><a href="bayesian-models-of-cognition.html#cb570-104" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-105"><a href="bayesian-models-of-cognition.html#cb570-105" tabindex="-1"></a><span class="st">  // Priors for population standard deviations</span></span>
<span id="cb570-106"><a href="bayesian-models-of-cognition.html#cb570-106" tabindex="-1"></a><span class="st">  target += exponential_lpdf(tau | 2);                   // Conservative prior for SDs</span></span>
<span id="cb570-107"><a href="bayesian-models-of-cognition.html#cb570-107" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-108"><a href="bayesian-models-of-cognition.html#cb570-108" tabindex="-1"></a><span class="st">  // Prior for correlation matrix</span></span>
<span id="cb570-109"><a href="bayesian-models-of-cognition.html#cb570-109" tabindex="-1"></a><span class="st">  target += lkj_corr_cholesky_lpdf(L_Omega | 2);         // LKJ prior on correlations</span></span>
<span id="cb570-110"><a href="bayesian-models-of-cognition.html#cb570-110" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-111"><a href="bayesian-models-of-cognition.html#cb570-111" tabindex="-1"></a><span class="st">  // Prior for standardized individual parameters</span></span>
<span id="cb570-112"><a href="bayesian-models-of-cognition.html#cb570-112" tabindex="-1"></a><span class="st">  target += std_normal_lpdf(to_vector(z));               // Standard normal prior on z-scores</span></span>
<span id="cb570-113"><a href="bayesian-models-of-cognition.html#cb570-113" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-114"><a href="bayesian-models-of-cognition.html#cb570-114" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb570-115"><a href="bayesian-models-of-cognition.html#cb570-115" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb570-116"><a href="bayesian-models-of-cognition.html#cb570-116" tabindex="-1"></a><span class="st">    int j = agent_id[i];                                  // Agent ID</span></span>
<span id="cb570-117"><a href="bayesian-models-of-cognition.html#cb570-117" tabindex="-1"></a><span class="st">    int t = trial_id[i];                                  // Trial number</span></span>
<span id="cb570-118"><a href="bayesian-models-of-cognition.html#cb570-118" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb570-119"><a href="bayesian-models-of-cognition.html#cb570-119" tabindex="-1"></a><span class="st">    // Model choice as a function of current belief</span></span>
<span id="cb570-120"><a href="bayesian-models-of-cognition.html#cb570-120" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(choice[i] | belief[j, t]);</span></span>
<span id="cb570-121"><a href="bayesian-models-of-cognition.html#cb570-121" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb570-122"><a href="bayesian-models-of-cognition.html#cb570-122" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb570-123"><a href="bayesian-models-of-cognition.html#cb570-123" tabindex="-1"></a></span>
<span id="cb570-124"><a href="bayesian-models-of-cognition.html#cb570-124" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb570-125"><a href="bayesian-models-of-cognition.html#cb570-125" tabindex="-1"></a><span class="st">  // Transform population parameters to natural scale for interpretation</span></span>
<span id="cb570-126"><a href="bayesian-models-of-cognition.html#cb570-126" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; pop_total_weight = exp(mu_total_weight);</span></span>
<span id="cb570-127"><a href="bayesian-models-of-cognition.html#cb570-127" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; pop_weight_prop = inv_logit(mu_weight_prop_logit);</span></span>
<span id="cb570-128"><a href="bayesian-models-of-cognition.html#cb570-128" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; pop_alpha = exp(mu_alpha_log);</span></span>
<span id="cb570-129"><a href="bayesian-models-of-cognition.html#cb570-129" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; pop_weight_direct = pop_total_weight * pop_weight_prop;</span></span>
<span id="cb570-130"><a href="bayesian-models-of-cognition.html#cb570-130" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; pop_weight_social = pop_total_weight * (1 - pop_weight_prop);</span></span>
<span id="cb570-131"><a href="bayesian-models-of-cognition.html#cb570-131" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-132"><a href="bayesian-models-of-cognition.html#cb570-132" tabindex="-1"></a><span class="st">  // Correlation matrix for individual differences</span></span>
<span id="cb570-133"><a href="bayesian-models-of-cognition.html#cb570-133" tabindex="-1"></a><span class="st">  matrix[3, 3] Omega = multiply_lower_tri_self_transpose(L_Omega);</span></span>
<span id="cb570-134"><a href="bayesian-models-of-cognition.html#cb570-134" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-135"><a href="bayesian-models-of-cognition.html#cb570-135" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb570-136"><a href="bayesian-models-of-cognition.html#cb570-136" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb570-137"><a href="bayesian-models-of-cognition.html#cb570-137" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-138"><a href="bayesian-models-of-cognition.html#cb570-138" tabindex="-1"></a><span class="st">  // Posterior predictions</span></span>
<span id="cb570-139"><a href="bayesian-models-of-cognition.html#cb570-139" tabindex="-1"></a><span class="st">  array[N] int pred_choice;</span></span>
<span id="cb570-140"><a href="bayesian-models-of-cognition.html#cb570-140" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb570-141"><a href="bayesian-models-of-cognition.html#cb570-141" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb570-142"><a href="bayesian-models-of-cognition.html#cb570-142" tabindex="-1"></a><span class="st">    int j = agent_id[i];</span></span>
<span id="cb570-143"><a href="bayesian-models-of-cognition.html#cb570-143" tabindex="-1"></a><span class="st">    int t = trial_id[i];</span></span>
<span id="cb570-144"><a href="bayesian-models-of-cognition.html#cb570-144" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb570-145"><a href="bayesian-models-of-cognition.html#cb570-145" tabindex="-1"></a><span class="st">    // Generate predicted choices</span></span>
<span id="cb570-146"><a href="bayesian-models-of-cognition.html#cb570-146" tabindex="-1"></a><span class="st">    pred_choice[i] = bernoulli_rng(belief[j, t]);</span></span>
<span id="cb570-147"><a href="bayesian-models-of-cognition.html#cb570-147" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb570-148"><a href="bayesian-models-of-cognition.html#cb570-148" tabindex="-1"></a><span class="st">    // Calculate log likelihood</span></span>
<span id="cb570-149"><a href="bayesian-models-of-cognition.html#cb570-149" tabindex="-1"></a><span class="st">    log_lik[i] = bernoulli_lpmf(choice[i] | belief[j, t]);</span></span>
<span id="cb570-150"><a href="bayesian-models-of-cognition.html#cb570-150" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb570-151"><a href="bayesian-models-of-cognition.html#cb570-151" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb570-152"><a href="bayesian-models-of-cognition.html#cb570-152" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb570-153"><a href="bayesian-models-of-cognition.html#cb570-153" tabindex="-1"></a></span>
<span id="cb570-154"><a href="bayesian-models-of-cognition.html#cb570-154" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb570-155"><a href="bayesian-models-of-cognition.html#cb570-155" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb570-156"><a href="bayesian-models-of-cognition.html#cb570-156" tabindex="-1"></a>  multilevel_sequential_stan,</span>
<span id="cb570-157"><a href="bayesian-models-of-cognition.html#cb570-157" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb570-158"><a href="bayesian-models-of-cognition.html#cb570-158" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;10_multilevel_sequential_updating.stan&quot;</span></span>
<span id="cb570-159"><a href="bayesian-models-of-cognition.html#cb570-159" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/10_multilevel_sequential_updating.stan&quot;</code></pre>
</div>
<div id="generating-data-for-the-sequential-model" class="section level3 hasAnchor" number="11.23.4">
<h3><span class="header-section-number">11.23.4</span> Generating Data for the Sequential Model<a href="bayesian-models-of-cognition.html#generating-data-for-the-sequential-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To test our sequential updating model, we need to generate data that involves a sequence of decisions where beliefs are updated over time. Here’s how we can simulate such data:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="bayesian-models-of-cognition.html#cb572-1" tabindex="-1"></a><span class="co"># Function to simulate sequential updating agent behavior</span></span>
<span id="cb572-2"><a href="bayesian-models-of-cognition.html#cb572-2" tabindex="-1"></a>simulate_sequential_agent <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, </span>
<span id="cb572-3"><a href="bayesian-models-of-cognition.html#cb572-3" tabindex="-1"></a>                                     weight_direct, </span>
<span id="cb572-4"><a href="bayesian-models-of-cognition.html#cb572-4" tabindex="-1"></a>                                     weight_social, </span>
<span id="cb572-5"><a href="bayesian-models-of-cognition.html#cb572-5" tabindex="-1"></a>                                     learning_rate,</span>
<span id="cb572-6"><a href="bayesian-models-of-cognition.html#cb572-6" tabindex="-1"></a>                                     <span class="at">p_blue_transitions =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)) {</span>
<span id="cb572-7"><a href="bayesian-models-of-cognition.html#cb572-7" tabindex="-1"></a>  <span class="co"># p_blue_transitions = c(p(blue|previous=blue), p(blue|previous=red))</span></span>
<span id="cb572-8"><a href="bayesian-models-of-cognition.html#cb572-8" tabindex="-1"></a>  <span class="co"># This creates a Markov process for the underlying jar probabilities</span></span>
<span id="cb572-9"><a href="bayesian-models-of-cognition.html#cb572-9" tabindex="-1"></a>  </span>
<span id="cb572-10"><a href="bayesian-models-of-cognition.html#cb572-10" tabindex="-1"></a>  <span class="co"># Initialize results</span></span>
<span id="cb572-11"><a href="bayesian-models-of-cognition.html#cb572-11" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb572-12"><a href="bayesian-models-of-cognition.html#cb572-12" tabindex="-1"></a>    <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>n_trials,</span>
<span id="cb572-13"><a href="bayesian-models-of-cognition.html#cb572-13" tabindex="-1"></a>    <span class="at">true_p_blue =</span> <span class="cn">NA_real_</span>,        <span class="co"># True probability of blue</span></span>
<span id="cb572-14"><a href="bayesian-models-of-cognition.html#cb572-14" tabindex="-1"></a>    <span class="at">jar_state =</span> <span class="cn">NA_integer_</span>,       <span class="co"># Which jar: 1=mostly blue, 0=mostly red</span></span>
<span id="cb572-15"><a href="bayesian-models-of-cognition.html#cb572-15" tabindex="-1"></a>    <span class="at">blue1 =</span> <span class="cn">NA_integer_</span>,           <span class="co"># Direct evidence (blue marbles)</span></span>
<span id="cb572-16"><a href="bayesian-models-of-cognition.html#cb572-16" tabindex="-1"></a>    <span class="at">total1 =</span> <span class="cn">NA_integer_</span>,          <span class="co"># Total direct evidence</span></span>
<span id="cb572-17"><a href="bayesian-models-of-cognition.html#cb572-17" tabindex="-1"></a>    <span class="at">blue2 =</span> <span class="cn">NA_integer_</span>,           <span class="co"># Social evidence (blue signals)</span></span>
<span id="cb572-18"><a href="bayesian-models-of-cognition.html#cb572-18" tabindex="-1"></a>    <span class="at">total2 =</span> <span class="cn">NA_integer_</span>,          <span class="co"># Total social evidence</span></span>
<span id="cb572-19"><a href="bayesian-models-of-cognition.html#cb572-19" tabindex="-1"></a>    <span class="at">belief =</span> <span class="cn">NA_real_</span>,             <span class="co"># Agent&#39;s belief that next marble is blue</span></span>
<span id="cb572-20"><a href="bayesian-models-of-cognition.html#cb572-20" tabindex="-1"></a>    <span class="at">choice =</span> <span class="cn">NA_integer_</span>           <span class="co"># Agent&#39;s choice (1=blue, 0=red)</span></span>
<span id="cb572-21"><a href="bayesian-models-of-cognition.html#cb572-21" tabindex="-1"></a>  )</span>
<span id="cb572-22"><a href="bayesian-models-of-cognition.html#cb572-22" tabindex="-1"></a>  </span>
<span id="cb572-23"><a href="bayesian-models-of-cognition.html#cb572-23" tabindex="-1"></a>  <span class="co"># Initialize belief tracking variables</span></span>
<span id="cb572-24"><a href="bayesian-models-of-cognition.html#cb572-24" tabindex="-1"></a>  alpha_param <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb572-25"><a href="bayesian-models-of-cognition.html#cb572-25" tabindex="-1"></a>  beta_param <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb572-26"><a href="bayesian-models-of-cognition.html#cb572-26" tabindex="-1"></a>  </span>
<span id="cb572-27"><a href="bayesian-models-of-cognition.html#cb572-27" tabindex="-1"></a>  <span class="co"># Set initial jar state randomly</span></span>
<span id="cb572-28"><a href="bayesian-models-of-cognition.html#cb572-28" tabindex="-1"></a>  results<span class="sc">$</span>jar_state[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb572-29"><a href="bayesian-models-of-cognition.html#cb572-29" tabindex="-1"></a>  results<span class="sc">$</span>true_p_blue[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(results<span class="sc">$</span>jar_state[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>)</span>
<span id="cb572-30"><a href="bayesian-models-of-cognition.html#cb572-30" tabindex="-1"></a>  </span>
<span id="cb572-31"><a href="bayesian-models-of-cognition.html#cb572-31" tabindex="-1"></a>  <span class="co"># Generate the sequence of jar states (Markov process)</span></span>
<span id="cb572-32"><a href="bayesian-models-of-cognition.html#cb572-32" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_trials) {</span>
<span id="cb572-33"><a href="bayesian-models-of-cognition.html#cb572-33" tabindex="-1"></a>    <span class="co"># Transition probability depends on previous state</span></span>
<span id="cb572-34"><a href="bayesian-models-of-cognition.html#cb572-34" tabindex="-1"></a>    p_blue <span class="ot">&lt;-</span> p_blue_transitions[<span class="dv">2</span> <span class="sc">-</span> results<span class="sc">$</span>jar_state[t<span class="dv">-1</span>]]</span>
<span id="cb572-35"><a href="bayesian-models-of-cognition.html#cb572-35" tabindex="-1"></a>    results<span class="sc">$</span>jar_state[t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, p_blue)</span>
<span id="cb572-36"><a href="bayesian-models-of-cognition.html#cb572-36" tabindex="-1"></a>    results<span class="sc">$</span>true_p_blue[t] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(results<span class="sc">$</span>jar_state[t] <span class="sc">==</span> <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>)</span>
<span id="cb572-37"><a href="bayesian-models-of-cognition.html#cb572-37" tabindex="-1"></a>  }</span>
<span id="cb572-38"><a href="bayesian-models-of-cognition.html#cb572-38" tabindex="-1"></a>  </span>
<span id="cb572-39"><a href="bayesian-models-of-cognition.html#cb572-39" tabindex="-1"></a>  <span class="co"># Generate evidence and choices for each trial</span></span>
<span id="cb572-40"><a href="bayesian-models-of-cognition.html#cb572-40" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb572-41"><a href="bayesian-models-of-cognition.html#cb572-41" tabindex="-1"></a>    <span class="co"># Generate direct evidence (8 marbles per trial)</span></span>
<span id="cb572-42"><a href="bayesian-models-of-cognition.html#cb572-42" tabindex="-1"></a>    results<span class="sc">$</span>total1[t] <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb572-43"><a href="bayesian-models-of-cognition.html#cb572-43" tabindex="-1"></a>    results<span class="sc">$</span>blue1[t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, results<span class="sc">$</span>total1[t], results<span class="sc">$</span>true_p_blue[t])</span>
<span id="cb572-44"><a href="bayesian-models-of-cognition.html#cb572-44" tabindex="-1"></a>    </span>
<span id="cb572-45"><a href="bayesian-models-of-cognition.html#cb572-45" tabindex="-1"></a>    <span class="co"># Generate social evidence (3 signals per trial)</span></span>
<span id="cb572-46"><a href="bayesian-models-of-cognition.html#cb572-46" tabindex="-1"></a>    results<span class="sc">$</span>total2[t] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb572-47"><a href="bayesian-models-of-cognition.html#cb572-47" tabindex="-1"></a>    results<span class="sc">$</span>blue2[t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, results<span class="sc">$</span>total2[t], results<span class="sc">$</span>true_p_blue[t])</span>
<span id="cb572-48"><a href="bayesian-models-of-cognition.html#cb572-48" tabindex="-1"></a>    </span>
<span id="cb572-49"><a href="bayesian-models-of-cognition.html#cb572-49" tabindex="-1"></a>    <span class="co"># Calculate current belief based on previous evidence</span></span>
<span id="cb572-50"><a href="bayesian-models-of-cognition.html#cb572-50" tabindex="-1"></a>    <span class="cf">if</span> (t <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb572-51"><a href="bayesian-models-of-cognition.html#cb572-51" tabindex="-1"></a>      <span class="co"># First trial - start with uniform prior</span></span>
<span id="cb572-52"><a href="bayesian-models-of-cognition.html#cb572-52" tabindex="-1"></a>      results<span class="sc">$</span>belief[t] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb572-53"><a href="bayesian-models-of-cognition.html#cb572-53" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb572-54"><a href="bayesian-models-of-cognition.html#cb572-54" tabindex="-1"></a>      <span class="co"># Calculate weighted evidence from previous trial</span></span>
<span id="cb572-55"><a href="bayesian-models-of-cognition.html#cb572-55" tabindex="-1"></a>      weighted_blue1 <span class="ot">&lt;-</span> results<span class="sc">$</span>blue1[t<span class="dv">-1</span>] <span class="sc">*</span> weight_direct</span>
<span id="cb572-56"><a href="bayesian-models-of-cognition.html#cb572-56" tabindex="-1"></a>      weighted_red1 <span class="ot">&lt;-</span> (results<span class="sc">$</span>total1[t<span class="dv">-1</span>] <span class="sc">-</span> results<span class="sc">$</span>blue1[t<span class="dv">-1</span>]) <span class="sc">*</span> weight_direct</span>
<span id="cb572-57"><a href="bayesian-models-of-cognition.html#cb572-57" tabindex="-1"></a>      weighted_blue2 <span class="ot">&lt;-</span> results<span class="sc">$</span>blue2[t<span class="dv">-1</span>] <span class="sc">*</span> weight_social</span>
<span id="cb572-58"><a href="bayesian-models-of-cognition.html#cb572-58" tabindex="-1"></a>      weighted_red2 <span class="ot">&lt;-</span> (results<span class="sc">$</span>total2[t<span class="dv">-1</span>] <span class="sc">-</span> results<span class="sc">$</span>blue2[t<span class="dv">-1</span>]) <span class="sc">*</span> weight_social</span>
<span id="cb572-59"><a href="bayesian-models-of-cognition.html#cb572-59" tabindex="-1"></a>      </span>
<span id="cb572-60"><a href="bayesian-models-of-cognition.html#cb572-60" tabindex="-1"></a>      <span class="co"># Update belief parameters with learning rate</span></span>
<span id="cb572-61"><a href="bayesian-models-of-cognition.html#cb572-61" tabindex="-1"></a>      alpha_param <span class="ot">&lt;-</span> alpha_param <span class="sc">+</span> learning_rate <span class="sc">*</span> (weighted_blue1 <span class="sc">+</span> weighted_blue2)</span>
<span id="cb572-62"><a href="bayesian-models-of-cognition.html#cb572-62" tabindex="-1"></a>      beta_param <span class="ot">&lt;-</span> beta_param <span class="sc">+</span> learning_rate <span class="sc">*</span> (weighted_red1 <span class="sc">+</span> weighted_red2)</span>
<span id="cb572-63"><a href="bayesian-models-of-cognition.html#cb572-63" tabindex="-1"></a>      </span>
<span id="cb572-64"><a href="bayesian-models-of-cognition.html#cb572-64" tabindex="-1"></a>      <span class="co"># Calculate updated belief</span></span>
<span id="cb572-65"><a href="bayesian-models-of-cognition.html#cb572-65" tabindex="-1"></a>      results<span class="sc">$</span>belief[t] <span class="ot">&lt;-</span> alpha_param <span class="sc">/</span> (alpha_param <span class="sc">+</span> beta_param)</span>
<span id="cb572-66"><a href="bayesian-models-of-cognition.html#cb572-66" tabindex="-1"></a>    }</span>
<span id="cb572-67"><a href="bayesian-models-of-cognition.html#cb572-67" tabindex="-1"></a>    </span>
<span id="cb572-68"><a href="bayesian-models-of-cognition.html#cb572-68" tabindex="-1"></a>    <span class="co"># Generate choice based on current belief</span></span>
<span id="cb572-69"><a href="bayesian-models-of-cognition.html#cb572-69" tabindex="-1"></a>    results<span class="sc">$</span>choice[t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, results<span class="sc">$</span>belief[t])</span>
<span id="cb572-70"><a href="bayesian-models-of-cognition.html#cb572-70" tabindex="-1"></a>  }</span>
<span id="cb572-71"><a href="bayesian-models-of-cognition.html#cb572-71" tabindex="-1"></a>  </span>
<span id="cb572-72"><a href="bayesian-models-of-cognition.html#cb572-72" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb572-73"><a href="bayesian-models-of-cognition.html#cb572-73" tabindex="-1"></a>}</span>
<span id="cb572-74"><a href="bayesian-models-of-cognition.html#cb572-74" tabindex="-1"></a></span>
<span id="cb572-75"><a href="bayesian-models-of-cognition.html#cb572-75" tabindex="-1"></a><span class="co"># Simulate data for multiple agents with different parameters</span></span>
<span id="cb572-76"><a href="bayesian-models-of-cognition.html#cb572-76" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb572-77"><a href="bayesian-models-of-cognition.html#cb572-77" tabindex="-1"></a></span>
<span id="cb572-78"><a href="bayesian-models-of-cognition.html#cb572-78" tabindex="-1"></a><span class="co"># Number of agents and trials</span></span>
<span id="cb572-79"><a href="bayesian-models-of-cognition.html#cb572-79" tabindex="-1"></a>n_agents <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb572-80"><a href="bayesian-models-of-cognition.html#cb572-80" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb572-81"><a href="bayesian-models-of-cognition.html#cb572-81" tabindex="-1"></a></span>
<span id="cb572-82"><a href="bayesian-models-of-cognition.html#cb572-82" tabindex="-1"></a><span class="co"># Create agent parameters</span></span>
<span id="cb572-83"><a href="bayesian-models-of-cognition.html#cb572-83" tabindex="-1"></a>agent_params <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb572-84"><a href="bayesian-models-of-cognition.html#cb572-84" tabindex="-1"></a>  <span class="at">agent_id =</span> <span class="dv">1</span><span class="sc">:</span>n_agents,</span>
<span id="cb572-85"><a href="bayesian-models-of-cognition.html#cb572-85" tabindex="-1"></a>  <span class="co"># Generate random parameters</span></span>
<span id="cb572-86"><a href="bayesian-models-of-cognition.html#cb572-86" tabindex="-1"></a>  <span class="at">weight_direct =</span> <span class="fu">rlnorm</span>(n_agents, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="fl">0.3</span>),</span>
<span id="cb572-87"><a href="bayesian-models-of-cognition.html#cb572-87" tabindex="-1"></a>  <span class="at">weight_social =</span> <span class="fu">rlnorm</span>(n_agents, <span class="at">meanlog =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">sdlog =</span> <span class="fl">0.3</span>),</span>
<span id="cb572-88"><a href="bayesian-models-of-cognition.html#cb572-88" tabindex="-1"></a>  <span class="at">learning_rate =</span> <span class="fu">rlnorm</span>(n_agents, <span class="at">meanlog =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>)  <span class="co"># Typically &lt; 1</span></span>
<span id="cb572-89"><a href="bayesian-models-of-cognition.html#cb572-89" tabindex="-1"></a>)</span>
<span id="cb572-90"><a href="bayesian-models-of-cognition.html#cb572-90" tabindex="-1"></a></span>
<span id="cb572-91"><a href="bayesian-models-of-cognition.html#cb572-91" tabindex="-1"></a><span class="co"># Simulate data for all agents</span></span>
<span id="cb572-92"><a href="bayesian-models-of-cognition.html#cb572-92" tabindex="-1"></a>sequential_sim_data <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>n_agents, <span class="cf">function</span>(i) {</span>
<span id="cb572-93"><a href="bayesian-models-of-cognition.html#cb572-93" tabindex="-1"></a>  agent_data <span class="ot">&lt;-</span> <span class="fu">simulate_sequential_agent</span>(</span>
<span id="cb572-94"><a href="bayesian-models-of-cognition.html#cb572-94" tabindex="-1"></a>    <span class="at">n_trials =</span> n_trials,</span>
<span id="cb572-95"><a href="bayesian-models-of-cognition.html#cb572-95" tabindex="-1"></a>    <span class="at">weight_direct =</span> agent_params<span class="sc">$</span>weight_direct[i],</span>
<span id="cb572-96"><a href="bayesian-models-of-cognition.html#cb572-96" tabindex="-1"></a>    <span class="at">weight_social =</span> agent_params<span class="sc">$</span>weight_social[i],</span>
<span id="cb572-97"><a href="bayesian-models-of-cognition.html#cb572-97" tabindex="-1"></a>    <span class="at">learning_rate =</span> agent_params<span class="sc">$</span>learning_rate[i]</span>
<span id="cb572-98"><a href="bayesian-models-of-cognition.html#cb572-98" tabindex="-1"></a>  )</span>
<span id="cb572-99"><a href="bayesian-models-of-cognition.html#cb572-99" tabindex="-1"></a>  </span>
<span id="cb572-100"><a href="bayesian-models-of-cognition.html#cb572-100" tabindex="-1"></a>  <span class="co"># Add agent ID</span></span>
<span id="cb572-101"><a href="bayesian-models-of-cognition.html#cb572-101" tabindex="-1"></a>  agent_data<span class="sc">$</span>agent_id <span class="ot">&lt;-</span> i</span>
<span id="cb572-102"><a href="bayesian-models-of-cognition.html#cb572-102" tabindex="-1"></a>  </span>
<span id="cb572-103"><a href="bayesian-models-of-cognition.html#cb572-103" tabindex="-1"></a>  <span class="fu">return</span>(agent_data)</span>
<span id="cb572-104"><a href="bayesian-models-of-cognition.html#cb572-104" tabindex="-1"></a>})</span>
<span id="cb572-105"><a href="bayesian-models-of-cognition.html#cb572-105" tabindex="-1"></a></span>
<span id="cb572-106"><a href="bayesian-models-of-cognition.html#cb572-106" tabindex="-1"></a><span class="co"># View data summary</span></span>
<span id="cb572-107"><a href="bayesian-models-of-cognition.html#cb572-107" tabindex="-1"></a>sequential_summary <span class="ot">&lt;-</span> sequential_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb572-108"><a href="bayesian-models-of-cognition.html#cb572-108" tabindex="-1"></a>  <span class="fu">group_by</span>(agent_id) <span class="sc">%&gt;%</span></span>
<span id="cb572-109"><a href="bayesian-models-of-cognition.html#cb572-109" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb572-110"><a href="bayesian-models-of-cognition.html#cb572-110" tabindex="-1"></a>    <span class="at">n_trials =</span> <span class="fu">n</span>(),</span>
<span id="cb572-111"><a href="bayesian-models-of-cognition.html#cb572-111" tabindex="-1"></a>    <span class="at">mean_belief =</span> <span class="fu">mean</span>(belief),</span>
<span id="cb572-112"><a href="bayesian-models-of-cognition.html#cb572-112" tabindex="-1"></a>    <span class="at">prop_blue_choice =</span> <span class="fu">mean</span>(choice),</span>
<span id="cb572-113"><a href="bayesian-models-of-cognition.html#cb572-113" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">mean</span>(choice <span class="sc">==</span> jar_state),</span>
<span id="cb572-114"><a href="bayesian-models-of-cognition.html#cb572-114" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb572-115"><a href="bayesian-models-of-cognition.html#cb572-115" tabindex="-1"></a>  )</span>
<span id="cb572-116"><a href="bayesian-models-of-cognition.html#cb572-116" tabindex="-1"></a></span>
<span id="cb572-117"><a href="bayesian-models-of-cognition.html#cb572-117" tabindex="-1"></a><span class="co"># Join with true parameters</span></span>
<span id="cb572-118"><a href="bayesian-models-of-cognition.html#cb572-118" tabindex="-1"></a>sequential_summary <span class="ot">&lt;-</span> sequential_summary <span class="sc">%&gt;%</span></span>
<span id="cb572-119"><a href="bayesian-models-of-cognition.html#cb572-119" tabindex="-1"></a>  <span class="fu">left_join</span>(agent_params, <span class="at">by =</span> <span class="st">&quot;agent_id&quot;</span>)</span>
<span id="cb572-120"><a href="bayesian-models-of-cognition.html#cb572-120" tabindex="-1"></a></span>
<span id="cb572-121"><a href="bayesian-models-of-cognition.html#cb572-121" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb572-122"><a href="bayesian-models-of-cognition.html#cb572-122" tabindex="-1"></a><span class="fu">head</span>(sequential_summary)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   agent_id n_trials mean_belief prop_blue_choice accuracy weight_direct weight_social
##      &lt;int&gt;    &lt;int&gt;       &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
## 1        1       50       0.497             0.58     0.4          1.51          0.747
## 2        2       50       0.460             0.46     0.52         0.844         0.480
## 3        3       50       0.491             0.54     0.42         1.12          0.778
## 4        4       50       0.421             0.44     0.56         1.21          1.18 
## 5        5       50       0.493             0.46     0.54         1.13          1.45 
## 6        6       50       0.586             0.58     0.46         0.969         0.720
## # ℹ 1 more variable: learning_rate &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="bayesian-models-of-cognition.html#cb574-1" tabindex="-1"></a><span class="co"># Visualize belief updating for a few agents</span></span>
<span id="cb574-2"><a href="bayesian-models-of-cognition.html#cb574-2" tabindex="-1"></a>selected_agents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb574-3"><a href="bayesian-models-of-cognition.html#cb574-3" tabindex="-1"></a></span>
<span id="cb574-4"><a href="bayesian-models-of-cognition.html#cb574-4" tabindex="-1"></a>p_belief_updating <span class="ot">&lt;-</span> sequential_sim_data <span class="sc">%&gt;%</span></span>
<span id="cb574-5"><a href="bayesian-models-of-cognition.html#cb574-5" tabindex="-1"></a>  <span class="fu">filter</span>(agent_id <span class="sc">%in%</span> selected_agents) <span class="sc">%&gt;%</span></span>
<span id="cb574-6"><a href="bayesian-models-of-cognition.html#cb574-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> belief, <span class="at">color =</span> <span class="fu">factor</span>(agent_id), <span class="at">group =</span> agent_id)) <span class="sc">+</span></span>
<span id="cb574-7"><a href="bayesian-models-of-cognition.html#cb574-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb574-8"><a href="bayesian-models-of-cognition.html#cb574-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> <span class="fu">factor</span>(jar_state)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb574-9"><a href="bayesian-models-of-cognition.html#cb574-9" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="dv">17</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Mostly Red Jar&quot;</span>, <span class="st">&quot;Mostly Blue Jar&quot;</span>)) <span class="sc">+</span></span>
<span id="cb574-10"><a href="bayesian-models-of-cognition.html#cb574-10" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb574-11"><a href="bayesian-models-of-cognition.html#cb574-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb574-12"><a href="bayesian-models-of-cognition.html#cb574-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Sequential Belief Updating&quot;</span>,</span>
<span id="cb574-13"><a href="bayesian-models-of-cognition.html#cb574-13" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Belief evolution across trials with changing jar probabilities&quot;</span>,</span>
<span id="cb574-14"><a href="bayesian-models-of-cognition.html#cb574-14" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb574-15"><a href="bayesian-models-of-cognition.html#cb574-15" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Belief (Probability of Blue)&quot;</span>,</span>
<span id="cb574-16"><a href="bayesian-models-of-cognition.html#cb574-16" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent ID&quot;</span>,</span>
<span id="cb574-17"><a href="bayesian-models-of-cognition.html#cb574-17" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">&quot;True Jar State&quot;</span></span>
<span id="cb574-18"><a href="bayesian-models-of-cognition.html#cb574-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb574-19"><a href="bayesian-models-of-cognition.html#cb574-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb574-20"><a href="bayesian-models-of-cognition.html#cb574-20" tabindex="-1"></a></span>
<span id="cb574-21"><a href="bayesian-models-of-cognition.html#cb574-21" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb574-22"><a href="bayesian-models-of-cognition.html#cb574-22" tabindex="-1"></a><span class="fu">print</span>(p_belief_updating)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-66-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="bayesian-models-of-cognition.html#cb575-1" tabindex="-1"></a><span class="co"># Prepare data for Stan fitting</span></span>
<span id="cb575-2"><a href="bayesian-models-of-cognition.html#cb575-2" tabindex="-1"></a>stan_data_sequential <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb575-3"><a href="bayesian-models-of-cognition.html#cb575-3" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(sequential_sim_data),</span>
<span id="cb575-4"><a href="bayesian-models-of-cognition.html#cb575-4" tabindex="-1"></a>  <span class="at">J =</span> n_agents,</span>
<span id="cb575-5"><a href="bayesian-models-of-cognition.html#cb575-5" tabindex="-1"></a>  <span class="at">T =</span> n_trials,</span>
<span id="cb575-6"><a href="bayesian-models-of-cognition.html#cb575-6" tabindex="-1"></a>  <span class="at">agent_id =</span> sequential_sim_data<span class="sc">$</span>agent_id,</span>
<span id="cb575-7"><a href="bayesian-models-of-cognition.html#cb575-7" tabindex="-1"></a>  <span class="at">trial_id =</span> sequential_sim_data<span class="sc">$</span>trial,</span>
<span id="cb575-8"><a href="bayesian-models-of-cognition.html#cb575-8" tabindex="-1"></a>  <span class="at">choice =</span> sequential_sim_data<span class="sc">$</span>choice,</span>
<span id="cb575-9"><a href="bayesian-models-of-cognition.html#cb575-9" tabindex="-1"></a>  <span class="at">blue1 =</span> sequential_sim_data<span class="sc">$</span>blue1,</span>
<span id="cb575-10"><a href="bayesian-models-of-cognition.html#cb575-10" tabindex="-1"></a>  <span class="at">total1 =</span> sequential_sim_data<span class="sc">$</span>total1,</span>
<span id="cb575-11"><a href="bayesian-models-of-cognition.html#cb575-11" tabindex="-1"></a>  <span class="at">blue2 =</span> sequential_sim_data<span class="sc">$</span>blue2,</span>
<span id="cb575-12"><a href="bayesian-models-of-cognition.html#cb575-12" tabindex="-1"></a>  <span class="at">total2 =</span> sequential_sim_data<span class="sc">$</span>total2,</span>
<span id="cb575-13"><a href="bayesian-models-of-cognition.html#cb575-13" tabindex="-1"></a>  <span class="at">trials_per_agent =</span> <span class="fu">rep</span>(n_trials, n_agents)</span>
<span id="cb575-14"><a href="bayesian-models-of-cognition.html#cb575-14" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="fitting-and-evaluating-the-sequential-models" class="section level3 hasAnchor" number="11.23.5">
<h3><span class="header-section-number">11.23.5</span> Fitting and Evaluating the Sequential Models<a href="bayesian-models-of-cognition.html#fitting-and-evaluating-the-sequential-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can fit the models to our simulated data:</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="bayesian-models-of-cognition.html#cb576-1" tabindex="-1"></a><span class="co"># Check if we need to regenerate model fits</span></span>
<span id="cb576-2"><a href="bayesian-models-of-cognition.html#cb576-2" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb576-3"><a href="bayesian-models-of-cognition.html#cb576-3" tabindex="-1"></a>  <span class="co"># Compile Stan models</span></span>
<span id="cb576-4"><a href="bayesian-models-of-cognition.html#cb576-4" tabindex="-1"></a>  mod_seq_single <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb576-5"><a href="bayesian-models-of-cognition.html#cb576-5" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="st">&quot;stan/10_sequential_updating.stan&quot;</span>),</span>
<span id="cb576-6"><a href="bayesian-models-of-cognition.html#cb576-6" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb576-7"><a href="bayesian-models-of-cognition.html#cb576-7" tabindex="-1"></a>  )</span>
<span id="cb576-8"><a href="bayesian-models-of-cognition.html#cb576-8" tabindex="-1"></a>  </span>
<span id="cb576-9"><a href="bayesian-models-of-cognition.html#cb576-9" tabindex="-1"></a>  mod_seq_multilevel <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb576-10"><a href="bayesian-models-of-cognition.html#cb576-10" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="st">&quot;stan/10_multilevel_sequential_updating.stan&quot;</span>),</span>
<span id="cb576-11"><a href="bayesian-models-of-cognition.html#cb576-11" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb576-12"><a href="bayesian-models-of-cognition.html#cb576-12" tabindex="-1"></a>  )</span>
<span id="cb576-13"><a href="bayesian-models-of-cognition.html#cb576-13" tabindex="-1"></a>  </span>
<span id="cb576-14"><a href="bayesian-models-of-cognition.html#cb576-14" tabindex="-1"></a>  <span class="co"># Fit the single-agent model to one agent&#39;s data</span></span>
<span id="cb576-15"><a href="bayesian-models-of-cognition.html#cb576-15" tabindex="-1"></a>  <span class="co"># For demonstration, we&#39;ll use the first agent</span></span>
<span id="cb576-16"><a href="bayesian-models-of-cognition.html#cb576-16" tabindex="-1"></a>  agent1_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(sequential_sim_data, agent_id <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb576-17"><a href="bayesian-models-of-cognition.html#cb576-17" tabindex="-1"></a>  </span>
<span id="cb576-18"><a href="bayesian-models-of-cognition.html#cb576-18" tabindex="-1"></a>  stan_data_single <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb576-19"><a href="bayesian-models-of-cognition.html#cb576-19" tabindex="-1"></a>    <span class="at">T =</span> <span class="fu">nrow</span>(agent1_data),</span>
<span id="cb576-20"><a href="bayesian-models-of-cognition.html#cb576-20" tabindex="-1"></a>    <span class="at">choice =</span> agent1_data<span class="sc">$</span>choice,</span>
<span id="cb576-21"><a href="bayesian-models-of-cognition.html#cb576-21" tabindex="-1"></a>    <span class="at">blue1 =</span> agent1_data<span class="sc">$</span>blue1,</span>
<span id="cb576-22"><a href="bayesian-models-of-cognition.html#cb576-22" tabindex="-1"></a>    <span class="at">total1 =</span> agent1_data<span class="sc">$</span>total1,</span>
<span id="cb576-23"><a href="bayesian-models-of-cognition.html#cb576-23" tabindex="-1"></a>    <span class="at">blue2 =</span> agent1_data<span class="sc">$</span>blue2,</span>
<span id="cb576-24"><a href="bayesian-models-of-cognition.html#cb576-24" tabindex="-1"></a>    <span class="at">total2 =</span> agent1_data<span class="sc">$</span>total2</span>
<span id="cb576-25"><a href="bayesian-models-of-cognition.html#cb576-25" tabindex="-1"></a>  )</span>
<span id="cb576-26"><a href="bayesian-models-of-cognition.html#cb576-26" tabindex="-1"></a>  </span>
<span id="cb576-27"><a href="bayesian-models-of-cognition.html#cb576-27" tabindex="-1"></a>  fit_seq_single <span class="ot">&lt;-</span> mod_seq_single<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb576-28"><a href="bayesian-models-of-cognition.html#cb576-28" tabindex="-1"></a>    <span class="at">data =</span> stan_data_single,</span>
<span id="cb576-29"><a href="bayesian-models-of-cognition.html#cb576-29" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb576-30"><a href="bayesian-models-of-cognition.html#cb576-30" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb576-31"><a href="bayesian-models-of-cognition.html#cb576-31" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb576-32"><a href="bayesian-models-of-cognition.html#cb576-32" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb576-33"><a href="bayesian-models-of-cognition.html#cb576-33" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb576-34"><a href="bayesian-models-of-cognition.html#cb576-34" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb576-35"><a href="bayesian-models-of-cognition.html#cb576-35" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">200</span>,</span>
<span id="cb576-36"><a href="bayesian-models-of-cognition.html#cb576-36" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.9</span></span>
<span id="cb576-37"><a href="bayesian-models-of-cognition.html#cb576-37" tabindex="-1"></a>  )</span>
<span id="cb576-38"><a href="bayesian-models-of-cognition.html#cb576-38" tabindex="-1"></a>  </span>
<span id="cb576-39"><a href="bayesian-models-of-cognition.html#cb576-39" tabindex="-1"></a>  <span class="co"># Fit the multilevel model to all agents&#39; data</span></span>
<span id="cb576-40"><a href="bayesian-models-of-cognition.html#cb576-40" tabindex="-1"></a>  fit_seq_multilevel <span class="ot">&lt;-</span> mod_seq_multilevel<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb576-41"><a href="bayesian-models-of-cognition.html#cb576-41" tabindex="-1"></a>    <span class="at">data =</span> stan_data_sequential,</span>
<span id="cb576-42"><a href="bayesian-models-of-cognition.html#cb576-42" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">43</span>,</span>
<span id="cb576-43"><a href="bayesian-models-of-cognition.html#cb576-43" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb576-44"><a href="bayesian-models-of-cognition.html#cb576-44" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb576-45"><a href="bayesian-models-of-cognition.html#cb576-45" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb576-46"><a href="bayesian-models-of-cognition.html#cb576-46" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb576-47"><a href="bayesian-models-of-cognition.html#cb576-47" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb576-48"><a href="bayesian-models-of-cognition.html#cb576-48" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">200</span>,</span>
<span id="cb576-49"><a href="bayesian-models-of-cognition.html#cb576-49" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.95</span></span>
<span id="cb576-50"><a href="bayesian-models-of-cognition.html#cb576-50" tabindex="-1"></a>  )</span>
<span id="cb576-51"><a href="bayesian-models-of-cognition.html#cb576-51" tabindex="-1"></a>  </span>
<span id="cb576-52"><a href="bayesian-models-of-cognition.html#cb576-52" tabindex="-1"></a>  <span class="co"># Save model fits</span></span>
<span id="cb576-53"><a href="bayesian-models-of-cognition.html#cb576-53" tabindex="-1"></a>  fit_seq_single<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_sequential_single.rds&quot;</span>)</span>
<span id="cb576-54"><a href="bayesian-models-of-cognition.html#cb576-54" tabindex="-1"></a>  fit_seq_multilevel<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/fit_sequential_multilevel.rds&quot;</span>)</span>
<span id="cb576-55"><a href="bayesian-models-of-cognition.html#cb576-55" tabindex="-1"></a>  </span>
<span id="cb576-56"><a href="bayesian-models-of-cognition.html#cb576-56" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Models fitted and saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb576-57"><a href="bayesian-models-of-cognition.html#cb576-57" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb576-58"><a href="bayesian-models-of-cognition.html#cb576-58" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb576-59"><a href="bayesian-models-of-cognition.html#cb576-59" tabindex="-1"></a>  fit_seq_single <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_sequential_single.rds&quot;</span>)</span>
<span id="cb576-60"><a href="bayesian-models-of-cognition.html#cb576-60" tabindex="-1"></a>  fit_seq_multilevel <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/fit_sequential_multilevel.rds&quot;</span>)</span>
<span id="cb576-61"><a href="bayesian-models-of-cognition.html#cb576-61" tabindex="-1"></a>  </span>
<span id="cb576-62"><a href="bayesian-models-of-cognition.html#cb576-62" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb576-63"><a href="bayesian-models-of-cognition.html#cb576-63" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing model fits.</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="bayesian-models-of-cognition.html#cb578-1" tabindex="-1"></a><span class="co"># Check for convergence issues</span></span>
<span id="cb578-2"><a href="bayesian-models-of-cognition.html#cb578-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Checking convergence for single-agent model:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Checking convergence for single-agent model:</code></pre>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="bayesian-models-of-cognition.html#cb580-1" tabindex="-1"></a><span class="fu">print</span>(fit_seq_single<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;total_weight&quot;</span>, <span class="st">&quot;weight_prop&quot;</span>, <span class="st">&quot;alpha&quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 10
##   variable      mean median    sd   mad     q5   q95  rhat ess_bulk ess_tail
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 total_weight 1.03   0.895 0.576 0.428 0.415  2.12   1.00    1650.    1273.
## 2 weight_prop  0.500  0.498 0.285 0.369 0.0646 0.950  1.00    1986.    1225.
## 3 alpha        0.369  0.325 0.193 0.166 0.144  0.751  1.00    1802.    1400.</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="bayesian-models-of-cognition.html#cb582-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Checking convergence for multilevel model (population parameters):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Checking convergence for multilevel model (population parameters):</code></pre>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="bayesian-models-of-cognition.html#cb584-1" tabindex="-1"></a><span class="fu">print</span>(fit_seq_multilevel<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;pop_total_weight&quot;</span>, <span class="st">&quot;pop_weight_prop&quot;</span>, <span class="st">&quot;pop_alpha&quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 10
##   variable          mean median    sd   mad    q5   q95  rhat ess_bulk ess_tail
##   &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 pop_total_weight 1.89   1.31  2.49  1.01  0.342 5.10  1.00     2640.    1624.
## 2 pop_weight_prop  0.660  0.672 0.150 0.164 0.391 0.884 0.999    3008.    1583.
## 3 pop_alpha        0.626  0.456 0.601 0.354 0.124 1.73  0.999    2611.    1643.</code></pre>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="bayesian-models-of-cognition.html#cb586-1" tabindex="-1"></a><span class="co"># Extract posterior samples</span></span>
<span id="cb586-2"><a href="bayesian-models-of-cognition.html#cb586-2" tabindex="-1"></a>draws_seq_single <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_seq_single<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb586-3"><a href="bayesian-models-of-cognition.html#cb586-3" tabindex="-1"></a>draws_seq_multilevel <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_seq_multilevel<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb586-4"><a href="bayesian-models-of-cognition.html#cb586-4" tabindex="-1"></a></span>
<span id="cb586-5"><a href="bayesian-models-of-cognition.html#cb586-5" tabindex="-1"></a><span class="co"># Examine parameter recovery for the single agent</span></span>
<span id="cb586-6"><a href="bayesian-models-of-cognition.html#cb586-6" tabindex="-1"></a>agent1_params <span class="ot">&lt;-</span> agent_params <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_id <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb586-7"><a href="bayesian-models-of-cognition.html#cb586-7" tabindex="-1"></a>agent1_recovery <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb586-8"><a href="bayesian-models-of-cognition.html#cb586-8" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">&quot;weight_direct&quot;</span>, <span class="st">&quot;weight_social&quot;</span>, <span class="st">&quot;learning_rate&quot;</span>),</span>
<span id="cb586-9"><a href="bayesian-models-of-cognition.html#cb586-9" tabindex="-1"></a>  <span class="at">true_value =</span> <span class="fu">c</span>(</span>
<span id="cb586-10"><a href="bayesian-models-of-cognition.html#cb586-10" tabindex="-1"></a>    agent1_params<span class="sc">$</span>weight_direct, </span>
<span id="cb586-11"><a href="bayesian-models-of-cognition.html#cb586-11" tabindex="-1"></a>    agent1_params<span class="sc">$</span>weight_social, </span>
<span id="cb586-12"><a href="bayesian-models-of-cognition.html#cb586-12" tabindex="-1"></a>    agent1_params<span class="sc">$</span>learning_rate</span>
<span id="cb586-13"><a href="bayesian-models-of-cognition.html#cb586-13" tabindex="-1"></a>  ),</span>
<span id="cb586-14"><a href="bayesian-models-of-cognition.html#cb586-14" tabindex="-1"></a>  <span class="at">estimated =</span> <span class="fu">c</span>(</span>
<span id="cb586-15"><a href="bayesian-models-of-cognition.html#cb586-15" tabindex="-1"></a>    <span class="fu">mean</span>(draws_seq_single<span class="sc">$</span>weight_direct),</span>
<span id="cb586-16"><a href="bayesian-models-of-cognition.html#cb586-16" tabindex="-1"></a>    <span class="fu">mean</span>(draws_seq_single<span class="sc">$</span>weight_social),</span>
<span id="cb586-17"><a href="bayesian-models-of-cognition.html#cb586-17" tabindex="-1"></a>    <span class="fu">mean</span>(draws_seq_single<span class="sc">$</span>alpha)</span>
<span id="cb586-18"><a href="bayesian-models-of-cognition.html#cb586-18" tabindex="-1"></a>  ),</span>
<span id="cb586-19"><a href="bayesian-models-of-cognition.html#cb586-19" tabindex="-1"></a>  <span class="at">error =</span> estimated <span class="sc">-</span> true_value,</span>
<span id="cb586-20"><a href="bayesian-models-of-cognition.html#cb586-20" tabindex="-1"></a>  <span class="at">pct_error =</span> <span class="dv">100</span> <span class="sc">*</span> error <span class="sc">/</span> true_value</span>
<span id="cb586-21"><a href="bayesian-models-of-cognition.html#cb586-21" tabindex="-1"></a>)</span>
<span id="cb586-22"><a href="bayesian-models-of-cognition.html#cb586-22" tabindex="-1"></a></span>
<span id="cb586-23"><a href="bayesian-models-of-cognition.html#cb586-23" tabindex="-1"></a><span class="co"># Print recovery results</span></span>
<span id="cb586-24"><a href="bayesian-models-of-cognition.html#cb586-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Parameter recovery for Agent 1:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Parameter recovery for Agent 1:</code></pre>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="bayesian-models-of-cognition.html#cb588-1" tabindex="-1"></a><span class="fu">print</span>(agent1_recovery)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   parameter     true_value estimated   error pct_error
##   &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 weight_direct      1.51      0.522 -0.987     -65.4 
## 2 weight_social      0.747     0.506 -0.241     -32.3 
## 3 learning_rate      0.408     0.369 -0.0387     -9.49</code></pre>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="bayesian-models-of-cognition.html#cb590-1" tabindex="-1"></a><span class="co"># Evaluate population-level recovery</span></span>
<span id="cb590-2"><a href="bayesian-models-of-cognition.html#cb590-2" tabindex="-1"></a>pop_recovery <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb590-3"><a href="bayesian-models-of-cognition.html#cb590-3" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">&quot;mean_weight_direct&quot;</span>, <span class="st">&quot;mean_weight_social&quot;</span>, <span class="st">&quot;mean_learning_rate&quot;</span>),</span>
<span id="cb590-4"><a href="bayesian-models-of-cognition.html#cb590-4" tabindex="-1"></a>  <span class="at">true_value =</span> <span class="fu">c</span>(</span>
<span id="cb590-5"><a href="bayesian-models-of-cognition.html#cb590-5" tabindex="-1"></a>    <span class="fu">mean</span>(agent_params<span class="sc">$</span>weight_direct),</span>
<span id="cb590-6"><a href="bayesian-models-of-cognition.html#cb590-6" tabindex="-1"></a>    <span class="fu">mean</span>(agent_params<span class="sc">$</span>weight_social),</span>
<span id="cb590-7"><a href="bayesian-models-of-cognition.html#cb590-7" tabindex="-1"></a>    <span class="fu">mean</span>(agent_params<span class="sc">$</span>learning_rate)</span>
<span id="cb590-8"><a href="bayesian-models-of-cognition.html#cb590-8" tabindex="-1"></a>  ),</span>
<span id="cb590-9"><a href="bayesian-models-of-cognition.html#cb590-9" tabindex="-1"></a>  <span class="at">estimated =</span> <span class="fu">c</span>(</span>
<span id="cb590-10"><a href="bayesian-models-of-cognition.html#cb590-10" tabindex="-1"></a>    <span class="fu">mean</span>(draws_seq_multilevel<span class="sc">$</span>pop_weight_direct),</span>
<span id="cb590-11"><a href="bayesian-models-of-cognition.html#cb590-11" tabindex="-1"></a>    <span class="fu">mean</span>(draws_seq_multilevel<span class="sc">$</span>pop_weight_social),</span>
<span id="cb590-12"><a href="bayesian-models-of-cognition.html#cb590-12" tabindex="-1"></a>    <span class="fu">mean</span>(draws_seq_multilevel<span class="sc">$</span>pop_alpha)</span>
<span id="cb590-13"><a href="bayesian-models-of-cognition.html#cb590-13" tabindex="-1"></a>  ),</span>
<span id="cb590-14"><a href="bayesian-models-of-cognition.html#cb590-14" tabindex="-1"></a>  <span class="at">error =</span> estimated <span class="sc">-</span> true_value,</span>
<span id="cb590-15"><a href="bayesian-models-of-cognition.html#cb590-15" tabindex="-1"></a>  <span class="at">pct_error =</span> <span class="dv">100</span> <span class="sc">*</span> error <span class="sc">/</span> true_value</span>
<span id="cb590-16"><a href="bayesian-models-of-cognition.html#cb590-16" tabindex="-1"></a>)</span>
<span id="cb590-17"><a href="bayesian-models-of-cognition.html#cb590-17" tabindex="-1"></a></span>
<span id="cb590-18"><a href="bayesian-models-of-cognition.html#cb590-18" tabindex="-1"></a><span class="co"># Print population recovery results</span></span>
<span id="cb590-19"><a href="bayesian-models-of-cognition.html#cb590-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Population parameter recovery:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Population parameter recovery:</code></pre>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="bayesian-models-of-cognition.html#cb592-1" tabindex="-1"></a><span class="fu">print</span>(pop_recovery)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   parameter          true_value estimated   error pct_error
##   &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 mean_weight_direct      1.13      1.23   0.0945      8.33
## 2 mean_weight_social      0.795     0.657 -0.138     -17.3 
## 3 mean_learning_rate      0.409     0.626  0.218      53.3</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="bayesian-models-of-cognition.html#cb594-1" tabindex="-1"></a><span class="co"># Extract individual parameter estimates</span></span>
<span id="cb594-2"><a href="bayesian-models-of-cognition.html#cb594-2" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(draws_seq_multilevel<span class="sc">$</span>.chain))</span>
<span id="cb594-3"><a href="bayesian-models-of-cognition.html#cb594-3" tabindex="-1"></a>n_iterations <span class="ot">&lt;-</span> <span class="fu">nrow</span>(draws_seq_multilevel) <span class="sc">/</span> n_chains</span>
<span id="cb594-4"><a href="bayesian-models-of-cognition.html#cb594-4" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> n_chains <span class="sc">*</span> n_iterations</span>
<span id="cb594-5"><a href="bayesian-models-of-cognition.html#cb594-5" tabindex="-1"></a></span>
<span id="cb594-6"><a href="bayesian-models-of-cognition.html#cb594-6" tabindex="-1"></a>weight_direct_samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_samples, <span class="at">ncol =</span> n_agents)</span>
<span id="cb594-7"><a href="bayesian-models-of-cognition.html#cb594-7" tabindex="-1"></a>weight_social_samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_samples, <span class="at">ncol =</span> n_agents)</span>
<span id="cb594-8"><a href="bayesian-models-of-cognition.html#cb594-8" tabindex="-1"></a>alpha_samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_samples, <span class="at">ncol =</span> n_agents)</span>
<span id="cb594-9"><a href="bayesian-models-of-cognition.html#cb594-9" tabindex="-1"></a></span>
<span id="cb594-10"><a href="bayesian-models-of-cognition.html#cb594-10" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_agents) {</span>
<span id="cb594-11"><a href="bayesian-models-of-cognition.html#cb594-11" tabindex="-1"></a>  weight_direct_samples[, j] <span class="ot">&lt;-</span> draws_seq_multilevel[[<span class="fu">paste0</span>(<span class="st">&quot;weight_direct[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb594-12"><a href="bayesian-models-of-cognition.html#cb594-12" tabindex="-1"></a>  weight_social_samples[, j] <span class="ot">&lt;-</span> draws_seq_multilevel[[<span class="fu">paste0</span>(<span class="st">&quot;weight_social[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb594-13"><a href="bayesian-models-of-cognition.html#cb594-13" tabindex="-1"></a>  alpha_samples[, j] <span class="ot">&lt;-</span> draws_seq_multilevel[[<span class="fu">paste0</span>(<span class="st">&quot;alpha[&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb594-14"><a href="bayesian-models-of-cognition.html#cb594-14" tabindex="-1"></a>}</span>
<span id="cb594-15"><a href="bayesian-models-of-cognition.html#cb594-15" tabindex="-1"></a></span>
<span id="cb594-16"><a href="bayesian-models-of-cognition.html#cb594-16" tabindex="-1"></a><span class="co"># Calculate posterior means</span></span>
<span id="cb594-17"><a href="bayesian-models-of-cognition.html#cb594-17" tabindex="-1"></a>weight_direct_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_direct_samples)</span>
<span id="cb594-18"><a href="bayesian-models-of-cognition.html#cb594-18" tabindex="-1"></a>weight_social_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(weight_social_samples)</span>
<span id="cb594-19"><a href="bayesian-models-of-cognition.html#cb594-19" tabindex="-1"></a>alpha_est <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(alpha_samples)</span>
<span id="cb594-20"><a href="bayesian-models-of-cognition.html#cb594-20" tabindex="-1"></a></span>
<span id="cb594-21"><a href="bayesian-models-of-cognition.html#cb594-21" tabindex="-1"></a><span class="co"># Create recovery data for all agents</span></span>
<span id="cb594-22"><a href="bayesian-models-of-cognition.html#cb594-22" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb594-23"><a href="bayesian-models-of-cognition.html#cb594-23" tabindex="-1"></a>  <span class="at">agent_id =</span> <span class="dv">1</span><span class="sc">:</span>n_agents,</span>
<span id="cb594-24"><a href="bayesian-models-of-cognition.html#cb594-24" tabindex="-1"></a>  <span class="co"># True parameters</span></span>
<span id="cb594-25"><a href="bayesian-models-of-cognition.html#cb594-25" tabindex="-1"></a>  <span class="at">true_weight_direct =</span> agent_params<span class="sc">$</span>weight_direct,</span>
<span id="cb594-26"><a href="bayesian-models-of-cognition.html#cb594-26" tabindex="-1"></a>  <span class="at">true_weight_social =</span> agent_params<span class="sc">$</span>weight_social,</span>
<span id="cb594-27"><a href="bayesian-models-of-cognition.html#cb594-27" tabindex="-1"></a>  <span class="at">true_learning_rate =</span> agent_params<span class="sc">$</span>learning_rate,</span>
<span id="cb594-28"><a href="bayesian-models-of-cognition.html#cb594-28" tabindex="-1"></a>  <span class="co"># Estimated parameters</span></span>
<span id="cb594-29"><a href="bayesian-models-of-cognition.html#cb594-29" tabindex="-1"></a>  <span class="at">est_weight_direct =</span> weight_direct_est,</span>
<span id="cb594-30"><a href="bayesian-models-of-cognition.html#cb594-30" tabindex="-1"></a>  <span class="at">est_weight_social =</span> weight_social_est,</span>
<span id="cb594-31"><a href="bayesian-models-of-cognition.html#cb594-31" tabindex="-1"></a>  <span class="at">est_learning_rate =</span> alpha_est</span>
<span id="cb594-32"><a href="bayesian-models-of-cognition.html#cb594-32" tabindex="-1"></a>)</span>
<span id="cb594-33"><a href="bayesian-models-of-cognition.html#cb594-33" tabindex="-1"></a></span>
<span id="cb594-34"><a href="bayesian-models-of-cognition.html#cb594-34" tabindex="-1"></a><span class="co"># Calculate recovery metrics</span></span>
<span id="cb594-35"><a href="bayesian-models-of-cognition.html#cb594-35" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb594-36"><a href="bayesian-models-of-cognition.html#cb594-36" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb594-37"><a href="bayesian-models-of-cognition.html#cb594-37" tabindex="-1"></a>    <span class="at">error_direct =</span> est_weight_direct <span class="sc">-</span> true_weight_direct,</span>
<span id="cb594-38"><a href="bayesian-models-of-cognition.html#cb594-38" tabindex="-1"></a>    <span class="at">error_social =</span> est_weight_social <span class="sc">-</span> true_weight_social,</span>
<span id="cb594-39"><a href="bayesian-models-of-cognition.html#cb594-39" tabindex="-1"></a>    <span class="at">error_learning =</span> est_learning_rate <span class="sc">-</span> true_learning_rate,</span>
<span id="cb594-40"><a href="bayesian-models-of-cognition.html#cb594-40" tabindex="-1"></a>    </span>
<span id="cb594-41"><a href="bayesian-models-of-cognition.html#cb594-41" tabindex="-1"></a>    <span class="at">pct_error_direct =</span> <span class="dv">100</span> <span class="sc">*</span> error_direct <span class="sc">/</span> true_weight_direct,</span>
<span id="cb594-42"><a href="bayesian-models-of-cognition.html#cb594-42" tabindex="-1"></a>    <span class="at">pct_error_social =</span> <span class="dv">100</span> <span class="sc">*</span> error_social <span class="sc">/</span> true_weight_social,</span>
<span id="cb594-43"><a href="bayesian-models-of-cognition.html#cb594-43" tabindex="-1"></a>    <span class="at">pct_error_learning =</span> <span class="dv">100</span> <span class="sc">*</span> error_learning <span class="sc">/</span> true_learning_rate</span>
<span id="cb594-44"><a href="bayesian-models-of-cognition.html#cb594-44" tabindex="-1"></a>  )</span>
<span id="cb594-45"><a href="bayesian-models-of-cognition.html#cb594-45" tabindex="-1"></a></span>
<span id="cb594-46"><a href="bayesian-models-of-cognition.html#cb594-46" tabindex="-1"></a><span class="co"># Create recovery plots</span></span>
<span id="cb594-47"><a href="bayesian-models-of-cognition.html#cb594-47" tabindex="-1"></a>p_recovery <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb594-48"><a href="bayesian-models-of-cognition.html#cb594-48" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb594-49"><a href="bayesian-models-of-cognition.html#cb594-49" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="fu">starts_with</span>(<span class="st">&quot;true_&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;est_&quot;</span>)),</span>
<span id="cb594-50"><a href="bayesian-models-of-cognition.html#cb594-50" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;parameter&quot;</span>),</span>
<span id="cb594-51"><a href="bayesian-models-of-cognition.html#cb594-51" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">&quot;(true|est)_(.*)&quot;</span></span>
<span id="cb594-52"><a href="bayesian-models-of-cognition.html#cb594-52" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb594-53"><a href="bayesian-models-of-cognition.html#cb594-53" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb594-54"><a href="bayesian-models-of-cognition.html#cb594-54" tabindex="-1"></a>    <span class="at">names_from =</span> type,</span>
<span id="cb594-55"><a href="bayesian-models-of-cognition.html#cb594-55" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb594-56"><a href="bayesian-models-of-cognition.html#cb594-56" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb594-57"><a href="bayesian-models-of-cognition.html#cb594-57" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb594-58"><a href="bayesian-models-of-cognition.html#cb594-58" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">factor</span>(</span>
<span id="cb594-59"><a href="bayesian-models-of-cognition.html#cb594-59" tabindex="-1"></a>      parameter,</span>
<span id="cb594-60"><a href="bayesian-models-of-cognition.html#cb594-60" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;weight_direct&quot;</span>, <span class="st">&quot;weight_social&quot;</span>, <span class="st">&quot;learning_rate&quot;</span>),</span>
<span id="cb594-61"><a href="bayesian-models-of-cognition.html#cb594-61" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Direct Evidence Weight&quot;</span>, <span class="st">&quot;Social Evidence Weight&quot;</span>, <span class="st">&quot;Learning Rate&quot;</span>)</span>
<span id="cb594-62"><a href="bayesian-models-of-cognition.html#cb594-62" tabindex="-1"></a>    )</span>
<span id="cb594-63"><a href="bayesian-models-of-cognition.html#cb594-63" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb594-64"><a href="bayesian-models-of-cognition.html#cb594-64" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> true, <span class="at">y =</span> est)) <span class="sc">+</span></span>
<span id="cb594-65"><a href="bayesian-models-of-cognition.html#cb594-65" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb594-66"><a href="bayesian-models-of-cognition.html#cb594-66" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb594-67"><a href="bayesian-models-of-cognition.html#cb594-67" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb594-68"><a href="bayesian-models-of-cognition.html#cb594-68" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb594-69"><a href="bayesian-models-of-cognition.html#cb594-69" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Parameter Recovery for Sequential Updating Model&quot;</span>,</span>
<span id="cb594-70"><a href="bayesian-models-of-cognition.html#cb594-70" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Comparing true parameter values to posterior means&quot;</span>,</span>
<span id="cb594-71"><a href="bayesian-models-of-cognition.html#cb594-71" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Parameter Value&quot;</span>,</span>
<span id="cb594-72"><a href="bayesian-models-of-cognition.html#cb594-72" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Parameter Value&quot;</span></span>
<span id="cb594-73"><a href="bayesian-models-of-cognition.html#cb594-73" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb594-74"><a href="bayesian-models-of-cognition.html#cb594-74" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb594-75"><a href="bayesian-models-of-cognition.html#cb594-75" tabindex="-1"></a></span>
<span id="cb594-76"><a href="bayesian-models-of-cognition.html#cb594-76" tabindex="-1"></a><span class="co"># Display recovery plot</span></span>
<span id="cb594-77"><a href="bayesian-models-of-cognition.html#cb594-77" tabindex="-1"></a><span class="fu">print</span>(p_recovery)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-67-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="bayesian-models-of-cognition.html#cb595-1" tabindex="-1"></a><span class="co"># Examine posterior predictive checks</span></span>
<span id="cb595-2"><a href="bayesian-models-of-cognition.html#cb595-2" tabindex="-1"></a><span class="co"># Extract belief trajectories</span></span>
<span id="cb595-3"><a href="bayesian-models-of-cognition.html#cb595-3" tabindex="-1"></a>belief_samples <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(n_samples, n_agents, n_trials))</span>
<span id="cb595-4"><a href="bayesian-models-of-cognition.html#cb595-4" tabindex="-1"></a></span>
<span id="cb595-5"><a href="bayesian-models-of-cognition.html#cb595-5" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_agents) {</span>
<span id="cb595-6"><a href="bayesian-models-of-cognition.html#cb595-6" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb595-7"><a href="bayesian-models-of-cognition.html#cb595-7" tabindex="-1"></a>    belief_samples[, j, t] <span class="ot">&lt;-</span> draws_seq_multilevel[[<span class="fu">paste0</span>(<span class="st">&quot;belief[&quot;</span>, j, <span class="st">&quot;,&quot;</span>, t, <span class="st">&quot;]&quot;</span>)]]</span>
<span id="cb595-8"><a href="bayesian-models-of-cognition.html#cb595-8" tabindex="-1"></a>  }</span>
<span id="cb595-9"><a href="bayesian-models-of-cognition.html#cb595-9" tabindex="-1"></a>}</span>
<span id="cb595-10"><a href="bayesian-models-of-cognition.html#cb595-10" tabindex="-1"></a></span>
<span id="cb595-11"><a href="bayesian-models-of-cognition.html#cb595-11" tabindex="-1"></a><span class="co"># Calculate mean and credible intervals for beliefs</span></span>
<span id="cb595-12"><a href="bayesian-models-of-cognition.html#cb595-12" tabindex="-1"></a>belief_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb595-13"><a href="bayesian-models-of-cognition.html#cb595-13" tabindex="-1"></a>  <span class="at">agent_id =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_agents, <span class="at">each =</span> n_trials), <span class="dv">3</span>),</span>
<span id="cb595-14"><a href="bayesian-models-of-cognition.html#cb595-14" tabindex="-1"></a>  <span class="at">trial =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_trials, n_agents), <span class="dv">3</span>),</span>
<span id="cb595-15"><a href="bayesian-models-of-cognition.html#cb595-15" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>), <span class="at">each =</span> n_agents <span class="sc">*</span> n_trials),</span>
<span id="cb595-16"><a href="bayesian-models-of-cognition.html#cb595-16" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(</span>
<span id="cb595-17"><a href="bayesian-models-of-cognition.html#cb595-17" tabindex="-1"></a>    <span class="co"># Mean belief across samples</span></span>
<span id="cb595-18"><a href="bayesian-models-of-cognition.html#cb595-18" tabindex="-1"></a>    <span class="fu">apply</span>(belief_samples, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), mean) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>(),</span>
<span id="cb595-19"><a href="bayesian-models-of-cognition.html#cb595-19" tabindex="-1"></a>    <span class="co"># Lower 95% CI</span></span>
<span id="cb595-20"><a href="bayesian-models-of-cognition.html#cb595-20" tabindex="-1"></a>    <span class="fu">apply</span>(belief_samples, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), quantile, <span class="fl">0.025</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>(),</span>
<span id="cb595-21"><a href="bayesian-models-of-cognition.html#cb595-21" tabindex="-1"></a>    <span class="co"># Upper 95% CI</span></span>
<span id="cb595-22"><a href="bayesian-models-of-cognition.html#cb595-22" tabindex="-1"></a>    <span class="fu">apply</span>(belief_samples, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), quantile, <span class="fl">0.975</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb595-23"><a href="bayesian-models-of-cognition.html#cb595-23" tabindex="-1"></a>  )</span>
<span id="cb595-24"><a href="bayesian-models-of-cognition.html#cb595-24" tabindex="-1"></a>)</span>
<span id="cb595-25"><a href="bayesian-models-of-cognition.html#cb595-25" tabindex="-1"></a></span>
<span id="cb595-26"><a href="bayesian-models-of-cognition.html#cb595-26" tabindex="-1"></a><span class="co"># Reshape for plotting</span></span>
<span id="cb595-27"><a href="bayesian-models-of-cognition.html#cb595-27" tabindex="-1"></a>belief_wider <span class="ot">&lt;-</span> belief_summary <span class="sc">%&gt;%</span></span>
<span id="cb595-28"><a href="bayesian-models-of-cognition.html#cb595-28" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb595-29"><a href="bayesian-models-of-cognition.html#cb595-29" tabindex="-1"></a>    <span class="at">names_from =</span> statistic,</span>
<span id="cb595-30"><a href="bayesian-models-of-cognition.html#cb595-30" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb595-31"><a href="bayesian-models-of-cognition.html#cb595-31" tabindex="-1"></a>  )</span>
<span id="cb595-32"><a href="bayesian-models-of-cognition.html#cb595-32" tabindex="-1"></a></span>
<span id="cb595-33"><a href="bayesian-models-of-cognition.html#cb595-33" tabindex="-1"></a><span class="co"># Visualize belief trajectories for selected agents</span></span>
<span id="cb595-34"><a href="bayesian-models-of-cognition.html#cb595-34" tabindex="-1"></a>p_belief_trajectories <span class="ot">&lt;-</span> belief_wider <span class="sc">%&gt;%</span></span>
<span id="cb595-35"><a href="bayesian-models-of-cognition.html#cb595-35" tabindex="-1"></a>  <span class="fu">filter</span>(agent_id <span class="sc">%in%</span> selected_agents) <span class="sc">%&gt;%</span></span>
<span id="cb595-36"><a href="bayesian-models-of-cognition.html#cb595-36" tabindex="-1"></a>  <span class="fu">left_join</span>(sequential_sim_data <span class="sc">%&gt;%</span> </span>
<span id="cb595-37"><a href="bayesian-models-of-cognition.html#cb595-37" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(agent_id, trial, true_p_blue, jar_state), </span>
<span id="cb595-38"><a href="bayesian-models-of-cognition.html#cb595-38" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;agent_id&quot;</span>, <span class="st">&quot;trial&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb595-39"><a href="bayesian-models-of-cognition.html#cb595-39" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb595-40"><a href="bayesian-models-of-cognition.html#cb595-40" tabindex="-1"></a>  <span class="co"># Add true jar state as background</span></span>
<span id="cb595-41"><a href="bayesian-models-of-cognition.html#cb595-41" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> trial <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">xmax =</span> trial <span class="sc">+</span> <span class="fl">0.5</span>, </span>
<span id="cb595-42"><a href="bayesian-models-of-cognition.html#cb595-42" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, </span>
<span id="cb595-43"><a href="bayesian-models-of-cognition.html#cb595-43" tabindex="-1"></a>                <span class="at">fill =</span> <span class="fu">factor</span>(jar_state)), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb595-44"><a href="bayesian-models-of-cognition.html#cb595-44" tabindex="-1"></a>  <span class="co"># Add posterior belief intervals</span></span>
<span id="cb595-45"><a href="bayesian-models-of-cognition.html#cb595-45" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, <span class="at">group =</span> agent_id), </span>
<span id="cb595-46"><a href="bayesian-models-of-cognition.html#cb595-46" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb595-47"><a href="bayesian-models-of-cognition.html#cb595-47" tabindex="-1"></a>  <span class="co"># Add mean posterior belief</span></span>
<span id="cb595-48"><a href="bayesian-models-of-cognition.html#cb595-48" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> mean, <span class="at">color =</span> <span class="fu">factor</span>(agent_id)), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb595-49"><a href="bayesian-models-of-cognition.html#cb595-49" tabindex="-1"></a>  <span class="co"># Add true belief from simulation</span></span>
<span id="cb595-50"><a href="bayesian-models-of-cognition.html#cb595-50" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> sequential_sim_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_id <span class="sc">%in%</span> selected_agents),</span>
<span id="cb595-51"><a href="bayesian-models-of-cognition.html#cb595-51" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> belief, <span class="at">group =</span> agent_id), </span>
<span id="cb595-52"><a href="bayesian-models-of-cognition.html#cb595-52" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb595-53"><a href="bayesian-models-of-cognition.html#cb595-53" tabindex="-1"></a>  <span class="co"># Add true choices</span></span>
<span id="cb595-54"><a href="bayesian-models-of-cognition.html#cb595-54" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> sequential_sim_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(agent_id <span class="sc">%in%</span> selected_agents),</span>
<span id="cb595-55"><a href="bayesian-models-of-cognition.html#cb595-55" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> choice, <span class="at">shape =</span> <span class="st">&quot;Actual Choice&quot;</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb595-56"><a href="bayesian-models-of-cognition.html#cb595-56" tabindex="-1"></a>  <span class="co"># Styling</span></span>
<span id="cb595-57"><a href="bayesian-models-of-cognition.html#cb595-57" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_id, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb595-58"><a href="bayesian-models-of-cognition.html#cb595-58" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;pink&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightblue&quot;</span>), </span>
<span id="cb595-59"><a href="bayesian-models-of-cognition.html#cb595-59" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Mostly Red Jar&quot;</span>, <span class="st">&quot;Mostly Blue Jar&quot;</span>),</span>
<span id="cb595-60"><a href="bayesian-models-of-cognition.html#cb595-60" tabindex="-1"></a>                  <span class="at">name =</span> <span class="st">&quot;True Jar State&quot;</span>) <span class="sc">+</span></span>
<span id="cb595-61"><a href="bayesian-models-of-cognition.html#cb595-61" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Agent ID&quot;</span>) <span class="sc">+</span></span>
<span id="cb595-62"><a href="bayesian-models-of-cognition.html#cb595-62" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Actual Choice&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb595-63"><a href="bayesian-models-of-cognition.html#cb595-63" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb595-64"><a href="bayesian-models-of-cognition.html#cb595-64" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb595-65"><a href="bayesian-models-of-cognition.html#cb595-65" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Belief Updating Over Time&quot;</span>,</span>
<span id="cb595-66"><a href="bayesian-models-of-cognition.html#cb595-66" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Blue ribbons show 95% credible intervals of estimated beliefs</span><span class="sc">\n</span><span class="st">Dashed lines show true simulated beliefs&quot;</span>,</span>
<span id="cb595-67"><a href="bayesian-models-of-cognition.html#cb595-67" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb595-68"><a href="bayesian-models-of-cognition.html#cb595-68" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Belief/Choice Probability&quot;</span>,</span>
<span id="cb595-69"><a href="bayesian-models-of-cognition.html#cb595-69" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb595-70"><a href="bayesian-models-of-cognition.html#cb595-70" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb595-71"><a href="bayesian-models-of-cognition.html#cb595-71" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb595-72"><a href="bayesian-models-of-cognition.html#cb595-72" tabindex="-1"></a></span>
<span id="cb595-73"><a href="bayesian-models-of-cognition.html#cb595-73" tabindex="-1"></a><span class="co"># Display belief trajectories</span></span>
<span id="cb595-74"><a href="bayesian-models-of-cognition.html#cb595-74" tabindex="-1"></a><span class="fu">print</span>(p_belief_trajectories)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-67-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="bayesian-models-of-cognition.html#cb596-1" tabindex="-1"></a><span class="co"># Compare learning styles across agents</span></span>
<span id="cb596-2"><a href="bayesian-models-of-cognition.html#cb596-2" tabindex="-1"></a>learning_styles <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb596-3"><a href="bayesian-models-of-cognition.html#cb596-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb596-4"><a href="bayesian-models-of-cognition.html#cb596-4" tabindex="-1"></a>    <span class="at">relative_weight =</span> est_weight_direct <span class="sc">/</span> est_weight_social,</span>
<span id="cb596-5"><a href="bayesian-models-of-cognition.html#cb596-5" tabindex="-1"></a>    <span class="at">learning_speed =</span> est_learning_rate</span>
<span id="cb596-6"><a href="bayesian-models-of-cognition.html#cb596-6" tabindex="-1"></a>  )</span>
<span id="cb596-7"><a href="bayesian-models-of-cognition.html#cb596-7" tabindex="-1"></a></span>
<span id="cb596-8"><a href="bayesian-models-of-cognition.html#cb596-8" tabindex="-1"></a>p_learning_styles <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(learning_styles, <span class="fu">aes</span>(<span class="at">x =</span> relative_weight, <span class="at">y =</span> learning_speed)) <span class="sc">+</span></span>
<span id="cb596-9"><a href="bayesian-models-of-cognition.html#cb596-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb596-10"><a href="bayesian-models-of-cognition.html#cb596-10" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> agent_id), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">vjust =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb596-11"><a href="bayesian-models-of-cognition.html#cb596-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb596-12"><a href="bayesian-models-of-cognition.html#cb596-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Individual Learning Styles&quot;</span>,</span>
<span id="cb596-13"><a href="bayesian-models-of-cognition.html#cb596-13" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Mapping agents by their evidence weighting and learning speed&quot;</span>,</span>
<span id="cb596-14"><a href="bayesian-models-of-cognition.html#cb596-14" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Relative Weight (Direct/Social)&quot;</span>,</span>
<span id="cb596-15"><a href="bayesian-models-of-cognition.html#cb596-15" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Learning Rate&quot;</span></span>
<span id="cb596-16"><a href="bayesian-models-of-cognition.html#cb596-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb596-17"><a href="bayesian-models-of-cognition.html#cb596-17" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb596-18"><a href="bayesian-models-of-cognition.html#cb596-18" tabindex="-1"></a></span>
<span id="cb596-19"><a href="bayesian-models-of-cognition.html#cb596-19" tabindex="-1"></a><span class="fu">print</span>(p_learning_styles)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-67-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="bayesian-models-of-cognition.html#cb597-1" tabindex="-1"></a><span class="co"># Calculate correlations between estimated parameters</span></span>
<span id="cb597-2"><a href="bayesian-models-of-cognition.html#cb597-2" tabindex="-1"></a>param_correlations <span class="ot">&lt;-</span> <span class="fu">cor</span>(</span>
<span id="cb597-3"><a href="bayesian-models-of-cognition.html#cb597-3" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb597-4"><a href="bayesian-models-of-cognition.html#cb597-4" tabindex="-1"></a>    learning_styles<span class="sc">$</span>est_weight_direct,</span>
<span id="cb597-5"><a href="bayesian-models-of-cognition.html#cb597-5" tabindex="-1"></a>    learning_styles<span class="sc">$</span>est_weight_social,</span>
<span id="cb597-6"><a href="bayesian-models-of-cognition.html#cb597-6" tabindex="-1"></a>    learning_styles<span class="sc">$</span>est_learning_rate</span>
<span id="cb597-7"><a href="bayesian-models-of-cognition.html#cb597-7" tabindex="-1"></a>  )</span>
<span id="cb597-8"><a href="bayesian-models-of-cognition.html#cb597-8" tabindex="-1"></a>)</span>
<span id="cb597-9"><a href="bayesian-models-of-cognition.html#cb597-9" tabindex="-1"></a></span>
<span id="cb597-10"><a href="bayesian-models-of-cognition.html#cb597-10" tabindex="-1"></a><span class="fu">colnames</span>(param_correlations) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(param_correlations) <span class="ot">&lt;-</span> </span>
<span id="cb597-11"><a href="bayesian-models-of-cognition.html#cb597-11" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Weight (Direct)&quot;</span>, <span class="st">&quot;Weight (Social)&quot;</span>, <span class="st">&quot;Learning Rate&quot;</span>)</span>
<span id="cb597-12"><a href="bayesian-models-of-cognition.html#cb597-12" tabindex="-1"></a></span>
<span id="cb597-13"><a href="bayesian-models-of-cognition.html#cb597-13" tabindex="-1"></a><span class="co"># Extract population-level parameter correlations from the model</span></span>
<span id="cb597-14"><a href="bayesian-models-of-cognition.html#cb597-14" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb597-15"><a href="bayesian-models-of-cognition.html#cb597-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb597-16"><a href="bayesian-models-of-cognition.html#cb597-16" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb597-17"><a href="bayesian-models-of-cognition.html#cb597-17" tabindex="-1"></a>    correlation_matrix[i, j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_seq_multilevel[[<span class="fu">paste0</span>(<span class="st">&quot;Omega[&quot;</span>, i, <span class="st">&quot;,&quot;</span>, j, <span class="st">&quot;]&quot;</span>)]])</span>
<span id="cb597-18"><a href="bayesian-models-of-cognition.html#cb597-18" tabindex="-1"></a>  }</span>
<span id="cb597-19"><a href="bayesian-models-of-cognition.html#cb597-19" tabindex="-1"></a>}</span>
<span id="cb597-20"><a href="bayesian-models-of-cognition.html#cb597-20" tabindex="-1"></a></span>
<span id="cb597-21"><a href="bayesian-models-of-cognition.html#cb597-21" tabindex="-1"></a><span class="fu">colnames</span>(correlation_matrix) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(correlation_matrix) <span class="ot">&lt;-</span> </span>
<span id="cb597-22"><a href="bayesian-models-of-cognition.html#cb597-22" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Total Weight&quot;</span>, <span class="st">&quot;Weight Prop&quot;</span>, <span class="st">&quot;Learning Rate&quot;</span>)</span>
<span id="cb597-23"><a href="bayesian-models-of-cognition.html#cb597-23" tabindex="-1"></a></span>
<span id="cb597-24"><a href="bayesian-models-of-cognition.html#cb597-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Estimated parameter correlations:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Estimated parameter correlations:</code></pre>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="bayesian-models-of-cognition.html#cb599-1" tabindex="-1"></a><span class="fu">print</span>(param_correlations)</span></code></pre></div>
<pre><code>##                 Weight (Direct) Weight (Social) Learning Rate
## Weight (Direct)      1.00000000       0.7527066    0.08451286
## Weight (Social)      0.75270656       1.0000000    0.14876461
## Learning Rate        0.08451286       0.1487646    1.00000000</code></pre>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="bayesian-models-of-cognition.html#cb601-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Population-level parameter correlations:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Population-level parameter correlations:</code></pre>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="bayesian-models-of-cognition.html#cb603-1" tabindex="-1"></a><span class="fu">print</span>(correlation_matrix)</span></code></pre></div>
<pre><code>##               Total Weight Weight Prop Learning Rate
## Total Weight   1.000000000 0.017304172   0.007257079
## Weight Prop    0.017304172 1.000000000   0.008023128
## Learning Rate  0.007257079 0.008023128   1.000000000</code></pre>
</div>
</div>
<div id="sequential-bayesian-evidence-integration-models" class="section level2 hasAnchor" number="11.24">
<h2><span class="header-section-number">11.24</span> Sequential Bayesian Evidence Integration Models<a href="bayesian-models-of-cognition.html#sequential-bayesian-evidence-integration-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="understanding-belief-updating-over-time" class="section level3 hasAnchor" number="11.24.1">
<h3><span class="header-section-number">11.24.1</span> Understanding Belief Updating Over Time<a href="bayesian-models-of-cognition.html#understanding-belief-updating-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Real-world learning rarely happens all at once - it’s a dynamic process where our beliefs evolve as we gather new evidence over time. The sequential Bayesian models we’ve developed capture this dynamic learning process by tracking how beliefs are updated from trial to trial.</p>
</div>
<div id="the-sequential-updating-framework" class="section level3 hasAnchor" number="11.24.2">
<h3><span class="header-section-number">11.24.2</span> The Sequential Updating Framework<a href="bayesian-models-of-cognition.html#the-sequential-updating-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our sequential updating models build on the static evidence integration models from earlier, but with a crucial difference: beliefs are continuously updated based on new evidence. This creates a recursive structure where:</p>
<ul>
<li><p>The agent starts with some initial belief (prior)</p></li>
<li><p>After observing evidence, they update their belief (posterior)</p></li>
<li><p>This posterior becomes the prior for the next trial</p></li>
<li><p>The process repeats for each new piece of evidence</p></li>
</ul>
<p>The key parameters that govern this updating process are:</p>
<ul>
<li><p>Evidence weights (weight_direct and weight_social): How much influence each type of evidence has</p></li>
<li><p>Learning rate (alpha): How quickly beliefs change in response to new evidence</p></li>
</ul>
<p>The learning rate parameter is particularly important - it determines whether an agent is conservative (low learning rate) or responsive (high learning rate) to new information. A learning rate near 1.0 means the agent fully incorporates new evidence, while a rate closer to 0 means the agent makes only small adjustments to beliefs.</p>
</div>
<div id="mathematical-formulation" class="section level3 hasAnchor" number="11.24.3">
<h3><span class="header-section-number">11.24.3</span> Mathematical Formulation<a href="bayesian-models-of-cognition.html#mathematical-formulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For each trial t, the agent’s belief is updated according to:</p>
<p>α_t = α_t − 1 + λ × (w_d × E_d, t − 1 + w_s × E_s, t − 1)</p>
<p>β_t = β_t − 1 + λ × (w_d × (T_d, t−1−E_d, t−1) + w_s × (T_s,t−1−E_s,t−1))</p>
<p>Belief_t = α_t α_t + β_t</p>
<p>Where:</p>
<p>α_t and β_t are the parameters of the Beta distribution representing the belief at trial t</p>
<p>λ is the learning rate</p>
<p>w_d and w_s are the weights for direct and social evidence</p>
<p>E_{d,t−1} and E_{s,t-1} are the counts of blue marbles/signals in the previous trial</p>
<p>T_{d,t-1} and T_{s,t-1} are the total counts of marbles/signals in the previous trial</p>
</div>
<div id="moving-from-single-agent-to-multilevel" class="section level3 hasAnchor" number="11.24.4">
<h3><span class="header-section-number">11.24.4</span> Moving from Single-Agent to Multilevel<a href="bayesian-models-of-cognition.html#moving-from-single-agent-to-multilevel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The multilevel extension allows us to model individual differences in learning while still leveraging the commonalities across individuals. This approach:</p>
<ul>
<li><p>Captures individual learning styles: Some people may learn faster, others may weight certain evidence types more heavily</p></li>
<li><p>Models population distributions: Helps understand the typical learning patterns and the range of variation
Improves parameter estimation: Especially for individuals with limited or noisy data</p></li>
</ul>
<p>The multilevel structure adds substantial complexity to the model implementation, requiring careful handling of:</p>
<p>Trial sequences: Each agent has their own sequence of trials and updating process
Parameter correlations: Learning rate might correlate with evidence weighting
Computational efficiency: Sequential updating creates dependencies that make parallelization challenging</p>
<p>Interpreting Model Results
Our simulation and model fitting reveal several important insights:
Parameter Recovery
The model successfully recovers the key cognitive parameters:</p>
<p>Evidence weights: How much individuals trust different information sources
Learning rate: How quickly they update their beliefs</p>
<p>This validates that our model can meaningfully measure these cognitive processes from observed choices.
Learning Style Differences
The scatterplot of learning styles shows a two-dimensional space of cognitive strategies:</p>
<p>The x-axis represents relative weighting of direct vs. social evidence
The y-axis represents learning speed (how quickly beliefs change)</p>
<p>This creates a typology of learners:</p>
<p>Fast direct learners: Rapidly update based primarily on their own observations
Cautious social learners: Slowly incorporate information, with emphasis on social cues
Balanced adapters: Moderate learning rate with equal weighting of evidence sources</p>
<p>Belief Trajectories
The plots of belief trajectories over time reveal how individuals track changing environmental statistics:</p>
<p>The shaded regions show the model’s uncertainty about beliefs
The comparison with true simulated beliefs validates the model’s ability to recover learning dynamics
The background coloring shows how beliefs align with true environmental states (jar probabilities)</p>
<p>Parameter Correlations
The correlation matrix reveals relationships between cognitive parameters:</p>
<p>A negative correlation between learning rate and total evidence weight would suggest compensatory strategies (fast updating with conservative evidence weighting, or slow updating with strong evidence weighting)
Correlations between direct and social weights might indicate general trust or skepticism toward evidence</p>

<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="bayesian-models-of-cognition.html#cb605-1" tabindex="-1"></a>regenerate_simulations <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb605-2"><a href="bayesian-models-of-cognition.html#cb605-2" tabindex="-1"></a></span>
<span id="cb605-3"><a href="bayesian-models-of-cognition.html#cb605-3" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb605-4"><a href="bayesian-models-of-cognition.html#cb605-4" tabindex="-1"></a>    tidyverse,</span>
<span id="cb605-5"><a href="bayesian-models-of-cognition.html#cb605-5" tabindex="-1"></a>    future,</span>
<span id="cb605-6"><a href="bayesian-models-of-cognition.html#cb605-6" tabindex="-1"></a>    purrr,</span>
<span id="cb605-7"><a href="bayesian-models-of-cognition.html#cb605-7" tabindex="-1"></a>    furrr,</span>
<span id="cb605-8"><a href="bayesian-models-of-cognition.html#cb605-8" tabindex="-1"></a>    patchwork,</span>
<span id="cb605-9"><a href="bayesian-models-of-cognition.html#cb605-9" tabindex="-1"></a>    brms,</span>
<span id="cb605-10"><a href="bayesian-models-of-cognition.html#cb605-10" tabindex="-1"></a>    cmdstanr</span>
<span id="cb605-11"><a href="bayesian-models-of-cognition.html#cb605-11" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-categorization-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/10-BayesianModels.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
