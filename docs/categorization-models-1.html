<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Categorization models | 11 - Reinforcement Learning</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Categorization models | 11 - Reinforcement Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Categorization models | 11 - Reinforcement Learning" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2023" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2024-02-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="categorization-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-goal-of-the-course"><i class="fa fa-check"></i><b>1.1</b> The goal of the course</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#list-of-lectures-and-practical-exercises"><i class="fa fa-check"></i><b>1.2</b> List of lectures and practical exercises</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation-before-the-course"><i class="fa fa-check"></i><b>1.3</b> Preparation before the course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a></li>
<li class="chapter" data-level="2.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#strategies"><i class="fa fa-check"></i><b>2.4</b> Strategies</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.4.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.4.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.4.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.4.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.4.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.4.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.4.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.4.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.4.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.4.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.4.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.5</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.5.1</b> Memory</a></li>
<li class="chapter" data-level="2.5.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#perseveration"><i class="fa fa-check"></i><b>2.5.2</b> Perseveration</a></li>
<li class="chapter" data-level="2.5.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.5.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.6</b> Continuity between models</a></li>
<li class="chapter" data-level="2.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.7</b> Mixture of strategies</a></li>
<li class="chapter" data-level="2.8" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>2.8</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.1</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.2" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.2</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.4" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.4</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.4.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#data"><i class="fa fa-check"></i><b>4.3.1</b> Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#model"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>4.3.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="4.3.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-model"><i class="fa fa-check"></i><b>4.3.4</b> Summarizing the model</a></li>
<li class="chapter" data-level="4.3.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#assessing-model-quality"><i class="fa fa-check"></i><b>4.3.5</b> Assessing model quality</a></li>
<li class="chapter" data-level="4.3.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results"><i class="fa fa-check"></i><b>4.3.6</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>4.5.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>4.6</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>4.6.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html"><i class="fa fa-check"></i><b>5</b> Practical exercise 4 - Model quality checks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>5.1</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="5.2" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-priors"><i class="fa fa-check"></i><b>5.2</b> Assessing priors</a></li>
<li class="chapter" data-level="5.3" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-prior-and-posterior-predictions"><i class="fa fa-check"></i><b>5.3</b> Assessing prior and posterior predictions</a></li>
<li class="chapter" data-level="5.4" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="5.5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#the-memory-model"><i class="fa fa-check"></i><b>5.5</b> The memory model</a></li>
<li class="chapter" data-level="5.6" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>5.6</b> Prior sensitivity check for the memory model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html"><i class="fa fa-check"></i><b>6</b> Multilevel modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#intro-to-multilevel-modeling"><i class="fa fa-check"></i><b>6.1</b> Intro to multilevel modeling</a></li>
<li class="chapter" data-level="6.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent"><i class="fa fa-check"></i><b>6.2</b> A multilevel version of the biased agent and of the simple memory agent</a></li>
<li class="chapter" data-level="6.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>6.3</b> Generating the agents</a></li>
<li class="chapter" data-level="6.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>6.4</b> Plotting the agents</a></li>
<li class="chapter" data-level="6.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>6.5</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>6.5.1</b> Multilevel random</a></li>
<li class="chapter" data-level="6.5.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>6.5.2</b> Assessing multilevel random agents</a></li>
<li class="chapter" data-level="6.5.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory"><i class="fa fa-check"></i><b>6.5.3</b> Multilevel memory</a></li>
<li class="chapter" data-level="6.5.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>6.5.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>6.5.5</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="6.5.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>6.5.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.7" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>6.5.7</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="6.5.8" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>6.5.8</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.9" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-no-pooling"><i class="fa fa-check"></i><b>6.5.9</b> Multilevel memory no pooling</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-full-pooling"><i class="fa fa-check"></i><b>6.6</b> Multilevel full pooling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>7</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model-comparison.html"><a href="model-comparison.html#define-parameters"><i class="fa fa-check"></i><b>7.1</b> Define parameters</a></li>
<li class="chapter" data-level="7.2" data-path="model-comparison.html"><a href="model-comparison.html#define-biased-and-memory-agents"><i class="fa fa-check"></i><b>7.2</b> Define biased and memory agents</a></li>
<li class="chapter" data-level="7.3" data-path="model-comparison.html"><a href="model-comparison.html#generating-the-agents-1"><i class="fa fa-check"></i><b>7.3</b> Generating the agents</a></li>
<li class="chapter" data-level="7.4" data-path="model-comparison.html"><a href="model-comparison.html#prep-the-data"><i class="fa fa-check"></i><b>7.4</b> Prep the data</a></li>
<li class="chapter" data-level="7.5" data-path="model-comparison.html"><a href="model-comparison.html#log-posterior-likelihood"><i class="fa fa-check"></i><b>7.5</b> Log posterior likelihood</a></li>
<li class="chapter" data-level="7.6" data-path="model-comparison.html"><a href="model-comparison.html#create-the-models-multilevel-biased-agents"><i class="fa fa-check"></i><b>7.6</b> Create the models: multilevel biased agents</a></li>
<li class="chapter" data-level="7.7" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-memory-model"><i class="fa fa-check"></i><b>7.7</b> Multilevel memory model</a></li>
<li class="chapter" data-level="7.8" data-path="model-comparison.html"><a href="model-comparison.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>7.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="7.9" data-path="model-comparison.html"><a href="model-comparison.html#calculating-the-expected-log-predictive-density-of-a-model"><i class="fa fa-check"></i><b>7.9</b> Calculating the expected log predictive density of a model</a></li>
<li class="chapter" data-level="7.10" data-path="model-comparison.html"><a href="model-comparison.html#implementing-cross-validation"><i class="fa fa-check"></i><b>7.10</b> Implementing Cross-Validation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-biased-agents"><i class="fa fa-check"></i><b>7.10.1</b> Create cross-validation ready stan model for biased agents</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-memory-agents"><i class="fa fa-check"></i><b>7.10.2</b> Create cross-validation ready stan model for memory agents</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="model-comparison.html"><a href="model-comparison.html#calculating-elpd-and-comparing"><i class="fa fa-check"></i><b>7.11</b> Calculating elpd and comparing</a></li>
<li class="chapter" data-level="7.12" data-path="model-comparison.html"><a href="model-comparison.html#limitations-of-model-comparison-techniques"><i class="fa fa-check"></i><b>7.12</b> Limitations of model comparison techniques</a></li>
<li class="chapter" data-level="7.13" data-path="model-comparison.html"><a href="model-comparison.html#mixture-models"><i class="fa fa-check"></i><b>7.13</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="model-comparison.html"><a href="model-comparison.html#load-the-dataset"><i class="fa fa-check"></i><b>7.13.1</b> Load the dataset</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="model-comparison.html"><a href="model-comparison.html#stan-model-mixing-biased-and-noise"><i class="fa fa-check"></i><b>7.14</b> Stan model mixing biased and noise</a></li>
<li class="chapter" data-level="7.15" data-path="model-comparison.html"><a href="model-comparison.html#fitting-and-assessing-the-model"><i class="fa fa-check"></i><b>7.15</b> Fitting and assessing the model</a></li>
<li class="chapter" data-level="7.16" data-path="model-comparison.html"><a href="model-comparison.html#basic-evaluation"><i class="fa fa-check"></i><b>7.16</b> Basic evaluation</a></li>
<li class="chapter" data-level="7.17" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-mixture-model"><i class="fa fa-check"></i><b>7.17</b> Multilevel mixture model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html"><i class="fa fa-check"></i><b>8</b> Bonus chapter: Additional models developed by students</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#additional-models"><i class="fa fa-check"></i><b>8.1</b> Additional models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.1</b> Probabilistic Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-asymmetric-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.2</b> Probabilistic asymmetric Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-rate"><i class="fa fa-check"></i><b>8.1.3</b> Memory agent with exponential memory decay (rate)</a></li>
<li class="chapter" data-level="8.1.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-exponential"><i class="fa fa-check"></i><b>8.1.4</b> Memory agent with exponential memory decay (exponential)</a></li>
<li class="chapter" data-level="8.1.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-but-separate-memory-for-wins-and-losses"><i class="fa fa-check"></i><b>8.1.5</b> Memory agent with exponential memory decay, but separate memory for wins and losses</a></li>
<li class="chapter" data-level="8.1.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-and-with-confidence"><i class="fa fa-check"></i><b>8.1.6</b> Memory agent with exponential memory decay, and with confidence</a></li>
<li class="chapter" data-level="8.1.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#reinforcement-learning-rescorla-wagner"><i class="fa fa-check"></i><b>8.1.7</b> Reinforcement learning (Rescorla Wagner)</a></li>
<li class="chapter" data-level="8.1.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#hierarchical-gaussian-filter"><i class="fa fa-check"></i><b>8.1.8</b> Hierarchical gaussian filter</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#implementing-the-wsls-model"><i class="fa fa-check"></i><b>8.2</b> Implementing the WSLS model</a></li>
<li class="chapter" data-level="8.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#load-packages"><i class="fa fa-check"></i><b>8.3</b> Load packages</a></li>
<li class="chapter" data-level="8.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#generate-data"><i class="fa fa-check"></i><b>8.4</b> Generate data</a></li>
<li class="chapter" data-level="8.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#sanity-check-for-the-data"><i class="fa fa-check"></i><b>8.5</b> Sanity check for the data</a></li>
<li class="chapter" data-level="8.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#more-sanity-check"><i class="fa fa-check"></i><b>8.6</b> More sanity check</a></li>
<li class="chapter" data-level="8.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-data-for-single-agent-model"><i class="fa fa-check"></i><b>8.7</b> Create data for single agent model</a></li>
<li class="chapter" data-level="8.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model"><i class="fa fa-check"></i><b>8.8</b> Create the model</a></li>
<li class="chapter" data-level="8.9" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#basic-assessment"><i class="fa fa-check"></i><b>8.9</b> Basic assessment</a></li>
<li class="chapter" data-level="8.10" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-multilevel-data"><i class="fa fa-check"></i><b>8.10</b> Create multilevel data</a></li>
<li class="chapter" data-level="8.11" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model-1"><i class="fa fa-check"></i><b>8.11</b> Create the model</a></li>
<li class="chapter" data-level="8.12" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#quality-checks"><i class="fa fa-check"></i><b>8.12</b> Quality checks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>9</b> Bayesian models of cognition</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#load-the-packages"><i class="fa fa-check"></i><b>9.1</b> Load the packages</a></li>
<li class="chapter" data-level="9.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#design-the-model"><i class="fa fa-check"></i><b>9.2</b> Design the model</a></li>
<li class="chapter" data-level="9.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-data"><i class="fa fa-check"></i><b>9.3</b> Create the data</a></li>
<li class="chapter" data-level="9.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize"><i class="fa fa-check"></i><b>9.4</b> Visualize</a></li>
<li class="chapter" data-level="9.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#data-for-stan"><i class="fa fa-check"></i><b>9.5</b> Data for Stan</a></li>
<li class="chapter" data-level="9.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-stan-model"><i class="fa fa-check"></i><b>9.6</b> Create the Stan Model</a></li>
<li class="chapter" data-level="9.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-model"><i class="fa fa-check"></i><b>9.7</b> Fitting the model</a></li>
<li class="chapter" data-level="9.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#basic-evaluation-1"><i class="fa fa-check"></i><b>9.8</b> Basic evaluation</a></li>
<li class="chapter" data-level="9.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayes"><i class="fa fa-check"></i><b>9.9</b> Weighted Bayes</a></li>
<li class="chapter" data-level="9.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize-1"><i class="fa fa-check"></i><b>9.10</b> Visualize</a></li>
<li class="chapter" data-level="9.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-the-weighted-bayes-stan-model-simple-formula"><i class="fa fa-check"></i><b>9.11</b> Build the Weighted Bayes Stan model (simple formula)</a></li>
<li class="chapter" data-level="9.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-evaluation"><i class="fa fa-check"></i><b>9.12</b> Model evaluation</a></li>
<li class="chapter" data-level="9.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-recovery"><i class="fa fa-check"></i><b>9.13</b> Model recovery</a></li>
<li class="chapter" data-level="9.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel"><i class="fa fa-check"></i><b>9.14</b> Multilevel</a></li>
<li class="chapter" data-level="9.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bonus-build-the-weighted-bayes-stan-model-fancier-formula"><i class="fa fa-check"></i><b>9.15</b> Bonus: Build the Weighted Bayes Stan model (fancier formula)</a></li>
<li class="chapter" data-level="9.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluation"><i class="fa fa-check"></i><b>9.16</b> Evaluation</a></li>
<li class="chapter" data-level="9.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-a-temporal-bayes-storing-current-belief-as-prior-for-next-turn"><i class="fa fa-check"></i><b>9.17</b> Build a temporal Bayes (storing current belief as prior for next turn)</a></li>
<li class="chapter" data-level="9.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluate"><i class="fa fa-check"></i><b>9.18</b> Evaluate</a></li>
<li class="chapter" data-level="9.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-simple-bayes-model"><i class="fa fa-check"></i><b>9.19</b> Multilevel version of the simple bayes model</a></li>
<li class="chapter" data-level="9.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-weighted-bayes-model"><i class="fa fa-check"></i><b>9.20</b> Multilevel version of the weighted bayes model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="categorization-models.html"><a href="categorization-models.html"><i class="fa fa-check"></i><b>10</b> Categorization models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="categorization-models.html"><a href="categorization-models.html#multilevel-gcm"><i class="fa fa-check"></i><b>10.1</b> Multilevel GCM</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="categorization-models.html"><a href="categorization-models.html#simulate-hierarchical-simplices"><i class="fa fa-check"></i><b>10.1.1</b> Simulate hierarchical simplices</a></li>
<li class="chapter" data-level="10.1.2" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-data-simulation"><i class="fa fa-check"></i><b>10.1.2</b> Set up the data simulation</a></li>
<li class="chapter" data-level="10.1.3" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-stan-model"><i class="fa fa-check"></i><b>10.1.3</b> Set up the Stan model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="categorization-models.html"><a href="categorization-models.html#now-we-parallelize-n.b.-not-finished"><i class="fa fa-check"></i><b>10.2</b> Now we parallelize [N.B. NOT FINISHED]</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="categorization-models.html"><a href="categorization-models.html#student-produced-models-of-categorization"><i class="fa fa-check"></i><b>10.2.1</b> Student-produced models of categorization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="categorization-models-1.html"><a href="categorization-models-1.html"><i class="fa fa-check"></i><b>11</b> Categorization models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="categorization-models-1.html"><a href="categorization-models-1.html#defining-parameters"><i class="fa fa-check"></i><b>11.1</b> Defining parameters</a></li>
<li class="chapter" data-level="11.2" data-path="categorization-models-1.html"><a href="categorization-models-1.html#simulating-with-alpha-0.9-and-p-0.9"><i class="fa fa-check"></i><b>11.2</b> Simulating with alpha 0.9 and p 0.9</a></li>
<li class="chapter" data-level="11.3" data-path="categorization-models-1.html"><a href="categorization-models-1.html#simulating-with-p-0.75"><i class="fa fa-check"></i><b>11.3</b> Simulating with p = 0.75</a></li>
<li class="chapter" data-level="11.4" data-path="categorization-models-1.html"><a href="categorization-models-1.html#what-about-asymmetric-learning"><i class="fa fa-check"></i><b>11.4</b> What about asymmetric learning?</a></li>
<li class="chapter" data-level="11.5" data-path="categorization-models-1.html"><a href="categorization-models-1.html#model-fitting-symmetric-rl"><i class="fa fa-check"></i><b>11.5</b> Model fitting: symmetric RL</a></li>
<li class="chapter" data-level="11.6" data-path="categorization-models-1.html"><a href="categorization-models-1.html#model-fitting-asymmetric-rl"><i class="fa fa-check"></i><b>11.6</b> Model fitting: asymmetric RL</a></li>
<li class="chapter" data-level="11.7" data-path="categorization-models-1.html"><a href="categorization-models-1.html#model-fitting-multilevel"><i class="fa fa-check"></i><b>11.7</b> Model fitting: multilevel</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">11 - Reinforcement Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorization-models-1" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Categorization models<a href="categorization-models-1.html#categorization-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this module the course covers reinforcement learning. In particular, here we implement a version of the Rescorla-Wagner model. [Missing additional RL models]</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="categorization-models-1.html#cb431-1" tabindex="-1"></a>softmax <span class="ot">&lt;-</span> <span class="cf">function</span>(x, tau) {</span>
<span id="cb431-2"><a href="categorization-models-1.html#cb431-2" tabindex="-1"></a>  outcome <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>tau <span class="sc">*</span> x))</span>
<span id="cb431-3"><a href="categorization-models-1.html#cb431-3" tabindex="-1"></a>  <span class="fu">return</span>(outcome)</span>
<span id="cb431-4"><a href="categorization-models-1.html#cb431-4" tabindex="-1"></a>}</span>
<span id="cb431-5"><a href="categorization-models-1.html#cb431-5" tabindex="-1"></a></span>
<span id="cb431-6"><a href="categorization-models-1.html#cb431-6" tabindex="-1"></a>ValueUpdate <span class="ot">=</span> <span class="cf">function</span>(value, alpha, choice, feedback) {</span>
<span id="cb431-7"><a href="categorization-models-1.html#cb431-7" tabindex="-1"></a>  </span>
<span id="cb431-8"><a href="categorization-models-1.html#cb431-8" tabindex="-1"></a>  PE <span class="ot">&lt;-</span> feedback <span class="sc">-</span> value</span>
<span id="cb431-9"><a href="categorization-models-1.html#cb431-9" tabindex="-1"></a>  </span>
<span id="cb431-10"><a href="categorization-models-1.html#cb431-10" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> value[<span class="dv">1</span>] <span class="sc">+</span> alpha <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> choice) <span class="sc">*</span> (feedback <span class="sc">-</span> value[<span class="dv">1</span>])</span>
<span id="cb431-11"><a href="categorization-models-1.html#cb431-11" tabindex="-1"></a></span>
<span id="cb431-12"><a href="categorization-models-1.html#cb431-12" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> value[<span class="dv">2</span>] <span class="sc">+</span> alpha <span class="sc">*</span> (choice) <span class="sc">*</span> (feedback <span class="sc">-</span> value[<span class="dv">2</span>])</span>
<span id="cb431-13"><a href="categorization-models-1.html#cb431-13" tabindex="-1"></a>  </span>
<span id="cb431-14"><a href="categorization-models-1.html#cb431-14" tabindex="-1"></a>  updatedValue <span class="ot">&lt;-</span> <span class="fu">c</span>(v1, v2)</span>
<span id="cb431-15"><a href="categorization-models-1.html#cb431-15" tabindex="-1"></a>  </span>
<span id="cb431-16"><a href="categorization-models-1.html#cb431-16" tabindex="-1"></a>  <span class="fu">return</span>(updatedValue)</span>
<span id="cb431-17"><a href="categorization-models-1.html#cb431-17" tabindex="-1"></a>}</span></code></pre></div>
<div id="defining-parameters" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Defining parameters<a href="categorization-models-1.html#defining-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="categorization-models-1.html#cb432-1" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb432-2"><a href="categorization-models-1.html#cb432-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span></code></pre></div>
</div>
<div id="simulating-with-alpha-0.9-and-p-0.9" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Simulating with alpha 0.9 and p 0.9<a href="categorization-models-1.html#simulating-with-alpha-0.9-and-p-0.9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="categorization-models-1.html#cb433-1" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb433-2"><a href="categorization-models-1.html#cb433-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb433-3"><a href="categorization-models-1.html#cb433-3" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb433-4"><a href="categorization-models-1.html#cb433-4" tabindex="-1"></a>choice <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb433-5"><a href="categorization-models-1.html#cb433-5" tabindex="-1"></a>feedback <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb433-6"><a href="categorization-models-1.html#cb433-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co"># probability that choice 0 gives a prize (1-p is probability that choice 1 gives a prize)</span></span>
<span id="cb433-7"><a href="categorization-models-1.html#cb433-7" tabindex="-1"></a></span>
<span id="cb433-8"><a href="categorization-models-1.html#cb433-8" tabindex="-1"></a><span class="fu">ValueUpdate</span>(value, alpha, choice, feedback)</span></code></pre></div>
<pre><code>## [1] -0.9  0.0</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="categorization-models-1.html#cb435-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials),</span>
<span id="cb435-2"><a href="categorization-models-1.html#cb435-2" tabindex="-1"></a>            <span class="at">choice =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb435-3"><a href="categorization-models-1.html#cb435-3" tabindex="-1"></a>            <span class="at">value1 =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb435-4"><a href="categorization-models-1.html#cb435-4" tabindex="-1"></a>            <span class="at">value2 =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb435-5"><a href="categorization-models-1.html#cb435-5" tabindex="-1"></a>            <span class="at">feedback =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials))</span>
<span id="cb435-6"><a href="categorization-models-1.html#cb435-6" tabindex="-1"></a></span>
<span id="cb435-7"><a href="categorization-models-1.html#cb435-7" tabindex="-1"></a>Bot <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="dv">1</span>, p)</span>
<span id="cb435-8"><a href="categorization-models-1.html#cb435-8" tabindex="-1"></a></span>
<span id="cb435-9"><a href="categorization-models-1.html#cb435-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>trials) {</span>
<span id="cb435-10"><a href="categorization-models-1.html#cb435-10" tabindex="-1"></a>    </span>
<span id="cb435-11"><a href="categorization-models-1.html#cb435-11" tabindex="-1"></a>    choice <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#rbinom(1, 1, softmax(value[2] - value[1], temperature))</span></span>
<span id="cb435-12"><a href="categorization-models-1.html#cb435-12" tabindex="-1"></a>    feedback <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Bot[i] <span class="sc">==</span> choice, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb435-13"><a href="categorization-models-1.html#cb435-13" tabindex="-1"></a>    value <span class="ot">&lt;-</span> <span class="fu">ValueUpdate</span>(value, alpha, choice, feedback)</span>
<span id="cb435-14"><a href="categorization-models-1.html#cb435-14" tabindex="-1"></a>    d<span class="sc">$</span>choice[i] <span class="ot">&lt;-</span> choice</span>
<span id="cb435-15"><a href="categorization-models-1.html#cb435-15" tabindex="-1"></a>    d<span class="sc">$</span>value1[i] <span class="ot">&lt;-</span> value[<span class="dv">1</span>]</span>
<span id="cb435-16"><a href="categorization-models-1.html#cb435-16" tabindex="-1"></a>    d<span class="sc">$</span>value2[i] <span class="ot">&lt;-</span> value[<span class="dv">2</span>]</span>
<span id="cb435-17"><a href="categorization-models-1.html#cb435-17" tabindex="-1"></a>    d<span class="sc">$</span>feedback[i] <span class="ot">&lt;-</span> feedback</span>
<span id="cb435-18"><a href="categorization-models-1.html#cb435-18" tabindex="-1"></a>  </span>
<span id="cb435-19"><a href="categorization-models-1.html#cb435-19" tabindex="-1"></a>}</span>
<span id="cb435-20"><a href="categorization-models-1.html#cb435-20" tabindex="-1"></a></span>
<span id="cb435-21"><a href="categorization-models-1.html#cb435-21" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb435-22"><a href="categorization-models-1.html#cb435-22" tabindex="-1"></a>  <span class="at">trial =</span> <span class="fu">seq</span>(trials),</span>
<span id="cb435-23"><a href="categorization-models-1.html#cb435-23" tabindex="-1"></a>  <span class="at">prevFeedback =</span> <span class="fu">lead</span>(feedback))</span>
<span id="cb435-24"><a href="categorization-models-1.html#cb435-24" tabindex="-1"></a></span>
<span id="cb435-25"><a href="categorization-models-1.html#cb435-25" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(d, trial <span class="sc">&lt;</span> <span class="dv">21</span>)) <span class="sc">+</span> </span>
<span id="cb435-26"><a href="categorization-models-1.html#cb435-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(trial, value1), <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span> </span>
<span id="cb435-27"><a href="categorization-models-1.html#cb435-27" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(trial, value2), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb435-28"><a href="categorization-models-1.html#cb435-28" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(trial, prevFeedback), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb435-29"><a href="categorization-models-1.html#cb435-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
<div id="simulating-with-p-0.75" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Simulating with p = 0.75<a href="categorization-models-1.html#simulating-with-p-0.75" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="categorization-models-1.html#cb436-1" tabindex="-1"></a><span class="co"># Let&#39;s imagine a situation where the underlying rate is 0.75</span></span>
<span id="cb436-2"><a href="categorization-models-1.html#cb436-2" tabindex="-1"></a></span>
<span id="cb436-3"><a href="categorization-models-1.html#cb436-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb436-4"><a href="categorization-models-1.html#cb436-4" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb436-5"><a href="categorization-models-1.html#cb436-5" tabindex="-1"></a>choice <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb436-6"><a href="categorization-models-1.html#cb436-6" tabindex="-1"></a>feedback <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb436-7"><a href="categorization-models-1.html#cb436-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.75</span> <span class="co"># probability that choice 0 gives a prize (1-p is probability that choice 1 gives a prize)</span></span>
<span id="cb436-8"><a href="categorization-models-1.html#cb436-8" tabindex="-1"></a></span>
<span id="cb436-9"><a href="categorization-models-1.html#cb436-9" tabindex="-1"></a></span>
<span id="cb436-10"><a href="categorization-models-1.html#cb436-10" tabindex="-1"></a></span>
<span id="cb436-11"><a href="categorization-models-1.html#cb436-11" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb436-12"><a href="categorization-models-1.html#cb436-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb436-13"><a href="categorization-models-1.html#cb436-13" tabindex="-1"></a><span class="cf">for</span> (temperature <span class="cf">in</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)) {</span>
<span id="cb436-14"><a href="categorization-models-1.html#cb436-14" tabindex="-1"></a>  </span>
<span id="cb436-15"><a href="categorization-models-1.html#cb436-15" tabindex="-1"></a>  <span class="cf">for</span> (alpha <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) {</span>
<span id="cb436-16"><a href="categorization-models-1.html#cb436-16" tabindex="-1"></a>    </span>
<span id="cb436-17"><a href="categorization-models-1.html#cb436-17" tabindex="-1"></a>    value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb436-18"><a href="categorization-models-1.html#cb436-18" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials),</span>
<span id="cb436-19"><a href="categorization-models-1.html#cb436-19" tabindex="-1"></a>                <span class="at">choice =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb436-20"><a href="categorization-models-1.html#cb436-20" tabindex="-1"></a>                <span class="at">value1 =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb436-21"><a href="categorization-models-1.html#cb436-21" tabindex="-1"></a>                <span class="at">value2 =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb436-22"><a href="categorization-models-1.html#cb436-22" tabindex="-1"></a>                <span class="at">feedback =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials),</span>
<span id="cb436-23"><a href="categorization-models-1.html#cb436-23" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials),</span>
<span id="cb436-24"><a href="categorization-models-1.html#cb436-24" tabindex="-1"></a>                <span class="at">temperature =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials),</span>
<span id="cb436-25"><a href="categorization-models-1.html#cb436-25" tabindex="-1"></a>                <span class="at">agent =</span> n)</span>
<span id="cb436-26"><a href="categorization-models-1.html#cb436-26" tabindex="-1"></a>    </span>
<span id="cb436-27"><a href="categorization-models-1.html#cb436-27" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>trials) {</span>
<span id="cb436-28"><a href="categorization-models-1.html#cb436-28" tabindex="-1"></a>      </span>
<span id="cb436-29"><a href="categorization-models-1.html#cb436-29" tabindex="-1"></a>      choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">softmax</span>(value[<span class="dv">2</span>] <span class="sc">-</span> value[<span class="dv">1</span>], temperature))</span>
<span id="cb436-30"><a href="categorization-models-1.html#cb436-30" tabindex="-1"></a>      feedback <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Bot[i] <span class="sc">==</span> choice, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb436-31"><a href="categorization-models-1.html#cb436-31" tabindex="-1"></a>      value <span class="ot">&lt;-</span> <span class="fu">ValueUpdate</span>(value, alpha, choice, feedback)</span>
<span id="cb436-32"><a href="categorization-models-1.html#cb436-32" tabindex="-1"></a>      d<span class="sc">$</span>trial[i] <span class="ot">&lt;-</span> i</span>
<span id="cb436-33"><a href="categorization-models-1.html#cb436-33" tabindex="-1"></a>      d<span class="sc">$</span>choice[i] <span class="ot">&lt;-</span> choice</span>
<span id="cb436-34"><a href="categorization-models-1.html#cb436-34" tabindex="-1"></a>      d<span class="sc">$</span>value1[i] <span class="ot">&lt;-</span> value[<span class="dv">1</span>]</span>
<span id="cb436-35"><a href="categorization-models-1.html#cb436-35" tabindex="-1"></a>      d<span class="sc">$</span>value2[i] <span class="ot">&lt;-</span> value[<span class="dv">2</span>]</span>
<span id="cb436-36"><a href="categorization-models-1.html#cb436-36" tabindex="-1"></a>      d<span class="sc">$</span>feedback[i] <span class="ot">&lt;-</span> feedback</span>
<span id="cb436-37"><a href="categorization-models-1.html#cb436-37" tabindex="-1"></a>      d<span class="sc">$</span>alpha[i] <span class="ot">&lt;-</span> alpha</span>
<span id="cb436-38"><a href="categorization-models-1.html#cb436-38" tabindex="-1"></a>      d<span class="sc">$</span>temperature[i] <span class="ot">&lt;-</span> temperature</span>
<span id="cb436-39"><a href="categorization-models-1.html#cb436-39" tabindex="-1"></a>      </span>
<span id="cb436-40"><a href="categorization-models-1.html#cb436-40" tabindex="-1"></a>    }</span>
<span id="cb436-41"><a href="categorization-models-1.html#cb436-41" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;df&quot;</span>)) {df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, d)} <span class="cf">else</span> {df <span class="ot">&lt;-</span> d}</span>
<span id="cb436-42"><a href="categorization-models-1.html#cb436-42" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb436-43"><a href="categorization-models-1.html#cb436-43" tabindex="-1"></a>  }</span>
<span id="cb436-44"><a href="categorization-models-1.html#cb436-44" tabindex="-1"></a>}</span>
<span id="cb436-45"><a href="categorization-models-1.html#cb436-45" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alpha, temperature) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb436-46"><a href="categorization-models-1.html#cb436-46" tabindex="-1"></a>  <span class="at">prevFeedback =</span> <span class="fu">lead</span>(feedback))</span>
<span id="cb436-47"><a href="categorization-models-1.html#cb436-47" tabindex="-1"></a></span>
<span id="cb436-48"><a href="categorization-models-1.html#cb436-48" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">subset</span>(trial <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> temperature <span class="sc">==</span> <span class="fl">0.01</span>)</span>
<span id="cb436-49"><a href="categorization-models-1.html#cb436-49" tabindex="-1"></a></span>
<span id="cb436-50"><a href="categorization-models-1.html#cb436-50" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb436-51"><a href="categorization-models-1.html#cb436-51" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(d1, alpha <span class="sc">==</span> <span class="dv">1</span>), <span class="fu">aes</span>(trial, prevFeedback), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb436-52"><a href="categorization-models-1.html#cb436-52" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(d1, alpha <span class="sc">==</span> <span class="fl">0.9</span>), <span class="fu">aes</span>(trial, value2), <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span></span>
<span id="cb436-53"><a href="categorization-models-1.html#cb436-53" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(d1, alpha <span class="sc">==</span> <span class="fl">0.5</span>), <span class="fu">aes</span>(trial, value2), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb436-54"><a href="categorization-models-1.html#cb436-54" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(d1, alpha <span class="sc">==</span> <span class="fl">0.2</span>), <span class="fu">aes</span>(trial, value2), <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb436-55"><a href="categorization-models-1.html#cb436-55" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="categorization-models-1.html#cb437-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alpha, temperature) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb437-2"><a href="categorization-models-1.html#cb437-2" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">cumsum</span>(choice) <span class="sc">/</span> <span class="fu">seq_along</span>(choice),</span>
<span id="cb437-3"><a href="categorization-models-1.html#cb437-3" tabindex="-1"></a>  <span class="at">performance =</span> <span class="fu">cumsum</span>(feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(feedback)</span>
<span id="cb437-4"><a href="categorization-models-1.html#cb437-4" tabindex="-1"></a>)</span>
<span id="cb437-5"><a href="categorization-models-1.html#cb437-5" tabindex="-1"></a></span>
<span id="cb437-6"><a href="categorization-models-1.html#cb437-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(df, trial <span class="sc">&lt;</span> <span class="dv">41</span>), <span class="fu">aes</span>(trial, performance, <span class="at">group =</span> alpha, <span class="at">color =</span> alpha)) <span class="sc">+</span></span>
<span id="cb437-7"><a href="categorization-models-1.html#cb437-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb437-8"><a href="categorization-models-1.html#cb437-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>temperature) <span class="sc">+</span></span>
<span id="cb437-9"><a href="categorization-models-1.html#cb437-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-46-2.png" width="672" /></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="categorization-models-1.html#cb438-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(df, trial <span class="sc">&lt;</span> <span class="dv">41</span>), <span class="fu">aes</span>(trial, performance, <span class="at">group =</span> temperature, <span class="at">color =</span> temperature)) <span class="sc">+</span></span>
<span id="cb438-2"><a href="categorization-models-1.html#cb438-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb438-3"><a href="categorization-models-1.html#cb438-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>alpha) <span class="sc">+</span></span>
<span id="cb438-4"><a href="categorization-models-1.html#cb438-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-46-3.png" width="672" /></p>
</div>
<div id="what-about-asymmetric-learning" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> What about asymmetric learning?<a href="categorization-models-1.html#what-about-asymmetric-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>[Missing: simulations of RL with different alphas for positive and negative feedback]</p>
</div>
<div id="model-fitting-symmetric-rl" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Model fitting: symmetric RL<a href="categorization-models-1.html#model-fitting-symmetric-rl" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="categorization-models-1.html#cb439-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">subset</span>(alpha <span class="sc">==</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> temperature <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb439-2"><a href="categorization-models-1.html#cb439-2" tabindex="-1"></a></span>
<span id="cb439-3"><a href="categorization-models-1.html#cb439-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb439-4"><a href="categorization-models-1.html#cb439-4" tabindex="-1"></a>  <span class="at">trials =</span> trials,</span>
<span id="cb439-5"><a href="categorization-models-1.html#cb439-5" tabindex="-1"></a>  <span class="at">choice =</span> d<span class="sc">$</span>choice <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb439-6"><a href="categorization-models-1.html#cb439-6" tabindex="-1"></a>  <span class="at">feedback =</span> d<span class="sc">$</span>feedback</span>
<span id="cb439-7"><a href="categorization-models-1.html#cb439-7" tabindex="-1"></a>)</span>
<span id="cb439-8"><a href="categorization-models-1.html#cb439-8" tabindex="-1"></a></span>
<span id="cb439-9"><a href="categorization-models-1.html#cb439-9" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb439-10"><a href="categorization-models-1.html#cb439-10" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb439-11"><a href="categorization-models-1.html#cb439-11" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; trials;</span></span>
<span id="cb439-12"><a href="categorization-models-1.html#cb439-12" tabindex="-1"></a><span class="st">    array[trials] int&lt;lower=1,upper=2&gt; choice;</span></span>
<span id="cb439-13"><a href="categorization-models-1.html#cb439-13" tabindex="-1"></a><span class="st">    array[trials] int&lt;lower=-1,upper=1&gt; feedback;</span></span>
<span id="cb439-14"><a href="categorization-models-1.html#cb439-14" tabindex="-1"></a><span class="st">} </span></span>
<span id="cb439-15"><a href="categorization-models-1.html#cb439-15" tabindex="-1"></a></span>
<span id="cb439-16"><a href="categorization-models-1.html#cb439-16" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb439-17"><a href="categorization-models-1.html#cb439-17" tabindex="-1"></a><span class="st">  vector[2] initValue;  // initial values for V</span></span>
<span id="cb439-18"><a href="categorization-models-1.html#cb439-18" tabindex="-1"></a><span class="st">  initValue = rep_vector(0.0, 2);</span></span>
<span id="cb439-19"><a href="categorization-models-1.html#cb439-19" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb439-20"><a href="categorization-models-1.html#cb439-20" tabindex="-1"></a></span>
<span id="cb439-21"><a href="categorization-models-1.html#cb439-21" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb439-22"><a href="categorization-models-1.html#cb439-22" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; alpha; // learning rate</span></span>
<span id="cb439-23"><a href="categorization-models-1.html#cb439-23" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=20&gt; temperature; // softmax inv.temp.</span></span>
<span id="cb439-24"><a href="categorization-models-1.html#cb439-24" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb439-25"><a href="categorization-models-1.html#cb439-25" tabindex="-1"></a></span>
<span id="cb439-26"><a href="categorization-models-1.html#cb439-26" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb439-27"><a href="categorization-models-1.html#cb439-27" tabindex="-1"></a><span class="st">    real pe;</span></span>
<span id="cb439-28"><a href="categorization-models-1.html#cb439-28" tabindex="-1"></a><span class="st">    vector[2] value;</span></span>
<span id="cb439-29"><a href="categorization-models-1.html#cb439-29" tabindex="-1"></a><span class="st">    vector[2] theta;</span></span>
<span id="cb439-30"><a href="categorization-models-1.html#cb439-30" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb439-31"><a href="categorization-models-1.html#cb439-31" tabindex="-1"></a><span class="st">    target += uniform_lpdf(alpha | 0, 1);</span></span>
<span id="cb439-32"><a href="categorization-models-1.html#cb439-32" tabindex="-1"></a><span class="st">    target += uniform_lpdf(temperature | 0, 20);</span></span>
<span id="cb439-33"><a href="categorization-models-1.html#cb439-33" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb439-34"><a href="categorization-models-1.html#cb439-34" tabindex="-1"></a><span class="st">    value = initValue;</span></span>
<span id="cb439-35"><a href="categorization-models-1.html#cb439-35" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb439-36"><a href="categorization-models-1.html#cb439-36" tabindex="-1"></a><span class="st">    for (t in 1:trials) {</span></span>
<span id="cb439-37"><a href="categorization-models-1.html#cb439-37" tabindex="-1"></a><span class="st">        theta = softmax( temperature * value); // action prob. computed via softmax</span></span>
<span id="cb439-38"><a href="categorization-models-1.html#cb439-38" tabindex="-1"></a><span class="st">        target += categorical_lpmf(choice[t] | theta);</span></span>
<span id="cb439-39"><a href="categorization-models-1.html#cb439-39" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb439-40"><a href="categorization-models-1.html#cb439-40" tabindex="-1"></a><span class="st">        pe = feedback[t] - value[choice[t]]; // compute pe for chosen value only</span></span>
<span id="cb439-41"><a href="categorization-models-1.html#cb439-41" tabindex="-1"></a><span class="st">        value[choice[t]] = value[choice[t]] + alpha * pe; // update chosen V</span></span>
<span id="cb439-42"><a href="categorization-models-1.html#cb439-42" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb439-43"><a href="categorization-models-1.html#cb439-43" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb439-44"><a href="categorization-models-1.html#cb439-44" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb439-45"><a href="categorization-models-1.html#cb439-45" tabindex="-1"></a></span>
<span id="cb439-46"><a href="categorization-models-1.html#cb439-46" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb439-47"><a href="categorization-models-1.html#cb439-47" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; alpha_prior;</span></span>
<span id="cb439-48"><a href="categorization-models-1.html#cb439-48" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=20&gt; temperature_prior;</span></span>
<span id="cb439-49"><a href="categorization-models-1.html#cb439-49" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb439-50"><a href="categorization-models-1.html#cb439-50" tabindex="-1"></a><span class="st">  real pe;</span></span>
<span id="cb439-51"><a href="categorization-models-1.html#cb439-51" tabindex="-1"></a><span class="st">  vector[2] value;</span></span>
<span id="cb439-52"><a href="categorization-models-1.html#cb439-52" tabindex="-1"></a><span class="st">  vector[2] theta;</span></span>
<span id="cb439-53"><a href="categorization-models-1.html#cb439-53" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb439-54"><a href="categorization-models-1.html#cb439-54" tabindex="-1"></a><span class="st">  real log_lik;</span></span>
<span id="cb439-55"><a href="categorization-models-1.html#cb439-55" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb439-56"><a href="categorization-models-1.html#cb439-56" tabindex="-1"></a><span class="st">  alpha_prior = uniform_rng(0,1);</span></span>
<span id="cb439-57"><a href="categorization-models-1.html#cb439-57" tabindex="-1"></a><span class="st">  temperature_prior = uniform_rng(0,20);</span></span>
<span id="cb439-58"><a href="categorization-models-1.html#cb439-58" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb439-59"><a href="categorization-models-1.html#cb439-59" tabindex="-1"></a><span class="st">  value = initValue;</span></span>
<span id="cb439-60"><a href="categorization-models-1.html#cb439-60" tabindex="-1"></a><span class="st">  log_lik = 0;</span></span>
<span id="cb439-61"><a href="categorization-models-1.html#cb439-61" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb439-62"><a href="categorization-models-1.html#cb439-62" tabindex="-1"></a><span class="st">  for (t in 1:trials) {</span></span>
<span id="cb439-63"><a href="categorization-models-1.html#cb439-63" tabindex="-1"></a><span class="st">        theta = softmax( temperature * value); // action prob. computed via softmax</span></span>
<span id="cb439-64"><a href="categorization-models-1.html#cb439-64" tabindex="-1"></a><span class="st">        log_lik = log_lik + categorical_lpmf(choice[t] | theta);</span></span>
<span id="cb439-65"><a href="categorization-models-1.html#cb439-65" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb439-66"><a href="categorization-models-1.html#cb439-66" tabindex="-1"></a><span class="st">        pe = feedback[t] - value[choice[t]]; // compute pe for chosen value only</span></span>
<span id="cb439-67"><a href="categorization-models-1.html#cb439-67" tabindex="-1"></a><span class="st">        value[choice[t]] = value[choice[t]] + alpha * pe; // update chosen V</span></span>
<span id="cb439-68"><a href="categorization-models-1.html#cb439-68" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb439-69"><a href="categorization-models-1.html#cb439-69" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb439-70"><a href="categorization-models-1.html#cb439-70" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb439-71"><a href="categorization-models-1.html#cb439-71" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb439-72"><a href="categorization-models-1.html#cb439-72" tabindex="-1"></a></span>
<span id="cb439-73"><a href="categorization-models-1.html#cb439-73" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb439-74"><a href="categorization-models-1.html#cb439-74" tabindex="-1"></a>  stan_model,</span>
<span id="cb439-75"><a href="categorization-models-1.html#cb439-75" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb439-76"><a href="categorization-models-1.html#cb439-76" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W11_RL_symmetric.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W11_RL_symmetric.stan&quot;</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="categorization-models-1.html#cb441-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W11_RL_symmetric.stan&quot;</span>)</span>
<span id="cb441-2"><a href="categorization-models-1.html#cb441-2" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb441-3"><a href="categorization-models-1.html#cb441-3" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>), <span class="at">pedantic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb441-4"><a href="categorization-models-1.html#cb441-4" tabindex="-1"></a></span>
<span id="cb441-5"><a href="categorization-models-1.html#cb441-5" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb441-6"><a href="categorization-models-1.html#cb441-6" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb441-7"><a href="categorization-models-1.html#cb441-7" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb441-8"><a href="categorization-models-1.html#cb441-8" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb441-9"><a href="categorization-models-1.html#cb441-9" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb441-10"><a href="categorization-models-1.html#cb441-10" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb441-11"><a href="categorization-models-1.html#cb441-11" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb441-12"><a href="categorization-models-1.html#cb441-12" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb441-13"><a href="categorization-models-1.html#cb441-13" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">1000</span>,</span>
<span id="cb441-14"><a href="categorization-models-1.html#cb441-14" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">&quot;simmodels&quot;</span>,</span>
<span id="cb441-15"><a href="categorization-models-1.html#cb441-15" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb441-16"><a href="categorization-models-1.html#cb441-16" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb441-17"><a href="categorization-models-1.html#cb441-17" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 4000 [  0%]  (Warmup) 
## Chain 2 Iteration:    1 / 4000 [  0%]  (Warmup) 
## Chain 1 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
## Chain 2 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
## Chain 1 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 4000 / 4000 [100%]  (Sampling) 
## Chain 1 finished in 1.9 seconds.
## Chain 2 Iteration: 4000 / 4000 [100%]  (Sampling) 
## Chain 2 finished in 1.9 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 1.9 seconds.
## Total execution time: 2.2 seconds.</code></pre>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="categorization-models-1.html#cb443-1" tabindex="-1"></a><span class="co"># Same the fitted model</span></span>
<span id="cb443-2"><a href="categorization-models-1.html#cb443-2" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/W11_RL_symmetric.rds&quot;</span>)</span>
<span id="cb443-3"><a href="categorization-models-1.html#cb443-3" tabindex="-1"></a></span>
<span id="cb443-4"><a href="categorization-models-1.html#cb443-4" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">cmdstan_diagnose</span>()</span></code></pre></div>
<pre><code>## Processing csv files: /Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/simmodels/W11_RL_symmetric-202402150732-1-8fd82a.csv, /Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/simmodels/W11_RL_symmetric-202402150732-2-8fd82a.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="categorization-models-1.html#cb445-1" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">summary</span>() </span></code></pre></div>
<pre><code>## # A tibble: 11 × 10
##    variable      mean   median      sd     mad       q5      q95  rhat ess_bulk ess_tail
##    &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 lp__      -1.37e+1 -1.33e+1 1.15    0.749   -1.60e+1 -12.6     1.00    1409.    1628.
##  2 alpha      6.07e-1  6.13e-1 0.146   0.149    3.57e-1   0.840   1.00    2087.    1606.
##  3 temperat…  4.61e+0  4.40e+0 1.30    1.13     2.94e+0   7.03    1.00    1942.    1747.
##  4 alpha_pr…  4.99e-1  4.96e-1 0.286   0.364    5.24e-2   0.947   1.00    4069.    3923.
##  5 temperat…  9.86e+0  9.81e+0 5.73    7.34     1.07e+0  18.9     1.00    3739.    3853.
##  6 pe         4.68e-1  4.89e-1 0.0998  0.0910   2.69e-1   0.593   1.00    2088.    1606.
##  7 value[1]  -9.13e-1 -9.42e-1 0.0901  0.0607  -9.96e-1  -0.734   1.00    2086.    1606.
##  8 value[2]   8.02e-1  8.11e-1 0.103   0.108    6.18e-1   0.957   1.00    2099.    1606.
##  9 theta[1]   4.69e-3  1.84e-3 0.00757 0.00251  2.38e-5   0.0193  1.00    1929.    1534.
## 10 theta[2]   9.95e-1  9.98e-1 0.00757 0.00251  9.81e-1   1.00    1.00    1937.    1555.
## 11 log_lik   -1.03e+1 -1.00e+1 1.04    0.709   -1.25e+1  -9.38    1.00    1503.    1788.</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="categorization-models-1.html#cb447-1" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb447-2"><a href="categorization-models-1.html#cb447-2" tabindex="-1"></a></span>
<span id="cb447-3"><a href="categorization-models-1.html#cb447-3" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, alpha, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb447-4"><a href="categorization-models-1.html#cb447-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb447-5"><a href="categorization-models-1.html#cb447-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="categorization-models-1.html#cb448-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, temperature, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb448-2"><a href="categorization-models-1.html#cb448-2" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb448-3"><a href="categorization-models-1.html#cb448-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="categorization-models-1.html#cb449-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb449-2"><a href="categorization-models-1.html#cb449-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(alpha), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb449-3"><a href="categorization-models-1.html#cb449-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(alpha_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb449-4"><a href="categorization-models-1.html#cb449-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Learning Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb449-5"><a href="categorization-models-1.html#cb449-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb449-6"><a href="categorization-models-1.html#cb449-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-47-3.png" width="672" /></p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="categorization-models-1.html#cb450-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb450-2"><a href="categorization-models-1.html#cb450-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(temperature), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb450-3"><a href="categorization-models-1.html#cb450-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(temperature_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb450-4"><a href="categorization-models-1.html#cb450-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;(inverse) temperature&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-5"><a href="categorization-models-1.html#cb450-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-6"><a href="categorization-models-1.html#cb450-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-47-4.png" width="672" /></p>
</div>
<div id="model-fitting-asymmetric-rl" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Model fitting: asymmetric RL<a href="categorization-models-1.html#model-fitting-asymmetric-rl" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="categorization-models-1.html#cb451-1" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb451-2"><a href="categorization-models-1.html#cb451-2" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb451-3"><a href="categorization-models-1.html#cb451-3" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; trials;</span></span>
<span id="cb451-4"><a href="categorization-models-1.html#cb451-4" tabindex="-1"></a><span class="st">    array[trials] int&lt;lower=1,upper=2&gt; choice;</span></span>
<span id="cb451-5"><a href="categorization-models-1.html#cb451-5" tabindex="-1"></a><span class="st">    array[trials] int&lt;lower=-1,upper=1&gt; feedback;</span></span>
<span id="cb451-6"><a href="categorization-models-1.html#cb451-6" tabindex="-1"></a><span class="st">} </span></span>
<span id="cb451-7"><a href="categorization-models-1.html#cb451-7" tabindex="-1"></a></span>
<span id="cb451-8"><a href="categorization-models-1.html#cb451-8" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb451-9"><a href="categorization-models-1.html#cb451-9" tabindex="-1"></a><span class="st">  vector[2] initValue;  // initial values for V</span></span>
<span id="cb451-10"><a href="categorization-models-1.html#cb451-10" tabindex="-1"></a><span class="st">  initValue = rep_vector(0.0, 2);</span></span>
<span id="cb451-11"><a href="categorization-models-1.html#cb451-11" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb451-12"><a href="categorization-models-1.html#cb451-12" tabindex="-1"></a></span>
<span id="cb451-13"><a href="categorization-models-1.html#cb451-13" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb451-14"><a href="categorization-models-1.html#cb451-14" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; alpha_pos; // learning rate</span></span>
<span id="cb451-15"><a href="categorization-models-1.html#cb451-15" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; alpha_neg; // learning rate</span></span>
<span id="cb451-16"><a href="categorization-models-1.html#cb451-16" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=20&gt; temperature; // softmax inv.temp.</span></span>
<span id="cb451-17"><a href="categorization-models-1.html#cb451-17" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb451-18"><a href="categorization-models-1.html#cb451-18" tabindex="-1"></a></span>
<span id="cb451-19"><a href="categorization-models-1.html#cb451-19" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb451-20"><a href="categorization-models-1.html#cb451-20" tabindex="-1"></a><span class="st">    real pe;</span></span>
<span id="cb451-21"><a href="categorization-models-1.html#cb451-21" tabindex="-1"></a><span class="st">    vector[2] value;</span></span>
<span id="cb451-22"><a href="categorization-models-1.html#cb451-22" tabindex="-1"></a><span class="st">    vector[2] theta;</span></span>
<span id="cb451-23"><a href="categorization-models-1.html#cb451-23" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb451-24"><a href="categorization-models-1.html#cb451-24" tabindex="-1"></a><span class="st">    target += uniform_lpdf(alpha_pos | 0, 1);</span></span>
<span id="cb451-25"><a href="categorization-models-1.html#cb451-25" tabindex="-1"></a><span class="st">    target += uniform_lpdf(alpha_neg | 0, 1);</span></span>
<span id="cb451-26"><a href="categorization-models-1.html#cb451-26" tabindex="-1"></a><span class="st">    target += uniform_lpdf(temperature | 0, 20);</span></span>
<span id="cb451-27"><a href="categorization-models-1.html#cb451-27" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb451-28"><a href="categorization-models-1.html#cb451-28" tabindex="-1"></a><span class="st">    value = initValue;</span></span>
<span id="cb451-29"><a href="categorization-models-1.html#cb451-29" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb451-30"><a href="categorization-models-1.html#cb451-30" tabindex="-1"></a><span class="st">    for (t in 1:trials) {</span></span>
<span id="cb451-31"><a href="categorization-models-1.html#cb451-31" tabindex="-1"></a><span class="st">        theta = softmax( temperature * value); // action prob. computed via softmax</span></span>
<span id="cb451-32"><a href="categorization-models-1.html#cb451-32" tabindex="-1"></a><span class="st">        target += categorical_lpmf(choice[t] | theta);</span></span>
<span id="cb451-33"><a href="categorization-models-1.html#cb451-33" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb451-34"><a href="categorization-models-1.html#cb451-34" tabindex="-1"></a><span class="st">        pe = feedback[t] - value[choice[t]]; // compute pe for chosen value only</span></span>
<span id="cb451-35"><a href="categorization-models-1.html#cb451-35" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb451-36"><a href="categorization-models-1.html#cb451-36" tabindex="-1"></a><span class="st">        if (pe &lt; 0)</span></span>
<span id="cb451-37"><a href="categorization-models-1.html#cb451-37" tabindex="-1"></a><span class="st">          value[choice[t]] = value[choice[t]] + alpha_neg * pe; // update chosen V</span></span>
<span id="cb451-38"><a href="categorization-models-1.html#cb451-38" tabindex="-1"></a><span class="st">        if (pe &gt; 0)</span></span>
<span id="cb451-39"><a href="categorization-models-1.html#cb451-39" tabindex="-1"></a><span class="st">          value[choice[t]] = value[choice[t]] + alpha_pos * pe; // update chosen V</span></span>
<span id="cb451-40"><a href="categorization-models-1.html#cb451-40" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb451-41"><a href="categorization-models-1.html#cb451-41" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb451-42"><a href="categorization-models-1.html#cb451-42" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb451-43"><a href="categorization-models-1.html#cb451-43" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb451-44"><a href="categorization-models-1.html#cb451-44" tabindex="-1"></a></span>
<span id="cb451-45"><a href="categorization-models-1.html#cb451-45" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb451-46"><a href="categorization-models-1.html#cb451-46" tabindex="-1"></a>  stan_model,</span>
<span id="cb451-47"><a href="categorization-models-1.html#cb451-47" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb451-48"><a href="categorization-models-1.html#cb451-48" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W11_RL_asymmetric.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W11_RL_asymmetric.stan&quot;</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="categorization-models-1.html#cb453-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W11_RL_asymmetric.stan&quot;</span>)</span>
<span id="cb453-2"><a href="categorization-models-1.html#cb453-2" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb453-3"><a href="categorization-models-1.html#cb453-3" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>), <span class="at">pedantic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb453-4"><a href="categorization-models-1.html#cb453-4" tabindex="-1"></a></span>
<span id="cb453-5"><a href="categorization-models-1.html#cb453-5" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb453-6"><a href="categorization-models-1.html#cb453-6" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb453-7"><a href="categorization-models-1.html#cb453-7" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb453-8"><a href="categorization-models-1.html#cb453-8" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb453-9"><a href="categorization-models-1.html#cb453-9" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb453-10"><a href="categorization-models-1.html#cb453-10" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb453-11"><a href="categorization-models-1.html#cb453-11" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb453-12"><a href="categorization-models-1.html#cb453-12" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb453-13"><a href="categorization-models-1.html#cb453-13" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">1000</span>,</span>
<span id="cb453-14"><a href="categorization-models-1.html#cb453-14" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">&quot;simmodels&quot;</span>,</span>
<span id="cb453-15"><a href="categorization-models-1.html#cb453-15" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb453-16"><a href="categorization-models-1.html#cb453-16" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb453-17"><a href="categorization-models-1.html#cb453-17" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 4000 [  0%]  (Warmup) 
## Chain 2 Iteration:    1 / 4000 [  0%]  (Warmup) 
## Chain 1 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
## Chain 2 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
## Chain 1 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 4000 / 4000 [100%]  (Sampling) 
## Chain 2 finished in 2.5 seconds.
## Chain 1 Iteration: 4000 / 4000 [100%]  (Sampling) 
## Chain 1 finished in 2.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 2.7 seconds.
## Total execution time: 2.9 seconds.</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="categorization-models-1.html#cb455-1" tabindex="-1"></a><span class="co"># Same the fitted model</span></span>
<span id="cb455-2"><a href="categorization-models-1.html#cb455-2" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/W11_RL_asymmetric.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="model-fitting-multilevel" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> Model fitting: multilevel<a href="categorization-models-1.html#model-fitting-multilevel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="categorization-models-1.html#cb456-1" tabindex="-1"></a><span class="do">## Multilevel</span></span>
<span id="cb456-2"><a href="categorization-models-1.html#cb456-2" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb456-3"><a href="categorization-models-1.html#cb456-3" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span> </span>
<span id="cb456-4"><a href="categorization-models-1.html#cb456-4" tabindex="-1"></a></span>
<span id="cb456-5"><a href="categorization-models-1.html#cb456-5" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb456-6"><a href="categorization-models-1.html#cb456-6" tabindex="-1"></a><span class="cf">for</span> (agent <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb456-7"><a href="categorization-models-1.html#cb456-7" tabindex="-1"></a>  </span>
<span id="cb456-8"><a href="categorization-models-1.html#cb456-8" tabindex="-1"></a>  temperature <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">inv.logit</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="fl">0.3</span>))<span class="sc">*</span><span class="dv">20</span></span>
<span id="cb456-9"><a href="categorization-models-1.html#cb456-9" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">inv.logit</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">1.1</span>, <span class="fl">0.3</span>))  </span>
<span id="cb456-10"><a href="categorization-models-1.html#cb456-10" tabindex="-1"></a>    </span>
<span id="cb456-11"><a href="categorization-models-1.html#cb456-11" tabindex="-1"></a>    value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb456-12"><a href="categorization-models-1.html#cb456-12" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials),</span>
<span id="cb456-13"><a href="categorization-models-1.html#cb456-13" tabindex="-1"></a>                <span class="at">choice =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb456-14"><a href="categorization-models-1.html#cb456-14" tabindex="-1"></a>                <span class="at">value1 =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb456-15"><a href="categorization-models-1.html#cb456-15" tabindex="-1"></a>                <span class="at">value2 =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials), </span>
<span id="cb456-16"><a href="categorization-models-1.html#cb456-16" tabindex="-1"></a>                <span class="at">feedback =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials),</span>
<span id="cb456-17"><a href="categorization-models-1.html#cb456-17" tabindex="-1"></a>                <span class="at">alpha =</span> alpha,</span>
<span id="cb456-18"><a href="categorization-models-1.html#cb456-18" tabindex="-1"></a>                <span class="at">temperature =</span> temperature,</span>
<span id="cb456-19"><a href="categorization-models-1.html#cb456-19" tabindex="-1"></a>                <span class="at">agent =</span> agent)</span>
<span id="cb456-20"><a href="categorization-models-1.html#cb456-20" tabindex="-1"></a>    </span>
<span id="cb456-21"><a href="categorization-models-1.html#cb456-21" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>trials) {</span>
<span id="cb456-22"><a href="categorization-models-1.html#cb456-22" tabindex="-1"></a>      </span>
<span id="cb456-23"><a href="categorization-models-1.html#cb456-23" tabindex="-1"></a>      choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">softmax</span>(value[<span class="dv">2</span>] <span class="sc">-</span> value[<span class="dv">1</span>], temperature))</span>
<span id="cb456-24"><a href="categorization-models-1.html#cb456-24" tabindex="-1"></a>      feedback <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Bot[i] <span class="sc">==</span> choice, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb456-25"><a href="categorization-models-1.html#cb456-25" tabindex="-1"></a>      value <span class="ot">&lt;-</span> <span class="fu">ValueUpdate</span>(value, alpha, choice, feedback)</span>
<span id="cb456-26"><a href="categorization-models-1.html#cb456-26" tabindex="-1"></a>      d<span class="sc">$</span>trial[i] <span class="ot">&lt;-</span> i</span>
<span id="cb456-27"><a href="categorization-models-1.html#cb456-27" tabindex="-1"></a>      d<span class="sc">$</span>choice[i] <span class="ot">&lt;-</span> choice</span>
<span id="cb456-28"><a href="categorization-models-1.html#cb456-28" tabindex="-1"></a>      d<span class="sc">$</span>value1[i] <span class="ot">&lt;-</span> value[<span class="dv">1</span>]</span>
<span id="cb456-29"><a href="categorization-models-1.html#cb456-29" tabindex="-1"></a>      d<span class="sc">$</span>value2[i] <span class="ot">&lt;-</span> value[<span class="dv">2</span>]</span>
<span id="cb456-30"><a href="categorization-models-1.html#cb456-30" tabindex="-1"></a>      d<span class="sc">$</span>feedback[i] <span class="ot">&lt;-</span> feedback</span>
<span id="cb456-31"><a href="categorization-models-1.html#cb456-31" tabindex="-1"></a>      d<span class="sc">$</span>alpha[i] <span class="ot">&lt;-</span> alpha</span>
<span id="cb456-32"><a href="categorization-models-1.html#cb456-32" tabindex="-1"></a>      d<span class="sc">$</span>temperature[i] <span class="ot">&lt;-</span> temperature</span>
<span id="cb456-33"><a href="categorization-models-1.html#cb456-33" tabindex="-1"></a>      </span>
<span id="cb456-34"><a href="categorization-models-1.html#cb456-34" tabindex="-1"></a>    }</span>
<span id="cb456-35"><a href="categorization-models-1.html#cb456-35" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;df&quot;</span>)) {df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, d)} <span class="cf">else</span> {df <span class="ot">&lt;-</span> d}</span>
<span id="cb456-36"><a href="categorization-models-1.html#cb456-36" tabindex="-1"></a></span>
<span id="cb456-37"><a href="categorization-models-1.html#cb456-37" tabindex="-1"></a>}</span>
<span id="cb456-38"><a href="categorization-models-1.html#cb456-38" tabindex="-1"></a></span>
<span id="cb456-39"><a href="categorization-models-1.html#cb456-39" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alpha, temperature) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb456-40"><a href="categorization-models-1.html#cb456-40" tabindex="-1"></a>  <span class="at">prevFeedback =</span> <span class="fu">lead</span>(feedback))</span>
<span id="cb456-41"><a href="categorization-models-1.html#cb456-41" tabindex="-1"></a></span>
<span id="cb456-42"><a href="categorization-models-1.html#cb456-42" tabindex="-1"></a><span class="do">## Create the data</span></span>
<span id="cb456-43"><a href="categorization-models-1.html#cb456-43" tabindex="-1"></a></span>
<span id="cb456-44"><a href="categorization-models-1.html#cb456-44" tabindex="-1"></a>trials <span class="ot">&lt;-</span> trials</span>
<span id="cb456-45"><a href="categorization-models-1.html#cb456-45" tabindex="-1"></a>agents <span class="ot">&lt;-</span> agents</span>
<span id="cb456-46"><a href="categorization-models-1.html#cb456-46" tabindex="-1"></a></span>
<span id="cb456-47"><a href="categorization-models-1.html#cb456-47" tabindex="-1"></a>d_choice <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb456-48"><a href="categorization-models-1.html#cb456-48" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, choice)) <span class="sc">%&gt;%</span> </span>
<span id="cb456-49"><a href="categorization-models-1.html#cb456-49" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(trials),agents)) <span class="sc">%&gt;%</span> </span>
<span id="cb456-50"><a href="categorization-models-1.html#cb456-50" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> choice)</span>
<span id="cb456-51"><a href="categorization-models-1.html#cb456-51" tabindex="-1"></a></span>
<span id="cb456-52"><a href="categorization-models-1.html#cb456-52" tabindex="-1"></a>d_feedback <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb456-53"><a href="categorization-models-1.html#cb456-53" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, feedback)) <span class="sc">%&gt;%</span> </span>
<span id="cb456-54"><a href="categorization-models-1.html#cb456-54" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(trials),agents)) <span class="sc">%&gt;%</span> </span>
<span id="cb456-55"><a href="categorization-models-1.html#cb456-55" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> feedback)</span>
<span id="cb456-56"><a href="categorization-models-1.html#cb456-56" tabindex="-1"></a></span>
<span id="cb456-57"><a href="categorization-models-1.html#cb456-57" tabindex="-1"></a></span>
<span id="cb456-58"><a href="categorization-models-1.html#cb456-58" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb456-59"><a href="categorization-models-1.html#cb456-59" tabindex="-1"></a>  <span class="at">trials =</span> trials,</span>
<span id="cb456-60"><a href="categorization-models-1.html#cb456-60" tabindex="-1"></a>  <span class="at">agents =</span> agents,</span>
<span id="cb456-61"><a href="categorization-models-1.html#cb456-61" tabindex="-1"></a>  <span class="at">choice =</span> <span class="fu">as.matrix</span>(d_choice[,<span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)]),</span>
<span id="cb456-62"><a href="categorization-models-1.html#cb456-62" tabindex="-1"></a>  <span class="at">feedback =</span> <span class="fu">as.matrix</span>(d_feedback[,<span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)])</span>
<span id="cb456-63"><a href="categorization-models-1.html#cb456-63" tabindex="-1"></a>)</span>
<span id="cb456-64"><a href="categorization-models-1.html#cb456-64" tabindex="-1"></a></span>
<span id="cb456-65"><a href="categorization-models-1.html#cb456-65" tabindex="-1"></a>data<span class="sc">$</span>choice <span class="ot">&lt;-</span> data<span class="sc">$</span>choice <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb456-66"><a href="categorization-models-1.html#cb456-66" tabindex="-1"></a></span>
<span id="cb456-67"><a href="categorization-models-1.html#cb456-67" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb456-68"><a href="categorization-models-1.html#cb456-68" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb456-69"><a href="categorization-models-1.html#cb456-69" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; trials;</span></span>
<span id="cb456-70"><a href="categorization-models-1.html#cb456-70" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; agents;</span></span>
<span id="cb456-71"><a href="categorization-models-1.html#cb456-71" tabindex="-1"></a><span class="st">  array[trials, agents] int&lt;lower=1,upper=2&gt; choice;</span></span>
<span id="cb456-72"><a href="categorization-models-1.html#cb456-72" tabindex="-1"></a><span class="st">  array[trials, agents] int&lt;lower=-1,upper=1&gt; feedback;</span></span>
<span id="cb456-73"><a href="categorization-models-1.html#cb456-73" tabindex="-1"></a><span class="st">} </span></span>
<span id="cb456-74"><a href="categorization-models-1.html#cb456-74" tabindex="-1"></a></span>
<span id="cb456-75"><a href="categorization-models-1.html#cb456-75" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb456-76"><a href="categorization-models-1.html#cb456-76" tabindex="-1"></a><span class="st">  vector[2] initValue;  // initial values for V</span></span>
<span id="cb456-77"><a href="categorization-models-1.html#cb456-77" tabindex="-1"></a><span class="st">  initValue = rep_vector(0.0, 2);</span></span>
<span id="cb456-78"><a href="categorization-models-1.html#cb456-78" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-79"><a href="categorization-models-1.html#cb456-79" tabindex="-1"></a></span>
<span id="cb456-80"><a href="categorization-models-1.html#cb456-80" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb456-81"><a href="categorization-models-1.html#cb456-81" tabindex="-1"></a><span class="st">  real alphaM; // learning rate</span></span>
<span id="cb456-82"><a href="categorization-models-1.html#cb456-82" tabindex="-1"></a><span class="st">  real temperatureM; // softmax inv.temp.</span></span>
<span id="cb456-83"><a href="categorization-models-1.html#cb456-83" tabindex="-1"></a><span class="st">  vector&lt;lower = 0&gt;[2] tau;</span></span>
<span id="cb456-84"><a href="categorization-models-1.html#cb456-84" tabindex="-1"></a><span class="st">  matrix[2, agents] z_IDs;</span></span>
<span id="cb456-85"><a href="categorization-models-1.html#cb456-85" tabindex="-1"></a><span class="st">  cholesky_factor_corr[2] L_u;</span></span>
<span id="cb456-86"><a href="categorization-models-1.html#cb456-86" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-87"><a href="categorization-models-1.html#cb456-87" tabindex="-1"></a></span>
<span id="cb456-88"><a href="categorization-models-1.html#cb456-88" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb456-89"><a href="categorization-models-1.html#cb456-89" tabindex="-1"></a><span class="st">  matrix[agents,2] IDs;</span></span>
<span id="cb456-90"><a href="categorization-models-1.html#cb456-90" tabindex="-1"></a><span class="st">  IDs = (diag_pre_multiply(tau, L_u) * z_IDs)&#39;;</span></span>
<span id="cb456-91"><a href="categorization-models-1.html#cb456-91" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-92"><a href="categorization-models-1.html#cb456-92" tabindex="-1"></a></span>
<span id="cb456-93"><a href="categorization-models-1.html#cb456-93" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb456-94"><a href="categorization-models-1.html#cb456-94" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-95"><a href="categorization-models-1.html#cb456-95" tabindex="-1"></a><span class="st">  real pe;</span></span>
<span id="cb456-96"><a href="categorization-models-1.html#cb456-96" tabindex="-1"></a><span class="st">  vector[2] value;</span></span>
<span id="cb456-97"><a href="categorization-models-1.html#cb456-97" tabindex="-1"></a><span class="st">  vector[2] theta;</span></span>
<span id="cb456-98"><a href="categorization-models-1.html#cb456-98" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-99"><a href="categorization-models-1.html#cb456-99" tabindex="-1"></a><span class="st">  target += normal_lpdf(alphaM | 0, 1);</span></span>
<span id="cb456-100"><a href="categorization-models-1.html#cb456-100" tabindex="-1"></a><span class="st">  target += normal_lpdf(temperatureM | 0, 1);</span></span>
<span id="cb456-101"><a href="categorization-models-1.html#cb456-101" tabindex="-1"></a><span class="st">  target += normal_lpdf(tau[1] | 0, .3)  -</span></span>
<span id="cb456-102"><a href="categorization-models-1.html#cb456-102" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb456-103"><a href="categorization-models-1.html#cb456-103" tabindex="-1"></a><span class="st">  target += normal_lpdf(tau[2] | 0, .3)  -</span></span>
<span id="cb456-104"><a href="categorization-models-1.html#cb456-104" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb456-105"><a href="categorization-models-1.html#cb456-105" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-106"><a href="categorization-models-1.html#cb456-106" tabindex="-1"></a><span class="st">  target += lkj_corr_cholesky_lpdf(L_u | 2);</span></span>
<span id="cb456-107"><a href="categorization-models-1.html#cb456-107" tabindex="-1"></a><span class="st">  target += std_normal_lpdf(to_vector(z_IDs));</span></span>
<span id="cb456-108"><a href="categorization-models-1.html#cb456-108" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-109"><a href="categorization-models-1.html#cb456-109" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb456-110"><a href="categorization-models-1.html#cb456-110" tabindex="-1"></a><span class="st">    value = initValue;</span></span>
<span id="cb456-111"><a href="categorization-models-1.html#cb456-111" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb456-112"><a href="categorization-models-1.html#cb456-112" tabindex="-1"></a><span class="st">    for (t in 1:trials) {</span></span>
<span id="cb456-113"><a href="categorization-models-1.html#cb456-113" tabindex="-1"></a><span class="st">      theta = softmax( inv_logit(temperatureM + IDs[agent,2]) * 20 * value); // action prob. computed via softmax</span></span>
<span id="cb456-114"><a href="categorization-models-1.html#cb456-114" tabindex="-1"></a><span class="st">      target += categorical_lpmf(choice[t, agent] | theta);</span></span>
<span id="cb456-115"><a href="categorization-models-1.html#cb456-115" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb456-116"><a href="categorization-models-1.html#cb456-116" tabindex="-1"></a><span class="st">      pe = feedback[t, agent] - value[choice[t, agent]]; // compute pe for chosen value only</span></span>
<span id="cb456-117"><a href="categorization-models-1.html#cb456-117" tabindex="-1"></a><span class="st">      value[choice[t, agent]] = value[choice[t, agent]] + inv_logit(alphaM + IDs[agent,1]) * pe; // update chosen V</span></span>
<span id="cb456-118"><a href="categorization-models-1.html#cb456-118" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb456-119"><a href="categorization-models-1.html#cb456-119" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb456-120"><a href="categorization-models-1.html#cb456-120" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb456-121"><a href="categorization-models-1.html#cb456-121" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb456-122"><a href="categorization-models-1.html#cb456-122" tabindex="-1"></a></span>
<span id="cb456-123"><a href="categorization-models-1.html#cb456-123" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb456-124"><a href="categorization-models-1.html#cb456-124" tabindex="-1"></a></span>
<span id="cb456-125"><a href="categorization-models-1.html#cb456-125" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb456-126"><a href="categorization-models-1.html#cb456-126" tabindex="-1"></a>  stan_model,</span>
<span id="cb456-127"><a href="categorization-models-1.html#cb456-127" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb456-128"><a href="categorization-models-1.html#cb456-128" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W11_RL_multilevel.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W11_RL_multilevel.stan&quot;</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="categorization-models-1.html#cb458-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W11_RL_multilevel.stan&quot;</span>)</span>
<span id="cb458-2"><a href="categorization-models-1.html#cb458-2" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb458-3"><a href="categorization-models-1.html#cb458-3" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>), <span class="at">pedantic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb458-4"><a href="categorization-models-1.html#cb458-4" tabindex="-1"></a></span>
<span id="cb458-5"><a href="categorization-models-1.html#cb458-5" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb458-6"><a href="categorization-models-1.html#cb458-6" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb458-7"><a href="categorization-models-1.html#cb458-7" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb458-8"><a href="categorization-models-1.html#cb458-8" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb458-9"><a href="categorization-models-1.html#cb458-9" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb458-10"><a href="categorization-models-1.html#cb458-10" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb458-11"><a href="categorization-models-1.html#cb458-11" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb458-12"><a href="categorization-models-1.html#cb458-12" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb458-13"><a href="categorization-models-1.html#cb458-13" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">1000</span>,</span>
<span id="cb458-14"><a href="categorization-models-1.html#cb458-14" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">&quot;simmodels&quot;</span>,</span>
<span id="cb458-15"><a href="categorization-models-1.html#cb458-15" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb458-16"><a href="categorization-models-1.html#cb458-16" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb458-17"><a href="categorization-models-1.html#cb458-17" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 4000 [  0%]  (Warmup)</code></pre>
<pre><code>## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 1 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 1</code></pre>
<pre><code>## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 1 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 1</code></pre>
<pre><code>## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 1 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 1</code></pre>
<pre><code>## Chain 2 Iteration:    1 / 4000 [  0%]  (Warmup)</code></pre>
<pre><code>## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 2 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 2</code></pre>
<pre><code>## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 2 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 2</code></pre>
<pre><code>## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 2 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 2</code></pre>
<pre><code>## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 2 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 2</code></pre>
<pre><code>## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 1 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 1</code></pre>
<pre><code>## Chain 1 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
## Chain 2 Iteration: 1000 / 4000 [ 25%]  (Warmup)</code></pre>
<pre><code>## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 1 Exception: lkj_corr_cholesky_lpdf: Random variable[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpP3dlfk/model-47d0691c5d7c.stan&#39;, line 40, column 2 to column 44)</code></pre>
<pre><code>## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 1</code></pre>
<pre><code>## Chain 1 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 4000 / 4000 [100%]  (Sampling) 
## Chain 1 finished in 1616.0 seconds.
## Chain 2 Iteration: 4000 / 4000 [100%]  (Sampling) 
## Chain 2 finished in 9821.7 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 5718.9 seconds.
## Total execution time: 9821.6 seconds.</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="categorization-models-1.html#cb508-1" tabindex="-1"></a><span class="co"># Same the fitted model</span></span>
<span id="cb508-2"><a href="categorization-models-1.html#cb508-2" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/W11_RL_multilevel.rds&quot;</span>)</span></code></pre></div>
<p>[Missing discussion of alternative models of RL: counterfactual learning, sequential learning, etc.]</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="categorization-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/11-ReinforcementLearning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
