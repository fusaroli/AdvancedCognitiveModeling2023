<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Categorization models | 10-CategorizationModels</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Categorization models | 10-CategorizationModels" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Categorization models | 10-CategorizationModels" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2023" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2023-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-models-of-cognition.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-goal-of-the-course"><i class="fa fa-check"></i><b>1.1</b> The goal of the course</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#list-of-lectures-and-practical-exercises"><i class="fa fa-check"></i><b>1.2</b> List of lectures and practical exercises</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation-before-the-course"><i class="fa fa-check"></i><b>1.3</b> Preparation before the course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Practical exercise 1 - Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a></li>
<li class="chapter" data-level="2.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#strategies"><i class="fa fa-check"></i><b>2.4</b> Strategies</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.4.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.4.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.4.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.4.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.4.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.4.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.4.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.4.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.4.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.4.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.4.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.5</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.5.1</b> Memory</a></li>
<li class="chapter" data-level="2.5.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.5.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.6</b> Continuity between models</a></li>
<li class="chapter" data-level="2.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.7</b> Mixture of strategies</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> Practical exercise 2 - From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.1</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.2" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.2</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.4" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.4</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.4.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#data"><i class="fa fa-check"></i><b>4.3.1</b> Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#model"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>4.3.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="4.3.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-model"><i class="fa fa-check"></i><b>4.3.4</b> Summarizing the model</a></li>
<li class="chapter" data-level="4.3.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#assessing-model-quality"><i class="fa fa-check"></i><b>4.3.5</b> Assessing model quality</a></li>
<li class="chapter" data-level="4.3.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results"><i class="fa fa-check"></i><b>4.3.6</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>4.5.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>4.6</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>4.6.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html"><i class="fa fa-check"></i><b>5</b> Practical exercise 4 - Model quality checks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>5.1</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="5.2" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-priors"><i class="fa fa-check"></i><b>5.2</b> Assessing priors</a></li>
<li class="chapter" data-level="5.3" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-prior-and-posterior-predictions"><i class="fa fa-check"></i><b>5.3</b> Assessing prior and posterior predictions</a></li>
<li class="chapter" data-level="5.4" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="5.5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#the-memory-model"><i class="fa fa-check"></i><b>5.5</b> The memory model</a></li>
<li class="chapter" data-level="5.6" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>5.6</b> Prior sensitivity check for the memory model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html"><i class="fa fa-check"></i><b>6</b> Multilevel modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#intro-to-multilevel-modeling"><i class="fa fa-check"></i><b>6.1</b> Intro to multilevel modeling</a></li>
<li class="chapter" data-level="6.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent"><i class="fa fa-check"></i><b>6.2</b> A multilevel version of the biased agent and of the simple memory agent</a></li>
<li class="chapter" data-level="6.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>6.3</b> Generating the agents</a></li>
<li class="chapter" data-level="6.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>6.4</b> Plotting the agents</a></li>
<li class="chapter" data-level="6.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>6.5</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>6.5.1</b> Multilevel random</a></li>
<li class="chapter" data-level="6.5.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>6.5.2</b> Assessing multilevel random agents</a></li>
<li class="chapter" data-level="6.5.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory"><i class="fa fa-check"></i><b>6.5.3</b> Multilevel memory</a></li>
<li class="chapter" data-level="6.5.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>6.5.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>6.5.5</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="6.5.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>6.5.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.7" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>6.5.7</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="6.5.8" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>6.5.8</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.9" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-no-pooling"><i class="fa fa-check"></i><b>6.5.9</b> Multilevel memory no pooling</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-full-pooling"><i class="fa fa-check"></i><b>6.6</b> Multilevel full pooling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>7</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model-comparison.html"><a href="model-comparison.html#define-parameters"><i class="fa fa-check"></i><b>7.1</b> Define parameters</a></li>
<li class="chapter" data-level="7.2" data-path="model-comparison.html"><a href="model-comparison.html#define-biased-and-memory-agents"><i class="fa fa-check"></i><b>7.2</b> Define biased and memory agents</a></li>
<li class="chapter" data-level="7.3" data-path="model-comparison.html"><a href="model-comparison.html#generating-the-agents-1"><i class="fa fa-check"></i><b>7.3</b> Generating the agents</a></li>
<li class="chapter" data-level="7.4" data-path="model-comparison.html"><a href="model-comparison.html#prep-the-data"><i class="fa fa-check"></i><b>7.4</b> Prep the data</a></li>
<li class="chapter" data-level="7.5" data-path="model-comparison.html"><a href="model-comparison.html#log-posterior-likelihood"><i class="fa fa-check"></i><b>7.5</b> Log posterior likelihood</a></li>
<li class="chapter" data-level="7.6" data-path="model-comparison.html"><a href="model-comparison.html#create-the-models-multilevel-biased-agents"><i class="fa fa-check"></i><b>7.6</b> Create the models: multilevel biased agents</a></li>
<li class="chapter" data-level="7.7" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-memory-model"><i class="fa fa-check"></i><b>7.7</b> Multilevel memory model</a></li>
<li class="chapter" data-level="7.8" data-path="model-comparison.html"><a href="model-comparison.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>7.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="7.9" data-path="model-comparison.html"><a href="model-comparison.html#calculating-the-expected-log-predictive-density-of-a-model"><i class="fa fa-check"></i><b>7.9</b> Calculating the expected log predictive density of a model</a></li>
<li class="chapter" data-level="7.10" data-path="model-comparison.html"><a href="model-comparison.html#implementing-cross-validation"><i class="fa fa-check"></i><b>7.10</b> Implementing Cross-Validation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-biased-agents"><i class="fa fa-check"></i><b>7.10.1</b> Create cross-validation ready stan model for biased agents</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-memory-agents"><i class="fa fa-check"></i><b>7.10.2</b> Create cross-validation ready stan model for memory agents</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="model-comparison.html"><a href="model-comparison.html#calculating-elpd-and-comparing"><i class="fa fa-check"></i><b>7.11</b> Calculating elpd and comparing</a></li>
<li class="chapter" data-level="7.12" data-path="model-comparison.html"><a href="model-comparison.html#limitations-of-model-comparison-techniques"><i class="fa fa-check"></i><b>7.12</b> Limitations of model comparison techniques</a></li>
<li class="chapter" data-level="7.13" data-path="model-comparison.html"><a href="model-comparison.html#mixture-models"><i class="fa fa-check"></i><b>7.13</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="model-comparison.html"><a href="model-comparison.html#load-the-dataset"><i class="fa fa-check"></i><b>7.13.1</b> Load the dataset</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="model-comparison.html"><a href="model-comparison.html#stan-model-mixing-biased-and-noise"><i class="fa fa-check"></i><b>7.14</b> Stan model mixing biased and noise</a></li>
<li class="chapter" data-level="7.15" data-path="model-comparison.html"><a href="model-comparison.html#fitting-and-assessing-the-model"><i class="fa fa-check"></i><b>7.15</b> Fitting and assessing the model</a></li>
<li class="chapter" data-level="7.16" data-path="model-comparison.html"><a href="model-comparison.html#basic-evaluation"><i class="fa fa-check"></i><b>7.16</b> Basic evaluation</a></li>
<li class="chapter" data-level="7.17" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-mixture-model"><i class="fa fa-check"></i><b>7.17</b> Multilevel mixture model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html"><i class="fa fa-check"></i><b>8</b> Bonus chapter: Additional models developed by students</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#additional-models"><i class="fa fa-check"></i><b>8.1</b> Additional models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.1</b> Probabilistic Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-asymmetric-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.2</b> Probabilistic asymmetric Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-rate"><i class="fa fa-check"></i><b>8.1.3</b> Memory agent with exponential memory decay (rate)</a></li>
<li class="chapter" data-level="8.1.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-exponential"><i class="fa fa-check"></i><b>8.1.4</b> Memory agent with exponential memory decay (exponential)</a></li>
<li class="chapter" data-level="8.1.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-but-separate-memory-for-wins-and-losses"><i class="fa fa-check"></i><b>8.1.5</b> Memory agent with exponential memory decay, but separate memory for wins and losses</a></li>
<li class="chapter" data-level="8.1.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-and-with-confidence"><i class="fa fa-check"></i><b>8.1.6</b> Memory agent with exponential memory decay, and with confidence</a></li>
<li class="chapter" data-level="8.1.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#reinforcement-learning-rescorla-wagner"><i class="fa fa-check"></i><b>8.1.7</b> Reinforcement learning (Rescorla Wagner)</a></li>
<li class="chapter" data-level="8.1.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#hierarchical-gaussian-filter"><i class="fa fa-check"></i><b>8.1.8</b> Hierarchical gaussian filter</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#implementing-the-wsls-model"><i class="fa fa-check"></i><b>8.2</b> Implementing the WSLS model</a></li>
<li class="chapter" data-level="8.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#load-packages"><i class="fa fa-check"></i><b>8.3</b> Load packages</a></li>
<li class="chapter" data-level="8.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#generate-data"><i class="fa fa-check"></i><b>8.4</b> Generate data</a></li>
<li class="chapter" data-level="8.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#sanity-check-for-the-data"><i class="fa fa-check"></i><b>8.5</b> Sanity check for the data</a></li>
<li class="chapter" data-level="8.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#more-sanity-check"><i class="fa fa-check"></i><b>8.6</b> More sanity check</a></li>
<li class="chapter" data-level="8.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-data-for-single-agent-model"><i class="fa fa-check"></i><b>8.7</b> Create data for single agent model</a></li>
<li class="chapter" data-level="8.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model"><i class="fa fa-check"></i><b>8.8</b> Create the model</a></li>
<li class="chapter" data-level="8.9" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#basic-assessment"><i class="fa fa-check"></i><b>8.9</b> Basic assessment</a></li>
<li class="chapter" data-level="8.10" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-multilevel-data"><i class="fa fa-check"></i><b>8.10</b> Create multilevel data</a></li>
<li class="chapter" data-level="8.11" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model-1"><i class="fa fa-check"></i><b>8.11</b> Create the model</a></li>
<li class="chapter" data-level="8.12" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#quality-checks"><i class="fa fa-check"></i><b>8.12</b> Quality checks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>9</b> Bayesian models of cognition</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#load-the-packages"><i class="fa fa-check"></i><b>9.1</b> Load the packages</a></li>
<li class="chapter" data-level="9.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#design-the-model"><i class="fa fa-check"></i><b>9.2</b> Design the model</a></li>
<li class="chapter" data-level="9.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-data"><i class="fa fa-check"></i><b>9.3</b> Create the data</a></li>
<li class="chapter" data-level="9.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize"><i class="fa fa-check"></i><b>9.4</b> Visualize</a></li>
<li class="chapter" data-level="9.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#data-for-stan"><i class="fa fa-check"></i><b>9.5</b> Data for Stan</a></li>
<li class="chapter" data-level="9.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-stan-model"><i class="fa fa-check"></i><b>9.6</b> Create the Stan Model</a></li>
<li class="chapter" data-level="9.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-model"><i class="fa fa-check"></i><b>9.7</b> Fitting the model</a></li>
<li class="chapter" data-level="9.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#basic-evaluation-1"><i class="fa fa-check"></i><b>9.8</b> Basic evaluation</a></li>
<li class="chapter" data-level="9.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayes"><i class="fa fa-check"></i><b>9.9</b> Weighted Bayes</a></li>
<li class="chapter" data-level="9.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize-1"><i class="fa fa-check"></i><b>9.10</b> Visualize</a></li>
<li class="chapter" data-level="9.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-the-weighted-bayes-stan-model-simple-formula"><i class="fa fa-check"></i><b>9.11</b> Build the Weighted Bayes Stan model (simple formula)</a></li>
<li class="chapter" data-level="9.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-evaluation"><i class="fa fa-check"></i><b>9.12</b> Model evaluation</a></li>
<li class="chapter" data-level="9.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-recovery"><i class="fa fa-check"></i><b>9.13</b> Model recovery</a></li>
<li class="chapter" data-level="9.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel"><i class="fa fa-check"></i><b>9.14</b> Multilevel</a></li>
<li class="chapter" data-level="9.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bonus-build-the-weighted-bayes-stan-model-fancier-formula"><i class="fa fa-check"></i><b>9.15</b> Bonus: Build the Weighted Bayes Stan model (fancier formula)</a></li>
<li class="chapter" data-level="9.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluation"><i class="fa fa-check"></i><b>9.16</b> Evaluation</a></li>
<li class="chapter" data-level="9.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-a-temporal-bayes-storing-current-belief-as-prior-for-next-turn"><i class="fa fa-check"></i><b>9.17</b> Build a temporal Bayes (storing current belief as prior for next turn)</a></li>
<li class="chapter" data-level="9.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluate"><i class="fa fa-check"></i><b>9.18</b> Evaluate</a></li>
<li class="chapter" data-level="9.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-simple-bayes-model"><i class="fa fa-check"></i><b>9.19</b> Multilevel version of the simple bayes model</a></li>
<li class="chapter" data-level="9.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-weighted-bayes-model"><i class="fa fa-check"></i><b>9.20</b> Multilevel version of the weighted bayes model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="categorization-models.html"><a href="categorization-models.html"><i class="fa fa-check"></i><b>10</b> Categorization models</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">10-CategorizationModels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorization-models" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Categorization models<a href="categorization-models.html#categorization-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this module the course covers formal models of categorization. In particular, here we implement a version of the Generalized Context Model (from now on GCM).</p>
<p>[MISSING: INTRODUCTION TO THE GCM]</p>
<p>In order to understand the GCM, we will rely on a setup from Kruschke 1993. Participants go through 8 blocks of trials. Within each block, participants see 8 stimuli, the same across every block. Each stimulus has to be categorised (classified) as belonging to either category A or category B. After categorizing a stimulus, feedback is given, so that the participant knows which category the stimulus truly belongs to.</p>
<p>The stimuli differ along two continuous dimensions (more specifically the height of a square and the position of a line with it).</p>
<p>Following on the structure in Kruschke 1993, we need to start simulating data. Let’s start with the stimuli.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="categorization-models.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the stimuli, their height and position features, and their category</span></span>
<span id="cb393-2"><a href="categorization-models.html#cb393-2" aria-hidden="true" tabindex="-1"></a>stimulus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>)</span>
<span id="cb393-3"><a href="categorization-models.html#cb393-3" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">3</span>, <span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb393-4"><a href="categorization-models.html#cb393-4" aria-hidden="true" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb393-5"><a href="categorization-models.html#cb393-5" aria-hidden="true" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb393-6"><a href="categorization-models.html#cb393-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-7"><a href="categorization-models.html#cb393-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Making this into a tibble</span></span>
<span id="cb393-8"><a href="categorization-models.html#cb393-8" aria-hidden="true" tabindex="-1"></a>stimuli <span class="ot">&lt;-</span> <span class="fu">tibble</span>(stimulus, height, position, category)</span>
<span id="cb393-9"><a href="categorization-models.html#cb393-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-10"><a href="categorization-models.html#cb393-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting to make sure all looks right</span></span>
<span id="cb393-11"><a href="categorization-models.html#cb393-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stimuli, <span class="fu">aes</span>(position, height, <span class="at">color =</span> category, <span class="at">label =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb393-12"><a href="categorization-models.html#cb393-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb393-13"><a href="categorization-models.html#cb393-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb393-14"><a href="categorization-models.html#cb393-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb393-15"><a href="categorization-models.html#cb393-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="categorization-models.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating the sequence of stimuli in the full experiment</span></span>
<span id="cb394-2"><a href="categorization-models.html#cb394-2" aria-hidden="true" tabindex="-1"></a>sequence <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb394-3"><a href="categorization-models.html#cb394-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb394-4"><a href="categorization-models.html#cb394-4" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">8</span>), <span class="dv">8</span>, <span class="at">replace =</span> F)</span>
<span id="cb394-5"><a href="categorization-models.html#cb394-5" aria-hidden="true" tabindex="-1"></a>  sequence <span class="ot">&lt;-</span> <span class="fu">append</span>(sequence, temp)</span>
<span id="cb394-6"><a href="categorization-models.html#cb394-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb394-7"><a href="categorization-models.html#cb394-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-8"><a href="categorization-models.html#cb394-8" aria-hidden="true" tabindex="-1"></a>experiment <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">stimulus =</span> sequence, <span class="at">height =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="cn">NA</span>, <span class="at">category =</span> <span class="cn">NA</span>)</span>
<span id="cb394-9"><a href="categorization-models.html#cb394-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment))) {</span>
<span id="cb394-10"><a href="categorization-models.html#cb394-10" aria-hidden="true" tabindex="-1"></a>  experiment<span class="sc">$</span>height[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>height[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb394-11"><a href="categorization-models.html#cb394-11" aria-hidden="true" tabindex="-1"></a>  experiment<span class="sc">$</span>position[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>position[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb394-12"><a href="categorization-models.html#cb394-12" aria-hidden="true" tabindex="-1"></a>  experiment<span class="sc">$</span>category[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(stimuli<span class="sc">$</span>category[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]))</span>
<span id="cb394-13"><a href="categorization-models.html#cb394-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We then have to simulate an agent using the GCM to assess the stimuli.
N.B. code based on work by Sara Østergaard</p>
<p>First we define functions for distance and similarity and assess them.
Distance takes feature values along n dimensions and calculate their euclidean distance,
weighing dimensions according to pregiven weights (w).
Similarity decays exponentially with distance, with a pre-given exponent (c). See plot.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="categorization-models.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance </span></span>
<span id="cb395-2"><a href="categorization-models.html#cb395-2" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="cf">function</span>(vect1, vect2, w) {</span>
<span id="cb395-3"><a href="categorization-models.html#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(w <span class="sc">*</span> <span class="fu">abs</span>(vect1 <span class="sc">-</span> vect2)))</span>
<span id="cb395-4"><a href="categorization-models.html#cb395-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb395-5"><a href="categorization-models.html#cb395-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-6"><a href="categorization-models.html#cb395-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Similarity</span></span>
<span id="cb395-7"><a href="categorization-models.html#cb395-7" aria-hidden="true" tabindex="-1"></a>similarity <span class="ot">&lt;-</span> <span class="cf">function</span>(distance, c) {</span>
<span id="cb395-8"><a href="categorization-models.html#cb395-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>c <span class="sc">*</span> distance))</span>
<span id="cb395-9"><a href="categorization-models.html#cb395-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb395-10"><a href="categorization-models.html#cb395-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-11"><a href="categorization-models.html#cb395-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s assess similarity</span></span>
<span id="cb395-12"><a href="categorization-models.html#cb395-12" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb395-13"><a href="categorization-models.html#cb395-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb395-14"><a href="categorization-models.html#cb395-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>,.<span class="dv">2</span>, .<span class="dv">3</span>,.<span class="dv">4</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), </span>
<span id="cb395-15"><a href="categorization-models.html#cb395-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb395-16"><a href="categorization-models.html#cb395-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb395-17"><a href="categorization-models.html#cb395-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">similarity =</span> <span class="fu">similarity</span>(distance, c)</span>
<span id="cb395-18"><a href="categorization-models.html#cb395-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb395-19"><a href="categorization-models.html#cb395-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-20"><a href="categorization-models.html#cb395-20" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb395-21"><a href="categorization-models.html#cb395-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb395-22"><a href="categorization-models.html#cb395-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(distance, similarity, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span> </span>
<span id="cb395-23"><a href="categorization-models.html#cb395-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="categorization-models.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
<p>With distance and similarity in place, we now need to implement an agent that can observe stimuli,
put them into categories according to feedback and - once enough stimuli are collected to have at
least one exemplar in each category - compare stimuli to exemplars in each category and assess
which category is more likely.
In other words: 1) if not enough stimuli have already been observed, the agent picks a category at random,
receives feedback and adjusts accordingly the category; otherwise, 2) it assesses average distance (according to weights) from observed exemplars by category; calculates similarity (according to c); and uses the relative similarity to the two categories to produce a probability of choosing category one. then it receives feedback and adjusts category accordingly.</p>
<p>As usual we make the agent a function, so that we can more easily deploy it.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="categorization-models.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="do">### generative model </span><span class="al">###</span></span>
<span id="cb397-2"><a href="categorization-models.html#cb397-2" aria-hidden="true" tabindex="-1"></a>gcm <span class="ot">&lt;-</span> <span class="cf">function</span>(w, c, obs, cat_one, <span class="at">quiet =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb397-3"><a href="categorization-models.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create an empty list to save probability of saying &quot;1&quot; for each trial</span></span>
<span id="cb397-4"><a href="categorization-models.html#cb397-4" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb397-5"><a href="categorization-models.html#cb397-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb397-6"><a href="categorization-models.html#cb397-6" aria-hidden="true" tabindex="-1"></a>  ntrials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb397-7"><a href="categorization-models.html#cb397-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb397-8"><a href="categorization-models.html#cb397-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ntrials) {</span>
<span id="cb397-9"><a href="categorization-models.html#cb397-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If quiet is FALSE, print every ten trials</span></span>
<span id="cb397-10"><a href="categorization-models.html#cb397-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>quiet <span class="sc">&amp;&amp;</span> i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb397-11"><a href="categorization-models.html#cb397-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;i =&quot;</span>, i))</span>
<span id="cb397-12"><a href="categorization-models.html#cb397-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb397-13"><a href="categorization-models.html#cb397-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if this is the first trial, or there any category with no exemplars seen yet, set the choice to random</span></span>
<span id="cb397-14"><a href="categorization-models.html#cb397-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> (i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb397-15"><a href="categorization-models.html#cb397-15" aria-hidden="true" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, .<span class="dv">5</span>)</span>
<span id="cb397-16"><a href="categorization-models.html#cb397-16" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb397-17"><a href="categorization-models.html#cb397-17" aria-hidden="true" tabindex="-1"></a>      similarities <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb397-18"><a href="categorization-models.html#cb397-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># for each previously seen stimulus assess distance and similarity</span></span>
<span id="cb397-19"><a href="categorization-models.html#cb397-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (e <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb397-20"><a href="categorization-models.html#cb397-20" aria-hidden="true" tabindex="-1"></a>        sim <span class="ot">&lt;-</span> <span class="fu">similarity</span>(<span class="fu">distance</span>(obs[i, ], obs[e, ], w), c)</span>
<span id="cb397-21"><a href="categorization-models.html#cb397-21" aria-hidden="true" tabindex="-1"></a>        similarities <span class="ot">&lt;-</span> <span class="fu">c</span>(similarities, sim)</span>
<span id="cb397-22"><a href="categorization-models.html#cb397-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb397-23"><a href="categorization-models.html#cb397-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate prob of saying &quot;1&quot; by dividing similarity to 1 by the sum of similarity to 1 and to 2</span></span>
<span id="cb397-24"><a href="categorization-models.html#cb397-24" aria-hidden="true" tabindex="-1"></a>      numerator <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb397-25"><a href="categorization-models.html#cb397-25" aria-hidden="true" tabindex="-1"></a>      denominator <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb397-26"><a href="categorization-models.html#cb397-26" aria-hidden="true" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, numerator <span class="sc">/</span> denominator)</span>
<span id="cb397-27"><a href="categorization-models.html#cb397-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb397-28"><a href="categorization-models.html#cb397-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb397-29"><a href="categorization-models.html#cb397-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-30"><a href="categorization-models.html#cb397-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(ntrials, <span class="dv">1</span>, r))</span>
<span id="cb397-31"><a href="categorization-models.html#cb397-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With the agent in place, we can now simulate behavior on our simulated stimuli and observe the impact of different weights and scaling parameters c.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="categorization-models.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for simulation responses</span></span>
<span id="cb398-2"><a href="categorization-models.html#cb398-2" aria-hidden="true" tabindex="-1"></a>simulate_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, w, c) {</span>
<span id="cb398-3"><a href="categorization-models.html#cb398-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb398-4"><a href="categorization-models.html#cb398-4" aria-hidden="true" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb398-5"><a href="categorization-models.html#cb398-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))</span>
<span id="cb398-6"><a href="categorization-models.html#cb398-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb398-7"><a href="categorization-models.html#cb398-7" aria-hidden="true" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category</span>
<span id="cb398-8"><a href="categorization-models.html#cb398-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb398-9"><a href="categorization-models.html#cb398-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;equal&quot;</span>) {</span>
<span id="cb398-10"><a href="categorization-models.html#cb398-10" aria-hidden="true" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb398-11"><a href="categorization-models.html#cb398-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed1&quot;</span>) {</span>
<span id="cb398-12"><a href="categorization-models.html#cb398-12" aria-hidden="true" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb398-13"><a href="categorization-models.html#cb398-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed2&quot;</span>) {</span>
<span id="cb398-14"><a href="categorization-models.html#cb398-14" aria-hidden="true" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)</span>
<span id="cb398-15"><a href="categorization-models.html#cb398-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb398-16"><a href="categorization-models.html#cb398-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-17"><a href="categorization-models.html#cb398-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate responses</span></span>
<span id="cb398-18"><a href="categorization-models.html#cb398-18" aria-hidden="true" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">gcm</span>(</span>
<span id="cb398-19"><a href="categorization-models.html#cb398-19" aria-hidden="true" tabindex="-1"></a>        weight,</span>
<span id="cb398-20"><a href="categorization-models.html#cb398-20" aria-hidden="true" tabindex="-1"></a>        c,</span>
<span id="cb398-21"><a href="categorization-models.html#cb398-21" aria-hidden="true" tabindex="-1"></a>        observations,</span>
<span id="cb398-22"><a href="categorization-models.html#cb398-22" aria-hidden="true" tabindex="-1"></a>        category</span>
<span id="cb398-23"><a href="categorization-models.html#cb398-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb398-24"><a href="categorization-models.html#cb398-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb398-25"><a href="categorization-models.html#cb398-25" aria-hidden="true" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb398-26"><a href="categorization-models.html#cb398-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb398-27"><a href="categorization-models.html#cb398-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">trial =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment)),</span>
<span id="cb398-28"><a href="categorization-models.html#cb398-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb398-29"><a href="categorization-models.html#cb398-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb398-30"><a href="categorization-models.html#cb398-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> <span class="fu">seq_along</span>(correct),</span>
<span id="cb398-31"><a href="categorization-models.html#cb398-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">c =</span> c,</span>
<span id="cb398-32"><a href="categorization-models.html#cb398-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">w =</span> w,</span>
<span id="cb398-33"><a href="categorization-models.html#cb398-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb398-34"><a href="categorization-models.html#cb398-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb398-35"><a href="categorization-models.html#cb398-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-36"><a href="categorization-models.html#cb398-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb398-37"><a href="categorization-models.html#cb398-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb398-38"><a href="categorization-models.html#cb398-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-39"><a href="categorization-models.html#cb398-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-40"><a href="categorization-models.html#cb398-40" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate responses</span></span>
<span id="cb398-41"><a href="categorization-models.html#cb398-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb398-42"><a href="categorization-models.html#cb398-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-43"><a href="categorization-models.html#cb398-43" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb398-44"><a href="categorization-models.html#cb398-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_grid</span>(</span>
<span id="cb398-45"><a href="categorization-models.html#cb398-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">agent =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb398-46"><a href="categorization-models.html#cb398-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">c =</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.2</span>),</span>
<span id="cb398-47"><a href="categorization-models.html#cb398-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">w =</span> <span class="fu">c</span>(<span class="st">&quot;equal&quot;</span>, <span class="st">&quot;skewed1&quot;</span>, <span class="st">&quot;skewed2&quot;</span>)</span>
<span id="cb398-48"><a href="categorization-models.html#cb398-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb398-49"><a href="categorization-models.html#cb398-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb398-50"><a href="categorization-models.html#cb398-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-51"><a href="categorization-models.html#cb398-51" aria-hidden="true" tabindex="-1"></a>simulated_responses <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(param_df,</span>
<span id="cb398-52"><a href="categorization-models.html#cb398-52" aria-hidden="true" tabindex="-1"></a>    simulate_responses,</span>
<span id="cb398-53"><a href="categorization-models.html#cb398-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb398-54"><a href="categorization-models.html#cb398-54" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>And now we can try a few plots to better understand how the model fares and the difference made by weights and scaling factors.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="categorization-models.html#cb399-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb399-2"><a href="categorization-models.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">w =</span> <span class="fu">as.factor</span>(w)) <span class="sc">%&gt;%</span></span>
<span id="cb399-3"><a href="categorization-models.html#cb399-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> w, <span class="at">color =</span> w)) <span class="sc">+</span></span>
<span id="cb399-4"><a href="categorization-models.html#cb399-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb399-5"><a href="categorization-models.html#cb399-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb399-6"><a href="categorization-models.html#cb399-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(c <span class="sc">~</span> .)</span>
<span id="cb399-7"><a href="categorization-models.html#cb399-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-8"><a href="categorization-models.html#cb399-8" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb399-9"><a href="categorization-models.html#cb399-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb399-10"><a href="categorization-models.html#cb399-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span></span>
<span id="cb399-11"><a href="categorization-models.html#cb399-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb399-12"><a href="categorization-models.html#cb399-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb399-13"><a href="categorization-models.html#cb399-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(w <span class="sc">~</span> .)</span>
<span id="cb399-14"><a href="categorization-models.html#cb399-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-15"><a href="categorization-models.html#cb399-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="categorization-models.html#cb401-1" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb401-2"><a href="categorization-models.html#cb401-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb401-3"><a href="categorization-models.html#cb401-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(st, performance, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span></span>
<span id="cb401-4"><a href="categorization-models.html#cb401-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb401-5"><a href="categorization-models.html#cb401-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb401-6"><a href="categorization-models.html#cb401-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(w <span class="sc">~</span> .)</span></code></pre></div>
<p>[MISSING: Discussion of how to make sense of the plots: Equal Weights (matching the actual rule) generating better decisions as long as c is above 1]</p>
<p>While we could try different scenarios, let us now move on to inference. We need to build the same GCM model in Stan.</p>
<p>[MISSING: MORE DETAILED EXPLANATION]</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="categorization-models.html#cb402-1" aria-hidden="true" tabindex="-1"></a>gcm_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb402-2"><a href="categorization-models.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="st">// Generalized Context Model (GCM)</span></span>
<span id="cb402-3"><a href="categorization-models.html#cb402-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-4"><a href="categorization-models.html#cb402-4" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb402-5"><a href="categorization-models.html#cb402-5" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; ntrials;  // number of trials</span></span>
<span id="cb402-6"><a href="categorization-models.html#cb402-6" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nfeatures;  // number of predefined relevant features</span></span>
<span id="cb402-7"><a href="categorization-models.html#cb402-7" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_one; // true responses on a trial by trial basis</span></span>
<span id="cb402-8"><a href="categorization-models.html#cb402-8" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; y;  // decisions on a trial by trial basis</span></span>
<span id="cb402-9"><a href="categorization-models.html#cb402-9" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials, nfeatures] real obs; // stimuli as vectors of features</span></span>
<span id="cb402-10"><a href="categorization-models.html#cb402-10" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; b;  // initial bias for category one over two</span></span>
<span id="cb402-11"><a href="categorization-models.html#cb402-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-12"><a href="categorization-models.html#cb402-12" aria-hidden="true" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb402-13"><a href="categorization-models.html#cb402-13" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[nfeatures] w_prior_values;  // concentration parameters for dirichlet distribution &lt;lower=1&gt;</span></span>
<span id="cb402-14"><a href="categorization-models.html#cb402-14" aria-hidden="true" tabindex="-1"></a><span class="st">    array[2] real c_prior_values;  // mean and variance for logit-normal distribution</span></span>
<span id="cb402-15"><a href="categorization-models.html#cb402-15" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb402-16"><a href="categorization-models.html#cb402-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-17"><a href="categorization-models.html#cb402-17" aria-hidden="true" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb402-18"><a href="categorization-models.html#cb402-18" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_two; // dummy variable for category two over cat 1</span></span>
<span id="cb402-19"><a href="categorization-models.html#cb402-19" aria-hidden="true" tabindex="-1"></a><span class="st">    array[sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_one_idx; // array of which stimuli are cat 1</span></span>
<span id="cb402-20"><a href="categorization-models.html#cb402-20" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials-sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_two_idx; //  array of which stimuli are cat 2</span></span>
<span id="cb402-21"><a href="categorization-models.html#cb402-21" aria-hidden="true" tabindex="-1"></a><span class="st">    int idx_one = 1; // Initializing </span></span>
<span id="cb402-22"><a href="categorization-models.html#cb402-22" aria-hidden="true" tabindex="-1"></a><span class="st">    int idx_two = 1;</span></span>
<span id="cb402-23"><a href="categorization-models.html#cb402-23" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials){</span></span>
<span id="cb402-24"><a href="categorization-models.html#cb402-24" aria-hidden="true" tabindex="-1"></a><span class="st">        cat_two[i] = abs(cat_one[i]-1);</span></span>
<span id="cb402-25"><a href="categorization-models.html#cb402-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-26"><a href="categorization-models.html#cb402-26" aria-hidden="true" tabindex="-1"></a><span class="st">        if (cat_one[i]==1){</span></span>
<span id="cb402-27"><a href="categorization-models.html#cb402-27" aria-hidden="true" tabindex="-1"></a><span class="st">            cat_one_idx[idx_one] = i;</span></span>
<span id="cb402-28"><a href="categorization-models.html#cb402-28" aria-hidden="true" tabindex="-1"></a><span class="st">            idx_one +=1;</span></span>
<span id="cb402-29"><a href="categorization-models.html#cb402-29" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb402-30"><a href="categorization-models.html#cb402-30" aria-hidden="true" tabindex="-1"></a><span class="st">            cat_two_idx[idx_two] = i;</span></span>
<span id="cb402-31"><a href="categorization-models.html#cb402-31" aria-hidden="true" tabindex="-1"></a><span class="st">            idx_two += 1;</span></span>
<span id="cb402-32"><a href="categorization-models.html#cb402-32" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb402-33"><a href="categorization-models.html#cb402-33" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb402-34"><a href="categorization-models.html#cb402-34" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb402-35"><a href="categorization-models.html#cb402-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-36"><a href="categorization-models.html#cb402-36" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb402-37"><a href="categorization-models.html#cb402-37" aria-hidden="true" tabindex="-1"></a><span class="st">    simplex[nfeatures] w;  // simplex means sum(w)=1</span></span>
<span id="cb402-38"><a href="categorization-models.html#cb402-38" aria-hidden="true" tabindex="-1"></a><span class="st">    real logit_c;</span></span>
<span id="cb402-39"><a href="categorization-models.html#cb402-39" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb402-40"><a href="categorization-models.html#cb402-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-41"><a href="categorization-models.html#cb402-41" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb402-42"><a href="categorization-models.html#cb402-42" aria-hidden="true" tabindex="-1"></a><span class="st">    // parameter c </span></span>
<span id="cb402-43"><a href="categorization-models.html#cb402-43" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=2&gt; c = inv_logit(logit_c)*2;  // times 2 as c is bounded between 0 and 2</span></span>
<span id="cb402-44"><a href="categorization-models.html#cb402-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-45"><a href="categorization-models.html#cb402-45" aria-hidden="true" tabindex="-1"></a><span class="st">    // parameter r (probability of response = category 1)</span></span>
<span id="cb402-46"><a href="categorization-models.html#cb402-46" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real&lt;lower=0.0001, upper=0.9999&gt; r;</span></span>
<span id="cb402-47"><a href="categorization-models.html#cb402-47" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real rr;</span></span>
<span id="cb402-48"><a href="categorization-models.html#cb402-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-49"><a href="categorization-models.html#cb402-49" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb402-50"><a href="categorization-models.html#cb402-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-51"><a href="categorization-models.html#cb402-51" aria-hidden="true" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb402-52"><a href="categorization-models.html#cb402-52" aria-hidden="true" tabindex="-1"></a><span class="st">        array[(i-1)] real exemplar_sim;</span></span>
<span id="cb402-53"><a href="categorization-models.html#cb402-53" aria-hidden="true" tabindex="-1"></a><span class="st">        for (e in 1:(i-1)){</span></span>
<span id="cb402-54"><a href="categorization-models.html#cb402-54" aria-hidden="true" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb402-55"><a href="categorization-models.html#cb402-55" aria-hidden="true" tabindex="-1"></a><span class="st">            for (j in 1:nfeatures) {</span></span>
<span id="cb402-56"><a href="categorization-models.html#cb402-56" aria-hidden="true" tabindex="-1"></a><span class="st">                tmp_dist[j] = w[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb402-57"><a href="categorization-models.html#cb402-57" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb402-58"><a href="categorization-models.html#cb402-58" aria-hidden="true" tabindex="-1"></a><span class="st">            exemplar_sim[e] = exp(-c * sum(tmp_dist));</span></span>
<span id="cb402-59"><a href="categorization-models.html#cb402-59" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb402-60"><a href="categorization-models.html#cb402-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-61"><a href="categorization-models.html#cb402-61" aria-hidden="true" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb402-62"><a href="categorization-models.html#cb402-62" aria-hidden="true" tabindex="-1"></a><span class="st">            r[i] = 0.5;</span></span>
<span id="cb402-63"><a href="categorization-models.html#cb402-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-64"><a href="categorization-models.html#cb402-64" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb402-65"><a href="categorization-models.html#cb402-65" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb402-66"><a href="categorization-models.html#cb402-66" aria-hidden="true" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb402-67"><a href="categorization-models.html#cb402-67" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb402-68"><a href="categorization-models.html#cb402-68" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb402-69"><a href="categorization-models.html#cb402-69" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb402-70"><a href="categorization-models.html#cb402-70" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[1] = sum(exemplar_sim[tmp_idx_one]);</span></span>
<span id="cb402-71"><a href="categorization-models.html#cb402-71" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[2] = sum(exemplar_sim[tmp_idx_two]);</span></span>
<span id="cb402-72"><a href="categorization-models.html#cb402-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-73"><a href="categorization-models.html#cb402-73" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate r[i]</span></span>
<span id="cb402-74"><a href="categorization-models.html#cb402-74" aria-hidden="true" tabindex="-1"></a><span class="st">            rr[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb402-75"><a href="categorization-models.html#cb402-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-76"><a href="categorization-models.html#cb402-76" aria-hidden="true" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb402-77"><a href="categorization-models.html#cb402-77" aria-hidden="true" tabindex="-1"></a><span class="st">            if (rr[i] &gt; 0.9999){</span></span>
<span id="cb402-78"><a href="categorization-models.html#cb402-78" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = 0.9999;</span></span>
<span id="cb402-79"><a href="categorization-models.html#cb402-79" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr[i] &lt; 0.0001) {</span></span>
<span id="cb402-80"><a href="categorization-models.html#cb402-80" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = 0.0001;</span></span>
<span id="cb402-81"><a href="categorization-models.html#cb402-81" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr[i] &gt; 0.0001 &amp;&amp; rr[i] &lt; 0.9999) {</span></span>
<span id="cb402-82"><a href="categorization-models.html#cb402-82" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = rr[i];</span></span>
<span id="cb402-83"><a href="categorization-models.html#cb402-83" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb402-84"><a href="categorization-models.html#cb402-84" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = 0.5;</span></span>
<span id="cb402-85"><a href="categorization-models.html#cb402-85" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb402-86"><a href="categorization-models.html#cb402-86" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb402-87"><a href="categorization-models.html#cb402-87" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb402-88"><a href="categorization-models.html#cb402-88" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb402-89"><a href="categorization-models.html#cb402-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-90"><a href="categorization-models.html#cb402-90" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb402-91"><a href="categorization-models.html#cb402-91" aria-hidden="true" tabindex="-1"></a><span class="st">    // Priors</span></span>
<span id="cb402-92"><a href="categorization-models.html#cb402-92" aria-hidden="true" tabindex="-1"></a><span class="st">    target += dirichlet_lpdf(w | w_prior_values);</span></span>
<span id="cb402-93"><a href="categorization-models.html#cb402-93" aria-hidden="true" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c | c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb402-94"><a href="categorization-models.html#cb402-94" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb402-95"><a href="categorization-models.html#cb402-95" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb402-96"><a href="categorization-models.html#cb402-96" aria-hidden="true" tabindex="-1"></a><span class="st">    // Decision Data</span></span>
<span id="cb402-97"><a href="categorization-models.html#cb402-97" aria-hidden="true" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(y | r);</span></span>
<span id="cb402-98"><a href="categorization-models.html#cb402-98" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb402-99"><a href="categorization-models.html#cb402-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-100"><a href="categorization-models.html#cb402-100" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb402-101"><a href="categorization-models.html#cb402-101" aria-hidden="true" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb402-102"><a href="categorization-models.html#cb402-102" aria-hidden="true" tabindex="-1"></a><span class="st">    simplex[nfeatures] w_prior = dirichlet_rng(w_prior_values);</span></span>
<span id="cb402-103"><a href="categorization-models.html#cb402-103" aria-hidden="true" tabindex="-1"></a><span class="st">    real logit_c_prior = normal_rng(c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb402-104"><a href="categorization-models.html#cb402-104" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=2&gt; c_prior = inv_logit(logit_c_prior)*2;</span></span>
<span id="cb402-105"><a href="categorization-models.html#cb402-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-106"><a href="categorization-models.html#cb402-106" aria-hidden="true" tabindex="-1"></a><span class="st">    // prior pred</span></span>
<span id="cb402-107"><a href="categorization-models.html#cb402-107" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real&lt;lower=0, upper=1&gt; r_prior;</span></span>
<span id="cb402-108"><a href="categorization-models.html#cb402-108" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real rr_prior;</span></span>
<span id="cb402-109"><a href="categorization-models.html#cb402-109" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb402-110"><a href="categorization-models.html#cb402-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-111"><a href="categorization-models.html#cb402-111" aria-hidden="true" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb402-112"><a href="categorization-models.html#cb402-112" aria-hidden="true" tabindex="-1"></a><span class="st">        array[(i-1)] real exemplar_dist;</span></span>
<span id="cb402-113"><a href="categorization-models.html#cb402-113" aria-hidden="true" tabindex="-1"></a><span class="st">        for (e in 1:(i-1)){</span></span>
<span id="cb402-114"><a href="categorization-models.html#cb402-114" aria-hidden="true" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb402-115"><a href="categorization-models.html#cb402-115" aria-hidden="true" tabindex="-1"></a><span class="st">            for (j in 1:nfeatures) {</span></span>
<span id="cb402-116"><a href="categorization-models.html#cb402-116" aria-hidden="true" tabindex="-1"></a><span class="st">                tmp_dist[j] = w_prior[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb402-117"><a href="categorization-models.html#cb402-117" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb402-118"><a href="categorization-models.html#cb402-118" aria-hidden="true" tabindex="-1"></a><span class="st">            exemplar_dist[e] = sum(tmp_dist);</span></span>
<span id="cb402-119"><a href="categorization-models.html#cb402-119" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb402-120"><a href="categorization-models.html#cb402-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-121"><a href="categorization-models.html#cb402-121" aria-hidden="true" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb402-122"><a href="categorization-models.html#cb402-122" aria-hidden="true" tabindex="-1"></a><span class="st">            r_prior[i] = 0.5;</span></span>
<span id="cb402-123"><a href="categorization-models.html#cb402-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-124"><a href="categorization-models.html#cb402-124" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb402-125"><a href="categorization-models.html#cb402-125" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb402-126"><a href="categorization-models.html#cb402-126" aria-hidden="true" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb402-127"><a href="categorization-models.html#cb402-127" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb402-128"><a href="categorization-models.html#cb402-128" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb402-129"><a href="categorization-models.html#cb402-129" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb402-130"><a href="categorization-models.html#cb402-130" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[1] = exp(-c_prior * sum(exemplar_dist[tmp_idx_one]));</span></span>
<span id="cb402-131"><a href="categorization-models.html#cb402-131" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[2] = exp(-c_prior * sum(exemplar_dist[tmp_idx_two]));</span></span>
<span id="cb402-132"><a href="categorization-models.html#cb402-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-133"><a href="categorization-models.html#cb402-133" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate r[i]</span></span>
<span id="cb402-134"><a href="categorization-models.html#cb402-134" aria-hidden="true" tabindex="-1"></a><span class="st">            rr_prior[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb402-135"><a href="categorization-models.html#cb402-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-136"><a href="categorization-models.html#cb402-136" aria-hidden="true" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb402-137"><a href="categorization-models.html#cb402-137" aria-hidden="true" tabindex="-1"></a><span class="st">            if (rr_prior[i] == 1){</span></span>
<span id="cb402-138"><a href="categorization-models.html#cb402-138" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = 0.9999;</span></span>
<span id="cb402-139"><a href="categorization-models.html#cb402-139" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr_prior[i] == 0) {</span></span>
<span id="cb402-140"><a href="categorization-models.html#cb402-140" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = 0.0001;</span></span>
<span id="cb402-141"><a href="categorization-models.html#cb402-141" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr_prior[i] &gt; 0 &amp;&amp; rr_prior[i] &lt; 1) {</span></span>
<span id="cb402-142"><a href="categorization-models.html#cb402-142" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = rr_prior[i];</span></span>
<span id="cb402-143"><a href="categorization-models.html#cb402-143" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb402-144"><a href="categorization-models.html#cb402-144" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = 0.5;</span></span>
<span id="cb402-145"><a href="categorization-models.html#cb402-145" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb402-146"><a href="categorization-models.html#cb402-146" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb402-147"><a href="categorization-models.html#cb402-147" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb402-148"><a href="categorization-models.html#cb402-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-149"><a href="categorization-models.html#cb402-149" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; priorpred = bernoulli_rng(r_prior);</span></span>
<span id="cb402-150"><a href="categorization-models.html#cb402-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-151"><a href="categorization-models.html#cb402-151" aria-hidden="true" tabindex="-1"></a><span class="st">    // posterior pred</span></span>
<span id="cb402-152"><a href="categorization-models.html#cb402-152" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; posteriorpred = bernoulli_rng(r);</span></span>
<span id="cb402-153"><a href="categorization-models.html#cb402-153" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; posteriorcorrect;</span></span>
<span id="cb402-154"><a href="categorization-models.html#cb402-154" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb402-155"><a href="categorization-models.html#cb402-155" aria-hidden="true" tabindex="-1"></a><span class="st">        if (posteriorpred[i] == cat_one[i]) {</span></span>
<span id="cb402-156"><a href="categorization-models.html#cb402-156" aria-hidden="true" tabindex="-1"></a><span class="st">            posteriorcorrect[i] = 1;</span></span>
<span id="cb402-157"><a href="categorization-models.html#cb402-157" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb402-158"><a href="categorization-models.html#cb402-158" aria-hidden="true" tabindex="-1"></a><span class="st">            posteriorcorrect[i] = 0;</span></span>
<span id="cb402-159"><a href="categorization-models.html#cb402-159" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb402-160"><a href="categorization-models.html#cb402-160" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb402-161"><a href="categorization-models.html#cb402-161" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb402-162"><a href="categorization-models.html#cb402-162" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb402-163"><a href="categorization-models.html#cb402-163" aria-hidden="true" tabindex="-1"></a><span class="st">    // log likelihood</span></span>
<span id="cb402-164"><a href="categorization-models.html#cb402-164" aria-hidden="true" tabindex="-1"></a><span class="st">   array[ntrials] real log_lik;</span></span>
<span id="cb402-165"><a href="categorization-models.html#cb402-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-166"><a href="categorization-models.html#cb402-166" aria-hidden="true" tabindex="-1"></a><span class="st">   for (i in 1:ntrials) {</span></span>
<span id="cb402-167"><a href="categorization-models.html#cb402-167" aria-hidden="true" tabindex="-1"></a><span class="st">        log_lik[i] = bernoulli_lpmf(y[i] | r[i]);</span></span>
<span id="cb402-168"><a href="categorization-models.html#cb402-168" aria-hidden="true" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb402-169"><a href="categorization-models.html#cb402-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-170"><a href="categorization-models.html#cb402-170" aria-hidden="true" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb402-171"><a href="categorization-models.html#cb402-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-172"><a href="categorization-models.html#cb402-172" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb402-173"><a href="categorization-models.html#cb402-173" aria-hidden="true" tabindex="-1"></a>  gcm_model,</span>
<span id="cb402-174"><a href="categorization-models.html#cb402-174" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb402-175"><a href="categorization-models.html#cb402-175" aria-hidden="true" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10_GCM.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10_GCM.stan&quot;</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="categorization-models.html#cb404-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10_GCM.stan&quot;</span>)</span>
<span id="cb404-2"><a href="categorization-models.html#cb404-2" aria-hidden="true" tabindex="-1"></a>mod_GCM <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb404-3"><a href="categorization-models.html#cb404-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span></code></pre></div>
<pre><code>## Compiling Stan program...</code></pre>
<pre><code>## Warning in readLines(hpp_path): incomplete final line found on
## &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T//Rtmp7crM4L/model-6c4b10f315f4.hpp&#39;</code></pre>
<pre><code>## 
-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

|

/

-

\

 </code></pre>
<pre><code>## Warning in readLines(private$hpp_file_): incomplete final line found on
## &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T//Rtmp7crM4L/model-6c4b10f315f4.hpp&#39;</code></pre>
<p>Now it’s time to fit the data</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="categorization-models.html#cb409-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb409-2"><a href="categorization-models.html#cb409-2" aria-hidden="true" tabindex="-1"></a>  c <span class="sc">==</span> <span class="st">&quot;1.1&quot;</span> <span class="sc">&amp;</span> w <span class="sc">==</span> <span class="st">&quot;skewed2&quot;</span></span>
<span id="cb409-3"><a href="categorization-models.html#cb409-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb409-4"><a href="categorization-models.html#cb409-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-5"><a href="categorization-models.html#cb409-5" aria-hidden="true" tabindex="-1"></a>gcm_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb409-6"><a href="categorization-models.html#cb409-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntrials =</span> <span class="fu">nrow</span>(d),</span>
<span id="cb409-7"><a href="categorization-models.html#cb409-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb409-8"><a href="categorization-models.html#cb409-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cat_one =</span> d<span class="sc">$</span>category,</span>
<span id="cb409-9"><a href="categorization-models.html#cb409-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> d<span class="sc">$</span>sim_response,</span>
<span id="cb409-10"><a href="categorization-models.html#cb409-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(d[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb409-11"><a href="categorization-models.html#cb409-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb409-12"><a href="categorization-models.html#cb409-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb409-13"><a href="categorization-models.html#cb409-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb409-14"><a href="categorization-models.html#cb409-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb409-15"><a href="categorization-models.html#cb409-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-16"><a href="categorization-models.html#cb409-16" aria-hidden="true" tabindex="-1"></a>samples_gcm <span class="ot">&lt;-</span> mod_GCM<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb409-17"><a href="categorization-models.html#cb409-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gcm_data,</span>
<span id="cb409-18"><a href="categorization-models.html#cb409-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb409-19"><a href="categorization-models.html#cb409-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb409-20"><a href="categorization-models.html#cb409-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb409-21"><a href="categorization-models.html#cb409-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">4</span>,</span>
<span id="cb409-22"><a href="categorization-models.html#cb409-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb409-23"><a href="categorization-models.html#cb409-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb409-24"><a href="categorization-models.html#cb409-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb409-25"><a href="categorization-models.html#cb409-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 1 chain, with 4 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 332.5 seconds.</code></pre>
<p>Now we need to check the model</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="categorization-models.html#cb411-1" aria-hidden="true" tabindex="-1"></a>samples_gcm<span class="sc">$</span><span class="fu">cmdstan_diagnose</span>()</span></code></pre></div>
<pre><code>## Processing csv files: /var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/Rtmp7crM4L/W10_GCM-202304202334-1-213e1f.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="categorization-models.html#cb413-1" aria-hidden="true" tabindex="-1"></a>samples_gcm<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5,129 × 10
##    variable      mean    median     sd    mad        q5       q95   rhat ess_bulk
##    &lt;chr&gt;        &lt;num&gt;     &lt;num&gt;  &lt;num&gt;  &lt;num&gt;     &lt;num&gt;     &lt;num&gt;  &lt;num&gt;    &lt;num&gt;
##  1 lp__     -394.     -394.     1.05   0.824  -396.     -393.      1.00      401.
##  2 w[1]        0.160     0.158  0.0590 0.0595    0.0670    0.264   1.01      518.
##  3 w[2]        0.840     0.842  0.0590 0.0595    0.736     0.933   1.01      518.
##  4 logit_c    -0.221    -0.223  0.191  0.194    -0.539     0.0958  0.999     415.
##  5 c           0.891     0.889  0.0934 0.0959    0.737     1.05    0.999     415.
##  6 r[1]        0.5       0.5    0      0         0.5       0.5    NA          NA 
##  7 r[2]        0.5       0.5    0      0         0.5       0.5    NA          NA 
##  8 r[3]        0.322     0.322  0.0191 0.0198    0.290     0.353   0.999     449.
##  9 r[4]        0.0716    0.0703 0.0160 0.0157    0.0475    0.100   0.999     465.
## 10 r[5]        0.700     0.701  0.0459 0.0482    0.621     0.774   0.999     437.
## # ℹ 5,119 more rows
## # ℹ 1 more variable: ess_tail &lt;num&gt;</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="categorization-models.html#cb415-1" aria-hidden="true" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb415-2"><a href="categorization-models.html#cb415-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-3"><a href="categorization-models.html#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, c, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb415-4"><a href="categorization-models.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb415-5"><a href="categorization-models.html#cb415-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="categorization-models.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, logit_c, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb416-2"><a href="categorization-models.html#cb416-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb416-3"><a href="categorization-models.html#cb416-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="categorization-models.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb417-2"><a href="categorization-models.html#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb417-3"><a href="categorization-models.html#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="categorization-models.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb418-2"><a href="categorization-models.html#cb418-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb418-3"><a href="categorization-models.html#cb418-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-4.png" width="672" /></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="categorization-models.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb419-2"><a href="categorization-models.html#cb419-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb419-3"><a href="categorization-models.html#cb419-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb419-4"><a href="categorization-models.html#cb419-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d<span class="sc">$</span>c[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb419-5"><a href="categorization-models.html#cb419-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-5.png" width="672" /></p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="categorization-models.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb421-2"><a href="categorization-models.html#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-3"><a href="categorization-models.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-4"><a href="categorization-models.html#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb421-5"><a href="categorization-models.html#cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-6.png" width="672" /></p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="categorization-models.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb423-2"><a href="categorization-models.html#cb423-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb423-3"><a href="categorization-models.html#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb423-4"><a href="categorization-models.html#cb423-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb423-5"><a href="categorization-models.html#cb423-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-7.png" width="672" /></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="categorization-models.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb425-2"><a href="categorization-models.html#cb425-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(c, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb425-3"><a href="categorization-models.html#cb425-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-8.png" width="672" /></p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="categorization-models.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb426-2"><a href="categorization-models.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(c, <span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb426-3"><a href="categorization-models.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-9.png" width="672" /></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="categorization-models.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb427-2"><a href="categorization-models.html#cb427-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb427-3"><a href="categorization-models.html#cb427-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-10.png" width="672" /></p>
<p>C looks like crap, while weights seem decently recovered. Let’s look at the larger picture, but looping through the different combinations of parameter values.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="categorization-models.html#cb428-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(future, purrr, furrr)</span>
<span id="cb428-2"><a href="categorization-models.html#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb428-3"><a href="categorization-models.html#cb428-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-4"><a href="categorization-models.html#cb428-4" aria-hidden="true" tabindex="-1"></a>sim_d_and_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, scaling, weights) {</span>
<span id="cb428-5"><a href="categorization-models.html#cb428-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb428-6"><a href="categorization-models.html#cb428-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb428-7"><a href="categorization-models.html#cb428-7" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb428-8"><a href="categorization-models.html#cb428-8" aria-hidden="true" tabindex="-1"></a>      c <span class="sc">==</span> scaling <span class="sc">&amp;</span> w <span class="sc">==</span> weights <span class="sc">&amp;</span> agent <span class="sc">==</span> agent</span>
<span id="cb428-9"><a href="categorization-models.html#cb428-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb428-10"><a href="categorization-models.html#cb428-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb428-11"><a href="categorization-models.html#cb428-11" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb428-12"><a href="categorization-models.html#cb428-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ntrials =</span> <span class="fu">nrow</span>(temp),</span>
<span id="cb428-13"><a href="categorization-models.html#cb428-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb428-14"><a href="categorization-models.html#cb428-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">cat_one =</span> temp<span class="sc">$</span>category,</span>
<span id="cb428-15"><a href="categorization-models.html#cb428-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> temp<span class="sc">$</span>sim_response,</span>
<span id="cb428-16"><a href="categorization-models.html#cb428-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> <span class="fu">as.matrix</span>(temp[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb428-17"><a href="categorization-models.html#cb428-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb428-18"><a href="categorization-models.html#cb428-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb428-19"><a href="categorization-models.html#cb428-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb428-20"><a href="categorization-models.html#cb428-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb428-21"><a href="categorization-models.html#cb428-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb428-22"><a href="categorization-models.html#cb428-22" aria-hidden="true" tabindex="-1"></a>    samples_gcm <span class="ot">&lt;-</span> mod_GCM<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb428-23"><a href="categorization-models.html#cb428-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb428-24"><a href="categorization-models.html#cb428-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb428-25"><a href="categorization-models.html#cb428-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb428-26"><a href="categorization-models.html#cb428-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb428-27"><a href="categorization-models.html#cb428-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">threads_per_chain =</span> <span class="dv">4</span>,</span>
<span id="cb428-28"><a href="categorization-models.html#cb428-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb428-29"><a href="categorization-models.html#cb428-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb428-30"><a href="categorization-models.html#cb428-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb428-31"><a href="categorization-models.html#cb428-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb428-32"><a href="categorization-models.html#cb428-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb428-33"><a href="categorization-models.html#cb428-33" aria-hidden="true" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb428-34"><a href="categorization-models.html#cb428-34" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trueC =</span> scaling, <span class="at">trueW =</span> weights, <span class="at">agent =</span> agent,</span>
<span id="cb428-35"><a href="categorization-models.html#cb428-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">estC =</span> draws_df<span class="sc">$</span>c, </span>
<span id="cb428-36"><a href="categorization-models.html#cb428-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">estW1 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>,</span>
<span id="cb428-37"><a href="categorization-models.html#cb428-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">estW2 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[2]</span><span class="st">`</span></span>
<span id="cb428-38"><a href="categorization-models.html#cb428-38" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb428-39"><a href="categorization-models.html#cb428-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb428-40"><a href="categorization-models.html#cb428-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(temp)</span>
<span id="cb428-41"><a href="categorization-models.html#cb428-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb428-42"><a href="categorization-models.html#cb428-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb428-43"><a href="categorization-models.html#cb428-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-44"><a href="categorization-models.html#cb428-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-45"><a href="categorization-models.html#cb428-45" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">unique</span>(simulated_responses[,<span class="fu">c</span>(<span class="st">&quot;agent&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;w&quot;</span>)])) <span class="sc">%&gt;%</span></span>
<span id="cb428-46"><a href="categorization-models.html#cb428-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb428-47"><a href="categorization-models.html#cb428-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> c,</span>
<span id="cb428-48"><a href="categorization-models.html#cb428-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> w</span>
<span id="cb428-49"><a href="categorization-models.html#cb428-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb428-50"><a href="categorization-models.html#cb428-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-51"><a href="categorization-models.html#cb428-51" aria-hidden="true" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(temp, sim_d_and_fit, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb428-52"><a href="categorization-models.html#cb428-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-53"><a href="categorization-models.html#cb428-53" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(recovery_df, <span class="st">&quot;simdata/W10_GCM_recoverydf.csv&quot;</span>)</span></code></pre></div>
<p>Time to visualize</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="categorization-models.html#cb429-1" aria-hidden="true" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;simdata/W10_GCM_recoverydf.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 300000 Columns: 6
## ── Column specification ───────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): trueW
## dbl (5): trueC, agent, estC, estW1, estW2
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="categorization-models.html#cb431-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb431-2"><a href="categorization-models.html#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estC, <span class="at">group =</span> trueW, <span class="at">fill =</span> trueW), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb431-3"><a href="categorization-models.html#cb431-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = trueC) +</span></span>
<span id="cb431-4"><a href="categorization-models.html#cb431-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> trueC) <span class="sc">+</span></span>
<span id="cb431-5"><a href="categorization-models.html#cb431-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb431-6"><a href="categorization-models.html#cb431-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb431-7"><a href="categorization-models.html#cb431-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb431-8"><a href="categorization-models.html#cb431-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estW1, <span class="at">group =</span> trueW, <span class="at">fill =</span> trueW), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb431-9"><a href="categorization-models.html#cb431-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = trueC) +</span></span>
<span id="cb431-10"><a href="categorization-models.html#cb431-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(trueC <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb431-11"><a href="categorization-models.html#cb431-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb431-12"><a href="categorization-models.html#cb431-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb431-13"><a href="categorization-models.html#cb431-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-models-of-cognition.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/10-CategorizationModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
