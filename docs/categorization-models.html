<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Categorization models | 10-CategorizationModels</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Categorization models | 10-CategorizationModels" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Categorization models | 10-CategorizationModels" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2023" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2023-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-models-of-cognition.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-goal-of-the-course"><i class="fa fa-check"></i><b>1.1</b> The goal of the course</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#list-of-lectures-and-practical-exercises"><i class="fa fa-check"></i><b>1.2</b> List of lectures and practical exercises</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation-before-the-course"><i class="fa fa-check"></i><b>1.3</b> Preparation before the course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.3.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.3.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.3.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.3.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.3.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.3.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.3.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.3.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.3.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.3.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.3.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.3.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.3.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.4</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.4.1</b> Memory</a></li>
<li class="chapter" data-level="2.4.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.4.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.5</b> Continuity between models</a></li>
<li class="chapter" data-level="2.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.6</b> Mixture of strategies</a></li>
<li class="chapter" data-level="2.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>2.7</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.1</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.2" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.2</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.4" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.4</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.4.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#data"><i class="fa fa-check"></i><b>4.3.1</b> Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#model"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>4.3.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="4.3.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-model"><i class="fa fa-check"></i><b>4.3.4</b> Summarizing the model</a></li>
<li class="chapter" data-level="4.3.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#assessing-model-quality"><i class="fa fa-check"></i><b>4.3.5</b> Assessing model quality</a></li>
<li class="chapter" data-level="4.3.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results"><i class="fa fa-check"></i><b>4.3.6</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>4.5.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>4.6</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>4.6.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html"><i class="fa fa-check"></i><b>5</b> Practical exercise 4 - Model quality checks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>5.1</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="5.2" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-priors"><i class="fa fa-check"></i><b>5.2</b> Assessing priors</a></li>
<li class="chapter" data-level="5.3" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-prior-and-posterior-predictions"><i class="fa fa-check"></i><b>5.3</b> Assessing prior and posterior predictions</a></li>
<li class="chapter" data-level="5.4" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="5.5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#the-memory-model"><i class="fa fa-check"></i><b>5.5</b> The memory model</a></li>
<li class="chapter" data-level="5.6" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>5.6</b> Prior sensitivity check for the memory model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html"><i class="fa fa-check"></i><b>6</b> Multilevel modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#intro-to-multilevel-modeling"><i class="fa fa-check"></i><b>6.1</b> Intro to multilevel modeling</a></li>
<li class="chapter" data-level="6.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent"><i class="fa fa-check"></i><b>6.2</b> A multilevel version of the biased agent and of the simple memory agent</a></li>
<li class="chapter" data-level="6.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>6.3</b> Generating the agents</a></li>
<li class="chapter" data-level="6.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>6.4</b> Plotting the agents</a></li>
<li class="chapter" data-level="6.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>6.5</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>6.5.1</b> Multilevel random</a></li>
<li class="chapter" data-level="6.5.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>6.5.2</b> Assessing multilevel random agents</a></li>
<li class="chapter" data-level="6.5.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory"><i class="fa fa-check"></i><b>6.5.3</b> Multilevel memory</a></li>
<li class="chapter" data-level="6.5.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>6.5.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>6.5.5</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="6.5.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>6.5.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.7" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>6.5.7</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="6.5.8" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>6.5.8</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.9" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-no-pooling"><i class="fa fa-check"></i><b>6.5.9</b> Multilevel memory no pooling</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-full-pooling"><i class="fa fa-check"></i><b>6.6</b> Multilevel full pooling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>7</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model-comparison.html"><a href="model-comparison.html#define-parameters"><i class="fa fa-check"></i><b>7.1</b> Define parameters</a></li>
<li class="chapter" data-level="7.2" data-path="model-comparison.html"><a href="model-comparison.html#define-biased-and-memory-agents"><i class="fa fa-check"></i><b>7.2</b> Define biased and memory agents</a></li>
<li class="chapter" data-level="7.3" data-path="model-comparison.html"><a href="model-comparison.html#generating-the-agents-1"><i class="fa fa-check"></i><b>7.3</b> Generating the agents</a></li>
<li class="chapter" data-level="7.4" data-path="model-comparison.html"><a href="model-comparison.html#prep-the-data"><i class="fa fa-check"></i><b>7.4</b> Prep the data</a></li>
<li class="chapter" data-level="7.5" data-path="model-comparison.html"><a href="model-comparison.html#log-posterior-likelihood"><i class="fa fa-check"></i><b>7.5</b> Log posterior likelihood</a></li>
<li class="chapter" data-level="7.6" data-path="model-comparison.html"><a href="model-comparison.html#create-the-models-multilevel-biased-agents"><i class="fa fa-check"></i><b>7.6</b> Create the models: multilevel biased agents</a></li>
<li class="chapter" data-level="7.7" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-memory-model"><i class="fa fa-check"></i><b>7.7</b> Multilevel memory model</a></li>
<li class="chapter" data-level="7.8" data-path="model-comparison.html"><a href="model-comparison.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>7.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="7.9" data-path="model-comparison.html"><a href="model-comparison.html#calculating-the-expected-log-predictive-density-of-a-model"><i class="fa fa-check"></i><b>7.9</b> Calculating the expected log predictive density of a model</a></li>
<li class="chapter" data-level="7.10" data-path="model-comparison.html"><a href="model-comparison.html#implementing-cross-validation"><i class="fa fa-check"></i><b>7.10</b> Implementing Cross-Validation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-biased-agents"><i class="fa fa-check"></i><b>7.10.1</b> Create cross-validation ready stan model for biased agents</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-memory-agents"><i class="fa fa-check"></i><b>7.10.2</b> Create cross-validation ready stan model for memory agents</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="model-comparison.html"><a href="model-comparison.html#calculating-elpd-and-comparing"><i class="fa fa-check"></i><b>7.11</b> Calculating elpd and comparing</a></li>
<li class="chapter" data-level="7.12" data-path="model-comparison.html"><a href="model-comparison.html#limitations-of-model-comparison-techniques"><i class="fa fa-check"></i><b>7.12</b> Limitations of model comparison techniques</a></li>
<li class="chapter" data-level="7.13" data-path="model-comparison.html"><a href="model-comparison.html#mixture-models"><i class="fa fa-check"></i><b>7.13</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="model-comparison.html"><a href="model-comparison.html#load-the-dataset"><i class="fa fa-check"></i><b>7.13.1</b> Load the dataset</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="model-comparison.html"><a href="model-comparison.html#stan-model-mixing-biased-and-noise"><i class="fa fa-check"></i><b>7.14</b> Stan model mixing biased and noise</a></li>
<li class="chapter" data-level="7.15" data-path="model-comparison.html"><a href="model-comparison.html#fitting-and-assessing-the-model"><i class="fa fa-check"></i><b>7.15</b> Fitting and assessing the model</a></li>
<li class="chapter" data-level="7.16" data-path="model-comparison.html"><a href="model-comparison.html#basic-evaluation"><i class="fa fa-check"></i><b>7.16</b> Basic evaluation</a></li>
<li class="chapter" data-level="7.17" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-mixture-model"><i class="fa fa-check"></i><b>7.17</b> Multilevel mixture model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html"><i class="fa fa-check"></i><b>8</b> Bonus chapter: Additional models developed by students</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#additional-models"><i class="fa fa-check"></i><b>8.1</b> Additional models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.1</b> Probabilistic Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-asymmetric-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.2</b> Probabilistic asymmetric Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-rate"><i class="fa fa-check"></i><b>8.1.3</b> Memory agent with exponential memory decay (rate)</a></li>
<li class="chapter" data-level="8.1.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-exponential"><i class="fa fa-check"></i><b>8.1.4</b> Memory agent with exponential memory decay (exponential)</a></li>
<li class="chapter" data-level="8.1.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-but-separate-memory-for-wins-and-losses"><i class="fa fa-check"></i><b>8.1.5</b> Memory agent with exponential memory decay, but separate memory for wins and losses</a></li>
<li class="chapter" data-level="8.1.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-and-with-confidence"><i class="fa fa-check"></i><b>8.1.6</b> Memory agent with exponential memory decay, and with confidence</a></li>
<li class="chapter" data-level="8.1.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#reinforcement-learning-rescorla-wagner"><i class="fa fa-check"></i><b>8.1.7</b> Reinforcement learning (Rescorla Wagner)</a></li>
<li class="chapter" data-level="8.1.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#hierarchical-gaussian-filter"><i class="fa fa-check"></i><b>8.1.8</b> Hierarchical gaussian filter</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#implementing-the-wsls-model"><i class="fa fa-check"></i><b>8.2</b> Implementing the WSLS model</a></li>
<li class="chapter" data-level="8.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#load-packages"><i class="fa fa-check"></i><b>8.3</b> Load packages</a></li>
<li class="chapter" data-level="8.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#generate-data"><i class="fa fa-check"></i><b>8.4</b> Generate data</a></li>
<li class="chapter" data-level="8.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#sanity-check-for-the-data"><i class="fa fa-check"></i><b>8.5</b> Sanity check for the data</a></li>
<li class="chapter" data-level="8.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#more-sanity-check"><i class="fa fa-check"></i><b>8.6</b> More sanity check</a></li>
<li class="chapter" data-level="8.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-data-for-single-agent-model"><i class="fa fa-check"></i><b>8.7</b> Create data for single agent model</a></li>
<li class="chapter" data-level="8.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model"><i class="fa fa-check"></i><b>8.8</b> Create the model</a></li>
<li class="chapter" data-level="8.9" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#basic-assessment"><i class="fa fa-check"></i><b>8.9</b> Basic assessment</a></li>
<li class="chapter" data-level="8.10" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-multilevel-data"><i class="fa fa-check"></i><b>8.10</b> Create multilevel data</a></li>
<li class="chapter" data-level="8.11" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model-1"><i class="fa fa-check"></i><b>8.11</b> Create the model</a></li>
<li class="chapter" data-level="8.12" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#quality-checks"><i class="fa fa-check"></i><b>8.12</b> Quality checks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>9</b> Bayesian models of cognition</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#load-the-packages"><i class="fa fa-check"></i><b>9.1</b> Load the packages</a></li>
<li class="chapter" data-level="9.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#design-the-model"><i class="fa fa-check"></i><b>9.2</b> Design the model</a></li>
<li class="chapter" data-level="9.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-data"><i class="fa fa-check"></i><b>9.3</b> Create the data</a></li>
<li class="chapter" data-level="9.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize"><i class="fa fa-check"></i><b>9.4</b> Visualize</a></li>
<li class="chapter" data-level="9.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#data-for-stan"><i class="fa fa-check"></i><b>9.5</b> Data for Stan</a></li>
<li class="chapter" data-level="9.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-stan-model"><i class="fa fa-check"></i><b>9.6</b> Create the Stan Model</a></li>
<li class="chapter" data-level="9.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-model"><i class="fa fa-check"></i><b>9.7</b> Fitting the model</a></li>
<li class="chapter" data-level="9.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#basic-evaluation-1"><i class="fa fa-check"></i><b>9.8</b> Basic evaluation</a></li>
<li class="chapter" data-level="9.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayes"><i class="fa fa-check"></i><b>9.9</b> Weighted Bayes</a></li>
<li class="chapter" data-level="9.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize-1"><i class="fa fa-check"></i><b>9.10</b> Visualize</a></li>
<li class="chapter" data-level="9.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-the-weighted-bayes-stan-model-simple-formula"><i class="fa fa-check"></i><b>9.11</b> Build the Weighted Bayes Stan model (simple formula)</a></li>
<li class="chapter" data-level="9.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-evaluation"><i class="fa fa-check"></i><b>9.12</b> Model evaluation</a></li>
<li class="chapter" data-level="9.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-recovery"><i class="fa fa-check"></i><b>9.13</b> Model recovery</a></li>
<li class="chapter" data-level="9.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel"><i class="fa fa-check"></i><b>9.14</b> Multilevel</a></li>
<li class="chapter" data-level="9.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bonus-build-the-weighted-bayes-stan-model-fancier-formula"><i class="fa fa-check"></i><b>9.15</b> Bonus: Build the Weighted Bayes Stan model (fancier formula)</a></li>
<li class="chapter" data-level="9.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluation"><i class="fa fa-check"></i><b>9.16</b> Evaluation</a></li>
<li class="chapter" data-level="9.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-a-temporal-bayes-storing-current-belief-as-prior-for-next-turn"><i class="fa fa-check"></i><b>9.17</b> Build a temporal Bayes (storing current belief as prior for next turn)</a></li>
<li class="chapter" data-level="9.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluate"><i class="fa fa-check"></i><b>9.18</b> Evaluate</a></li>
<li class="chapter" data-level="9.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-simple-bayes-model"><i class="fa fa-check"></i><b>9.19</b> Multilevel version of the simple bayes model</a></li>
<li class="chapter" data-level="9.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-weighted-bayes-model"><i class="fa fa-check"></i><b>9.20</b> Multilevel version of the weighted bayes model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="categorization-models.html"><a href="categorization-models.html"><i class="fa fa-check"></i><b>10</b> Categorization models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="categorization-models.html"><a href="categorization-models.html#multilevel-gcm"><i class="fa fa-check"></i><b>10.1</b> Multilevel GCM</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="categorization-models.html"><a href="categorization-models.html#simulate-hierarchical-simplices"><i class="fa fa-check"></i><b>10.1.1</b> Simulate hierarchical simplices</a></li>
<li class="chapter" data-level="10.1.2" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-data-simulation"><i class="fa fa-check"></i><b>10.1.2</b> Set up the data simulation</a></li>
<li class="chapter" data-level="10.1.3" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-stan-model"><i class="fa fa-check"></i><b>10.1.3</b> Set up the Stan model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="categorization-models.html"><a href="categorization-models.html#now-we-parallelize-n.b.-not-finished"><i class="fa fa-check"></i><b>10.2</b> Now we parallelize [N.B. NOT FINISHED]</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="categorization-models.html"><a href="categorization-models.html#student-produced-models-of-categorization"><i class="fa fa-check"></i><b>10.2.1</b> Student-produced models of categorization</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">10-CategorizationModels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorization-models" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Categorization models<a href="categorization-models.html#categorization-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this module the course covers formal models of categorization. In particular, here we implement a version of the Generalized Context Model (from now on GCM).</p>
<p>[MISSING: INTRODUCTION TO THE GCM]</p>
<p>In order to understand the GCM, we will rely on a setup from Kruschke 1993. Participants go through 8 blocks of trials. Within each block, participants see 8 stimuli, the same across every block. Each stimulus has to be categorised (classified) as belonging to either category A or category B. After categorizing a stimulus, feedback is given, so that the participant knows which category the stimulus truly belongs to.</p>
<p>The stimuli differ along two continuous dimensions (more specifically the height of a square and the position of a line with it).</p>
<p>Following on the structure in Kruschke 1993, we need to start simulating data. Let’s start with the stimuli.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="categorization-models.html#cb372-1" tabindex="-1"></a><span class="co"># Defining the stimuli, their height and position features, and their category</span></span>
<span id="cb372-2"><a href="categorization-models.html#cb372-2" tabindex="-1"></a>stimulus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>)</span>
<span id="cb372-3"><a href="categorization-models.html#cb372-3" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">3</span>, <span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb372-4"><a href="categorization-models.html#cb372-4" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb372-5"><a href="categorization-models.html#cb372-5" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb372-6"><a href="categorization-models.html#cb372-6" tabindex="-1"></a></span>
<span id="cb372-7"><a href="categorization-models.html#cb372-7" tabindex="-1"></a><span class="co"># Making this into a tibble</span></span>
<span id="cb372-8"><a href="categorization-models.html#cb372-8" tabindex="-1"></a>stimuli <span class="ot">&lt;-</span> <span class="fu">tibble</span>(stimulus, height, position, category)</span>
<span id="cb372-9"><a href="categorization-models.html#cb372-9" tabindex="-1"></a></span>
<span id="cb372-10"><a href="categorization-models.html#cb372-10" tabindex="-1"></a><span class="co"># Plotting to make sure all looks right</span></span>
<span id="cb372-11"><a href="categorization-models.html#cb372-11" tabindex="-1"></a><span class="fu">ggplot</span>(stimuli, <span class="fu">aes</span>(position, height, <span class="at">color =</span> category, <span class="at">label =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb372-12"><a href="categorization-models.html#cb372-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb372-13"><a href="categorization-models.html#cb372-13" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb372-14"><a href="categorization-models.html#cb372-14" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb372-15"><a href="categorization-models.html#cb372-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="categorization-models.html#cb373-1" tabindex="-1"></a><span class="co"># Generating the sequence of stimuli in the full experiment</span></span>
<span id="cb373-2"><a href="categorization-models.html#cb373-2" tabindex="-1"></a>sequence <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb373-3"><a href="categorization-models.html#cb373-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb373-4"><a href="categorization-models.html#cb373-4" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">8</span>), <span class="dv">8</span>, <span class="at">replace =</span> F)</span>
<span id="cb373-5"><a href="categorization-models.html#cb373-5" tabindex="-1"></a>  sequence <span class="ot">&lt;-</span> <span class="fu">append</span>(sequence, temp)</span>
<span id="cb373-6"><a href="categorization-models.html#cb373-6" tabindex="-1"></a>}</span>
<span id="cb373-7"><a href="categorization-models.html#cb373-7" tabindex="-1"></a></span>
<span id="cb373-8"><a href="categorization-models.html#cb373-8" tabindex="-1"></a>experiment <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">stimulus =</span> sequence, <span class="at">height =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="cn">NA</span>, <span class="at">category =</span> <span class="cn">NA</span>)</span>
<span id="cb373-9"><a href="categorization-models.html#cb373-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment))) {</span>
<span id="cb373-10"><a href="categorization-models.html#cb373-10" tabindex="-1"></a>  experiment<span class="sc">$</span>height[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>height[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb373-11"><a href="categorization-models.html#cb373-11" tabindex="-1"></a>  experiment<span class="sc">$</span>position[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>position[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb373-12"><a href="categorization-models.html#cb373-12" tabindex="-1"></a>  experiment<span class="sc">$</span>category[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(stimuli<span class="sc">$</span>category[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]))</span>
<span id="cb373-13"><a href="categorization-models.html#cb373-13" tabindex="-1"></a>}</span></code></pre></div>
<p>We then have to simulate an agent using the GCM to assess the stimuli.
N.B. code based on work by Sara Østergaard</p>
<p>First we define functions for distance and similarity and assess them.
Distance takes feature values along n dimensions and calculate their euclidean distance,
weighing dimensions according to pregiven weights (w).
Similarity decays exponentially with distance, with a pre-given exponent (c). See plot.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="categorization-models.html#cb374-1" tabindex="-1"></a><span class="co"># Distance </span></span>
<span id="cb374-2"><a href="categorization-models.html#cb374-2" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="cf">function</span>(vect1, vect2, w) {</span>
<span id="cb374-3"><a href="categorization-models.html#cb374-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(w <span class="sc">*</span> <span class="fu">abs</span>(vect1 <span class="sc">-</span> vect2)))</span>
<span id="cb374-4"><a href="categorization-models.html#cb374-4" tabindex="-1"></a>}</span>
<span id="cb374-5"><a href="categorization-models.html#cb374-5" tabindex="-1"></a></span>
<span id="cb374-6"><a href="categorization-models.html#cb374-6" tabindex="-1"></a><span class="co"># Similarity</span></span>
<span id="cb374-7"><a href="categorization-models.html#cb374-7" tabindex="-1"></a>similarity <span class="ot">&lt;-</span> <span class="cf">function</span>(distance, c) {</span>
<span id="cb374-8"><a href="categorization-models.html#cb374-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>c <span class="sc">*</span> distance))</span>
<span id="cb374-9"><a href="categorization-models.html#cb374-9" tabindex="-1"></a>}</span>
<span id="cb374-10"><a href="categorization-models.html#cb374-10" tabindex="-1"></a></span>
<span id="cb374-11"><a href="categorization-models.html#cb374-11" tabindex="-1"></a><span class="co"># Let&#39;s assess similarity</span></span>
<span id="cb374-12"><a href="categorization-models.html#cb374-12" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb374-13"><a href="categorization-models.html#cb374-13" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb374-14"><a href="categorization-models.html#cb374-14" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>,.<span class="dv">2</span>, .<span class="dv">3</span>,.<span class="dv">4</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), </span>
<span id="cb374-15"><a href="categorization-models.html#cb374-15" tabindex="-1"></a>    <span class="at">c =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb374-16"><a href="categorization-models.html#cb374-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb374-17"><a href="categorization-models.html#cb374-17" tabindex="-1"></a>    <span class="at">similarity =</span> <span class="fu">similarity</span>(distance, c)</span>
<span id="cb374-18"><a href="categorization-models.html#cb374-18" tabindex="-1"></a>  )</span>
<span id="cb374-19"><a href="categorization-models.html#cb374-19" tabindex="-1"></a></span>
<span id="cb374-20"><a href="categorization-models.html#cb374-20" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb374-21"><a href="categorization-models.html#cb374-21" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb374-22"><a href="categorization-models.html#cb374-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(distance, similarity, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span> </span>
<span id="cb374-23"><a href="categorization-models.html#cb374-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="categorization-models.html#cb375-1" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
<p>With distance and similarity in place, we now need to implement an agent that can observe stimuli,
put them into categories according to feedback and - once enough stimuli are collected to have at
least one exemplar in each category - compare stimuli to exemplars in each category and assess
which category is more likely.
In other words: 1) if not enough stimuli have already been observed, the agent picks a category at random,
receives feedback and adjusts accordingly the category; otherwise, 2) it assesses average distance (according to weights) from observed exemplars by category; calculates similarity (according to c); and uses the relative similarity to the two categories to produce a probability of choosing category one. then it receives feedback and adjusts category accordingly.</p>
<p>As usual we make the agent a function, so that we can more easily deploy it.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="categorization-models.html#cb376-1" tabindex="-1"></a><span class="do">### generative model </span><span class="al">###</span></span>
<span id="cb376-2"><a href="categorization-models.html#cb376-2" tabindex="-1"></a>gcm <span class="ot">&lt;-</span> <span class="cf">function</span>(w, c, obs, cat_one, <span class="at">quiet =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb376-3"><a href="categorization-models.html#cb376-3" tabindex="-1"></a>  <span class="co"># create an empty list to save probability of saying &quot;1&quot; for each trial</span></span>
<span id="cb376-4"><a href="categorization-models.html#cb376-4" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb376-5"><a href="categorization-models.html#cb376-5" tabindex="-1"></a>  </span>
<span id="cb376-6"><a href="categorization-models.html#cb376-6" tabindex="-1"></a>  ntrials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb376-7"><a href="categorization-models.html#cb376-7" tabindex="-1"></a>  </span>
<span id="cb376-8"><a href="categorization-models.html#cb376-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ntrials) {</span>
<span id="cb376-9"><a href="categorization-models.html#cb376-9" tabindex="-1"></a>    <span class="co"># If quiet is FALSE, print every ten trials</span></span>
<span id="cb376-10"><a href="categorization-models.html#cb376-10" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>quiet <span class="sc">&amp;&amp;</span> i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb376-11"><a href="categorization-models.html#cb376-11" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;i =&quot;</span>, i))</span>
<span id="cb376-12"><a href="categorization-models.html#cb376-12" tabindex="-1"></a>    }</span>
<span id="cb376-13"><a href="categorization-models.html#cb376-13" tabindex="-1"></a>    <span class="co"># if this is the first trial, or there any category with no exemplars seen yet, set the choice to random</span></span>
<span id="cb376-14"><a href="categorization-models.html#cb376-14" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> (i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb376-15"><a href="categorization-models.html#cb376-15" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, .<span class="dv">5</span>)</span>
<span id="cb376-16"><a href="categorization-models.html#cb376-16" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb376-17"><a href="categorization-models.html#cb376-17" tabindex="-1"></a>      similarities <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb376-18"><a href="categorization-models.html#cb376-18" tabindex="-1"></a>      <span class="co"># for each previously seen stimulus assess distance and similarity</span></span>
<span id="cb376-19"><a href="categorization-models.html#cb376-19" tabindex="-1"></a>      <span class="cf">for</span> (e <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb376-20"><a href="categorization-models.html#cb376-20" tabindex="-1"></a>        sim <span class="ot">&lt;-</span> <span class="fu">similarity</span>(<span class="fu">distance</span>(obs[i, ], obs[e, ], w), c)</span>
<span id="cb376-21"><a href="categorization-models.html#cb376-21" tabindex="-1"></a>        similarities <span class="ot">&lt;-</span> <span class="fu">c</span>(similarities, sim)</span>
<span id="cb376-22"><a href="categorization-models.html#cb376-22" tabindex="-1"></a>      }</span>
<span id="cb376-23"><a href="categorization-models.html#cb376-23" tabindex="-1"></a>      <span class="co"># Calculate prob of saying &quot;1&quot; by dividing similarity to 1 by the sum of similarity to 1 and to 2</span></span>
<span id="cb376-24"><a href="categorization-models.html#cb376-24" tabindex="-1"></a>      numerator <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb376-25"><a href="categorization-models.html#cb376-25" tabindex="-1"></a>      denominator <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb376-26"><a href="categorization-models.html#cb376-26" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, numerator <span class="sc">/</span> denominator)</span>
<span id="cb376-27"><a href="categorization-models.html#cb376-27" tabindex="-1"></a>    }</span>
<span id="cb376-28"><a href="categorization-models.html#cb376-28" tabindex="-1"></a>  }</span>
<span id="cb376-29"><a href="categorization-models.html#cb376-29" tabindex="-1"></a></span>
<span id="cb376-30"><a href="categorization-models.html#cb376-30" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(ntrials, <span class="dv">1</span>, r))</span>
<span id="cb376-31"><a href="categorization-models.html#cb376-31" tabindex="-1"></a>}</span></code></pre></div>
<p>With the agent in place, we can now simulate behavior on our simulated stimuli and observe the impact of different weights and scaling parameters c.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="categorization-models.html#cb377-1" tabindex="-1"></a><span class="co"># function for simulation responses</span></span>
<span id="cb377-2"><a href="categorization-models.html#cb377-2" tabindex="-1"></a>simulate_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, w, c) {</span>
<span id="cb377-3"><a href="categorization-models.html#cb377-3" tabindex="-1"></a>    </span>
<span id="cb377-4"><a href="categorization-models.html#cb377-4" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb377-5"><a href="categorization-models.html#cb377-5" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))</span>
<span id="cb377-6"><a href="categorization-models.html#cb377-6" tabindex="-1"></a>    </span>
<span id="cb377-7"><a href="categorization-models.html#cb377-7" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category</span>
<span id="cb377-8"><a href="categorization-models.html#cb377-8" tabindex="-1"></a>    </span>
<span id="cb377-9"><a href="categorization-models.html#cb377-9" tabindex="-1"></a>    <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;equal&quot;</span>) {</span>
<span id="cb377-10"><a href="categorization-models.html#cb377-10" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb377-11"><a href="categorization-models.html#cb377-11" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed1&quot;</span>) {</span>
<span id="cb377-12"><a href="categorization-models.html#cb377-12" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb377-13"><a href="categorization-models.html#cb377-13" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed2&quot;</span>) {</span>
<span id="cb377-14"><a href="categorization-models.html#cb377-14" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)</span>
<span id="cb377-15"><a href="categorization-models.html#cb377-15" tabindex="-1"></a>    }</span>
<span id="cb377-16"><a href="categorization-models.html#cb377-16" tabindex="-1"></a></span>
<span id="cb377-17"><a href="categorization-models.html#cb377-17" tabindex="-1"></a>    <span class="co"># simulate responses</span></span>
<span id="cb377-18"><a href="categorization-models.html#cb377-18" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">gcm</span>(</span>
<span id="cb377-19"><a href="categorization-models.html#cb377-19" tabindex="-1"></a>        weight,</span>
<span id="cb377-20"><a href="categorization-models.html#cb377-20" tabindex="-1"></a>        c,</span>
<span id="cb377-21"><a href="categorization-models.html#cb377-21" tabindex="-1"></a>        observations,</span>
<span id="cb377-22"><a href="categorization-models.html#cb377-22" tabindex="-1"></a>        category</span>
<span id="cb377-23"><a href="categorization-models.html#cb377-23" tabindex="-1"></a>    )</span>
<span id="cb377-24"><a href="categorization-models.html#cb377-24" tabindex="-1"></a>    </span>
<span id="cb377-25"><a href="categorization-models.html#cb377-25" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb377-26"><a href="categorization-models.html#cb377-26" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb377-27"><a href="categorization-models.html#cb377-27" tabindex="-1"></a>            <span class="at">trial =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment)),</span>
<span id="cb377-28"><a href="categorization-models.html#cb377-28" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb377-29"><a href="categorization-models.html#cb377-29" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb377-30"><a href="categorization-models.html#cb377-30" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> <span class="fu">seq_along</span>(correct),</span>
<span id="cb377-31"><a href="categorization-models.html#cb377-31" tabindex="-1"></a>            <span class="at">c =</span> c,</span>
<span id="cb377-32"><a href="categorization-models.html#cb377-32" tabindex="-1"></a>            <span class="at">w =</span> w,</span>
<span id="cb377-33"><a href="categorization-models.html#cb377-33" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb377-34"><a href="categorization-models.html#cb377-34" tabindex="-1"></a>        )</span>
<span id="cb377-35"><a href="categorization-models.html#cb377-35" tabindex="-1"></a></span>
<span id="cb377-36"><a href="categorization-models.html#cb377-36" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb377-37"><a href="categorization-models.html#cb377-37" tabindex="-1"></a>}</span>
<span id="cb377-38"><a href="categorization-models.html#cb377-38" tabindex="-1"></a></span>
<span id="cb377-39"><a href="categorization-models.html#cb377-39" tabindex="-1"></a></span>
<span id="cb377-40"><a href="categorization-models.html#cb377-40" tabindex="-1"></a><span class="co"># simulate responses</span></span>
<span id="cb377-41"><a href="categorization-models.html#cb377-41" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb377-42"><a href="categorization-models.html#cb377-42" tabindex="-1"></a></span>
<span id="cb377-43"><a href="categorization-models.html#cb377-43" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb377-44"><a href="categorization-models.html#cb377-44" tabindex="-1"></a>    <span class="fu">expand_grid</span>(</span>
<span id="cb377-45"><a href="categorization-models.html#cb377-45" tabindex="-1"></a>        <span class="at">agent =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb377-46"><a href="categorization-models.html#cb377-46" tabindex="-1"></a>        <span class="at">c =</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.2</span>),</span>
<span id="cb377-47"><a href="categorization-models.html#cb377-47" tabindex="-1"></a>        <span class="at">w =</span> <span class="fu">c</span>(<span class="st">&quot;equal&quot;</span>, <span class="st">&quot;skewed1&quot;</span>, <span class="st">&quot;skewed2&quot;</span>)</span>
<span id="cb377-48"><a href="categorization-models.html#cb377-48" tabindex="-1"></a>    )</span>
<span id="cb377-49"><a href="categorization-models.html#cb377-49" tabindex="-1"></a>)</span>
<span id="cb377-50"><a href="categorization-models.html#cb377-50" tabindex="-1"></a></span>
<span id="cb377-51"><a href="categorization-models.html#cb377-51" tabindex="-1"></a>simulated_responses <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(param_df,</span>
<span id="cb377-52"><a href="categorization-models.html#cb377-52" tabindex="-1"></a>    simulate_responses,</span>
<span id="cb377-53"><a href="categorization-models.html#cb377-53" tabindex="-1"></a>    <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb377-54"><a href="categorization-models.html#cb377-54" tabindex="-1"></a>)</span></code></pre></div>
<p>And now we can try a few plots to better understand how the model fares and the difference made by weights and scaling factors.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="categorization-models.html#cb378-1" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb378-2"><a href="categorization-models.html#cb378-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">w =</span> <span class="fu">as.factor</span>(w)) <span class="sc">%&gt;%</span></span>
<span id="cb378-3"><a href="categorization-models.html#cb378-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> w, <span class="at">color =</span> w)) <span class="sc">+</span></span>
<span id="cb378-4"><a href="categorization-models.html#cb378-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb378-5"><a href="categorization-models.html#cb378-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb378-6"><a href="categorization-models.html#cb378-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(c <span class="sc">~</span> .)</span>
<span id="cb378-7"><a href="categorization-models.html#cb378-7" tabindex="-1"></a></span>
<span id="cb378-8"><a href="categorization-models.html#cb378-8" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb378-9"><a href="categorization-models.html#cb378-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb378-10"><a href="categorization-models.html#cb378-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span></span>
<span id="cb378-11"><a href="categorization-models.html#cb378-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb378-12"><a href="categorization-models.html#cb378-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb378-13"><a href="categorization-models.html#cb378-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(w <span class="sc">~</span> .)</span>
<span id="cb378-14"><a href="categorization-models.html#cb378-14" tabindex="-1"></a></span>
<span id="cb378-15"><a href="categorization-models.html#cb378-15" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="categorization-models.html#cb380-1" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb380-2"><a href="categorization-models.html#cb380-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb380-3"><a href="categorization-models.html#cb380-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(st, performance, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span></span>
<span id="cb380-4"><a href="categorization-models.html#cb380-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb380-5"><a href="categorization-models.html#cb380-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb380-6"><a href="categorization-models.html#cb380-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(w <span class="sc">~</span> .)</span></code></pre></div>
<p>[MISSING: Discussion of how to make sense of the plots: Equal Weights (matching the actual rule) generating better decisions as long as c is above 1]</p>
<p>While we could try different scenarios, let us now move on to inference. We need to build the same GCM model in Stan.</p>
<p>[MISSING: MORE DETAILED EXPLANATION]</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="categorization-models.html#cb381-1" tabindex="-1"></a>gcm_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb381-2"><a href="categorization-models.html#cb381-2" tabindex="-1"></a><span class="st">// Generalized Context Model (GCM)</span></span>
<span id="cb381-3"><a href="categorization-models.html#cb381-3" tabindex="-1"></a></span>
<span id="cb381-4"><a href="categorization-models.html#cb381-4" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb381-5"><a href="categorization-models.html#cb381-5" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; ntrials;  // number of trials</span></span>
<span id="cb381-6"><a href="categorization-models.html#cb381-6" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nfeatures;  // number of predefined relevant features</span></span>
<span id="cb381-7"><a href="categorization-models.html#cb381-7" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_one; // true responses on a trial by trial basis</span></span>
<span id="cb381-8"><a href="categorization-models.html#cb381-8" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; y;  // decisions on a trial by trial basis</span></span>
<span id="cb381-9"><a href="categorization-models.html#cb381-9" tabindex="-1"></a><span class="st">    array[ntrials, nfeatures] real obs; // stimuli as vectors of features</span></span>
<span id="cb381-10"><a href="categorization-models.html#cb381-10" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; b;  // initial bias for category one over two</span></span>
<span id="cb381-11"><a href="categorization-models.html#cb381-11" tabindex="-1"></a></span>
<span id="cb381-12"><a href="categorization-models.html#cb381-12" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb381-13"><a href="categorization-models.html#cb381-13" tabindex="-1"></a><span class="st">    vector[nfeatures] w_prior_values;  // concentration parameters for dirichlet distribution &lt;lower=1&gt;</span></span>
<span id="cb381-14"><a href="categorization-models.html#cb381-14" tabindex="-1"></a><span class="st">    array[2] real c_prior_values;  // mean and variance for logit-normal distribution</span></span>
<span id="cb381-15"><a href="categorization-models.html#cb381-15" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb381-16"><a href="categorization-models.html#cb381-16" tabindex="-1"></a></span>
<span id="cb381-17"><a href="categorization-models.html#cb381-17" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb381-18"><a href="categorization-models.html#cb381-18" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_two; // dummy variable for category two over cat 1</span></span>
<span id="cb381-19"><a href="categorization-models.html#cb381-19" tabindex="-1"></a><span class="st">    array[sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_one_idx; // array of which stimuli are cat 1</span></span>
<span id="cb381-20"><a href="categorization-models.html#cb381-20" tabindex="-1"></a><span class="st">    array[ntrials-sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_two_idx; //  array of which stimuli are cat 2</span></span>
<span id="cb381-21"><a href="categorization-models.html#cb381-21" tabindex="-1"></a><span class="st">    int idx_one = 1; // Initializing </span></span>
<span id="cb381-22"><a href="categorization-models.html#cb381-22" tabindex="-1"></a><span class="st">    int idx_two = 1;</span></span>
<span id="cb381-23"><a href="categorization-models.html#cb381-23" tabindex="-1"></a><span class="st">    for (i in 1:ntrials){</span></span>
<span id="cb381-24"><a href="categorization-models.html#cb381-24" tabindex="-1"></a><span class="st">        cat_two[i] = abs(cat_one[i]-1);</span></span>
<span id="cb381-25"><a href="categorization-models.html#cb381-25" tabindex="-1"></a></span>
<span id="cb381-26"><a href="categorization-models.html#cb381-26" tabindex="-1"></a><span class="st">        if (cat_one[i]==1){</span></span>
<span id="cb381-27"><a href="categorization-models.html#cb381-27" tabindex="-1"></a><span class="st">            cat_one_idx[idx_one] = i;</span></span>
<span id="cb381-28"><a href="categorization-models.html#cb381-28" tabindex="-1"></a><span class="st">            idx_one +=1;</span></span>
<span id="cb381-29"><a href="categorization-models.html#cb381-29" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb381-30"><a href="categorization-models.html#cb381-30" tabindex="-1"></a><span class="st">            cat_two_idx[idx_two] = i;</span></span>
<span id="cb381-31"><a href="categorization-models.html#cb381-31" tabindex="-1"></a><span class="st">            idx_two += 1;</span></span>
<span id="cb381-32"><a href="categorization-models.html#cb381-32" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb381-33"><a href="categorization-models.html#cb381-33" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb381-34"><a href="categorization-models.html#cb381-34" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb381-35"><a href="categorization-models.html#cb381-35" tabindex="-1"></a></span>
<span id="cb381-36"><a href="categorization-models.html#cb381-36" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb381-37"><a href="categorization-models.html#cb381-37" tabindex="-1"></a><span class="st">    simplex[nfeatures] w;  // simplex means sum(w)=1</span></span>
<span id="cb381-38"><a href="categorization-models.html#cb381-38" tabindex="-1"></a><span class="st">    real logit_c;</span></span>
<span id="cb381-39"><a href="categorization-models.html#cb381-39" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb381-40"><a href="categorization-models.html#cb381-40" tabindex="-1"></a></span>
<span id="cb381-41"><a href="categorization-models.html#cb381-41" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb381-42"><a href="categorization-models.html#cb381-42" tabindex="-1"></a><span class="st">    // parameter c </span></span>
<span id="cb381-43"><a href="categorization-models.html#cb381-43" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=2&gt; c = inv_logit(logit_c)*2;  // times 2 as c is bounded between 0 and 2</span></span>
<span id="cb381-44"><a href="categorization-models.html#cb381-44" tabindex="-1"></a></span>
<span id="cb381-45"><a href="categorization-models.html#cb381-45" tabindex="-1"></a><span class="st">    // parameter r (probability of response = category 1)</span></span>
<span id="cb381-46"><a href="categorization-models.html#cb381-46" tabindex="-1"></a><span class="st">    array[ntrials] real&lt;lower=0.0001, upper=0.9999&gt; r;</span></span>
<span id="cb381-47"><a href="categorization-models.html#cb381-47" tabindex="-1"></a><span class="st">    array[ntrials] real rr;</span></span>
<span id="cb381-48"><a href="categorization-models.html#cb381-48" tabindex="-1"></a></span>
<span id="cb381-49"><a href="categorization-models.html#cb381-49" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb381-50"><a href="categorization-models.html#cb381-50" tabindex="-1"></a></span>
<span id="cb381-51"><a href="categorization-models.html#cb381-51" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb381-52"><a href="categorization-models.html#cb381-52" tabindex="-1"></a><span class="st">        array[(i-1)] real exemplar_sim;</span></span>
<span id="cb381-53"><a href="categorization-models.html#cb381-53" tabindex="-1"></a><span class="st">        for (e in 1:(i-1)){</span></span>
<span id="cb381-54"><a href="categorization-models.html#cb381-54" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb381-55"><a href="categorization-models.html#cb381-55" tabindex="-1"></a><span class="st">            for (j in 1:nfeatures) {</span></span>
<span id="cb381-56"><a href="categorization-models.html#cb381-56" tabindex="-1"></a><span class="st">                tmp_dist[j] = w[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb381-57"><a href="categorization-models.html#cb381-57" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb381-58"><a href="categorization-models.html#cb381-58" tabindex="-1"></a><span class="st">            exemplar_sim[e] = exp(-c * sum(tmp_dist));</span></span>
<span id="cb381-59"><a href="categorization-models.html#cb381-59" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb381-60"><a href="categorization-models.html#cb381-60" tabindex="-1"></a></span>
<span id="cb381-61"><a href="categorization-models.html#cb381-61" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb381-62"><a href="categorization-models.html#cb381-62" tabindex="-1"></a><span class="st">            r[i] = 0.5;</span></span>
<span id="cb381-63"><a href="categorization-models.html#cb381-63" tabindex="-1"></a></span>
<span id="cb381-64"><a href="categorization-models.html#cb381-64" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb381-65"><a href="categorization-models.html#cb381-65" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb381-66"><a href="categorization-models.html#cb381-66" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb381-67"><a href="categorization-models.html#cb381-67" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb381-68"><a href="categorization-models.html#cb381-68" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb381-69"><a href="categorization-models.html#cb381-69" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb381-70"><a href="categorization-models.html#cb381-70" tabindex="-1"></a><span class="st">            similarities[1] = sum(exemplar_sim[tmp_idx_one]);</span></span>
<span id="cb381-71"><a href="categorization-models.html#cb381-71" tabindex="-1"></a><span class="st">            similarities[2] = sum(exemplar_sim[tmp_idx_two]);</span></span>
<span id="cb381-72"><a href="categorization-models.html#cb381-72" tabindex="-1"></a></span>
<span id="cb381-73"><a href="categorization-models.html#cb381-73" tabindex="-1"></a><span class="st">            // calculate r[i]</span></span>
<span id="cb381-74"><a href="categorization-models.html#cb381-74" tabindex="-1"></a><span class="st">            rr[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb381-75"><a href="categorization-models.html#cb381-75" tabindex="-1"></a></span>
<span id="cb381-76"><a href="categorization-models.html#cb381-76" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb381-77"><a href="categorization-models.html#cb381-77" tabindex="-1"></a><span class="st">            if (rr[i] &gt; 0.9999){</span></span>
<span id="cb381-78"><a href="categorization-models.html#cb381-78" tabindex="-1"></a><span class="st">                r[i] = 0.9999;</span></span>
<span id="cb381-79"><a href="categorization-models.html#cb381-79" tabindex="-1"></a><span class="st">            } else if (rr[i] &lt; 0.0001) {</span></span>
<span id="cb381-80"><a href="categorization-models.html#cb381-80" tabindex="-1"></a><span class="st">                r[i] = 0.0001;</span></span>
<span id="cb381-81"><a href="categorization-models.html#cb381-81" tabindex="-1"></a><span class="st">            } else if (rr[i] &gt; 0.0001 &amp;&amp; rr[i] &lt; 0.9999) {</span></span>
<span id="cb381-82"><a href="categorization-models.html#cb381-82" tabindex="-1"></a><span class="st">                r[i] = rr[i];</span></span>
<span id="cb381-83"><a href="categorization-models.html#cb381-83" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb381-84"><a href="categorization-models.html#cb381-84" tabindex="-1"></a><span class="st">                r[i] = 0.5;</span></span>
<span id="cb381-85"><a href="categorization-models.html#cb381-85" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb381-86"><a href="categorization-models.html#cb381-86" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb381-87"><a href="categorization-models.html#cb381-87" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb381-88"><a href="categorization-models.html#cb381-88" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb381-89"><a href="categorization-models.html#cb381-89" tabindex="-1"></a></span>
<span id="cb381-90"><a href="categorization-models.html#cb381-90" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb381-91"><a href="categorization-models.html#cb381-91" tabindex="-1"></a><span class="st">    // Priors</span></span>
<span id="cb381-92"><a href="categorization-models.html#cb381-92" tabindex="-1"></a><span class="st">    target += dirichlet_lpdf(w | w_prior_values);</span></span>
<span id="cb381-93"><a href="categorization-models.html#cb381-93" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c | c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb381-94"><a href="categorization-models.html#cb381-94" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb381-95"><a href="categorization-models.html#cb381-95" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb381-96"><a href="categorization-models.html#cb381-96" tabindex="-1"></a><span class="st">    // Decision Data</span></span>
<span id="cb381-97"><a href="categorization-models.html#cb381-97" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(y | r);</span></span>
<span id="cb381-98"><a href="categorization-models.html#cb381-98" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb381-99"><a href="categorization-models.html#cb381-99" tabindex="-1"></a></span>
<span id="cb381-100"><a href="categorization-models.html#cb381-100" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb381-101"><a href="categorization-models.html#cb381-101" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb381-102"><a href="categorization-models.html#cb381-102" tabindex="-1"></a><span class="st">    simplex[nfeatures] w_prior = dirichlet_rng(w_prior_values);</span></span>
<span id="cb381-103"><a href="categorization-models.html#cb381-103" tabindex="-1"></a><span class="st">    real logit_c_prior = normal_rng(c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb381-104"><a href="categorization-models.html#cb381-104" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=2&gt; c_prior = inv_logit(logit_c_prior)*2;</span></span>
<span id="cb381-105"><a href="categorization-models.html#cb381-105" tabindex="-1"></a></span>
<span id="cb381-106"><a href="categorization-models.html#cb381-106" tabindex="-1"></a><span class="st">    // prior pred</span></span>
<span id="cb381-107"><a href="categorization-models.html#cb381-107" tabindex="-1"></a><span class="st">    array[ntrials] real&lt;lower=0, upper=1&gt; r_prior;</span></span>
<span id="cb381-108"><a href="categorization-models.html#cb381-108" tabindex="-1"></a><span class="st">    array[ntrials] real rr_prior;</span></span>
<span id="cb381-109"><a href="categorization-models.html#cb381-109" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb381-110"><a href="categorization-models.html#cb381-110" tabindex="-1"></a></span>
<span id="cb381-111"><a href="categorization-models.html#cb381-111" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb381-112"><a href="categorization-models.html#cb381-112" tabindex="-1"></a><span class="st">        array[(i-1)] real exemplar_dist;</span></span>
<span id="cb381-113"><a href="categorization-models.html#cb381-113" tabindex="-1"></a><span class="st">        for (e in 1:(i-1)){</span></span>
<span id="cb381-114"><a href="categorization-models.html#cb381-114" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb381-115"><a href="categorization-models.html#cb381-115" tabindex="-1"></a><span class="st">            for (j in 1:nfeatures) {</span></span>
<span id="cb381-116"><a href="categorization-models.html#cb381-116" tabindex="-1"></a><span class="st">                tmp_dist[j] = w_prior[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb381-117"><a href="categorization-models.html#cb381-117" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb381-118"><a href="categorization-models.html#cb381-118" tabindex="-1"></a><span class="st">            exemplar_dist[e] = sum(tmp_dist);</span></span>
<span id="cb381-119"><a href="categorization-models.html#cb381-119" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb381-120"><a href="categorization-models.html#cb381-120" tabindex="-1"></a></span>
<span id="cb381-121"><a href="categorization-models.html#cb381-121" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb381-122"><a href="categorization-models.html#cb381-122" tabindex="-1"></a><span class="st">            r_prior[i] = 0.5;</span></span>
<span id="cb381-123"><a href="categorization-models.html#cb381-123" tabindex="-1"></a></span>
<span id="cb381-124"><a href="categorization-models.html#cb381-124" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb381-125"><a href="categorization-models.html#cb381-125" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb381-126"><a href="categorization-models.html#cb381-126" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb381-127"><a href="categorization-models.html#cb381-127" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb381-128"><a href="categorization-models.html#cb381-128" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb381-129"><a href="categorization-models.html#cb381-129" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb381-130"><a href="categorization-models.html#cb381-130" tabindex="-1"></a><span class="st">            similarities[1] = exp(-c_prior * sum(exemplar_dist[tmp_idx_one]));</span></span>
<span id="cb381-131"><a href="categorization-models.html#cb381-131" tabindex="-1"></a><span class="st">            similarities[2] = exp(-c_prior * sum(exemplar_dist[tmp_idx_two]));</span></span>
<span id="cb381-132"><a href="categorization-models.html#cb381-132" tabindex="-1"></a></span>
<span id="cb381-133"><a href="categorization-models.html#cb381-133" tabindex="-1"></a><span class="st">            // calculate r[i]</span></span>
<span id="cb381-134"><a href="categorization-models.html#cb381-134" tabindex="-1"></a><span class="st">            rr_prior[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb381-135"><a href="categorization-models.html#cb381-135" tabindex="-1"></a></span>
<span id="cb381-136"><a href="categorization-models.html#cb381-136" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb381-137"><a href="categorization-models.html#cb381-137" tabindex="-1"></a><span class="st">            if (rr_prior[i] == 1){</span></span>
<span id="cb381-138"><a href="categorization-models.html#cb381-138" tabindex="-1"></a><span class="st">                r_prior[i] = 0.9999;</span></span>
<span id="cb381-139"><a href="categorization-models.html#cb381-139" tabindex="-1"></a><span class="st">            } else if (rr_prior[i] == 0) {</span></span>
<span id="cb381-140"><a href="categorization-models.html#cb381-140" tabindex="-1"></a><span class="st">                r_prior[i] = 0.0001;</span></span>
<span id="cb381-141"><a href="categorization-models.html#cb381-141" tabindex="-1"></a><span class="st">            } else if (rr_prior[i] &gt; 0 &amp;&amp; rr_prior[i] &lt; 1) {</span></span>
<span id="cb381-142"><a href="categorization-models.html#cb381-142" tabindex="-1"></a><span class="st">                r_prior[i] = rr_prior[i];</span></span>
<span id="cb381-143"><a href="categorization-models.html#cb381-143" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb381-144"><a href="categorization-models.html#cb381-144" tabindex="-1"></a><span class="st">                r_prior[i] = 0.5;</span></span>
<span id="cb381-145"><a href="categorization-models.html#cb381-145" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb381-146"><a href="categorization-models.html#cb381-146" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb381-147"><a href="categorization-models.html#cb381-147" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb381-148"><a href="categorization-models.html#cb381-148" tabindex="-1"></a></span>
<span id="cb381-149"><a href="categorization-models.html#cb381-149" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; priorpred = bernoulli_rng(r_prior);</span></span>
<span id="cb381-150"><a href="categorization-models.html#cb381-150" tabindex="-1"></a></span>
<span id="cb381-151"><a href="categorization-models.html#cb381-151" tabindex="-1"></a><span class="st">    // posterior pred</span></span>
<span id="cb381-152"><a href="categorization-models.html#cb381-152" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; posteriorpred = bernoulli_rng(r);</span></span>
<span id="cb381-153"><a href="categorization-models.html#cb381-153" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; posteriorcorrect;</span></span>
<span id="cb381-154"><a href="categorization-models.html#cb381-154" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb381-155"><a href="categorization-models.html#cb381-155" tabindex="-1"></a><span class="st">        if (posteriorpred[i] == cat_one[i]) {</span></span>
<span id="cb381-156"><a href="categorization-models.html#cb381-156" tabindex="-1"></a><span class="st">            posteriorcorrect[i] = 1;</span></span>
<span id="cb381-157"><a href="categorization-models.html#cb381-157" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb381-158"><a href="categorization-models.html#cb381-158" tabindex="-1"></a><span class="st">            posteriorcorrect[i] = 0;</span></span>
<span id="cb381-159"><a href="categorization-models.html#cb381-159" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb381-160"><a href="categorization-models.html#cb381-160" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb381-161"><a href="categorization-models.html#cb381-161" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb381-162"><a href="categorization-models.html#cb381-162" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb381-163"><a href="categorization-models.html#cb381-163" tabindex="-1"></a><span class="st">    // log likelihood</span></span>
<span id="cb381-164"><a href="categorization-models.html#cb381-164" tabindex="-1"></a><span class="st">   array[ntrials] real log_lik;</span></span>
<span id="cb381-165"><a href="categorization-models.html#cb381-165" tabindex="-1"></a></span>
<span id="cb381-166"><a href="categorization-models.html#cb381-166" tabindex="-1"></a><span class="st">   for (i in 1:ntrials) {</span></span>
<span id="cb381-167"><a href="categorization-models.html#cb381-167" tabindex="-1"></a><span class="st">        log_lik[i] = bernoulli_lpmf(y[i] | r[i]);</span></span>
<span id="cb381-168"><a href="categorization-models.html#cb381-168" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb381-169"><a href="categorization-models.html#cb381-169" tabindex="-1"></a></span>
<span id="cb381-170"><a href="categorization-models.html#cb381-170" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb381-171"><a href="categorization-models.html#cb381-171" tabindex="-1"></a></span>
<span id="cb381-172"><a href="categorization-models.html#cb381-172" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb381-173"><a href="categorization-models.html#cb381-173" tabindex="-1"></a>  gcm_model,</span>
<span id="cb381-174"><a href="categorization-models.html#cb381-174" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb381-175"><a href="categorization-models.html#cb381-175" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10_GCM.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10_GCM.stan&quot;</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="categorization-models.html#cb383-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10_GCM.stan&quot;</span>)</span>
<span id="cb383-2"><a href="categorization-models.html#cb383-2" tabindex="-1"></a>mod_GCM <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb383-3"><a href="categorization-models.html#cb383-3" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span></code></pre></div>
<p>Now it’s time to fit the data</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="categorization-models.html#cb384-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb384-2"><a href="categorization-models.html#cb384-2" tabindex="-1"></a>  c <span class="sc">==</span> <span class="st">&quot;1.1&quot;</span> <span class="sc">&amp;</span> w <span class="sc">==</span> <span class="st">&quot;equal&quot;</span></span>
<span id="cb384-3"><a href="categorization-models.html#cb384-3" tabindex="-1"></a>)</span>
<span id="cb384-4"><a href="categorization-models.html#cb384-4" tabindex="-1"></a></span>
<span id="cb384-5"><a href="categorization-models.html#cb384-5" tabindex="-1"></a>gcm_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb384-6"><a href="categorization-models.html#cb384-6" tabindex="-1"></a>  <span class="at">ntrials =</span> <span class="fu">nrow</span>(d),</span>
<span id="cb384-7"><a href="categorization-models.html#cb384-7" tabindex="-1"></a>  <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb384-8"><a href="categorization-models.html#cb384-8" tabindex="-1"></a>  <span class="at">cat_one =</span> d<span class="sc">$</span>category,</span>
<span id="cb384-9"><a href="categorization-models.html#cb384-9" tabindex="-1"></a>  <span class="at">y =</span> d<span class="sc">$</span>sim_response,</span>
<span id="cb384-10"><a href="categorization-models.html#cb384-10" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(d[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb384-11"><a href="categorization-models.html#cb384-11" tabindex="-1"></a>  <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb384-12"><a href="categorization-models.html#cb384-12" tabindex="-1"></a>  <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb384-13"><a href="categorization-models.html#cb384-13" tabindex="-1"></a>  <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb384-14"><a href="categorization-models.html#cb384-14" tabindex="-1"></a>)</span>
<span id="cb384-15"><a href="categorization-models.html#cb384-15" tabindex="-1"></a></span>
<span id="cb384-16"><a href="categorization-models.html#cb384-16" tabindex="-1"></a>samples_gcm <span class="ot">&lt;-</span> mod_GCM<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb384-17"><a href="categorization-models.html#cb384-17" tabindex="-1"></a>  <span class="at">data =</span> gcm_data,</span>
<span id="cb384-18"><a href="categorization-models.html#cb384-18" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb384-19"><a href="categorization-models.html#cb384-19" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb384-20"><a href="categorization-models.html#cb384-20" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb384-21"><a href="categorization-models.html#cb384-21" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">4</span>,</span>
<span id="cb384-22"><a href="categorization-models.html#cb384-22" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb384-23"><a href="categorization-models.html#cb384-23" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb384-24"><a href="categorization-models.html#cb384-24" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb384-25"><a href="categorization-models.html#cb384-25" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 1 chain, with 4 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 299.6 seconds.</code></pre>
<p>Now we need to check the model</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="categorization-models.html#cb386-1" tabindex="-1"></a>samples_gcm<span class="sc">$</span><span class="fu">cmdstan_diagnose</span>()</span></code></pre></div>
<pre><code>## Processing csv files: /var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpYpbuAD/W10_GCM-202402021443-1-7d5146.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="categorization-models.html#cb388-1" tabindex="-1"></a>samples_gcm<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5,129 × 10
##    variable     mean   median     sd    mad       q5      q95  rhat ess_bulk ess_tail
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 lp__     -412.    -411.    1.05   0.738  -414.    -411.     1.01     452.     508.
##  2 w[1]        0.452    0.453 0.0755 0.0805    0.327    0.572  1.00     790.     646.
##  3 w[2]        0.548    0.547 0.0755 0.0805    0.428    0.673  1.00     790.     646.
##  4 logit_c    -0.448   -0.444 0.176  0.168    -0.739   -0.161  1.01     799.     435.
##  5 c           0.781    0.781 0.0827 0.0798    0.647    0.920  1.01     799.     435.
##  6 r[1]        0.5      0.5   0      0         0.5      0.5   NA         NA       NA 
##  7 r[2]        0.5      0.5   0      0         0.5      0.5   NA         NA       NA 
##  8 r[3]        0.314    0.314 0.0178 0.0172    0.285    0.344  1.01     799.     435.
##  9 r[4]        0.226    0.226 0.0236 0.0239    0.189    0.265  1.00     796.     541.
## 10 r[5]        0.233    0.230 0.0400 0.0428    0.171    0.303  1.00     810.     734.
## # ℹ 5,119 more rows</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="categorization-models.html#cb390-1" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb390-2"><a href="categorization-models.html#cb390-2" tabindex="-1"></a></span>
<span id="cb390-3"><a href="categorization-models.html#cb390-3" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, c, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb390-4"><a href="categorization-models.html#cb390-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb390-5"><a href="categorization-models.html#cb390-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="categorization-models.html#cb391-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, logit_c, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb391-2"><a href="categorization-models.html#cb391-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb391-3"><a href="categorization-models.html#cb391-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="categorization-models.html#cb392-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb392-2"><a href="categorization-models.html#cb392-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb392-3"><a href="categorization-models.html#cb392-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="categorization-models.html#cb393-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb393-2"><a href="categorization-models.html#cb393-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb393-3"><a href="categorization-models.html#cb393-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-4.png" width="672" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="categorization-models.html#cb394-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb394-2"><a href="categorization-models.html#cb394-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-3"><a href="categorization-models.html#cb394-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-4"><a href="categorization-models.html#cb394-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d<span class="sc">$</span>c[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb394-5"><a href="categorization-models.html#cb394-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-5.png" width="672" /></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="categorization-models.html#cb396-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb396-2"><a href="categorization-models.html#cb396-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb396-3"><a href="categorization-models.html#cb396-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb396-4"><a href="categorization-models.html#cb396-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb396-5"><a href="categorization-models.html#cb396-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-6.png" width="672" /></p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="categorization-models.html#cb398-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb398-2"><a href="categorization-models.html#cb398-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb398-3"><a href="categorization-models.html#cb398-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb398-4"><a href="categorization-models.html#cb398-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb398-5"><a href="categorization-models.html#cb398-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-7.png" width="672" /></p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="categorization-models.html#cb400-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb400-2"><a href="categorization-models.html#cb400-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(c, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb400-3"><a href="categorization-models.html#cb400-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-8.png" width="672" /></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="categorization-models.html#cb401-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb401-2"><a href="categorization-models.html#cb401-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(c, <span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb401-3"><a href="categorization-models.html#cb401-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-9.png" width="672" /></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="categorization-models.html#cb402-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb402-2"><a href="categorization-models.html#cb402-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb402-3"><a href="categorization-models.html#cb402-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-10.png" width="672" /></p>
<p>C looks like crap, while weights seem decently recovered. Let’s look at the larger picture, but looping through the different combinations of parameter values.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="categorization-models.html#cb403-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(future, purrr, furrr)</span>
<span id="cb403-2"><a href="categorization-models.html#cb403-2" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb403-3"><a href="categorization-models.html#cb403-3" tabindex="-1"></a></span>
<span id="cb403-4"><a href="categorization-models.html#cb403-4" tabindex="-1"></a>sim_d_and_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, scaling, weights) {</span>
<span id="cb403-5"><a href="categorization-models.html#cb403-5" tabindex="-1"></a>  </span>
<span id="cb403-6"><a href="categorization-models.html#cb403-6" tabindex="-1"></a>    </span>
<span id="cb403-7"><a href="categorization-models.html#cb403-7" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb403-8"><a href="categorization-models.html#cb403-8" tabindex="-1"></a>      c <span class="sc">==</span> scaling <span class="sc">&amp;</span> w <span class="sc">==</span> weights <span class="sc">&amp;</span> agent <span class="sc">==</span> agent</span>
<span id="cb403-9"><a href="categorization-models.html#cb403-9" tabindex="-1"></a>      )</span>
<span id="cb403-10"><a href="categorization-models.html#cb403-10" tabindex="-1"></a>    </span>
<span id="cb403-11"><a href="categorization-models.html#cb403-11" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb403-12"><a href="categorization-models.html#cb403-12" tabindex="-1"></a>      <span class="at">ntrials =</span> <span class="fu">nrow</span>(temp),</span>
<span id="cb403-13"><a href="categorization-models.html#cb403-13" tabindex="-1"></a>      <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb403-14"><a href="categorization-models.html#cb403-14" tabindex="-1"></a>      <span class="at">cat_one =</span> temp<span class="sc">$</span>category,</span>
<span id="cb403-15"><a href="categorization-models.html#cb403-15" tabindex="-1"></a>      <span class="at">y =</span> temp<span class="sc">$</span>sim_response,</span>
<span id="cb403-16"><a href="categorization-models.html#cb403-16" tabindex="-1"></a>      <span class="at">obs =</span> <span class="fu">as.matrix</span>(temp[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb403-17"><a href="categorization-models.html#cb403-17" tabindex="-1"></a>      <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb403-18"><a href="categorization-models.html#cb403-18" tabindex="-1"></a>      <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb403-19"><a href="categorization-models.html#cb403-19" tabindex="-1"></a>      <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb403-20"><a href="categorization-models.html#cb403-20" tabindex="-1"></a>    )</span>
<span id="cb403-21"><a href="categorization-models.html#cb403-21" tabindex="-1"></a>    </span>
<span id="cb403-22"><a href="categorization-models.html#cb403-22" tabindex="-1"></a>    samples_gcm <span class="ot">&lt;-</span> mod_GCM<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb403-23"><a href="categorization-models.html#cb403-23" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb403-24"><a href="categorization-models.html#cb403-24" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb403-25"><a href="categorization-models.html#cb403-25" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb403-26"><a href="categorization-models.html#cb403-26" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb403-27"><a href="categorization-models.html#cb403-27" tabindex="-1"></a>      <span class="at">threads_per_chain =</span> <span class="dv">4</span>,</span>
<span id="cb403-28"><a href="categorization-models.html#cb403-28" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb403-29"><a href="categorization-models.html#cb403-29" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb403-30"><a href="categorization-models.html#cb403-30" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb403-31"><a href="categorization-models.html#cb403-31" tabindex="-1"></a>    )</span>
<span id="cb403-32"><a href="categorization-models.html#cb403-32" tabindex="-1"></a>    </span>
<span id="cb403-33"><a href="categorization-models.html#cb403-33" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb403-34"><a href="categorization-models.html#cb403-34" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trueC =</span> scaling, <span class="at">trueW =</span> weights, <span class="at">agent =</span> agent,</span>
<span id="cb403-35"><a href="categorization-models.html#cb403-35" tabindex="-1"></a>                   <span class="at">estC =</span> draws_df<span class="sc">$</span>c, </span>
<span id="cb403-36"><a href="categorization-models.html#cb403-36" tabindex="-1"></a>                   <span class="at">estW1 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>,</span>
<span id="cb403-37"><a href="categorization-models.html#cb403-37" tabindex="-1"></a>                   <span class="at">estW2 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[2]</span><span class="st">`</span></span>
<span id="cb403-38"><a href="categorization-models.html#cb403-38" tabindex="-1"></a>                   )</span>
<span id="cb403-39"><a href="categorization-models.html#cb403-39" tabindex="-1"></a>    </span>
<span id="cb403-40"><a href="categorization-models.html#cb403-40" tabindex="-1"></a>    <span class="fu">return</span>(temp)</span>
<span id="cb403-41"><a href="categorization-models.html#cb403-41" tabindex="-1"></a>  </span>
<span id="cb403-42"><a href="categorization-models.html#cb403-42" tabindex="-1"></a>}</span>
<span id="cb403-43"><a href="categorization-models.html#cb403-43" tabindex="-1"></a></span>
<span id="cb403-44"><a href="categorization-models.html#cb403-44" tabindex="-1"></a></span>
<span id="cb403-45"><a href="categorization-models.html#cb403-45" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">unique</span>(simulated_responses[,<span class="fu">c</span>(<span class="st">&quot;agent&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;w&quot;</span>)])) <span class="sc">%&gt;%</span></span>
<span id="cb403-46"><a href="categorization-models.html#cb403-46" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb403-47"><a href="categorization-models.html#cb403-47" tabindex="-1"></a>    <span class="at">scaling =</span> c,</span>
<span id="cb403-48"><a href="categorization-models.html#cb403-48" tabindex="-1"></a>    <span class="at">weights =</span> w</span>
<span id="cb403-49"><a href="categorization-models.html#cb403-49" tabindex="-1"></a>  )</span>
<span id="cb403-50"><a href="categorization-models.html#cb403-50" tabindex="-1"></a></span>
<span id="cb403-51"><a href="categorization-models.html#cb403-51" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(temp, sim_d_and_fit, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb403-52"><a href="categorization-models.html#cb403-52" tabindex="-1"></a></span>
<span id="cb403-53"><a href="categorization-models.html#cb403-53" tabindex="-1"></a><span class="fu">write_csv</span>(recovery_df, <span class="st">&quot;simdata/W10_GCM_recoverydf.csv&quot;</span>)</span></code></pre></div>
<p>Time to visualize</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="categorization-models.html#cb404-1" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;simdata/W10_GCM_recoverydf.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 300000 Columns: 6
## ── Column specification ─────────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): trueW
## dbl (5): trueC, agent, estC, estW1, estW2
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="categorization-models.html#cb406-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb406-2"><a href="categorization-models.html#cb406-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estC, <span class="at">group =</span> trueW, <span class="at">fill =</span> trueW), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb406-3"><a href="categorization-models.html#cb406-3" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = trueC) +</span></span>
<span id="cb406-4"><a href="categorization-models.html#cb406-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> trueC) <span class="sc">+</span></span>
<span id="cb406-5"><a href="categorization-models.html#cb406-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb406-6"><a href="categorization-models.html#cb406-6" tabindex="-1"></a></span>
<span id="cb406-7"><a href="categorization-models.html#cb406-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb406-8"><a href="categorization-models.html#cb406-8" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estW1, <span class="at">group =</span> trueW, <span class="at">fill =</span> trueW), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb406-9"><a href="categorization-models.html#cb406-9" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = trueC) +</span></span>
<span id="cb406-10"><a href="categorization-models.html#cb406-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(trueC <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb406-11"><a href="categorization-models.html#cb406-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb406-12"><a href="categorization-models.html#cb406-12" tabindex="-1"></a></span>
<span id="cb406-13"><a href="categorization-models.html#cb406-13" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div id="multilevel-gcm" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Multilevel GCM<a href="categorization-models.html#multilevel-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>[MISSING: quick reminder of what it means to make GCM multilevel: weights and can vary by participants, but they do not do so in correlated ways]</p>
<div id="simulate-hierarchical-simplices" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Simulate hierarchical simplices<a href="categorization-models.html#simulate-hierarchical-simplices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need weights that sum up to 1 at the population level and at the individual level. Let’s simulate the dirichlet distribution to see how it does it.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="categorization-models.html#cb407-1" tabindex="-1"></a>simulate_dirichlet <span class="ot">&lt;-</span> <span class="cf">function</span>(weights, kappa, agents){</span>
<span id="cb407-2"><a href="categorization-models.html#cb407-2" tabindex="-1"></a>  </span>
<span id="cb407-3"><a href="categorization-models.html#cb407-3" tabindex="-1"></a>  w_n <span class="ot">&lt;-</span> <span class="fu">length</span>(weights)</span>
<span id="cb407-4"><a href="categorization-models.html#cb407-4" tabindex="-1"></a>  </span>
<span id="cb407-5"><a href="categorization-models.html#cb407-5" tabindex="-1"></a>  w_ind <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(agents, weights <span class="sc">*</span> kappa)</span>
<span id="cb407-6"><a href="categorization-models.html#cb407-6" tabindex="-1"></a>  </span>
<span id="cb407-7"><a href="categorization-models.html#cb407-7" tabindex="-1"></a>  w_ind_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb407-8"><a href="categorization-models.html#cb407-8" tabindex="-1"></a>    <span class="at">agent =</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(agents), <span class="at">each =</span> w_n)),</span>
<span id="cb407-9"><a href="categorization-models.html#cb407-9" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(w_ind),</span>
<span id="cb407-10"><a href="categorization-models.html#cb407-10" tabindex="-1"></a>    <span class="at">weight =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(w_n), agents)</span>
<span id="cb407-11"><a href="categorization-models.html#cb407-11" tabindex="-1"></a>  )</span>
<span id="cb407-12"><a href="categorization-models.html#cb407-12" tabindex="-1"></a>  </span>
<span id="cb407-13"><a href="categorization-models.html#cb407-13" tabindex="-1"></a>  <span class="fu">return</span>(w_ind_df)</span>
<span id="cb407-14"><a href="categorization-models.html#cb407-14" tabindex="-1"></a>}</span>
<span id="cb407-15"><a href="categorization-models.html#cb407-15" tabindex="-1"></a></span>
<span id="cb407-16"><a href="categorization-models.html#cb407-16" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_dirichlet</span>(<span class="at">weights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">kappa =</span> <span class="dv">100</span>, <span class="at">agents =</span> <span class="dv">10</span>)</span>
<span id="cb407-17"><a href="categorization-models.html#cb407-17" tabindex="-1"></a></span>
<span id="cb407-18"><a href="categorization-models.html#cb407-18" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(weight, value, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb407-19"><a href="categorization-models.html#cb407-19" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb407-20"><a href="categorization-models.html#cb407-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb407-21"><a href="categorization-models.html#cb407-21" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb407-22"><a href="categorization-models.html#cb407-22" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb407-23"><a href="categorization-models.html#cb407-23" tabindex="-1"></a></span>
<span id="cb407-24"><a href="categorization-models.html#cb407-24" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_dirichlet</span>(<span class="at">weights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">kappa =</span> <span class="dv">1</span>, <span class="at">agents =</span> <span class="dv">10</span>)</span>
<span id="cb407-25"><a href="categorization-models.html#cb407-25" tabindex="-1"></a></span>
<span id="cb407-26"><a href="categorization-models.html#cb407-26" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(weight, value, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb407-27"><a href="categorization-models.html#cb407-27" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb407-28"><a href="categorization-models.html#cb407-28" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb407-29"><a href="categorization-models.html#cb407-29" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb407-30"><a href="categorization-models.html#cb407-30" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb407-31"><a href="categorization-models.html#cb407-31" tabindex="-1"></a></span>
<span id="cb407-32"><a href="categorization-models.html#cb407-32" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="set-up-the-data-simulation" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Set up the data simulation<a href="categorization-models.html#set-up-the-data-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need to feed:
- agents
- scaling (M and SD)
- weights (weights and concentration)</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="categorization-models.html#cb408-1" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb408-2"><a href="categorization-models.html#cb408-2" tabindex="-1"></a>scalingM <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb408-3"><a href="categorization-models.html#cb408-3" tabindex="-1"></a>scalingSD <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb408-4"><a href="categorization-models.html#cb408-4" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb408-5"><a href="categorization-models.html#cb408-5" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb408-6"><a href="categorization-models.html#cb408-6" tabindex="-1"></a></span>
<span id="cb408-7"><a href="categorization-models.html#cb408-7" tabindex="-1"></a><span class="co"># First one agent, just to make sure it works</span></span>
<span id="cb408-8"><a href="categorization-models.html#cb408-8" tabindex="-1"></a>simulate_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, weights, c) {</span>
<span id="cb408-9"><a href="categorization-models.html#cb408-9" tabindex="-1"></a>    </span>
<span id="cb408-10"><a href="categorization-models.html#cb408-10" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb408-11"><a href="categorization-models.html#cb408-11" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))</span>
<span id="cb408-12"><a href="categorization-models.html#cb408-12" tabindex="-1"></a>    </span>
<span id="cb408-13"><a href="categorization-models.html#cb408-13" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category</span>
<span id="cb408-14"><a href="categorization-models.html#cb408-14" tabindex="-1"></a>    </span>
<span id="cb408-15"><a href="categorization-models.html#cb408-15" tabindex="-1"></a>    <span class="co"># simulate responses</span></span>
<span id="cb408-16"><a href="categorization-models.html#cb408-16" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">gcm</span>(</span>
<span id="cb408-17"><a href="categorization-models.html#cb408-17" tabindex="-1"></a>        weights,</span>
<span id="cb408-18"><a href="categorization-models.html#cb408-18" tabindex="-1"></a>        c,</span>
<span id="cb408-19"><a href="categorization-models.html#cb408-19" tabindex="-1"></a>        observations,</span>
<span id="cb408-20"><a href="categorization-models.html#cb408-20" tabindex="-1"></a>        category</span>
<span id="cb408-21"><a href="categorization-models.html#cb408-21" tabindex="-1"></a>    )</span>
<span id="cb408-22"><a href="categorization-models.html#cb408-22" tabindex="-1"></a>    </span>
<span id="cb408-23"><a href="categorization-models.html#cb408-23" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb408-24"><a href="categorization-models.html#cb408-24" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb408-25"><a href="categorization-models.html#cb408-25" tabindex="-1"></a>            <span class="at">trial =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment)),</span>
<span id="cb408-26"><a href="categorization-models.html#cb408-26" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb408-27"><a href="categorization-models.html#cb408-27" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb408-28"><a href="categorization-models.html#cb408-28" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> <span class="fu">seq_along</span>(correct),</span>
<span id="cb408-29"><a href="categorization-models.html#cb408-29" tabindex="-1"></a>            <span class="at">c =</span> c,</span>
<span id="cb408-30"><a href="categorization-models.html#cb408-30" tabindex="-1"></a>            <span class="at">w1 =</span> weights[<span class="dv">1</span>],</span>
<span id="cb408-31"><a href="categorization-models.html#cb408-31" tabindex="-1"></a>            <span class="at">w2 =</span> weights[<span class="dv">2</span>],</span>
<span id="cb408-32"><a href="categorization-models.html#cb408-32" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb408-33"><a href="categorization-models.html#cb408-33" tabindex="-1"></a>        )</span>
<span id="cb408-34"><a href="categorization-models.html#cb408-34" tabindex="-1"></a></span>
<span id="cb408-35"><a href="categorization-models.html#cb408-35" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb408-36"><a href="categorization-models.html#cb408-36" tabindex="-1"></a>}</span>
<span id="cb408-37"><a href="categorization-models.html#cb408-37" tabindex="-1"></a></span>
<span id="cb408-38"><a href="categorization-models.html#cb408-38" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_responses</span>(agents, weights, scalingM)</span>
<span id="cb408-39"><a href="categorization-models.html#cb408-39" tabindex="-1"></a></span>
<span id="cb408-40"><a href="categorization-models.html#cb408-40" tabindex="-1"></a><span class="do">## Then we make sure to simulate n agents</span></span>
<span id="cb408-41"><a href="categorization-models.html#cb408-41" tabindex="-1"></a></span>
<span id="cb408-42"><a href="categorization-models.html#cb408-42" tabindex="-1"></a>simulate_ml_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agents, scalingM, scalingSD, weights, kappa) {</span>
<span id="cb408-43"><a href="categorization-models.html#cb408-43" tabindex="-1"></a>  </span>
<span id="cb408-44"><a href="categorization-models.html#cb408-44" tabindex="-1"></a>  w_ind <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(agents, weights <span class="sc">*</span> kappa)</span>
<span id="cb408-45"><a href="categorization-models.html#cb408-45" tabindex="-1"></a>  c_ind <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(agents, scalingM, scalingSD)</span>
<span id="cb408-46"><a href="categorization-models.html#cb408-46" tabindex="-1"></a>  </span>
<span id="cb408-47"><a href="categorization-models.html#cb408-47" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb408-48"><a href="categorization-models.html#cb408-48" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">simulate_responses</span>(i, <span class="at">weights =</span> <span class="fu">c</span>(w_ind[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="at">c =</span> c_ind[i])</span>
<span id="cb408-49"><a href="categorization-models.html#cb408-49" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb408-50"><a href="categorization-models.html#cb408-50" tabindex="-1"></a>      simulated_responses <span class="ot">&lt;-</span> tmp</span>
<span id="cb408-51"><a href="categorization-models.html#cb408-51" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb408-52"><a href="categorization-models.html#cb408-52" tabindex="-1"></a>      simulated_responses <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simulated_responses, tmp)</span>
<span id="cb408-53"><a href="categorization-models.html#cb408-53" tabindex="-1"></a>    }</span>
<span id="cb408-54"><a href="categorization-models.html#cb408-54" tabindex="-1"></a>  }</span>
<span id="cb408-55"><a href="categorization-models.html#cb408-55" tabindex="-1"></a>  </span>
<span id="cb408-56"><a href="categorization-models.html#cb408-56" tabindex="-1"></a>  <span class="fu">return</span>(simulated_responses)</span>
<span id="cb408-57"><a href="categorization-models.html#cb408-57" tabindex="-1"></a>}</span>
<span id="cb408-58"><a href="categorization-models.html#cb408-58" tabindex="-1"></a></span>
<span id="cb408-59"><a href="categorization-models.html#cb408-59" tabindex="-1"></a><span class="co"># Simulate and visualize</span></span>
<span id="cb408-60"><a href="categorization-models.html#cb408-60" tabindex="-1"></a></span>
<span id="cb408-61"><a href="categorization-models.html#cb408-61" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_ml_responses</span>(agents, scalingM, scalingSD, weights, kappa)</span>
<span id="cb408-62"><a href="categorization-models.html#cb408-62" tabindex="-1"></a></span>
<span id="cb408-63"><a href="categorization-models.html#cb408-63" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, performance)) <span class="sc">+</span></span>
<span id="cb408-64"><a href="categorization-models.html#cb408-64" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb408-65"><a href="categorization-models.html#cb408-65" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb408-66"><a href="categorization-models.html#cb408-66" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="set-up-the-stan-model" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Set up the Stan model<a href="categorization-models.html#set-up-the-stan-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="categorization-models.html#cb410-1" tabindex="-1"></a>gcm_ml_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb410-2"><a href="categorization-models.html#cb410-2" tabindex="-1"></a><span class="st">// Generalized Context Model (GCM) - multilevel version</span></span>
<span id="cb410-3"><a href="categorization-models.html#cb410-3" tabindex="-1"></a></span>
<span id="cb410-4"><a href="categorization-models.html#cb410-4" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb410-5"><a href="categorization-models.html#cb410-5" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nsubjects;  // number of subjects</span></span>
<span id="cb410-6"><a href="categorization-models.html#cb410-6" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; ntrials;  // number of trials</span></span>
<span id="cb410-7"><a href="categorization-models.html#cb410-7" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nfeatures;  // number of predefined relevant features</span></span>
<span id="cb410-8"><a href="categorization-models.html#cb410-8" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_one; // true responses on a trial by trial basis</span></span>
<span id="cb410-9"><a href="categorization-models.html#cb410-9" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] int&lt;lower=0, upper=1&gt; y;  // decisions on a trial by trial basis</span></span>
<span id="cb410-10"><a href="categorization-models.html#cb410-10" tabindex="-1"></a><span class="st">    array[ntrials, nfeatures] real obs; // stimuli as vectors of features assuming all participants get the same sequence</span></span>
<span id="cb410-11"><a href="categorization-models.html#cb410-11" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; b;  // initial bias for category one over two</span></span>
<span id="cb410-12"><a href="categorization-models.html#cb410-12" tabindex="-1"></a></span>
<span id="cb410-13"><a href="categorization-models.html#cb410-13" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb410-14"><a href="categorization-models.html#cb410-14" tabindex="-1"></a><span class="st">    vector[nfeatures] w_prior_values;  // concentration parameters for dirichlet distribution &lt;lower=1&gt;</span></span>
<span id="cb410-15"><a href="categorization-models.html#cb410-15" tabindex="-1"></a><span class="st">    array[2] real c_prior_values;  // mean and variance for logit-normal distribution</span></span>
<span id="cb410-16"><a href="categorization-models.html#cb410-16" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb410-17"><a href="categorization-models.html#cb410-17" tabindex="-1"></a></span>
<span id="cb410-18"><a href="categorization-models.html#cb410-18" tabindex="-1"></a><span class="st">transformed data { // assuming all participants get the same sequence</span></span>
<span id="cb410-19"><a href="categorization-models.html#cb410-19" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb410-20"><a href="categorization-models.html#cb410-20" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_two; // dummy variable for category two over cat 1</span></span>
<span id="cb410-21"><a href="categorization-models.html#cb410-21" tabindex="-1"></a><span class="st">    array[sum(cat_one)] int&lt;lower=1, upper = ntrials&gt; cat_one_idx; // array of which stimuli are cat 1</span></span>
<span id="cb410-22"><a href="categorization-models.html#cb410-22" tabindex="-1"></a><span class="st">    array[ntrials - sum(cat_one)] int&lt;lower = 1, upper = ntrials&gt; cat_two_idx; //  array of which stimuli are cat 2</span></span>
<span id="cb410-23"><a href="categorization-models.html#cb410-23" tabindex="-1"></a><span class="st">    int idx_one = 1; // Initializing </span></span>
<span id="cb410-24"><a href="categorization-models.html#cb410-24" tabindex="-1"></a><span class="st">    int idx_two = 1;</span></span>
<span id="cb410-25"><a href="categorization-models.html#cb410-25" tabindex="-1"></a><span class="st">    for (i in 1:ntrials){</span></span>
<span id="cb410-26"><a href="categorization-models.html#cb410-26" tabindex="-1"></a><span class="st">        cat_two[i] = abs(cat_one[i]-1);</span></span>
<span id="cb410-27"><a href="categorization-models.html#cb410-27" tabindex="-1"></a></span>
<span id="cb410-28"><a href="categorization-models.html#cb410-28" tabindex="-1"></a><span class="st">        if (cat_one[i]==1){</span></span>
<span id="cb410-29"><a href="categorization-models.html#cb410-29" tabindex="-1"></a><span class="st">            cat_one_idx[idx_one] = i;</span></span>
<span id="cb410-30"><a href="categorization-models.html#cb410-30" tabindex="-1"></a><span class="st">            idx_one +=1;</span></span>
<span id="cb410-31"><a href="categorization-models.html#cb410-31" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb410-32"><a href="categorization-models.html#cb410-32" tabindex="-1"></a><span class="st">            cat_two_idx[idx_two] = i;</span></span>
<span id="cb410-33"><a href="categorization-models.html#cb410-33" tabindex="-1"></a><span class="st">            idx_two += 1;</span></span>
<span id="cb410-34"><a href="categorization-models.html#cb410-34" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb410-35"><a href="categorization-models.html#cb410-35" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb410-36"><a href="categorization-models.html#cb410-36" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb410-37"><a href="categorization-models.html#cb410-37" tabindex="-1"></a></span>
<span id="cb410-38"><a href="categorization-models.html#cb410-38" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb410-39"><a href="categorization-models.html#cb410-39" tabindex="-1"></a><span class="st">    real logit_c_M;    // Pop Mean of the scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb410-40"><a href="categorization-models.html#cb410-40" tabindex="-1"></a><span class="st">    real&lt;lower = 0&gt; logit_c_SD;    // Pop SD of the scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb410-41"><a href="categorization-models.html#cb410-41" tabindex="-1"></a><span class="st">    vector[nsubjects] logit_c;    // scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb410-42"><a href="categorization-models.html#cb410-42" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb410-43"><a href="categorization-models.html#cb410-43" tabindex="-1"></a><span class="st">    simplex[nfeatures] weight;  // simplex means sum(w)=1</span></span>
<span id="cb410-44"><a href="categorization-models.html#cb410-44" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; kappa;</span></span>
<span id="cb410-45"><a href="categorization-models.html#cb410-45" tabindex="-1"></a><span class="st">    array[nsubjects] simplex[nfeatures] w_ind;    // weight parameter (how much attention should be paid to feature 1 related to feature 2 - summing up to 1)</span></span>
<span id="cb410-46"><a href="categorization-models.html#cb410-46" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb410-47"><a href="categorization-models.html#cb410-47" tabindex="-1"></a></span>
<span id="cb410-48"><a href="categorization-models.html#cb410-48" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb410-49"><a href="categorization-models.html#cb410-49" tabindex="-1"></a><span class="st">    // parameter w</span></span>
<span id="cb410-50"><a href="categorization-models.html#cb410-50" tabindex="-1"></a><span class="st">    vector[nfeatures] alpha = kappa * weight;</span></span>
<span id="cb410-51"><a href="categorization-models.html#cb410-51" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb410-52"><a href="categorization-models.html#cb410-52" tabindex="-1"></a><span class="st">    // parameter c </span></span>
<span id="cb410-53"><a href="categorization-models.html#cb410-53" tabindex="-1"></a><span class="st">    vector&lt;lower=0,upper=2&gt;[nsubjects] c = inv_logit(logit_c)*2;  // times 2 as c is bounded between 0 and 2</span></span>
<span id="cb410-54"><a href="categorization-models.html#cb410-54" tabindex="-1"></a></span>
<span id="cb410-55"><a href="categorization-models.html#cb410-55" tabindex="-1"></a><span class="st">    // parameter r (probability of response = category 1)</span></span>
<span id="cb410-56"><a href="categorization-models.html#cb410-56" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] real&lt;lower=0.0001, upper=0.9999&gt; r;</span></span>
<span id="cb410-57"><a href="categorization-models.html#cb410-57" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] real rr;</span></span>
<span id="cb410-58"><a href="categorization-models.html#cb410-58" tabindex="-1"></a></span>
<span id="cb410-59"><a href="categorization-models.html#cb410-59" tabindex="-1"></a><span class="st">    for (sub in 1:nsubjects) {</span></span>
<span id="cb410-60"><a href="categorization-models.html#cb410-60" tabindex="-1"></a><span class="st">      for (trial in 1:ntrials) {</span></span>
<span id="cb410-61"><a href="categorization-models.html#cb410-61" tabindex="-1"></a></span>
<span id="cb410-62"><a href="categorization-models.html#cb410-62" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb410-63"><a href="categorization-models.html#cb410-63" tabindex="-1"></a><span class="st">        array[(trial-1)] real exemplar_sim;</span></span>
<span id="cb410-64"><a href="categorization-models.html#cb410-64" tabindex="-1"></a><span class="st">        for (e in 1:(trial-1)){</span></span>
<span id="cb410-65"><a href="categorization-models.html#cb410-65" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb410-66"><a href="categorization-models.html#cb410-66" tabindex="-1"></a><span class="st">            for (feature in 1:nfeatures) {</span></span>
<span id="cb410-67"><a href="categorization-models.html#cb410-67" tabindex="-1"></a><span class="st">                tmp_dist[feature] = w_ind[sub,feature]*abs(obs[e,feature] - obs[trial,feature]);</span></span>
<span id="cb410-68"><a href="categorization-models.html#cb410-68" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb410-69"><a href="categorization-models.html#cb410-69" tabindex="-1"></a><span class="st">            exemplar_sim[e] = exp(-c[sub] * sum(tmp_dist));</span></span>
<span id="cb410-70"><a href="categorization-models.html#cb410-70" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb410-71"><a href="categorization-models.html#cb410-71" tabindex="-1"></a></span>
<span id="cb410-72"><a href="categorization-models.html#cb410-72" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(trial-1)])==0 || sum(cat_two[:(trial-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb410-73"><a href="categorization-models.html#cb410-73" tabindex="-1"></a><span class="st">            r[trial,sub] = 0.5;</span></span>
<span id="cb410-74"><a href="categorization-models.html#cb410-74" tabindex="-1"></a></span>
<span id="cb410-75"><a href="categorization-models.html#cb410-75" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb410-76"><a href="categorization-models.html#cb410-76" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb410-77"><a href="categorization-models.html#cb410-77" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb410-78"><a href="categorization-models.html#cb410-78" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb410-79"><a href="categorization-models.html#cb410-79" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(trial-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(trial-1)])];</span></span>
<span id="cb410-80"><a href="categorization-models.html#cb410-80" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(trial-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(trial-1)])];</span></span>
<span id="cb410-81"><a href="categorization-models.html#cb410-81" tabindex="-1"></a><span class="st">            similarities[1] = sum(exemplar_sim[tmp_idx_one]);</span></span>
<span id="cb410-82"><a href="categorization-models.html#cb410-82" tabindex="-1"></a><span class="st">            similarities[2] = sum(exemplar_sim[tmp_idx_two]);</span></span>
<span id="cb410-83"><a href="categorization-models.html#cb410-83" tabindex="-1"></a></span>
<span id="cb410-84"><a href="categorization-models.html#cb410-84" tabindex="-1"></a><span class="st">            // calculate r</span></span>
<span id="cb410-85"><a href="categorization-models.html#cb410-85" tabindex="-1"></a><span class="st">            rr[trial,sub] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb410-86"><a href="categorization-models.html#cb410-86" tabindex="-1"></a></span>
<span id="cb410-87"><a href="categorization-models.html#cb410-87" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb410-88"><a href="categorization-models.html#cb410-88" tabindex="-1"></a><span class="st">            if (rr[trial,sub] &gt; 0.9999){</span></span>
<span id="cb410-89"><a href="categorization-models.html#cb410-89" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.9999;</span></span>
<span id="cb410-90"><a href="categorization-models.html#cb410-90" tabindex="-1"></a><span class="st">            } else if (rr[trial,sub] &lt; 0.0001) {</span></span>
<span id="cb410-91"><a href="categorization-models.html#cb410-91" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.0001;</span></span>
<span id="cb410-92"><a href="categorization-models.html#cb410-92" tabindex="-1"></a><span class="st">            } else if (rr[trial,sub] &gt; 0.0001 &amp;&amp; rr[trial,sub] &lt; 0.9999) {</span></span>
<span id="cb410-93"><a href="categorization-models.html#cb410-93" tabindex="-1"></a><span class="st">                r[trial,sub] = rr[trial,sub];</span></span>
<span id="cb410-94"><a href="categorization-models.html#cb410-94" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb410-95"><a href="categorization-models.html#cb410-95" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.5;</span></span>
<span id="cb410-96"><a href="categorization-models.html#cb410-96" tabindex="-1"></a><span class="st">            }}}}}</span></span>
<span id="cb410-97"><a href="categorization-models.html#cb410-97" tabindex="-1"></a></span>
<span id="cb410-98"><a href="categorization-models.html#cb410-98" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb410-99"><a href="categorization-models.html#cb410-99" tabindex="-1"></a><span class="st">    // Priors</span></span>
<span id="cb410-100"><a href="categorization-models.html#cb410-100" tabindex="-1"></a><span class="st">    target += exponential_lpdf(kappa | 0.1);</span></span>
<span id="cb410-101"><a href="categorization-models.html#cb410-101" tabindex="-1"></a><span class="st">    target += dirichlet_lpdf(weight | w_prior_values);</span></span>
<span id="cb410-102"><a href="categorization-models.html#cb410-102" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb410-103"><a href="categorization-models.html#cb410-103" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c_M | c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb410-104"><a href="categorization-models.html#cb410-104" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c_SD | 0, 1) - normal_lccdf(0 | 0, 1);</span></span>
<span id="cb410-105"><a href="categorization-models.html#cb410-105" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb410-106"><a href="categorization-models.html#cb410-106" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c | logit_c_M, logit_c_SD);</span></span>
<span id="cb410-107"><a href="categorization-models.html#cb410-107" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb410-108"><a href="categorization-models.html#cb410-108" tabindex="-1"></a><span class="st">    // Decision Data</span></span>
<span id="cb410-109"><a href="categorization-models.html#cb410-109" tabindex="-1"></a><span class="st">    for (sub in 1:nsubjects){</span></span>
<span id="cb410-110"><a href="categorization-models.html#cb410-110" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb410-111"><a href="categorization-models.html#cb410-111" tabindex="-1"></a><span class="st">      target += dirichlet_lpdf(w_ind[sub] | alpha);</span></span>
<span id="cb410-112"><a href="categorization-models.html#cb410-112" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb410-113"><a href="categorization-models.html#cb410-113" tabindex="-1"></a><span class="st">      for (trial in 1:ntrials){</span></span>
<span id="cb410-114"><a href="categorization-models.html#cb410-114" tabindex="-1"></a><span class="st">        target += bernoulli_lpmf(y[trial,sub] | r[trial,sub]);</span></span>
<span id="cb410-115"><a href="categorization-models.html#cb410-115" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb410-116"><a href="categorization-models.html#cb410-116" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb410-117"><a href="categorization-models.html#cb410-117" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb410-118"><a href="categorization-models.html#cb410-118" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb410-119"><a href="categorization-models.html#cb410-119" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb410-120"><a href="categorization-models.html#cb410-120" tabindex="-1"></a></span>
<span id="cb410-121"><a href="categorization-models.html#cb410-121" tabindex="-1"></a><span class="st">// generated quantities {</span></span>
<span id="cb410-122"><a href="categorization-models.html#cb410-122" tabindex="-1"></a><span class="st">//     // priors</span></span>
<span id="cb410-123"><a href="categorization-models.html#cb410-123" tabindex="-1"></a><span class="st">//     simplex[nfeatures] w_prior = dirichlet_rng(w_prior_values);</span></span>
<span id="cb410-124"><a href="categorization-models.html#cb410-124" tabindex="-1"></a><span class="st">//     real logit_c_prior = normal_rng(c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb410-125"><a href="categorization-models.html#cb410-125" tabindex="-1"></a><span class="st">//     real&lt;lower=0, upper=2&gt; c_prior = inv_logit(logit_c_prior)*2;</span></span>
<span id="cb410-126"><a href="categorization-models.html#cb410-126" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-127"><a href="categorization-models.html#cb410-127" tabindex="-1"></a><span class="st">//     // prior pred</span></span>
<span id="cb410-128"><a href="categorization-models.html#cb410-128" tabindex="-1"></a><span class="st">//     array[ntrials] real&lt;lower=0, upper=1&gt; r_prior;</span></span>
<span id="cb410-129"><a href="categorization-models.html#cb410-129" tabindex="-1"></a><span class="st">//     array[ntrials] real rr_prior;</span></span>
<span id="cb410-130"><a href="categorization-models.html#cb410-130" tabindex="-1"></a><span class="st">//     for (i in 1:ntrials) {</span></span>
<span id="cb410-131"><a href="categorization-models.html#cb410-131" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-132"><a href="categorization-models.html#cb410-132" tabindex="-1"></a><span class="st">//         // calculate distance from obs to all exemplars</span></span>
<span id="cb410-133"><a href="categorization-models.html#cb410-133" tabindex="-1"></a><span class="st">//         array[(i-1)] real exemplar_dist;</span></span>
<span id="cb410-134"><a href="categorization-models.html#cb410-134" tabindex="-1"></a><span class="st">//         for (e in 1:(i-1)){</span></span>
<span id="cb410-135"><a href="categorization-models.html#cb410-135" tabindex="-1"></a><span class="st">//             array[nfeatures] real tmp_dist;</span></span>
<span id="cb410-136"><a href="categorization-models.html#cb410-136" tabindex="-1"></a><span class="st">//             for (j in 1:nfeatures) {</span></span>
<span id="cb410-137"><a href="categorization-models.html#cb410-137" tabindex="-1"></a><span class="st">//                 tmp_dist[j] = w_prior[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb410-138"><a href="categorization-models.html#cb410-138" tabindex="-1"></a><span class="st">//             }</span></span>
<span id="cb410-139"><a href="categorization-models.html#cb410-139" tabindex="-1"></a><span class="st">//             exemplar_dist[e] = sum(tmp_dist);</span></span>
<span id="cb410-140"><a href="categorization-models.html#cb410-140" tabindex="-1"></a><span class="st">//         }</span></span>
<span id="cb410-141"><a href="categorization-models.html#cb410-141" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-142"><a href="categorization-models.html#cb410-142" tabindex="-1"></a><span class="st">//         if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb410-143"><a href="categorization-models.html#cb410-143" tabindex="-1"></a><span class="st">//             r_prior[i] = 0.5;</span></span>
<span id="cb410-144"><a href="categorization-models.html#cb410-144" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-145"><a href="categorization-models.html#cb410-145" tabindex="-1"></a><span class="st">//         } else {</span></span>
<span id="cb410-146"><a href="categorization-models.html#cb410-146" tabindex="-1"></a><span class="st">//             // calculate similarity</span></span>
<span id="cb410-147"><a href="categorization-models.html#cb410-147" tabindex="-1"></a><span class="st">//             array[2] real similarities;</span></span>
<span id="cb410-148"><a href="categorization-models.html#cb410-148" tabindex="-1"></a><span class="st">//             </span></span>
<span id="cb410-149"><a href="categorization-models.html#cb410-149" tabindex="-1"></a><span class="st">//             array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb410-150"><a href="categorization-models.html#cb410-150" tabindex="-1"></a><span class="st">//             array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb410-151"><a href="categorization-models.html#cb410-151" tabindex="-1"></a><span class="st">//             similarities[1] = exp(-c_prior * sum(exemplar_dist[tmp_idx_one]));</span></span>
<span id="cb410-152"><a href="categorization-models.html#cb410-152" tabindex="-1"></a><span class="st">//             similarities[2] = exp(-c_prior * sum(exemplar_dist[tmp_idx_two]));</span></span>
<span id="cb410-153"><a href="categorization-models.html#cb410-153" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-154"><a href="categorization-models.html#cb410-154" tabindex="-1"></a><span class="st">//             // calculate r[i]</span></span>
<span id="cb410-155"><a href="categorization-models.html#cb410-155" tabindex="-1"></a><span class="st">//             rr_prior[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb410-156"><a href="categorization-models.html#cb410-156" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-157"><a href="categorization-models.html#cb410-157" tabindex="-1"></a><span class="st">//             // to make the sampling work</span></span>
<span id="cb410-158"><a href="categorization-models.html#cb410-158" tabindex="-1"></a><span class="st">//             if (rr_prior[i] == 1){</span></span>
<span id="cb410-159"><a href="categorization-models.html#cb410-159" tabindex="-1"></a><span class="st">//                 r_prior[i] = 0.9999;</span></span>
<span id="cb410-160"><a href="categorization-models.html#cb410-160" tabindex="-1"></a><span class="st">//             } else if (rr_prior[i] == 0) {</span></span>
<span id="cb410-161"><a href="categorization-models.html#cb410-161" tabindex="-1"></a><span class="st">//                 r_prior[i] = 0.0001;</span></span>
<span id="cb410-162"><a href="categorization-models.html#cb410-162" tabindex="-1"></a><span class="st">//             } else if (rr_prior[i] &gt; 0 &amp;&amp; rr_prior[i] &lt; 1) {</span></span>
<span id="cb410-163"><a href="categorization-models.html#cb410-163" tabindex="-1"></a><span class="st">//                 r_prior[i] = rr_prior[i];</span></span>
<span id="cb410-164"><a href="categorization-models.html#cb410-164" tabindex="-1"></a><span class="st">//             } else {</span></span>
<span id="cb410-165"><a href="categorization-models.html#cb410-165" tabindex="-1"></a><span class="st">//                 r_prior[i] = 0.5;</span></span>
<span id="cb410-166"><a href="categorization-models.html#cb410-166" tabindex="-1"></a><span class="st">//             }</span></span>
<span id="cb410-167"><a href="categorization-models.html#cb410-167" tabindex="-1"></a><span class="st">//         }</span></span>
<span id="cb410-168"><a href="categorization-models.html#cb410-168" tabindex="-1"></a><span class="st">//     }</span></span>
<span id="cb410-169"><a href="categorization-models.html#cb410-169" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-170"><a href="categorization-models.html#cb410-170" tabindex="-1"></a><span class="st">//     array[ntrials] int&lt;lower=0, upper=1&gt; priorpred = bernoulli_rng(r_prior);</span></span>
<span id="cb410-171"><a href="categorization-models.html#cb410-171" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-172"><a href="categorization-models.html#cb410-172" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-173"><a href="categorization-models.html#cb410-173" tabindex="-1"></a><span class="st">//     // posterior pred</span></span>
<span id="cb410-174"><a href="categorization-models.html#cb410-174" tabindex="-1"></a><span class="st">//     array[ntrials] int&lt;lower=0, upper=1&gt; posteriorpred = bernoulli_rng(r);</span></span>
<span id="cb410-175"><a href="categorization-models.html#cb410-175" tabindex="-1"></a><span class="st">//     array[ntrials] int&lt;lower=0, upper=1&gt; posteriorcorrect;</span></span>
<span id="cb410-176"><a href="categorization-models.html#cb410-176" tabindex="-1"></a><span class="st">//     for (i in 1:ntrials) {</span></span>
<span id="cb410-177"><a href="categorization-models.html#cb410-177" tabindex="-1"></a><span class="st">//         if (posteriorpred[i] == cat_one[i]) {</span></span>
<span id="cb410-178"><a href="categorization-models.html#cb410-178" tabindex="-1"></a><span class="st">//             posteriorcorrect[i] = 1;</span></span>
<span id="cb410-179"><a href="categorization-models.html#cb410-179" tabindex="-1"></a><span class="st">//         } else {</span></span>
<span id="cb410-180"><a href="categorization-models.html#cb410-180" tabindex="-1"></a><span class="st">//             posteriorcorrect[i] = 0;</span></span>
<span id="cb410-181"><a href="categorization-models.html#cb410-181" tabindex="-1"></a><span class="st">//         }</span></span>
<span id="cb410-182"><a href="categorization-models.html#cb410-182" tabindex="-1"></a><span class="st">//     }</span></span>
<span id="cb410-183"><a href="categorization-models.html#cb410-183" tabindex="-1"></a><span class="st">//     </span></span>
<span id="cb410-184"><a href="categorization-models.html#cb410-184" tabindex="-1"></a><span class="st">//     </span></span>
<span id="cb410-185"><a href="categorization-models.html#cb410-185" tabindex="-1"></a><span class="st">//     // log likelihood</span></span>
<span id="cb410-186"><a href="categorization-models.html#cb410-186" tabindex="-1"></a><span class="st">//    array[ntrials] real log_lik;</span></span>
<span id="cb410-187"><a href="categorization-models.html#cb410-187" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-188"><a href="categorization-models.html#cb410-188" tabindex="-1"></a><span class="st">//    for (i in 1:ntrials) {</span></span>
<span id="cb410-189"><a href="categorization-models.html#cb410-189" tabindex="-1"></a><span class="st">//         log_lik[i] = bernoulli_lpmf(y[i] | r[i]);</span></span>
<span id="cb410-190"><a href="categorization-models.html#cb410-190" tabindex="-1"></a><span class="st">//    }</span></span>
<span id="cb410-191"><a href="categorization-models.html#cb410-191" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb410-192"><a href="categorization-models.html#cb410-192" tabindex="-1"></a><span class="st">// }</span></span>
<span id="cb410-193"><a href="categorization-models.html#cb410-193" tabindex="-1"></a></span>
<span id="cb410-194"><a href="categorization-models.html#cb410-194" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb410-195"><a href="categorization-models.html#cb410-195" tabindex="-1"></a></span>
<span id="cb410-196"><a href="categorization-models.html#cb410-196" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb410-197"><a href="categorization-models.html#cb410-197" tabindex="-1"></a>  gcm_ml_model,</span>
<span id="cb410-198"><a href="categorization-models.html#cb410-198" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb410-199"><a href="categorization-models.html#cb410-199" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10_GCM_ml.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10_GCM_ml.stan&quot;</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="categorization-models.html#cb412-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10_GCM_ml.stan&quot;</span>)</span>
<span id="cb412-2"><a href="categorization-models.html#cb412-2" tabindex="-1"></a>mod_GCM_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb412-3"><a href="categorization-models.html#cb412-3" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="categorization-models.html#cb413-1" tabindex="-1"></a><span class="do">## Fit the simulated data</span></span>
<span id="cb413-2"><a href="categorization-models.html#cb413-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d[,<span class="fu">c</span>(<span class="st">&quot;agent&quot;</span>,<span class="st">&quot;trial&quot;</span>,<span class="st">&quot;sim_response&quot;</span>)] <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb413-3"><a href="categorization-models.html#cb413-3" tabindex="-1"></a>  <span class="at">names_from =</span> agent,</span>
<span id="cb413-4"><a href="categorization-models.html#cb413-4" tabindex="-1"></a>  <span class="at">values_from =</span> <span class="fu">c</span>(sim_response))</span>
<span id="cb413-5"><a href="categorization-models.html#cb413-5" tabindex="-1"></a></span>
<span id="cb413-6"><a href="categorization-models.html#cb413-6" tabindex="-1"></a>gcm_ml_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb413-7"><a href="categorization-models.html#cb413-7" tabindex="-1"></a>  <span class="at">nsubjects =</span> agents,</span>
<span id="cb413-8"><a href="categorization-models.html#cb413-8" tabindex="-1"></a>  <span class="at">ntrials =</span> <span class="fu">nrow</span>(experiment),</span>
<span id="cb413-9"><a href="categorization-models.html#cb413-9" tabindex="-1"></a>  <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb413-10"><a href="categorization-models.html#cb413-10" tabindex="-1"></a>  <span class="at">cat_one =</span> experiment<span class="sc">$</span>category,</span>
<span id="cb413-11"><a href="categorization-models.html#cb413-11" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">as.matrix</span>(d1[, <span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)]),</span>
<span id="cb413-12"><a href="categorization-models.html#cb413-12" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb413-13"><a href="categorization-models.html#cb413-13" tabindex="-1"></a>  <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb413-14"><a href="categorization-models.html#cb413-14" tabindex="-1"></a>  <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb413-15"><a href="categorization-models.html#cb413-15" tabindex="-1"></a>  <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb413-16"><a href="categorization-models.html#cb413-16" tabindex="-1"></a>)</span>
<span id="cb413-17"><a href="categorization-models.html#cb413-17" tabindex="-1"></a></span>
<span id="cb413-18"><a href="categorization-models.html#cb413-18" tabindex="-1"></a>samples_gcm_ml <span class="ot">&lt;-</span> mod_GCM_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb413-19"><a href="categorization-models.html#cb413-19" tabindex="-1"></a>  <span class="at">data =</span> gcm_ml_data,</span>
<span id="cb413-20"><a href="categorization-models.html#cb413-20" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb413-21"><a href="categorization-models.html#cb413-21" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb413-22"><a href="categorization-models.html#cb413-22" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb413-23"><a href="categorization-models.html#cb413-23" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb413-24"><a href="categorization-models.html#cb413-24" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb413-25"><a href="categorization-models.html#cb413-25" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb413-26"><a href="categorization-models.html#cb413-26" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">1000</span></span>
<span id="cb413-27"><a href="categorization-models.html#cb413-27" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup)</code></pre>
<pre><code>## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 1 Exception: dirichlet_lpdf: prior sample sizes[1] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/Rtmp8y3suQ/model-104652778844.stan&#39;, line 111, column 6 to column 51)</code></pre>
<pre><code>## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 1</code></pre>
<pre><code>## Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 619.4 seconds.
## Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 2 finished in 724.8 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 672.1 seconds.
## Total execution time: 725.2 seconds.</code></pre>
<pre><code>## Warning: 169 of 2000 (8.0%) transitions ended with a divergence.
## See https://mc-stan.org/misc/warnings for details.</code></pre>
<pre><code>## Warning: 1 of 2 chains had an E-BFMI less than 0.3.
## See https://mc-stan.org/misc/warnings for details.</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="categorization-models.html#cb423-1" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm_ml)</span>
<span id="cb423-2"><a href="categorization-models.html#cb423-2" tabindex="-1"></a></span>
<span id="cb423-3"><a href="categorization-models.html#cb423-3" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, logit_c_M, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb423-4"><a href="categorization-models.html#cb423-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb423-5"><a href="categorization-models.html#cb423-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="categorization-models.html#cb424-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, logit_c_SD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb424-2"><a href="categorization-models.html#cb424-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb424-3"><a href="categorization-models.html#cb424-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="categorization-models.html#cb425-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb425-2"><a href="categorization-models.html#cb425-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb425-3"><a href="categorization-models.html#cb425-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-3.png" width="672" /></p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="categorization-models.html#cb426-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb426-2"><a href="categorization-models.html#cb426-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb426-3"><a href="categorization-models.html#cb426-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-4.png" width="672" /></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="categorization-models.html#cb427-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">kappa</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb427-2"><a href="categorization-models.html#cb427-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb427-3"><a href="categorization-models.html#cb427-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-5.png" width="672" /></p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="categorization-models.html#cb428-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c_prior =</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(draws), <span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb428-2"><a href="categorization-models.html#cb428-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb428-3"><a href="categorization-models.html#cb428-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(logit_c_M), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb428-4"><a href="categorization-models.html#cb428-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb428-5"><a href="categorization-models.html#cb428-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">logit_scaled</span>(scalingM,<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb428-6"><a href="categorization-models.html#cb428-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-6.png" width="672" /></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="categorization-models.html#cb431-1" tabindex="-1"></a><span class="fu">library</span>(msm)</span>
<span id="cb431-2"><a href="categorization-models.html#cb431-2" tabindex="-1"></a></span>
<span id="cb431-3"><a href="categorization-models.html#cb431-3" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c_prior =</span> <span class="fu">rtnorm</span>(<span class="fu">nrow</span>(draws), <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lower =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb431-4"><a href="categorization-models.html#cb431-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb431-5"><a href="categorization-models.html#cb431-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(logit_c_SD), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb431-6"><a href="categorization-models.html#cb431-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb431-7"><a href="categorization-models.html#cb431-7" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb431-8"><a href="categorization-models.html#cb431-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-7.png" width="672" /></p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="categorization-models.html#cb433-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rdirichlet</span>(<span class="fu">nrow</span>(draws), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb433-2"><a href="categorization-models.html#cb433-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb433-3"><a href="categorization-models.html#cb433-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb433-4"><a href="categorization-models.html#cb433-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb433-5"><a href="categorization-models.html#cb433-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb433-6"><a href="categorization-models.html#cb433-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-8.png" width="672" /></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="categorization-models.html#cb435-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">w_prior[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rdirichlet</span>(<span class="fu">nrow</span>(draws), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb435-2"><a href="categorization-models.html#cb435-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb435-3"><a href="categorization-models.html#cb435-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb435-4"><a href="categorization-models.html#cb435-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb435-5"><a href="categorization-models.html#cb435-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb435-6"><a href="categorization-models.html#cb435-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-9.png" width="672" /></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="categorization-models.html#cb437-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">kappa_prior</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rexp</span>(<span class="fu">nrow</span>(draws), <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb437-2"><a href="categorization-models.html#cb437-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb437-3"><a href="categorization-models.html#cb437-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">kappa</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb437-4"><a href="categorization-models.html#cb437-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">kappa_prior</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb437-5"><a href="categorization-models.html#cb437-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb437-6"><a href="categorization-models.html#cb437-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-10.png" width="672" /></p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="categorization-models.html#cb439-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb439-2"><a href="categorization-models.html#cb439-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>, <span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb439-3"><a href="categorization-models.html#cb439-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-11.png" width="672" /></p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="categorization-models.html#cb440-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb440-2"><a href="categorization-models.html#cb440-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(logit_c_M, logit_c_SD), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb440-3"><a href="categorization-models.html#cb440-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-12.png" width="672" /></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="categorization-models.html#cb441-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb441-2"><a href="categorization-models.html#cb441-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(kappa, <span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb441-3"><a href="categorization-models.html#cb441-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-13.png" width="672" /></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="categorization-models.html#cb442-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb442-2"><a href="categorization-models.html#cb442-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(kappa, <span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb442-3"><a href="categorization-models.html#cb442-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-14.png" width="672" /></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="categorization-models.html#cb443-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb443-2"><a href="categorization-models.html#cb443-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(kappa, <span class="st">`</span><span class="at">logit_c_M</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb443-3"><a href="categorization-models.html#cb443-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-15.png" width="672" /></p>
</div>
</div>
<div id="now-we-parallelize-n.b.-not-finished" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Now we parallelize [N.B. NOT FINISHED]<a href="categorization-models.html#now-we-parallelize-n.b.-not-finished" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="categorization-models.html#cb444-1" tabindex="-1"></a><span class="co"># ## Then we create the function that simulates data and fits the model, so we can quickly go through multiple parameter values in the simulation</span></span>
<span id="cb444-2"><a href="categorization-models.html#cb444-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-3"><a href="categorization-models.html#cb444-3" tabindex="-1"></a><span class="co"># sim_ml_and_fit &lt;- function(agents, scalingM, scalingSD, weights, kappa) {</span></span>
<span id="cb444-4"><a href="categorization-models.html#cb444-4" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-5"><a href="categorization-models.html#cb444-5" tabindex="-1"></a><span class="co">#   d &lt;- simulate_ml_responses(agents, scalingM, scalingSD, weights, kappa)</span></span>
<span id="cb444-6"><a href="categorization-models.html#cb444-6" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-7"><a href="categorization-models.html#cb444-7" tabindex="-1"></a><span class="co">#   d1 &lt;- d[,c(&quot;agent&quot;,&quot;trial&quot;,&quot;sim_response&quot;)] %&gt;% pivot_wider(</span></span>
<span id="cb444-8"><a href="categorization-models.html#cb444-8" tabindex="-1"></a><span class="co">#     names_from = agent,</span></span>
<span id="cb444-9"><a href="categorization-models.html#cb444-9" tabindex="-1"></a><span class="co">#     values_from = c(sim_response))</span></span>
<span id="cb444-10"><a href="categorization-models.html#cb444-10" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-11"><a href="categorization-models.html#cb444-11" tabindex="-1"></a><span class="co">#   gcm_ml_data &lt;- list(</span></span>
<span id="cb444-12"><a href="categorization-models.html#cb444-12" tabindex="-1"></a><span class="co">#     nsubjects = agents,</span></span>
<span id="cb444-13"><a href="categorization-models.html#cb444-13" tabindex="-1"></a><span class="co">#     ntrials = nrow(experiment),</span></span>
<span id="cb444-14"><a href="categorization-models.html#cb444-14" tabindex="-1"></a><span class="co">#     nfeatures = 2,</span></span>
<span id="cb444-15"><a href="categorization-models.html#cb444-15" tabindex="-1"></a><span class="co">#     cat_one = experiment$category,</span></span>
<span id="cb444-16"><a href="categorization-models.html#cb444-16" tabindex="-1"></a><span class="co">#     y = as.matrix(d1[, 2:(agents + 1)]),</span></span>
<span id="cb444-17"><a href="categorization-models.html#cb444-17" tabindex="-1"></a><span class="co">#     obs = as.matrix(experiment[, c(&quot;height&quot;, &quot;position&quot;)]),</span></span>
<span id="cb444-18"><a href="categorization-models.html#cb444-18" tabindex="-1"></a><span class="co">#     b = 0.5,</span></span>
<span id="cb444-19"><a href="categorization-models.html#cb444-19" tabindex="-1"></a><span class="co">#     w_prior_values = c(1, 1),</span></span>
<span id="cb444-20"><a href="categorization-models.html#cb444-20" tabindex="-1"></a><span class="co">#     c_prior_values = c(0, 1)</span></span>
<span id="cb444-21"><a href="categorization-models.html#cb444-21" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb444-22"><a href="categorization-models.html#cb444-22" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-23"><a href="categorization-models.html#cb444-23" tabindex="-1"></a><span class="co">#   samples_gcm_ml &lt;- mod_GCM_ml$sample(</span></span>
<span id="cb444-24"><a href="categorization-models.html#cb444-24" tabindex="-1"></a><span class="co">#     data = gcm_ml_data,</span></span>
<span id="cb444-25"><a href="categorization-models.html#cb444-25" tabindex="-1"></a><span class="co">#     seed = 123,</span></span>
<span id="cb444-26"><a href="categorization-models.html#cb444-26" tabindex="-1"></a><span class="co">#     chains = 2,</span></span>
<span id="cb444-27"><a href="categorization-models.html#cb444-27" tabindex="-1"></a><span class="co">#     parallel_chains = 2,</span></span>
<span id="cb444-28"><a href="categorization-models.html#cb444-28" tabindex="-1"></a><span class="co">#     threads_per_chain = 2,</span></span>
<span id="cb444-29"><a href="categorization-models.html#cb444-29" tabindex="-1"></a><span class="co">#     iter_warmup = 1000,</span></span>
<span id="cb444-30"><a href="categorization-models.html#cb444-30" tabindex="-1"></a><span class="co">#     iter_sampling = 1000,</span></span>
<span id="cb444-31"><a href="categorization-models.html#cb444-31" tabindex="-1"></a><span class="co">#     refresh = 1000</span></span>
<span id="cb444-32"><a href="categorization-models.html#cb444-32" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb444-33"><a href="categorization-models.html#cb444-33" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-34"><a href="categorization-models.html#cb444-34" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-35"><a href="categorization-models.html#cb444-35" tabindex="-1"></a><span class="co">#   draws_df &lt;- as_draws_df(samples_gcm$draws()) </span></span>
<span id="cb444-36"><a href="categorization-models.html#cb444-36" tabindex="-1"></a><span class="co">#   temp &lt;- tibble(trueC_M = scalingM, </span></span>
<span id="cb444-37"><a href="categorization-models.html#cb444-37" tabindex="-1"></a><span class="co">#                  trueC_SD = scalingSD, </span></span>
<span id="cb444-38"><a href="categorization-models.html#cb444-38" tabindex="-1"></a><span class="co">#                  trueW1 = weights[1], </span></span>
<span id="cb444-39"><a href="categorization-models.html#cb444-39" tabindex="-1"></a><span class="co">#                  trueW2 = weights[2], </span></span>
<span id="cb444-40"><a href="categorization-models.html#cb444-40" tabindex="-1"></a><span class="co">#                  trueKappa = kappa, </span></span>
<span id="cb444-41"><a href="categorization-models.html#cb444-41" tabindex="-1"></a><span class="co">#                  agents = agents,</span></span>
<span id="cb444-42"><a href="categorization-models.html#cb444-42" tabindex="-1"></a><span class="co">#                  # FROM HERE</span></span>
<span id="cb444-43"><a href="categorization-models.html#cb444-43" tabindex="-1"></a><span class="co">#                  estC = draws_df$c, </span></span>
<span id="cb444-44"><a href="categorization-models.html#cb444-44" tabindex="-1"></a><span class="co">#                  estW1 = draws_df$`w[1]`,</span></span>
<span id="cb444-45"><a href="categorization-models.html#cb444-45" tabindex="-1"></a><span class="co">#                  estW2 = draws_df$`w[2]`</span></span>
<span id="cb444-46"><a href="categorization-models.html#cb444-46" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb444-47"><a href="categorization-models.html#cb444-47" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-48"><a href="categorization-models.html#cb444-48" tabindex="-1"></a><span class="co">#   return(temp)</span></span>
<span id="cb444-49"><a href="categorization-models.html#cb444-49" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb444-50"><a href="categorization-models.html#cb444-50" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb444-51"><a href="categorization-models.html#cb444-51" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-52"><a href="categorization-models.html#cb444-52" tabindex="-1"></a><span class="co"># ## Now I need to make a list of lists</span></span>
<span id="cb444-53"><a href="categorization-models.html#cb444-53" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-54"><a href="categorization-models.html#cb444-54" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-55"><a href="categorization-models.html#cb444-55" tabindex="-1"></a><span class="co"># temp &lt;- tibble(unique(simulated_responses[,c(&quot;agent&quot;, &quot;c&quot;, &quot;w&quot;)])) %&gt;%</span></span>
<span id="cb444-56"><a href="categorization-models.html#cb444-56" tabindex="-1"></a><span class="co">#   rename(</span></span>
<span id="cb444-57"><a href="categorization-models.html#cb444-57" tabindex="-1"></a><span class="co">#     scaling = c,</span></span>
<span id="cb444-58"><a href="categorization-models.html#cb444-58" tabindex="-1"></a><span class="co">#     weights = w</span></span>
<span id="cb444-59"><a href="categorization-models.html#cb444-59" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb444-60"><a href="categorization-models.html#cb444-60" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-61"><a href="categorization-models.html#cb444-61" tabindex="-1"></a><span class="co"># recovery_df &lt;- future_pmap_dfr(temp, sim_d_and_fit, .options = furrr_options(seed = TRUE))</span></span>
<span id="cb444-62"><a href="categorization-models.html#cb444-62" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-63"><a href="categorization-models.html#cb444-63" tabindex="-1"></a><span class="co"># write_csv(recovery_df, &quot;simdata/W10_GCM_recoverydf.csv&quot;)</span></span></code></pre></div>
<div id="student-produced-models-of-categorization" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Student-produced models of categorization<a href="categorization-models.html#student-produced-models-of-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Attempting to identify features</p></li>
<li><p>Attempting to associate 1 of the features to one of the outcome dimensions (e.g. green as danger), test hypothesis, stay if positive, try different trait if negative. [missing details on how to define the hypothesized association, and how much evidence needed to shift]</p></li>
<li><p>Remembering the rule and/or remembering the single exemplars</p></li>
<li><p>Focusing on 1 feature 1 outcome vs trying to incorporate additional features</p></li>
<li><p>Using arbitrary associations btw features and outcomes vs. relying on intuition (raised arms are dangerous)</p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-models-of-cognition.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/10-CategorizationModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
