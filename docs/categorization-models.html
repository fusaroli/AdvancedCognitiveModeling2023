<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Categorization models | 10-CategorizationModels</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Categorization models | 10-CategorizationModels" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Categorization models | 10-CategorizationModels" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2023" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2023-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-models-of-cognition.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-goal-of-the-course"><i class="fa fa-check"></i><b>1.1</b> The goal of the course</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#list-of-lectures-and-practical-exercises"><i class="fa fa-check"></i><b>1.2</b> List of lectures and practical exercises</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation-before-the-course"><i class="fa fa-check"></i><b>1.3</b> Preparation before the course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Practical exercise 1 - Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a></li>
<li class="chapter" data-level="2.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#strategies"><i class="fa fa-check"></i><b>2.4</b> Strategies</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.4.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.4.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.4.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.4.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.4.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.4.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.4.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.4.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.4.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.4.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.4.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.5</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.5.1</b> Memory</a></li>
<li class="chapter" data-level="2.5.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.5.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.6</b> Continuity between models</a></li>
<li class="chapter" data-level="2.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.7</b> Mixture of strategies</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> Practical exercise 2 - From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.1</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.2" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.2</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.4" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.4</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.4.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#data"><i class="fa fa-check"></i><b>4.3.1</b> Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#model"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>4.3.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="4.3.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-model"><i class="fa fa-check"></i><b>4.3.4</b> Summarizing the model</a></li>
<li class="chapter" data-level="4.3.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#assessing-model-quality"><i class="fa fa-check"></i><b>4.3.5</b> Assessing model quality</a></li>
<li class="chapter" data-level="4.3.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results"><i class="fa fa-check"></i><b>4.3.6</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>4.5.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>4.6</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>4.6.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html"><i class="fa fa-check"></i><b>5</b> Practical exercise 4 - Model quality checks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>5.1</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="5.2" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-priors"><i class="fa fa-check"></i><b>5.2</b> Assessing priors</a></li>
<li class="chapter" data-level="5.3" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-prior-and-posterior-predictions"><i class="fa fa-check"></i><b>5.3</b> Assessing prior and posterior predictions</a></li>
<li class="chapter" data-level="5.4" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="5.5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#the-memory-model"><i class="fa fa-check"></i><b>5.5</b> The memory model</a></li>
<li class="chapter" data-level="5.6" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>5.6</b> Prior sensitivity check for the memory model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html"><i class="fa fa-check"></i><b>6</b> Multilevel modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#intro-to-multilevel-modeling"><i class="fa fa-check"></i><b>6.1</b> Intro to multilevel modeling</a></li>
<li class="chapter" data-level="6.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent"><i class="fa fa-check"></i><b>6.2</b> A multilevel version of the biased agent and of the simple memory agent</a></li>
<li class="chapter" data-level="6.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>6.3</b> Generating the agents</a></li>
<li class="chapter" data-level="6.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>6.4</b> Plotting the agents</a></li>
<li class="chapter" data-level="6.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>6.5</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>6.5.1</b> Multilevel random</a></li>
<li class="chapter" data-level="6.5.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>6.5.2</b> Assessing multilevel random agents</a></li>
<li class="chapter" data-level="6.5.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory"><i class="fa fa-check"></i><b>6.5.3</b> Multilevel memory</a></li>
<li class="chapter" data-level="6.5.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>6.5.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>6.5.5</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="6.5.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>6.5.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.7" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>6.5.7</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="6.5.8" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>6.5.8</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.9" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-no-pooling"><i class="fa fa-check"></i><b>6.5.9</b> Multilevel memory no pooling</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-full-pooling"><i class="fa fa-check"></i><b>6.6</b> Multilevel full pooling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>7</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model-comparison.html"><a href="model-comparison.html#define-parameters"><i class="fa fa-check"></i><b>7.1</b> Define parameters</a></li>
<li class="chapter" data-level="7.2" data-path="model-comparison.html"><a href="model-comparison.html#define-biased-and-memory-agents"><i class="fa fa-check"></i><b>7.2</b> Define biased and memory agents</a></li>
<li class="chapter" data-level="7.3" data-path="model-comparison.html"><a href="model-comparison.html#generating-the-agents-1"><i class="fa fa-check"></i><b>7.3</b> Generating the agents</a></li>
<li class="chapter" data-level="7.4" data-path="model-comparison.html"><a href="model-comparison.html#prep-the-data"><i class="fa fa-check"></i><b>7.4</b> Prep the data</a></li>
<li class="chapter" data-level="7.5" data-path="model-comparison.html"><a href="model-comparison.html#log-posterior-likelihood"><i class="fa fa-check"></i><b>7.5</b> Log posterior likelihood</a></li>
<li class="chapter" data-level="7.6" data-path="model-comparison.html"><a href="model-comparison.html#create-the-models-multilevel-biased-agents"><i class="fa fa-check"></i><b>7.6</b> Create the models: multilevel biased agents</a></li>
<li class="chapter" data-level="7.7" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-memory-model"><i class="fa fa-check"></i><b>7.7</b> Multilevel memory model</a></li>
<li class="chapter" data-level="7.8" data-path="model-comparison.html"><a href="model-comparison.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>7.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="7.9" data-path="model-comparison.html"><a href="model-comparison.html#calculating-the-expected-log-predictive-density-of-a-model"><i class="fa fa-check"></i><b>7.9</b> Calculating the expected log predictive density of a model</a></li>
<li class="chapter" data-level="7.10" data-path="model-comparison.html"><a href="model-comparison.html#implementing-cross-validation"><i class="fa fa-check"></i><b>7.10</b> Implementing Cross-Validation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-biased-agents"><i class="fa fa-check"></i><b>7.10.1</b> Create cross-validation ready stan model for biased agents</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-memory-agents"><i class="fa fa-check"></i><b>7.10.2</b> Create cross-validation ready stan model for memory agents</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="model-comparison.html"><a href="model-comparison.html#calculating-elpd-and-comparing"><i class="fa fa-check"></i><b>7.11</b> Calculating elpd and comparing</a></li>
<li class="chapter" data-level="7.12" data-path="model-comparison.html"><a href="model-comparison.html#limitations-of-model-comparison-techniques"><i class="fa fa-check"></i><b>7.12</b> Limitations of model comparison techniques</a></li>
<li class="chapter" data-level="7.13" data-path="model-comparison.html"><a href="model-comparison.html#mixture-models"><i class="fa fa-check"></i><b>7.13</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="model-comparison.html"><a href="model-comparison.html#load-the-dataset"><i class="fa fa-check"></i><b>7.13.1</b> Load the dataset</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="model-comparison.html"><a href="model-comparison.html#stan-model-mixing-biased-and-noise"><i class="fa fa-check"></i><b>7.14</b> Stan model mixing biased and noise</a></li>
<li class="chapter" data-level="7.15" data-path="model-comparison.html"><a href="model-comparison.html#fitting-and-assessing-the-model"><i class="fa fa-check"></i><b>7.15</b> Fitting and assessing the model</a></li>
<li class="chapter" data-level="7.16" data-path="model-comparison.html"><a href="model-comparison.html#basic-evaluation"><i class="fa fa-check"></i><b>7.16</b> Basic evaluation</a></li>
<li class="chapter" data-level="7.17" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-mixture-model"><i class="fa fa-check"></i><b>7.17</b> Multilevel mixture model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html"><i class="fa fa-check"></i><b>8</b> Bonus chapter: Additional models developed by students</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#additional-models"><i class="fa fa-check"></i><b>8.1</b> Additional models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.1</b> Probabilistic Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-asymmetric-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.2</b> Probabilistic asymmetric Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-rate"><i class="fa fa-check"></i><b>8.1.3</b> Memory agent with exponential memory decay (rate)</a></li>
<li class="chapter" data-level="8.1.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-exponential"><i class="fa fa-check"></i><b>8.1.4</b> Memory agent with exponential memory decay (exponential)</a></li>
<li class="chapter" data-level="8.1.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-but-separate-memory-for-wins-and-losses"><i class="fa fa-check"></i><b>8.1.5</b> Memory agent with exponential memory decay, but separate memory for wins and losses</a></li>
<li class="chapter" data-level="8.1.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-and-with-confidence"><i class="fa fa-check"></i><b>8.1.6</b> Memory agent with exponential memory decay, and with confidence</a></li>
<li class="chapter" data-level="8.1.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#reinforcement-learning-rescorla-wagner"><i class="fa fa-check"></i><b>8.1.7</b> Reinforcement learning (Rescorla Wagner)</a></li>
<li class="chapter" data-level="8.1.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#hierarchical-gaussian-filter"><i class="fa fa-check"></i><b>8.1.8</b> Hierarchical gaussian filter</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#implementing-the-wsls-model"><i class="fa fa-check"></i><b>8.2</b> Implementing the WSLS model</a></li>
<li class="chapter" data-level="8.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#load-packages"><i class="fa fa-check"></i><b>8.3</b> Load packages</a></li>
<li class="chapter" data-level="8.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#generate-data"><i class="fa fa-check"></i><b>8.4</b> Generate data</a></li>
<li class="chapter" data-level="8.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#sanity-check-for-the-data"><i class="fa fa-check"></i><b>8.5</b> Sanity check for the data</a></li>
<li class="chapter" data-level="8.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#more-sanity-check"><i class="fa fa-check"></i><b>8.6</b> More sanity check</a></li>
<li class="chapter" data-level="8.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-data-for-single-agent-model"><i class="fa fa-check"></i><b>8.7</b> Create data for single agent model</a></li>
<li class="chapter" data-level="8.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model"><i class="fa fa-check"></i><b>8.8</b> Create the model</a></li>
<li class="chapter" data-level="8.9" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#basic-assessment"><i class="fa fa-check"></i><b>8.9</b> Basic assessment</a></li>
<li class="chapter" data-level="8.10" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-multilevel-data"><i class="fa fa-check"></i><b>8.10</b> Create multilevel data</a></li>
<li class="chapter" data-level="8.11" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model-1"><i class="fa fa-check"></i><b>8.11</b> Create the model</a></li>
<li class="chapter" data-level="8.12" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#quality-checks"><i class="fa fa-check"></i><b>8.12</b> Quality checks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>9</b> Bayesian models of cognition</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#load-the-packages"><i class="fa fa-check"></i><b>9.1</b> Load the packages</a></li>
<li class="chapter" data-level="9.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#design-the-model"><i class="fa fa-check"></i><b>9.2</b> Design the model</a></li>
<li class="chapter" data-level="9.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-data"><i class="fa fa-check"></i><b>9.3</b> Create the data</a></li>
<li class="chapter" data-level="9.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize"><i class="fa fa-check"></i><b>9.4</b> Visualize</a></li>
<li class="chapter" data-level="9.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#data-for-stan"><i class="fa fa-check"></i><b>9.5</b> Data for Stan</a></li>
<li class="chapter" data-level="9.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-stan-model"><i class="fa fa-check"></i><b>9.6</b> Create the Stan Model</a></li>
<li class="chapter" data-level="9.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-model"><i class="fa fa-check"></i><b>9.7</b> Fitting the model</a></li>
<li class="chapter" data-level="9.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#basic-evaluation-1"><i class="fa fa-check"></i><b>9.8</b> Basic evaluation</a></li>
<li class="chapter" data-level="9.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayes"><i class="fa fa-check"></i><b>9.9</b> Weighted Bayes</a></li>
<li class="chapter" data-level="9.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize-1"><i class="fa fa-check"></i><b>9.10</b> Visualize</a></li>
<li class="chapter" data-level="9.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-the-weighted-bayes-stan-model-simple-formula"><i class="fa fa-check"></i><b>9.11</b> Build the Weighted Bayes Stan model (simple formula)</a></li>
<li class="chapter" data-level="9.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-evaluation"><i class="fa fa-check"></i><b>9.12</b> Model evaluation</a></li>
<li class="chapter" data-level="9.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-recovery"><i class="fa fa-check"></i><b>9.13</b> Model recovery</a></li>
<li class="chapter" data-level="9.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel"><i class="fa fa-check"></i><b>9.14</b> Multilevel</a></li>
<li class="chapter" data-level="9.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bonus-build-the-weighted-bayes-stan-model-fancier-formula"><i class="fa fa-check"></i><b>9.15</b> Bonus: Build the Weighted Bayes Stan model (fancier formula)</a></li>
<li class="chapter" data-level="9.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluation"><i class="fa fa-check"></i><b>9.16</b> Evaluation</a></li>
<li class="chapter" data-level="9.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-a-temporal-bayes-storing-current-belief-as-prior-for-next-turn"><i class="fa fa-check"></i><b>9.17</b> Build a temporal Bayes (storing current belief as prior for next turn)</a></li>
<li class="chapter" data-level="9.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluate"><i class="fa fa-check"></i><b>9.18</b> Evaluate</a></li>
<li class="chapter" data-level="9.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-simple-bayes-model"><i class="fa fa-check"></i><b>9.19</b> Multilevel version of the simple bayes model</a></li>
<li class="chapter" data-level="9.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-weighted-bayes-model"><i class="fa fa-check"></i><b>9.20</b> Multilevel version of the weighted bayes model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="categorization-models.html"><a href="categorization-models.html"><i class="fa fa-check"></i><b>10</b> Categorization models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="categorization-models.html"><a href="categorization-models.html#multilevel-gcm"><i class="fa fa-check"></i><b>10.1</b> Multilevel GCM</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="categorization-models.html"><a href="categorization-models.html#simulate-hierarchical-simplices"><i class="fa fa-check"></i><b>10.1.1</b> Simulate hierarchical simplices</a></li>
<li class="chapter" data-level="10.1.2" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-data-simulation"><i class="fa fa-check"></i><b>10.1.2</b> Set up the data simulation</a></li>
<li class="chapter" data-level="10.1.3" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-stan-model"><i class="fa fa-check"></i><b>10.1.3</b> Set up the Stan model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="categorization-models.html"><a href="categorization-models.html#now-we-parallelize-n.b.-not-finished"><i class="fa fa-check"></i><b>10.2</b> Now we parallelize [N.B. NOT FINISHED]</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="categorization-models.html"><a href="categorization-models.html#student-produced-models-of-categorization"><i class="fa fa-check"></i><b>10.2.1</b> Student-produced models of categorization</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">10-CategorizationModels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorization-models" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Categorization models<a href="categorization-models.html#categorization-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this module the course covers formal models of categorization. In particular, here we implement a version of the Generalized Context Model (from now on GCM).</p>
<p>[MISSING: INTRODUCTION TO THE GCM]</p>
<p>In order to understand the GCM, we will rely on a setup from Kruschke 1993. Participants go through 8 blocks of trials. Within each block, participants see 8 stimuli, the same across every block. Each stimulus has to be categorised (classified) as belonging to either category A or category B. After categorizing a stimulus, feedback is given, so that the participant knows which category the stimulus truly belongs to.</p>
<p>The stimuli differ along two continuous dimensions (more specifically the height of a square and the position of a line with it).</p>
<p>Following on the structure in Kruschke 1993, we need to start simulating data. Let’s start with the stimuli.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="categorization-models.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the stimuli, their height and position features, and their category</span></span>
<span id="cb390-2"><a href="categorization-models.html#cb390-2" aria-hidden="true" tabindex="-1"></a>stimulus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>)</span>
<span id="cb390-3"><a href="categorization-models.html#cb390-3" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">3</span>, <span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb390-4"><a href="categorization-models.html#cb390-4" aria-hidden="true" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb390-5"><a href="categorization-models.html#cb390-5" aria-hidden="true" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb390-6"><a href="categorization-models.html#cb390-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-7"><a href="categorization-models.html#cb390-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Making this into a tibble</span></span>
<span id="cb390-8"><a href="categorization-models.html#cb390-8" aria-hidden="true" tabindex="-1"></a>stimuli <span class="ot">&lt;-</span> <span class="fu">tibble</span>(stimulus, height, position, category)</span>
<span id="cb390-9"><a href="categorization-models.html#cb390-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-10"><a href="categorization-models.html#cb390-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting to make sure all looks right</span></span>
<span id="cb390-11"><a href="categorization-models.html#cb390-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stimuli, <span class="fu">aes</span>(position, height, <span class="at">color =</span> category, <span class="at">label =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb390-12"><a href="categorization-models.html#cb390-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb390-13"><a href="categorization-models.html#cb390-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb390-14"><a href="categorization-models.html#cb390-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb390-15"><a href="categorization-models.html#cb390-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="categorization-models.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating the sequence of stimuli in the full experiment</span></span>
<span id="cb391-2"><a href="categorization-models.html#cb391-2" aria-hidden="true" tabindex="-1"></a>sequence <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb391-3"><a href="categorization-models.html#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb391-4"><a href="categorization-models.html#cb391-4" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">8</span>), <span class="dv">8</span>, <span class="at">replace =</span> F)</span>
<span id="cb391-5"><a href="categorization-models.html#cb391-5" aria-hidden="true" tabindex="-1"></a>  sequence <span class="ot">&lt;-</span> <span class="fu">append</span>(sequence, temp)</span>
<span id="cb391-6"><a href="categorization-models.html#cb391-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb391-7"><a href="categorization-models.html#cb391-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-8"><a href="categorization-models.html#cb391-8" aria-hidden="true" tabindex="-1"></a>experiment <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">stimulus =</span> sequence, <span class="at">height =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="cn">NA</span>, <span class="at">category =</span> <span class="cn">NA</span>)</span>
<span id="cb391-9"><a href="categorization-models.html#cb391-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment))) {</span>
<span id="cb391-10"><a href="categorization-models.html#cb391-10" aria-hidden="true" tabindex="-1"></a>  experiment<span class="sc">$</span>height[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>height[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb391-11"><a href="categorization-models.html#cb391-11" aria-hidden="true" tabindex="-1"></a>  experiment<span class="sc">$</span>position[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>position[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb391-12"><a href="categorization-models.html#cb391-12" aria-hidden="true" tabindex="-1"></a>  experiment<span class="sc">$</span>category[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(stimuli<span class="sc">$</span>category[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]))</span>
<span id="cb391-13"><a href="categorization-models.html#cb391-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We then have to simulate an agent using the GCM to assess the stimuli.
N.B. code based on work by Sara Østergaard</p>
<p>First we define functions for distance and similarity and assess them.
Distance takes feature values along n dimensions and calculate their euclidean distance,
weighing dimensions according to pregiven weights (w).
Similarity decays exponentially with distance, with a pre-given exponent (c). See plot.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="categorization-models.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance </span></span>
<span id="cb392-2"><a href="categorization-models.html#cb392-2" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="cf">function</span>(vect1, vect2, w) {</span>
<span id="cb392-3"><a href="categorization-models.html#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(w <span class="sc">*</span> <span class="fu">abs</span>(vect1 <span class="sc">-</span> vect2)))</span>
<span id="cb392-4"><a href="categorization-models.html#cb392-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb392-5"><a href="categorization-models.html#cb392-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-6"><a href="categorization-models.html#cb392-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Similarity</span></span>
<span id="cb392-7"><a href="categorization-models.html#cb392-7" aria-hidden="true" tabindex="-1"></a>similarity <span class="ot">&lt;-</span> <span class="cf">function</span>(distance, c) {</span>
<span id="cb392-8"><a href="categorization-models.html#cb392-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>c <span class="sc">*</span> distance))</span>
<span id="cb392-9"><a href="categorization-models.html#cb392-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb392-10"><a href="categorization-models.html#cb392-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-11"><a href="categorization-models.html#cb392-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s assess similarity</span></span>
<span id="cb392-12"><a href="categorization-models.html#cb392-12" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb392-13"><a href="categorization-models.html#cb392-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb392-14"><a href="categorization-models.html#cb392-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>,.<span class="dv">2</span>, .<span class="dv">3</span>,.<span class="dv">4</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), </span>
<span id="cb392-15"><a href="categorization-models.html#cb392-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb392-16"><a href="categorization-models.html#cb392-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb392-17"><a href="categorization-models.html#cb392-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">similarity =</span> <span class="fu">similarity</span>(distance, c)</span>
<span id="cb392-18"><a href="categorization-models.html#cb392-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb392-19"><a href="categorization-models.html#cb392-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-20"><a href="categorization-models.html#cb392-20" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb392-21"><a href="categorization-models.html#cb392-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb392-22"><a href="categorization-models.html#cb392-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(distance, similarity, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span> </span>
<span id="cb392-23"><a href="categorization-models.html#cb392-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="categorization-models.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
<p>With distance and similarity in place, we now need to implement an agent that can observe stimuli,
put them into categories according to feedback and - once enough stimuli are collected to have at
least one exemplar in each category - compare stimuli to exemplars in each category and assess
which category is more likely.
In other words: 1) if not enough stimuli have already been observed, the agent picks a category at random,
receives feedback and adjusts accordingly the category; otherwise, 2) it assesses average distance (according to weights) from observed exemplars by category; calculates similarity (according to c); and uses the relative similarity to the two categories to produce a probability of choosing category one. then it receives feedback and adjusts category accordingly.</p>
<p>As usual we make the agent a function, so that we can more easily deploy it.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="categorization-models.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="do">### generative model </span><span class="al">###</span></span>
<span id="cb394-2"><a href="categorization-models.html#cb394-2" aria-hidden="true" tabindex="-1"></a>gcm <span class="ot">&lt;-</span> <span class="cf">function</span>(w, c, obs, cat_one, <span class="at">quiet =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb394-3"><a href="categorization-models.html#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create an empty list to save probability of saying &quot;1&quot; for each trial</span></span>
<span id="cb394-4"><a href="categorization-models.html#cb394-4" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb394-5"><a href="categorization-models.html#cb394-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb394-6"><a href="categorization-models.html#cb394-6" aria-hidden="true" tabindex="-1"></a>  ntrials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb394-7"><a href="categorization-models.html#cb394-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb394-8"><a href="categorization-models.html#cb394-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ntrials) {</span>
<span id="cb394-9"><a href="categorization-models.html#cb394-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If quiet is FALSE, print every ten trials</span></span>
<span id="cb394-10"><a href="categorization-models.html#cb394-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>quiet <span class="sc">&amp;&amp;</span> i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb394-11"><a href="categorization-models.html#cb394-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;i =&quot;</span>, i))</span>
<span id="cb394-12"><a href="categorization-models.html#cb394-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb394-13"><a href="categorization-models.html#cb394-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if this is the first trial, or there any category with no exemplars seen yet, set the choice to random</span></span>
<span id="cb394-14"><a href="categorization-models.html#cb394-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> (i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb394-15"><a href="categorization-models.html#cb394-15" aria-hidden="true" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, .<span class="dv">5</span>)</span>
<span id="cb394-16"><a href="categorization-models.html#cb394-16" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb394-17"><a href="categorization-models.html#cb394-17" aria-hidden="true" tabindex="-1"></a>      similarities <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb394-18"><a href="categorization-models.html#cb394-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># for each previously seen stimulus assess distance and similarity</span></span>
<span id="cb394-19"><a href="categorization-models.html#cb394-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (e <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb394-20"><a href="categorization-models.html#cb394-20" aria-hidden="true" tabindex="-1"></a>        sim <span class="ot">&lt;-</span> <span class="fu">similarity</span>(<span class="fu">distance</span>(obs[i, ], obs[e, ], w), c)</span>
<span id="cb394-21"><a href="categorization-models.html#cb394-21" aria-hidden="true" tabindex="-1"></a>        similarities <span class="ot">&lt;-</span> <span class="fu">c</span>(similarities, sim)</span>
<span id="cb394-22"><a href="categorization-models.html#cb394-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb394-23"><a href="categorization-models.html#cb394-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate prob of saying &quot;1&quot; by dividing similarity to 1 by the sum of similarity to 1 and to 2</span></span>
<span id="cb394-24"><a href="categorization-models.html#cb394-24" aria-hidden="true" tabindex="-1"></a>      numerator <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb394-25"><a href="categorization-models.html#cb394-25" aria-hidden="true" tabindex="-1"></a>      denominator <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb394-26"><a href="categorization-models.html#cb394-26" aria-hidden="true" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, numerator <span class="sc">/</span> denominator)</span>
<span id="cb394-27"><a href="categorization-models.html#cb394-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb394-28"><a href="categorization-models.html#cb394-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb394-29"><a href="categorization-models.html#cb394-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-30"><a href="categorization-models.html#cb394-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(ntrials, <span class="dv">1</span>, r))</span>
<span id="cb394-31"><a href="categorization-models.html#cb394-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With the agent in place, we can now simulate behavior on our simulated stimuli and observe the impact of different weights and scaling parameters c.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="categorization-models.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for simulation responses</span></span>
<span id="cb395-2"><a href="categorization-models.html#cb395-2" aria-hidden="true" tabindex="-1"></a>simulate_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, w, c) {</span>
<span id="cb395-3"><a href="categorization-models.html#cb395-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb395-4"><a href="categorization-models.html#cb395-4" aria-hidden="true" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb395-5"><a href="categorization-models.html#cb395-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))</span>
<span id="cb395-6"><a href="categorization-models.html#cb395-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb395-7"><a href="categorization-models.html#cb395-7" aria-hidden="true" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category</span>
<span id="cb395-8"><a href="categorization-models.html#cb395-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb395-9"><a href="categorization-models.html#cb395-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;equal&quot;</span>) {</span>
<span id="cb395-10"><a href="categorization-models.html#cb395-10" aria-hidden="true" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb395-11"><a href="categorization-models.html#cb395-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed1&quot;</span>) {</span>
<span id="cb395-12"><a href="categorization-models.html#cb395-12" aria-hidden="true" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb395-13"><a href="categorization-models.html#cb395-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed2&quot;</span>) {</span>
<span id="cb395-14"><a href="categorization-models.html#cb395-14" aria-hidden="true" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)</span>
<span id="cb395-15"><a href="categorization-models.html#cb395-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb395-16"><a href="categorization-models.html#cb395-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-17"><a href="categorization-models.html#cb395-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate responses</span></span>
<span id="cb395-18"><a href="categorization-models.html#cb395-18" aria-hidden="true" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">gcm</span>(</span>
<span id="cb395-19"><a href="categorization-models.html#cb395-19" aria-hidden="true" tabindex="-1"></a>        weight,</span>
<span id="cb395-20"><a href="categorization-models.html#cb395-20" aria-hidden="true" tabindex="-1"></a>        c,</span>
<span id="cb395-21"><a href="categorization-models.html#cb395-21" aria-hidden="true" tabindex="-1"></a>        observations,</span>
<span id="cb395-22"><a href="categorization-models.html#cb395-22" aria-hidden="true" tabindex="-1"></a>        category</span>
<span id="cb395-23"><a href="categorization-models.html#cb395-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb395-24"><a href="categorization-models.html#cb395-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb395-25"><a href="categorization-models.html#cb395-25" aria-hidden="true" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb395-26"><a href="categorization-models.html#cb395-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb395-27"><a href="categorization-models.html#cb395-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">trial =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment)),</span>
<span id="cb395-28"><a href="categorization-models.html#cb395-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb395-29"><a href="categorization-models.html#cb395-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb395-30"><a href="categorization-models.html#cb395-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> <span class="fu">seq_along</span>(correct),</span>
<span id="cb395-31"><a href="categorization-models.html#cb395-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">c =</span> c,</span>
<span id="cb395-32"><a href="categorization-models.html#cb395-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">w =</span> w,</span>
<span id="cb395-33"><a href="categorization-models.html#cb395-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb395-34"><a href="categorization-models.html#cb395-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb395-35"><a href="categorization-models.html#cb395-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-36"><a href="categorization-models.html#cb395-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb395-37"><a href="categorization-models.html#cb395-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb395-38"><a href="categorization-models.html#cb395-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-39"><a href="categorization-models.html#cb395-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-40"><a href="categorization-models.html#cb395-40" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate responses</span></span>
<span id="cb395-41"><a href="categorization-models.html#cb395-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb395-42"><a href="categorization-models.html#cb395-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-43"><a href="categorization-models.html#cb395-43" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb395-44"><a href="categorization-models.html#cb395-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_grid</span>(</span>
<span id="cb395-45"><a href="categorization-models.html#cb395-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">agent =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb395-46"><a href="categorization-models.html#cb395-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">c =</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.2</span>),</span>
<span id="cb395-47"><a href="categorization-models.html#cb395-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">w =</span> <span class="fu">c</span>(<span class="st">&quot;equal&quot;</span>, <span class="st">&quot;skewed1&quot;</span>, <span class="st">&quot;skewed2&quot;</span>)</span>
<span id="cb395-48"><a href="categorization-models.html#cb395-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb395-49"><a href="categorization-models.html#cb395-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-50"><a href="categorization-models.html#cb395-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-51"><a href="categorization-models.html#cb395-51" aria-hidden="true" tabindex="-1"></a>simulated_responses <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(param_df,</span>
<span id="cb395-52"><a href="categorization-models.html#cb395-52" aria-hidden="true" tabindex="-1"></a>    simulate_responses,</span>
<span id="cb395-53"><a href="categorization-models.html#cb395-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-54"><a href="categorization-models.html#cb395-54" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>And now we can try a few plots to better understand how the model fares and the difference made by weights and scaling factors.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="categorization-models.html#cb396-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb396-2"><a href="categorization-models.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">w =</span> <span class="fu">as.factor</span>(w)) <span class="sc">%&gt;%</span></span>
<span id="cb396-3"><a href="categorization-models.html#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> w, <span class="at">color =</span> w)) <span class="sc">+</span></span>
<span id="cb396-4"><a href="categorization-models.html#cb396-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb396-5"><a href="categorization-models.html#cb396-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb396-6"><a href="categorization-models.html#cb396-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(c <span class="sc">~</span> .)</span>
<span id="cb396-7"><a href="categorization-models.html#cb396-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-8"><a href="categorization-models.html#cb396-8" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb396-9"><a href="categorization-models.html#cb396-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb396-10"><a href="categorization-models.html#cb396-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span></span>
<span id="cb396-11"><a href="categorization-models.html#cb396-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb396-12"><a href="categorization-models.html#cb396-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb396-13"><a href="categorization-models.html#cb396-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(w <span class="sc">~</span> .)</span>
<span id="cb396-14"><a href="categorization-models.html#cb396-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-15"><a href="categorization-models.html#cb396-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="categorization-models.html#cb398-1" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb398-2"><a href="categorization-models.html#cb398-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb398-3"><a href="categorization-models.html#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(st, performance, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span></span>
<span id="cb398-4"><a href="categorization-models.html#cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb398-5"><a href="categorization-models.html#cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb398-6"><a href="categorization-models.html#cb398-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(w <span class="sc">~</span> .)</span></code></pre></div>
<p>[MISSING: Discussion of how to make sense of the plots: Equal Weights (matching the actual rule) generating better decisions as long as c is above 1]</p>
<p>While we could try different scenarios, let us now move on to inference. We need to build the same GCM model in Stan.</p>
<p>[MISSING: MORE DETAILED EXPLANATION]</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="categorization-models.html#cb399-1" aria-hidden="true" tabindex="-1"></a>gcm_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb399-2"><a href="categorization-models.html#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="st">// Generalized Context Model (GCM)</span></span>
<span id="cb399-3"><a href="categorization-models.html#cb399-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-4"><a href="categorization-models.html#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb399-5"><a href="categorization-models.html#cb399-5" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; ntrials;  // number of trials</span></span>
<span id="cb399-6"><a href="categorization-models.html#cb399-6" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nfeatures;  // number of predefined relevant features</span></span>
<span id="cb399-7"><a href="categorization-models.html#cb399-7" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_one; // true responses on a trial by trial basis</span></span>
<span id="cb399-8"><a href="categorization-models.html#cb399-8" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; y;  // decisions on a trial by trial basis</span></span>
<span id="cb399-9"><a href="categorization-models.html#cb399-9" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials, nfeatures] real obs; // stimuli as vectors of features</span></span>
<span id="cb399-10"><a href="categorization-models.html#cb399-10" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; b;  // initial bias for category one over two</span></span>
<span id="cb399-11"><a href="categorization-models.html#cb399-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-12"><a href="categorization-models.html#cb399-12" aria-hidden="true" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb399-13"><a href="categorization-models.html#cb399-13" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[nfeatures] w_prior_values;  // concentration parameters for dirichlet distribution &lt;lower=1&gt;</span></span>
<span id="cb399-14"><a href="categorization-models.html#cb399-14" aria-hidden="true" tabindex="-1"></a><span class="st">    array[2] real c_prior_values;  // mean and variance for logit-normal distribution</span></span>
<span id="cb399-15"><a href="categorization-models.html#cb399-15" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb399-16"><a href="categorization-models.html#cb399-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-17"><a href="categorization-models.html#cb399-17" aria-hidden="true" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb399-18"><a href="categorization-models.html#cb399-18" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_two; // dummy variable for category two over cat 1</span></span>
<span id="cb399-19"><a href="categorization-models.html#cb399-19" aria-hidden="true" tabindex="-1"></a><span class="st">    array[sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_one_idx; // array of which stimuli are cat 1</span></span>
<span id="cb399-20"><a href="categorization-models.html#cb399-20" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials-sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_two_idx; //  array of which stimuli are cat 2</span></span>
<span id="cb399-21"><a href="categorization-models.html#cb399-21" aria-hidden="true" tabindex="-1"></a><span class="st">    int idx_one = 1; // Initializing </span></span>
<span id="cb399-22"><a href="categorization-models.html#cb399-22" aria-hidden="true" tabindex="-1"></a><span class="st">    int idx_two = 1;</span></span>
<span id="cb399-23"><a href="categorization-models.html#cb399-23" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials){</span></span>
<span id="cb399-24"><a href="categorization-models.html#cb399-24" aria-hidden="true" tabindex="-1"></a><span class="st">        cat_two[i] = abs(cat_one[i]-1);</span></span>
<span id="cb399-25"><a href="categorization-models.html#cb399-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-26"><a href="categorization-models.html#cb399-26" aria-hidden="true" tabindex="-1"></a><span class="st">        if (cat_one[i]==1){</span></span>
<span id="cb399-27"><a href="categorization-models.html#cb399-27" aria-hidden="true" tabindex="-1"></a><span class="st">            cat_one_idx[idx_one] = i;</span></span>
<span id="cb399-28"><a href="categorization-models.html#cb399-28" aria-hidden="true" tabindex="-1"></a><span class="st">            idx_one +=1;</span></span>
<span id="cb399-29"><a href="categorization-models.html#cb399-29" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb399-30"><a href="categorization-models.html#cb399-30" aria-hidden="true" tabindex="-1"></a><span class="st">            cat_two_idx[idx_two] = i;</span></span>
<span id="cb399-31"><a href="categorization-models.html#cb399-31" aria-hidden="true" tabindex="-1"></a><span class="st">            idx_two += 1;</span></span>
<span id="cb399-32"><a href="categorization-models.html#cb399-32" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb399-33"><a href="categorization-models.html#cb399-33" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb399-34"><a href="categorization-models.html#cb399-34" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb399-35"><a href="categorization-models.html#cb399-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-36"><a href="categorization-models.html#cb399-36" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb399-37"><a href="categorization-models.html#cb399-37" aria-hidden="true" tabindex="-1"></a><span class="st">    simplex[nfeatures] w;  // simplex means sum(w)=1</span></span>
<span id="cb399-38"><a href="categorization-models.html#cb399-38" aria-hidden="true" tabindex="-1"></a><span class="st">    real logit_c;</span></span>
<span id="cb399-39"><a href="categorization-models.html#cb399-39" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb399-40"><a href="categorization-models.html#cb399-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-41"><a href="categorization-models.html#cb399-41" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb399-42"><a href="categorization-models.html#cb399-42" aria-hidden="true" tabindex="-1"></a><span class="st">    // parameter c </span></span>
<span id="cb399-43"><a href="categorization-models.html#cb399-43" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=2&gt; c = inv_logit(logit_c)*2;  // times 2 as c is bounded between 0 and 2</span></span>
<span id="cb399-44"><a href="categorization-models.html#cb399-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-45"><a href="categorization-models.html#cb399-45" aria-hidden="true" tabindex="-1"></a><span class="st">    // parameter r (probability of response = category 1)</span></span>
<span id="cb399-46"><a href="categorization-models.html#cb399-46" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real&lt;lower=0.0001, upper=0.9999&gt; r;</span></span>
<span id="cb399-47"><a href="categorization-models.html#cb399-47" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real rr;</span></span>
<span id="cb399-48"><a href="categorization-models.html#cb399-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-49"><a href="categorization-models.html#cb399-49" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb399-50"><a href="categorization-models.html#cb399-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-51"><a href="categorization-models.html#cb399-51" aria-hidden="true" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb399-52"><a href="categorization-models.html#cb399-52" aria-hidden="true" tabindex="-1"></a><span class="st">        array[(i-1)] real exemplar_sim;</span></span>
<span id="cb399-53"><a href="categorization-models.html#cb399-53" aria-hidden="true" tabindex="-1"></a><span class="st">        for (e in 1:(i-1)){</span></span>
<span id="cb399-54"><a href="categorization-models.html#cb399-54" aria-hidden="true" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb399-55"><a href="categorization-models.html#cb399-55" aria-hidden="true" tabindex="-1"></a><span class="st">            for (j in 1:nfeatures) {</span></span>
<span id="cb399-56"><a href="categorization-models.html#cb399-56" aria-hidden="true" tabindex="-1"></a><span class="st">                tmp_dist[j] = w[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb399-57"><a href="categorization-models.html#cb399-57" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb399-58"><a href="categorization-models.html#cb399-58" aria-hidden="true" tabindex="-1"></a><span class="st">            exemplar_sim[e] = exp(-c * sum(tmp_dist));</span></span>
<span id="cb399-59"><a href="categorization-models.html#cb399-59" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb399-60"><a href="categorization-models.html#cb399-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-61"><a href="categorization-models.html#cb399-61" aria-hidden="true" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb399-62"><a href="categorization-models.html#cb399-62" aria-hidden="true" tabindex="-1"></a><span class="st">            r[i] = 0.5;</span></span>
<span id="cb399-63"><a href="categorization-models.html#cb399-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-64"><a href="categorization-models.html#cb399-64" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb399-65"><a href="categorization-models.html#cb399-65" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb399-66"><a href="categorization-models.html#cb399-66" aria-hidden="true" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb399-67"><a href="categorization-models.html#cb399-67" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb399-68"><a href="categorization-models.html#cb399-68" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb399-69"><a href="categorization-models.html#cb399-69" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb399-70"><a href="categorization-models.html#cb399-70" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[1] = sum(exemplar_sim[tmp_idx_one]);</span></span>
<span id="cb399-71"><a href="categorization-models.html#cb399-71" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[2] = sum(exemplar_sim[tmp_idx_two]);</span></span>
<span id="cb399-72"><a href="categorization-models.html#cb399-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-73"><a href="categorization-models.html#cb399-73" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate r[i]</span></span>
<span id="cb399-74"><a href="categorization-models.html#cb399-74" aria-hidden="true" tabindex="-1"></a><span class="st">            rr[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb399-75"><a href="categorization-models.html#cb399-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-76"><a href="categorization-models.html#cb399-76" aria-hidden="true" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb399-77"><a href="categorization-models.html#cb399-77" aria-hidden="true" tabindex="-1"></a><span class="st">            if (rr[i] &gt; 0.9999){</span></span>
<span id="cb399-78"><a href="categorization-models.html#cb399-78" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = 0.9999;</span></span>
<span id="cb399-79"><a href="categorization-models.html#cb399-79" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr[i] &lt; 0.0001) {</span></span>
<span id="cb399-80"><a href="categorization-models.html#cb399-80" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = 0.0001;</span></span>
<span id="cb399-81"><a href="categorization-models.html#cb399-81" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr[i] &gt; 0.0001 &amp;&amp; rr[i] &lt; 0.9999) {</span></span>
<span id="cb399-82"><a href="categorization-models.html#cb399-82" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = rr[i];</span></span>
<span id="cb399-83"><a href="categorization-models.html#cb399-83" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb399-84"><a href="categorization-models.html#cb399-84" aria-hidden="true" tabindex="-1"></a><span class="st">                r[i] = 0.5;</span></span>
<span id="cb399-85"><a href="categorization-models.html#cb399-85" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb399-86"><a href="categorization-models.html#cb399-86" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb399-87"><a href="categorization-models.html#cb399-87" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb399-88"><a href="categorization-models.html#cb399-88" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb399-89"><a href="categorization-models.html#cb399-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-90"><a href="categorization-models.html#cb399-90" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb399-91"><a href="categorization-models.html#cb399-91" aria-hidden="true" tabindex="-1"></a><span class="st">    // Priors</span></span>
<span id="cb399-92"><a href="categorization-models.html#cb399-92" aria-hidden="true" tabindex="-1"></a><span class="st">    target += dirichlet_lpdf(w | w_prior_values);</span></span>
<span id="cb399-93"><a href="categorization-models.html#cb399-93" aria-hidden="true" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c | c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb399-94"><a href="categorization-models.html#cb399-94" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb399-95"><a href="categorization-models.html#cb399-95" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb399-96"><a href="categorization-models.html#cb399-96" aria-hidden="true" tabindex="-1"></a><span class="st">    // Decision Data</span></span>
<span id="cb399-97"><a href="categorization-models.html#cb399-97" aria-hidden="true" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(y | r);</span></span>
<span id="cb399-98"><a href="categorization-models.html#cb399-98" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb399-99"><a href="categorization-models.html#cb399-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-100"><a href="categorization-models.html#cb399-100" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb399-101"><a href="categorization-models.html#cb399-101" aria-hidden="true" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb399-102"><a href="categorization-models.html#cb399-102" aria-hidden="true" tabindex="-1"></a><span class="st">    simplex[nfeatures] w_prior = dirichlet_rng(w_prior_values);</span></span>
<span id="cb399-103"><a href="categorization-models.html#cb399-103" aria-hidden="true" tabindex="-1"></a><span class="st">    real logit_c_prior = normal_rng(c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb399-104"><a href="categorization-models.html#cb399-104" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=2&gt; c_prior = inv_logit(logit_c_prior)*2;</span></span>
<span id="cb399-105"><a href="categorization-models.html#cb399-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-106"><a href="categorization-models.html#cb399-106" aria-hidden="true" tabindex="-1"></a><span class="st">    // prior pred</span></span>
<span id="cb399-107"><a href="categorization-models.html#cb399-107" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real&lt;lower=0, upper=1&gt; r_prior;</span></span>
<span id="cb399-108"><a href="categorization-models.html#cb399-108" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] real rr_prior;</span></span>
<span id="cb399-109"><a href="categorization-models.html#cb399-109" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb399-110"><a href="categorization-models.html#cb399-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-111"><a href="categorization-models.html#cb399-111" aria-hidden="true" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb399-112"><a href="categorization-models.html#cb399-112" aria-hidden="true" tabindex="-1"></a><span class="st">        array[(i-1)] real exemplar_dist;</span></span>
<span id="cb399-113"><a href="categorization-models.html#cb399-113" aria-hidden="true" tabindex="-1"></a><span class="st">        for (e in 1:(i-1)){</span></span>
<span id="cb399-114"><a href="categorization-models.html#cb399-114" aria-hidden="true" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb399-115"><a href="categorization-models.html#cb399-115" aria-hidden="true" tabindex="-1"></a><span class="st">            for (j in 1:nfeatures) {</span></span>
<span id="cb399-116"><a href="categorization-models.html#cb399-116" aria-hidden="true" tabindex="-1"></a><span class="st">                tmp_dist[j] = w_prior[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb399-117"><a href="categorization-models.html#cb399-117" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb399-118"><a href="categorization-models.html#cb399-118" aria-hidden="true" tabindex="-1"></a><span class="st">            exemplar_dist[e] = sum(tmp_dist);</span></span>
<span id="cb399-119"><a href="categorization-models.html#cb399-119" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb399-120"><a href="categorization-models.html#cb399-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-121"><a href="categorization-models.html#cb399-121" aria-hidden="true" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb399-122"><a href="categorization-models.html#cb399-122" aria-hidden="true" tabindex="-1"></a><span class="st">            r_prior[i] = 0.5;</span></span>
<span id="cb399-123"><a href="categorization-models.html#cb399-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-124"><a href="categorization-models.html#cb399-124" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb399-125"><a href="categorization-models.html#cb399-125" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb399-126"><a href="categorization-models.html#cb399-126" aria-hidden="true" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb399-127"><a href="categorization-models.html#cb399-127" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb399-128"><a href="categorization-models.html#cb399-128" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb399-129"><a href="categorization-models.html#cb399-129" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb399-130"><a href="categorization-models.html#cb399-130" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[1] = exp(-c_prior * sum(exemplar_dist[tmp_idx_one]));</span></span>
<span id="cb399-131"><a href="categorization-models.html#cb399-131" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[2] = exp(-c_prior * sum(exemplar_dist[tmp_idx_two]));</span></span>
<span id="cb399-132"><a href="categorization-models.html#cb399-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-133"><a href="categorization-models.html#cb399-133" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate r[i]</span></span>
<span id="cb399-134"><a href="categorization-models.html#cb399-134" aria-hidden="true" tabindex="-1"></a><span class="st">            rr_prior[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb399-135"><a href="categorization-models.html#cb399-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-136"><a href="categorization-models.html#cb399-136" aria-hidden="true" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb399-137"><a href="categorization-models.html#cb399-137" aria-hidden="true" tabindex="-1"></a><span class="st">            if (rr_prior[i] == 1){</span></span>
<span id="cb399-138"><a href="categorization-models.html#cb399-138" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = 0.9999;</span></span>
<span id="cb399-139"><a href="categorization-models.html#cb399-139" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr_prior[i] == 0) {</span></span>
<span id="cb399-140"><a href="categorization-models.html#cb399-140" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = 0.0001;</span></span>
<span id="cb399-141"><a href="categorization-models.html#cb399-141" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr_prior[i] &gt; 0 &amp;&amp; rr_prior[i] &lt; 1) {</span></span>
<span id="cb399-142"><a href="categorization-models.html#cb399-142" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = rr_prior[i];</span></span>
<span id="cb399-143"><a href="categorization-models.html#cb399-143" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb399-144"><a href="categorization-models.html#cb399-144" aria-hidden="true" tabindex="-1"></a><span class="st">                r_prior[i] = 0.5;</span></span>
<span id="cb399-145"><a href="categorization-models.html#cb399-145" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb399-146"><a href="categorization-models.html#cb399-146" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb399-147"><a href="categorization-models.html#cb399-147" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb399-148"><a href="categorization-models.html#cb399-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-149"><a href="categorization-models.html#cb399-149" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; priorpred = bernoulli_rng(r_prior);</span></span>
<span id="cb399-150"><a href="categorization-models.html#cb399-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-151"><a href="categorization-models.html#cb399-151" aria-hidden="true" tabindex="-1"></a><span class="st">    // posterior pred</span></span>
<span id="cb399-152"><a href="categorization-models.html#cb399-152" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; posteriorpred = bernoulli_rng(r);</span></span>
<span id="cb399-153"><a href="categorization-models.html#cb399-153" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; posteriorcorrect;</span></span>
<span id="cb399-154"><a href="categorization-models.html#cb399-154" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb399-155"><a href="categorization-models.html#cb399-155" aria-hidden="true" tabindex="-1"></a><span class="st">        if (posteriorpred[i] == cat_one[i]) {</span></span>
<span id="cb399-156"><a href="categorization-models.html#cb399-156" aria-hidden="true" tabindex="-1"></a><span class="st">            posteriorcorrect[i] = 1;</span></span>
<span id="cb399-157"><a href="categorization-models.html#cb399-157" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb399-158"><a href="categorization-models.html#cb399-158" aria-hidden="true" tabindex="-1"></a><span class="st">            posteriorcorrect[i] = 0;</span></span>
<span id="cb399-159"><a href="categorization-models.html#cb399-159" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb399-160"><a href="categorization-models.html#cb399-160" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb399-161"><a href="categorization-models.html#cb399-161" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb399-162"><a href="categorization-models.html#cb399-162" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb399-163"><a href="categorization-models.html#cb399-163" aria-hidden="true" tabindex="-1"></a><span class="st">    // log likelihood</span></span>
<span id="cb399-164"><a href="categorization-models.html#cb399-164" aria-hidden="true" tabindex="-1"></a><span class="st">   array[ntrials] real log_lik;</span></span>
<span id="cb399-165"><a href="categorization-models.html#cb399-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-166"><a href="categorization-models.html#cb399-166" aria-hidden="true" tabindex="-1"></a><span class="st">   for (i in 1:ntrials) {</span></span>
<span id="cb399-167"><a href="categorization-models.html#cb399-167" aria-hidden="true" tabindex="-1"></a><span class="st">        log_lik[i] = bernoulli_lpmf(y[i] | r[i]);</span></span>
<span id="cb399-168"><a href="categorization-models.html#cb399-168" aria-hidden="true" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb399-169"><a href="categorization-models.html#cb399-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-170"><a href="categorization-models.html#cb399-170" aria-hidden="true" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb399-171"><a href="categorization-models.html#cb399-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-172"><a href="categorization-models.html#cb399-172" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb399-173"><a href="categorization-models.html#cb399-173" aria-hidden="true" tabindex="-1"></a>  gcm_model,</span>
<span id="cb399-174"><a href="categorization-models.html#cb399-174" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb399-175"><a href="categorization-models.html#cb399-175" aria-hidden="true" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10_GCM.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10_GCM.stan&quot;</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="categorization-models.html#cb401-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10_GCM.stan&quot;</span>)</span>
<span id="cb401-2"><a href="categorization-models.html#cb401-2" aria-hidden="true" tabindex="-1"></a>mod_GCM <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb401-3"><a href="categorization-models.html#cb401-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span></code></pre></div>
<pre><code>## Model executable is up to date!</code></pre>
<p>Now it’s time to fit the data</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="categorization-models.html#cb403-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb403-2"><a href="categorization-models.html#cb403-2" aria-hidden="true" tabindex="-1"></a>  c <span class="sc">==</span> <span class="st">&quot;1.1&quot;</span> <span class="sc">&amp;</span> w <span class="sc">==</span> <span class="st">&quot;equal&quot;</span></span>
<span id="cb403-3"><a href="categorization-models.html#cb403-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb403-4"><a href="categorization-models.html#cb403-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-5"><a href="categorization-models.html#cb403-5" aria-hidden="true" tabindex="-1"></a>gcm_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb403-6"><a href="categorization-models.html#cb403-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntrials =</span> <span class="fu">nrow</span>(d),</span>
<span id="cb403-7"><a href="categorization-models.html#cb403-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb403-8"><a href="categorization-models.html#cb403-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cat_one =</span> d<span class="sc">$</span>category,</span>
<span id="cb403-9"><a href="categorization-models.html#cb403-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> d<span class="sc">$</span>sim_response,</span>
<span id="cb403-10"><a href="categorization-models.html#cb403-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(d[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb403-11"><a href="categorization-models.html#cb403-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb403-12"><a href="categorization-models.html#cb403-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb403-13"><a href="categorization-models.html#cb403-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb403-14"><a href="categorization-models.html#cb403-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb403-15"><a href="categorization-models.html#cb403-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-16"><a href="categorization-models.html#cb403-16" aria-hidden="true" tabindex="-1"></a>samples_gcm <span class="ot">&lt;-</span> mod_GCM<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb403-17"><a href="categorization-models.html#cb403-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gcm_data,</span>
<span id="cb403-18"><a href="categorization-models.html#cb403-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb403-19"><a href="categorization-models.html#cb403-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb403-20"><a href="categorization-models.html#cb403-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb403-21"><a href="categorization-models.html#cb403-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">4</span>,</span>
<span id="cb403-22"><a href="categorization-models.html#cb403-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb403-23"><a href="categorization-models.html#cb403-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb403-24"><a href="categorization-models.html#cb403-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb403-25"><a href="categorization-models.html#cb403-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 1 chain, with 4 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 405.2 seconds.</code></pre>
<p>Now we need to check the model</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="categorization-models.html#cb405-1" aria-hidden="true" tabindex="-1"></a>samples_gcm<span class="sc">$</span><span class="fu">cmdstan_diagnose</span>()</span></code></pre></div>
<pre><code>## Processing csv files: /var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/Rtmp7XI0Hl/W10_GCM-202304301924-1-3e1afa.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="categorization-models.html#cb407-1" aria-hidden="true" tabindex="-1"></a>samples_gcm<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5,129 × 10
##    variable     mean   median     sd    mad        q5      q95  rhat ess_bulk ess_tail
##    &lt;chr&gt;       &lt;num&gt;    &lt;num&gt;  &lt;num&gt;  &lt;num&gt;     &lt;num&gt;    &lt;num&gt; &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
##  1 lp__     -375.    -374.    1.01   0.792  -376.     -374.     1.00     380.     644.
##  2 w[1]        0.396    0.396 0.0556 0.0550    0.308     0.492  1.01     849.     469.
##  3 w[2]        0.604    0.604 0.0556 0.0550    0.508     0.692  1.01     849.     469.
##  4 logit_c     0.206    0.206 0.177  0.176    -0.0874    0.494  1.00     948.     680.
##  5 c           1.10     1.10  0.0869 0.0868    0.956     1.24   1.00     948.     680.
##  6 r[1]        0.5      0.5   0      0         0.5       0.5   NA         NA       NA 
##  7 r[2]        0.5      0.5   0      0         0.5       0.5   NA         NA       NA 
##  8 r[3]        0.5      0.5   0      0         0.5       0.5   NA         NA       NA 
##  9 r[4]        0.185    0.183 0.0221 0.0226    0.150     0.224  1.00     901.     709.
## 10 r[5]        0.279    0.279 0.0248 0.0247    0.237     0.318  1.00     865.     593.
## # ℹ 5,119 more rows</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="categorization-models.html#cb409-1" aria-hidden="true" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb409-2"><a href="categorization-models.html#cb409-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-3"><a href="categorization-models.html#cb409-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, c, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb409-4"><a href="categorization-models.html#cb409-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb409-5"><a href="categorization-models.html#cb409-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="categorization-models.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, logit_c, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb410-2"><a href="categorization-models.html#cb410-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb410-3"><a href="categorization-models.html#cb410-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="categorization-models.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb411-2"><a href="categorization-models.html#cb411-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb411-3"><a href="categorization-models.html#cb411-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="categorization-models.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb412-2"><a href="categorization-models.html#cb412-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb412-3"><a href="categorization-models.html#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-4.png" width="672" /></p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="categorization-models.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb413-2"><a href="categorization-models.html#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb413-3"><a href="categorization-models.html#cb413-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb413-4"><a href="categorization-models.html#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d<span class="sc">$</span>c[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb413-5"><a href="categorization-models.html#cb413-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-5.png" width="672" /></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="categorization-models.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb415-2"><a href="categorization-models.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb415-3"><a href="categorization-models.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb415-4"><a href="categorization-models.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb415-5"><a href="categorization-models.html#cb415-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-6.png" width="672" /></p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="categorization-models.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb417-2"><a href="categorization-models.html#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb417-3"><a href="categorization-models.html#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb417-4"><a href="categorization-models.html#cb417-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb417-5"><a href="categorization-models.html#cb417-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-36-7.png" width="672" /></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="categorization-models.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb419-2"><a href="categorization-models.html#cb419-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(c, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb419-3"><a href="categorization-models.html#cb419-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-8.png" width="672" /></p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="categorization-models.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb420-2"><a href="categorization-models.html#cb420-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(c, <span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb420-3"><a href="categorization-models.html#cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-9.png" width="672" /></p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="categorization-models.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb421-2"><a href="categorization-models.html#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>, <span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-3"><a href="categorization-models.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-36-10.png" width="672" /></p>
<p>C looks like crap, while weights seem decently recovered. Let’s look at the larger picture, but looping through the different combinations of parameter values.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="categorization-models.html#cb422-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(future, purrr, furrr)</span>
<span id="cb422-2"><a href="categorization-models.html#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb422-3"><a href="categorization-models.html#cb422-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-4"><a href="categorization-models.html#cb422-4" aria-hidden="true" tabindex="-1"></a>sim_d_and_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, scaling, weights) {</span>
<span id="cb422-5"><a href="categorization-models.html#cb422-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb422-6"><a href="categorization-models.html#cb422-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb422-7"><a href="categorization-models.html#cb422-7" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb422-8"><a href="categorization-models.html#cb422-8" aria-hidden="true" tabindex="-1"></a>      c <span class="sc">==</span> scaling <span class="sc">&amp;</span> w <span class="sc">==</span> weights <span class="sc">&amp;</span> agent <span class="sc">==</span> agent</span>
<span id="cb422-9"><a href="categorization-models.html#cb422-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb422-10"><a href="categorization-models.html#cb422-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb422-11"><a href="categorization-models.html#cb422-11" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb422-12"><a href="categorization-models.html#cb422-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ntrials =</span> <span class="fu">nrow</span>(temp),</span>
<span id="cb422-13"><a href="categorization-models.html#cb422-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb422-14"><a href="categorization-models.html#cb422-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">cat_one =</span> temp<span class="sc">$</span>category,</span>
<span id="cb422-15"><a href="categorization-models.html#cb422-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> temp<span class="sc">$</span>sim_response,</span>
<span id="cb422-16"><a href="categorization-models.html#cb422-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> <span class="fu">as.matrix</span>(temp[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb422-17"><a href="categorization-models.html#cb422-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb422-18"><a href="categorization-models.html#cb422-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb422-19"><a href="categorization-models.html#cb422-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb422-20"><a href="categorization-models.html#cb422-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb422-21"><a href="categorization-models.html#cb422-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb422-22"><a href="categorization-models.html#cb422-22" aria-hidden="true" tabindex="-1"></a>    samples_gcm <span class="ot">&lt;-</span> mod_GCM<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb422-23"><a href="categorization-models.html#cb422-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb422-24"><a href="categorization-models.html#cb422-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb422-25"><a href="categorization-models.html#cb422-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb422-26"><a href="categorization-models.html#cb422-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb422-27"><a href="categorization-models.html#cb422-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">threads_per_chain =</span> <span class="dv">4</span>,</span>
<span id="cb422-28"><a href="categorization-models.html#cb422-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb422-29"><a href="categorization-models.html#cb422-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb422-30"><a href="categorization-models.html#cb422-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb422-31"><a href="categorization-models.html#cb422-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb422-32"><a href="categorization-models.html#cb422-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb422-33"><a href="categorization-models.html#cb422-33" aria-hidden="true" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb422-34"><a href="categorization-models.html#cb422-34" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trueC =</span> scaling, <span class="at">trueW =</span> weights, <span class="at">agent =</span> agent,</span>
<span id="cb422-35"><a href="categorization-models.html#cb422-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">estC =</span> draws_df<span class="sc">$</span>c, </span>
<span id="cb422-36"><a href="categorization-models.html#cb422-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">estW1 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>,</span>
<span id="cb422-37"><a href="categorization-models.html#cb422-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">estW2 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[2]</span><span class="st">`</span></span>
<span id="cb422-38"><a href="categorization-models.html#cb422-38" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb422-39"><a href="categorization-models.html#cb422-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb422-40"><a href="categorization-models.html#cb422-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(temp)</span>
<span id="cb422-41"><a href="categorization-models.html#cb422-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb422-42"><a href="categorization-models.html#cb422-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb422-43"><a href="categorization-models.html#cb422-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-44"><a href="categorization-models.html#cb422-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-45"><a href="categorization-models.html#cb422-45" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">unique</span>(simulated_responses[,<span class="fu">c</span>(<span class="st">&quot;agent&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;w&quot;</span>)])) <span class="sc">%&gt;%</span></span>
<span id="cb422-46"><a href="categorization-models.html#cb422-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb422-47"><a href="categorization-models.html#cb422-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> c,</span>
<span id="cb422-48"><a href="categorization-models.html#cb422-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> w</span>
<span id="cb422-49"><a href="categorization-models.html#cb422-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb422-50"><a href="categorization-models.html#cb422-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-51"><a href="categorization-models.html#cb422-51" aria-hidden="true" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(temp, sim_d_and_fit, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb422-52"><a href="categorization-models.html#cb422-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-53"><a href="categorization-models.html#cb422-53" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(recovery_df, <span class="st">&quot;simdata/W10_GCM_recoverydf.csv&quot;</span>)</span></code></pre></div>
<p>Time to visualize</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="categorization-models.html#cb423-1" aria-hidden="true" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;simdata/W10_GCM_recoverydf.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 300000 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): trueW
## dbl (5): trueC, agent, estC, estW1, estW2
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="categorization-models.html#cb425-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb425-2"><a href="categorization-models.html#cb425-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estC, <span class="at">group =</span> trueW, <span class="at">fill =</span> trueW), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb425-3"><a href="categorization-models.html#cb425-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = trueC) +</span></span>
<span id="cb425-4"><a href="categorization-models.html#cb425-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> trueC) <span class="sc">+</span></span>
<span id="cb425-5"><a href="categorization-models.html#cb425-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb425-6"><a href="categorization-models.html#cb425-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-7"><a href="categorization-models.html#cb425-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb425-8"><a href="categorization-models.html#cb425-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estW1, <span class="at">group =</span> trueW, <span class="at">fill =</span> trueW), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb425-9"><a href="categorization-models.html#cb425-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = trueC) +</span></span>
<span id="cb425-10"><a href="categorization-models.html#cb425-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(trueC <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb425-11"><a href="categorization-models.html#cb425-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb425-12"><a href="categorization-models.html#cb425-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-13"><a href="categorization-models.html#cb425-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div id="multilevel-gcm" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Multilevel GCM<a href="categorization-models.html#multilevel-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>[MISSING: quick reminder of what it means to make GCM multilevel: weights and can vary by participants, but they do not do so in correlated ways]</p>
<div id="simulate-hierarchical-simplices" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Simulate hierarchical simplices<a href="categorization-models.html#simulate-hierarchical-simplices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need weights that sum up to 1 at the population level and at the individual level. Let’s simulate the dirichlet distribution to see how it does it.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="categorization-models.html#cb426-1" aria-hidden="true" tabindex="-1"></a>simulate_dirichlet <span class="ot">&lt;-</span> <span class="cf">function</span>(weights, kappa, agents){</span>
<span id="cb426-2"><a href="categorization-models.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb426-3"><a href="categorization-models.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  w_n <span class="ot">&lt;-</span> <span class="fu">length</span>(weights)</span>
<span id="cb426-4"><a href="categorization-models.html#cb426-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb426-5"><a href="categorization-models.html#cb426-5" aria-hidden="true" tabindex="-1"></a>  w_ind <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(agents, weights <span class="sc">*</span> kappa)</span>
<span id="cb426-6"><a href="categorization-models.html#cb426-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb426-7"><a href="categorization-models.html#cb426-7" aria-hidden="true" tabindex="-1"></a>  w_ind_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb426-8"><a href="categorization-models.html#cb426-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">agent =</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(agents), <span class="at">each =</span> w_n)),</span>
<span id="cb426-9"><a href="categorization-models.html#cb426-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(w_ind),</span>
<span id="cb426-10"><a href="categorization-models.html#cb426-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(w_n), agents)</span>
<span id="cb426-11"><a href="categorization-models.html#cb426-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb426-12"><a href="categorization-models.html#cb426-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb426-13"><a href="categorization-models.html#cb426-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(w_ind_df)</span>
<span id="cb426-14"><a href="categorization-models.html#cb426-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb426-15"><a href="categorization-models.html#cb426-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-16"><a href="categorization-models.html#cb426-16" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_dirichlet</span>(<span class="at">weights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">kappa =</span> <span class="dv">100</span>, <span class="at">agents =</span> <span class="dv">10</span>)</span>
<span id="cb426-17"><a href="categorization-models.html#cb426-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-18"><a href="categorization-models.html#cb426-18" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(weight, value, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb426-19"><a href="categorization-models.html#cb426-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb426-20"><a href="categorization-models.html#cb426-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb426-21"><a href="categorization-models.html#cb426-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb426-22"><a href="categorization-models.html#cb426-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb426-23"><a href="categorization-models.html#cb426-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-24"><a href="categorization-models.html#cb426-24" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_dirichlet</span>(<span class="at">weights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">kappa =</span> <span class="dv">1</span>, <span class="at">agents =</span> <span class="dv">10</span>)</span>
<span id="cb426-25"><a href="categorization-models.html#cb426-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-26"><a href="categorization-models.html#cb426-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(weight, value, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb426-27"><a href="categorization-models.html#cb426-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb426-28"><a href="categorization-models.html#cb426-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb426-29"><a href="categorization-models.html#cb426-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb426-30"><a href="categorization-models.html#cb426-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb426-31"><a href="categorization-models.html#cb426-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-32"><a href="categorization-models.html#cb426-32" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="set-up-the-data-simulation" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Set up the data simulation<a href="categorization-models.html#set-up-the-data-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need to feed:
- agents
- scaling (M and SD)
- weights (weights and concentration)</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="categorization-models.html#cb427-1" aria-hidden="true" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb427-2"><a href="categorization-models.html#cb427-2" aria-hidden="true" tabindex="-1"></a>scalingM <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb427-3"><a href="categorization-models.html#cb427-3" aria-hidden="true" tabindex="-1"></a>scalingSD <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb427-4"><a href="categorization-models.html#cb427-4" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb427-5"><a href="categorization-models.html#cb427-5" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb427-6"><a href="categorization-models.html#cb427-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-7"><a href="categorization-models.html#cb427-7" aria-hidden="true" tabindex="-1"></a><span class="co"># First one agent, just to make sure it works</span></span>
<span id="cb427-8"><a href="categorization-models.html#cb427-8" aria-hidden="true" tabindex="-1"></a>simulate_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, weights, c) {</span>
<span id="cb427-9"><a href="categorization-models.html#cb427-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb427-10"><a href="categorization-models.html#cb427-10" aria-hidden="true" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb427-11"><a href="categorization-models.html#cb427-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))</span>
<span id="cb427-12"><a href="categorization-models.html#cb427-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb427-13"><a href="categorization-models.html#cb427-13" aria-hidden="true" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category</span>
<span id="cb427-14"><a href="categorization-models.html#cb427-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb427-15"><a href="categorization-models.html#cb427-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate responses</span></span>
<span id="cb427-16"><a href="categorization-models.html#cb427-16" aria-hidden="true" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">gcm</span>(</span>
<span id="cb427-17"><a href="categorization-models.html#cb427-17" aria-hidden="true" tabindex="-1"></a>        weights,</span>
<span id="cb427-18"><a href="categorization-models.html#cb427-18" aria-hidden="true" tabindex="-1"></a>        c,</span>
<span id="cb427-19"><a href="categorization-models.html#cb427-19" aria-hidden="true" tabindex="-1"></a>        observations,</span>
<span id="cb427-20"><a href="categorization-models.html#cb427-20" aria-hidden="true" tabindex="-1"></a>        category</span>
<span id="cb427-21"><a href="categorization-models.html#cb427-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb427-22"><a href="categorization-models.html#cb427-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb427-23"><a href="categorization-models.html#cb427-23" aria-hidden="true" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb427-24"><a href="categorization-models.html#cb427-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb427-25"><a href="categorization-models.html#cb427-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">trial =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment)),</span>
<span id="cb427-26"><a href="categorization-models.html#cb427-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb427-27"><a href="categorization-models.html#cb427-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb427-28"><a href="categorization-models.html#cb427-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> <span class="fu">seq_along</span>(correct),</span>
<span id="cb427-29"><a href="categorization-models.html#cb427-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">c =</span> c,</span>
<span id="cb427-30"><a href="categorization-models.html#cb427-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">w1 =</span> weights[<span class="dv">1</span>],</span>
<span id="cb427-31"><a href="categorization-models.html#cb427-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">w2 =</span> weights[<span class="dv">2</span>],</span>
<span id="cb427-32"><a href="categorization-models.html#cb427-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb427-33"><a href="categorization-models.html#cb427-33" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb427-34"><a href="categorization-models.html#cb427-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-35"><a href="categorization-models.html#cb427-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb427-36"><a href="categorization-models.html#cb427-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb427-37"><a href="categorization-models.html#cb427-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-38"><a href="categorization-models.html#cb427-38" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_responses</span>(agents, weights, scalingM)</span>
<span id="cb427-39"><a href="categorization-models.html#cb427-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-40"><a href="categorization-models.html#cb427-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Then we make sure to simulate n agents</span></span>
<span id="cb427-41"><a href="categorization-models.html#cb427-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-42"><a href="categorization-models.html#cb427-42" aria-hidden="true" tabindex="-1"></a>simulate_ml_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agents, scalingM, scalingSD, weights, kappa) {</span>
<span id="cb427-43"><a href="categorization-models.html#cb427-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb427-44"><a href="categorization-models.html#cb427-44" aria-hidden="true" tabindex="-1"></a>  w_ind <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(agents, weights <span class="sc">*</span> kappa)</span>
<span id="cb427-45"><a href="categorization-models.html#cb427-45" aria-hidden="true" tabindex="-1"></a>  c_ind <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(agents, scalingM, scalingSD)</span>
<span id="cb427-46"><a href="categorization-models.html#cb427-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb427-47"><a href="categorization-models.html#cb427-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb427-48"><a href="categorization-models.html#cb427-48" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">simulate_responses</span>(i, <span class="at">weights =</span> <span class="fu">c</span>(w_ind[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="at">c =</span> c_ind[i])</span>
<span id="cb427-49"><a href="categorization-models.html#cb427-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb427-50"><a href="categorization-models.html#cb427-50" aria-hidden="true" tabindex="-1"></a>      simulated_responses <span class="ot">&lt;-</span> tmp</span>
<span id="cb427-51"><a href="categorization-models.html#cb427-51" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb427-52"><a href="categorization-models.html#cb427-52" aria-hidden="true" tabindex="-1"></a>      simulated_responses <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simulated_responses, tmp)</span>
<span id="cb427-53"><a href="categorization-models.html#cb427-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb427-54"><a href="categorization-models.html#cb427-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb427-55"><a href="categorization-models.html#cb427-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb427-56"><a href="categorization-models.html#cb427-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(simulated_responses)</span>
<span id="cb427-57"><a href="categorization-models.html#cb427-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb427-58"><a href="categorization-models.html#cb427-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-59"><a href="categorization-models.html#cb427-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate and visualize</span></span>
<span id="cb427-60"><a href="categorization-models.html#cb427-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-61"><a href="categorization-models.html#cb427-61" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_ml_responses</span>(agents, scalingM, scalingSD, weights, kappa)</span>
<span id="cb427-62"><a href="categorization-models.html#cb427-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-63"><a href="categorization-models.html#cb427-63" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, performance)) <span class="sc">+</span></span>
<span id="cb427-64"><a href="categorization-models.html#cb427-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb427-65"><a href="categorization-models.html#cb427-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb427-66"><a href="categorization-models.html#cb427-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="set-up-the-stan-model" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Set up the Stan model<a href="categorization-models.html#set-up-the-stan-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="categorization-models.html#cb429-1" aria-hidden="true" tabindex="-1"></a>gcm_ml_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb429-2"><a href="categorization-models.html#cb429-2" aria-hidden="true" tabindex="-1"></a><span class="st">// Generalized Context Model (GCM) - multilevel version</span></span>
<span id="cb429-3"><a href="categorization-models.html#cb429-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-4"><a href="categorization-models.html#cb429-4" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb429-5"><a href="categorization-models.html#cb429-5" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nsubjects;  // number of subjects</span></span>
<span id="cb429-6"><a href="categorization-models.html#cb429-6" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; ntrials;  // number of trials</span></span>
<span id="cb429-7"><a href="categorization-models.html#cb429-7" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nfeatures;  // number of predefined relevant features</span></span>
<span id="cb429-8"><a href="categorization-models.html#cb429-8" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_one; // true responses on a trial by trial basis</span></span>
<span id="cb429-9"><a href="categorization-models.html#cb429-9" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] int&lt;lower=0, upper=1&gt; y;  // decisions on a trial by trial basis</span></span>
<span id="cb429-10"><a href="categorization-models.html#cb429-10" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials, nfeatures] real obs; // stimuli as vectors of features assuming all participants get the same sequence</span></span>
<span id="cb429-11"><a href="categorization-models.html#cb429-11" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; b;  // initial bias for category one over two</span></span>
<span id="cb429-12"><a href="categorization-models.html#cb429-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-13"><a href="categorization-models.html#cb429-13" aria-hidden="true" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb429-14"><a href="categorization-models.html#cb429-14" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[nfeatures] w_prior_values;  // concentration parameters for dirichlet distribution &lt;lower=1&gt;</span></span>
<span id="cb429-15"><a href="categorization-models.html#cb429-15" aria-hidden="true" tabindex="-1"></a><span class="st">    array[2] real c_prior_values;  // mean and variance for logit-normal distribution</span></span>
<span id="cb429-16"><a href="categorization-models.html#cb429-16" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb429-17"><a href="categorization-models.html#cb429-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-18"><a href="categorization-models.html#cb429-18" aria-hidden="true" tabindex="-1"></a><span class="st">transformed data { // assuming all participants get the same sequence</span></span>
<span id="cb429-19"><a href="categorization-models.html#cb429-19" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb429-20"><a href="categorization-models.html#cb429-20" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_two; // dummy variable for category two over cat 1</span></span>
<span id="cb429-21"><a href="categorization-models.html#cb429-21" aria-hidden="true" tabindex="-1"></a><span class="st">    array[sum(cat_one)] int&lt;lower=1, upper = ntrials&gt; cat_one_idx; // array of which stimuli are cat 1</span></span>
<span id="cb429-22"><a href="categorization-models.html#cb429-22" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials - sum(cat_one)] int&lt;lower = 1, upper = ntrials&gt; cat_two_idx; //  array of which stimuli are cat 2</span></span>
<span id="cb429-23"><a href="categorization-models.html#cb429-23" aria-hidden="true" tabindex="-1"></a><span class="st">    int idx_one = 1; // Initializing </span></span>
<span id="cb429-24"><a href="categorization-models.html#cb429-24" aria-hidden="true" tabindex="-1"></a><span class="st">    int idx_two = 1;</span></span>
<span id="cb429-25"><a href="categorization-models.html#cb429-25" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:ntrials){</span></span>
<span id="cb429-26"><a href="categorization-models.html#cb429-26" aria-hidden="true" tabindex="-1"></a><span class="st">        cat_two[i] = abs(cat_one[i]-1);</span></span>
<span id="cb429-27"><a href="categorization-models.html#cb429-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-28"><a href="categorization-models.html#cb429-28" aria-hidden="true" tabindex="-1"></a><span class="st">        if (cat_one[i]==1){</span></span>
<span id="cb429-29"><a href="categorization-models.html#cb429-29" aria-hidden="true" tabindex="-1"></a><span class="st">            cat_one_idx[idx_one] = i;</span></span>
<span id="cb429-30"><a href="categorization-models.html#cb429-30" aria-hidden="true" tabindex="-1"></a><span class="st">            idx_one +=1;</span></span>
<span id="cb429-31"><a href="categorization-models.html#cb429-31" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb429-32"><a href="categorization-models.html#cb429-32" aria-hidden="true" tabindex="-1"></a><span class="st">            cat_two_idx[idx_two] = i;</span></span>
<span id="cb429-33"><a href="categorization-models.html#cb429-33" aria-hidden="true" tabindex="-1"></a><span class="st">            idx_two += 1;</span></span>
<span id="cb429-34"><a href="categorization-models.html#cb429-34" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb429-35"><a href="categorization-models.html#cb429-35" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb429-36"><a href="categorization-models.html#cb429-36" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb429-37"><a href="categorization-models.html#cb429-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-38"><a href="categorization-models.html#cb429-38" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb429-39"><a href="categorization-models.html#cb429-39" aria-hidden="true" tabindex="-1"></a><span class="st">    real logit_c_M;    // Pop Mean of the scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb429-40"><a href="categorization-models.html#cb429-40" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower = 0&gt; logit_c_SD;    // Pop SD of the scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb429-41"><a href="categorization-models.html#cb429-41" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[nsubjects] logit_c;    // scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb429-42"><a href="categorization-models.html#cb429-42" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb429-43"><a href="categorization-models.html#cb429-43" aria-hidden="true" tabindex="-1"></a><span class="st">    simplex[nfeatures] weight;  // simplex means sum(w)=1</span></span>
<span id="cb429-44"><a href="categorization-models.html#cb429-44" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; kappa;</span></span>
<span id="cb429-45"><a href="categorization-models.html#cb429-45" aria-hidden="true" tabindex="-1"></a><span class="st">    array[nsubjects] simplex[nfeatures] w_ind;    // weight parameter (how much attention should be paid to feature 1 related to feature 2 - summing up to 1)</span></span>
<span id="cb429-46"><a href="categorization-models.html#cb429-46" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb429-47"><a href="categorization-models.html#cb429-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-48"><a href="categorization-models.html#cb429-48" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb429-49"><a href="categorization-models.html#cb429-49" aria-hidden="true" tabindex="-1"></a><span class="st">    // parameter w</span></span>
<span id="cb429-50"><a href="categorization-models.html#cb429-50" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[nfeatures] alpha = kappa * weight;</span></span>
<span id="cb429-51"><a href="categorization-models.html#cb429-51" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb429-52"><a href="categorization-models.html#cb429-52" aria-hidden="true" tabindex="-1"></a><span class="st">    // parameter c </span></span>
<span id="cb429-53"><a href="categorization-models.html#cb429-53" aria-hidden="true" tabindex="-1"></a><span class="st">    vector&lt;lower=0,upper=2&gt;[nsubjects] c = inv_logit(logit_c)*2;  // times 2 as c is bounded between 0 and 2</span></span>
<span id="cb429-54"><a href="categorization-models.html#cb429-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-55"><a href="categorization-models.html#cb429-55" aria-hidden="true" tabindex="-1"></a><span class="st">    // parameter r (probability of response = category 1)</span></span>
<span id="cb429-56"><a href="categorization-models.html#cb429-56" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] real&lt;lower=0.0001, upper=0.9999&gt; r;</span></span>
<span id="cb429-57"><a href="categorization-models.html#cb429-57" aria-hidden="true" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] real rr;</span></span>
<span id="cb429-58"><a href="categorization-models.html#cb429-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-59"><a href="categorization-models.html#cb429-59" aria-hidden="true" tabindex="-1"></a><span class="st">    for (sub in 1:nsubjects) {</span></span>
<span id="cb429-60"><a href="categorization-models.html#cb429-60" aria-hidden="true" tabindex="-1"></a><span class="st">      for (trial in 1:ntrials) {</span></span>
<span id="cb429-61"><a href="categorization-models.html#cb429-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-62"><a href="categorization-models.html#cb429-62" aria-hidden="true" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb429-63"><a href="categorization-models.html#cb429-63" aria-hidden="true" tabindex="-1"></a><span class="st">        array[(trial-1)] real exemplar_sim;</span></span>
<span id="cb429-64"><a href="categorization-models.html#cb429-64" aria-hidden="true" tabindex="-1"></a><span class="st">        for (e in 1:(trial-1)){</span></span>
<span id="cb429-65"><a href="categorization-models.html#cb429-65" aria-hidden="true" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb429-66"><a href="categorization-models.html#cb429-66" aria-hidden="true" tabindex="-1"></a><span class="st">            for (feature in 1:nfeatures) {</span></span>
<span id="cb429-67"><a href="categorization-models.html#cb429-67" aria-hidden="true" tabindex="-1"></a><span class="st">                tmp_dist[feature] = w_ind[sub,feature]*abs(obs[e,feature] - obs[trial,feature]);</span></span>
<span id="cb429-68"><a href="categorization-models.html#cb429-68" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb429-69"><a href="categorization-models.html#cb429-69" aria-hidden="true" tabindex="-1"></a><span class="st">            exemplar_sim[e] = exp(-c[sub] * sum(tmp_dist));</span></span>
<span id="cb429-70"><a href="categorization-models.html#cb429-70" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb429-71"><a href="categorization-models.html#cb429-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-72"><a href="categorization-models.html#cb429-72" aria-hidden="true" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(trial-1)])==0 || sum(cat_two[:(trial-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb429-73"><a href="categorization-models.html#cb429-73" aria-hidden="true" tabindex="-1"></a><span class="st">            r[trial,sub] = 0.5;</span></span>
<span id="cb429-74"><a href="categorization-models.html#cb429-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-75"><a href="categorization-models.html#cb429-75" aria-hidden="true" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb429-76"><a href="categorization-models.html#cb429-76" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb429-77"><a href="categorization-models.html#cb429-77" aria-hidden="true" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb429-78"><a href="categorization-models.html#cb429-78" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb429-79"><a href="categorization-models.html#cb429-79" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(trial-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(trial-1)])];</span></span>
<span id="cb429-80"><a href="categorization-models.html#cb429-80" aria-hidden="true" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(trial-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(trial-1)])];</span></span>
<span id="cb429-81"><a href="categorization-models.html#cb429-81" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[1] = sum(exemplar_sim[tmp_idx_one]);</span></span>
<span id="cb429-82"><a href="categorization-models.html#cb429-82" aria-hidden="true" tabindex="-1"></a><span class="st">            similarities[2] = sum(exemplar_sim[tmp_idx_two]);</span></span>
<span id="cb429-83"><a href="categorization-models.html#cb429-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-84"><a href="categorization-models.html#cb429-84" aria-hidden="true" tabindex="-1"></a><span class="st">            // calculate r</span></span>
<span id="cb429-85"><a href="categorization-models.html#cb429-85" aria-hidden="true" tabindex="-1"></a><span class="st">            rr[trial,sub] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb429-86"><a href="categorization-models.html#cb429-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-87"><a href="categorization-models.html#cb429-87" aria-hidden="true" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb429-88"><a href="categorization-models.html#cb429-88" aria-hidden="true" tabindex="-1"></a><span class="st">            if (rr[trial,sub] &gt; 0.9999){</span></span>
<span id="cb429-89"><a href="categorization-models.html#cb429-89" aria-hidden="true" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.9999;</span></span>
<span id="cb429-90"><a href="categorization-models.html#cb429-90" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr[trial,sub] &lt; 0.0001) {</span></span>
<span id="cb429-91"><a href="categorization-models.html#cb429-91" aria-hidden="true" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.0001;</span></span>
<span id="cb429-92"><a href="categorization-models.html#cb429-92" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (rr[trial,sub] &gt; 0.0001 &amp;&amp; rr[trial,sub] &lt; 0.9999) {</span></span>
<span id="cb429-93"><a href="categorization-models.html#cb429-93" aria-hidden="true" tabindex="-1"></a><span class="st">                r[trial,sub] = rr[trial,sub];</span></span>
<span id="cb429-94"><a href="categorization-models.html#cb429-94" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb429-95"><a href="categorization-models.html#cb429-95" aria-hidden="true" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.5;</span></span>
<span id="cb429-96"><a href="categorization-models.html#cb429-96" aria-hidden="true" tabindex="-1"></a><span class="st">            }}}}}</span></span>
<span id="cb429-97"><a href="categorization-models.html#cb429-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-98"><a href="categorization-models.html#cb429-98" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb429-99"><a href="categorization-models.html#cb429-99" aria-hidden="true" tabindex="-1"></a><span class="st">    // Priors</span></span>
<span id="cb429-100"><a href="categorization-models.html#cb429-100" aria-hidden="true" tabindex="-1"></a><span class="st">    target += exponential_lpdf(kappa | 0.1);</span></span>
<span id="cb429-101"><a href="categorization-models.html#cb429-101" aria-hidden="true" tabindex="-1"></a><span class="st">    target += dirichlet_lpdf(weight | w_prior_values);</span></span>
<span id="cb429-102"><a href="categorization-models.html#cb429-102" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb429-103"><a href="categorization-models.html#cb429-103" aria-hidden="true" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c_M | c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb429-104"><a href="categorization-models.html#cb429-104" aria-hidden="true" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c_SD | 0, 1) - normal_lccdf(0 | 0, 1);</span></span>
<span id="cb429-105"><a href="categorization-models.html#cb429-105" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb429-106"><a href="categorization-models.html#cb429-106" aria-hidden="true" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c | logit_c_M, logit_c_SD);</span></span>
<span id="cb429-107"><a href="categorization-models.html#cb429-107" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb429-108"><a href="categorization-models.html#cb429-108" aria-hidden="true" tabindex="-1"></a><span class="st">    // Decision Data</span></span>
<span id="cb429-109"><a href="categorization-models.html#cb429-109" aria-hidden="true" tabindex="-1"></a><span class="st">    for (sub in 1:nsubjects){</span></span>
<span id="cb429-110"><a href="categorization-models.html#cb429-110" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb429-111"><a href="categorization-models.html#cb429-111" aria-hidden="true" tabindex="-1"></a><span class="st">      target += dirichlet_lpdf(w_ind[sub] | alpha);</span></span>
<span id="cb429-112"><a href="categorization-models.html#cb429-112" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb429-113"><a href="categorization-models.html#cb429-113" aria-hidden="true" tabindex="-1"></a><span class="st">      for (trial in 1:ntrials){</span></span>
<span id="cb429-114"><a href="categorization-models.html#cb429-114" aria-hidden="true" tabindex="-1"></a><span class="st">        target += bernoulli_lpmf(y[trial,sub] | r[trial,sub]);</span></span>
<span id="cb429-115"><a href="categorization-models.html#cb429-115" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb429-116"><a href="categorization-models.html#cb429-116" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb429-117"><a href="categorization-models.html#cb429-117" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb429-118"><a href="categorization-models.html#cb429-118" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb429-119"><a href="categorization-models.html#cb429-119" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb429-120"><a href="categorization-models.html#cb429-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-121"><a href="categorization-models.html#cb429-121" aria-hidden="true" tabindex="-1"></a><span class="st">// generated quantities {</span></span>
<span id="cb429-122"><a href="categorization-models.html#cb429-122" aria-hidden="true" tabindex="-1"></a><span class="st">//     // priors</span></span>
<span id="cb429-123"><a href="categorization-models.html#cb429-123" aria-hidden="true" tabindex="-1"></a><span class="st">//     simplex[nfeatures] w_prior = dirichlet_rng(w_prior_values);</span></span>
<span id="cb429-124"><a href="categorization-models.html#cb429-124" aria-hidden="true" tabindex="-1"></a><span class="st">//     real logit_c_prior = normal_rng(c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb429-125"><a href="categorization-models.html#cb429-125" aria-hidden="true" tabindex="-1"></a><span class="st">//     real&lt;lower=0, upper=2&gt; c_prior = inv_logit(logit_c_prior)*2;</span></span>
<span id="cb429-126"><a href="categorization-models.html#cb429-126" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-127"><a href="categorization-models.html#cb429-127" aria-hidden="true" tabindex="-1"></a><span class="st">//     // prior pred</span></span>
<span id="cb429-128"><a href="categorization-models.html#cb429-128" aria-hidden="true" tabindex="-1"></a><span class="st">//     array[ntrials] real&lt;lower=0, upper=1&gt; r_prior;</span></span>
<span id="cb429-129"><a href="categorization-models.html#cb429-129" aria-hidden="true" tabindex="-1"></a><span class="st">//     array[ntrials] real rr_prior;</span></span>
<span id="cb429-130"><a href="categorization-models.html#cb429-130" aria-hidden="true" tabindex="-1"></a><span class="st">//     for (i in 1:ntrials) {</span></span>
<span id="cb429-131"><a href="categorization-models.html#cb429-131" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-132"><a href="categorization-models.html#cb429-132" aria-hidden="true" tabindex="-1"></a><span class="st">//         // calculate distance from obs to all exemplars</span></span>
<span id="cb429-133"><a href="categorization-models.html#cb429-133" aria-hidden="true" tabindex="-1"></a><span class="st">//         array[(i-1)] real exemplar_dist;</span></span>
<span id="cb429-134"><a href="categorization-models.html#cb429-134" aria-hidden="true" tabindex="-1"></a><span class="st">//         for (e in 1:(i-1)){</span></span>
<span id="cb429-135"><a href="categorization-models.html#cb429-135" aria-hidden="true" tabindex="-1"></a><span class="st">//             array[nfeatures] real tmp_dist;</span></span>
<span id="cb429-136"><a href="categorization-models.html#cb429-136" aria-hidden="true" tabindex="-1"></a><span class="st">//             for (j in 1:nfeatures) {</span></span>
<span id="cb429-137"><a href="categorization-models.html#cb429-137" aria-hidden="true" tabindex="-1"></a><span class="st">//                 tmp_dist[j] = w_prior[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb429-138"><a href="categorization-models.html#cb429-138" aria-hidden="true" tabindex="-1"></a><span class="st">//             }</span></span>
<span id="cb429-139"><a href="categorization-models.html#cb429-139" aria-hidden="true" tabindex="-1"></a><span class="st">//             exemplar_dist[e] = sum(tmp_dist);</span></span>
<span id="cb429-140"><a href="categorization-models.html#cb429-140" aria-hidden="true" tabindex="-1"></a><span class="st">//         }</span></span>
<span id="cb429-141"><a href="categorization-models.html#cb429-141" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-142"><a href="categorization-models.html#cb429-142" aria-hidden="true" tabindex="-1"></a><span class="st">//         if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb429-143"><a href="categorization-models.html#cb429-143" aria-hidden="true" tabindex="-1"></a><span class="st">//             r_prior[i] = 0.5;</span></span>
<span id="cb429-144"><a href="categorization-models.html#cb429-144" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-145"><a href="categorization-models.html#cb429-145" aria-hidden="true" tabindex="-1"></a><span class="st">//         } else {</span></span>
<span id="cb429-146"><a href="categorization-models.html#cb429-146" aria-hidden="true" tabindex="-1"></a><span class="st">//             // calculate similarity</span></span>
<span id="cb429-147"><a href="categorization-models.html#cb429-147" aria-hidden="true" tabindex="-1"></a><span class="st">//             array[2] real similarities;</span></span>
<span id="cb429-148"><a href="categorization-models.html#cb429-148" aria-hidden="true" tabindex="-1"></a><span class="st">//             </span></span>
<span id="cb429-149"><a href="categorization-models.html#cb429-149" aria-hidden="true" tabindex="-1"></a><span class="st">//             array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb429-150"><a href="categorization-models.html#cb429-150" aria-hidden="true" tabindex="-1"></a><span class="st">//             array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb429-151"><a href="categorization-models.html#cb429-151" aria-hidden="true" tabindex="-1"></a><span class="st">//             similarities[1] = exp(-c_prior * sum(exemplar_dist[tmp_idx_one]));</span></span>
<span id="cb429-152"><a href="categorization-models.html#cb429-152" aria-hidden="true" tabindex="-1"></a><span class="st">//             similarities[2] = exp(-c_prior * sum(exemplar_dist[tmp_idx_two]));</span></span>
<span id="cb429-153"><a href="categorization-models.html#cb429-153" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-154"><a href="categorization-models.html#cb429-154" aria-hidden="true" tabindex="-1"></a><span class="st">//             // calculate r[i]</span></span>
<span id="cb429-155"><a href="categorization-models.html#cb429-155" aria-hidden="true" tabindex="-1"></a><span class="st">//             rr_prior[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb429-156"><a href="categorization-models.html#cb429-156" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-157"><a href="categorization-models.html#cb429-157" aria-hidden="true" tabindex="-1"></a><span class="st">//             // to make the sampling work</span></span>
<span id="cb429-158"><a href="categorization-models.html#cb429-158" aria-hidden="true" tabindex="-1"></a><span class="st">//             if (rr_prior[i] == 1){</span></span>
<span id="cb429-159"><a href="categorization-models.html#cb429-159" aria-hidden="true" tabindex="-1"></a><span class="st">//                 r_prior[i] = 0.9999;</span></span>
<span id="cb429-160"><a href="categorization-models.html#cb429-160" aria-hidden="true" tabindex="-1"></a><span class="st">//             } else if (rr_prior[i] == 0) {</span></span>
<span id="cb429-161"><a href="categorization-models.html#cb429-161" aria-hidden="true" tabindex="-1"></a><span class="st">//                 r_prior[i] = 0.0001;</span></span>
<span id="cb429-162"><a href="categorization-models.html#cb429-162" aria-hidden="true" tabindex="-1"></a><span class="st">//             } else if (rr_prior[i] &gt; 0 &amp;&amp; rr_prior[i] &lt; 1) {</span></span>
<span id="cb429-163"><a href="categorization-models.html#cb429-163" aria-hidden="true" tabindex="-1"></a><span class="st">//                 r_prior[i] = rr_prior[i];</span></span>
<span id="cb429-164"><a href="categorization-models.html#cb429-164" aria-hidden="true" tabindex="-1"></a><span class="st">//             } else {</span></span>
<span id="cb429-165"><a href="categorization-models.html#cb429-165" aria-hidden="true" tabindex="-1"></a><span class="st">//                 r_prior[i] = 0.5;</span></span>
<span id="cb429-166"><a href="categorization-models.html#cb429-166" aria-hidden="true" tabindex="-1"></a><span class="st">//             }</span></span>
<span id="cb429-167"><a href="categorization-models.html#cb429-167" aria-hidden="true" tabindex="-1"></a><span class="st">//         }</span></span>
<span id="cb429-168"><a href="categorization-models.html#cb429-168" aria-hidden="true" tabindex="-1"></a><span class="st">//     }</span></span>
<span id="cb429-169"><a href="categorization-models.html#cb429-169" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-170"><a href="categorization-models.html#cb429-170" aria-hidden="true" tabindex="-1"></a><span class="st">//     array[ntrials] int&lt;lower=0, upper=1&gt; priorpred = bernoulli_rng(r_prior);</span></span>
<span id="cb429-171"><a href="categorization-models.html#cb429-171" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-172"><a href="categorization-models.html#cb429-172" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-173"><a href="categorization-models.html#cb429-173" aria-hidden="true" tabindex="-1"></a><span class="st">//     // posterior pred</span></span>
<span id="cb429-174"><a href="categorization-models.html#cb429-174" aria-hidden="true" tabindex="-1"></a><span class="st">//     array[ntrials] int&lt;lower=0, upper=1&gt; posteriorpred = bernoulli_rng(r);</span></span>
<span id="cb429-175"><a href="categorization-models.html#cb429-175" aria-hidden="true" tabindex="-1"></a><span class="st">//     array[ntrials] int&lt;lower=0, upper=1&gt; posteriorcorrect;</span></span>
<span id="cb429-176"><a href="categorization-models.html#cb429-176" aria-hidden="true" tabindex="-1"></a><span class="st">//     for (i in 1:ntrials) {</span></span>
<span id="cb429-177"><a href="categorization-models.html#cb429-177" aria-hidden="true" tabindex="-1"></a><span class="st">//         if (posteriorpred[i] == cat_one[i]) {</span></span>
<span id="cb429-178"><a href="categorization-models.html#cb429-178" aria-hidden="true" tabindex="-1"></a><span class="st">//             posteriorcorrect[i] = 1;</span></span>
<span id="cb429-179"><a href="categorization-models.html#cb429-179" aria-hidden="true" tabindex="-1"></a><span class="st">//         } else {</span></span>
<span id="cb429-180"><a href="categorization-models.html#cb429-180" aria-hidden="true" tabindex="-1"></a><span class="st">//             posteriorcorrect[i] = 0;</span></span>
<span id="cb429-181"><a href="categorization-models.html#cb429-181" aria-hidden="true" tabindex="-1"></a><span class="st">//         }</span></span>
<span id="cb429-182"><a href="categorization-models.html#cb429-182" aria-hidden="true" tabindex="-1"></a><span class="st">//     }</span></span>
<span id="cb429-183"><a href="categorization-models.html#cb429-183" aria-hidden="true" tabindex="-1"></a><span class="st">//     </span></span>
<span id="cb429-184"><a href="categorization-models.html#cb429-184" aria-hidden="true" tabindex="-1"></a><span class="st">//     </span></span>
<span id="cb429-185"><a href="categorization-models.html#cb429-185" aria-hidden="true" tabindex="-1"></a><span class="st">//     // log likelihood</span></span>
<span id="cb429-186"><a href="categorization-models.html#cb429-186" aria-hidden="true" tabindex="-1"></a><span class="st">//    array[ntrials] real log_lik;</span></span>
<span id="cb429-187"><a href="categorization-models.html#cb429-187" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-188"><a href="categorization-models.html#cb429-188" aria-hidden="true" tabindex="-1"></a><span class="st">//    for (i in 1:ntrials) {</span></span>
<span id="cb429-189"><a href="categorization-models.html#cb429-189" aria-hidden="true" tabindex="-1"></a><span class="st">//         log_lik[i] = bernoulli_lpmf(y[i] | r[i]);</span></span>
<span id="cb429-190"><a href="categorization-models.html#cb429-190" aria-hidden="true" tabindex="-1"></a><span class="st">//    }</span></span>
<span id="cb429-191"><a href="categorization-models.html#cb429-191" aria-hidden="true" tabindex="-1"></a><span class="st">// </span></span>
<span id="cb429-192"><a href="categorization-models.html#cb429-192" aria-hidden="true" tabindex="-1"></a><span class="st">// }</span></span>
<span id="cb429-193"><a href="categorization-models.html#cb429-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-194"><a href="categorization-models.html#cb429-194" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb429-195"><a href="categorization-models.html#cb429-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-196"><a href="categorization-models.html#cb429-196" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb429-197"><a href="categorization-models.html#cb429-197" aria-hidden="true" tabindex="-1"></a>  gcm_ml_model,</span>
<span id="cb429-198"><a href="categorization-models.html#cb429-198" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb429-199"><a href="categorization-models.html#cb429-199" aria-hidden="true" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W10_GCM_ml.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W10_GCM_ml.stan&quot;</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="categorization-models.html#cb431-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W10_GCM_ml.stan&quot;</span>)</span>
<span id="cb431-2"><a href="categorization-models.html#cb431-2" aria-hidden="true" tabindex="-1"></a>mod_GCM_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb431-3"><a href="categorization-models.html#cb431-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span></code></pre></div>
<pre><code>## Model executable is up to date!</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="categorization-models.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit the simulated data</span></span>
<span id="cb433-2"><a href="categorization-models.html#cb433-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d[,<span class="fu">c</span>(<span class="st">&quot;agent&quot;</span>,<span class="st">&quot;trial&quot;</span>,<span class="st">&quot;sim_response&quot;</span>)] <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb433-3"><a href="categorization-models.html#cb433-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_from =</span> agent,</span>
<span id="cb433-4"><a href="categorization-models.html#cb433-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_from =</span> <span class="fu">c</span>(sim_response))</span>
<span id="cb433-5"><a href="categorization-models.html#cb433-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-6"><a href="categorization-models.html#cb433-6" aria-hidden="true" tabindex="-1"></a>gcm_ml_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb433-7"><a href="categorization-models.html#cb433-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsubjects =</span> agents,</span>
<span id="cb433-8"><a href="categorization-models.html#cb433-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntrials =</span> <span class="fu">nrow</span>(experiment),</span>
<span id="cb433-9"><a href="categorization-models.html#cb433-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb433-10"><a href="categorization-models.html#cb433-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cat_one =</span> experiment<span class="sc">$</span>category,</span>
<span id="cb433-11"><a href="categorization-models.html#cb433-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">as.matrix</span>(d1[, <span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)]),</span>
<span id="cb433-12"><a href="categorization-models.html#cb433-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb433-13"><a href="categorization-models.html#cb433-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb433-14"><a href="categorization-models.html#cb433-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb433-15"><a href="categorization-models.html#cb433-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb433-16"><a href="categorization-models.html#cb433-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb433-17"><a href="categorization-models.html#cb433-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-18"><a href="categorization-models.html#cb433-18" aria-hidden="true" tabindex="-1"></a>samples_gcm_ml <span class="ot">&lt;-</span> mod_GCM_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb433-19"><a href="categorization-models.html#cb433-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gcm_ml_data,</span>
<span id="cb433-20"><a href="categorization-models.html#cb433-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb433-21"><a href="categorization-models.html#cb433-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb433-22"><a href="categorization-models.html#cb433-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb433-23"><a href="categorization-models.html#cb433-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb433-24"><a href="categorization-models.html#cb433-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb433-25"><a href="categorization-models.html#cb433-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb433-26"><a href="categorization-models.html#cb433-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">1000</span></span>
<span id="cb433-27"><a href="categorization-models.html#cb433-27" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup)</code></pre>
<pre><code>## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>## Chain 1 Exception: dirichlet_lpdf: prior sample sizes[2] is 0, but must be positive! (in &#39;/var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/Rtmp8y3suQ/model-104652778844.stan&#39;, line 111, column 6 to column 51)</code></pre>
<pre><code>## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>## Chain 1</code></pre>
<pre><code>## Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 286.8 seconds.
## Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 2 finished in 433.3 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 360.0 seconds.
## Total execution time: 433.4 seconds.</code></pre>
<pre><code>## Warning: 220 of 2000 (11.0%) transitions ended with a divergence.
## See https://mc-stan.org/misc/warnings for details.</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="categorization-models.html#cb442-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm_ml)</span>
<span id="cb442-2"><a href="categorization-models.html#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="categorization-models.html#cb442-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, logit_c_M, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb442-4"><a href="categorization-models.html#cb442-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb442-5"><a href="categorization-models.html#cb442-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="categorization-models.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, logit_c_SD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb443-2"><a href="categorization-models.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb443-3"><a href="categorization-models.html#cb443-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="categorization-models.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb444-2"><a href="categorization-models.html#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb444-3"><a href="categorization-models.html#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-3.png" width="672" /></p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="categorization-models.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb445-2"><a href="categorization-models.html#cb445-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb445-3"><a href="categorization-models.html#cb445-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-4.png" width="672" /></p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="categorization-models.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">kappa</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb446-2"><a href="categorization-models.html#cb446-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb446-3"><a href="categorization-models.html#cb446-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-5.png" width="672" /></p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="categorization-models.html#cb447-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c_prior =</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(draws), <span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb447-2"><a href="categorization-models.html#cb447-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb447-3"><a href="categorization-models.html#cb447-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(logit_c_M), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb447-4"><a href="categorization-models.html#cb447-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb447-5"><a href="categorization-models.html#cb447-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">logit_scaled</span>(scalingM,<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb447-6"><a href="categorization-models.html#cb447-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-6.png" width="672" /></p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="categorization-models.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(msm)</span>
<span id="cb450-2"><a href="categorization-models.html#cb450-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-3"><a href="categorization-models.html#cb450-3" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c_prior =</span> <span class="fu">rtnorm</span>(<span class="fu">nrow</span>(draws), <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lower =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb450-4"><a href="categorization-models.html#cb450-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb450-5"><a href="categorization-models.html#cb450-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(logit_c_SD), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-6"><a href="categorization-models.html#cb450-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-7"><a href="categorization-models.html#cb450-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb450-8"><a href="categorization-models.html#cb450-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-7.png" width="672" /></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="categorization-models.html#cb452-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rdirichlet</span>(<span class="fu">nrow</span>(draws), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb452-2"><a href="categorization-models.html#cb452-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb452-3"><a href="categorization-models.html#cb452-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb452-4"><a href="categorization-models.html#cb452-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb452-5"><a href="categorization-models.html#cb452-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb452-6"><a href="categorization-models.html#cb452-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-8.png" width="672" /></p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="categorization-models.html#cb454-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">w_prior[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rdirichlet</span>(<span class="fu">nrow</span>(draws), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb454-2"><a href="categorization-models.html#cb454-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb454-3"><a href="categorization-models.html#cb454-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb454-4"><a href="categorization-models.html#cb454-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb454-5"><a href="categorization-models.html#cb454-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb454-6"><a href="categorization-models.html#cb454-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-9.png" width="672" /></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="categorization-models.html#cb456-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">kappa_prior</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rexp</span>(<span class="fu">nrow</span>(draws), <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb456-2"><a href="categorization-models.html#cb456-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb456-3"><a href="categorization-models.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">kappa</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb456-4"><a href="categorization-models.html#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">kappa_prior</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb456-5"><a href="categorization-models.html#cb456-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb456-6"><a href="categorization-models.html#cb456-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-42-10.png" width="672" /></p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="categorization-models.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb458-2"><a href="categorization-models.html#cb458-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>, <span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb458-3"><a href="categorization-models.html#cb458-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-11.png" width="672" /></p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="categorization-models.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb459-2"><a href="categorization-models.html#cb459-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(logit_c_M, logit_c_SD), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb459-3"><a href="categorization-models.html#cb459-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-12.png" width="672" /></p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="categorization-models.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb460-2"><a href="categorization-models.html#cb460-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(kappa, <span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb460-3"><a href="categorization-models.html#cb460-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-13.png" width="672" /></p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="categorization-models.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb461-2"><a href="categorization-models.html#cb461-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(kappa, <span class="st">`</span><span class="at">weight[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb461-3"><a href="categorization-models.html#cb461-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-14.png" width="672" /></p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="categorization-models.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws) <span class="sc">+</span></span>
<span id="cb462-2"><a href="categorization-models.html#cb462-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(kappa, <span class="st">`</span><span class="at">logit_c_M</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb462-3"><a href="categorization-models.html#cb462-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-15.png" width="672" /></p>
</div>
</div>
<div id="now-we-parallelize-n.b.-not-finished" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Now we parallelize [N.B. NOT FINISHED]<a href="categorization-models.html#now-we-parallelize-n.b.-not-finished" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="categorization-models.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Then we create the function that simulates data and fits the model, so we can quickly go through multiple parameter values in the simulation</span></span>
<span id="cb463-2"><a href="categorization-models.html#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb463-3"><a href="categorization-models.html#cb463-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sim_ml_and_fit &lt;- function(agents, scalingM, scalingSD, weights, kappa) {</span></span>
<span id="cb463-4"><a href="categorization-models.html#cb463-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-5"><a href="categorization-models.html#cb463-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   d &lt;- simulate_ml_responses(agents, scalingM, scalingSD, weights, kappa)</span></span>
<span id="cb463-6"><a href="categorization-models.html#cb463-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-7"><a href="categorization-models.html#cb463-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   d1 &lt;- d[,c(&quot;agent&quot;,&quot;trial&quot;,&quot;sim_response&quot;)] %&gt;% pivot_wider(</span></span>
<span id="cb463-8"><a href="categorization-models.html#cb463-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from = agent,</span></span>
<span id="cb463-9"><a href="categorization-models.html#cb463-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = c(sim_response))</span></span>
<span id="cb463-10"><a href="categorization-models.html#cb463-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-11"><a href="categorization-models.html#cb463-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   gcm_ml_data &lt;- list(</span></span>
<span id="cb463-12"><a href="categorization-models.html#cb463-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     nsubjects = agents,</span></span>
<span id="cb463-13"><a href="categorization-models.html#cb463-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     ntrials = nrow(experiment),</span></span>
<span id="cb463-14"><a href="categorization-models.html#cb463-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     nfeatures = 2,</span></span>
<span id="cb463-15"><a href="categorization-models.html#cb463-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     cat_one = experiment$category,</span></span>
<span id="cb463-16"><a href="categorization-models.html#cb463-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = as.matrix(d1[, 2:(agents + 1)]),</span></span>
<span id="cb463-17"><a href="categorization-models.html#cb463-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     obs = as.matrix(experiment[, c(&quot;height&quot;, &quot;position&quot;)]),</span></span>
<span id="cb463-18"><a href="categorization-models.html#cb463-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     b = 0.5,</span></span>
<span id="cb463-19"><a href="categorization-models.html#cb463-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     w_prior_values = c(1, 1),</span></span>
<span id="cb463-20"><a href="categorization-models.html#cb463-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     c_prior_values = c(0, 1)</span></span>
<span id="cb463-21"><a href="categorization-models.html#cb463-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb463-22"><a href="categorization-models.html#cb463-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-23"><a href="categorization-models.html#cb463-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   samples_gcm_ml &lt;- mod_GCM_ml$sample(</span></span>
<span id="cb463-24"><a href="categorization-models.html#cb463-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = gcm_ml_data,</span></span>
<span id="cb463-25"><a href="categorization-models.html#cb463-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     seed = 123,</span></span>
<span id="cb463-26"><a href="categorization-models.html#cb463-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     chains = 2,</span></span>
<span id="cb463-27"><a href="categorization-models.html#cb463-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     parallel_chains = 2,</span></span>
<span id="cb463-28"><a href="categorization-models.html#cb463-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     threads_per_chain = 2,</span></span>
<span id="cb463-29"><a href="categorization-models.html#cb463-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     iter_warmup = 1000,</span></span>
<span id="cb463-30"><a href="categorization-models.html#cb463-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     iter_sampling = 1000,</span></span>
<span id="cb463-31"><a href="categorization-models.html#cb463-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     refresh = 1000</span></span>
<span id="cb463-32"><a href="categorization-models.html#cb463-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb463-33"><a href="categorization-models.html#cb463-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-34"><a href="categorization-models.html#cb463-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-35"><a href="categorization-models.html#cb463-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   draws_df &lt;- as_draws_df(samples_gcm$draws()) </span></span>
<span id="cb463-36"><a href="categorization-models.html#cb463-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   temp &lt;- tibble(trueC_M = scalingM, </span></span>
<span id="cb463-37"><a href="categorization-models.html#cb463-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                  trueC_SD = scalingSD, </span></span>
<span id="cb463-38"><a href="categorization-models.html#cb463-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                  trueW1 = weights[1], </span></span>
<span id="cb463-39"><a href="categorization-models.html#cb463-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                  trueW2 = weights[2], </span></span>
<span id="cb463-40"><a href="categorization-models.html#cb463-40" aria-hidden="true" tabindex="-1"></a><span class="co">#                  trueKappa = kappa, </span></span>
<span id="cb463-41"><a href="categorization-models.html#cb463-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                  agents = agents,</span></span>
<span id="cb463-42"><a href="categorization-models.html#cb463-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                  # FROM HERE</span></span>
<span id="cb463-43"><a href="categorization-models.html#cb463-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                  estC = draws_df$c, </span></span>
<span id="cb463-44"><a href="categorization-models.html#cb463-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                  estW1 = draws_df$`w[1]`,</span></span>
<span id="cb463-45"><a href="categorization-models.html#cb463-45" aria-hidden="true" tabindex="-1"></a><span class="co">#                  estW2 = draws_df$`w[2]`</span></span>
<span id="cb463-46"><a href="categorization-models.html#cb463-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb463-47"><a href="categorization-models.html#cb463-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-48"><a href="categorization-models.html#cb463-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(temp)</span></span>
<span id="cb463-49"><a href="categorization-models.html#cb463-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb463-50"><a href="categorization-models.html#cb463-50" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb463-51"><a href="categorization-models.html#cb463-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb463-52"><a href="categorization-models.html#cb463-52" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Now I need to make a list of lists</span></span>
<span id="cb463-53"><a href="categorization-models.html#cb463-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb463-54"><a href="categorization-models.html#cb463-54" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb463-55"><a href="categorization-models.html#cb463-55" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- tibble(unique(simulated_responses[,c(&quot;agent&quot;, &quot;c&quot;, &quot;w&quot;)])) %&gt;%</span></span>
<span id="cb463-56"><a href="categorization-models.html#cb463-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(</span></span>
<span id="cb463-57"><a href="categorization-models.html#cb463-57" aria-hidden="true" tabindex="-1"></a><span class="co">#     scaling = c,</span></span>
<span id="cb463-58"><a href="categorization-models.html#cb463-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     weights = w</span></span>
<span id="cb463-59"><a href="categorization-models.html#cb463-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb463-60"><a href="categorization-models.html#cb463-60" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb463-61"><a href="categorization-models.html#cb463-61" aria-hidden="true" tabindex="-1"></a><span class="co"># recovery_df &lt;- future_pmap_dfr(temp, sim_d_and_fit, .options = furrr_options(seed = TRUE))</span></span>
<span id="cb463-62"><a href="categorization-models.html#cb463-62" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb463-63"><a href="categorization-models.html#cb463-63" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(recovery_df, &quot;simdata/W10_GCM_recoverydf.csv&quot;)</span></span></code></pre></div>
<div id="student-produced-models-of-categorization" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Student-produced models of categorization<a href="categorization-models.html#student-produced-models-of-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Attempting to identify features</p></li>
<li><p>Attempting to associate 1 of the features to one of the outcome dimensions (e.g. green as danger), test hypothesis, stay if positive, try different trait if negative. [missing details on how to define the hypothesized association, and how much evidence needed to shift]</p></li>
<li><p>Remembering the rule and/or remembering the single exemplars</p></li>
<li><p>Focusing on 1 feature 1 outcome vs trying to incorporate additional features</p></li>
<li><p>Using arbitrary associations btw features and outcomes vs. relying on intuition (raised arms are dangerous)</p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-models-of-cognition.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/10-CategorizationModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
