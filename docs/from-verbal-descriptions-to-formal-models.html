<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 From verbal descriptions to formal models | Advanced Cognitive Modeling Notes</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2026" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 From verbal descriptions to formal models | Advanced Cognitive Modeling Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2026" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 From verbal descriptions to formal models | Advanced Cognitive Modeling Notes" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2026" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2026-01-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="candidate-verbal-models.html"/>
<link rel="next" href="from-simulation-to-model-fitting.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html"><i class="fa fa-check"></i><b>2</b> The Pizza Experiment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#conclusion-from-pizza-to-cognitive-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Cognitive Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning Goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction-observing-behavior-to-theorize-mechanisms"><i class="fa fa-check"></i><b>3.2</b> Introduction: Observing Behavior to Theorize Mechanisms</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory-identifying-potential-mechanisms"><i class="fa fa-check"></i><b>3.6.1</b> From Observation to Theory: Identifying Potential Mechanisms</a></li>
<li class="chapter" data-level="3.6.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.6.2</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html"><i class="fa fa-check"></i><b>4</b> Candidate Verbal Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#plausibility-check-cognitive-constraints"><i class="fa fa-check"></i><b>4.1</b> Plausibility Check: Cognitive Constraints</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#memory-limitations"><i class="fa fa-check"></i><b>4.1.1</b> Memory Limitations</a></li>
<li class="chapter" data-level="4.1.2" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#perseveration-tendencies"><i class="fa fa-check"></i><b>4.1.2</b> Perseveration Tendencies</a></li>
<li class="chapter" data-level="4.1.3" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#noise-and-errors"><i class="fa fa-check"></i><b>4.1.3</b> Noise and Errors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#relationships-between-models"><i class="fa fa-check"></i><b>4.2</b> Relationships Between Models</a></li>
<li class="chapter" data-level="4.3" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#handling-heterogeneity-mixture-models"><i class="fa fa-check"></i><b>4.3</b> Handling Heterogeneity: Mixture Models</a></li>
<li class="chapter" data-level="4.4" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#cognitive-modeling-vs.-traditional-statistical-approaches-e.g.-glm"><i class="fa fa-check"></i><b>4.4</b> Cognitive Modeling vs. Traditional Statistical Approaches (e.g., GLM)</a></li>
<li class="chapter" data-level="4.5" data-path="candidate-verbal-models.html"><a href="candidate-verbal-models.html#conclusion-from-observations-to-verbal-theories"><i class="fa fa-check"></i><b>4.5</b> Conclusion: From Observations to Verbal Theories</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>5</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization-and-simulation"><i class="fa fa-check"></i><b>5.2</b> The Value of Formalization and Simulation</a></li>
<li class="chapter" data-level="5.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>5.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="5.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>5.4</b> Implementing a Random Agent</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#encapsulating-the-agent-in-a-function"><i class="fa fa-check"></i><b>5.4.1</b> Encapsulating the Agent in a Function</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-wsls-agent"><i class="fa fa-check"></i><b>5.5</b> Implementing a Win-Stay-Lose-Shift (WSLS) Agent</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#simulating-wsls-vs.-opponents"><i class="fa fa-check"></i><b>5.5.1</b> Simulating WSLS vs. Opponents</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#scaling-up-simulating-multiple-agents"><i class="fa fa-check"></i><b>5.6</b> Scaling Up: Simulating Multiple Agents</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#visualizing-results"><i class="fa fa-check"></i><b>5.6.1</b> Visualizing Results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion-formalizing-and-simulating-strategies"><i class="fa fa-check"></i><b>5.7</b> Conclusion: Formalizing and Simulating Strategies</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>6</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>6.1</b> Learning Goals</a></li>
<li class="chapter" data-level="6.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-inferring-latent-parameters"><i class="fa fa-check"></i><b>6.2</b> The Challenge: Inferring Latent Parameters</a></li>
<li class="chapter" data-level="6.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>6.3</b> Simulating data</a></li>
<li class="chapter" data-level="6.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-first-stan-model-inferring-bias-rate"><i class="fa fa-check"></i><b>6.4</b> Building our First Stan Model: Inferring Bias Rate</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>6.4.1</b> Model</a></li>
<li class="chapter" data-level="6.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>6.4.2</b> Assessing model quality</a></li>
<li class="chapter" data-level="6.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>6.4.3</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#validating-the-model-parameter-recovery"><i class="fa fa-check"></i><b>6.5</b> Validating the Model: Parameter Recovery</a></li>
<li class="chapter" data-level="6.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#moving-beyond-simple-bias-memory-models"><i class="fa fa-check"></i><b>6.6</b> Moving Beyond Simple Bias: Memory Models</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-1-glm-like-approach-external-predictor"><i class="fa fa-check"></i><b>6.6.1</b> Memory Model 1: GLM-like Approach (External Predictor)</a></li>
<li class="chapter" data-level="6.6.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>6.6.2</b> Summarizing the results</a></li>
<li class="chapter" data-level="6.6.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-2-internal-state-variable"><i class="fa fa-check"></i><b>6.6.3</b> Memory Model 2: Internal State Variable</a></li>
<li class="chapter" data-level="6.6.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-3-exponential-forgetting-relation-to-rl"><i class="fa fa-check"></i><b>6.6.4</b> Memory Model 3: Exponential Forgetting (Relation to RL)</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-4-bayesian-agent-optimal-updating"><i class="fa fa-check"></i><b>6.7</b> Memory Model 4: Bayesian Agent (Optimal Updating)</a></li>
<li class="chapter" data-level="6.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>6.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>6.8.1</b> Connection to Kalman Filters</a></li>
<li class="chapter" data-level="6.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>6.8.2</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="6.8.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>6.8.3</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-estimating-parameters-and-exploring-memory"><i class="fa fa-check"></i><b>6.9</b> Conclusion: Estimating Parameters and Exploring Memory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Cognitive Modeling Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="from-verbal-descriptions-to-formal-models" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> From verbal descriptions to formal models<a href="from-verbal-descriptions-to-formal-models.html#from-verbal-descriptions-to-formal-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter bridges the gap between verbal theories and computational implementations of cognitive models. Building on our observations of the matching pennies game, we now develop precise mathematical formulations that can generate testable predictions.</p>
<div id="learning-goals-1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Learning Goals<a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter focuses on translating the verbal theories from Chapter 2 into concrete, testable computational models. After completing this chapter, you will be able to:</p>
<ul>
<li><strong>Formalize Verbal Models:</strong> Translate abstract strategy descriptions (like “Random Choice” or “Win-Stay-Lose-Shift”) into precise algorithms and implement them as R functions.</li>
<li><strong>Implement Agent-Based Simulations:</strong> Create simple software “agents” that execute these strategies within a simulated environment (the Matching Pennies game).</li>
<li><strong>Understand Simulation’s Role:</strong> Use simulation to explore the behavioral consequences of different model assumptions and parameters <em>before</em> fitting models to real data.</li>
<li><strong>Analyze Simulated Behavior:</strong> Generate and visualize simulation data to understand how different strategies perform and interact under controlled conditions.</li>
<li><strong>Prepare for Model Fitting:</strong> Appreciate why simulating models is a crucial step prior to estimating parameters from empirical data (covered in Chapter 4).</li>
</ul>
</div>
<div id="the-value-of-formalization-and-simulation" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> The Value of Formalization and Simulation<a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization-and-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Moving from the verbal models discussed in Chapter 2 to formal, computational models is a critical step in cognitive science. Verbal descriptions often hide ambiguity – what does “tend to repeat” or “track patterns” <em>precisely</em> mean? Formalization forces us to be explicit.</p>
<p><strong>1. Formalization forces clarity:</strong>
* Translating ideas into code or math requires specifying exact rules, parameters, and information processing steps. This often reveals hidden assumptions or underspecified aspects of the verbal theory.</p>
<p><strong>2. Computational implementation enables simulation:</strong>
* Once formalized, we can create computational agents that <em>act out</em> the strategy.
* Simulation allows us to:
* <strong>Understand Emergent Behavior:</strong> See the consequences of our model’s rules over many trials or interactions. Does the strategy lead to expected patterns? Are there surprising outcomes?
* <strong>Explore Parameter Space:</strong> How does behavior change if we alter a model parameter (e.g., the bias in a random agent, or the stay probability in WSLS)?
* <strong>Generate Testable Predictions:</strong> What specific behavioral patterns (e.g., choice sequences, reaction times - though not modeled here) does the model predict under different conditions? These predictions can then be compared to real data.
* <strong>Debug Model Logic:</strong> Does the simulated behavior make sense? If not, it might indicate a flaw in our formalization of the verbal theory.</p>
<p>In this chapter, we will walk through this process:</p>
<ol style="list-style-type: decimal">
<li><strong>Formalize:</strong> Define precise algorithms for two key strategies from Chapter 2 (Random Choice and WSLS).</li>
<li><strong>Implement:</strong> Code these algorithms as reusable R functions.</li>
<li><strong>Simulate:</strong> Run these agents against different types of opponents (a biased random agent, another WSLS agent).</li>
<li><strong>Scale &amp; Analyze:</strong> Simulate many agents to understand average behavior and visualize the results to compare strategy effectiveness.</li>
</ol>
</div>
<div id="defining-general-conditions" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Defining general conditions<a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="from-verbal-descriptions-to-formal-models.html#cb20-1" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb20-2"><a href="from-verbal-descriptions-to-formal-models.html#cb20-2" tabindex="-1"></a><span class="co"># patchwork helps combine multiple plots</span></span>
<span id="cb20-3"><a href="from-verbal-descriptions-to-formal-models.html#cb20-3" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, patchwork)</span>
<span id="cb20-4"><a href="from-verbal-descriptions-to-formal-models.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="from-verbal-descriptions-to-formal-models.html#cb20-5" tabindex="-1"></a><span class="co"># Number of trials per simulation</span></span>
<span id="cb20-6"><a href="from-verbal-descriptions-to-formal-models.html#cb20-6" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span>  </span>
<span id="cb20-7"><a href="from-verbal-descriptions-to-formal-models.html#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="from-verbal-descriptions-to-formal-models.html#cb20-8" tabindex="-1"></a><span class="co"># Number of agents to simulate</span></span>
<span id="cb20-9"><a href="from-verbal-descriptions-to-formal-models.html#cb20-9" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span>  </span>
<span id="cb20-10"><a href="from-verbal-descriptions-to-formal-models.html#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="from-verbal-descriptions-to-formal-models.html#cb20-11" tabindex="-1"></a><span class="co"># Optional: Set random seed for reproducibility</span></span>
<span id="cb20-12"><a href="from-verbal-descriptions-to-formal-models.html#cb20-12" tabindex="-1"></a><span class="co"># set.seed(123)</span></span></code></pre></div>
</div>
<div id="implementing-a-random-agent" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Implementing a Random Agent<a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our simplest model from Chapter 2 was the Random Choice agent. It assumes choices are independent of history and context, potentially with a fixed bias.</p>
<p><strong>Algorithm:</strong> On each trial, choose option 1 (‘right’, coded as 1) with probability <code>rate</code>, otherwise choose option 0 (‘left’, coded as 0).</p>
<p>Let’s implement this and visualize its behavior.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="from-verbal-descriptions-to-formal-models.html#cb21-1" tabindex="-1"></a><span class="co"># --- Simulation Parameters ---</span></span>
<span id="cb21-2"><a href="from-verbal-descriptions-to-formal-models.html#cb21-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span> <span class="co"># Number of trials for a single simulation run</span></span>
<span id="cb21-3"><a href="from-verbal-descriptions-to-formal-models.html#cb21-3" tabindex="-1"></a><span class="co"># set.seed(123) # Uncomment for reproducible random choices</span></span>
<span id="cb21-4"><a href="from-verbal-descriptions-to-formal-models.html#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="from-verbal-descriptions-to-formal-models.html#cb21-5" tabindex="-1"></a><span class="co"># --- Basic Implementation ---</span></span>
<span id="cb21-6"><a href="from-verbal-descriptions-to-formal-models.html#cb21-6" tabindex="-1"></a><span class="co"># Simulate an unbiased random agent (rate = 0.5)</span></span>
<span id="cb21-7"><a href="from-verbal-descriptions-to-formal-models.html#cb21-7" tabindex="-1"></a>rate_unbiased <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb21-8"><a href="from-verbal-descriptions-to-formal-models.html#cb21-8" tabindex="-1"></a>choices_unbiased <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> rate_unbiased)</span>
<span id="cb21-9"><a href="from-verbal-descriptions-to-formal-models.html#cb21-9" tabindex="-1"></a><span class="co"># rbinom generates random draws from a binomial distribution.</span></span>
<span id="cb21-10"><a href="from-verbal-descriptions-to-formal-models.html#cb21-10" tabindex="-1"></a><span class="co"># size = 1 makes it a Bernoulli trial (0 or 1 outcome).</span></span>
<span id="cb21-11"><a href="from-verbal-descriptions-to-formal-models.html#cb21-11" tabindex="-1"></a><span class="co"># prob = rate specifies the probability of getting a 1.</span></span>
<span id="cb21-12"><a href="from-verbal-descriptions-to-formal-models.html#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="from-verbal-descriptions-to-formal-models.html#cb21-13" tabindex="-1"></a><span class="co"># Simulate a biased random agent (rate = 0.8, chooses &#39;right&#39; 80% of the time)</span></span>
<span id="cb21-14"><a href="from-verbal-descriptions-to-formal-models.html#cb21-14" tabindex="-1"></a>rate_biased <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb21-15"><a href="from-verbal-descriptions-to-formal-models.html#cb21-15" tabindex="-1"></a>choices_biased <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> rate_biased)</span>
<span id="cb21-16"><a href="from-verbal-descriptions-to-formal-models.html#cb21-16" tabindex="-1"></a></span>
<span id="cb21-17"><a href="from-verbal-descriptions-to-formal-models.html#cb21-17" tabindex="-1"></a><span class="co"># --- Visualization 1: Raw Choices ---</span></span>
<span id="cb21-18"><a href="from-verbal-descriptions-to-formal-models.html#cb21-18" tabindex="-1"></a><span class="co"># Create data frames for plotting</span></span>
<span id="cb21-19"><a href="from-verbal-descriptions-to-formal-models.html#cb21-19" tabindex="-1"></a>d_unbiased <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials, <span class="at">choice =</span> choices_unbiased, <span class="at">rate =</span> rate_unbiased)</span>
<span id="cb21-20"><a href="from-verbal-descriptions-to-formal-models.html#cb21-20" tabindex="-1"></a>d_biased <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials, <span class="at">choice =</span> choices_biased, <span class="at">rate =</span> rate_biased)</span>
<span id="cb21-21"><a href="from-verbal-descriptions-to-formal-models.html#cb21-21" tabindex="-1"></a></span>
<span id="cb21-22"><a href="from-verbal-descriptions-to-formal-models.html#cb21-22" tabindex="-1"></a><span class="co"># Plot raw choice sequence (0s and 1s)</span></span>
<span id="cb21-23"><a href="from-verbal-descriptions-to-formal-models.html#cb21-23" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_unbiased, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> choice)) <span class="sc">+</span></span>
<span id="cb21-24"><a href="from-verbal-descriptions-to-formal-models.html#cb21-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-25"><a href="from-verbal-descriptions-to-formal-models.html#cb21-25" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unbiased Random Agent (Rate = 0.5)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb21-26"><a href="from-verbal-descriptions-to-formal-models.html#cb21-26" tabindex="-1"></a></span>
<span id="cb21-27"><a href="from-verbal-descriptions-to-formal-models.html#cb21-27" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_biased, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> choice)) <span class="sc">+</span></span>
<span id="cb21-28"><a href="from-verbal-descriptions-to-formal-models.html#cb21-28" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-29"><a href="from-verbal-descriptions-to-formal-models.html#cb21-29" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Biased Random Agent (Rate = 0.8)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb21-30"><a href="from-verbal-descriptions-to-formal-models.html#cb21-30" tabindex="-1"></a></span>
<span id="cb21-31"><a href="from-verbal-descriptions-to-formal-models.html#cb21-31" tabindex="-1"></a><span class="co"># Show plots side-by-side</span></span>
<span id="cb21-32"><a href="from-verbal-descriptions-to-formal-models.html#cb21-32" tabindex="-1"></a><span class="fu">print</span>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>))</span>
<span id="cb21-33"><a href="from-verbal-descriptions-to-formal-models.html#cb21-33" tabindex="-1"></a></span>
<span id="cb21-34"><a href="from-verbal-descriptions-to-formal-models.html#cb21-34" tabindex="-1"></a></span>
<span id="cb21-35"><a href="from-verbal-descriptions-to-formal-models.html#cb21-35" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;This first visualization shows the behavior of a purely random agent - one that chooses between options with equal probability (rate = 0.5). Looking at the jagged line jumping between 0 and 1, we can see that the agent&#39;s choices appear truly random, with no discernible pattern. This represents what we might expect from a player who is deliberately trying to be unpredictable in the matching pennies game.</span></span>
<span id="cb21-36"><a href="from-verbal-descriptions-to-formal-models.html#cb21-36" tabindex="-1"></a><span class="st">However, this raw choice plot can be hard to interpret. A more informative way to look at the agent&#39;s behavior is to examine how its average rate of choosing option 1 evolves over time:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;This first visualization shows the behavior of a purely random agent - one that chooses between options with equal probability (rate = 0.5). Looking at the jagged line jumping between 0 and 1, we can see that the agent&#39;s choices appear truly random, with no discernible pattern. This represents what we might expect from a player who is deliberately trying to be unpredictable in the matching pennies game.\nHowever, this raw choice plot can be hard to interpret. A more informative way to look at the agent&#39;s behavior is to examine how its average rate of choosing option 1 evolves over time:&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="from-verbal-descriptions-to-formal-models.html#cb23-1" tabindex="-1"></a><span class="co"># --- Visualization 2: Cumulative Rate ---</span></span>
<span id="cb23-2"><a href="from-verbal-descriptions-to-formal-models.html#cb23-2" tabindex="-1"></a><span class="co"># Calculate the cumulative proportion of &#39;right&#39; choices (1s)</span></span>
<span id="cb23-3"><a href="from-verbal-descriptions-to-formal-models.html#cb23-3" tabindex="-1"></a>d_unbiased <span class="ot">&lt;-</span> d_unbiased <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cumulative_rate =</span> <span class="fu">cumsum</span>(choice) <span class="sc">/</span> <span class="fu">row_number</span>())</span>
<span id="cb23-4"><a href="from-verbal-descriptions-to-formal-models.html#cb23-4" tabindex="-1"></a>d_biased <span class="ot">&lt;-</span> d_biased <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cumulative_rate =</span> <span class="fu">cumsum</span>(choice) <span class="sc">/</span> <span class="fu">row_number</span>())</span>
<span id="cb23-5"><a href="from-verbal-descriptions-to-formal-models.html#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="from-verbal-descriptions-to-formal-models.html#cb23-6" tabindex="-1"></a><span class="co"># Combine data for comparison plot</span></span>
<span id="cb23-7"><a href="from-verbal-descriptions-to-formal-models.html#cb23-7" tabindex="-1"></a>d_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(d_unbiased, d_biased) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="from-verbal-descriptions-to-formal-models.html#cb23-8" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Agent =</span> <span class="fu">paste</span>(<span class="st">&quot;Rate =&quot;</span>, rate))</span>
<span id="cb23-9"><a href="from-verbal-descriptions-to-formal-models.html#cb23-9" tabindex="-1"></a></span>
<span id="cb23-10"><a href="from-verbal-descriptions-to-formal-models.html#cb23-10" tabindex="-1"></a><span class="co"># Plot cumulative rates</span></span>
<span id="cb23-11"><a href="from-verbal-descriptions-to-formal-models.html#cb23-11" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_combined, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> cumulative_rate, <span class="at">color =</span> Agent)) <span class="sc">+</span></span>
<span id="cb23-12"><a href="from-verbal-descriptions-to-formal-models.html#cb23-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="from-verbal-descriptions-to-formal-models.html#cb23-13" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="co"># Reference line for 50%</span></span>
<span id="cb23-14"><a href="from-verbal-descriptions-to-formal-models.html#cb23-14" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="from-verbal-descriptions-to-formal-models.html#cb23-15" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-16"><a href="from-verbal-descriptions-to-formal-models.html#cb23-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Cumulative Choice Rate Over Time&quot;</span>,</span>
<span id="cb23-17"><a href="from-verbal-descriptions-to-formal-models.html#cb23-17" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Shows convergence towards the agent&#39;s underlying bias&quot;</span>,</span>
<span id="cb23-18"><a href="from-verbal-descriptions-to-formal-models.html#cb23-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb23-19"><a href="from-verbal-descriptions-to-formal-models.html#cb23-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative Proportion of Choosing &#39;Right&#39;&quot;</span>,</span>
<span id="cb23-20"><a href="from-verbal-descriptions-to-formal-models.html#cb23-20" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb23-21"><a href="from-verbal-descriptions-to-formal-models.html#cb23-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-22"><a href="from-verbal-descriptions-to-formal-models.html#cb23-22" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb23-23"><a href="from-verbal-descriptions-to-formal-models.html#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="from-verbal-descriptions-to-formal-models.html#cb23-24" tabindex="-1"></a><span class="fu">print</span>(p3)</span>
<span id="cb23-25"><a href="from-verbal-descriptions-to-formal-models.html#cb23-25" tabindex="-1"></a></span>
<span id="cb23-26"><a href="from-verbal-descriptions-to-formal-models.html#cb23-26" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;We can clearly see how bias affects choice behavior. The unbiased agent (rate = 0.5) stabilizes around choosing each option equally often, while the biased agent (rate = 0.8) shows a strong preference for option 1, choosing it approximately 80% of the time. This comparison helps us understand how we might detect biases in real players&#39; behavior - consistent deviation from 50-50 choice proportions could indicate an underlying preference or strategy.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;We can clearly see how bias affects choice behavior. The unbiased agent (rate = 0.5) stabilizes around choosing each option equally often, while the biased agent (rate = 0.8) shows a strong preference for option 1, choosing it approximately 80% of the time. This comparison helps us understand how we might detect biases in real players&#39; behavior - consistent deviation from 50-50 choice proportions could indicate an underlying preference or strategy.&quot;</code></pre>
<p><img src="series_files/figure-html/03-implement-random-agent-1.png" alt="" width="80%" style="display: block; margin: auto;" /><img src="series_files/figure-html/03-implement-random-agent-2.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<div id="encapsulating-the-agent-in-a-function" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Encapsulating the Agent in a Function<a href="from-verbal-descriptions-to-formal-models.html#encapsulating-the-agent-in-a-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To make our agent reusable, we’ll wrap the logic in a function. This is good practice for building more complex simulations.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="from-verbal-descriptions-to-formal-models.html#cb25-1" tabindex="-1"></a><span class="co">#&#39; Random Agent Function</span></span>
<span id="cb25-2"><a href="from-verbal-descriptions-to-formal-models.html#cb25-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb25-3"><a href="from-verbal-descriptions-to-formal-models.html#cb25-3" tabindex="-1"></a><span class="co">#&#39; Generates a sequence of choices based on a fixed probability (rate).</span></span>
<span id="cb25-4"><a href="from-verbal-descriptions-to-formal-models.html#cb25-4" tabindex="-1"></a><span class="co">#&#39; Includes optional noise causing random 50/50 choices.</span></span>
<span id="cb25-5"><a href="from-verbal-descriptions-to-formal-models.html#cb25-5" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb25-6"><a href="from-verbal-descriptions-to-formal-models.html#cb25-6" tabindex="-1"></a><span class="co">#&#39; @param n_trials Integer, the number of choices to generate.</span></span>
<span id="cb25-7"><a href="from-verbal-descriptions-to-formal-models.html#cb25-7" tabindex="-1"></a><span class="co">#&#39; @param rate Numeric, the probability (0-1) of choosing option 1 (&#39;right&#39;).</span></span>
<span id="cb25-8"><a href="from-verbal-descriptions-to-formal-models.html#cb25-8" tabindex="-1"></a><span class="co">#&#39; @param noise Numeric, the probability (0-1) of making a random 50/50 choice</span></span>
<span id="cb25-9"><a href="from-verbal-descriptions-to-formal-models.html#cb25-9" tabindex="-1"></a><span class="co">#&#39;   instead of following the rate. Default is 0 (no noise).</span></span>
<span id="cb25-10"><a href="from-verbal-descriptions-to-formal-models.html#cb25-10" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb25-11"><a href="from-verbal-descriptions-to-formal-models.html#cb25-11" tabindex="-1"></a><span class="co">#&#39; @return A numeric vector of choices (0s and 1s).</span></span>
<span id="cb25-12"><a href="from-verbal-descriptions-to-formal-models.html#cb25-12" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb25-13"><a href="from-verbal-descriptions-to-formal-models.html#cb25-13" tabindex="-1"></a>RandomAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, <span class="at">rate =</span> <span class="fl">0.5</span>, <span class="at">noise =</span> <span class="dv">0</span>) {</span>
<span id="cb25-14"><a href="from-verbal-descriptions-to-formal-models.html#cb25-14" tabindex="-1"></a>  <span class="co"># Input validation</span></span>
<span id="cb25-15"><a href="from-verbal-descriptions-to-formal-models.html#cb25-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(rate) <span class="sc">||</span> rate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> rate <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb25-16"><a href="from-verbal-descriptions-to-formal-models.html#cb25-16" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Rate must be a probability between 0 and 1.&quot;</span>)</span>
<span id="cb25-17"><a href="from-verbal-descriptions-to-formal-models.html#cb25-17" tabindex="-1"></a>  }</span>
<span id="cb25-18"><a href="from-verbal-descriptions-to-formal-models.html#cb25-18" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(noise) <span class="sc">||</span> noise <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> noise <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb25-19"><a href="from-verbal-descriptions-to-formal-models.html#cb25-19" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Noise must be a probability between 0 and 1.&quot;</span>)</span>
<span id="cb25-20"><a href="from-verbal-descriptions-to-formal-models.html#cb25-20" tabindex="-1"></a>  }</span>
<span id="cb25-21"><a href="from-verbal-descriptions-to-formal-models.html#cb25-21" tabindex="-1"></a></span>
<span id="cb25-22"><a href="from-verbal-descriptions-to-formal-models.html#cb25-22" tabindex="-1"></a>  <span class="co"># Generate base choices according to the rate</span></span>
<span id="cb25-23"><a href="from-verbal-descriptions-to-formal-models.html#cb25-23" tabindex="-1"></a>  choices <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> rate)</span>
<span id="cb25-24"><a href="from-verbal-descriptions-to-formal-models.html#cb25-24" tabindex="-1"></a></span>
<span id="cb25-25"><a href="from-verbal-descriptions-to-formal-models.html#cb25-25" tabindex="-1"></a>  <span class="co"># Apply noise: identify trials where noise occurs</span></span>
<span id="cb25-26"><a href="from-verbal-descriptions-to-formal-models.html#cb25-26" tabindex="-1"></a>  noise_trials <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> noise) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb25-27"><a href="from-verbal-descriptions-to-formal-models.html#cb25-27" tabindex="-1"></a></span>
<span id="cb25-28"><a href="from-verbal-descriptions-to-formal-models.html#cb25-28" tabindex="-1"></a>  <span class="co"># Replace choices with random 50/50 on noise trials</span></span>
<span id="cb25-29"><a href="from-verbal-descriptions-to-formal-models.html#cb25-29" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(noise_trials)) {</span>
<span id="cb25-30"><a href="from-verbal-descriptions-to-formal-models.html#cb25-30" tabindex="-1"></a>    choices[noise_trials] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">sum</span>(noise_trials), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb25-31"><a href="from-verbal-descriptions-to-formal-models.html#cb25-31" tabindex="-1"></a>  }</span>
<span id="cb25-32"><a href="from-verbal-descriptions-to-formal-models.html#cb25-32" tabindex="-1"></a></span>
<span id="cb25-33"><a href="from-verbal-descriptions-to-formal-models.html#cb25-33" tabindex="-1"></a>  <span class="fu">return</span>(choices)</span>
<span id="cb25-34"><a href="from-verbal-descriptions-to-formal-models.html#cb25-34" tabindex="-1"></a>}</span>
<span id="cb25-35"><a href="from-verbal-descriptions-to-formal-models.html#cb25-35" tabindex="-1"></a></span>
<span id="cb25-36"><a href="from-verbal-descriptions-to-formal-models.html#cb25-36" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb25-37"><a href="from-verbal-descriptions-to-formal-models.html#cb25-37" tabindex="-1"></a>example_choices <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="at">n_trials =</span> <span class="dv">10</span>, <span class="at">rate =</span> <span class="fl">0.7</span>, <span class="at">noise =</span> <span class="fl">0.1</span>)</span>
<span id="cb25-38"><a href="from-verbal-descriptions-to-formal-models.html#cb25-38" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Example choices (rate=0.7, noise=0.1):&quot;</span>, <span class="fu">paste</span>(example_choices, <span class="at">collapse=</span><span class="st">&quot; &quot;</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Example choices (rate=0.7, noise=0.1): 0 0 0 1 0 1 1 1 1 0&quot;</code></pre>
</div>
</div>
<div id="implementing-a-win-stay-lose-shift-wsls-agent" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Implementing a Win-Stay-Lose-Shift (WSLS) Agent<a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-wsls-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The WSLS strategy (Chapter 2) reacts to the immediate past: repeat a winning choice, switch after a loss.</p>
<p><strong>Algorithm:</strong>
1. Make an initial choice (e.g., randomly).
2. On trial <em>t</em> &gt; 1:
a. Determine feedback from trial <em>t-1</em> (win or loss).
b. If win: choose the same action as trial <em>t-1</em>.
c. If loss: choose the opposite action from trial <em>t-1</em>.
3. Add optional noise: with probability <code>noise</code>, make a random 50/50 choice instead.</p>
<p><strong>Implementing the WSLS Function</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="from-verbal-descriptions-to-formal-models.html#cb27-1" tabindex="-1"></a><span class="co">#&#39; Win-Stay-Lose-Shift Agent Function</span></span>
<span id="cb27-2"><a href="from-verbal-descriptions-to-formal-models.html#cb27-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb27-3"><a href="from-verbal-descriptions-to-formal-models.html#cb27-3" tabindex="-1"></a><span class="co">#&#39; Determines the next choice based on the previous choice and its outcome (feedback).</span></span>
<span id="cb27-4"><a href="from-verbal-descriptions-to-formal-models.html#cb27-4" tabindex="-1"></a><span class="co">#&#39; Includes optional noise.</span></span>
<span id="cb27-5"><a href="from-verbal-descriptions-to-formal-models.html#cb27-5" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb27-6"><a href="from-verbal-descriptions-to-formal-models.html#cb27-6" tabindex="-1"></a><span class="co">#&#39; @param prevChoice Numeric, the agent&#39;s choice on the previous trial (0 or 1).</span></span>
<span id="cb27-7"><a href="from-verbal-descriptions-to-formal-models.html#cb27-7" tabindex="-1"></a><span class="co">#&#39; @param feedback Numeric, the outcome of the previous trial (1 for win, 0 for loss).</span></span>
<span id="cb27-8"><a href="from-verbal-descriptions-to-formal-models.html#cb27-8" tabindex="-1"></a><span class="co">#&#39; @param noise Numeric, the probability (0-1) of making a random 50/50 choice. Default is 0.</span></span>
<span id="cb27-9"><a href="from-verbal-descriptions-to-formal-models.html#cb27-9" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb27-10"><a href="from-verbal-descriptions-to-formal-models.html#cb27-10" tabindex="-1"></a><span class="co">#&#39; @return Numeric, the agent&#39;s next choice (0 or 1).</span></span>
<span id="cb27-11"><a href="from-verbal-descriptions-to-formal-models.html#cb27-11" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb27-12"><a href="from-verbal-descriptions-to-formal-models.html#cb27-12" tabindex="-1"></a>WSLSAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, feedback, <span class="at">noise =</span> <span class="dv">0</span>) {</span>
<span id="cb27-13"><a href="from-verbal-descriptions-to-formal-models.html#cb27-13" tabindex="-1"></a>  <span class="co"># Input validation</span></span>
<span id="cb27-14"><a href="from-verbal-descriptions-to-formal-models.html#cb27-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>prevChoice <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">stop</span>(<span class="st">&quot;Previous choice must be 0 or 1.&quot;</span>)</span>
<span id="cb27-15"><a href="from-verbal-descriptions-to-formal-models.html#cb27-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>feedback <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">stop</span>(<span class="st">&quot;Feedback must be 0 or 1.&quot;</span>)</span>
<span id="cb27-16"><a href="from-verbal-descriptions-to-formal-models.html#cb27-16" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(noise) <span class="sc">||</span> noise <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> noise <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="fu">stop</span>(<span class="st">&quot;Noise must be a probability between 0 and 1.&quot;</span>)</span>
<span id="cb27-17"><a href="from-verbal-descriptions-to-formal-models.html#cb27-17" tabindex="-1"></a></span>
<span id="cb27-18"><a href="from-verbal-descriptions-to-formal-models.html#cb27-18" tabindex="-1"></a>  <span class="co"># Core WSLS logic:</span></span>
<span id="cb27-19"><a href="from-verbal-descriptions-to-formal-models.html#cb27-19" tabindex="-1"></a>  <span class="co"># If feedback is 1 (win), stay: choice = prevChoice</span></span>
<span id="cb27-20"><a href="from-verbal-descriptions-to-formal-models.html#cb27-20" tabindex="-1"></a>  <span class="co"># If feedback is 0 (loss), shift: choice = 1 - prevChoice</span></span>
<span id="cb27-21"><a href="from-verbal-descriptions-to-formal-models.html#cb27-21" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(feedback <span class="sc">==</span> <span class="dv">1</span>, prevChoice, <span class="dv">1</span> <span class="sc">-</span> prevChoice)</span>
<span id="cb27-22"><a href="from-verbal-descriptions-to-formal-models.html#cb27-22" tabindex="-1"></a></span>
<span id="cb27-23"><a href="from-verbal-descriptions-to-formal-models.html#cb27-23" tabindex="-1"></a>  <span class="co"># Apply noise if specified</span></span>
<span id="cb27-24"><a href="from-verbal-descriptions-to-formal-models.html#cb27-24" tabindex="-1"></a>  <span class="cf">if</span> (noise <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> noise) {</span>
<span id="cb27-25"><a href="from-verbal-descriptions-to-formal-models.html#cb27-25" tabindex="-1"></a>    <span class="co"># Override with a random 50/50 choice</span></span>
<span id="cb27-26"><a href="from-verbal-descriptions-to-formal-models.html#cb27-26" tabindex="-1"></a>    choice <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb27-27"><a href="from-verbal-descriptions-to-formal-models.html#cb27-27" tabindex="-1"></a>  }</span>
<span id="cb27-28"><a href="from-verbal-descriptions-to-formal-models.html#cb27-28" tabindex="-1"></a></span>
<span id="cb27-29"><a href="from-verbal-descriptions-to-formal-models.html#cb27-29" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb27-30"><a href="from-verbal-descriptions-to-formal-models.html#cb27-30" tabindex="-1"></a>}</span>
<span id="cb27-31"><a href="from-verbal-descriptions-to-formal-models.html#cb27-31" tabindex="-1"></a></span>
<span id="cb27-32"><a href="from-verbal-descriptions-to-formal-models.html#cb27-32" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb27-33"><a href="from-verbal-descriptions-to-formal-models.html#cb27-33" tabindex="-1"></a><span class="co"># Won previous trial (feedback=1) after choosing 1:</span></span>
<span id="cb27-34"><a href="from-verbal-descriptions-to-formal-models.html#cb27-34" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Next choice after win (chose 1):&quot;</span>, <span class="fu">WSLSAgent_f</span>(<span class="at">prevChoice =</span> <span class="dv">1</span>, <span class="at">feedback =</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Next choice after win (chose 1): 1&quot;</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="from-verbal-descriptions-to-formal-models.html#cb29-1" tabindex="-1"></a><span class="co"># Lost previous trial (feedback=0) after choosing 1:</span></span>
<span id="cb29-2"><a href="from-verbal-descriptions-to-formal-models.html#cb29-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Next choice after loss (chose 1):&quot;</span>, <span class="fu">WSLSAgent_f</span>(<span class="at">prevChoice =</span> <span class="dv">1</span>, <span class="at">feedback =</span> <span class="dv">0</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Next choice after loss (chose 1): 0&quot;</code></pre>
<div id="simulating-wsls-vs.-opponents" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Simulating WSLS vs. Opponents<a href="from-verbal-descriptions-to-formal-models.html#simulating-wsls-vs.-opponents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, let’s simulate our WSLS agent playing against different opponents to see how it performs.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="from-verbal-descriptions-to-formal-models.html#cb31-1" tabindex="-1"></a><span class="co"># --- Simulation Setup ---</span></span>
<span id="cb31-2"><a href="from-verbal-descriptions-to-formal-models.html#cb31-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb31-3"><a href="from-verbal-descriptions-to-formal-models.html#cb31-3" tabindex="-1"></a><span class="co"># set.seed(456) # Uncomment for reproducible simulation runs</span></span>
<span id="cb31-4"><a href="from-verbal-descriptions-to-formal-models.html#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="from-verbal-descriptions-to-formal-models.html#cb31-5" tabindex="-1"></a><span class="co"># --- Simulation 1: WSLS vs. Biased Random Agent ---</span></span>
<span id="cb31-6"><a href="from-verbal-descriptions-to-formal-models.html#cb31-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simulating WSLS vs. Biased Random (Rate = 0.8)...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simulating WSLS vs. Biased Random (Rate = 0.8)...</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="from-verbal-descriptions-to-formal-models.html#cb33-1" tabindex="-1"></a><span class="co"># Opponent always chooses &#39;right&#39; with 80% probability</span></span>
<span id="cb33-2"><a href="from-verbal-descriptions-to-formal-models.html#cb33-2" tabindex="-1"></a>opponent_choices_biased <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="at">n_trials =</span> trials, <span class="at">rate =</span> <span class="fl">0.8</span>, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb33-3"><a href="from-verbal-descriptions-to-formal-models.html#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="from-verbal-descriptions-to-formal-models.html#cb33-4" tabindex="-1"></a><span class="co"># Initialize vectors for WSLS agent</span></span>
<span id="cb33-5"><a href="from-verbal-descriptions-to-formal-models.html#cb33-5" tabindex="-1"></a>wsls_choices_vs_biased <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb33-6"><a href="from-verbal-descriptions-to-formal-models.html#cb33-6" tabindex="-1"></a>feedback_vs_biased <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb33-7"><a href="from-verbal-descriptions-to-formal-models.html#cb33-7" tabindex="-1"></a></span>
<span id="cb33-8"><a href="from-verbal-descriptions-to-formal-models.html#cb33-8" tabindex="-1"></a><span class="co"># First choice is random</span></span>
<span id="cb33-9"><a href="from-verbal-descriptions-to-formal-models.html#cb33-9" tabindex="-1"></a>wsls_choices_vs_biased[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb33-10"><a href="from-verbal-descriptions-to-formal-models.html#cb33-10" tabindex="-1"></a></span>
<span id="cb33-11"><a href="from-verbal-descriptions-to-formal-models.html#cb33-11" tabindex="-1"></a><span class="co"># Simulation loop</span></span>
<span id="cb33-12"><a href="from-verbal-descriptions-to-formal-models.html#cb33-12" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb33-13"><a href="from-verbal-descriptions-to-formal-models.html#cb33-13" tabindex="-1"></a>  <span class="co"># Determine feedback from previous trial (WSLS wins if choices match opponent)</span></span>
<span id="cb33-14"><a href="from-verbal-descriptions-to-formal-models.html#cb33-14" tabindex="-1"></a>  <span class="co"># Note: In Matching Pennies, win condition depends on role (Matcher/Hider).</span></span>
<span id="cb33-15"><a href="from-verbal-descriptions-to-formal-models.html#cb33-15" tabindex="-1"></a>  <span class="co"># Here we assume the WSLS agent is the &#39;Matcher&#39; for simplicity.</span></span>
<span id="cb33-16"><a href="from-verbal-descriptions-to-formal-models.html#cb33-16" tabindex="-1"></a>  prev_feedback <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls_choices_vs_biased[t<span class="dv">-1</span>] <span class="sc">==</span> opponent_choices_biased[t<span class="dv">-1</span>], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb33-17"><a href="from-verbal-descriptions-to-formal-models.html#cb33-17" tabindex="-1"></a>  feedback_vs_biased[t<span class="dv">-1</span>] <span class="ot">&lt;-</span> prev_feedback <span class="co"># Store feedback for analysis</span></span>
<span id="cb33-18"><a href="from-verbal-descriptions-to-formal-models.html#cb33-18" tabindex="-1"></a></span>
<span id="cb33-19"><a href="from-verbal-descriptions-to-formal-models.html#cb33-19" tabindex="-1"></a>  <span class="co"># WSLS agent makes choice based on previous feedback</span></span>
<span id="cb33-20"><a href="from-verbal-descriptions-to-formal-models.html#cb33-20" tabindex="-1"></a>  wsls_choices_vs_biased[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(</span>
<span id="cb33-21"><a href="from-verbal-descriptions-to-formal-models.html#cb33-21" tabindex="-1"></a>    <span class="at">prevChoice =</span> wsls_choices_vs_biased[t<span class="dv">-1</span>],</span>
<span id="cb33-22"><a href="from-verbal-descriptions-to-formal-models.html#cb33-22" tabindex="-1"></a>    <span class="at">feedback =</span> prev_feedback,</span>
<span id="cb33-23"><a href="from-verbal-descriptions-to-formal-models.html#cb33-23" tabindex="-1"></a>    <span class="at">noise =</span> <span class="dv">0</span> <span class="co"># Assuming no noise for this simulation</span></span>
<span id="cb33-24"><a href="from-verbal-descriptions-to-formal-models.html#cb33-24" tabindex="-1"></a>  )</span>
<span id="cb33-25"><a href="from-verbal-descriptions-to-formal-models.html#cb33-25" tabindex="-1"></a>}</span>
<span id="cb33-26"><a href="from-verbal-descriptions-to-formal-models.html#cb33-26" tabindex="-1"></a><span class="co"># Record feedback for the last trial</span></span>
<span id="cb33-27"><a href="from-verbal-descriptions-to-formal-models.html#cb33-27" tabindex="-1"></a>feedback_vs_biased[trials] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls_choices_vs_biased[trials] <span class="sc">==</span> opponent_choices_biased[trials], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb33-28"><a href="from-verbal-descriptions-to-formal-models.html#cb33-28" tabindex="-1"></a></span>
<span id="cb33-29"><a href="from-verbal-descriptions-to-formal-models.html#cb33-29" tabindex="-1"></a><span class="co"># Create dataframe for analysis</span></span>
<span id="cb33-30"><a href="from-verbal-descriptions-to-formal-models.html#cb33-30" tabindex="-1"></a>df_vs_biased <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-31"><a href="from-verbal-descriptions-to-formal-models.html#cb33-31" tabindex="-1"></a>  <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials,</span>
<span id="cb33-32"><a href="from-verbal-descriptions-to-formal-models.html#cb33-32" tabindex="-1"></a>  <span class="at">Self_WSLS =</span> wsls_choices_vs_biased,</span>
<span id="cb33-33"><a href="from-verbal-descriptions-to-formal-models.html#cb33-33" tabindex="-1"></a>  <span class="at">Opponent_Random =</span> opponent_choices_biased,</span>
<span id="cb33-34"><a href="from-verbal-descriptions-to-formal-models.html#cb33-34" tabindex="-1"></a>  <span class="at">Feedback =</span> feedback_vs_biased <span class="co"># 1 if WSLS won</span></span>
<span id="cb33-35"><a href="from-verbal-descriptions-to-formal-models.html#cb33-35" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb33-36"><a href="from-verbal-descriptions-to-formal-models.html#cb33-36" tabindex="-1"></a>  <span class="at">Cumulative_Performance =</span> <span class="fu">cumsum</span>(Feedback) <span class="sc">/</span> <span class="fu">row_number</span>()</span>
<span id="cb33-37"><a href="from-verbal-descriptions-to-formal-models.html#cb33-37" tabindex="-1"></a>)</span>
<span id="cb33-38"><a href="from-verbal-descriptions-to-formal-models.html#cb33-38" tabindex="-1"></a></span>
<span id="cb33-39"><a href="from-verbal-descriptions-to-formal-models.html#cb33-39" tabindex="-1"></a><span class="co"># --- Simulation 2: WSLS vs. WSLS ---</span></span>
<span id="cb33-40"><a href="from-verbal-descriptions-to-formal-models.html#cb33-40" tabindex="-1"></a><span class="co"># (Opponent plays WSLS but tries to mismatch - feedback is inverted)</span></span>
<span id="cb33-41"><a href="from-verbal-descriptions-to-formal-models.html#cb33-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simulating WSLS vs. WSLS...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simulating WSLS vs. WSLS...</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="from-verbal-descriptions-to-formal-models.html#cb35-1" tabindex="-1"></a>wsls1_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb35-2"><a href="from-verbal-descriptions-to-formal-models.html#cb35-2" tabindex="-1"></a>wsls2_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb35-3"><a href="from-verbal-descriptions-to-formal-models.html#cb35-3" tabindex="-1"></a>feedback_wsls1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials) <span class="co"># Feedback for agent 1</span></span>
<span id="cb35-4"><a href="from-verbal-descriptions-to-formal-models.html#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="from-verbal-descriptions-to-formal-models.html#cb35-5" tabindex="-1"></a>wsls1_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb35-6"><a href="from-verbal-descriptions-to-formal-models.html#cb35-6" tabindex="-1"></a>wsls2_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb35-7"><a href="from-verbal-descriptions-to-formal-models.html#cb35-7" tabindex="-1"></a></span>
<span id="cb35-8"><a href="from-verbal-descriptions-to-formal-models.html#cb35-8" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb35-9"><a href="from-verbal-descriptions-to-formal-models.html#cb35-9" tabindex="-1"></a>  <span class="co"># Feedback for agent 1 from previous trial (wins if match)</span></span>
<span id="cb35-10"><a href="from-verbal-descriptions-to-formal-models.html#cb35-10" tabindex="-1"></a>  prev_feedback1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls1_choices[t<span class="dv">-1</span>] <span class="sc">==</span> wsls2_choices[t<span class="dv">-1</span>], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-11"><a href="from-verbal-descriptions-to-formal-models.html#cb35-11" tabindex="-1"></a>  feedback_wsls1[t<span class="dv">-1</span>] <span class="ot">&lt;-</span> prev_feedback1</span>
<span id="cb35-12"><a href="from-verbal-descriptions-to-formal-models.html#cb35-12" tabindex="-1"></a></span>
<span id="cb35-13"><a href="from-verbal-descriptions-to-formal-models.html#cb35-13" tabindex="-1"></a>  <span class="co"># Feedback for agent 2 (opponent) is the opposite (wins if mismatch)</span></span>
<span id="cb35-14"><a href="from-verbal-descriptions-to-formal-models.html#cb35-14" tabindex="-1"></a>  prev_feedback2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> prev_feedback1</span>
<span id="cb35-15"><a href="from-verbal-descriptions-to-formal-models.html#cb35-15" tabindex="-1"></a></span>
<span id="cb35-16"><a href="from-verbal-descriptions-to-formal-models.html#cb35-16" tabindex="-1"></a>  <span class="co"># Both agents choose based on their own previous feedback</span></span>
<span id="cb35-17"><a href="from-verbal-descriptions-to-formal-models.html#cb35-17" tabindex="-1"></a>  wsls1_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(wsls1_choices[t<span class="dv">-1</span>], prev_feedback1, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb35-18"><a href="from-verbal-descriptions-to-formal-models.html#cb35-18" tabindex="-1"></a>  wsls2_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(wsls2_choices[t<span class="dv">-1</span>], prev_feedback2, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb35-19"><a href="from-verbal-descriptions-to-formal-models.html#cb35-19" tabindex="-1"></a>}</span>
<span id="cb35-20"><a href="from-verbal-descriptions-to-formal-models.html#cb35-20" tabindex="-1"></a>feedback_wsls1[trials] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls1_choices[trials] <span class="sc">==</span> wsls2_choices[trials], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-21"><a href="from-verbal-descriptions-to-formal-models.html#cb35-21" tabindex="-1"></a></span>
<span id="cb35-22"><a href="from-verbal-descriptions-to-formal-models.html#cb35-22" tabindex="-1"></a><span class="co"># Create dataframe</span></span>
<span id="cb35-23"><a href="from-verbal-descriptions-to-formal-models.html#cb35-23" tabindex="-1"></a>df_vs_wsls <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-24"><a href="from-verbal-descriptions-to-formal-models.html#cb35-24" tabindex="-1"></a>  <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials,</span>
<span id="cb35-25"><a href="from-verbal-descriptions-to-formal-models.html#cb35-25" tabindex="-1"></a>  <span class="at">Self_WSLS =</span> wsls1_choices,</span>
<span id="cb35-26"><a href="from-verbal-descriptions-to-formal-models.html#cb35-26" tabindex="-1"></a>  <span class="at">Opponent_WSLS =</span> wsls2_choices,</span>
<span id="cb35-27"><a href="from-verbal-descriptions-to-formal-models.html#cb35-27" tabindex="-1"></a>  <span class="at">Feedback =</span> feedback_wsls1 <span class="co"># 1 if Self_WSLS won</span></span>
<span id="cb35-28"><a href="from-verbal-descriptions-to-formal-models.html#cb35-28" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb35-29"><a href="from-verbal-descriptions-to-formal-models.html#cb35-29" tabindex="-1"></a>  <span class="at">Cumulative_Performance =</span> <span class="fu">cumsum</span>(Feedback) <span class="sc">/</span> <span class="fu">row_number</span>()</span>
<span id="cb35-30"><a href="from-verbal-descriptions-to-formal-models.html#cb35-30" tabindex="-1"></a>)</span>
<span id="cb35-31"><a href="from-verbal-descriptions-to-formal-models.html#cb35-31" tabindex="-1"></a></span>
<span id="cb35-32"><a href="from-verbal-descriptions-to-formal-models.html#cb35-32" tabindex="-1"></a><span class="co"># --- Visualize Simulation Results ---</span></span>
<span id="cb35-33"><a href="from-verbal-descriptions-to-formal-models.html#cb35-33" tabindex="-1"></a><span class="co"># Plot choices over time</span></span>
<span id="cb35-34"><a href="from-verbal-descriptions-to-formal-models.html#cb35-34" tabindex="-1"></a>p_choices_biased <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_biased, <span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb35-35"><a href="from-verbal-descriptions-to-formal-models.html#cb35-35" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Self_WSLS, <span class="at">color =</span> <span class="st">&quot;WSLS Agent&quot;</span>)) <span class="sc">+</span></span>
<span id="cb35-36"><a href="from-verbal-descriptions-to-formal-models.html#cb35-36" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Opponent_Random <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">&quot;Biased Opponent&quot;</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="co"># Offset slightly</span></span>
<span id="cb35-37"><a href="from-verbal-descriptions-to-formal-models.html#cb35-37" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS vs. Biased Random&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb35-38"><a href="from-verbal-descriptions-to-formal-models.html#cb35-38" tabindex="-1"></a></span>
<span id="cb35-39"><a href="from-verbal-descriptions-to-formal-models.html#cb35-39" tabindex="-1"></a>p_choices_wsls <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_wsls, <span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb35-40"><a href="from-verbal-descriptions-to-formal-models.html#cb35-40" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Self_WSLS, <span class="at">color =</span> <span class="st">&quot;WSLS Agent 1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb35-41"><a href="from-verbal-descriptions-to-formal-models.html#cb35-41" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Opponent_WSLS <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">&quot;WSLS Agent 2&quot;</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="co"># Offset slightly</span></span>
<span id="cb35-42"><a href="from-verbal-descriptions-to-formal-models.html#cb35-42" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS vs. WSLS&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb35-43"><a href="from-verbal-descriptions-to-formal-models.html#cb35-43" tabindex="-1"></a></span>
<span id="cb35-44"><a href="from-verbal-descriptions-to-formal-models.html#cb35-44" tabindex="-1"></a><span class="co"># Plot cumulative performance</span></span>
<span id="cb35-45"><a href="from-verbal-descriptions-to-formal-models.html#cb35-45" tabindex="-1"></a>p_perf_biased <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_biased, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> Cumulative_Performance)) <span class="sc">+</span></span>
<span id="cb35-46"><a href="from-verbal-descriptions-to-formal-models.html#cb35-46" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-47"><a href="from-verbal-descriptions-to-formal-models.html#cb35-47" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS Performance vs. Biased Random&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Proportion Wins&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb35-48"><a href="from-verbal-descriptions-to-formal-models.html#cb35-48" tabindex="-1"></a></span>
<span id="cb35-49"><a href="from-verbal-descriptions-to-formal-models.html#cb35-49" tabindex="-1"></a>p_perf_wsls <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_wsls, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> Cumulative_Performance)) <span class="sc">+</span></span>
<span id="cb35-50"><a href="from-verbal-descriptions-to-formal-models.html#cb35-50" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-51"><a href="from-verbal-descriptions-to-formal-models.html#cb35-51" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS Performance vs. WSLS&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Proportion Wins&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb35-52"><a href="from-verbal-descriptions-to-formal-models.html#cb35-52" tabindex="-1"></a></span>
<span id="cb35-53"><a href="from-verbal-descriptions-to-formal-models.html#cb35-53" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb35-54"><a href="from-verbal-descriptions-to-formal-models.html#cb35-54" tabindex="-1"></a><span class="fu">print</span>((p_choices_biased <span class="sc">|</span> p_choices_wsls) <span class="sc">/</span> (p_perf_biased <span class="sc">|</span> p_perf_wsls) <span class="sc">+</span></span>
<span id="cb35-55"><a href="from-verbal-descriptions-to-formal-models.html#cb35-55" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/03%20Win-Stay-Lose-Shift%20vs%20biased%20agent-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="from-verbal-descriptions-to-formal-models.html#cb36-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;This cumulative performance plot reveals the overall effectiveness of the WSLS strategy. By tracking the running average of successes, we can see whether the strategy leads to above-chance performance in the long run. When playing against a biased random opponent, the WSLS agent can potentially exploit the opponent&#39;s predictable tendencies, though success depends on how strong and consistent the opponent&#39;s bias is.</span></span>
<span id="cb36-2"><a href="from-verbal-descriptions-to-formal-models.html#cb36-2" tabindex="-1"></a><span class="st">When we pit the WSLS agent against another WSLS agent, the dynamics become more complex. Both agents are now trying to adapt to each other&#39;s adaptations, creating a more sophisticated strategic interaction. The resulting behavior often shows interesting patterns of mutual adaptation, where each agent&#39;s attempts to exploit the other&#39;s strategy leads to evolving patterns of play.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;This cumulative performance plot reveals the overall effectiveness of the WSLS strategy. By tracking the running average of successes, we can see whether the strategy leads to above-chance performance in the long run. When playing against a biased random opponent, the WSLS agent can potentially exploit the opponent&#39;s predictable tendencies, though success depends on how strong and consistent the opponent&#39;s bias is.\nWhen we pit the WSLS agent against another WSLS agent, the dynamics become more complex. Both agents are now trying to adapt to each other&#39;s adaptations, creating a more sophisticated strategic interaction. The resulting behavior often shows interesting patterns of mutual adaptation, where each agent&#39;s attempts to exploit the other&#39;s strategy leads to evolving patterns of play.&quot;</code></pre>
</div>
</div>
<div id="scaling-up-simulating-multiple-agents" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Scaling Up: Simulating Multiple Agents<a href="from-verbal-descriptions-to-formal-models.html#scaling-up-simulating-multiple-agents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To understand the average behavior and robustness of the WSLS strategy, we need to simulate many agents playing against opponents with varying biases.</p>
<p><strong>Refactoring Simulation into a Function</strong></p>
<p>First, let’s create a function that runs one simulation (one WSLS agent vs. one opponent) and returns the results. This avoids repeating code.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="from-verbal-descriptions-to-formal-models.html#cb38-1" tabindex="-1"></a><span class="co">#&#39; Run Matching Pennies Simulation</span></span>
<span id="cb38-2"><a href="from-verbal-descriptions-to-formal-models.html#cb38-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb38-3"><a href="from-verbal-descriptions-to-formal-models.html#cb38-3" tabindex="-1"></a><span class="co">#&#39; Simulates one agent playing Matching Pennies against an opponent</span></span>
<span id="cb38-4"><a href="from-verbal-descriptions-to-formal-models.html#cb38-4" tabindex="-1"></a><span class="co">#&#39; for a specified number of trials.</span></span>
<span id="cb38-5"><a href="from-verbal-descriptions-to-formal-models.html#cb38-5" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb38-6"><a href="from-verbal-descriptions-to-formal-models.html#cb38-6" tabindex="-1"></a><span class="co">#&#39; @param n_trials Integer, number of trials.</span></span>
<span id="cb38-7"><a href="from-verbal-descriptions-to-formal-models.html#cb38-7" tabindex="-1"></a><span class="co">#&#39; @param wsls_params List, parameters for the WSLS agent (alpha, betaWin, betaLose, noise).</span></span>
<span id="cb38-8"><a href="from-verbal-descriptions-to-formal-models.html#cb38-8" tabindex="-1"></a><span class="co">#&#39; @param opponent_type String, &quot;Random&quot; or &quot;WSLS&quot;.</span></span>
<span id="cb38-9"><a href="from-verbal-descriptions-to-formal-models.html#cb38-9" tabindex="-1"></a><span class="co">#&#39; @param opponent_params List, parameters for the opponent agent.</span></span>
<span id="cb38-10"><a href="from-verbal-descriptions-to-formal-models.html#cb38-10" tabindex="-1"></a><span class="co">#&#39;                           For Random: list(rate, noise).</span></span>
<span id="cb38-11"><a href="from-verbal-descriptions-to-formal-models.html#cb38-11" tabindex="-1"></a><span class="co">#&#39;                           For WSLS: list(alpha, betaWin, betaLose, noise).</span></span>
<span id="cb38-12"><a href="from-verbal-descriptions-to-formal-models.html#cb38-12" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb38-13"><a href="from-verbal-descriptions-to-formal-models.html#cb38-13" tabindex="-1"></a><span class="co">#&#39; @return A tibble with trial-by-trial choices and outcomes.</span></span>
<span id="cb38-14"><a href="from-verbal-descriptions-to-formal-models.html#cb38-14" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb38-15"><a href="from-verbal-descriptions-to-formal-models.html#cb38-15" tabindex="-1"></a>run_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, wsls_params, opponent_type, opponent_params) {</span>
<span id="cb38-16"><a href="from-verbal-descriptions-to-formal-models.html#cb38-16" tabindex="-1"></a></span>
<span id="cb38-17"><a href="from-verbal-descriptions-to-formal-models.html#cb38-17" tabindex="-1"></a>  <span class="co"># Initialize choices and feedback</span></span>
<span id="cb38-18"><a href="from-verbal-descriptions-to-formal-models.html#cb38-18" tabindex="-1"></a>  wsls_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_trials)</span>
<span id="cb38-19"><a href="from-verbal-descriptions-to-formal-models.html#cb38-19" tabindex="-1"></a>  opponent_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_trials)</span>
<span id="cb38-20"><a href="from-verbal-descriptions-to-formal-models.html#cb38-20" tabindex="-1"></a>  wsls_feedback <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_trials) <span class="co"># Feedback for WSLS agent (1=win)</span></span>
<span id="cb38-21"><a href="from-verbal-descriptions-to-formal-models.html#cb38-21" tabindex="-1"></a>  wsls_win_signal <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_trials) <span class="co"># +1/-1 if won, 0 if lost</span></span>
<span id="cb38-22"><a href="from-verbal-descriptions-to-formal-models.html#cb38-22" tabindex="-1"></a>  wsls_lose_signal <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_trials) <span class="co"># +1/-1 if lost, 0 if won</span></span>
<span id="cb38-23"><a href="from-verbal-descriptions-to-formal-models.html#cb38-23" tabindex="-1"></a></span>
<span id="cb38-24"><a href="from-verbal-descriptions-to-formal-models.html#cb38-24" tabindex="-1"></a>  <span class="co"># First trial choices</span></span>
<span id="cb38-25"><a href="from-verbal-descriptions-to-formal-models.html#cb38-25" tabindex="-1"></a>  wsls_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb38-26"><a href="from-verbal-descriptions-to-formal-models.html#cb38-26" tabindex="-1"></a>  <span class="cf">if</span> (opponent_type <span class="sc">==</span> <span class="st">&quot;Random&quot;</span>) {</span>
<span id="cb38-27"><a href="from-verbal-descriptions-to-formal-models.html#cb38-27" tabindex="-1"></a>    opponent_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, opponent_params<span class="sc">$</span>rate, opponent_params<span class="sc">$</span>noise)</span>
<span id="cb38-28"><a href="from-verbal-descriptions-to-formal-models.html#cb38-28" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="co"># Opponent is WSLS</span></span>
<span id="cb38-29"><a href="from-verbal-descriptions-to-formal-models.html#cb38-29" tabindex="-1"></a>    opponent_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb38-30"><a href="from-verbal-descriptions-to-formal-models.html#cb38-30" tabindex="-1"></a>  }</span>
<span id="cb38-31"><a href="from-verbal-descriptions-to-formal-models.html#cb38-31" tabindex="-1"></a></span>
<span id="cb38-32"><a href="from-verbal-descriptions-to-formal-models.html#cb38-32" tabindex="-1"></a>  <span class="co"># Loop through remaining trials</span></span>
<span id="cb38-33"><a href="from-verbal-descriptions-to-formal-models.html#cb38-33" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_trials) {</span>
<span id="cb38-34"><a href="from-verbal-descriptions-to-formal-models.html#cb38-34" tabindex="-1"></a>    <span class="co"># Determine feedback from t-1 (WSLS agent is Matcher)</span></span>
<span id="cb38-35"><a href="from-verbal-descriptions-to-formal-models.html#cb38-35" tabindex="-1"></a>    prev_wsls_feedback <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls_choices[t<span class="dv">-1</span>] <span class="sc">==</span> opponent_choices[t<span class="dv">-1</span>], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb38-36"><a href="from-verbal-descriptions-to-formal-models.html#cb38-36" tabindex="-1"></a>    wsls_feedback[t<span class="dv">-1</span>] <span class="ot">&lt;-</span> prev_wsls_feedback</span>
<span id="cb38-37"><a href="from-verbal-descriptions-to-formal-models.html#cb38-37" tabindex="-1"></a></span>
<span id="cb38-38"><a href="from-verbal-descriptions-to-formal-models.html#cb38-38" tabindex="-1"></a>    <span class="co"># Update WSLS win/lose signals based on t-1 outcome</span></span>
<span id="cb38-39"><a href="from-verbal-descriptions-to-formal-models.html#cb38-39" tabindex="-1"></a>    wsls_win_signal[t<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prev_wsls_feedback <span class="sc">==</span> <span class="dv">1</span>, <span class="fu">ifelse</span>(wsls_choices[t<span class="dv">-1</span>] <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="dv">0</span>)</span>
<span id="cb38-40"><a href="from-verbal-descriptions-to-formal-models.html#cb38-40" tabindex="-1"></a>    wsls_lose_signal[t<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prev_wsls_feedback <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">ifelse</span>(wsls_choices[t<span class="dv">-1</span>] <span class="sc">==</span> <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">0</span>)</span>
<span id="cb38-41"><a href="from-verbal-descriptions-to-formal-models.html#cb38-41" tabindex="-1"></a></span>
<span id="cb38-42"><a href="from-verbal-descriptions-to-formal-models.html#cb38-42" tabindex="-1"></a>    <span class="co"># WSLS agent chooses for trial t</span></span>
<span id="cb38-43"><a href="from-verbal-descriptions-to-formal-models.html#cb38-43" tabindex="-1"></a>    wsls_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(</span>
<span id="cb38-44"><a href="from-verbal-descriptions-to-formal-models.html#cb38-44" tabindex="-1"></a>      <span class="at">prevChoice =</span> wsls_choices[t<span class="dv">-1</span>],</span>
<span id="cb38-45"><a href="from-verbal-descriptions-to-formal-models.html#cb38-45" tabindex="-1"></a>      <span class="at">feedback =</span> prev_wsls_feedback,</span>
<span id="cb38-46"><a href="from-verbal-descriptions-to-formal-models.html#cb38-46" tabindex="-1"></a>      <span class="at">noise =</span> wsls_params<span class="sc">$</span>noise</span>
<span id="cb38-47"><a href="from-verbal-descriptions-to-formal-models.html#cb38-47" tabindex="-1"></a>      <span class="co"># Note: Using deterministic WSLS here for simplicity, could use parameterized version</span></span>
<span id="cb38-48"><a href="from-verbal-descriptions-to-formal-models.html#cb38-48" tabindex="-1"></a>      <span class="co"># WSLSAgentNoise_f(wsls_params$alpha, wsls_params$betaWin, wsls_params$betaLose,</span></span>
<span id="cb38-49"><a href="from-verbal-descriptions-to-formal-models.html#cb38-49" tabindex="-1"></a>      <span class="co">#                  wsls_win_signal[t-1], wsls_lose_signal[t-1], wsls_params$noise)</span></span>
<span id="cb38-50"><a href="from-verbal-descriptions-to-formal-models.html#cb38-50" tabindex="-1"></a>    )</span>
<span id="cb38-51"><a href="from-verbal-descriptions-to-formal-models.html#cb38-51" tabindex="-1"></a></span>
<span id="cb38-52"><a href="from-verbal-descriptions-to-formal-models.html#cb38-52" tabindex="-1"></a>    <span class="co"># Opponent chooses for trial t</span></span>
<span id="cb38-53"><a href="from-verbal-descriptions-to-formal-models.html#cb38-53" tabindex="-1"></a>    <span class="cf">if</span> (opponent_type <span class="sc">==</span> <span class="st">&quot;Random&quot;</span>) {</span>
<span id="cb38-54"><a href="from-verbal-descriptions-to-formal-models.html#cb38-54" tabindex="-1"></a>      opponent_choices[t] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, opponent_params<span class="sc">$</span>rate, opponent_params<span class="sc">$</span>noise)</span>
<span id="cb38-55"><a href="from-verbal-descriptions-to-formal-models.html#cb38-55" tabindex="-1"></a>    } <span class="cf">else</span> { <span class="co"># Opponent is WSLS (Hider - gets opposite feedback)</span></span>
<span id="cb38-56"><a href="from-verbal-descriptions-to-formal-models.html#cb38-56" tabindex="-1"></a>       opponent_feedback_prev <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> prev_wsls_feedback <span class="co"># Hider wins on mismatch</span></span>
<span id="cb38-57"><a href="from-verbal-descriptions-to-formal-models.html#cb38-57" tabindex="-1"></a>       opponent_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(</span>
<span id="cb38-58"><a href="from-verbal-descriptions-to-formal-models.html#cb38-58" tabindex="-1"></a>         <span class="at">prevChoice =</span> opponent_choices[t<span class="dv">-1</span>],</span>
<span id="cb38-59"><a href="from-verbal-descriptions-to-formal-models.html#cb38-59" tabindex="-1"></a>         <span class="at">feedback =</span> opponent_feedback_prev,</span>
<span id="cb38-60"><a href="from-verbal-descriptions-to-formal-models.html#cb38-60" tabindex="-1"></a>         <span class="at">noise =</span> opponent_params<span class="sc">$</span>noise</span>
<span id="cb38-61"><a href="from-verbal-descriptions-to-formal-models.html#cb38-61" tabindex="-1"></a>       )</span>
<span id="cb38-62"><a href="from-verbal-descriptions-to-formal-models.html#cb38-62" tabindex="-1"></a>    }</span>
<span id="cb38-63"><a href="from-verbal-descriptions-to-formal-models.html#cb38-63" tabindex="-1"></a>  }</span>
<span id="cb38-64"><a href="from-verbal-descriptions-to-formal-models.html#cb38-64" tabindex="-1"></a>  <span class="co"># Record feedback for the last trial</span></span>
<span id="cb38-65"><a href="from-verbal-descriptions-to-formal-models.html#cb38-65" tabindex="-1"></a>  wsls_feedback[n_trials] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls_choices[n_trials] <span class="sc">==</span> opponent_choices[n_trials], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb38-66"><a href="from-verbal-descriptions-to-formal-models.html#cb38-66" tabindex="-1"></a></span>
<span id="cb38-67"><a href="from-verbal-descriptions-to-formal-models.html#cb38-67" tabindex="-1"></a>  <span class="co"># Return results</span></span>
<span id="cb38-68"><a href="from-verbal-descriptions-to-formal-models.html#cb38-68" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">tibble</span>(</span>
<span id="cb38-69"><a href="from-verbal-descriptions-to-formal-models.html#cb38-69" tabindex="-1"></a>    <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>n_trials,</span>
<span id="cb38-70"><a href="from-verbal-descriptions-to-formal-models.html#cb38-70" tabindex="-1"></a>    <span class="at">Self_WSLS =</span> wsls_choices,</span>
<span id="cb38-71"><a href="from-verbal-descriptions-to-formal-models.html#cb38-71" tabindex="-1"></a>    <span class="at">Opponent =</span> opponent_choices,</span>
<span id="cb38-72"><a href="from-verbal-descriptions-to-formal-models.html#cb38-72" tabindex="-1"></a>    <span class="at">Feedback =</span> wsls_feedback</span>
<span id="cb38-73"><a href="from-verbal-descriptions-to-formal-models.html#cb38-73" tabindex="-1"></a>  ))</span>
<span id="cb38-74"><a href="from-verbal-descriptions-to-formal-models.html#cb38-74" tabindex="-1"></a>}</span>
<span id="cb38-75"><a href="from-verbal-descriptions-to-formal-models.html#cb38-75" tabindex="-1"></a></span>
<span id="cb38-76"><a href="from-verbal-descriptions-to-formal-models.html#cb38-76" tabindex="-1"></a><span class="co"># --- Running Scaled Simulations ---</span></span>
<span id="cb38-77"><a href="from-verbal-descriptions-to-formal-models.html#cb38-77" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Running scaled simulations...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Running scaled simulations...</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="from-verbal-descriptions-to-formal-models.html#cb40-1" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb40-2"><a href="from-verbal-descriptions-to-formal-models.html#cb40-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb40-3"><a href="from-verbal-descriptions-to-formal-models.html#cb40-3" tabindex="-1"></a><span class="co"># Default WSLS parameters (deterministic)</span></span>
<span id="cb40-4"><a href="from-verbal-descriptions-to-formal-models.html#cb40-4" tabindex="-1"></a>wsls_params_default <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">betaWin =</span> <span class="cn">Inf</span>, <span class="at">betaLose =</span> <span class="cn">Inf</span>, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb40-5"><a href="from-verbal-descriptions-to-formal-models.html#cb40-5" tabindex="-1"></a></span>
<span id="cb40-6"><a href="from-verbal-descriptions-to-formal-models.html#cb40-6" tabindex="-1"></a><span class="co"># Simulation 1: WSLS vs. Random agents with varying biases</span></span>
<span id="cb40-7"><a href="from-verbal-descriptions-to-formal-models.html#cb40-7" tabindex="-1"></a>opponent_rates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.5</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb40-8"><a href="from-verbal-descriptions-to-formal-models.html#cb40-8" tabindex="-1"></a>results_vs_random <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># Store results</span></span>
<span id="cb40-9"><a href="from-verbal-descriptions-to-formal-models.html#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="from-verbal-descriptions-to-formal-models.html#cb40-10" tabindex="-1"></a><span class="cf">for</span> (rate <span class="cf">in</span> opponent_rates) {</span>
<span id="cb40-11"><a href="from-verbal-descriptions-to-formal-models.html#cb40-11" tabindex="-1"></a>  rate_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-12"><a href="from-verbal-descriptions-to-formal-models.html#cb40-12" tabindex="-1"></a>  <span class="cf">for</span> (agent_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb40-13"><a href="from-verbal-descriptions-to-formal-models.html#cb40-13" tabindex="-1"></a>     opponent_params_rand <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">rate =</span> rate, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb40-14"><a href="from-verbal-descriptions-to-formal-models.html#cb40-14" tabindex="-1"></a>     sim_run <span class="ot">&lt;-</span> <span class="fu">run_simulation</span>(trials, wsls_params_default, <span class="st">&quot;Random&quot;</span>, opponent_params_rand)</span>
<span id="cb40-15"><a href="from-verbal-descriptions-to-formal-models.html#cb40-15" tabindex="-1"></a>     sim_run<span class="sc">$</span>agent <span class="ot">&lt;-</span> agent_i</span>
<span id="cb40-16"><a href="from-verbal-descriptions-to-formal-models.html#cb40-16" tabindex="-1"></a>     sim_run<span class="sc">$</span>opponent_rate <span class="ot">&lt;-</span> rate</span>
<span id="cb40-17"><a href="from-verbal-descriptions-to-formal-models.html#cb40-17" tabindex="-1"></a>     rate_results[[agent_i]] <span class="ot">&lt;-</span> sim_run</span>
<span id="cb40-18"><a href="from-verbal-descriptions-to-formal-models.html#cb40-18" tabindex="-1"></a>  }</span>
<span id="cb40-19"><a href="from-verbal-descriptions-to-formal-models.html#cb40-19" tabindex="-1"></a>  results_vs_random[[<span class="fu">as.character</span>(rate)]] <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rate_results)</span>
<span id="cb40-20"><a href="from-verbal-descriptions-to-formal-models.html#cb40-20" tabindex="-1"></a>}</span>
<span id="cb40-21"><a href="from-verbal-descriptions-to-formal-models.html#cb40-21" tabindex="-1"></a>df_scaled_vs_random <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_vs_random)</span>
<span id="cb40-22"><a href="from-verbal-descriptions-to-formal-models.html#cb40-22" tabindex="-1"></a></span>
<span id="cb40-23"><a href="from-verbal-descriptions-to-formal-models.html#cb40-23" tabindex="-1"></a><span class="co"># Simulation 2: WSLS vs. WSLS (100 times)</span></span>
<span id="cb40-24"><a href="from-verbal-descriptions-to-formal-models.html#cb40-24" tabindex="-1"></a>results_vs_wsls <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-25"><a href="from-verbal-descriptions-to-formal-models.html#cb40-25" tabindex="-1"></a>opponent_params_wsls <span class="ot">&lt;-</span> wsls_params_default <span class="co"># Opponent uses same deterministic WSLS</span></span>
<span id="cb40-26"><a href="from-verbal-descriptions-to-formal-models.html#cb40-26" tabindex="-1"></a></span>
<span id="cb40-27"><a href="from-verbal-descriptions-to-formal-models.html#cb40-27" tabindex="-1"></a><span class="cf">for</span> (agent_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb40-28"><a href="from-verbal-descriptions-to-formal-models.html#cb40-28" tabindex="-1"></a>   sim_run <span class="ot">&lt;-</span> <span class="fu">run_simulation</span>(trials, wsls_params_default, <span class="st">&quot;WSLS&quot;</span>, opponent_params_wsls)</span>
<span id="cb40-29"><a href="from-verbal-descriptions-to-formal-models.html#cb40-29" tabindex="-1"></a>   sim_run<span class="sc">$</span>agent <span class="ot">&lt;-</span> agent_i</span>
<span id="cb40-30"><a href="from-verbal-descriptions-to-formal-models.html#cb40-30" tabindex="-1"></a>   sim_run<span class="sc">$</span>opponent_rate <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># Not applicable</span></span>
<span id="cb40-31"><a href="from-verbal-descriptions-to-formal-models.html#cb40-31" tabindex="-1"></a>   results_vs_wsls[[agent_i]] <span class="ot">&lt;-</span> sim_run</span>
<span id="cb40-32"><a href="from-verbal-descriptions-to-formal-models.html#cb40-32" tabindex="-1"></a>}</span>
<span id="cb40-33"><a href="from-verbal-descriptions-to-formal-models.html#cb40-33" tabindex="-1"></a>df_scaled_vs_wsls <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_vs_wsls) <span class="co"># Contains results for WSLS vs WSLS</span></span>
<span id="cb40-34"><a href="from-verbal-descriptions-to-formal-models.html#cb40-34" tabindex="-1"></a></span>
<span id="cb40-35"><a href="from-verbal-descriptions-to-formal-models.html#cb40-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Scaled simulations complete.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Scaled simulations complete.</code></pre>
<div id="visualizing-results" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Visualizing Results<a href="from-verbal-descriptions-to-formal-models.html#visualizing-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s visualize the average performance of the WSLS agent against random opponents with different biases.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="from-verbal-descriptions-to-formal-models.html#cb42-1" tabindex="-1"></a><span class="co"># Calculate cumulative performance for each simulation run</span></span>
<span id="cb42-2"><a href="from-verbal-descriptions-to-formal-models.html#cb42-2" tabindex="-1"></a>df_scaled_vs_random <span class="ot">&lt;-</span> df_scaled_vs_random <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="from-verbal-descriptions-to-formal-models.html#cb42-3" tabindex="-1"></a>  <span class="fu">group_by</span>(agent, opponent_rate) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="from-verbal-descriptions-to-formal-models.html#cb42-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cumulative_Performance =</span> <span class="fu">cumsum</span>(Feedback) <span class="sc">/</span> <span class="fu">row_number</span>())</span>
<span id="cb42-5"><a href="from-verbal-descriptions-to-formal-models.html#cb42-5" tabindex="-1"></a></span>
<span id="cb42-6"><a href="from-verbal-descriptions-to-formal-models.html#cb42-6" tabindex="-1"></a><span class="co"># Plot average performance over time, grouped by opponent bias rate</span></span>
<span id="cb42-7"><a href="from-verbal-descriptions-to-formal-models.html#cb42-7" tabindex="-1"></a>p_scaled_perf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_scaled_vs_random,</span>
<span id="cb42-8"><a href="from-verbal-descriptions-to-formal-models.html#cb42-8" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> Cumulative_Performance,</span>
<span id="cb42-9"><a href="from-verbal-descriptions-to-formal-models.html#cb42-9" tabindex="-1"></a>           <span class="at">group =</span> opponent_rate, <span class="at">color =</span> opponent_rate)) <span class="sc">+</span></span>
<span id="cb42-10"><a href="from-verbal-descriptions-to-formal-models.html#cb42-10" tabindex="-1"></a>  <span class="co"># Use stat_summary to plot the mean performance across agents for each rate</span></span>
<span id="cb42-11"><a href="from-verbal-descriptions-to-formal-models.html#cb42-11" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-12"><a href="from-verbal-descriptions-to-formal-models.html#cb42-12" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="co"># Chance performance</span></span>
<span id="cb42-13"><a href="from-verbal-descriptions-to-formal-models.html#cb42-13" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span> <span class="co"># Use perceptually uniform color scale</span></span>
<span id="cb42-14"><a href="from-verbal-descriptions-to-formal-models.html#cb42-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-15"><a href="from-verbal-descriptions-to-formal-models.html#cb42-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Average WSLS Performance vs. Random Opponents&quot;</span>,</span>
<span id="cb42-16"><a href="from-verbal-descriptions-to-formal-models.html#cb42-16" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Performance improves as opponent&#39;s bias increases (rate moves away from 0.5)&quot;</span>,</span>
<span id="cb42-17"><a href="from-verbal-descriptions-to-formal-models.html#cb42-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb42-18"><a href="from-verbal-descriptions-to-formal-models.html#cb42-18" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Average Proportion Wins (across 100 agents)&quot;</span>,</span>
<span id="cb42-19"><a href="from-verbal-descriptions-to-formal-models.html#cb42-19" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Opponent&#39;s</span><span class="sc">\n</span><span class="st">Bias Rate&quot;</span></span>
<span id="cb42-20"><a href="from-verbal-descriptions-to-formal-models.html#cb42-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-21"><a href="from-verbal-descriptions-to-formal-models.html#cb42-21" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-22"><a href="from-verbal-descriptions-to-formal-models.html#cb42-22" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb42-23"><a href="from-verbal-descriptions-to-formal-models.html#cb42-23" tabindex="-1"></a></span>
<span id="cb42-24"><a href="from-verbal-descriptions-to-formal-models.html#cb42-24" tabindex="-1"></a><span class="fu">print</span>(p_scaled_perf)</span></code></pre></div>
<p><img src="series_files/figure-html/03%20visualizing-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This plot clearly shows that the WSLS strategy becomes more effective (higher average win rate) as the opponent becomes more predictable (i.e., their bias rate moves further away from 0.5 towards 1.0). Against a purely random opponent (rate=0.5), WSLS performs at chance level on average. This highlights WSLS’s ability to exploit predictability.</p>
</div>
</div>
<div id="conclusion-formalizing-and-simulating-strategies" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Conclusion: Formalizing and Simulating Strategies<a href="from-verbal-descriptions-to-formal-models.html#conclusion-formalizing-and-simulating-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter demonstrated the crucial step of translating verbal models from Chapter 2 (Random Choice, WSLS) into precise, computational forms. We implemented these strategies as R functions and used simulation to explore their behavior, both individually and when interacting with different opponents.</p>
<p>Key takeaways from this process include:
* <strong>Formalization Reduces Ambiguity:</strong> Writing code forced us to define exactly how each strategy operates (e.g., how WSLS uses feedback). When we state that an agent “learns from experience” or “responds to patterns,” we must specify exactly how these processes work. This precision not only clarifies our theoretical understanding but also enables rigorous empirical testing.
* <strong>Simulation Reveals Implications:</strong> Running the agents showed the behavioral consequences of these rules. We saw how a random agent’s bias affects its choice patterns and how WSLS performance depends heavily on the predictability of its opponent.
* <strong>Functions Enable Scalability:</strong> Encapsulating strategies in functions allowed us to easily simulate many agents and explore different parameter settings (like opponent bias).</p>
<p>We established a basic workflow: <strong>Observe -&gt; Formalize -&gt; Implement -&gt; Simulate -&gt; Analyze</strong>. Begin with careful observation, think carefully and develop precise mathematical formulations, implement these as computational models, and validate predictions against data. Don’t be afraid to make mistakes, or rethink your strategy and iterate the modeling process.This process helps us understand our models deeply <em>before</em> we attempt to fit them to complex, noisy empirical data. Simulation is invaluable for debugging model logic and generating clear, testable predictions.</p>
<p>However, simulation alone cannot tell us <em>which</em> model best describes actual human behavior, or <em>what parameter values</em> (like bias rates or WSLS sensitivities) best capture individual performance. For that, we need to confront our models with data. The next chapter, “From simulation to model fitting,” will introduce methods for estimating model parameters from observed data using Bayesian inference with Stan.</p>
<p>For more advanced examples of models that can underly behavior in the Matching Pennies game check:</p>
<ul>
<li><p>Chapter XX on reinforcement learning.</p></li>
<li><p>the paper by Waade et al mentioned at the beginning of the chapter.</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="candidate-verbal-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="from-simulation-to-model-fitting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/03-BuildingFormalModels.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
