<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 From verbal descriptions to formal models | Advanced Cognitive Modeling Notes</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2026" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 From verbal descriptions to formal models | Advanced Cognitive Modeling Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2026" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 From verbal descriptions to formal models | Advanced Cognitive Modeling Notes" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2026" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2026-02-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-models-of-strategic-decision-making.html"/>
<link rel="next" href="from-simulation-to-model-fitting.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html"><i class="fa fa-check"></i><b>2</b> The Pizza Experiment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#conclusion-from-pizza-to-cognitive-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Cognitive Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning Goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction-observing-behavior-to-theorize-mechanisms"><i class="fa fa-check"></i><b>3.2</b> Introduction: Observing Behavior to Theorize Mechanisms</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory-identifying-potential-mechanisms"><i class="fa fa-check"></i><b>3.6.1</b> From Observation to Theory: Identifying Potential Mechanisms</a></li>
<li class="chapter" data-level="3.6.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.6.2</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#candidate-verbal-models"><i class="fa fa-check"></i><b>3.7</b> Candidate Verbal Models</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#plausibility-check-cognitive-constraints"><i class="fa fa-check"></i><b>3.7.1</b> Plausibility Check: Cognitive Constraints</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#relationships-between-models"><i class="fa fa-check"></i><b>3.7.2</b> Relationships Between Models</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#handling-heterogeneity-mixture-models"><i class="fa fa-check"></i><b>3.7.3</b> Handling Heterogeneity: Mixture Models</a></li>
<li class="chapter" data-level="3.7.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-modeling-vs.-traditional-statistical-approaches-e.g.-glm"><i class="fa fa-check"></i><b>3.7.4</b> Cognitive Modeling vs. Traditional Statistical Approaches (e.g., GLM)</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#conclusion-from-observations-to-verbal-theories"><i class="fa fa-check"></i><b>3.8</b> Conclusion: From Observations to Verbal Theories</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization-and-simulation"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization and Simulation</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a Random Agent</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#encapsulating-the-agent-in-a-function"><i class="fa fa-check"></i><b>4.4.1</b> Encapsulating the Agent in a Function</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-wsls-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift (WSLS) Agent</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-the-wsls-function"><i class="fa fa-check"></i><b>4.5.1</b> Implementing the WSLS Function</a></li>
<li class="chapter" data-level="4.5.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#simulating-wsls-vs.-opponents"><i class="fa fa-check"></i><b>4.5.2</b> Simulating WSLS vs. Opponents</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#scaling-up-the-virtual-experiment"><i class="fa fa-check"></i><b>4.6</b> Scaling Up: The Virtual Experiment</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#visualizing-results"><i class="fa fa-check"></i><b>4.6.1</b> Visualizing Results</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion-the-forward-model"><i class="fa fa-check"></i><b>4.7</b> Conclusion: The Forward Model</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-problem-of-inference"><i class="fa fa-check"></i><b>4.7.1</b> The Problem of Inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-inferring-latent-parameters"><i class="fa fa-check"></i><b>5.2</b> The Challenge: Inferring Latent Parameters</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-first-stan-model-inferring-bias-rate"><i class="fa fa-check"></i><b>5.4</b> Building our First Stan Model: Inferring Bias Rate</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.1</b> Model</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.2</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.3</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#validating-the-model-parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Validating the Model: Parameter Recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#moving-beyond-simple-bias-memory-models"><i class="fa fa-check"></i><b>5.6</b> Moving Beyond Simple Bias: Memory Models</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-1-glm-like-approach-external-predictor"><i class="fa fa-check"></i><b>5.6.1</b> Memory Model 1: GLM-like Approach (External Predictor)</a></li>
<li class="chapter" data-level="5.6.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.2</b> Summarizing the results</a></li>
<li class="chapter" data-level="5.6.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-2-internal-state-variable"><i class="fa fa-check"></i><b>5.6.3</b> Memory Model 2: Internal State Variable</a></li>
<li class="chapter" data-level="5.6.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-3-exponential-forgetting-relation-to-rl"><i class="fa fa-check"></i><b>5.6.4</b> Memory Model 3: Exponential Forgetting (Relation to RL)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-4-bayesian-agent-optimal-updating"><i class="fa fa-check"></i><b>5.7</b> Memory Model 4: Bayesian Agent (Optimal Updating)</a></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Kalman Filters</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.2</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.3</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-estimating-parameters-and-exploring-memory"><i class="fa fa-check"></i><b>5.9</b> Conclusion: Estimating Parameters and Exploring Memory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Cognitive Modeling Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="from-verbal-descriptions-to-formal-models" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> From verbal descriptions to formal models<a href="from-verbal-descriptions-to-formal-models.html#from-verbal-descriptions-to-formal-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In Chapter 1, we explored how the “physics” of a pizza stone—Newton’s Law of Cooling—could generate temperature data. We called this a <strong>generative model</strong>. In Chapter 2, you observed your own behavior in the Matching Pennies game and proposed verbal theories like “Win-Stay-Lose-Shift” or “Random Choice.”</p>
<p>Now, we bridge the gap. In this chapter, we will build “models of the mind.” We will translate the verbal strategies from Chapter 2 into precise algorithms—creating agents, or <strong>Synthetic Subjects</strong>.</p>
<p>Just as we used a formula to simulate the pizza stone heating up, we will write code to simulate a cognitive agent playing a game. If our code can generate choice data that looks like human data, we have a candidate model for how the mind works. If it cannot, our theory is wrong.</p>
<div id="learning-goals-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Learning Goals<a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter focuses on translating the verbal theories from Chapter 2 into concrete, testable computational models. After completing this chapter, you will be able to:</p>
<ul>
<li><strong>Formalize Verbal Models:</strong> Translate abstract strategy descriptions (like “Random Choice” or “Win-Stay-Lose-Shift”) into precise algorithms.</li>
<li><strong>Implement Agent-Based Simulations:</strong> Create simple software “agents” that execute these algorithms within a simulated environment (the Matching Pennies game).</li>
<li><strong>Run Virtual Experiments:</strong> Use simulation to see how different strategies perform against different opponents <em>before</em> we ever touch real data.</li>
<li><strong>Analyze Simulated Behavior:</strong> Generate and visualize simulation data to understand how different strategies perform and interact under controlled conditions.</li>
<li><strong>Prepare for Model Fitting:</strong> Appreciate why simulating models is a crucial step prior to estimating parameters from empirical data (covered in Chapter 4).</li>
</ul>
</div>
<div id="the-value-of-formalization-and-simulation" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> The Value of Formalization and Simulation<a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization-and-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Verbal models are comfortable but dangerous. In Chapter 2, we might have said: <em>“The agent stays after a win.”</em></p>
<p>But formalization forces us to answer uncomfortable questions, for instance:</p>
<ul>
<li><p><strong>The Persistence Question:</strong> If they win 10 times, do they stay forever? Or is there a limit?</p></li>
<li><p><strong>The Error Question:</strong> Do they <em>always</em> stay, or do they sometimes press the wrong button by mistake?</p></li>
<li><p><strong>The First Trial Question:</strong> What do they do before they have any feedback?</p></li>
</ul>
<p>Writing code forces us to strip away ambiguity. It reveals hidden assumptions and forces us to be explicit about the mechanisms driving behavior. However, the value of this process extends beyond just clarity. Once formalized, we can create computational agents that act out the strategy. Simulation allows us to:</p>
<ul>
<li><p><strong>Understand Emergent Behavior</strong>: See the consequences of our model’s rules over many trials or interactions. Does the strategy lead to expected patterns? Are there surprising outcomes that weren’t obvious from the verbal description?</p></li>
<li><p><strong>Explore Parameter Space</strong>: How does behavior change if we alter a model parameter (e.g., the bias in a random agent, or the stay probability in WSLS)?</p></li>
<li><p><strong>Generate Testable Predictions</strong>: What specific behavioral patterns (e.g., choice sequences) does the model predict under different conditions? These predictions can then be compared to real data.</p></li>
<li><p><strong>Debug Model Logic</strong>: Does the simulated behavior make sense? If not, it might indicate a flaw in our formalization of the verbal theory.</p></li>
</ul>
<p>In this chapter, we will:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Formalize:</strong> Define precise algorithms for two key strategies (Random Choice and WSLS).</p></li>
<li><p><strong>Implement:</strong> Code these algorithms as reusable R functions.</p></li>
<li><p><strong>Simulate:</strong> Run these agents in a “Virtual Arena” against different opponents.</p></li>
<li><p><strong>Scale:</strong> Simulate many agents to understand average behavior and visualize the results to compare strategy effectiveness.</p></li>
</ol>
</div>
<div id="defining-general-conditions" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Defining general conditions<a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="from-verbal-descriptions-to-formal-models.html#cb21-1" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb21-2"><a href="from-verbal-descriptions-to-formal-models.html#cb21-2" tabindex="-1"></a><span class="co"># patchwork helps combine multiple plots</span></span>
<span id="cb21-3"><a href="from-verbal-descriptions-to-formal-models.html#cb21-3" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, patchwork)</span>
<span id="cb21-4"><a href="from-verbal-descriptions-to-formal-models.html#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="from-verbal-descriptions-to-formal-models.html#cb21-5" tabindex="-1"></a><span class="co"># Number of trials per simulation</span></span>
<span id="cb21-6"><a href="from-verbal-descriptions-to-formal-models.html#cb21-6" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span>  </span>
<span id="cb21-7"><a href="from-verbal-descriptions-to-formal-models.html#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="from-verbal-descriptions-to-formal-models.html#cb21-8" tabindex="-1"></a><span class="co"># Number of agents to simulate</span></span>
<span id="cb21-9"><a href="from-verbal-descriptions-to-formal-models.html#cb21-9" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span>  </span>
<span id="cb21-10"><a href="from-verbal-descriptions-to-formal-models.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="from-verbal-descriptions-to-formal-models.html#cb21-11" tabindex="-1"></a><span class="co"># Optional: Set random seed for reproducibility</span></span>
<span id="cb21-12"><a href="from-verbal-descriptions-to-formal-models.html#cb21-12" tabindex="-1"></a><span class="co"># set.seed(123)</span></span></code></pre></div>
</div>
<div id="implementing-a-random-agent" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Implementing a Random Agent<a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our simplest model from Chapter 2 was the Random Choice agent. In cognitive science, this serves as our <strong>Null Hypothesis</strong>.</p>
<p>A Random Agent is not just “acting crazily”; it represents a specific, strong theoretical claim: <strong>The agent has no memory and no learning.</strong> It does not care about the past (history) or the future (planning). It only has a bias.</p>
<p><strong>Algorithm:</strong> On every trial <span class="math inline">\(t\)</span>, independently of what happened at <span class="math inline">\(t-1\)</span>, choose ‘right’ (1) with probability <span class="math inline">\(\theta\)</span> and ‘left’ (0) with probability <span class="math inline">\(1-\theta\)</span>.</p>
<p>Let’s implement this synthetic subject.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="from-verbal-descriptions-to-formal-models.html#cb22-1" tabindex="-1"></a><span class="co"># --- Simulation Parameters ---</span></span>
<span id="cb22-2"><a href="from-verbal-descriptions-to-formal-models.html#cb22-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span> <span class="co"># Number of trials for a single simulation run</span></span>
<span id="cb22-3"><a href="from-verbal-descriptions-to-formal-models.html#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="from-verbal-descriptions-to-formal-models.html#cb22-4" tabindex="-1"></a><span class="co"># --- Basic Implementation ---</span></span>
<span id="cb22-5"><a href="from-verbal-descriptions-to-formal-models.html#cb22-5" tabindex="-1"></a><span class="co"># Simulate an unbiased random agent (rate = 0.5)</span></span>
<span id="cb22-6"><a href="from-verbal-descriptions-to-formal-models.html#cb22-6" tabindex="-1"></a>rate_unbiased <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb22-7"><a href="from-verbal-descriptions-to-formal-models.html#cb22-7" tabindex="-1"></a>choices_unbiased <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> rate_unbiased)</span>
<span id="cb22-8"><a href="from-verbal-descriptions-to-formal-models.html#cb22-8" tabindex="-1"></a><span class="co"># rbinom generates random draws from a binomial distribution.</span></span>
<span id="cb22-9"><a href="from-verbal-descriptions-to-formal-models.html#cb22-9" tabindex="-1"></a><span class="co"># size = 1 makes it a Bernoulli trial (0 or 1 outcome).</span></span>
<span id="cb22-10"><a href="from-verbal-descriptions-to-formal-models.html#cb22-10" tabindex="-1"></a><span class="co"># prob = rate specifies the probability of getting a 1.</span></span>
<span id="cb22-11"><a href="from-verbal-descriptions-to-formal-models.html#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="from-verbal-descriptions-to-formal-models.html#cb22-12" tabindex="-1"></a><span class="co"># Simulate a biased random agent (rate = 0.8, chooses &#39;right&#39; 80% of the time)</span></span>
<span id="cb22-13"><a href="from-verbal-descriptions-to-formal-models.html#cb22-13" tabindex="-1"></a>rate_biased <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb22-14"><a href="from-verbal-descriptions-to-formal-models.html#cb22-14" tabindex="-1"></a>choices_biased <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> rate_biased)</span>
<span id="cb22-15"><a href="from-verbal-descriptions-to-formal-models.html#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="from-verbal-descriptions-to-formal-models.html#cb22-16" tabindex="-1"></a><span class="co"># --- Visualization 1: Raw Choices ---</span></span>
<span id="cb22-17"><a href="from-verbal-descriptions-to-formal-models.html#cb22-17" tabindex="-1"></a><span class="co"># Create data frames for plotting</span></span>
<span id="cb22-18"><a href="from-verbal-descriptions-to-formal-models.html#cb22-18" tabindex="-1"></a>d_unbiased <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials, <span class="at">choice =</span> choices_unbiased, <span class="at">rate =</span> rate_unbiased)</span>
<span id="cb22-19"><a href="from-verbal-descriptions-to-formal-models.html#cb22-19" tabindex="-1"></a>d_biased <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials, <span class="at">choice =</span> choices_biased, <span class="at">rate =</span> rate_biased)</span>
<span id="cb22-20"><a href="from-verbal-descriptions-to-formal-models.html#cb22-20" tabindex="-1"></a></span>
<span id="cb22-21"><a href="from-verbal-descriptions-to-formal-models.html#cb22-21" tabindex="-1"></a><span class="co"># Plot raw choice sequence (0s and 1s)</span></span>
<span id="cb22-22"><a href="from-verbal-descriptions-to-formal-models.html#cb22-22" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_unbiased, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> choice)) <span class="sc">+</span></span>
<span id="cb22-23"><a href="from-verbal-descriptions-to-formal-models.html#cb22-23" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-24"><a href="from-verbal-descriptions-to-formal-models.html#cb22-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unbiased Random Agent (Rate = 0.5)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb22-25"><a href="from-verbal-descriptions-to-formal-models.html#cb22-25" tabindex="-1"></a></span>
<span id="cb22-26"><a href="from-verbal-descriptions-to-formal-models.html#cb22-26" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_biased, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> choice)) <span class="sc">+</span></span>
<span id="cb22-27"><a href="from-verbal-descriptions-to-formal-models.html#cb22-27" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-28"><a href="from-verbal-descriptions-to-formal-models.html#cb22-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Biased Random Agent (Rate = 0.8)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb22-29"><a href="from-verbal-descriptions-to-formal-models.html#cb22-29" tabindex="-1"></a></span>
<span id="cb22-30"><a href="from-verbal-descriptions-to-formal-models.html#cb22-30" tabindex="-1"></a><span class="co"># Show plots side-by-side</span></span>
<span id="cb22-31"><a href="from-verbal-descriptions-to-formal-models.html#cb22-31" tabindex="-1"></a><span class="fu">print</span>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/03-implement-random-agent-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This first visualization shows the behavior of a purely random agent - one that chooses between options with equal probability (rate = 0.5). Looking at the jagged line jumping between 0 and 1, we can see that the agent’s choices appear truly random, with no discernible pattern. This represents what we might expect from a player who is deliberately trying to be unpredictable in the matching pennies game.
However, this raw choice plot can be hard to interpret. A more informative way to look at the agent’s behavior is to examine how its average rate of choosing option 1 evolves over time:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="from-verbal-descriptions-to-formal-models.html#cb23-1" tabindex="-1"></a><span class="co"># --- Visualization 2: Cumulative Rate ---</span></span>
<span id="cb23-2"><a href="from-verbal-descriptions-to-formal-models.html#cb23-2" tabindex="-1"></a><span class="co"># Calculate the cumulative proportion of &#39;right&#39; choices (1s)</span></span>
<span id="cb23-3"><a href="from-verbal-descriptions-to-formal-models.html#cb23-3" tabindex="-1"></a>d_unbiased <span class="ot">&lt;-</span> d_unbiased <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cumulative_rate =</span> <span class="fu">cumsum</span>(choice) <span class="sc">/</span> <span class="fu">row_number</span>())</span>
<span id="cb23-4"><a href="from-verbal-descriptions-to-formal-models.html#cb23-4" tabindex="-1"></a>d_biased <span class="ot">&lt;-</span> d_biased <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cumulative_rate =</span> <span class="fu">cumsum</span>(choice) <span class="sc">/</span> <span class="fu">row_number</span>())</span>
<span id="cb23-5"><a href="from-verbal-descriptions-to-formal-models.html#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="from-verbal-descriptions-to-formal-models.html#cb23-6" tabindex="-1"></a><span class="co"># Combine data for comparison plot</span></span>
<span id="cb23-7"><a href="from-verbal-descriptions-to-formal-models.html#cb23-7" tabindex="-1"></a>d_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(d_unbiased, d_biased) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="from-verbal-descriptions-to-formal-models.html#cb23-8" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Agent =</span> <span class="fu">paste</span>(<span class="st">&quot;Rate =&quot;</span>, rate))</span>
<span id="cb23-9"><a href="from-verbal-descriptions-to-formal-models.html#cb23-9" tabindex="-1"></a></span>
<span id="cb23-10"><a href="from-verbal-descriptions-to-formal-models.html#cb23-10" tabindex="-1"></a><span class="co"># Plot cumulative rates</span></span>
<span id="cb23-11"><a href="from-verbal-descriptions-to-formal-models.html#cb23-11" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_combined, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> cumulative_rate, <span class="at">color =</span> Agent)) <span class="sc">+</span></span>
<span id="cb23-12"><a href="from-verbal-descriptions-to-formal-models.html#cb23-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="from-verbal-descriptions-to-formal-models.html#cb23-13" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="co"># Reference line for 50%</span></span>
<span id="cb23-14"><a href="from-verbal-descriptions-to-formal-models.html#cb23-14" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="from-verbal-descriptions-to-formal-models.html#cb23-15" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-16"><a href="from-verbal-descriptions-to-formal-models.html#cb23-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Cumulative Choice Rate Over Time&quot;</span>,</span>
<span id="cb23-17"><a href="from-verbal-descriptions-to-formal-models.html#cb23-17" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Shows convergence towards the agent&#39;s underlying bias&quot;</span>,</span>
<span id="cb23-18"><a href="from-verbal-descriptions-to-formal-models.html#cb23-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb23-19"><a href="from-verbal-descriptions-to-formal-models.html#cb23-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative Proportion of Choosing &#39;Right&#39;&quot;</span>,</span>
<span id="cb23-20"><a href="from-verbal-descriptions-to-formal-models.html#cb23-20" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb23-21"><a href="from-verbal-descriptions-to-formal-models.html#cb23-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-22"><a href="from-verbal-descriptions-to-formal-models.html#cb23-22" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb23-23"><a href="from-verbal-descriptions-to-formal-models.html#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="from-verbal-descriptions-to-formal-models.html#cb23-24" tabindex="-1"></a><span class="fu">print</span>(p3)</span></code></pre></div>
<p><img src="series_files/figure-html/03%20cumulative%20viz-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>We can clearly see how bias affects choice behavior. The unbiased agent (rate = 0.5) stabilizes around choosing each option equally often, while the biased agent (rate = 0.8) shows a strong preference for option 1, choosing it approximately 80% of the time. This comparison helps us understand how we might detect biases in real players’ behavior - consistent deviation from 50-50 choice proportions could indicate an underlying preference or strategy.</p>
<div id="encapsulating-the-agent-in-a-function" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Encapsulating the Agent in a Function<a href="from-verbal-descriptions-to-formal-models.html#encapsulating-the-agent-in-a-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To make our agent reusable, we’ll wrap the logic in a function. This is good practice for building more complex simulations.</p>
<p>Note that the function is preceded by a number of commented lines. They are called Roxygen comments, a special documentation format used in R packages. By using these comments, we keep the code and its manual in the same place (and if you build a package, the format allows for automatically generating the help pages).</p>
<div id="how-to-read-it" class="section level4 hasAnchor" number="4.4.1.1">
<h4><span class="header-section-number">4.4.1.1</span> How to read it:<a href="from-verbal-descriptions-to-formal-models.html#how-to-read-it" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Description: The first lines describe what the function does.</p></li>
<li><p><span class="citation">(<a href="#ref-param"><strong>param?</strong></a>)</span>: Describes the inputs (arguments) the function expects (e.g., n_trials, rate).</p></li>
<li><p><span class="citation">(<a href="#ref-return"><strong>return?</strong></a>)</span>: Describes the output the function produces (e.g., a vector of 0s and 1s).</p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="from-verbal-descriptions-to-formal-models.html#cb24-1" tabindex="-1"></a><span class="co">#&#39; Random Agent Function</span></span>
<span id="cb24-2"><a href="from-verbal-descriptions-to-formal-models.html#cb24-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb24-3"><a href="from-verbal-descriptions-to-formal-models.html#cb24-3" tabindex="-1"></a><span class="co">#&#39; Generates a sequence of choices based on a fixed probability (rate).</span></span>
<span id="cb24-4"><a href="from-verbal-descriptions-to-formal-models.html#cb24-4" tabindex="-1"></a><span class="co">#&#39; Includes optional noise causing random 50/50 choices.</span></span>
<span id="cb24-5"><a href="from-verbal-descriptions-to-formal-models.html#cb24-5" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb24-6"><a href="from-verbal-descriptions-to-formal-models.html#cb24-6" tabindex="-1"></a><span class="co">#&#39; @param n_trials Integer, the number of choices to generate.</span></span>
<span id="cb24-7"><a href="from-verbal-descriptions-to-formal-models.html#cb24-7" tabindex="-1"></a><span class="co">#&#39; @param rate Numeric, the probability (0-1) of choosing option 1 (&#39;right&#39;).</span></span>
<span id="cb24-8"><a href="from-verbal-descriptions-to-formal-models.html#cb24-8" tabindex="-1"></a><span class="co">#&#39; @param noise Numeric, the probability (0-1) of making a random 50/50 choice</span></span>
<span id="cb24-9"><a href="from-verbal-descriptions-to-formal-models.html#cb24-9" tabindex="-1"></a><span class="co">#&#39;   instead of following the rate. Default is 0 (no noise).</span></span>
<span id="cb24-10"><a href="from-verbal-descriptions-to-formal-models.html#cb24-10" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb24-11"><a href="from-verbal-descriptions-to-formal-models.html#cb24-11" tabindex="-1"></a><span class="co">#&#39; @return A numeric vector of choices (0s and 1s).</span></span>
<span id="cb24-12"><a href="from-verbal-descriptions-to-formal-models.html#cb24-12" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb24-13"><a href="from-verbal-descriptions-to-formal-models.html#cb24-13" tabindex="-1"></a>RandomAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, <span class="at">rate =</span> <span class="fl">0.5</span>, <span class="at">noise =</span> <span class="dv">0</span>) {</span>
<span id="cb24-14"><a href="from-verbal-descriptions-to-formal-models.html#cb24-14" tabindex="-1"></a>  <span class="co"># Input validation</span></span>
<span id="cb24-15"><a href="from-verbal-descriptions-to-formal-models.html#cb24-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(rate) <span class="sc">||</span> rate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> rate <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb24-16"><a href="from-verbal-descriptions-to-formal-models.html#cb24-16" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Rate must be a probability between 0 and 1.&quot;</span>)</span>
<span id="cb24-17"><a href="from-verbal-descriptions-to-formal-models.html#cb24-17" tabindex="-1"></a>  }</span>
<span id="cb24-18"><a href="from-verbal-descriptions-to-formal-models.html#cb24-18" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(noise) <span class="sc">||</span> noise <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> noise <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb24-19"><a href="from-verbal-descriptions-to-formal-models.html#cb24-19" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Noise must be a probability between 0 and 1.&quot;</span>)</span>
<span id="cb24-20"><a href="from-verbal-descriptions-to-formal-models.html#cb24-20" tabindex="-1"></a>  }</span>
<span id="cb24-21"><a href="from-verbal-descriptions-to-formal-models.html#cb24-21" tabindex="-1"></a></span>
<span id="cb24-22"><a href="from-verbal-descriptions-to-formal-models.html#cb24-22" tabindex="-1"></a>  <span class="co"># Generate base choices according to the rate</span></span>
<span id="cb24-23"><a href="from-verbal-descriptions-to-formal-models.html#cb24-23" tabindex="-1"></a>  choices <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> rate)</span>
<span id="cb24-24"><a href="from-verbal-descriptions-to-formal-models.html#cb24-24" tabindex="-1"></a></span>
<span id="cb24-25"><a href="from-verbal-descriptions-to-formal-models.html#cb24-25" tabindex="-1"></a>  <span class="co"># Apply noise: identify trials where noise occurs</span></span>
<span id="cb24-26"><a href="from-verbal-descriptions-to-formal-models.html#cb24-26" tabindex="-1"></a>  noise_trials <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_trials, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> noise) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb24-27"><a href="from-verbal-descriptions-to-formal-models.html#cb24-27" tabindex="-1"></a></span>
<span id="cb24-28"><a href="from-verbal-descriptions-to-formal-models.html#cb24-28" tabindex="-1"></a>  <span class="co"># Replace choices with random 50/50 on noise trials</span></span>
<span id="cb24-29"><a href="from-verbal-descriptions-to-formal-models.html#cb24-29" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(noise_trials)) {</span>
<span id="cb24-30"><a href="from-verbal-descriptions-to-formal-models.html#cb24-30" tabindex="-1"></a>    choices[noise_trials] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">sum</span>(noise_trials), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb24-31"><a href="from-verbal-descriptions-to-formal-models.html#cb24-31" tabindex="-1"></a>  }</span>
<span id="cb24-32"><a href="from-verbal-descriptions-to-formal-models.html#cb24-32" tabindex="-1"></a></span>
<span id="cb24-33"><a href="from-verbal-descriptions-to-formal-models.html#cb24-33" tabindex="-1"></a>  <span class="fu">return</span>(choices)</span>
<span id="cb24-34"><a href="from-verbal-descriptions-to-formal-models.html#cb24-34" tabindex="-1"></a>}</span>
<span id="cb24-35"><a href="from-verbal-descriptions-to-formal-models.html#cb24-35" tabindex="-1"></a></span>
<span id="cb24-36"><a href="from-verbal-descriptions-to-formal-models.html#cb24-36" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb24-37"><a href="from-verbal-descriptions-to-formal-models.html#cb24-37" tabindex="-1"></a>example_choices <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="at">n_trials =</span> <span class="dv">10</span>, <span class="at">rate =</span> <span class="fl">0.7</span>, <span class="at">noise =</span> <span class="fl">0.1</span>)</span>
<span id="cb24-38"><a href="from-verbal-descriptions-to-formal-models.html#cb24-38" tabindex="-1"></a></span>
<span id="cb24-39"><a href="from-verbal-descriptions-to-formal-models.html#cb24-39" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Example choices (rate=0.7, noise=0.1):&quot;</span>, <span class="fu">paste</span>(example_choices, <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Example choices (rate=0.7, noise=0.1): 1 0 1 1 0 1 1 1 1 1&quot;</code></pre>
</div>
</div>
</div>
<div id="implementing-a-win-stay-lose-shift-wsls-agent" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Implementing a Win-Stay-Lose-Shift (WSLS) Agent<a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-wsls-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Random Agent was memoryless. The Win-Stay-Lose-Shift (WSLS) agent is our first step into <strong>strategic behavior</strong>: it reacts to the immediate past.</p>
<p><strong>Algorithm:</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Initialize:</strong> Make a random guess on the first trial.</p></li>
<li><p><strong>Loop (Trial <span class="math inline">\(t &gt; 1\)</span>):</strong></p>
<ul>
<li><p>Check feedback from trial <span class="math inline">\(t-1\)</span>.</p></li>
<li><p>If <strong>Win</strong>: Repeat the previous choice.</p></li>
<li><p>If <strong>Loss</strong>: Switch to the opposite choice.</p></li>
</ul></li>
<li><p><strong>Noise (The “Trembling Hand”):</strong> With a small probability <code>noise</code>, ignore the strategy and pick randomly. This accounts for attention lapses or motor errors (often called “trembling hand” in game theory).</p></li>
</ol>
<div id="implementing-the-wsls-function" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Implementing the WSLS Function<a href="from-verbal-descriptions-to-formal-models.html#implementing-the-wsls-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Note on Programming:</em> In R, we usually prefer vectorization (doing everything at once) over loops. However, many cognitive models are inherently <strong>sequential</strong>: what I do now depends on what I just saw. Therefore, we use an explicit <code>if/else</code> logic here to mirror the cognitive process.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="from-verbal-descriptions-to-formal-models.html#cb26-1" tabindex="-1"></a><span class="co">#&#39; Win-Stay-Lose-Shift Agent Function</span></span>
<span id="cb26-2"><a href="from-verbal-descriptions-to-formal-models.html#cb26-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb26-3"><a href="from-verbal-descriptions-to-formal-models.html#cb26-3" tabindex="-1"></a><span class="co">#&#39; Determines the next choice based on the previous choice and its outcome (feedback).</span></span>
<span id="cb26-4"><a href="from-verbal-descriptions-to-formal-models.html#cb26-4" tabindex="-1"></a><span class="co">#&#39; Includes optional noise.</span></span>
<span id="cb26-5"><a href="from-verbal-descriptions-to-formal-models.html#cb26-5" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb26-6"><a href="from-verbal-descriptions-to-formal-models.html#cb26-6" tabindex="-1"></a><span class="co">#&#39; @param prevChoice Numeric, the agent&#39;s choice on the previous trial (0 or 1).</span></span>
<span id="cb26-7"><a href="from-verbal-descriptions-to-formal-models.html#cb26-7" tabindex="-1"></a><span class="co">#&#39; @param feedback Numeric, the outcome of the previous trial (1 for win, 0 for loss).</span></span>
<span id="cb26-8"><a href="from-verbal-descriptions-to-formal-models.html#cb26-8" tabindex="-1"></a><span class="co">#&#39; @param noise Numeric, the probability (0-1) of making a random 50/50 choice. Default is 0.</span></span>
<span id="cb26-9"><a href="from-verbal-descriptions-to-formal-models.html#cb26-9" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb26-10"><a href="from-verbal-descriptions-to-formal-models.html#cb26-10" tabindex="-1"></a><span class="co">#&#39; @return Numeric, the agent&#39;s next choice (0 or 1).</span></span>
<span id="cb26-11"><a href="from-verbal-descriptions-to-formal-models.html#cb26-11" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb26-12"><a href="from-verbal-descriptions-to-formal-models.html#cb26-12" tabindex="-1"></a>WSLSAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, feedback, <span class="at">noise =</span> <span class="dv">0</span>) {</span>
<span id="cb26-13"><a href="from-verbal-descriptions-to-formal-models.html#cb26-13" tabindex="-1"></a>  <span class="co"># Input validation</span></span>
<span id="cb26-14"><a href="from-verbal-descriptions-to-formal-models.html#cb26-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>prevChoice <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">stop</span>(<span class="st">&quot;Previous choice must be 0 or 1.&quot;</span>)</span>
<span id="cb26-15"><a href="from-verbal-descriptions-to-formal-models.html#cb26-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>feedback <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">stop</span>(<span class="st">&quot;Feedback must be 0 or 1.&quot;</span>)</span>
<span id="cb26-16"><a href="from-verbal-descriptions-to-formal-models.html#cb26-16" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(noise) <span class="sc">||</span> noise <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> noise <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="fu">stop</span>(<span class="st">&quot;Noise must be a probability between 0 and 1.&quot;</span>)</span>
<span id="cb26-17"><a href="from-verbal-descriptions-to-formal-models.html#cb26-17" tabindex="-1"></a></span>
<span id="cb26-18"><a href="from-verbal-descriptions-to-formal-models.html#cb26-18" tabindex="-1"></a>  <span class="co"># Core WSLS logic:</span></span>
<span id="cb26-19"><a href="from-verbal-descriptions-to-formal-models.html#cb26-19" tabindex="-1"></a>  <span class="co"># If feedback is 1 (win), stay: choice = prevChoice</span></span>
<span id="cb26-20"><a href="from-verbal-descriptions-to-formal-models.html#cb26-20" tabindex="-1"></a>  <span class="co"># If feedback is 0 (loss), shift: choice = 1 - prevChoice</span></span>
<span id="cb26-21"><a href="from-verbal-descriptions-to-formal-models.html#cb26-21" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(feedback <span class="sc">==</span> <span class="dv">1</span>, prevChoice, <span class="dv">1</span> <span class="sc">-</span> prevChoice)</span>
<span id="cb26-22"><a href="from-verbal-descriptions-to-formal-models.html#cb26-22" tabindex="-1"></a></span>
<span id="cb26-23"><a href="from-verbal-descriptions-to-formal-models.html#cb26-23" tabindex="-1"></a>  <span class="co"># Apply noise if specified</span></span>
<span id="cb26-24"><a href="from-verbal-descriptions-to-formal-models.html#cb26-24" tabindex="-1"></a>  <span class="cf">if</span> (noise <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> noise) {</span>
<span id="cb26-25"><a href="from-verbal-descriptions-to-formal-models.html#cb26-25" tabindex="-1"></a>    <span class="co"># Override with a random 50/50 choice</span></span>
<span id="cb26-26"><a href="from-verbal-descriptions-to-formal-models.html#cb26-26" tabindex="-1"></a>    choice <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb26-27"><a href="from-verbal-descriptions-to-formal-models.html#cb26-27" tabindex="-1"></a>  }</span>
<span id="cb26-28"><a href="from-verbal-descriptions-to-formal-models.html#cb26-28" tabindex="-1"></a></span>
<span id="cb26-29"><a href="from-verbal-descriptions-to-formal-models.html#cb26-29" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb26-30"><a href="from-verbal-descriptions-to-formal-models.html#cb26-30" tabindex="-1"></a>}</span>
<span id="cb26-31"><a href="from-verbal-descriptions-to-formal-models.html#cb26-31" tabindex="-1"></a></span>
<span id="cb26-32"><a href="from-verbal-descriptions-to-formal-models.html#cb26-32" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb26-33"><a href="from-verbal-descriptions-to-formal-models.html#cb26-33" tabindex="-1"></a><span class="co"># Won previous trial (feedback=1) after choosing 1:</span></span>
<span id="cb26-34"><a href="from-verbal-descriptions-to-formal-models.html#cb26-34" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Next choice after win (chose 1):&quot;</span>, <span class="fu">WSLSAgent_f</span>(<span class="at">prevChoice =</span> <span class="dv">1</span>, <span class="at">feedback =</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Next choice after win (chose 1): 1&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="from-verbal-descriptions-to-formal-models.html#cb28-1" tabindex="-1"></a><span class="co"># Lost previous trial (feedback=0) after choosing 1:</span></span>
<span id="cb28-2"><a href="from-verbal-descriptions-to-formal-models.html#cb28-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Next choice after loss (chose 1):&quot;</span>, <span class="fu">WSLSAgent_f</span>(<span class="at">prevChoice =</span> <span class="dv">1</span>, <span class="at">feedback =</span> <span class="dv">0</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Next choice after loss (chose 1): 0&quot;</code></pre>
</div>
<div id="simulating-wsls-vs.-opponents" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Simulating WSLS vs. Opponents<a href="from-verbal-descriptions-to-formal-models.html#simulating-wsls-vs.-opponents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, let’s simulate our WSLS agent playing against different opponents to see how it performs.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="from-verbal-descriptions-to-formal-models.html#cb30-1" tabindex="-1"></a><span class="co"># --- Simulation Setup ---</span></span>
<span id="cb30-2"><a href="from-verbal-descriptions-to-formal-models.html#cb30-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb30-3"><a href="from-verbal-descriptions-to-formal-models.html#cb30-3" tabindex="-1"></a></span>
<span id="cb30-4"><a href="from-verbal-descriptions-to-formal-models.html#cb30-4" tabindex="-1"></a><span class="co"># --- Simulation 1: WSLS vs. Biased Random Agent ---</span></span>
<span id="cb30-5"><a href="from-verbal-descriptions-to-formal-models.html#cb30-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simulating WSLS vs. Biased Random (Rate = 0.8)...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simulating WSLS vs. Biased Random (Rate = 0.8)...</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="from-verbal-descriptions-to-formal-models.html#cb32-1" tabindex="-1"></a><span class="co"># Opponent always chooses &#39;right&#39; with 80% probability</span></span>
<span id="cb32-2"><a href="from-verbal-descriptions-to-formal-models.html#cb32-2" tabindex="-1"></a>opponent_choices_biased <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="at">n_trials =</span> trials, <span class="at">rate =</span> <span class="fl">0.8</span>, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb32-3"><a href="from-verbal-descriptions-to-formal-models.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="from-verbal-descriptions-to-formal-models.html#cb32-4" tabindex="-1"></a><span class="co"># Initialize vectors for WSLS agent</span></span>
<span id="cb32-5"><a href="from-verbal-descriptions-to-formal-models.html#cb32-5" tabindex="-1"></a>wsls_choices_vs_biased <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb32-6"><a href="from-verbal-descriptions-to-formal-models.html#cb32-6" tabindex="-1"></a>feedback_vs_biased <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb32-7"><a href="from-verbal-descriptions-to-formal-models.html#cb32-7" tabindex="-1"></a></span>
<span id="cb32-8"><a href="from-verbal-descriptions-to-formal-models.html#cb32-8" tabindex="-1"></a><span class="co"># First choice is random</span></span>
<span id="cb32-9"><a href="from-verbal-descriptions-to-formal-models.html#cb32-9" tabindex="-1"></a>wsls_choices_vs_biased[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb32-10"><a href="from-verbal-descriptions-to-formal-models.html#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="from-verbal-descriptions-to-formal-models.html#cb32-11" tabindex="-1"></a><span class="co"># Simulation loop</span></span>
<span id="cb32-12"><a href="from-verbal-descriptions-to-formal-models.html#cb32-12" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb32-13"><a href="from-verbal-descriptions-to-formal-models.html#cb32-13" tabindex="-1"></a>  <span class="co"># Determine feedback from previous trial (WSLS wins if choices match opponent)</span></span>
<span id="cb32-14"><a href="from-verbal-descriptions-to-formal-models.html#cb32-14" tabindex="-1"></a>  <span class="co"># Note: In Matching Pennies, win condition depends on role (Matcher/Hider).</span></span>
<span id="cb32-15"><a href="from-verbal-descriptions-to-formal-models.html#cb32-15" tabindex="-1"></a>  <span class="co"># Here we assume the WSLS agent is the &#39;Matcher&#39; for simplicity.</span></span>
<span id="cb32-16"><a href="from-verbal-descriptions-to-formal-models.html#cb32-16" tabindex="-1"></a>  prev_feedback <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls_choices_vs_biased[t <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> opponent_choices_biased[t <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-17"><a href="from-verbal-descriptions-to-formal-models.html#cb32-17" tabindex="-1"></a>  feedback_vs_biased[t <span class="sc">-</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> prev_feedback <span class="co"># Store feedback for analysis</span></span>
<span id="cb32-18"><a href="from-verbal-descriptions-to-formal-models.html#cb32-18" tabindex="-1"></a></span>
<span id="cb32-19"><a href="from-verbal-descriptions-to-formal-models.html#cb32-19" tabindex="-1"></a>  <span class="co"># WSLS agent makes choice based on previous feedback</span></span>
<span id="cb32-20"><a href="from-verbal-descriptions-to-formal-models.html#cb32-20" tabindex="-1"></a>  wsls_choices_vs_biased[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(</span>
<span id="cb32-21"><a href="from-verbal-descriptions-to-formal-models.html#cb32-21" tabindex="-1"></a>    <span class="at">prevChoice =</span> wsls_choices_vs_biased[t <span class="sc">-</span> <span class="dv">1</span>],</span>
<span id="cb32-22"><a href="from-verbal-descriptions-to-formal-models.html#cb32-22" tabindex="-1"></a>    <span class="at">feedback =</span> prev_feedback,</span>
<span id="cb32-23"><a href="from-verbal-descriptions-to-formal-models.html#cb32-23" tabindex="-1"></a>    <span class="at">noise =</span> <span class="dv">0</span> <span class="co"># Assuming no noise for this simulation</span></span>
<span id="cb32-24"><a href="from-verbal-descriptions-to-formal-models.html#cb32-24" tabindex="-1"></a>  )</span>
<span id="cb32-25"><a href="from-verbal-descriptions-to-formal-models.html#cb32-25" tabindex="-1"></a>}</span>
<span id="cb32-26"><a href="from-verbal-descriptions-to-formal-models.html#cb32-26" tabindex="-1"></a><span class="co"># Record feedback for the last trial</span></span>
<span id="cb32-27"><a href="from-verbal-descriptions-to-formal-models.html#cb32-27" tabindex="-1"></a>feedback_vs_biased[trials] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls_choices_vs_biased[trials] <span class="sc">==</span> opponent_choices_biased[trials], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-28"><a href="from-verbal-descriptions-to-formal-models.html#cb32-28" tabindex="-1"></a></span>
<span id="cb32-29"><a href="from-verbal-descriptions-to-formal-models.html#cb32-29" tabindex="-1"></a><span class="co"># Create dataframe for analysis</span></span>
<span id="cb32-30"><a href="from-verbal-descriptions-to-formal-models.html#cb32-30" tabindex="-1"></a>df_vs_biased <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb32-31"><a href="from-verbal-descriptions-to-formal-models.html#cb32-31" tabindex="-1"></a>  <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials,</span>
<span id="cb32-32"><a href="from-verbal-descriptions-to-formal-models.html#cb32-32" tabindex="-1"></a>  <span class="at">Self_WSLS =</span> wsls_choices_vs_biased,</span>
<span id="cb32-33"><a href="from-verbal-descriptions-to-formal-models.html#cb32-33" tabindex="-1"></a>  <span class="at">Opponent_Random =</span> opponent_choices_biased,</span>
<span id="cb32-34"><a href="from-verbal-descriptions-to-formal-models.html#cb32-34" tabindex="-1"></a>  <span class="at">Feedback =</span> feedback_vs_biased <span class="co"># 1 if WSLS won</span></span>
<span id="cb32-35"><a href="from-verbal-descriptions-to-formal-models.html#cb32-35" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb32-36"><a href="from-verbal-descriptions-to-formal-models.html#cb32-36" tabindex="-1"></a>  <span class="at">Cumulative_Performance =</span> <span class="fu">cumsum</span>(Feedback) <span class="sc">/</span> <span class="fu">row_number</span>()</span>
<span id="cb32-37"><a href="from-verbal-descriptions-to-formal-models.html#cb32-37" tabindex="-1"></a>)</span>
<span id="cb32-38"><a href="from-verbal-descriptions-to-formal-models.html#cb32-38" tabindex="-1"></a></span>
<span id="cb32-39"><a href="from-verbal-descriptions-to-formal-models.html#cb32-39" tabindex="-1"></a><span class="co"># --- Simulation 2: WSLS vs. WSLS ---</span></span>
<span id="cb32-40"><a href="from-verbal-descriptions-to-formal-models.html#cb32-40" tabindex="-1"></a><span class="co"># (Opponent plays WSLS but tries to mismatch - feedback is inverted)</span></span>
<span id="cb32-41"><a href="from-verbal-descriptions-to-formal-models.html#cb32-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simulating WSLS vs. WSLS...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simulating WSLS vs. WSLS...</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="from-verbal-descriptions-to-formal-models.html#cb34-1" tabindex="-1"></a>wsls1_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb34-2"><a href="from-verbal-descriptions-to-formal-models.html#cb34-2" tabindex="-1"></a>wsls2_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb34-3"><a href="from-verbal-descriptions-to-formal-models.html#cb34-3" tabindex="-1"></a>feedback_wsls1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials) <span class="co"># Feedback for agent 1</span></span>
<span id="cb34-4"><a href="from-verbal-descriptions-to-formal-models.html#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="from-verbal-descriptions-to-formal-models.html#cb34-5" tabindex="-1"></a>wsls1_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb34-6"><a href="from-verbal-descriptions-to-formal-models.html#cb34-6" tabindex="-1"></a>wsls2_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb34-7"><a href="from-verbal-descriptions-to-formal-models.html#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a href="from-verbal-descriptions-to-formal-models.html#cb34-8" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb34-9"><a href="from-verbal-descriptions-to-formal-models.html#cb34-9" tabindex="-1"></a>  <span class="co"># Feedback for agent 1 from previous trial (wins if match)</span></span>
<span id="cb34-10"><a href="from-verbal-descriptions-to-formal-models.html#cb34-10" tabindex="-1"></a>  prev_feedback1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls1_choices[t <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> wsls2_choices[t <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb34-11"><a href="from-verbal-descriptions-to-formal-models.html#cb34-11" tabindex="-1"></a>  feedback_wsls1[t <span class="sc">-</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> prev_feedback1</span>
<span id="cb34-12"><a href="from-verbal-descriptions-to-formal-models.html#cb34-12" tabindex="-1"></a></span>
<span id="cb34-13"><a href="from-verbal-descriptions-to-formal-models.html#cb34-13" tabindex="-1"></a>  <span class="co"># Feedback for agent 2 (opponent) is the opposite (wins if mismatch)</span></span>
<span id="cb34-14"><a href="from-verbal-descriptions-to-formal-models.html#cb34-14" tabindex="-1"></a>  prev_feedback2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> prev_feedback1</span>
<span id="cb34-15"><a href="from-verbal-descriptions-to-formal-models.html#cb34-15" tabindex="-1"></a></span>
<span id="cb34-16"><a href="from-verbal-descriptions-to-formal-models.html#cb34-16" tabindex="-1"></a>  <span class="co"># Both agents choose based on their own previous feedback</span></span>
<span id="cb34-17"><a href="from-verbal-descriptions-to-formal-models.html#cb34-17" tabindex="-1"></a>  wsls1_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(wsls1_choices[t <span class="sc">-</span> <span class="dv">1</span>], prev_feedback1, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb34-18"><a href="from-verbal-descriptions-to-formal-models.html#cb34-18" tabindex="-1"></a>  wsls2_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(wsls2_choices[t <span class="sc">-</span> <span class="dv">1</span>], prev_feedback2, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb34-19"><a href="from-verbal-descriptions-to-formal-models.html#cb34-19" tabindex="-1"></a>}</span>
<span id="cb34-20"><a href="from-verbal-descriptions-to-formal-models.html#cb34-20" tabindex="-1"></a>feedback_wsls1[trials] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wsls1_choices[trials] <span class="sc">==</span> wsls2_choices[trials], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb34-21"><a href="from-verbal-descriptions-to-formal-models.html#cb34-21" tabindex="-1"></a></span>
<span id="cb34-22"><a href="from-verbal-descriptions-to-formal-models.html#cb34-22" tabindex="-1"></a><span class="co"># Create dataframe</span></span>
<span id="cb34-23"><a href="from-verbal-descriptions-to-formal-models.html#cb34-23" tabindex="-1"></a>df_vs_wsls <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-24"><a href="from-verbal-descriptions-to-formal-models.html#cb34-24" tabindex="-1"></a>  <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>trials,</span>
<span id="cb34-25"><a href="from-verbal-descriptions-to-formal-models.html#cb34-25" tabindex="-1"></a>  <span class="at">Self_WSLS =</span> wsls1_choices,</span>
<span id="cb34-26"><a href="from-verbal-descriptions-to-formal-models.html#cb34-26" tabindex="-1"></a>  <span class="at">Opponent_WSLS =</span> wsls2_choices,</span>
<span id="cb34-27"><a href="from-verbal-descriptions-to-formal-models.html#cb34-27" tabindex="-1"></a>  <span class="at">Feedback =</span> feedback_wsls1 <span class="co"># 1 if Self_WSLS won</span></span>
<span id="cb34-28"><a href="from-verbal-descriptions-to-formal-models.html#cb34-28" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb34-29"><a href="from-verbal-descriptions-to-formal-models.html#cb34-29" tabindex="-1"></a>  <span class="at">Cumulative_Performance =</span> <span class="fu">cumsum</span>(Feedback) <span class="sc">/</span> <span class="fu">row_number</span>()</span>
<span id="cb34-30"><a href="from-verbal-descriptions-to-formal-models.html#cb34-30" tabindex="-1"></a>)</span>
<span id="cb34-31"><a href="from-verbal-descriptions-to-formal-models.html#cb34-31" tabindex="-1"></a></span>
<span id="cb34-32"><a href="from-verbal-descriptions-to-formal-models.html#cb34-32" tabindex="-1"></a><span class="co"># --- Visualize Simulation Results ---</span></span>
<span id="cb34-33"><a href="from-verbal-descriptions-to-formal-models.html#cb34-33" tabindex="-1"></a><span class="co"># Plot choices over time</span></span>
<span id="cb34-34"><a href="from-verbal-descriptions-to-formal-models.html#cb34-34" tabindex="-1"></a>p_choices_biased <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_biased, <span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb34-35"><a href="from-verbal-descriptions-to-formal-models.html#cb34-35" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Self_WSLS, <span class="at">color =</span> <span class="st">&quot;WSLS Agent&quot;</span>)) <span class="sc">+</span></span>
<span id="cb34-36"><a href="from-verbal-descriptions-to-formal-models.html#cb34-36" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Opponent_Random <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">&quot;Biased Opponent&quot;</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="co"># Offset slightly</span></span>
<span id="cb34-37"><a href="from-verbal-descriptions-to-formal-models.html#cb34-37" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS vs. Biased Random&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb34-38"><a href="from-verbal-descriptions-to-formal-models.html#cb34-38" tabindex="-1"></a></span>
<span id="cb34-39"><a href="from-verbal-descriptions-to-formal-models.html#cb34-39" tabindex="-1"></a>p_choices_wsls <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_wsls, <span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb34-40"><a href="from-verbal-descriptions-to-formal-models.html#cb34-40" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Self_WSLS, <span class="at">color =</span> <span class="st">&quot;WSLS Agent 1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb34-41"><a href="from-verbal-descriptions-to-formal-models.html#cb34-41" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Opponent_WSLS <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">&quot;WSLS Agent 2&quot;</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="co"># Offset slightly</span></span>
<span id="cb34-42"><a href="from-verbal-descriptions-to-formal-models.html#cb34-42" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS vs. WSLS&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb34-43"><a href="from-verbal-descriptions-to-formal-models.html#cb34-43" tabindex="-1"></a></span>
<span id="cb34-44"><a href="from-verbal-descriptions-to-formal-models.html#cb34-44" tabindex="-1"></a><span class="co"># Plot cumulative performance</span></span>
<span id="cb34-45"><a href="from-verbal-descriptions-to-formal-models.html#cb34-45" tabindex="-1"></a>p_perf_biased <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_biased, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> Cumulative_Performance)) <span class="sc">+</span></span>
<span id="cb34-46"><a href="from-verbal-descriptions-to-formal-models.html#cb34-46" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-47"><a href="from-verbal-descriptions-to-formal-models.html#cb34-47" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS Performance vs. Biased Random&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Proportion Wins&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-48"><a href="from-verbal-descriptions-to-formal-models.html#cb34-48" tabindex="-1"></a></span>
<span id="cb34-49"><a href="from-verbal-descriptions-to-formal-models.html#cb34-49" tabindex="-1"></a>p_perf_wsls <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_vs_wsls, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> Cumulative_Performance)) <span class="sc">+</span></span>
<span id="cb34-50"><a href="from-verbal-descriptions-to-formal-models.html#cb34-50" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-51"><a href="from-verbal-descriptions-to-formal-models.html#cb34-51" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WSLS Performance vs. WSLS&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Proportion Wins&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-52"><a href="from-verbal-descriptions-to-formal-models.html#cb34-52" tabindex="-1"></a></span>
<span id="cb34-53"><a href="from-verbal-descriptions-to-formal-models.html#cb34-53" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb34-54"><a href="from-verbal-descriptions-to-formal-models.html#cb34-54" tabindex="-1"></a><span class="fu">print</span>((p_choices_biased <span class="sc">|</span> p_choices_wsls) <span class="sc">/</span> (p_perf_biased <span class="sc">|</span> p_perf_wsls) <span class="sc">+</span></span>
<span id="cb34-55"><a href="from-verbal-descriptions-to-formal-models.html#cb34-55" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/03%20Win-Stay-Lose-Shift%20vs%20biased%20agent-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This cumulative performance plot reveals the overall effectiveness of the WSLS strategy. By tracking the running average of successes, we can see whether the strategy leads to above-chance performance in the long run. When playing against a biased random opponent, the WSLS agent can potentially exploit the opponent’s predictable tendencies, though success depends on how strong and consistent the opponent’s bias is.
When we pit the WSLS agent against another WSLS agent, the dynamics become more complex. Both agents are now trying to adapt to each other’s adaptations, creating a more sophisticated strategic interaction. The resulting behavior often shows interesting patterns of mutual adaptation, where each agent’s attempts to exploit the other’s strategy leads to evolving patterns of play.</p>
</div>
</div>
<div id="scaling-up-the-virtual-experiment" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Scaling Up: The Virtual Experiment<a href="from-verbal-descriptions-to-formal-models.html#scaling-up-the-virtual-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have our agents defined as functions, we can run <strong>virtual Experiments</strong>, to better understand our models.</p>
<p>We will build a “Simulation Engine” function that:</p>
<ol style="list-style-type: decimal">
<li><p>Takes two agents (e.g., WSLS vs. Random).</p></li>
<li><p>Makes them play for <code>N</code> trials.</p></li>
<li><p>Records every move.</p></li>
</ol>
<p>To understand the average behavior and robustness of the WSLS strategy, we need to simulate many agents playing against opponents with varying biases.</p>
<p>First, let’s create a function that runs one simulation (one WSLS agent vs. one opponent) and returns the results. This avoids repeating code.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="from-verbal-descriptions-to-formal-models.html#cb35-1" tabindex="-1"></a><span class="co">#&#39; Run Matching Pennies Simulation</span></span>
<span id="cb35-2"><a href="from-verbal-descriptions-to-formal-models.html#cb35-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb35-3"><a href="from-verbal-descriptions-to-formal-models.html#cb35-3" tabindex="-1"></a><span class="co">#&#39; Simulates a full game between an Agent (Subject) and an Opponent.</span></span>
<span id="cb35-4"><a href="from-verbal-descriptions-to-formal-models.html#cb35-4" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb35-5"><a href="from-verbal-descriptions-to-formal-models.html#cb35-5" tabindex="-1"></a><span class="co">#&#39; @param n_trials Integer, number of trials.</span></span>
<span id="cb35-6"><a href="from-verbal-descriptions-to-formal-models.html#cb35-6" tabindex="-1"></a><span class="co">#&#39; @param agent_strategy String, &quot;WSLS&quot; or &quot;Random&quot;.</span></span>
<span id="cb35-7"><a href="from-verbal-descriptions-to-formal-models.html#cb35-7" tabindex="-1"></a><span class="co">#&#39; @param agent_params List, parameters for the agent (e.g., list(noise=0.1)).</span></span>
<span id="cb35-8"><a href="from-verbal-descriptions-to-formal-models.html#cb35-8" tabindex="-1"></a><span class="co">#&#39; @param opponent_strategy String, &quot;WSLS&quot; or &quot;Random&quot;.</span></span>
<span id="cb35-9"><a href="from-verbal-descriptions-to-formal-models.html#cb35-9" tabindex="-1"></a><span class="co">#&#39; @param opponent_params List, parameters for the opponent (e.g., list(rate=0.8)).</span></span>
<span id="cb35-10"><a href="from-verbal-descriptions-to-formal-models.html#cb35-10" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb35-11"><a href="from-verbal-descriptions-to-formal-models.html#cb35-11" tabindex="-1"></a><span class="co">#&#39; @return A tibble with trial-by-trial choices and outcomes.</span></span>
<span id="cb35-12"><a href="from-verbal-descriptions-to-formal-models.html#cb35-12" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb35-13"><a href="from-verbal-descriptions-to-formal-models.html#cb35-13" tabindex="-1"></a>run_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, agent_strategy, agent_params, opponent_strategy, opponent_params) {</span>
<span id="cb35-14"><a href="from-verbal-descriptions-to-formal-models.html#cb35-14" tabindex="-1"></a></span>
<span id="cb35-15"><a href="from-verbal-descriptions-to-formal-models.html#cb35-15" tabindex="-1"></a>  <span class="co"># Pre-allocate vectors for speed</span></span>
<span id="cb35-16"><a href="from-verbal-descriptions-to-formal-models.html#cb35-16" tabindex="-1"></a>  agent_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_trials)</span>
<span id="cb35-17"><a href="from-verbal-descriptions-to-formal-models.html#cb35-17" tabindex="-1"></a>  opponent_choices <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_trials)</span>
<span id="cb35-18"><a href="from-verbal-descriptions-to-formal-models.html#cb35-18" tabindex="-1"></a>  agent_feedback <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_trials) </span>
<span id="cb35-19"><a href="from-verbal-descriptions-to-formal-models.html#cb35-19" tabindex="-1"></a></span>
<span id="cb35-20"><a href="from-verbal-descriptions-to-formal-models.html#cb35-20" tabindex="-1"></a>  <span class="co"># --- Trial 1 (Initialization) ---</span></span>
<span id="cb35-21"><a href="from-verbal-descriptions-to-formal-models.html#cb35-21" tabindex="-1"></a>  <span class="co"># Agents behave randomly or use a specific start bias on trial 1</span></span>
<span id="cb35-22"><a href="from-verbal-descriptions-to-formal-models.html#cb35-22" tabindex="-1"></a>  agent_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb35-23"><a href="from-verbal-descriptions-to-formal-models.html#cb35-23" tabindex="-1"></a>  opponent_choices[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb35-24"><a href="from-verbal-descriptions-to-formal-models.html#cb35-24" tabindex="-1"></a>  </span>
<span id="cb35-25"><a href="from-verbal-descriptions-to-formal-models.html#cb35-25" tabindex="-1"></a>  <span class="co"># Check winner (Assuming Agent is Matcher: Win if choices match)</span></span>
<span id="cb35-26"><a href="from-verbal-descriptions-to-formal-models.html#cb35-26" tabindex="-1"></a>  agent_feedback[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(agent_choices[<span class="dv">1</span>] <span class="sc">==</span> opponent_choices[<span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-27"><a href="from-verbal-descriptions-to-formal-models.html#cb35-27" tabindex="-1"></a></span>
<span id="cb35-28"><a href="from-verbal-descriptions-to-formal-models.html#cb35-28" tabindex="-1"></a>  <span class="co"># --- Loop through Game ---</span></span>
<span id="cb35-29"><a href="from-verbal-descriptions-to-formal-models.html#cb35-29" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_trials) {</span>
<span id="cb35-30"><a href="from-verbal-descriptions-to-formal-models.html#cb35-30" tabindex="-1"></a>    </span>
<span id="cb35-31"><a href="from-verbal-descriptions-to-formal-models.html#cb35-31" tabindex="-1"></a>    <span class="co"># 1. Agent makes a choice based on history (t-1)</span></span>
<span id="cb35-32"><a href="from-verbal-descriptions-to-formal-models.html#cb35-32" tabindex="-1"></a>    <span class="cf">if</span> (agent_strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>) {</span>
<span id="cb35-33"><a href="from-verbal-descriptions-to-formal-models.html#cb35-33" tabindex="-1"></a>      agent_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(agent_choices[t<span class="dv">-1</span>], agent_feedback[t<span class="dv">-1</span>], agent_params<span class="sc">$</span>noise)</span>
<span id="cb35-34"><a href="from-verbal-descriptions-to-formal-models.html#cb35-34" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (agent_strategy <span class="sc">==</span> <span class="st">&quot;Random&quot;</span>) {</span>
<span id="cb35-35"><a href="from-verbal-descriptions-to-formal-models.html#cb35-35" tabindex="-1"></a>      agent_choices[t] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, agent_params<span class="sc">$</span>rate, agent_params<span class="sc">$</span>noise)</span>
<span id="cb35-36"><a href="from-verbal-descriptions-to-formal-models.html#cb35-36" tabindex="-1"></a>    }</span>
<span id="cb35-37"><a href="from-verbal-descriptions-to-formal-models.html#cb35-37" tabindex="-1"></a>    </span>
<span id="cb35-38"><a href="from-verbal-descriptions-to-formal-models.html#cb35-38" tabindex="-1"></a>    <span class="co"># 2. Opponent makes a choice</span></span>
<span id="cb35-39"><a href="from-verbal-descriptions-to-formal-models.html#cb35-39" tabindex="-1"></a>    <span class="cf">if</span> (opponent_strategy <span class="sc">==</span> <span class="st">&quot;Random&quot;</span>) {</span>
<span id="cb35-40"><a href="from-verbal-descriptions-to-formal-models.html#cb35-40" tabindex="-1"></a>      opponent_choices[t] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, opponent_params<span class="sc">$</span>rate, opponent_params<span class="sc">$</span>noise)</span>
<span id="cb35-41"><a href="from-verbal-descriptions-to-formal-models.html#cb35-41" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (opponent_strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>) {</span>
<span id="cb35-42"><a href="from-verbal-descriptions-to-formal-models.html#cb35-42" tabindex="-1"></a>      <span class="co"># Opponent is Hider: They win if choices MISMATCH. </span></span>
<span id="cb35-43"><a href="from-verbal-descriptions-to-formal-models.html#cb35-43" tabindex="-1"></a>      <span class="co"># So their feedback is the opposite of the Agent&#39;s feedback.</span></span>
<span id="cb35-44"><a href="from-verbal-descriptions-to-formal-models.html#cb35-44" tabindex="-1"></a>      op_feedback <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> agent_feedback[t<span class="dv">-1</span>]</span>
<span id="cb35-45"><a href="from-verbal-descriptions-to-formal-models.html#cb35-45" tabindex="-1"></a>      opponent_choices[t] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(opponent_choices[t<span class="dv">-1</span>], op_feedback, opponent_params<span class="sc">$</span>noise)</span>
<span id="cb35-46"><a href="from-verbal-descriptions-to-formal-models.html#cb35-46" tabindex="-1"></a>    }</span>
<span id="cb35-47"><a href="from-verbal-descriptions-to-formal-models.html#cb35-47" tabindex="-1"></a></span>
<span id="cb35-48"><a href="from-verbal-descriptions-to-formal-models.html#cb35-48" tabindex="-1"></a>    <span class="co"># 3. Determine Outcome</span></span>
<span id="cb35-49"><a href="from-verbal-descriptions-to-formal-models.html#cb35-49" tabindex="-1"></a>    agent_feedback[t] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(agent_choices[t] <span class="sc">==</span> opponent_choices[t], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-50"><a href="from-verbal-descriptions-to-formal-models.html#cb35-50" tabindex="-1"></a>  }</span>
<span id="cb35-51"><a href="from-verbal-descriptions-to-formal-models.html#cb35-51" tabindex="-1"></a></span>
<span id="cb35-52"><a href="from-verbal-descriptions-to-formal-models.html#cb35-52" tabindex="-1"></a>  <span class="co"># Return data</span></span>
<span id="cb35-53"><a href="from-verbal-descriptions-to-formal-models.html#cb35-53" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">tibble</span>(</span>
<span id="cb35-54"><a href="from-verbal-descriptions-to-formal-models.html#cb35-54" tabindex="-1"></a>    <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>n_trials,</span>
<span id="cb35-55"><a href="from-verbal-descriptions-to-formal-models.html#cb35-55" tabindex="-1"></a>    <span class="at">choice =</span> agent_choices,</span>
<span id="cb35-56"><a href="from-verbal-descriptions-to-formal-models.html#cb35-56" tabindex="-1"></a>    <span class="at">opponent =</span> opponent_choices,</span>
<span id="cb35-57"><a href="from-verbal-descriptions-to-formal-models.html#cb35-57" tabindex="-1"></a>    <span class="at">win =</span> agent_feedback</span>
<span id="cb35-58"><a href="from-verbal-descriptions-to-formal-models.html#cb35-58" tabindex="-1"></a>  ))</span>
<span id="cb35-59"><a href="from-verbal-descriptions-to-formal-models.html#cb35-59" tabindex="-1"></a>}</span>
<span id="cb35-60"><a href="from-verbal-descriptions-to-formal-models.html#cb35-60" tabindex="-1"></a></span>
<span id="cb35-61"><a href="from-verbal-descriptions-to-formal-models.html#cb35-61" tabindex="-1"></a><span class="co"># --- Running Scaled Simulations ---</span></span>
<span id="cb35-62"><a href="from-verbal-descriptions-to-formal-models.html#cb35-62" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Running scaled simulations...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Running scaled simulations...</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="from-verbal-descriptions-to-formal-models.html#cb37-1" tabindex="-1"></a><span class="co"># Default WSLS parameters (Only &#39;noise&#39; is used by our simple WSLS agent)</span></span>
<span id="cb37-2"><a href="from-verbal-descriptions-to-formal-models.html#cb37-2" tabindex="-1"></a>wsls_params_default <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb37-3"><a href="from-verbal-descriptions-to-formal-models.html#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="from-verbal-descriptions-to-formal-models.html#cb37-4" tabindex="-1"></a><span class="co"># Simulation 1: WSLS vs. Random agents with varying biases</span></span>
<span id="cb37-5"><a href="from-verbal-descriptions-to-formal-models.html#cb37-5" tabindex="-1"></a>opponent_rates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.5</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb37-6"><a href="from-verbal-descriptions-to-formal-models.html#cb37-6" tabindex="-1"></a>results_vs_random <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb37-7"><a href="from-verbal-descriptions-to-formal-models.html#cb37-7" tabindex="-1"></a></span>
<span id="cb37-8"><a href="from-verbal-descriptions-to-formal-models.html#cb37-8" tabindex="-1"></a><span class="cf">for</span> (rate <span class="cf">in</span> opponent_rates) {</span>
<span id="cb37-9"><a href="from-verbal-descriptions-to-formal-models.html#cb37-9" tabindex="-1"></a>  <span class="co"># Create a list to store runs for this specific rate</span></span>
<span id="cb37-10"><a href="from-verbal-descriptions-to-formal-models.html#cb37-10" tabindex="-1"></a>  rate_runs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb37-11"><a href="from-verbal-descriptions-to-formal-models.html#cb37-11" tabindex="-1"></a>  </span>
<span id="cb37-12"><a href="from-verbal-descriptions-to-formal-models.html#cb37-12" tabindex="-1"></a>  <span class="cf">for</span> (agent_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb37-13"><a href="from-verbal-descriptions-to-formal-models.html#cb37-13" tabindex="-1"></a>     opponent_params_rand <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">rate =</span> rate, <span class="at">noise =</span> <span class="dv">0</span>)</span>
<span id="cb37-14"><a href="from-verbal-descriptions-to-formal-models.html#cb37-14" tabindex="-1"></a>     </span>
<span id="cb37-15"><a href="from-verbal-descriptions-to-formal-models.html#cb37-15" tabindex="-1"></a>     <span class="co"># CORRECTED CALL: Added &quot;WSLS&quot; as the second argument</span></span>
<span id="cb37-16"><a href="from-verbal-descriptions-to-formal-models.html#cb37-16" tabindex="-1"></a>     sim_run <span class="ot">&lt;-</span> <span class="fu">run_simulation</span>(trials, <span class="st">&quot;WSLS&quot;</span>, wsls_params_default, <span class="st">&quot;Random&quot;</span>, opponent_params_rand)</span>
<span id="cb37-17"><a href="from-verbal-descriptions-to-formal-models.html#cb37-17" tabindex="-1"></a>     </span>
<span id="cb37-18"><a href="from-verbal-descriptions-to-formal-models.html#cb37-18" tabindex="-1"></a>     sim_run<span class="sc">$</span>agent <span class="ot">&lt;-</span> agent_i</span>
<span id="cb37-19"><a href="from-verbal-descriptions-to-formal-models.html#cb37-19" tabindex="-1"></a>     sim_run<span class="sc">$</span>opponent_rate <span class="ot">&lt;-</span> rate</span>
<span id="cb37-20"><a href="from-verbal-descriptions-to-formal-models.html#cb37-20" tabindex="-1"></a>     rate_runs[[agent_i]] <span class="ot">&lt;-</span> sim_run</span>
<span id="cb37-21"><a href="from-verbal-descriptions-to-formal-models.html#cb37-21" tabindex="-1"></a>  }</span>
<span id="cb37-22"><a href="from-verbal-descriptions-to-formal-models.html#cb37-22" tabindex="-1"></a>  <span class="co"># Combine all agents for this rate and store in main list</span></span>
<span id="cb37-23"><a href="from-verbal-descriptions-to-formal-models.html#cb37-23" tabindex="-1"></a>  results_vs_random[[<span class="fu">as.character</span>(rate)]] <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rate_runs)</span>
<span id="cb37-24"><a href="from-verbal-descriptions-to-formal-models.html#cb37-24" tabindex="-1"></a>}</span>
<span id="cb37-25"><a href="from-verbal-descriptions-to-formal-models.html#cb37-25" tabindex="-1"></a><span class="co"># Combine everything into one big dataframe</span></span>
<span id="cb37-26"><a href="from-verbal-descriptions-to-formal-models.html#cb37-26" tabindex="-1"></a>df_scaled_vs_random <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_vs_random)</span></code></pre></div>
<div id="visualizing-results" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Visualizing Results<a href="from-verbal-descriptions-to-formal-models.html#visualizing-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s visualize the average performance of the WSLS agent against random opponents with different biases.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="from-verbal-descriptions-to-formal-models.html#cb38-1" tabindex="-1"></a><span class="co"># Calculate cumulative performance for each simulation run</span></span>
<span id="cb38-2"><a href="from-verbal-descriptions-to-formal-models.html#cb38-2" tabindex="-1"></a>df_scaled_vs_random <span class="ot">&lt;-</span> df_scaled_vs_random <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="from-verbal-descriptions-to-formal-models.html#cb38-3" tabindex="-1"></a>  <span class="fu">group_by</span>(agent, opponent_rate) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="from-verbal-descriptions-to-formal-models.html#cb38-4" tabindex="-1"></a>  <span class="co"># CHANGED &#39;Feedback&#39; to &#39;win&#39; here:</span></span>
<span id="cb38-5"><a href="from-verbal-descriptions-to-formal-models.html#cb38-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cumulative_Performance =</span> <span class="fu">cumsum</span>(win) <span class="sc">/</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="from-verbal-descriptions-to-formal-models.html#cb38-6" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb38-7"><a href="from-verbal-descriptions-to-formal-models.html#cb38-7" tabindex="-1"></a></span>
<span id="cb38-8"><a href="from-verbal-descriptions-to-formal-models.html#cb38-8" tabindex="-1"></a><span class="co"># Plot average performance over time, grouped by opponent bias rate</span></span>
<span id="cb38-9"><a href="from-verbal-descriptions-to-formal-models.html#cb38-9" tabindex="-1"></a>p_scaled_perf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_scaled_vs_random,</span>
<span id="cb38-10"><a href="from-verbal-descriptions-to-formal-models.html#cb38-10" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> Cumulative_Performance,</span>
<span id="cb38-11"><a href="from-verbal-descriptions-to-formal-models.html#cb38-11" tabindex="-1"></a>           <span class="at">group =</span> opponent_rate, <span class="at">color =</span> <span class="fu">as.factor</span>(opponent_rate))) <span class="sc">+</span> <span class="co"># made color a factor for cleaner legend</span></span>
<span id="cb38-12"><a href="from-verbal-descriptions-to-formal-models.html#cb38-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-13"><a href="from-verbal-descriptions-to-formal-models.html#cb38-13" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="from-verbal-descriptions-to-formal-models.html#cb38-14" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> <span class="co"># Discrete scale since we made rate a factor</span></span>
<span id="cb38-15"><a href="from-verbal-descriptions-to-formal-models.html#cb38-15" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-16"><a href="from-verbal-descriptions-to-formal-models.html#cb38-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Average WSLS Performance vs. Random Opponents&quot;</span>,</span>
<span id="cb38-17"><a href="from-verbal-descriptions-to-formal-models.html#cb38-17" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Performance improves as opponent&#39;s bias increases&quot;</span>,</span>
<span id="cb38-18"><a href="from-verbal-descriptions-to-formal-models.html#cb38-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb38-19"><a href="from-verbal-descriptions-to-formal-models.html#cb38-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Average Proportion Wins&quot;</span>,</span>
<span id="cb38-20"><a href="from-verbal-descriptions-to-formal-models.html#cb38-20" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Opponent Bias&quot;</span></span>
<span id="cb38-21"><a href="from-verbal-descriptions-to-formal-models.html#cb38-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-22"><a href="from-verbal-descriptions-to-formal-models.html#cb38-22" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-23"><a href="from-verbal-descriptions-to-formal-models.html#cb38-23" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb38-24"><a href="from-verbal-descriptions-to-formal-models.html#cb38-24" tabindex="-1"></a></span>
<span id="cb38-25"><a href="from-verbal-descriptions-to-formal-models.html#cb38-25" tabindex="-1"></a><span class="fu">print</span>(p_scaled_perf)</span></code></pre></div>
<p><img src="series_files/figure-html/03%20visualizing-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This plot clearly shows that the WSLS strategy becomes more effective (higher average win rate) as the opponent becomes more predictable (i.e., their bias rate moves further away from 0.5 towards 1.0). Against a purely random opponent (rate=0.5), WSLS performs at chance level on average. This highlights WSLS’s ability to exploit predictability.</p>
</div>
</div>
<div id="conclusion-the-forward-model" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Conclusion: The Forward Model<a href="from-verbal-descriptions-to-formal-models.html#conclusion-the-forward-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we successfully built a <strong>Forward Model</strong>.
* We started with a verbal theory (WSLS).
* We translated it into code (parameters + algorithm).
* We ran the code to <strong>generate</strong> artificial data.</p>
<p>This is the “models of the Mind” in action. We demonstrated that a simple mechanism (Win-Stay-Lose-Shift) can generate complex success rates depending on the environment (the opponent).</p>
<div id="the-problem-of-inference" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> The Problem of Inference<a href="from-verbal-descriptions-to-formal-models.html#the-problem-of-inference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>However, in real science, we don’t start with the parameters. We start with the data (the choices participants made) and we want to find the parameters (did they use WSLS? How much noise?).</p>
<p>We need to run our machine in reverse.</p>
<ul>
<li><p><strong>Forward (Simulation)</strong>: Parameters <span class="math inline">\(\rightarrow\)</span> Data</p></li>
<li><p><strong>Inverse (Fitting)</strong>: Data <span class="math inline">\(\rightarrow\)</span> Parameters</p></li>
</ul>
<p>In the next chapter, “From Simulation to Model Fitting,” we will learn how to take the simulated data we just created and use statistical methods (Maximum Likelihood and Bayesian Inference with Stan) to recover the original parameters.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-models-of-strategic-decision-making.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="from-simulation-to-model-fitting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/03-BuildingFormalModels.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
