<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 From verbal to formal models | 11 - Reinforcement Learning</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 From verbal to formal models | 11 - Reinforcement Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 From verbal to formal models | 11 - Reinforcement Learning" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2023" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2024-02-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-verbal-models-of-the-matching-pennies-game.html"/>
<link rel="next" href="practical-exercise-3---getting-into-stan.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-goal-of-the-course"><i class="fa fa-check"></i><b>1.1</b> The goal of the course</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#list-of-lectures-and-practical-exercises"><i class="fa fa-check"></i><b>1.2</b> List of lectures and practical exercises</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation-before-the-course"><i class="fa fa-check"></i><b>1.3</b> Preparation before the course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a></li>
<li class="chapter" data-level="2.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#strategies"><i class="fa fa-check"></i><b>2.4</b> Strategies</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.4.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.4.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.4.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.4.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.4.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.4.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.4.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.4.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.4.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.4.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.4.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.5</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.5.1</b> Memory</a></li>
<li class="chapter" data-level="2.5.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#perseveration"><i class="fa fa-check"></i><b>2.5.2</b> Perseveration</a></li>
<li class="chapter" data-level="2.5.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.5.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.6</b> Continuity between models</a></li>
<li class="chapter" data-level="2.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.7</b> Mixture of strategies</a></li>
<li class="chapter" data-level="2.8" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>2.8</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.1</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.2" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.2</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.4" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.4</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.4.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#data"><i class="fa fa-check"></i><b>4.3.1</b> Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#model"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>4.3.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="4.3.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-model"><i class="fa fa-check"></i><b>4.3.4</b> Summarizing the model</a></li>
<li class="chapter" data-level="4.3.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#assessing-model-quality"><i class="fa fa-check"></i><b>4.3.5</b> Assessing model quality</a></li>
<li class="chapter" data-level="4.3.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results"><i class="fa fa-check"></i><b>4.3.6</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>4.5.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>4.6</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>4.6.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html"><i class="fa fa-check"></i><b>5</b> Practical exercise 4 - Model quality checks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>5.1</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="5.2" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-priors"><i class="fa fa-check"></i><b>5.2</b> Assessing priors</a></li>
<li class="chapter" data-level="5.3" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-prior-and-posterior-predictions"><i class="fa fa-check"></i><b>5.3</b> Assessing prior and posterior predictions</a></li>
<li class="chapter" data-level="5.4" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="5.5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#the-memory-model"><i class="fa fa-check"></i><b>5.5</b> The memory model</a></li>
<li class="chapter" data-level="5.6" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>5.6</b> Prior sensitivity check for the memory model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html"><i class="fa fa-check"></i><b>6</b> Multilevel modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#intro-to-multilevel-modeling"><i class="fa fa-check"></i><b>6.1</b> Intro to multilevel modeling</a></li>
<li class="chapter" data-level="6.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent"><i class="fa fa-check"></i><b>6.2</b> A multilevel version of the biased agent and of the simple memory agent</a></li>
<li class="chapter" data-level="6.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>6.3</b> Generating the agents</a></li>
<li class="chapter" data-level="6.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>6.4</b> Plotting the agents</a></li>
<li class="chapter" data-level="6.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>6.5</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>6.5.1</b> Multilevel random</a></li>
<li class="chapter" data-level="6.5.2" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>6.5.2</b> Assessing multilevel random agents</a></li>
<li class="chapter" data-level="6.5.3" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory"><i class="fa fa-check"></i><b>6.5.3</b> Multilevel memory</a></li>
<li class="chapter" data-level="6.5.4" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>6.5.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.5" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>6.5.5</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="6.5.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>6.5.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.7" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>6.5.7</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="6.5.8" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>6.5.8</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="6.5.9" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-memory-no-pooling"><i class="fa fa-check"></i><b>6.5.9</b> Multilevel memory no pooling</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multilevel-modeling.html"><a href="multilevel-modeling.html#multilevel-full-pooling"><i class="fa fa-check"></i><b>6.6</b> Multilevel full pooling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>7</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model-comparison.html"><a href="model-comparison.html#define-parameters"><i class="fa fa-check"></i><b>7.1</b> Define parameters</a></li>
<li class="chapter" data-level="7.2" data-path="model-comparison.html"><a href="model-comparison.html#define-biased-and-memory-agents"><i class="fa fa-check"></i><b>7.2</b> Define biased and memory agents</a></li>
<li class="chapter" data-level="7.3" data-path="model-comparison.html"><a href="model-comparison.html#generating-the-agents-1"><i class="fa fa-check"></i><b>7.3</b> Generating the agents</a></li>
<li class="chapter" data-level="7.4" data-path="model-comparison.html"><a href="model-comparison.html#prep-the-data"><i class="fa fa-check"></i><b>7.4</b> Prep the data</a></li>
<li class="chapter" data-level="7.5" data-path="model-comparison.html"><a href="model-comparison.html#log-posterior-likelihood"><i class="fa fa-check"></i><b>7.5</b> Log posterior likelihood</a></li>
<li class="chapter" data-level="7.6" data-path="model-comparison.html"><a href="model-comparison.html#create-the-models-multilevel-biased-agents"><i class="fa fa-check"></i><b>7.6</b> Create the models: multilevel biased agents</a></li>
<li class="chapter" data-level="7.7" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-memory-model"><i class="fa fa-check"></i><b>7.7</b> Multilevel memory model</a></li>
<li class="chapter" data-level="7.8" data-path="model-comparison.html"><a href="model-comparison.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>7.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="7.9" data-path="model-comparison.html"><a href="model-comparison.html#calculating-the-expected-log-predictive-density-of-a-model"><i class="fa fa-check"></i><b>7.9</b> Calculating the expected log predictive density of a model</a></li>
<li class="chapter" data-level="7.10" data-path="model-comparison.html"><a href="model-comparison.html#implementing-cross-validation"><i class="fa fa-check"></i><b>7.10</b> Implementing Cross-Validation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-biased-agents"><i class="fa fa-check"></i><b>7.10.1</b> Create cross-validation ready stan model for biased agents</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-comparison.html"><a href="model-comparison.html#create-cross-validation-ready-stan-model-for-memory-agents"><i class="fa fa-check"></i><b>7.10.2</b> Create cross-validation ready stan model for memory agents</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="model-comparison.html"><a href="model-comparison.html#calculating-elpd-and-comparing"><i class="fa fa-check"></i><b>7.11</b> Calculating elpd and comparing</a></li>
<li class="chapter" data-level="7.12" data-path="model-comparison.html"><a href="model-comparison.html#limitations-of-model-comparison-techniques"><i class="fa fa-check"></i><b>7.12</b> Limitations of model comparison techniques</a></li>
<li class="chapter" data-level="7.13" data-path="model-comparison.html"><a href="model-comparison.html#mixture-models"><i class="fa fa-check"></i><b>7.13</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="model-comparison.html"><a href="model-comparison.html#load-the-dataset"><i class="fa fa-check"></i><b>7.13.1</b> Load the dataset</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="model-comparison.html"><a href="model-comparison.html#stan-model-mixing-biased-and-noise"><i class="fa fa-check"></i><b>7.14</b> Stan model mixing biased and noise</a></li>
<li class="chapter" data-level="7.15" data-path="model-comparison.html"><a href="model-comparison.html#fitting-and-assessing-the-model"><i class="fa fa-check"></i><b>7.15</b> Fitting and assessing the model</a></li>
<li class="chapter" data-level="7.16" data-path="model-comparison.html"><a href="model-comparison.html#basic-evaluation"><i class="fa fa-check"></i><b>7.16</b> Basic evaluation</a></li>
<li class="chapter" data-level="7.17" data-path="model-comparison.html"><a href="model-comparison.html#multilevel-mixture-model"><i class="fa fa-check"></i><b>7.17</b> Multilevel mixture model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html"><i class="fa fa-check"></i><b>8</b> Bonus chapter: Additional models developed by students</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#additional-models"><i class="fa fa-check"></i><b>8.1</b> Additional models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.1</b> Probabilistic Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#probabilistic-asymmetric-win-stay-lose-shift"><i class="fa fa-check"></i><b>8.1.2</b> Probabilistic asymmetric Win Stay Lose Shift</a></li>
<li class="chapter" data-level="8.1.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-rate"><i class="fa fa-check"></i><b>8.1.3</b> Memory agent with exponential memory decay (rate)</a></li>
<li class="chapter" data-level="8.1.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-exponential"><i class="fa fa-check"></i><b>8.1.4</b> Memory agent with exponential memory decay (exponential)</a></li>
<li class="chapter" data-level="8.1.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-but-separate-memory-for-wins-and-losses"><i class="fa fa-check"></i><b>8.1.5</b> Memory agent with exponential memory decay, but separate memory for wins and losses</a></li>
<li class="chapter" data-level="8.1.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#memory-agent-with-exponential-memory-decay-and-with-confidence"><i class="fa fa-check"></i><b>8.1.6</b> Memory agent with exponential memory decay, and with confidence</a></li>
<li class="chapter" data-level="8.1.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#reinforcement-learning-rescorla-wagner"><i class="fa fa-check"></i><b>8.1.7</b> Reinforcement learning (Rescorla Wagner)</a></li>
<li class="chapter" data-level="8.1.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#hierarchical-gaussian-filter"><i class="fa fa-check"></i><b>8.1.8</b> Hierarchical gaussian filter</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#implementing-the-wsls-model"><i class="fa fa-check"></i><b>8.2</b> Implementing the WSLS model</a></li>
<li class="chapter" data-level="8.3" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#load-packages"><i class="fa fa-check"></i><b>8.3</b> Load packages</a></li>
<li class="chapter" data-level="8.4" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#generate-data"><i class="fa fa-check"></i><b>8.4</b> Generate data</a></li>
<li class="chapter" data-level="8.5" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#sanity-check-for-the-data"><i class="fa fa-check"></i><b>8.5</b> Sanity check for the data</a></li>
<li class="chapter" data-level="8.6" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#more-sanity-check"><i class="fa fa-check"></i><b>8.6</b> More sanity check</a></li>
<li class="chapter" data-level="8.7" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-data-for-single-agent-model"><i class="fa fa-check"></i><b>8.7</b> Create data for single agent model</a></li>
<li class="chapter" data-level="8.8" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model"><i class="fa fa-check"></i><b>8.8</b> Create the model</a></li>
<li class="chapter" data-level="8.9" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#basic-assessment"><i class="fa fa-check"></i><b>8.9</b> Basic assessment</a></li>
<li class="chapter" data-level="8.10" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-multilevel-data"><i class="fa fa-check"></i><b>8.10</b> Create multilevel data</a></li>
<li class="chapter" data-level="8.11" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#create-the-model-1"><i class="fa fa-check"></i><b>8.11</b> Create the model</a></li>
<li class="chapter" data-level="8.12" data-path="bonus-chapter-additional-models-developed-by-students.html"><a href="bonus-chapter-additional-models-developed-by-students.html#quality-checks"><i class="fa fa-check"></i><b>8.12</b> Quality checks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>9</b> Bayesian models of cognition</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#load-the-packages"><i class="fa fa-check"></i><b>9.1</b> Load the packages</a></li>
<li class="chapter" data-level="9.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#design-the-model"><i class="fa fa-check"></i><b>9.2</b> Design the model</a></li>
<li class="chapter" data-level="9.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-data"><i class="fa fa-check"></i><b>9.3</b> Create the data</a></li>
<li class="chapter" data-level="9.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize"><i class="fa fa-check"></i><b>9.4</b> Visualize</a></li>
<li class="chapter" data-level="9.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#data-for-stan"><i class="fa fa-check"></i><b>9.5</b> Data for Stan</a></li>
<li class="chapter" data-level="9.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#create-the-stan-model"><i class="fa fa-check"></i><b>9.6</b> Create the Stan Model</a></li>
<li class="chapter" data-level="9.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-model"><i class="fa fa-check"></i><b>9.7</b> Fitting the model</a></li>
<li class="chapter" data-level="9.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#basic-evaluation-1"><i class="fa fa-check"></i><b>9.8</b> Basic evaluation</a></li>
<li class="chapter" data-level="9.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayes"><i class="fa fa-check"></i><b>9.9</b> Weighted Bayes</a></li>
<li class="chapter" data-level="9.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualize-1"><i class="fa fa-check"></i><b>9.10</b> Visualize</a></li>
<li class="chapter" data-level="9.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-the-weighted-bayes-stan-model-simple-formula"><i class="fa fa-check"></i><b>9.11</b> Build the Weighted Bayes Stan model (simple formula)</a></li>
<li class="chapter" data-level="9.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-evaluation"><i class="fa fa-check"></i><b>9.12</b> Model evaluation</a></li>
<li class="chapter" data-level="9.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-recovery"><i class="fa fa-check"></i><b>9.13</b> Model recovery</a></li>
<li class="chapter" data-level="9.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel"><i class="fa fa-check"></i><b>9.14</b> Multilevel</a></li>
<li class="chapter" data-level="9.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bonus-build-the-weighted-bayes-stan-model-fancier-formula"><i class="fa fa-check"></i><b>9.15</b> Bonus: Build the Weighted Bayes Stan model (fancier formula)</a></li>
<li class="chapter" data-level="9.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluation"><i class="fa fa-check"></i><b>9.16</b> Evaluation</a></li>
<li class="chapter" data-level="9.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#build-a-temporal-bayes-storing-current-belief-as-prior-for-next-turn"><i class="fa fa-check"></i><b>9.17</b> Build a temporal Bayes (storing current belief as prior for next turn)</a></li>
<li class="chapter" data-level="9.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evaluate"><i class="fa fa-check"></i><b>9.18</b> Evaluate</a></li>
<li class="chapter" data-level="9.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-simple-bayes-model"><i class="fa fa-check"></i><b>9.19</b> Multilevel version of the simple bayes model</a></li>
<li class="chapter" data-level="9.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-version-of-the-weighted-bayes-model"><i class="fa fa-check"></i><b>9.20</b> Multilevel version of the weighted bayes model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="categorization-models.html"><a href="categorization-models.html"><i class="fa fa-check"></i><b>10</b> Categorization models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="categorization-models.html"><a href="categorization-models.html#multilevel-gcm"><i class="fa fa-check"></i><b>10.1</b> Multilevel GCM</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="categorization-models.html"><a href="categorization-models.html#simulate-hierarchical-simplices"><i class="fa fa-check"></i><b>10.1.1</b> Simulate hierarchical simplices</a></li>
<li class="chapter" data-level="10.1.2" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-data-simulation"><i class="fa fa-check"></i><b>10.1.2</b> Set up the data simulation</a></li>
<li class="chapter" data-level="10.1.3" data-path="categorization-models.html"><a href="categorization-models.html#set-up-the-stan-model"><i class="fa fa-check"></i><b>10.1.3</b> Set up the Stan model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="categorization-models.html"><a href="categorization-models.html#now-we-parallelize-n.b.-not-finished"><i class="fa fa-check"></i><b>10.2</b> Now we parallelize [N.B. NOT FINISHED]</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="categorization-models.html"><a href="categorization-models.html#student-produced-models-of-categorization"><i class="fa fa-check"></i><b>10.2.1</b> Student-produced models of categorization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="categorization-models-1.html"><a href="categorization-models-1.html"><i class="fa fa-check"></i><b>11</b> Categorization models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="categorization-models-1.html"><a href="categorization-models-1.html#defining-parameters"><i class="fa fa-check"></i><b>11.1</b> Defining parameters</a></li>
<li class="chapter" data-level="11.2" data-path="categorization-models-1.html"><a href="categorization-models-1.html#simulating-with-alpha-0.9-and-p-0.9"><i class="fa fa-check"></i><b>11.2</b> Simulating with alpha 0.9 and p 0.9</a></li>
<li class="chapter" data-level="11.3" data-path="categorization-models-1.html"><a href="categorization-models-1.html#simulating-with-p-0.75"><i class="fa fa-check"></i><b>11.3</b> Simulating with p = 0.75</a></li>
<li class="chapter" data-level="11.4" data-path="categorization-models-1.html"><a href="categorization-models-1.html#what-about-asymmetric-learning"><i class="fa fa-check"></i><b>11.4</b> What about asymmetric learning?</a></li>
<li class="chapter" data-level="11.5" data-path="categorization-models-1.html"><a href="categorization-models-1.html#model-fitting-symmetric-rl"><i class="fa fa-check"></i><b>11.5</b> Model fitting: symmetric RL</a></li>
<li class="chapter" data-level="11.6" data-path="categorization-models-1.html"><a href="categorization-models-1.html#model-fitting-asymmetric-rl"><i class="fa fa-check"></i><b>11.6</b> Model fitting: asymmetric RL</a></li>
<li class="chapter" data-level="11.7" data-path="categorization-models-1.html"><a href="categorization-models-1.html#model-fitting-multilevel"><i class="fa fa-check"></i><b>11.7</b> Model fitting: multilevel</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">11 - Reinforcement Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="from-verbal-to-formal-models" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> From verbal to formal models<a href="from-verbal-to-formal-models.html#from-verbal-to-formal-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We will now discuss how to go from verbal to formal models.
We will not just write a formula, we will implement these models as algorithms in R.
By implementing the models of algorithms,</p>
<ul>
<li><p>we are forced to make them very explicit in their assumptions;</p></li>
<li><p>we become able to simulate the models in a variety of different situations and therefore better understand their implications</p></li>
</ul>
<p>So, the steps for today’s exercise are:</p>
<ol style="list-style-type: decimal">
<li><p>choose two of the models and formalize them, that is, produce an algorithm that enacts the strategy, so we can simulate them.</p></li>
<li><p>implement the algorithms as functions: getting an input and producing an output, so we can more easily implement them across various contexts (e.g. varying amount of trials, input, etc). See R4DataScience, if you need a refresher: <a href="https://r4ds.had.co.nz/functions.html" class="uri">https://r4ds.had.co.nz/functions.html</a></p></li>
<li><p>implement a Random Bias agent (choosing “head” 70% of the times) and get your agents to play against it for 120 trials (and save the data)</p></li>
<li><p>implement a Win-Stay-Lose-Shift agent (keeping the same choice if it won, changing it if it lost) and do the same.</p></li>
<li><p>Now scale up the simulation: have 100 agents for each of your strategy playing against both Random Bias and Win-Stay-Lose-Shift and save their data.</p></li>
<li><p>Figure out a good way to visualize the data to assess which strategy performs better, whether that changes over time and generally explore what the agents are doing.</p></li>
</ol>
<div id="defining-general-conditions" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Defining general conditions<a href="from-verbal-to-formal-models.html#defining-general-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="from-verbal-to-formal-models.html#cb9-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, patchwork)</span>
<span id="cb9-2"><a href="from-verbal-to-formal-models.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="from-verbal-to-formal-models.html#cb9-3" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb9-4"><a href="from-verbal-to-formal-models.html#cb9-4" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span></span></code></pre></div>
</div>
<div id="implementing-a-random-agent" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Implementing a random agent<a href="from-verbal-to-formal-models.html#implementing-a-random-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Remember a random agent is an agent that picks at random between “right” and “left” independently on what the opponent is doing.
A random agent might be perfectly random (50% chance of choosing “right”, same for “left”) or biased. The variable “rate” determines the rate of choosing “right”.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="from-verbal-to-formal-models.html#cb10-1" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb10-2"><a href="from-verbal-to-formal-models.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="from-verbal-to-formal-models.html#cb10-3" tabindex="-1"></a>RandomAgent <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="dv">1</span>, rate) <span class="co"># we simply sample randomly from a binomial</span></span>
<span id="cb10-4"><a href="from-verbal-to-formal-models.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="from-verbal-to-formal-models.html#cb10-5" tabindex="-1"></a><span class="co"># Now let&#39;s plot how it&#39;s choosing</span></span>
<span id="cb10-6"><a href="from-verbal-to-formal-models.html#cb10-6" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> RandomAgent)</span>
<span id="cb10-7"><a href="from-verbal-to-formal-models.html#cb10-7" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> </span>
<span id="cb10-8"><a href="from-verbal-to-formal-models.html#cb10-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb10-9"><a href="from-verbal-to-formal-models.html#cb10-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb10-10"><a href="from-verbal-to-formal-models.html#cb10-10" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="from-verbal-to-formal-models.html#cb11-1" tabindex="-1"></a><span class="co"># What if we were to compare it to an agent being biased?</span></span>
<span id="cb11-2"><a href="from-verbal-to-formal-models.html#cb11-2" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb11-3"><a href="from-verbal-to-formal-models.html#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="from-verbal-to-formal-models.html#cb11-4" tabindex="-1"></a>RandomAgent <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="dv">1</span>, rate) <span class="co"># we simply sample randomly from a binomial</span></span>
<span id="cb11-5"><a href="from-verbal-to-formal-models.html#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="from-verbal-to-formal-models.html#cb11-6" tabindex="-1"></a><span class="co"># Now let&#39;s plot how it&#39;s choosing</span></span>
<span id="cb11-7"><a href="from-verbal-to-formal-models.html#cb11-7" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> RandomAgent)</span>
<span id="cb11-8"><a href="from-verbal-to-formal-models.html#cb11-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> </span>
<span id="cb11-9"><a href="from-verbal-to-formal-models.html#cb11-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb11-10"><a href="from-verbal-to-formal-models.html#cb11-10" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb11-11"><a href="from-verbal-to-formal-models.html#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="from-verbal-to-formal-models.html#cb11-12" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-2.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="from-verbal-to-formal-models.html#cb12-1" tabindex="-1"></a><span class="co"># Tricky to see, let&#39;s try writing the cumulative rate:</span></span>
<span id="cb12-2"><a href="from-verbal-to-formal-models.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="from-verbal-to-formal-models.html#cb12-3" tabindex="-1"></a>d1<span class="sc">$</span>cumulativerate <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(d1<span class="sc">$</span>choice) <span class="sc">/</span> <span class="fu">seq_along</span>(d1<span class="sc">$</span>choice)</span>
<span id="cb12-4"><a href="from-verbal-to-formal-models.html#cb12-4" tabindex="-1"></a>d2<span class="sc">$</span>cumulativerate <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(d2<span class="sc">$</span>choice) <span class="sc">/</span> <span class="fu">seq_along</span>(d2<span class="sc">$</span>choice)</span>
<span id="cb12-5"><a href="from-verbal-to-formal-models.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="from-verbal-to-formal-models.html#cb12-6" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(trial, cumulativerate)) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="from-verbal-to-formal-models.html#cb12-7" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb12-8"><a href="from-verbal-to-formal-models.html#cb12-8" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="from-verbal-to-formal-models.html#cb12-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb12-10"><a href="from-verbal-to-formal-models.html#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="from-verbal-to-formal-models.html#cb12-11" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(trial, cumulativerate)) <span class="sc">+</span> </span>
<span id="cb12-12"><a href="from-verbal-to-formal-models.html#cb12-12" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb12-13"><a href="from-verbal-to-formal-models.html#cb12-13" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-14"><a href="from-verbal-to-formal-models.html#cb12-14" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb12-15"><a href="from-verbal-to-formal-models.html#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="from-verbal-to-formal-models.html#cb12-16" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-3.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="from-verbal-to-formal-models.html#cb13-1" tabindex="-1"></a><span class="do">## Now in the same plot</span></span>
<span id="cb13-2"><a href="from-verbal-to-formal-models.html#cb13-2" tabindex="-1"></a>d1<span class="sc">$</span>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb13-3"><a href="from-verbal-to-formal-models.html#cb13-3" tabindex="-1"></a>d2<span class="sc">$</span>rate <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb13-4"><a href="from-verbal-to-formal-models.html#cb13-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1,d2)</span>
<span id="cb13-5"><a href="from-verbal-to-formal-models.html#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="from-verbal-to-formal-models.html#cb13-6" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, cumulativerate, <span class="at">color =</span> rate, <span class="at">group =</span> rate)) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="from-verbal-to-formal-models.html#cb13-7" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb13-8"><a href="from-verbal-to-formal-models.html#cb13-8" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="from-verbal-to-formal-models.html#cb13-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb13-10"><a href="from-verbal-to-formal-models.html#cb13-10" tabindex="-1"></a>p5</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-4.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="from-verbal-to-formal-models.html#cb14-1" tabindex="-1"></a><span class="co"># now as a function</span></span>
<span id="cb14-2"><a href="from-verbal-to-formal-models.html#cb14-2" tabindex="-1"></a>RandomAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(input, rate){</span>
<span id="cb14-3"><a href="from-verbal-to-formal-models.html#cb14-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(input)</span>
<span id="cb14-4"><a href="from-verbal-to-formal-models.html#cb14-4" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, rate)</span>
<span id="cb14-5"><a href="from-verbal-to-formal-models.html#cb14-5" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb14-6"><a href="from-verbal-to-formal-models.html#cb14-6" tabindex="-1"></a>}</span>
<span id="cb14-7"><a href="from-verbal-to-formal-models.html#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="from-verbal-to-formal-models.html#cb14-8" tabindex="-1"></a>input <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,trials) <span class="co"># it doesn&#39;t matter, it&#39;s not taken into account</span></span>
<span id="cb14-9"><a href="from-verbal-to-formal-models.html#cb14-9" tabindex="-1"></a>choice <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(input, rate)</span>
<span id="cb14-10"><a href="from-verbal-to-formal-models.html#cb14-10" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), choice)</span>
<span id="cb14-11"><a href="from-verbal-to-formal-models.html#cb14-11" tabindex="-1"></a><span class="fu">ggplot</span>(d3, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-5.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="from-verbal-to-formal-models.html#cb15-1" tabindex="-1"></a><span class="do">## What if there&#39;s noise?</span></span>
<span id="cb15-2"><a href="from-verbal-to-formal-models.html#cb15-2" tabindex="-1"></a>RandomAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(input, rate, noise){</span>
<span id="cb15-3"><a href="from-verbal-to-formal-models.html#cb15-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(input)</span>
<span id="cb15-4"><a href="from-verbal-to-formal-models.html#cb15-4" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, rate)</span>
<span id="cb15-5"><a href="from-verbal-to-formal-models.html#cb15-5" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)}</span>
<span id="cb15-6"><a href="from-verbal-to-formal-models.html#cb15-6" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb15-7"><a href="from-verbal-to-formal-models.html#cb15-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="implementing-a-win-stay-lose-shift-agent" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Implementing a Win-Stay-Lose-Shift agent<a href="from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="from-verbal-to-formal-models.html#cb16-1" tabindex="-1"></a><span class="co"># as a function</span></span>
<span id="cb16-2"><a href="from-verbal-to-formal-models.html#cb16-2" tabindex="-1"></a>WSLSAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, Feedback){</span>
<span id="cb16-3"><a href="from-verbal-to-formal-models.html#cb16-3" tabindex="-1"></a>  <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb16-4"><a href="from-verbal-to-formal-models.html#cb16-4" tabindex="-1"></a>    choice <span class="ot">=</span> prevChoice</span>
<span id="cb16-5"><a href="from-verbal-to-formal-models.html#cb16-5" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb16-6"><a href="from-verbal-to-formal-models.html#cb16-6" tabindex="-1"></a>      choice <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> prevChoice</span>
<span id="cb16-7"><a href="from-verbal-to-formal-models.html#cb16-7" tabindex="-1"></a>      }</span>
<span id="cb16-8"><a href="from-verbal-to-formal-models.html#cb16-8" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb16-9"><a href="from-verbal-to-formal-models.html#cb16-9" tabindex="-1"></a>}</span>
<span id="cb16-10"><a href="from-verbal-to-formal-models.html#cb16-10" tabindex="-1"></a></span>
<span id="cb16-11"><a href="from-verbal-to-formal-models.html#cb16-11" tabindex="-1"></a></span>
<span id="cb16-12"><a href="from-verbal-to-formal-models.html#cb16-12" tabindex="-1"></a>WSLSAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, Feedback, noise){</span>
<span id="cb16-13"><a href="from-verbal-to-formal-models.html#cb16-13" tabindex="-1"></a>  <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb16-14"><a href="from-verbal-to-formal-models.html#cb16-14" tabindex="-1"></a>    choice <span class="ot">=</span> prevChoice</span>
<span id="cb16-15"><a href="from-verbal-to-formal-models.html#cb16-15" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb16-16"><a href="from-verbal-to-formal-models.html#cb16-16" tabindex="-1"></a>      choice <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> prevChoice</span>
<span id="cb16-17"><a href="from-verbal-to-formal-models.html#cb16-17" tabindex="-1"></a>  }</span>
<span id="cb16-18"><a href="from-verbal-to-formal-models.html#cb16-18" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">5</span>)}</span>
<span id="cb16-19"><a href="from-verbal-to-formal-models.html#cb16-19" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb16-20"><a href="from-verbal-to-formal-models.html#cb16-20" tabindex="-1"></a>}</span>
<span id="cb16-21"><a href="from-verbal-to-formal-models.html#cb16-21" tabindex="-1"></a></span>
<span id="cb16-22"><a href="from-verbal-to-formal-models.html#cb16-22" tabindex="-1"></a>WSLSAgent <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb16-23"><a href="from-verbal-to-formal-models.html#cb16-23" tabindex="-1"></a></span>
<span id="cb16-24"><a href="from-verbal-to-formal-models.html#cb16-24" tabindex="-1"></a></span>
<span id="cb16-25"><a href="from-verbal-to-formal-models.html#cb16-25" tabindex="-1"></a><span class="co"># Against a random agent</span></span>
<span id="cb16-26"><a href="from-verbal-to-formal-models.html#cb16-26" tabindex="-1"></a></span>
<span id="cb16-27"><a href="from-verbal-to-formal-models.html#cb16-27" tabindex="-1"></a>Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb16-28"><a href="from-verbal-to-formal-models.html#cb16-28" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb16-29"><a href="from-verbal-to-formal-models.html#cb16-29" tabindex="-1"></a></span>
<span id="cb16-30"><a href="from-verbal-to-formal-models.html#cb16-30" tabindex="-1"></a>Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb16-31"><a href="from-verbal-to-formal-models.html#cb16-31" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="fu">seq</span>(trials), rate)</span>
<span id="cb16-32"><a href="from-verbal-to-formal-models.html#cb16-32" tabindex="-1"></a>  </span>
<span id="cb16-33"><a href="from-verbal-to-formal-models.html#cb16-33" tabindex="-1"></a></span>
<span id="cb16-34"><a href="from-verbal-to-formal-models.html#cb16-34" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb16-35"><a href="from-verbal-to-formal-models.html#cb16-35" tabindex="-1"></a>  <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb16-36"><a href="from-verbal-to-formal-models.html#cb16-36" tabindex="-1"></a>    Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb16-37"><a href="from-verbal-to-formal-models.html#cb16-37" tabindex="-1"></a>  } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb16-38"><a href="from-verbal-to-formal-models.html#cb16-38" tabindex="-1"></a>  Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb16-39"><a href="from-verbal-to-formal-models.html#cb16-39" tabindex="-1"></a>}</span>
<span id="cb16-40"><a href="from-verbal-to-formal-models.html#cb16-40" tabindex="-1"></a></span>
<span id="cb16-41"><a href="from-verbal-to-formal-models.html#cb16-41" tabindex="-1"></a><span class="fu">sum</span>(Self <span class="sc">==</span> Other)</span></code></pre></div>
<pre><code>## [1] 71</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="from-verbal-to-formal-models.html#cb18-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other))</span>
<span id="cb18-2"><a href="from-verbal-to-formal-models.html#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="from-verbal-to-formal-models.html#cb18-3" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="from-verbal-to-formal-models.html#cb18-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Self)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="from-verbal-to-formal-models.html#cb18-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, Other))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="from-verbal-to-formal-models.html#cb19-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb19-2"><a href="from-verbal-to-formal-models.html#cb19-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Feedback)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="from-verbal-to-formal-models.html#cb19-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, <span class="dv">1</span> <span class="sc">-</span> Feedback))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-2.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="from-verbal-to-formal-models.html#cb20-1" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateSelf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb20-2"><a href="from-verbal-to-formal-models.html#cb20-2" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateOther <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb20-3"><a href="from-verbal-to-formal-models.html#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="from-verbal-to-formal-models.html#cb20-4" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="from-verbal-to-formal-models.html#cb20-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateSelf)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="from-verbal-to-formal-models.html#cb20-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateOther))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-3.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="from-verbal-to-formal-models.html#cb21-1" tabindex="-1"></a><span class="co"># Against a Win-Stay-Lose Shift</span></span>
<span id="cb21-2"><a href="from-verbal-to-formal-models.html#cb21-2" tabindex="-1"></a>Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb21-3"><a href="from-verbal-to-formal-models.html#cb21-3" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb21-4"><a href="from-verbal-to-formal-models.html#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="from-verbal-to-formal-models.html#cb21-5" tabindex="-1"></a>Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb21-6"><a href="from-verbal-to-formal-models.html#cb21-6" tabindex="-1"></a>Other[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb21-7"><a href="from-verbal-to-formal-models.html#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="from-verbal-to-formal-models.html#cb21-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb21-9"><a href="from-verbal-to-formal-models.html#cb21-9" tabindex="-1"></a>  <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb21-10"><a href="from-verbal-to-formal-models.html#cb21-10" tabindex="-1"></a>    Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb21-11"><a href="from-verbal-to-formal-models.html#cb21-11" tabindex="-1"></a>  } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb21-12"><a href="from-verbal-to-formal-models.html#cb21-12" tabindex="-1"></a>  Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb21-13"><a href="from-verbal-to-formal-models.html#cb21-13" tabindex="-1"></a>  Other[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Other[i <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> Feedback)</span>
<span id="cb21-14"><a href="from-verbal-to-formal-models.html#cb21-14" tabindex="-1"></a>}</span>
<span id="cb21-15"><a href="from-verbal-to-formal-models.html#cb21-15" tabindex="-1"></a></span>
<span id="cb21-16"><a href="from-verbal-to-formal-models.html#cb21-16" tabindex="-1"></a><span class="fu">sum</span>(Self <span class="sc">==</span> Other)</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="from-verbal-to-formal-models.html#cb23-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other))</span>
<span id="cb23-2"><a href="from-verbal-to-formal-models.html#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="from-verbal-to-formal-models.html#cb23-3" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="from-verbal-to-formal-models.html#cb23-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Self)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="from-verbal-to-formal-models.html#cb23-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, Other))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-4.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="from-verbal-to-formal-models.html#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb24-2"><a href="from-verbal-to-formal-models.html#cb24-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Feedback)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="from-verbal-to-formal-models.html#cb24-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, <span class="dv">1</span> <span class="sc">-</span> Feedback))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-5.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="from-verbal-to-formal-models.html#cb25-1" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateSelf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb25-2"><a href="from-verbal-to-formal-models.html#cb25-2" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateOther <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb25-3"><a href="from-verbal-to-formal-models.html#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="from-verbal-to-formal-models.html#cb25-4" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="from-verbal-to-formal-models.html#cb25-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateSelf)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="from-verbal-to-formal-models.html#cb25-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateOther))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-6.png" width="672" /></p>
</div>
<div id="now-we-scale-it-up" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Now we scale it up<a href="from-verbal-to-formal-models.html#now-we-scale-it-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="from-verbal-to-formal-models.html#cb26-1" tabindex="-1"></a>trials <span class="ot">=</span> <span class="dv">120</span></span>
<span id="cb26-2"><a href="from-verbal-to-formal-models.html#cb26-2" tabindex="-1"></a>agents <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb26-3"><a href="from-verbal-to-formal-models.html#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="from-verbal-to-formal-models.html#cb26-4" tabindex="-1"></a><span class="co"># WSLS vs agents with varying rates</span></span>
<span id="cb26-5"><a href="from-verbal-to-formal-models.html#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="from-verbal-to-formal-models.html#cb26-6" tabindex="-1"></a><span class="cf">for</span> (rate <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.5</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.05</span>)) {</span>
<span id="cb26-7"><a href="from-verbal-to-formal-models.html#cb26-7" tabindex="-1"></a>  </span>
<span id="cb26-8"><a href="from-verbal-to-formal-models.html#cb26-8" tabindex="-1"></a>  <span class="cf">for</span> (agent <span class="cf">in</span> <span class="fu">seq</span>(agents)) {</span>
<span id="cb26-9"><a href="from-verbal-to-formal-models.html#cb26-9" tabindex="-1"></a>    Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-10"><a href="from-verbal-to-formal-models.html#cb26-10" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-11"><a href="from-verbal-to-formal-models.html#cb26-11" tabindex="-1"></a>    </span>
<span id="cb26-12"><a href="from-verbal-to-formal-models.html#cb26-12" tabindex="-1"></a>    Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb26-13"><a href="from-verbal-to-formal-models.html#cb26-13" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="fu">seq</span>(trials), rate)</span>
<span id="cb26-14"><a href="from-verbal-to-formal-models.html#cb26-14" tabindex="-1"></a>    </span>
<span id="cb26-15"><a href="from-verbal-to-formal-models.html#cb26-15" tabindex="-1"></a>    </span>
<span id="cb26-16"><a href="from-verbal-to-formal-models.html#cb26-16" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb26-17"><a href="from-verbal-to-formal-models.html#cb26-17" tabindex="-1"></a>      <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb26-18"><a href="from-verbal-to-formal-models.html#cb26-18" tabindex="-1"></a>        Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-19"><a href="from-verbal-to-formal-models.html#cb26-19" tabindex="-1"></a>      } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb26-20"><a href="from-verbal-to-formal-models.html#cb26-20" tabindex="-1"></a>      Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb26-21"><a href="from-verbal-to-formal-models.html#cb26-21" tabindex="-1"></a>    }</span>
<span id="cb26-22"><a href="from-verbal-to-formal-models.html#cb26-22" tabindex="-1"></a>    </span>
<span id="cb26-23"><a href="from-verbal-to-formal-models.html#cb26-23" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other), agent, rate)</span>
<span id="cb26-24"><a href="from-verbal-to-formal-models.html#cb26-24" tabindex="-1"></a>    </span>
<span id="cb26-25"><a href="from-verbal-to-formal-models.html#cb26-25" tabindex="-1"></a>    <span class="cf">if</span> (agent <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> rate <span class="sc">==</span> <span class="fl">0.5</span>) {df <span class="ot">&lt;-</span> temp} <span class="cf">else</span> {df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, temp)}</span>
<span id="cb26-26"><a href="from-verbal-to-formal-models.html#cb26-26" tabindex="-1"></a>  }</span>
<span id="cb26-27"><a href="from-verbal-to-formal-models.html#cb26-27" tabindex="-1"></a>}</span>
<span id="cb26-28"><a href="from-verbal-to-formal-models.html#cb26-28" tabindex="-1"></a></span>
<span id="cb26-29"><a href="from-verbal-to-formal-models.html#cb26-29" tabindex="-1"></a><span class="do">## WSLS with another WSLS</span></span>
<span id="cb26-30"><a href="from-verbal-to-formal-models.html#cb26-30" tabindex="-1"></a></span>
<span id="cb26-31"><a href="from-verbal-to-formal-models.html#cb26-31" tabindex="-1"></a><span class="cf">for</span> (agent <span class="cf">in</span> <span class="fu">seq</span>(agents)) {</span>
<span id="cb26-32"><a href="from-verbal-to-formal-models.html#cb26-32" tabindex="-1"></a>    Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-33"><a href="from-verbal-to-formal-models.html#cb26-33" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-34"><a href="from-verbal-to-formal-models.html#cb26-34" tabindex="-1"></a>    </span>
<span id="cb26-35"><a href="from-verbal-to-formal-models.html#cb26-35" tabindex="-1"></a>    Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb26-36"><a href="from-verbal-to-formal-models.html#cb26-36" tabindex="-1"></a>    Other[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb26-37"><a href="from-verbal-to-formal-models.html#cb26-37" tabindex="-1"></a>    </span>
<span id="cb26-38"><a href="from-verbal-to-formal-models.html#cb26-38" tabindex="-1"></a>    </span>
<span id="cb26-39"><a href="from-verbal-to-formal-models.html#cb26-39" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb26-40"><a href="from-verbal-to-formal-models.html#cb26-40" tabindex="-1"></a>      <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb26-41"><a href="from-verbal-to-formal-models.html#cb26-41" tabindex="-1"></a>        Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-42"><a href="from-verbal-to-formal-models.html#cb26-42" tabindex="-1"></a>      } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb26-43"><a href="from-verbal-to-formal-models.html#cb26-43" tabindex="-1"></a>      Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb26-44"><a href="from-verbal-to-formal-models.html#cb26-44" tabindex="-1"></a>      Other[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Other[i <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> Feedback)</span>
<span id="cb26-45"><a href="from-verbal-to-formal-models.html#cb26-45" tabindex="-1"></a>    }</span>
<span id="cb26-46"><a href="from-verbal-to-formal-models.html#cb26-46" tabindex="-1"></a>    </span>
<span id="cb26-47"><a href="from-verbal-to-formal-models.html#cb26-47" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other), agent, rate)</span>
<span id="cb26-48"><a href="from-verbal-to-formal-models.html#cb26-48" tabindex="-1"></a>    </span>
<span id="cb26-49"><a href="from-verbal-to-formal-models.html#cb26-49" tabindex="-1"></a>    <span class="cf">if</span> (agent <span class="sc">==</span> <span class="dv">1</span> ) {df1 <span class="ot">&lt;-</span> temp} <span class="cf">else</span> {df1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df1, temp)}</span>
<span id="cb26-50"><a href="from-verbal-to-formal-models.html#cb26-50" tabindex="-1"></a>  }</span></code></pre></div>
<div id="and-we-visualize-it" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> And we visualize it<a href="from-verbal-to-formal-models.html#and-we-visualize-it" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="from-verbal-to-formal-models.html#cb27-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(trial, Feedback, <span class="at">group =</span> rate, <span class="at">color =</span> rate)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="from-verbal-to-formal-models.html#cb27-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="series_files/figure-html/02%20visualizing-1.png" width="672" /></p>
<p>We can see that the bigger the bias in the random agent, the bigger the performance in the WSLS (the higher the chances the random agent picks the same hand more than once in a row).</p>
<p>Now it’s your turn to follow a similar process for your 2 chosen strategies.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-verbal-models-of-the-matching-pennies-game.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practical-exercise-3---getting-into-stan.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/02-BuildingFormalModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
