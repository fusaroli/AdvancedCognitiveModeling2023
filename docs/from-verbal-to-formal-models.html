<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 From verbal to formal models | 01 - The Pizza Experiment</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 From verbal to formal models | 01 - The Pizza Experiment" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 From verbal to formal models | 01 - The Pizza Experiment" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-verbal-models-of-the-matching-pennies-game.html"/>
<link rel="next" href="practical-exercise-3---getting-into-stan.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#part-foundations"><i class="fa fa-check"></i>(PART) Foundations</a>
<ul>
<li class="chapter" data-level="1.6" data-path="03-BuildingFormalModels.html"><a href="#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>1.6</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#why-start-with-pizza"><i class="fa fa-check"></i><b>1.7</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.8</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>1.9</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#initial-data-visualization"><i class="fa fa-check"></i><b>1.9.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="1.9.2" data-path="index.html"><a href="index.html#key-observations"><i class="fa fa-check"></i><b>1.9.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>1.10</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="index.html"><a href="index.html#model-setup-and-priors"><i class="fa fa-check"></i><b>1.10.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="1.10.2" data-path="index.html"><a href="index.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>1.10.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="1.10.3" data-path="index.html"><a href="index.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>1.10.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="1.10.4" data-path="index.html"><a href="index.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>1.10.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="1.10.5" data-path="index.html"><a href="index.html#model-assessment"><i class="fa fa-check"></i><b>1.10.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>1.11</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="index.html"><a href="index.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>1.11.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>1.12</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="1.13" data-path="index.html"><a href="index.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>1.13</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="1.14" data-path="index.html"><a href="index.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>1.14</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a></li>
<li class="chapter" data-level="2.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#strategies"><i class="fa fa-check"></i><b>2.4</b> Strategies</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.4.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.4.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.4.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.4.4" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.4.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.4.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.4.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.4.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.4.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.4.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.4.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.5</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.5.1</b> Memory</a></li>
<li class="chapter" data-level="2.5.2" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#perseveration"><i class="fa fa-check"></i><b>2.5.2</b> Perseveration</a></li>
<li class="chapter" data-level="2.5.3" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.5.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.6</b> Continuity between models</a></li>
<li class="chapter" data-level="2.7" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.7</b> Mixture of strategies</a></li>
<li class="chapter" data-level="2.8" data-path="building-verbal-models-of-the-matching-pennies-game.html"><a href="building-verbal-models-of-the-matching-pennies-game.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>2.8</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.2</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.3" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.4" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.4</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.5" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.5</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="from-verbal-to-formal-models.html"><a href="from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.5.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#data"><i class="fa fa-check"></i><b>4.3.1</b> Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#model"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>4.3.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="4.3.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-model"><i class="fa fa-check"></i><b>4.3.4</b> Summarizing the model</a></li>
<li class="chapter" data-level="4.3.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#assessing-model-quality"><i class="fa fa-check"></i><b>4.3.5</b> Assessing model quality</a></li>
<li class="chapter" data-level="4.3.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results"><i class="fa fa-check"></i><b>4.3.6</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>4.5.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>4.6</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>4.6.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">01 - The Pizza Experiment</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="from-verbal-to-formal-models" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> From verbal to formal models<a href="from-verbal-to-formal-models.html#from-verbal-to-formal-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-objectives-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Learning Objectives<a href="from-verbal-to-formal-models.html#learning-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this exercise, you will be able to:</p>
<ul>
<li>Transform verbal descriptions of decision-making strategies into formal computational models</li>
<li>Implement and test different agent-based models in R</li>
<li>Compare and evaluate the performance of different strategic agents</li>
<li>Visualize and interpret simulation results at scale</li>
</ul>
<p>By computationally implementing the our models,</p>
<ul>
<li><p>we are forced to make them very explicit in their assumptions;</p></li>
<li><p>we become able to simulate the models in a variety of different situations and therefore better understand their implications</p></li>
</ul>
<p>So, the steps for today’s exercise are:</p>
<ol style="list-style-type: decimal">
<li><p>choose two of the models and formalize them, that is, produce an algorithm that enacts the strategy, so we can simulate them.</p></li>
<li><p>implement the algorithms as functions: getting an input and producing an output, so we can more easily implement them across various contexts (e.g. varying amount of trials, input, etc). See R4DataScience, if you need a refresher: <a href="https://r4ds.had.co.nz/functions.html" class="uri">https://r4ds.had.co.nz/functions.html</a></p></li>
<li><p>implement a Random Bias agent (choosing “head” 70% of the times) and get your agents to play against it for 120 trials (and save the data)</p></li>
<li><p>implement a Win-Stay-Lose-Shift agent (keeping the same choice if it won, changing it if it lost) and do the same.</p></li>
<li><p>Now scale up the simulation: have 100 agents for each of your strategy playing against both Random Bias and Win-Stay-Lose-Shift and save their data.</p></li>
<li><p>Figure out a good way to visualize the data to assess which strategy performs better, whether that changes over time and generally explore what the agents are doing.</p></li>
</ol>
</div>
<div id="defining-general-conditions" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Defining general conditions<a href="from-verbal-to-formal-models.html#defining-general-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="from-verbal-to-formal-models.html#cb21-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, patchwork)</span>
<span id="cb21-2"><a href="from-verbal-to-formal-models.html#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="from-verbal-to-formal-models.html#cb21-3" tabindex="-1"></a><span class="co"># Number of trials per simulation</span></span>
<span id="cb21-4"><a href="from-verbal-to-formal-models.html#cb21-4" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span>  </span>
<span id="cb21-5"><a href="from-verbal-to-formal-models.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="from-verbal-to-formal-models.html#cb21-6" tabindex="-1"></a><span class="co"># Number of agents to simulate</span></span>
<span id="cb21-7"><a href="from-verbal-to-formal-models.html#cb21-7" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span>  </span>
<span id="cb21-8"><a href="from-verbal-to-formal-models.html#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="from-verbal-to-formal-models.html#cb21-9" tabindex="-1"></a><span class="co"># Optional: Set random seed for reproducibility</span></span>
<span id="cb21-10"><a href="from-verbal-to-formal-models.html#cb21-10" tabindex="-1"></a><span class="co"># set.seed(123)</span></span></code></pre></div>
</div>
<div id="implementing-a-random-agent" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Implementing a random agent<a href="from-verbal-to-formal-models.html#implementing-a-random-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Remember a random agent is an agent that picks at random between “right” and “left” independently on what the opponent is doing.
A random agent might be perfectly random (50% chance of choosing “right”, same for “left”) or biased. The variable “rate” determines the rate of choosing “right”.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="from-verbal-to-formal-models.html#cb22-1" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb22-2"><a href="from-verbal-to-formal-models.html#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="from-verbal-to-formal-models.html#cb22-3" tabindex="-1"></a>RandomAgent <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="dv">1</span>, rate) <span class="co"># we simply sample randomly from a binomial</span></span>
<span id="cb22-4"><a href="from-verbal-to-formal-models.html#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="from-verbal-to-formal-models.html#cb22-5" tabindex="-1"></a><span class="co"># Now let&#39;s plot how it&#39;s choosing</span></span>
<span id="cb22-6"><a href="from-verbal-to-formal-models.html#cb22-6" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> RandomAgent)</span>
<span id="cb22-7"><a href="from-verbal-to-formal-models.html#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="from-verbal-to-formal-models.html#cb22-8" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> </span>
<span id="cb22-9"><a href="from-verbal-to-formal-models.html#cb22-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb22-10"><a href="from-verbal-to-formal-models.html#cb22-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-11"><a href="from-verbal-to-formal-models.html#cb22-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Random Agent Behavior (rate 0.5)&quot;</span>,</span>
<span id="cb22-12"><a href="from-verbal-to-formal-models.html#cb22-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb22-13"><a href="from-verbal-to-formal-models.html#cb22-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span></span>
<span id="cb22-14"><a href="from-verbal-to-formal-models.html#cb22-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-15"><a href="from-verbal-to-formal-models.html#cb22-15" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb22-16"><a href="from-verbal-to-formal-models.html#cb22-16" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="from-verbal-to-formal-models.html#cb23-1" tabindex="-1"></a><span class="co"># What if we were to compare it to an agent being biased?</span></span>
<span id="cb23-2"><a href="from-verbal-to-formal-models.html#cb23-2" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb23-3"><a href="from-verbal-to-formal-models.html#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="from-verbal-to-formal-models.html#cb23-4" tabindex="-1"></a>RandomAgent <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="dv">1</span>, rate) <span class="co"># we simply sample randomly from a binomial</span></span>
<span id="cb23-5"><a href="from-verbal-to-formal-models.html#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="from-verbal-to-formal-models.html#cb23-6" tabindex="-1"></a><span class="co"># Now let&#39;s plot how it&#39;s choosing</span></span>
<span id="cb23-7"><a href="from-verbal-to-formal-models.html#cb23-7" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> RandomAgent)</span>
<span id="cb23-8"><a href="from-verbal-to-formal-models.html#cb23-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="from-verbal-to-formal-models.html#cb23-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb23-10"><a href="from-verbal-to-formal-models.html#cb23-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-11"><a href="from-verbal-to-formal-models.html#cb23-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Biased Random Agent Behavior&quot;</span>,</span>
<span id="cb23-12"><a href="from-verbal-to-formal-models.html#cb23-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb23-13"><a href="from-verbal-to-formal-models.html#cb23-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span></span>
<span id="cb23-14"><a href="from-verbal-to-formal-models.html#cb23-14" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb23-15"><a href="from-verbal-to-formal-models.html#cb23-15" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb23-16"><a href="from-verbal-to-formal-models.html#cb23-16" tabindex="-1"></a></span>
<span id="cb23-17"><a href="from-verbal-to-formal-models.html#cb23-17" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="from-verbal-to-formal-models.html#cb24-1" tabindex="-1"></a><span class="co"># Tricky to see, let&#39;s try writing the cumulative rate:</span></span>
<span id="cb24-2"><a href="from-verbal-to-formal-models.html#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="from-verbal-to-formal-models.html#cb24-3" tabindex="-1"></a>d1<span class="sc">$</span>cumulativerate <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(d1<span class="sc">$</span>choice) <span class="sc">/</span> <span class="fu">seq_along</span>(d1<span class="sc">$</span>choice)</span>
<span id="cb24-4"><a href="from-verbal-to-formal-models.html#cb24-4" tabindex="-1"></a>d2<span class="sc">$</span>cumulativerate <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(d2<span class="sc">$</span>choice) <span class="sc">/</span> <span class="fu">seq_along</span>(d2<span class="sc">$</span>choice)</span>
<span id="cb24-5"><a href="from-verbal-to-formal-models.html#cb24-5" tabindex="-1"></a></span>
<span id="cb24-6"><a href="from-verbal-to-formal-models.html#cb24-6" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(trial, cumulativerate)) <span class="sc">+</span> </span>
<span id="cb24-7"><a href="from-verbal-to-formal-models.html#cb24-7" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb24-8"><a href="from-verbal-to-formal-models.html#cb24-8" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb24-9"><a href="from-verbal-to-formal-models.html#cb24-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-10"><a href="from-verbal-to-formal-models.html#cb24-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Random Agent Behavior&quot;</span>,</span>
<span id="cb24-11"><a href="from-verbal-to-formal-models.html#cb24-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb24-12"><a href="from-verbal-to-formal-models.html#cb24-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative probability of choosing 1 (0-1)&quot;</span></span>
<span id="cb24-13"><a href="from-verbal-to-formal-models.html#cb24-13" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb24-14"><a href="from-verbal-to-formal-models.html#cb24-14" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb24-15"><a href="from-verbal-to-formal-models.html#cb24-15" tabindex="-1"></a></span>
<span id="cb24-16"><a href="from-verbal-to-formal-models.html#cb24-16" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(trial, cumulativerate)) <span class="sc">+</span> </span>
<span id="cb24-17"><a href="from-verbal-to-formal-models.html#cb24-17" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb24-18"><a href="from-verbal-to-formal-models.html#cb24-18" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-19"><a href="from-verbal-to-formal-models.html#cb24-19" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Random Agent Behavior&quot;</span>,</span>
<span id="cb24-20"><a href="from-verbal-to-formal-models.html#cb24-20" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb24-21"><a href="from-verbal-to-formal-models.html#cb24-21" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative probability of choosing 1 (0-1)&quot;</span></span>
<span id="cb24-22"><a href="from-verbal-to-formal-models.html#cb24-22" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb24-23"><a href="from-verbal-to-formal-models.html#cb24-23" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb24-24"><a href="from-verbal-to-formal-models.html#cb24-24" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb24-25"><a href="from-verbal-to-formal-models.html#cb24-25" tabindex="-1"></a></span>
<span id="cb24-26"><a href="from-verbal-to-formal-models.html#cb24-26" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="from-verbal-to-formal-models.html#cb25-1" tabindex="-1"></a><span class="do">## Now in the same plot</span></span>
<span id="cb25-2"><a href="from-verbal-to-formal-models.html#cb25-2" tabindex="-1"></a>d1<span class="sc">$</span>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb25-3"><a href="from-verbal-to-formal-models.html#cb25-3" tabindex="-1"></a>d2<span class="sc">$</span>rate <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb25-4"><a href="from-verbal-to-formal-models.html#cb25-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1,d2) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="from-verbal-to-formal-models.html#cb25-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> <span class="fu">as.factor</span>(rate))</span>
<span id="cb25-6"><a href="from-verbal-to-formal-models.html#cb25-6" tabindex="-1"></a></span>
<span id="cb25-7"><a href="from-verbal-to-formal-models.html#cb25-7" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, cumulativerate, <span class="at">color =</span> rate, <span class="at">group =</span> rate)) <span class="sc">+</span> </span>
<span id="cb25-8"><a href="from-verbal-to-formal-models.html#cb25-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb25-9"><a href="from-verbal-to-formal-models.html#cb25-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-10"><a href="from-verbal-to-formal-models.html#cb25-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Random Agents Behavior&quot;</span>,</span>
<span id="cb25-11"><a href="from-verbal-to-formal-models.html#cb25-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb25-12"><a href="from-verbal-to-formal-models.html#cb25-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative probability of choosing 1 (0-1)&quot;</span></span>
<span id="cb25-13"><a href="from-verbal-to-formal-models.html#cb25-13" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb25-14"><a href="from-verbal-to-formal-models.html#cb25-14" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb25-15"><a href="from-verbal-to-formal-models.html#cb25-15" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb25-16"><a href="from-verbal-to-formal-models.html#cb25-16" tabindex="-1"></a>p5</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-4.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="from-verbal-to-formal-models.html#cb26-1" tabindex="-1"></a><span class="co"># Now as a function</span></span>
<span id="cb26-2"><a href="from-verbal-to-formal-models.html#cb26-2" tabindex="-1"></a><span class="co">#&#39; Create a random decision-making agent</span></span>
<span id="cb26-3"><a href="from-verbal-to-formal-models.html#cb26-3" tabindex="-1"></a><span class="co">#&#39; @param input Vector of previous choices (not used but included for API consistency)</span></span>
<span id="cb26-4"><a href="from-verbal-to-formal-models.html#cb26-4" tabindex="-1"></a><span class="co">#&#39; @param rate Probability of choosing option 1 (default: 0.5 for unbiased)</span></span>
<span id="cb26-5"><a href="from-verbal-to-formal-models.html#cb26-5" tabindex="-1"></a><span class="co">#&#39; @return Vector of binary choices</span></span>
<span id="cb26-6"><a href="from-verbal-to-formal-models.html#cb26-6" tabindex="-1"></a><span class="co">#&#39; @examples </span></span>
<span id="cb26-7"><a href="from-verbal-to-formal-models.html#cb26-7" tabindex="-1"></a><span class="co">#&#39; # Create unbiased random agent for 10 trials</span></span>
<span id="cb26-8"><a href="from-verbal-to-formal-models.html#cb26-8" tabindex="-1"></a><span class="co">#&#39; choices &lt;- RandomAgent_f(rep(1,10), 0.5)</span></span>
<span id="cb26-9"><a href="from-verbal-to-formal-models.html#cb26-9" tabindex="-1"></a>RandomAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(input, <span class="at">rate =</span> <span class="fl">0.5</span>) {</span>
<span id="cb26-10"><a href="from-verbal-to-formal-models.html#cb26-10" tabindex="-1"></a>  <span class="co"># Input validation</span></span>
<span id="cb26-11"><a href="from-verbal-to-formal-models.html#cb26-11" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(rate) <span class="sc">||</span> rate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> rate <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb26-12"><a href="from-verbal-to-formal-models.html#cb26-12" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Rate must be a probability between 0 and 1&quot;</span>)</span>
<span id="cb26-13"><a href="from-verbal-to-formal-models.html#cb26-13" tabindex="-1"></a>  }</span>
<span id="cb26-14"><a href="from-verbal-to-formal-models.html#cb26-14" tabindex="-1"></a>  </span>
<span id="cb26-15"><a href="from-verbal-to-formal-models.html#cb26-15" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(input)</span>
<span id="cb26-16"><a href="from-verbal-to-formal-models.html#cb26-16" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, rate)</span>
<span id="cb26-17"><a href="from-verbal-to-formal-models.html#cb26-17" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb26-18"><a href="from-verbal-to-formal-models.html#cb26-18" tabindex="-1"></a>}</span>
<span id="cb26-19"><a href="from-verbal-to-formal-models.html#cb26-19" tabindex="-1"></a></span>
<span id="cb26-20"><a href="from-verbal-to-formal-models.html#cb26-20" tabindex="-1"></a>input <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,trials) <span class="co"># it doesn&#39;t matter, it&#39;s not taken into account</span></span>
<span id="cb26-21"><a href="from-verbal-to-formal-models.html#cb26-21" tabindex="-1"></a>choice <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(input, rate)</span>
<span id="cb26-22"><a href="from-verbal-to-formal-models.html#cb26-22" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), choice)</span>
<span id="cb26-23"><a href="from-verbal-to-formal-models.html#cb26-23" tabindex="-1"></a></span>
<span id="cb26-24"><a href="from-verbal-to-formal-models.html#cb26-24" tabindex="-1"></a><span class="fu">ggplot</span>(d3, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> </span>
<span id="cb26-25"><a href="from-verbal-to-formal-models.html#cb26-25" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb26-26"><a href="from-verbal-to-formal-models.html#cb26-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-27"><a href="from-verbal-to-formal-models.html#cb26-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Random Agent Behavior&quot;</span>,</span>
<span id="cb26-28"><a href="from-verbal-to-formal-models.html#cb26-28" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb26-29"><a href="from-verbal-to-formal-models.html#cb26-29" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative probability of choosing 1 (0-1)&quot;</span></span>
<span id="cb26-30"><a href="from-verbal-to-formal-models.html#cb26-30" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb26-31"><a href="from-verbal-to-formal-models.html#cb26-31" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/02%20implementing%20random%20agent-5.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="from-verbal-to-formal-models.html#cb27-1" tabindex="-1"></a><span class="do">## What if there&#39;s noise?</span></span>
<span id="cb27-2"><a href="from-verbal-to-formal-models.html#cb27-2" tabindex="-1"></a>RandomAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(input, rate, noise){</span>
<span id="cb27-3"><a href="from-verbal-to-formal-models.html#cb27-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(input)</span>
<span id="cb27-4"><a href="from-verbal-to-formal-models.html#cb27-4" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, rate)</span>
<span id="cb27-5"><a href="from-verbal-to-formal-models.html#cb27-5" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)}</span>
<span id="cb27-6"><a href="from-verbal-to-formal-models.html#cb27-6" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb27-7"><a href="from-verbal-to-formal-models.html#cb27-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="implementing-a-win-stay-lose-shift-agent" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Implementing a Win-Stay-Lose-Shift agent<a href="from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="from-verbal-to-formal-models.html#cb28-1" tabindex="-1"></a><span class="co">#&#39; Create a Win-Stay-Lose-Shift decision-making agent</span></span>
<span id="cb28-2"><a href="from-verbal-to-formal-models.html#cb28-2" tabindex="-1"></a><span class="co">#&#39; @param prevChoice Previous choice made by the agent (0 or 1)</span></span>
<span id="cb28-3"><a href="from-verbal-to-formal-models.html#cb28-3" tabindex="-1"></a><span class="co">#&#39; @param feedback Success of previous choice (1 for win, 0 for loss)</span></span>
<span id="cb28-4"><a href="from-verbal-to-formal-models.html#cb28-4" tabindex="-1"></a><span class="co">#&#39; @param noise Optional probability of random choice (default: 0)</span></span>
<span id="cb28-5"><a href="from-verbal-to-formal-models.html#cb28-5" tabindex="-1"></a><span class="co">#&#39; @return Next choice (0 or 1)</span></span>
<span id="cb28-6"><a href="from-verbal-to-formal-models.html#cb28-6" tabindex="-1"></a><span class="co">#&#39; @examples</span></span>
<span id="cb28-7"><a href="from-verbal-to-formal-models.html#cb28-7" tabindex="-1"></a><span class="co">#&#39; # Basic WSLS decision after a win</span></span>
<span id="cb28-8"><a href="from-verbal-to-formal-models.html#cb28-8" tabindex="-1"></a><span class="co">#&#39; next_choice &lt;- WSLSAgent_f(prevChoice = 1, feedback = 1)</span></span>
<span id="cb28-9"><a href="from-verbal-to-formal-models.html#cb28-9" tabindex="-1"></a>WSLSAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, feedback, <span class="at">noise =</span> <span class="dv">0</span>) {</span>
<span id="cb28-10"><a href="from-verbal-to-formal-models.html#cb28-10" tabindex="-1"></a>  <span class="co"># Input validation</span></span>
<span id="cb28-11"><a href="from-verbal-to-formal-models.html#cb28-11" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(prevChoice) <span class="sc">||</span> <span class="sc">!</span>prevChoice <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) {</span>
<span id="cb28-12"><a href="from-verbal-to-formal-models.html#cb28-12" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Previous choice must be 0 or 1&quot;</span>)</span>
<span id="cb28-13"><a href="from-verbal-to-formal-models.html#cb28-13" tabindex="-1"></a>  }</span>
<span id="cb28-14"><a href="from-verbal-to-formal-models.html#cb28-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(feedback) <span class="sc">||</span> <span class="sc">!</span>feedback <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) {</span>
<span id="cb28-15"><a href="from-verbal-to-formal-models.html#cb28-15" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Feedback must be 0 or 1&quot;</span>)</span>
<span id="cb28-16"><a href="from-verbal-to-formal-models.html#cb28-16" tabindex="-1"></a>  }</span>
<span id="cb28-17"><a href="from-verbal-to-formal-models.html#cb28-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(noise) <span class="sc">||</span> noise <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> noise <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb28-18"><a href="from-verbal-to-formal-models.html#cb28-18" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Noise must be a probability between 0 and 1&quot;</span>)</span>
<span id="cb28-19"><a href="from-verbal-to-formal-models.html#cb28-19" tabindex="-1"></a>  }</span>
<span id="cb28-20"><a href="from-verbal-to-formal-models.html#cb28-20" tabindex="-1"></a>  </span>
<span id="cb28-21"><a href="from-verbal-to-formal-models.html#cb28-21" tabindex="-1"></a>  <span class="co"># Core WSLS logic</span></span>
<span id="cb28-22"><a href="from-verbal-to-formal-models.html#cb28-22" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="cf">if</span> (feedback <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb28-23"><a href="from-verbal-to-formal-models.html#cb28-23" tabindex="-1"></a>    prevChoice  <span class="co"># Stay with previous choice if won</span></span>
<span id="cb28-24"><a href="from-verbal-to-formal-models.html#cb28-24" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb28-25"><a href="from-verbal-to-formal-models.html#cb28-25" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> prevChoice  <span class="co"># Switch to opposite choice if lost</span></span>
<span id="cb28-26"><a href="from-verbal-to-formal-models.html#cb28-26" tabindex="-1"></a>  }</span>
<span id="cb28-27"><a href="from-verbal-to-formal-models.html#cb28-27" tabindex="-1"></a>  </span>
<span id="cb28-28"><a href="from-verbal-to-formal-models.html#cb28-28" tabindex="-1"></a>  <span class="co"># Apply noise if specified</span></span>
<span id="cb28-29"><a href="from-verbal-to-formal-models.html#cb28-29" tabindex="-1"></a>  <span class="cf">if</span> (noise <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> noise) {</span>
<span id="cb28-30"><a href="from-verbal-to-formal-models.html#cb28-30" tabindex="-1"></a>    choice <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb28-31"><a href="from-verbal-to-formal-models.html#cb28-31" tabindex="-1"></a>  }</span>
<span id="cb28-32"><a href="from-verbal-to-formal-models.html#cb28-32" tabindex="-1"></a>  </span>
<span id="cb28-33"><a href="from-verbal-to-formal-models.html#cb28-33" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb28-34"><a href="from-verbal-to-formal-models.html#cb28-34" tabindex="-1"></a>}</span>
<span id="cb28-35"><a href="from-verbal-to-formal-models.html#cb28-35" tabindex="-1"></a></span>
<span id="cb28-36"><a href="from-verbal-to-formal-models.html#cb28-36" tabindex="-1"></a></span>
<span id="cb28-37"><a href="from-verbal-to-formal-models.html#cb28-37" tabindex="-1"></a>WSLSAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, Feedback, noise){</span>
<span id="cb28-38"><a href="from-verbal-to-formal-models.html#cb28-38" tabindex="-1"></a>  <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb28-39"><a href="from-verbal-to-formal-models.html#cb28-39" tabindex="-1"></a>    choice <span class="ot">=</span> prevChoice</span>
<span id="cb28-40"><a href="from-verbal-to-formal-models.html#cb28-40" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb28-41"><a href="from-verbal-to-formal-models.html#cb28-41" tabindex="-1"></a>      choice <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> prevChoice</span>
<span id="cb28-42"><a href="from-verbal-to-formal-models.html#cb28-42" tabindex="-1"></a>  }</span>
<span id="cb28-43"><a href="from-verbal-to-formal-models.html#cb28-43" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">5</span>)}</span>
<span id="cb28-44"><a href="from-verbal-to-formal-models.html#cb28-44" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb28-45"><a href="from-verbal-to-formal-models.html#cb28-45" tabindex="-1"></a>}</span>
<span id="cb28-46"><a href="from-verbal-to-formal-models.html#cb28-46" tabindex="-1"></a></span>
<span id="cb28-47"><a href="from-verbal-to-formal-models.html#cb28-47" tabindex="-1"></a>WSLSAgent <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb28-48"><a href="from-verbal-to-formal-models.html#cb28-48" tabindex="-1"></a></span>
<span id="cb28-49"><a href="from-verbal-to-formal-models.html#cb28-49" tabindex="-1"></a></span>
<span id="cb28-50"><a href="from-verbal-to-formal-models.html#cb28-50" tabindex="-1"></a><span class="co"># Against a random agent</span></span>
<span id="cb28-51"><a href="from-verbal-to-formal-models.html#cb28-51" tabindex="-1"></a></span>
<span id="cb28-52"><a href="from-verbal-to-formal-models.html#cb28-52" tabindex="-1"></a>Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb28-53"><a href="from-verbal-to-formal-models.html#cb28-53" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb28-54"><a href="from-verbal-to-formal-models.html#cb28-54" tabindex="-1"></a></span>
<span id="cb28-55"><a href="from-verbal-to-formal-models.html#cb28-55" tabindex="-1"></a>Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb28-56"><a href="from-verbal-to-formal-models.html#cb28-56" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="fu">seq</span>(trials), rate)</span>
<span id="cb28-57"><a href="from-verbal-to-formal-models.html#cb28-57" tabindex="-1"></a>  </span>
<span id="cb28-58"><a href="from-verbal-to-formal-models.html#cb28-58" tabindex="-1"></a></span>
<span id="cb28-59"><a href="from-verbal-to-formal-models.html#cb28-59" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb28-60"><a href="from-verbal-to-formal-models.html#cb28-60" tabindex="-1"></a>  <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb28-61"><a href="from-verbal-to-formal-models.html#cb28-61" tabindex="-1"></a>    Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb28-62"><a href="from-verbal-to-formal-models.html#cb28-62" tabindex="-1"></a>  } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb28-63"><a href="from-verbal-to-formal-models.html#cb28-63" tabindex="-1"></a>  Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb28-64"><a href="from-verbal-to-formal-models.html#cb28-64" tabindex="-1"></a>}</span>
<span id="cb28-65"><a href="from-verbal-to-formal-models.html#cb28-65" tabindex="-1"></a></span>
<span id="cb28-66"><a href="from-verbal-to-formal-models.html#cb28-66" tabindex="-1"></a><span class="fu">sum</span>(Self <span class="sc">==</span> Other)</span></code></pre></div>
<pre><code>## [1] 73</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="from-verbal-to-formal-models.html#cb30-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other))</span>
<span id="cb30-2"><a href="from-verbal-to-formal-models.html#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="from-verbal-to-formal-models.html#cb30-3" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="from-verbal-to-formal-models.html#cb30-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Self)) <span class="sc">+</span></span>
<span id="cb30-5"><a href="from-verbal-to-formal-models.html#cb30-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, Other)) <span class="sc">+</span></span>
<span id="cb30-6"><a href="from-verbal-to-formal-models.html#cb30-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-7"><a href="from-verbal-to-formal-models.html#cb30-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;WSLS Agent (red) vs Biased Random Opponent (blue)&quot;</span>,</span>
<span id="cb30-8"><a href="from-verbal-to-formal-models.html#cb30-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb30-9"><a href="from-verbal-to-formal-models.html#cb30-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Choice (0/1)&quot;</span>,</span>
<span id="cb30-10"><a href="from-verbal-to-formal-models.html#cb30-10" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb30-11"><a href="from-verbal-to-formal-models.html#cb30-11" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="from-verbal-to-formal-models.html#cb31-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb31-2"><a href="from-verbal-to-formal-models.html#cb31-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Feedback)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="from-verbal-to-formal-models.html#cb31-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, <span class="dv">1</span> <span class="sc">-</span> Feedback)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="from-verbal-to-formal-models.html#cb31-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-5"><a href="from-verbal-to-formal-models.html#cb31-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;WSLS Agent (red) vs Biased Random Opponent (blue)&quot;</span>,</span>
<span id="cb31-6"><a href="from-verbal-to-formal-models.html#cb31-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb31-7"><a href="from-verbal-to-formal-models.html#cb31-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Feedback received (0/1)&quot;</span>,</span>
<span id="cb31-8"><a href="from-verbal-to-formal-models.html#cb31-8" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb31-9"><a href="from-verbal-to-formal-models.html#cb31-9" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="from-verbal-to-formal-models.html#cb32-1" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateSelf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb32-2"><a href="from-verbal-to-formal-models.html#cb32-2" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateOther <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb32-3"><a href="from-verbal-to-formal-models.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="from-verbal-to-formal-models.html#cb32-4" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb32-5"><a href="from-verbal-to-formal-models.html#cb32-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateSelf)) <span class="sc">+</span></span>
<span id="cb32-6"><a href="from-verbal-to-formal-models.html#cb32-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateOther))  <span class="sc">+</span></span>
<span id="cb32-7"><a href="from-verbal-to-formal-models.html#cb32-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-8"><a href="from-verbal-to-formal-models.html#cb32-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;WSLS Agent (red) vs Biased Random Opponent (blue)&quot;</span>,</span>
<span id="cb32-9"><a href="from-verbal-to-formal-models.html#cb32-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb32-10"><a href="from-verbal-to-formal-models.html#cb32-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative probability of choosing 1 (0-1)&quot;</span>,</span>
<span id="cb32-11"><a href="from-verbal-to-formal-models.html#cb32-11" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Agent Type&quot;</span></span>
<span id="cb32-12"><a href="from-verbal-to-formal-models.html#cb32-12" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="from-verbal-to-formal-models.html#cb33-1" tabindex="-1"></a><span class="co"># Against a Win-Stay-Lose Shift</span></span>
<span id="cb33-2"><a href="from-verbal-to-formal-models.html#cb33-2" tabindex="-1"></a>Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb33-3"><a href="from-verbal-to-formal-models.html#cb33-3" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb33-4"><a href="from-verbal-to-formal-models.html#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="from-verbal-to-formal-models.html#cb33-5" tabindex="-1"></a>Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb33-6"><a href="from-verbal-to-formal-models.html#cb33-6" tabindex="-1"></a>Other[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb33-7"><a href="from-verbal-to-formal-models.html#cb33-7" tabindex="-1"></a></span>
<span id="cb33-8"><a href="from-verbal-to-formal-models.html#cb33-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb33-9"><a href="from-verbal-to-formal-models.html#cb33-9" tabindex="-1"></a>  <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb33-10"><a href="from-verbal-to-formal-models.html#cb33-10" tabindex="-1"></a>    Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb33-11"><a href="from-verbal-to-formal-models.html#cb33-11" tabindex="-1"></a>  } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb33-12"><a href="from-verbal-to-formal-models.html#cb33-12" tabindex="-1"></a>  Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb33-13"><a href="from-verbal-to-formal-models.html#cb33-13" tabindex="-1"></a>  Other[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Other[i <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> Feedback)</span>
<span id="cb33-14"><a href="from-verbal-to-formal-models.html#cb33-14" tabindex="-1"></a>}</span>
<span id="cb33-15"><a href="from-verbal-to-formal-models.html#cb33-15" tabindex="-1"></a></span>
<span id="cb33-16"><a href="from-verbal-to-formal-models.html#cb33-16" tabindex="-1"></a><span class="fu">sum</span>(Self <span class="sc">==</span> Other)</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="from-verbal-to-formal-models.html#cb35-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other))</span>
<span id="cb35-2"><a href="from-verbal-to-formal-models.html#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="from-verbal-to-formal-models.html#cb35-3" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb35-4"><a href="from-verbal-to-formal-models.html#cb35-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Self)) <span class="sc">+</span></span>
<span id="cb35-5"><a href="from-verbal-to-formal-models.html#cb35-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, Other))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-4.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="from-verbal-to-formal-models.html#cb36-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb36-2"><a href="from-verbal-to-formal-models.html#cb36-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Feedback)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="from-verbal-to-formal-models.html#cb36-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, <span class="dv">1</span> <span class="sc">-</span> Feedback))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-5.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="from-verbal-to-formal-models.html#cb37-1" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateSelf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb37-2"><a href="from-verbal-to-formal-models.html#cb37-2" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateOther <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb37-3"><a href="from-verbal-to-formal-models.html#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="from-verbal-to-formal-models.html#cb37-4" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb37-5"><a href="from-verbal-to-formal-models.html#cb37-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateSelf)) <span class="sc">+</span></span>
<span id="cb37-6"><a href="from-verbal-to-formal-models.html#cb37-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateOther))</span></code></pre></div>
<p><img src="series_files/figure-html/02%20Implementing%20a%20Win-Stay-Lose-Shift%20agent-6.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="now-we-scale-it-up" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Now we scale it up<a href="from-verbal-to-formal-models.html#now-we-scale-it-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="from-verbal-to-formal-models.html#cb38-1" tabindex="-1"></a>trials <span class="ot">=</span> <span class="dv">120</span></span>
<span id="cb38-2"><a href="from-verbal-to-formal-models.html#cb38-2" tabindex="-1"></a>agents <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb38-3"><a href="from-verbal-to-formal-models.html#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="from-verbal-to-formal-models.html#cb38-4" tabindex="-1"></a><span class="co"># WSLS vs agents with varying rates</span></span>
<span id="cb38-5"><a href="from-verbal-to-formal-models.html#cb38-5" tabindex="-1"></a></span>
<span id="cb38-6"><a href="from-verbal-to-formal-models.html#cb38-6" tabindex="-1"></a><span class="cf">for</span> (rate <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.5</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.05</span>)) {</span>
<span id="cb38-7"><a href="from-verbal-to-formal-models.html#cb38-7" tabindex="-1"></a>  </span>
<span id="cb38-8"><a href="from-verbal-to-formal-models.html#cb38-8" tabindex="-1"></a>  <span class="cf">for</span> (agent <span class="cf">in</span> <span class="fu">seq</span>(agents)) {</span>
<span id="cb38-9"><a href="from-verbal-to-formal-models.html#cb38-9" tabindex="-1"></a>    Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb38-10"><a href="from-verbal-to-formal-models.html#cb38-10" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb38-11"><a href="from-verbal-to-formal-models.html#cb38-11" tabindex="-1"></a>    </span>
<span id="cb38-12"><a href="from-verbal-to-formal-models.html#cb38-12" tabindex="-1"></a>    Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb38-13"><a href="from-verbal-to-formal-models.html#cb38-13" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="fu">seq</span>(trials), rate)</span>
<span id="cb38-14"><a href="from-verbal-to-formal-models.html#cb38-14" tabindex="-1"></a>    </span>
<span id="cb38-15"><a href="from-verbal-to-formal-models.html#cb38-15" tabindex="-1"></a>    </span>
<span id="cb38-16"><a href="from-verbal-to-formal-models.html#cb38-16" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb38-17"><a href="from-verbal-to-formal-models.html#cb38-17" tabindex="-1"></a>      <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb38-18"><a href="from-verbal-to-formal-models.html#cb38-18" tabindex="-1"></a>        Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb38-19"><a href="from-verbal-to-formal-models.html#cb38-19" tabindex="-1"></a>      } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb38-20"><a href="from-verbal-to-formal-models.html#cb38-20" tabindex="-1"></a>      Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb38-21"><a href="from-verbal-to-formal-models.html#cb38-21" tabindex="-1"></a>    }</span>
<span id="cb38-22"><a href="from-verbal-to-formal-models.html#cb38-22" tabindex="-1"></a>    </span>
<span id="cb38-23"><a href="from-verbal-to-formal-models.html#cb38-23" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other), agent, rate)</span>
<span id="cb38-24"><a href="from-verbal-to-formal-models.html#cb38-24" tabindex="-1"></a>    </span>
<span id="cb38-25"><a href="from-verbal-to-formal-models.html#cb38-25" tabindex="-1"></a>    <span class="cf">if</span> (agent <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> rate <span class="sc">==</span> <span class="fl">0.5</span>) {df <span class="ot">&lt;-</span> temp} <span class="cf">else</span> {df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, temp)}</span>
<span id="cb38-26"><a href="from-verbal-to-formal-models.html#cb38-26" tabindex="-1"></a>  }</span>
<span id="cb38-27"><a href="from-verbal-to-formal-models.html#cb38-27" tabindex="-1"></a>}</span>
<span id="cb38-28"><a href="from-verbal-to-formal-models.html#cb38-28" tabindex="-1"></a></span>
<span id="cb38-29"><a href="from-verbal-to-formal-models.html#cb38-29" tabindex="-1"></a><span class="do">## WSLS with another WSLS</span></span>
<span id="cb38-30"><a href="from-verbal-to-formal-models.html#cb38-30" tabindex="-1"></a></span>
<span id="cb38-31"><a href="from-verbal-to-formal-models.html#cb38-31" tabindex="-1"></a><span class="cf">for</span> (agent <span class="cf">in</span> <span class="fu">seq</span>(agents)) {</span>
<span id="cb38-32"><a href="from-verbal-to-formal-models.html#cb38-32" tabindex="-1"></a>    Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb38-33"><a href="from-verbal-to-formal-models.html#cb38-33" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb38-34"><a href="from-verbal-to-formal-models.html#cb38-34" tabindex="-1"></a>    </span>
<span id="cb38-35"><a href="from-verbal-to-formal-models.html#cb38-35" tabindex="-1"></a>    Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb38-36"><a href="from-verbal-to-formal-models.html#cb38-36" tabindex="-1"></a>    Other[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb38-37"><a href="from-verbal-to-formal-models.html#cb38-37" tabindex="-1"></a>    </span>
<span id="cb38-38"><a href="from-verbal-to-formal-models.html#cb38-38" tabindex="-1"></a>    </span>
<span id="cb38-39"><a href="from-verbal-to-formal-models.html#cb38-39" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb38-40"><a href="from-verbal-to-formal-models.html#cb38-40" tabindex="-1"></a>      <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb38-41"><a href="from-verbal-to-formal-models.html#cb38-41" tabindex="-1"></a>        Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb38-42"><a href="from-verbal-to-formal-models.html#cb38-42" tabindex="-1"></a>      } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb38-43"><a href="from-verbal-to-formal-models.html#cb38-43" tabindex="-1"></a>      Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb38-44"><a href="from-verbal-to-formal-models.html#cb38-44" tabindex="-1"></a>      Other[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Other[i <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> Feedback)</span>
<span id="cb38-45"><a href="from-verbal-to-formal-models.html#cb38-45" tabindex="-1"></a>    }</span>
<span id="cb38-46"><a href="from-verbal-to-formal-models.html#cb38-46" tabindex="-1"></a>    </span>
<span id="cb38-47"><a href="from-verbal-to-formal-models.html#cb38-47" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other), agent, rate)</span>
<span id="cb38-48"><a href="from-verbal-to-formal-models.html#cb38-48" tabindex="-1"></a>    </span>
<span id="cb38-49"><a href="from-verbal-to-formal-models.html#cb38-49" tabindex="-1"></a>    <span class="cf">if</span> (agent <span class="sc">==</span> <span class="dv">1</span> ) {df1 <span class="ot">&lt;-</span> temp} <span class="cf">else</span> {df1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df1, temp)}</span>
<span id="cb38-50"><a href="from-verbal-to-formal-models.html#cb38-50" tabindex="-1"></a>  }</span></code></pre></div>
<div id="and-we-visualize-it" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> And we visualize it<a href="from-verbal-to-formal-models.html#and-we-visualize-it" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="from-verbal-to-formal-models.html#cb39-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(trial, Feedback, <span class="at">group =</span> rate, <span class="at">color =</span> rate)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="from-verbal-to-formal-models.html#cb39-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/02%20visualizing-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can see that the bigger the bias in the random agent, the bigger the performance in the WSLS (the higher the chances the random agent picks the same hand more than once in a row).</p>
<p>Now it’s your turn to follow a similar process for your 2 chosen strategies.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-verbal-models-of-the-matching-pennies-game.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practical-exercise-3---getting-into-stan.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/03-BuildingFormalModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
