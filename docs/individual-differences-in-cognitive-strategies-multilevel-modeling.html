<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Individual Differences in Cognitive Strategies (Multilevel modeling) | 06-ModelComparison</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Individual Differences in Cognitive Strategies (Multilevel modeling) | 06-ModelComparison" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Individual Differences in Cognitive Strategies (Multilevel modeling) | 06-ModelComparison" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2023-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-quality-assessment.html"/>
<link rel="next" href="model-comparison-in-cognitive-science.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-model"><i class="fa fa-check"></i><b>5.4.4</b> Summarizing the model</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.5</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.6</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.8</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent"><i class="fa fa-check"></i><b>7.4</b> A multilevel version of the biased agent and of the simple memory agent</a></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
<li class="chapter" data-level="7.7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.7.2</b> Assessing multilevel random agents</a></li>
<li class="chapter" data-level="7.7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory"><i class="fa fa-check"></i><b>7.7.3</b> Multilevel memory</a></li>
<li class="chapter" data-level="7.7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.7.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.7.5</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.7.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.7.7</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.7.8</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-no-pooling"><i class="fa fa-check"></i><b>7.7.9</b> Multilevel memory no pooling</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-full-pooling"><i class="fa fa-check"></i><b>7.8</b> Multilevel full pooling</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-parameters"><i class="fa fa-check"></i><b>8.3</b> Define parameters</a></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-biased-and-memory-agents"><i class="fa fa-check"></i><b>8.4</b> Define biased and memory agents</a></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generating-the-agents-1"><i class="fa fa-check"></i><b>8.5</b> Generating the agents</a></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prep-the-data"><i class="fa fa-check"></i><b>8.6</b> Prep the data</a></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#log-posterior-likelihood"><i class="fa fa-check"></i><b>8.7</b> Log posterior likelihood</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#create-the-models-multilevel-biased-agents"><i class="fa fa-check"></i><b>8.8</b> Create the models: multilevel biased agents</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-model"><i class="fa fa-check"></i><b>8.9</b> Multilevel memory model</a></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.10</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#calculating-the-expected-log-predictive-density-of-a-model"><i class="fa fa-check"></i><b>8.11</b> Calculating the expected log predictive density of a model</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.11.1</b> Rant on internal vs external validity</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-cross-validation"><i class="fa fa-check"></i><b>8.12</b> Implementing Cross-Validation</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#create-cross-validation-ready-stan-model-for-biased-agents"><i class="fa fa-check"></i><b>8.12.1</b> Create cross-validation ready stan model for biased agents</a></li>
<li class="chapter" data-level="8.12.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#create-cross-validation-ready-stan-model-for-memory-agents"><i class="fa fa-check"></i><b>8.12.2</b> Create cross-validation ready stan model for memory agents</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#calculating-elpd-and-comparing"><i class="fa fa-check"></i><b>8.13</b> Calculating elpd and comparing</a></li>
<li class="chapter" data-level="8.14" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-techniques"><i class="fa fa-check"></i><b>8.14</b> Limitations of model comparison techniques</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">06-ModelComparison</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="individual-differences-in-cognitive-strategies-multilevel-modeling" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Individual Differences in Cognitive Strategies (Multilevel modeling)<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#individual-differences-in-cognitive-strategies-multilevel-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our exploration of decision-making models has so far focused on single agents or averaged behavior. However, cognitive science reveals that individuals often differ systematically in how they approach tasks and process information. This chapter introduces multilevel modeling as a powerful framework for capturing these individual differences while still identifying population-level patterns.</p>
<p>Consider our matching pennies game: different players might vary in their strategic sophistication, memory capacity, or learning rates. Some may show strong biases toward particular choices while others adapt more flexibly to their opponents. Multilevel modeling allows us to capture these variations while still understanding what patterns hold across the population.</p>
</div>
<div id="learning-objectives-1" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Learning Objectives<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After completing this chapter, you will be able to:</p>
<ul>
<li><p>Understand how multilevel modeling balances individual and group-level information</p></li>
<li><p>Implement multilevel versions of our previous decision-making models</p></li>
<li><p>Compare different approaches to modeling individual variation</p></li>
<li><p>Evaluate model quality through systematic parameter recovery studies</p></li>
<li><p>Apply these techniques to real behavioral data</p></li>
</ul>
</div>
<div id="the-value-of-multilevel-modeling" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> The Value of Multilevel Modeling<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Traditional approaches to handling individual differences often force a choice between two extremes:</p>
<ul>
<li><p>Complete Pooling: Treating all participants as identical by averaging their data together. This approach can mask important individual variations.</p></li>
<li><p>No Pooling: Analyzing each participant separately. This fails to leverage information shared across participants and can lead to unstable estimates.</p></li>
</ul>
<p>Multilevel modeling offers a middle ground through partial pooling. Individual estimates are informed by both individual-level data and the overall population distribution. This approach is particularly valuable when:</p>
<ul>
<li>Data per individual is limited</li>
<li>Individual differences are meaningful but not completely independent</li>
<li>We want to make predictions about new individuals from the same population</li>
</ul>
</div>
<div id="a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> A multilevel version of the biased agent and of the simple memory agent<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#a-multilevel-version-of-the-biased-agent-and-of-the-simple-memory-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are now conceptualizing our agents as being part of (sampled from) a more general population. This general population is characterized by a population level average parameter value (e.g. a general bias of 0.8 as we all like right hands more) and a certain variation in the population (e.g. a standard deviation of 0.1, as we are all a bit different from each other). Each biased agent’s rate is then sampled from that distribution. Same for the memory agents.</p>
<p>[MISSING: DAG PLOTS OF THE TWO SCENARIOS]</p>
<p>Again, it’s practical to work in log odds. Why? Well, it’s not unconceivable that an agent would be 3 sd from the mean. So a biased agent could have a rate of 0.8 + 3 * 0.1, which gives a rate of 1.1. It’s kinda impossible to choose 110% of the time the right hand. We want an easy way to avoid these situations without too carefully tweaking our parameters, or including exception statements (e.g. if rate &gt; 1, then rate = 1). Conversion to log odds is again a wonderful way to work in a boundless space, and in the last step shrinking everything back to 0-1 probability space.</p>
<p>N.B. we model all agents with some added noise as we assume it cannot be eliminated from our studies.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,</span>
<span id="cb109-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-2" tabindex="-1"></a>               here,</span>
<span id="cb109-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-3" tabindex="-1"></a>               posterior,</span>
<span id="cb109-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-4" tabindex="-1"></a>               cmdstanr,</span>
<span id="cb109-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-5" tabindex="-1"></a>               brms, tidybayes, patchwork)</span>
<span id="cb109-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-6" tabindex="-1"></a></span>
<span id="cb109-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-7" tabindex="-1"></a><span class="co"># Shared parameters</span></span>
<span id="cb109-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-8" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb109-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-9" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb109-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-10" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb109-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-11" tabindex="-1"></a></span>
<span id="cb109-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-12" tabindex="-1"></a><span class="co"># Biased agents parameters</span></span>
<span id="cb109-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-13" tabindex="-1"></a>rateM <span class="ot">&lt;-</span> <span class="fl">1.386</span> <span class="co"># roughly 0.8 once inv_logit scaled</span></span>
<span id="cb109-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-14" tabindex="-1"></a>rateSD <span class="ot">&lt;-</span> <span class="fl">0.65</span> <span class="co"># roughly giving a sd of 0.1 in prob scale</span></span>
<span id="cb109-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-15" tabindex="-1"></a></span>
<span id="cb109-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-16" tabindex="-1"></a><span class="co"># Memory agents parameters</span></span>
<span id="cb109-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-17" tabindex="-1"></a>biasM <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb109-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-18" tabindex="-1"></a>biasSD <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb109-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-19" tabindex="-1"></a>betaM <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb109-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb109-20" tabindex="-1"></a>betaSD <span class="ot">&lt;-</span> <span class="fl">0.3</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-1" tabindex="-1"></a><span class="co"># Functions of the agents</span></span>
<span id="cb110-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-2" tabindex="-1"></a>RandomAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(rate, noise) {</span>
<span id="cb110-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-3" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">inv_logit_scaled</span>(rate))</span>
<span id="cb110-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb110-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-5" tabindex="-1"></a>    choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb110-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-6" tabindex="-1"></a>  }</span>
<span id="cb110-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-7" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb110-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-8" tabindex="-1"></a>}</span>
<span id="cb110-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-9" tabindex="-1"></a></span>
<span id="cb110-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-10" tabindex="-1"></a>MemoryAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(bias, beta, otherRate, noise) {</span>
<span id="cb110-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-11" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> <span class="fu">inv_logit_scaled</span>(bias <span class="sc">+</span> beta <span class="sc">*</span> <span class="fu">logit_scaled</span>(otherRate))</span>
<span id="cb110-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-12" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, rate)</span>
<span id="cb110-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-13" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb110-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-14" tabindex="-1"></a>    choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb110-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-15" tabindex="-1"></a>  }</span>
<span id="cb110-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-16" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb110-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb110-17" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="generating-the-agents" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Generating the agents<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>[MISSING: PARALLELIZE]</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-1" tabindex="-1"></a><span class="co"># Looping through all the agents to generate the data.</span></span>
<span id="cb111-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb111-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-3" tabindex="-1"></a></span>
<span id="cb111-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-4" tabindex="-1"></a><span class="cf">for</span> (agent <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb111-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-5" tabindex="-1"></a>  </span>
<span id="cb111-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-6" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, rateM, rateSD)</span>
<span id="cb111-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-7" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, biasM, biasSD)</span>
<span id="cb111-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-8" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, betaM, betaSD)</span>
<span id="cb111-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-9" tabindex="-1"></a>  </span>
<span id="cb111-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-10" tabindex="-1"></a>  randomChoice <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb111-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-11" tabindex="-1"></a>  memoryChoice <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb111-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-12" tabindex="-1"></a>  memoryRate <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb111-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-13" tabindex="-1"></a>  </span>
<span id="cb111-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-14" tabindex="-1"></a>  <span class="cf">for</span> (trial <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>trials) {</span>
<span id="cb111-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-15" tabindex="-1"></a>    </span>
<span id="cb111-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-16" tabindex="-1"></a>    randomChoice[trial] <span class="ot">&lt;-</span> <span class="fu">RandomAgentNoise_f</span>(rate, noise)</span>
<span id="cb111-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-17" tabindex="-1"></a>    <span class="cf">if</span> (trial <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb111-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-18" tabindex="-1"></a>      memoryChoice[trial] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb111-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-19" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb111-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-20" tabindex="-1"></a>      memoryChoice[trial] <span class="ot">&lt;-</span> <span class="fu">MemoryAgentNoise_f</span>(bias, beta, <span class="fu">mean</span>(randomChoice[<span class="dv">1</span><span class="sc">:</span>trial], <span class="at">na.rm =</span> T), noise)</span>
<span id="cb111-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-21" tabindex="-1"></a>    }</span>
<span id="cb111-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-22" tabindex="-1"></a>  }</span>
<span id="cb111-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-23" tabindex="-1"></a>  </span>
<span id="cb111-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-24" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(agent, <span class="at">trial =</span> <span class="fu">seq</span>(trials), randomChoice, <span class="at">randomRate =</span> rate, memoryChoice, memoryRate, noise, rateM, rateSD, bias, beta, biasM, biasSD, betaM, betaSD)</span>
<span id="cb111-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-25" tabindex="-1"></a>  </span>
<span id="cb111-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-26" tabindex="-1"></a>  <span class="cf">if</span> (agent <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb111-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-27" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d, temp)</span>
<span id="cb111-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-28" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb111-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-29" tabindex="-1"></a>    d <span class="ot">&lt;-</span> temp</span>
<span id="cb111-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-30" tabindex="-1"></a>  }</span>
<span id="cb111-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-31" tabindex="-1"></a>  </span>
<span id="cb111-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-32" tabindex="-1"></a>}</span>
<span id="cb111-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-33" tabindex="-1"></a></span>
<span id="cb111-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-34" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(agent) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb111-35"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-35" tabindex="-1"></a>  <span class="at">randomRate =</span> <span class="fu">cumsum</span>(randomChoice) <span class="sc">/</span> <span class="fu">seq_along</span>(randomChoice),</span>
<span id="cb111-36"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-36" tabindex="-1"></a>  <span class="at">memoryRate =</span> <span class="fu">cumsum</span>(memoryChoice) <span class="sc">/</span> <span class="fu">seq_along</span>(memoryChoice)</span>
<span id="cb111-37"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb111-37" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="plotting-the-agents" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Plotting the agents<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-1" tabindex="-1"></a><span class="co"># A plot of the proportion of right hand choices for the random agents</span></span>
<span id="cb112-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, randomRate, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span> </span>
<span id="cb112-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb112-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb112-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-5" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb112-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span>
<span id="cb112-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-7" tabindex="-1"></a><span class="co"># A plot of the proportion of right hand choices for the memory agents</span></span>
<span id="cb112-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, memoryRate, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span> </span>
<span id="cb112-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb112-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb112-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb112-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-12" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span>
<span id="cb112-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb112-13" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/Plotitng%20the%20agents-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-1" tabindex="-1"></a><span class="co"># A plot of whether memory and random agents are matched in proportion at different stages</span></span>
<span id="cb113-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-2" tabindex="-1"></a></span>
<span id="cb113-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-3" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">subset</span>(trial <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(randomRate, memoryRate)) <span class="sc">+</span></span>
<span id="cb113-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb113-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-6" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-7" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.25</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-8" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.25</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;correlation at 10 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb113-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-11" tabindex="-1"></a></span>
<span id="cb113-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-12" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">subset</span>(trial <span class="sc">==</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(randomRate, memoryRate)) <span class="sc">+</span></span>
<span id="cb113-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-13" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-14" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb113-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-15" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-16" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.25</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-17" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.25</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-18" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;correlation at 60 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-19" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb113-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-20" tabindex="-1"></a></span>
<span id="cb113-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-21" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">subset</span>(trial <span class="sc">==</span> <span class="dv">120</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(randomRate, memoryRate)) <span class="sc">+</span></span>
<span id="cb113-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-22" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-23" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb113-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-24" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-25" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.25</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-26" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.25</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-27" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;correlation at 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-28" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb113-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-29" tabindex="-1"></a></span>
<span id="cb113-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb113-30" tabindex="-1"></a>p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5</span></code></pre></div>
<p><img src="series_files/figure-html/Plotitng%20the%20agents-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note that as the n of trials increases, the memory model matches the random model better and better</p>
</div>
<div id="coding-the-multilevel-agents" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Coding the multilevel agents<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="multilevel-random" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Multilevel random<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Remember that the simulated parameters are:
* biasM &lt;- 0
* biasSD &lt;- 0.1
* betaM &lt;- 1.5
* betaSD &lt;- 0.3</p>
<p>Prep the data</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-2" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, randomChoice)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb114-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> randomChoice)</span>
<span id="cb114-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-5" tabindex="-1"></a></span>
<span id="cb114-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-6" tabindex="-1"></a><span class="do">## Create the data</span></span>
<span id="cb114-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb114-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-8" tabindex="-1"></a>  <span class="at">trials =</span> trials,</span>
<span id="cb114-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-9" tabindex="-1"></a>  <span class="at">agents =</span> agents,</span>
<span id="cb114-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-10" tabindex="-1"></a>  <span class="at">h =</span> <span class="fu">as.matrix</span>(d1[,<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>])</span>
<span id="cb114-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb114-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-1" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb115-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-2" tabindex="-1"></a><span class="st">/* Multilevel Bernoulli Model</span></span>
<span id="cb115-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-3" tabindex="-1"></a><span class="st"> * This model infers agent-specific choice biases from sequences of binary choices (0/1)</span></span>
<span id="cb115-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-4" tabindex="-1"></a><span class="st"> * The model assumes each agent has their own bias (theta) drawn from a population distribution</span></span>
<span id="cb115-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-5" tabindex="-1"></a><span class="st"> */</span></span>
<span id="cb115-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-6" tabindex="-1"></a></span>
<span id="cb115-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-7" tabindex="-1"></a><span class="st">functions {</span></span>
<span id="cb115-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-8" tabindex="-1"></a><span class="st">  // Generate random numbers from truncated normal distribution</span></span>
<span id="cb115-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-9" tabindex="-1"></a><span class="st">  real normal_lb_rng(real mu, real sigma, real lb) {</span></span>
<span id="cb115-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-10" tabindex="-1"></a><span class="st">    real p = normal_cdf(lb | mu, sigma);</span></span>
<span id="cb115-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-11" tabindex="-1"></a><span class="st">    real u = uniform_rng(p, 1);</span></span>
<span id="cb115-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-12" tabindex="-1"></a><span class="st">    return (sigma * inv_Phi(u)) + mu;</span></span>
<span id="cb115-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-13" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb115-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-14" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb115-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-15" tabindex="-1"></a></span>
<span id="cb115-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-16" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb115-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-17" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; trials;  // Number of trials per agent</span></span>
<span id="cb115-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-18" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; agents;  // Number of agents</span></span>
<span id="cb115-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-19" tabindex="-1"></a><span class="st">  array[trials, agents] int&lt;lower=0, upper=1&gt; h;  // Choice data: 0 or 1 for each trial/agent</span></span>
<span id="cb115-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-20" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb115-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-21" tabindex="-1"></a></span>
<span id="cb115-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-22" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb115-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-23" tabindex="-1"></a><span class="st">  real thetaM;                // Population-level mean bias (log-odds scale)</span></span>
<span id="cb115-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-24" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; thetaSD;      // Population-level SD of bias</span></span>
<span id="cb115-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-25" tabindex="-1"></a><span class="st">  array[agents] real theta;    // Agent-specific biases (log-odds scale)</span></span>
<span id="cb115-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-26" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb115-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-27" tabindex="-1"></a></span>
<span id="cb115-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-28" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb115-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-29" tabindex="-1"></a><span class="st">  // Population-level priors</span></span>
<span id="cb115-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-30" tabindex="-1"></a><span class="st">  target += normal_lpdf(thetaM | 0, 1);        // Prior for population mean </span></span>
<span id="cb115-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-31" tabindex="-1"></a><span class="st">  target += normal_lpdf(thetaSD | 0, 0.3)      // Half-normal prior for population SD</span></span>
<span id="cb115-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-32" tabindex="-1"></a><span class="st">    - normal_lccdf(0 | 0, 0.3);</span></span>
<span id="cb115-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-33" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb115-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-34" tabindex="-1"></a><span class="st">  // Agent-level model</span></span>
<span id="cb115-35"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-35" tabindex="-1"></a><span class="st">  target += normal_lpdf(theta | thetaM, thetaSD);    // Agent biases drawn from population</span></span>
<span id="cb115-36"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-36" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb115-37"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-37" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb115-38"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-38" tabindex="-1"></a><span class="st">  for (i in 1:agents) {</span></span>
<span id="cb115-39"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-39" tabindex="-1"></a><span class="st">    target += bernoulli_logit_lpmf(h[,i] | theta[i]);  // Choice likelihood</span></span>
<span id="cb115-40"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-40" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb115-41"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-41" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb115-42"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-42" tabindex="-1"></a></span>
<span id="cb115-43"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-43" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb115-44"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-44" tabindex="-1"></a><span class="st">  // Prior predictive samples</span></span>
<span id="cb115-45"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-45" tabindex="-1"></a><span class="st">  real thetaM_prior = normal_rng(0, 1);</span></span>
<span id="cb115-46"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-46" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; thetaSD_prior = normal_lb_rng(0, 0.3, 0);</span></span>
<span id="cb115-47"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-47" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; theta_prior = inv_logit(normal_rng(thetaM_prior, thetaSD_prior));</span></span>
<span id="cb115-48"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-48" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb115-49"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-49" tabindex="-1"></a><span class="st">  // Posterior predictive samples </span></span>
<span id="cb115-50"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-50" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; theta_posterior = inv_logit(normal_rng(thetaM, thetaSD));</span></span>
<span id="cb115-51"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-51" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb115-52"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-52" tabindex="-1"></a><span class="st">  // Predictive simulations</span></span>
<span id="cb115-53"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-53" tabindex="-1"></a><span class="st">  int&lt;lower=0, upper=trials&gt; prior_preds = binomial_rng(trials, inv_logit(thetaM_prior));</span></span>
<span id="cb115-54"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-54" tabindex="-1"></a><span class="st">  int&lt;lower=0, upper=trials&gt; posterior_preds = binomial_rng(trials, inv_logit(thetaM));</span></span>
<span id="cb115-55"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-55" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb115-56"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-56" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb115-57"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-57" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb115-58"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-58" tabindex="-1"></a>  stan_model,</span>
<span id="cb115-59"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-59" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb115-60"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-60" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W5_MultilevelBias.stan&quot;</span>)</span>
<span id="cb115-61"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-61" tabindex="-1"></a></span>
<span id="cb115-62"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-62" tabindex="-1"></a><span class="co"># Commented to ensure fast compiling time for the book. Uncomment to run the code.</span></span>
<span id="cb115-63"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-63" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W5_MultilevelBias.stan&quot;</span>)</span>
<span id="cb115-64"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-64" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file,</span>
<span id="cb115-65"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-65" tabindex="-1"></a>                     <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb115-66"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-66" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span>
<span id="cb115-67"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-67" tabindex="-1"></a></span>
<span id="cb115-68"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-68" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb115-69"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-69" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb115-70"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-70" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb115-71"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-71" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb115-72"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-72" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb115-73"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-73" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb115-74"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-74" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb115-75"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-75" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb115-76"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-76" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb115-77"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-77" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb115-78"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-78" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb115-79"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-79" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb115-80"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-80" tabindex="-1"></a>)</span>
<span id="cb115-81"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-81" tabindex="-1"></a></span>
<span id="cb115-82"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-82" tabindex="-1"></a><span class="co"># Save both object and CSV files</span></span>
<span id="cb115-83"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb115-83" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="at">file =</span> <span class="st">&quot;simmodels/W5_MultilevelBias.RDS&quot;</span>)</span></code></pre></div>
</div>
<div id="assessing-multilevel-random-agents" class="section level3 hasAnchor" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> Assessing multilevel random agents<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Besides the usual prior predictive checks, prior posterior update checks, posterior predictive checks, based on the population level estimates; we also want to plot at least a few of the single agents to assess how well the model is doing for them.</p>
<p>[MISSING: PLOT MODEL ESTIMATES AGAINST N OF HEADS BY PARTICIPANT]</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb116-1" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/W5_MultilevelBias.RDS&quot;</span>)</span>
<span id="cb116-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb116-2" tabindex="-1"></a><span class="co">#samples$cmdstan_diagnose()</span></span>
<span id="cb116-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb116-3" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">summary</span>() </span></code></pre></div>
<pre><code>## # A tibble: 109 × 10
##    variable      mean    median     sd    mad        q5       q95  rhat ess_bulk ess_tail
##    &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 lp__     -5816.    -5816.    7.31   7.12   -5828.    -5804.     1.00    1617.    2067.
##  2 thetaM       1.47      1.47  0.0612 0.0607     1.37      1.57   1.00    4675.    3138.
##  3 thetaSD      0.553     0.551 0.0455 0.0448     0.481     0.634  1.00    3169.    2902.
##  4 theta[1]     1.87      1.87  0.242  0.242      1.49      2.27   1.00    6087.    3225.
##  5 theta[2]     2.06      2.04  0.255  0.258      1.65      2.49   1.00    5572.    2964.
##  6 theta[3]     1.41      1.41  0.212  0.217      1.07      1.75   1.00    5623.    2664.
##  7 theta[4]     1.99      1.98  0.257  0.254      1.57      2.42   1.00    6618.    2740.
##  8 theta[5]     2.34      2.33  0.284  0.282      1.89      2.82   1.00    6527.    2614.
##  9 theta[6]     1.37      1.36  0.210  0.215      1.03      1.72   1.00    6795.    2532.
## 10 theta[7]     1.55      1.55  0.228  0.234      1.18      1.92   1.00    5341.    2615.
## # ℹ 99 more rows</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb118-1" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb118-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb118-2" tabindex="-1"></a></span>
<span id="cb118-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb118-3" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, thetaM, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb118-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb118-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb118-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb118-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20pop%20level%20features%20of%20multilevel%20random%20agents-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb119-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, thetaSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb119-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb119-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb119-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb119-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20pop%20level%20features%20of%20multilevel%20random%20agents-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb120-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb120-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb120-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(prior_preds), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb120-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb120-3" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb120-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb120-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Prior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb120-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb120-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20pop%20level%20features%20of%20multilevel%20random%20agents-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb121-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb121-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb121-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(thetaM), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb121-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb121-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(thetaM_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb121-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb121-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.386</span>) <span class="sc">+</span></span>
<span id="cb121-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb121-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb121-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb121-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb121-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb121-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20pop%20level%20features%20of%20multilevel%20random%20agents-4.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb122-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb122-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb122-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(thetaSD), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb122-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb122-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(thetaSD_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb122-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb122-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb122-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb122-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variance of Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb122-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb122-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20pop%20level%20features%20of%20multilevel%20random%20agents-5.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb123-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb123-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb123-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta_posterior), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb123-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb123-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb123-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb123-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Overall Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb123-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb123-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20pop%20level%20features%20of%20multilevel%20random%20agents-6.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb124-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb124-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb124-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(prior_preds), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb124-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb124-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(posterior_preds), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb124-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb124-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb124-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Predictive Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb124-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20pop%20level%20features%20of%20multilevel%20random%20agents-7.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb125-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[1]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[15]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;green&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[21]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[31]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[41]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[51]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-8" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[61]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(thetaM_prior)), <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-10" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(theta_prior), <span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb125-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb125-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb125-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20individual%20level%20features%20of%20multilevel%20random%20agents-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-1" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> draws_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb126-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-2" tabindex="-1"></a>  <span class="at">preds1 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[1]</span><span class="st">`</span>)),</span>
<span id="cb126-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-3" tabindex="-1"></a>  <span class="at">preds11 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[11]</span><span class="st">`</span>)),</span>
<span id="cb126-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-4" tabindex="-1"></a>  <span class="at">preds21 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[21]</span><span class="st">`</span>)),</span>
<span id="cb126-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-5" tabindex="-1"></a>  <span class="at">preds31 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[31]</span><span class="st">`</span>)),</span>
<span id="cb126-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-6" tabindex="-1"></a>  <span class="at">preds41 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[41]</span><span class="st">`</span>)),</span>
<span id="cb126-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-7" tabindex="-1"></a>  <span class="at">preds51 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[51]</span><span class="st">`</span>)),</span>
<span id="cb126-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-8" tabindex="-1"></a>  <span class="at">preds61 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[61]</span><span class="st">`</span>)),</span>
<span id="cb126-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-9" tabindex="-1"></a>  <span class="at">preds71 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[71]</span><span class="st">`</span>)),</span>
<span id="cb126-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-10" tabindex="-1"></a>  <span class="at">preds81 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[81]</span><span class="st">`</span>)),</span>
<span id="cb126-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-11" tabindex="-1"></a>  <span class="at">preds91 =</span> <span class="fu">rbinom</span>(<span class="dv">4000</span>,<span class="dv">120</span>, <span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">theta[91]</span><span class="st">`</span>)),</span>
<span id="cb126-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-12" tabindex="-1"></a>)</span>
<span id="cb126-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-13" tabindex="-1"></a></span>
<span id="cb126-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-14" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(agent) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">right =</span> <span class="fu">sum</span>(randomChoice))</span>
<span id="cb126-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-15" tabindex="-1"></a></span>
<span id="cb126-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-16" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb126-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-17" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(posterior_preds), <span class="at">color =</span> <span class="st">&quot;skyblue1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb126-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-18" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">data =</span> d2, <span class="fu">aes</span>(right),  <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb126-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-19" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-20" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb126-21" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20individual%20level%20features%20of%20multilevel%20random%20agents-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb127-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(preds1), <span class="at">color =</span> <span class="st">&quot;skyblue1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb127-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="fu">subset</span>(d2, agent <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">$</span>right, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-4" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb127-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-5" tabindex="-1"></a></span>
<span id="cb127-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-6" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb127-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-7" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(preds11), <span class="at">color =</span> <span class="st">&quot;skyblue1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb127-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="fu">subset</span>(d2, agent <span class="sc">==</span> <span class="dv">11</span>)<span class="sc">$</span>right, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb127-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-10" tabindex="-1"></a>  </span>
<span id="cb127-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-11" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb127-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-12" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(preds21), <span class="at">color =</span> <span class="st">&quot;skyblue1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb127-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="fu">subset</span>(d2, agent <span class="sc">==</span> <span class="dv">21</span>)<span class="sc">$</span>right, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-14" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb127-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-15" tabindex="-1"></a></span>
<span id="cb127-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-16" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb127-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb127-17" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20individual%20level%20features%20of%20multilevel%20random%20agents-3.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="multilevel-memory" class="section level3 hasAnchor" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> Multilevel memory<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>[MISSING: DAGS]
[MISSING: EXPLAIN NEW STAN CODE]
[MISSING: POP VS IND LEVEL PREDICTIONS]</p>
<p>Prep the data</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-1" tabindex="-1"></a><span class="do">## Create the data </span></span>
<span id="cb128-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb128-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-3" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, memoryChoice)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb128-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-5" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> memoryChoice)</span>
<span id="cb128-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-6" tabindex="-1"></a></span>
<span id="cb128-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-7" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb128-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-8" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, randomChoice)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb128-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-10" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> randomChoice)</span>
<span id="cb128-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-11" tabindex="-1"></a></span>
<span id="cb128-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-12" tabindex="-1"></a></span>
<span id="cb128-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-13" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb128-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-14" tabindex="-1"></a>  <span class="at">trials =</span> trials,</span>
<span id="cb128-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-15" tabindex="-1"></a>  <span class="at">agents =</span> agents,</span>
<span id="cb128-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-16" tabindex="-1"></a>  <span class="at">h =</span> <span class="fu">as.matrix</span>(d1[<span class="dv">1</span><span class="sc">:</span><span class="dv">120</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>]),</span>
<span id="cb128-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-17" tabindex="-1"></a>  <span class="at">other =</span> <span class="fu">as.matrix</span>(d2[<span class="dv">1</span><span class="sc">:</span><span class="dv">120</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>])</span>
<span id="cb128-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb128-18" tabindex="-1"></a>)</span></code></pre></div>
<p>Code, compile and fit the model</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-1" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb129-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-2" tabindex="-1"></a><span class="st">//</span></span>
<span id="cb129-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-3" tabindex="-1"></a><span class="st">//</span></span>
<span id="cb129-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-4" tabindex="-1"></a><span class="st">functions{</span></span>
<span id="cb129-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-5" tabindex="-1"></a><span class="st">  real normal_lb_rng(real mu, real sigma, real lb) {</span></span>
<span id="cb129-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-6" tabindex="-1"></a><span class="st">    real p = normal_cdf(lb | mu, sigma);  // cdf for bounds</span></span>
<span id="cb129-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-7" tabindex="-1"></a><span class="st">    real u = uniform_rng(p, 1);</span></span>
<span id="cb129-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-8" tabindex="-1"></a><span class="st">    return (sigma * inv_Phi(u)) + mu;  // inverse cdf for value</span></span>
<span id="cb129-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-9" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb129-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-10" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb129-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-11" tabindex="-1"></a></span>
<span id="cb129-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-12" tabindex="-1"></a><span class="st">// The input (data) for the model. </span></span>
<span id="cb129-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-13" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb129-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-14" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; trials;</span></span>
<span id="cb129-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-15" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; agents;</span></span>
<span id="cb129-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-16" tabindex="-1"></a><span class="st"> array[trials, agents] int h;</span></span>
<span id="cb129-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-17" tabindex="-1"></a><span class="st"> array[trials, agents] int other;</span></span>
<span id="cb129-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-18" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb129-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-19" tabindex="-1"></a></span>
<span id="cb129-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-20" tabindex="-1"></a><span class="st">// The parameters accepted by the model. </span></span>
<span id="cb129-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-21" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb129-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-22" tabindex="-1"></a><span class="st">  real biasM;</span></span>
<span id="cb129-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-23" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; biasSD;</span></span>
<span id="cb129-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-24" tabindex="-1"></a><span class="st">  real betaM;</span></span>
<span id="cb129-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-25" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; betaSD;</span></span>
<span id="cb129-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-26" tabindex="-1"></a><span class="st">  array[agents] real bias;</span></span>
<span id="cb129-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-27" tabindex="-1"></a><span class="st">  array[agents] real beta;</span></span>
<span id="cb129-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-28" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb129-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-29" tabindex="-1"></a></span>
<span id="cb129-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-30" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb129-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-31" tabindex="-1"></a><span class="st">  array[trials, agents] real memory;</span></span>
<span id="cb129-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-32" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb129-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-33" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb129-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-34" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb129-35"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-35" tabindex="-1"></a><span class="st">      if (trial == 1) {</span></span>
<span id="cb129-36"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-36" tabindex="-1"></a><span class="st">        memory[trial, agent] = 0.5;</span></span>
<span id="cb129-37"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-37" tabindex="-1"></a><span class="st">      } </span></span>
<span id="cb129-38"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-38" tabindex="-1"></a><span class="st">      if (trial &lt; trials){</span></span>
<span id="cb129-39"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-39" tabindex="-1"></a><span class="st">        memory[trial + 1, agent] = memory[trial, agent] + ((other[trial, agent] - memory[trial, agent]) / trial);</span></span>
<span id="cb129-40"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-40" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 0){memory[trial + 1, agent] = 0.01;}</span></span>
<span id="cb129-41"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-41" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 1){memory[trial + 1, agent] = 0.99;}</span></span>
<span id="cb129-42"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-42" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb129-43"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-43" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb129-44"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-44" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb129-45"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-45" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb129-46"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-46" tabindex="-1"></a></span>
<span id="cb129-47"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-47" tabindex="-1"></a></span>
<span id="cb129-48"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-48" tabindex="-1"></a><span class="st">// The model to be estimated. </span></span>
<span id="cb129-49"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-49" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb129-50"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-50" tabindex="-1"></a><span class="st">  target += normal_lpdf(biasM | 0, 1);</span></span>
<span id="cb129-51"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-51" tabindex="-1"></a><span class="st">  target += normal_lpdf(biasSD | 0, .3)  -</span></span>
<span id="cb129-52"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-52" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb129-53"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-53" tabindex="-1"></a><span class="st">  target += normal_lpdf(betaM | 0, .3);</span></span>
<span id="cb129-54"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-54" tabindex="-1"></a><span class="st">  target += normal_lpdf(betaSD | 0, .3)  -</span></span>
<span id="cb129-55"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-55" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb129-56"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-56" tabindex="-1"></a></span>
<span id="cb129-57"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-57" tabindex="-1"></a><span class="st">  target += normal_lpdf(bias | biasM, biasSD); </span></span>
<span id="cb129-58"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-58" tabindex="-1"></a><span class="st">  target += normal_lpdf(beta | betaM, betaSD); </span></span>
<span id="cb129-59"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-59" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb129-60"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-60" tabindex="-1"></a><span class="st">  for (agent in 1:agents)</span></span>
<span id="cb129-61"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-61" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb129-62"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-62" tabindex="-1"></a><span class="st">      target += bernoulli_logit_lpmf(h[trial,agent] | </span></span>
<span id="cb129-63"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-63" tabindex="-1"></a><span class="st">            bias[agent] +  logit(memory[trial, agent]) * (beta[agent]));</span></span>
<span id="cb129-64"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-64" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb129-65"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-65" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb129-66"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-66" tabindex="-1"></a></span>
<span id="cb129-67"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-67" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb129-68"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-68" tabindex="-1"></a><span class="st">   real biasM_prior;</span></span>
<span id="cb129-69"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-69" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; biasSD_prior;</span></span>
<span id="cb129-70"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-70" tabindex="-1"></a><span class="st">   real betaM_prior;</span></span>
<span id="cb129-71"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-71" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; betaSD_prior;</span></span>
<span id="cb129-72"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-72" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb129-73"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-73" tabindex="-1"></a><span class="st">   real bias_prior;</span></span>
<span id="cb129-74"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-74" tabindex="-1"></a><span class="st">   real beta_prior;</span></span>
<span id="cb129-75"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-75" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb129-76"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-76" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds0;</span></span>
<span id="cb129-77"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-77" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds1;</span></span>
<span id="cb129-78"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-78" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds2;</span></span>
<span id="cb129-79"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-79" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; posterior_preds0;</span></span>
<span id="cb129-80"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-80" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; posterior_preds1;</span></span>
<span id="cb129-81"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-81" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; posterior_preds2;</span></span>
<span id="cb129-82"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-82" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_predsID0;</span></span>
<span id="cb129-83"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-83" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_predsID1;</span></span>
<span id="cb129-84"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-84" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_predsID2;</span></span>
<span id="cb129-85"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-85" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb129-86"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-86" tabindex="-1"></a><span class="st">   biasM_prior = normal_rng(0,1);</span></span>
<span id="cb129-87"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-87" tabindex="-1"></a><span class="st">   biasSD_prior = normal_lb_rng(0,0.3,0);</span></span>
<span id="cb129-88"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-88" tabindex="-1"></a><span class="st">   betaM_prior = normal_rng(0,1);</span></span>
<span id="cb129-89"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-89" tabindex="-1"></a><span class="st">   betaSD_prior = normal_lb_rng(0,0.3,0);</span></span>
<span id="cb129-90"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-90" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb129-91"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-91" tabindex="-1"></a><span class="st">   bias_prior = normal_rng(biasM_prior, biasSD_prior);</span></span>
<span id="cb129-92"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-92" tabindex="-1"></a><span class="st">   beta_prior = normal_rng(betaM_prior, betaSD_prior);</span></span>
<span id="cb129-93"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-93" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb129-94"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-94" tabindex="-1"></a><span class="st">   prior_preds0 = binomial_rng(trials, inv_logit(bias_prior + 0 * beta_prior));</span></span>
<span id="cb129-95"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-95" tabindex="-1"></a><span class="st">   prior_preds1 = binomial_rng(trials, inv_logit(bias_prior + 1 * beta_prior));</span></span>
<span id="cb129-96"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-96" tabindex="-1"></a><span class="st">   prior_preds2 = binomial_rng(trials, inv_logit(bias_prior + 2 * beta_prior));</span></span>
<span id="cb129-97"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-97" tabindex="-1"></a><span class="st">   posterior_preds0 = binomial_rng(trials, inv_logit(biasM + 0 * betaM));</span></span>
<span id="cb129-98"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-98" tabindex="-1"></a><span class="st">   posterior_preds1 = binomial_rng(trials, inv_logit(biasM + 1 * betaM));</span></span>
<span id="cb129-99"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-99" tabindex="-1"></a><span class="st">   posterior_preds2 = binomial_rng(trials, inv_logit(biasM + 2 * betaM));</span></span>
<span id="cb129-100"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-100" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb129-101"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-101" tabindex="-1"></a></span>
<span id="cb129-102"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-102" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb129-103"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-103" tabindex="-1"></a><span class="st">    posterior_predsID0[agent] = binomial_rng(trials, inv_logit(bias[agent] +  0 * beta[agent]));</span></span>
<span id="cb129-104"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-104" tabindex="-1"></a><span class="st">      posterior_predsID1[agent] = binomial_rng(trials, inv_logit(bias[agent] +  1 * beta[agent]));</span></span>
<span id="cb129-105"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-105" tabindex="-1"></a><span class="st">      posterior_predsID2[agent] = binomial_rng(trials, inv_logit(bias[agent] +  2 * beta[agent]));</span></span>
<span id="cb129-106"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-106" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb129-107"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-107" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb129-108"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-108" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb129-109"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-109" tabindex="-1"></a></span>
<span id="cb129-110"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-110" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb129-111"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-111" tabindex="-1"></a></span>
<span id="cb129-112"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-112" tabindex="-1"></a></span>
<span id="cb129-113"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-113" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb129-114"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-114" tabindex="-1"></a>  stan_model,</span>
<span id="cb129-115"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-115" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb129-116"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-116" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W5_MultilevelMemory.stan&quot;</span>)</span>
<span id="cb129-117"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-117" tabindex="-1"></a></span>
<span id="cb129-118"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-118" tabindex="-1"></a><span class="co"># Commented out to ensure faster compiling time for the book. Uncomment to run the code.</span></span>
<span id="cb129-119"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-119" tabindex="-1"></a><span class="co"># file &lt;- file.path(&quot;stan/W5_MultilevelMemory.stan&quot;)</span></span>
<span id="cb129-120"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-120" tabindex="-1"></a><span class="co"># mod &lt;- cmdstan_model(file, </span></span>
<span id="cb129-121"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-121" tabindex="-1"></a><span class="co">#                      cpp_options = list(stan_threads = TRUE),</span></span>
<span id="cb129-122"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-122" tabindex="-1"></a><span class="co">#                      stanc_options = list(&quot;O1&quot;))</span></span>
<span id="cb129-123"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-123" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-124"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-124" tabindex="-1"></a><span class="co"># # The following command calls Stan with specific options.</span></span>
<span id="cb129-125"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-125" tabindex="-1"></a><span class="co"># samples &lt;- mod$sample(</span></span>
<span id="cb129-126"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-126" tabindex="-1"></a><span class="co">#   data = data,</span></span>
<span id="cb129-127"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-127" tabindex="-1"></a><span class="co">#   seed = 123,</span></span>
<span id="cb129-128"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-128" tabindex="-1"></a><span class="co">#   chains = 2,</span></span>
<span id="cb129-129"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-129" tabindex="-1"></a><span class="co">#   parallel_chains = 2,</span></span>
<span id="cb129-130"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-130" tabindex="-1"></a><span class="co">#   threads_per_chain = 2,</span></span>
<span id="cb129-131"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-131" tabindex="-1"></a><span class="co">#   iter_warmup = 2000,</span></span>
<span id="cb129-132"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-132" tabindex="-1"></a><span class="co">#   iter_sampling = 2000,</span></span>
<span id="cb129-133"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-133" tabindex="-1"></a><span class="co">#   refresh = 500,</span></span>
<span id="cb129-134"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-134" tabindex="-1"></a><span class="co">#   max_treedepth = 20,</span></span>
<span id="cb129-135"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-135" tabindex="-1"></a><span class="co">#   adapt_delta = 0.99,</span></span>
<span id="cb129-136"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-136" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb129-137"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-137" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-138"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb129-138" tabindex="-1"></a><span class="co"># samples$save_object(file = &quot;simmodels/W5_MultilevelMemory_centered.RDS&quot;)</span></span></code></pre></div>
</div>
<div id="assessing-multilevel-memory" class="section level3 hasAnchor" number="7.7.4">
<h3><span class="header-section-number">7.7.4</span> Assessing multilevel memory<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb130-1" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/W5_MultilevelMemory_centered.RDS&quot;</span>)</span>
<span id="cb130-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb130-2" tabindex="-1"></a></span>
<span id="cb130-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb130-3" tabindex="-1"></a><span class="co">#samples$cmdstan_diagnose()</span></span>
<span id="cb130-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb130-4" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;biasM&quot;</span>, <span class="st">&quot;betaM&quot;</span>, <span class="st">&quot;biasSD&quot;</span>, <span class="st">&quot;betaSD&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 10
##   variable  mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
##   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 biasM    0.572  0.570 0.0813 0.0821 0.441 0.708  1.00     398.    1075.
## 2 betaM    0.924  0.923 0.0619 0.0617 0.823 1.02   1.00     475.    1116.
## 3 biasSD   0.307  0.307 0.0620 0.0623 0.206 0.410  1.00     334.     460.
## 4 betaSD   0.289  0.287 0.0480 0.0467 0.212 0.370  1.00     796.    1025.</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-1" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb132-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-2" tabindex="-1"></a></span>
<span id="cb132-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, biasM, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb132-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb132-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb132-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-6" tabindex="-1"></a></span>
<span id="cb132-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, biasSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb132-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb132-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb132-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-10" tabindex="-1"></a></span>
<span id="cb132-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-11" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, betaM, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb132-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-12" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb132-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb132-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-14" tabindex="-1"></a></span>
<span id="cb132-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-15" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, betaSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb132-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-16" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb132-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-17" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb132-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-18" tabindex="-1"></a></span>
<span id="cb132-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb132-19" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20centered:%20markov%20chains-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="predictive-prior-checks" class="section level4 hasAnchor" number="7.7.4.1">
<h4><span class="header-section-number">7.7.4.1</span> Predictive prior checks<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#predictive-prior-checks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-1" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb133-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-2" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb133-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds0</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb133-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds1</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;green&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb133-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds2</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb133-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb133-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20centered:%20prior%20checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="prior-posterior-update-checks" class="section level4 hasAnchor" number="7.7.4.2">
<h4><span class="header-section-number">7.7.4.2</span> Prior posterior update checks<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-posterior-update-checks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>biasM &lt;- 0
biasSD &lt;- 0.1
betaM &lt;- 1.5
betaSD &lt;- 0.3</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-1" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb134-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb134-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(biasM), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(biasM_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb134-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb134-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-9" tabindex="-1"></a></span>
<span id="cb134-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-10" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb134-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-11" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(biasSD), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-12" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(biasSD_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-13" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb134-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-14" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variance of bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-15" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-16" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb134-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-17" tabindex="-1"></a></span>
<span id="cb134-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-18" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb134-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-19" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaM), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-20" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaM_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-21" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb134-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-22" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-23" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-24" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb134-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-25" tabindex="-1"></a></span>
<span id="cb134-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-26" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb134-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-27" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaSD), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-28" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaSD_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-29" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-30" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variance of beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-31" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-32" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb134-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-33" tabindex="-1"></a></span>
<span id="cb134-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb134-34" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 </span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20centered:%20prior%20posterior%20update%20checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="posterior-predictive-checks-1" class="section level4 hasAnchor" number="7.7.4.3">
<h4><span class="header-section-number">7.7.4.3</span> Posterior predictive checks<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#posterior-predictive-checks-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb135-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds0</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb135-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">posterior_preds0</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb135-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb135-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-7" tabindex="-1"></a></span>
<span id="cb135-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb135-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds1</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb135-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-10" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">posterior_preds1</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb135-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb135-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-14" tabindex="-1"></a></span>
<span id="cb135-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-15" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb135-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-16" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds2</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb135-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-17" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">posterior_preds2</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb135-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-18" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-19" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-20" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb135-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-21" tabindex="-1"></a></span>
<span id="cb135-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb135-22" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20centered:%20posterior%20predictive%20checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(biasM, biasSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb136-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb136-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb136-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-4" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(betaM, betaSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb136-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb136-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb136-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-7" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(biasM, betaM, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb136-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb136-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb136-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-10" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(biasSD, betaSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb136-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb136-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-12" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb136-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-13" tabindex="-1"></a></span>
<span id="cb136-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb136-14" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20centered:%20posterior%20predictive%20checks-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multilevel-memory-with-non-centered-parameterization" class="section level3 hasAnchor" number="7.7.5">
<h3><span class="header-section-number">7.7.5</span> Multilevel memory with non centered parameterization<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prep the data</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-1" tabindex="-1"></a><span class="do">## Create the data </span></span>
<span id="cb137-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb137-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-3" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, memoryChoice)) <span class="sc">%&gt;%</span> </span>
<span id="cb137-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb137-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-5" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> memoryChoice)</span>
<span id="cb137-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-6" tabindex="-1"></a></span>
<span id="cb137-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-7" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb137-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-8" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, randomChoice)) <span class="sc">%&gt;%</span> </span>
<span id="cb137-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb137-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-10" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> randomChoice)</span>
<span id="cb137-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-11" tabindex="-1"></a></span>
<span id="cb137-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-12" tabindex="-1"></a></span>
<span id="cb137-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-13" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb137-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-14" tabindex="-1"></a>  <span class="at">trials =</span> trials,</span>
<span id="cb137-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-15" tabindex="-1"></a>  <span class="at">agents =</span> agents,</span>
<span id="cb137-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-16" tabindex="-1"></a>  <span class="at">h =</span> <span class="fu">as.matrix</span>(d1[<span class="dv">1</span><span class="sc">:</span><span class="dv">120</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>]),</span>
<span id="cb137-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-17" tabindex="-1"></a>  <span class="at">other =</span> <span class="fu">as.matrix</span>(d2[<span class="dv">1</span><span class="sc">:</span><span class="dv">120</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>])</span>
<span id="cb137-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb137-18" tabindex="-1"></a>)</span></code></pre></div>
<p>Code, compile and and fit the model</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-1" tabindex="-1"></a><span class="do">## NON-CENTERED PARAMETRIZATION</span></span>
<span id="cb138-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-2" tabindex="-1"></a></span>
<span id="cb138-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-3" tabindex="-1"></a>stan_model_nc <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb138-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-4" tabindex="-1"></a></span>
<span id="cb138-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-5" tabindex="-1"></a><span class="st">//</span></span>
<span id="cb138-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-6" tabindex="-1"></a><span class="st">// This STAN model is a multilevel memory agent</span></span>
<span id="cb138-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-7" tabindex="-1"></a><span class="st">//</span></span>
<span id="cb138-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-8" tabindex="-1"></a><span class="st">functions{</span></span>
<span id="cb138-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-9" tabindex="-1"></a><span class="st">  real normal_lb_rng(real mu, real sigma, real lb) {</span></span>
<span id="cb138-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-10" tabindex="-1"></a><span class="st">    real p = normal_cdf(lb | mu, sigma);  // cdf for bounds</span></span>
<span id="cb138-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-11" tabindex="-1"></a><span class="st">    real u = uniform_rng(p, 1);</span></span>
<span id="cb138-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-12" tabindex="-1"></a><span class="st">    return (sigma * inv_Phi(u)) + mu;  // inverse cdf for value</span></span>
<span id="cb138-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-13" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb138-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-14" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb138-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-15" tabindex="-1"></a></span>
<span id="cb138-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-16" tabindex="-1"></a><span class="st">// The input (data) for the model. </span></span>
<span id="cb138-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-17" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb138-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-18" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; trials;</span></span>
<span id="cb138-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-19" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; agents;</span></span>
<span id="cb138-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-20" tabindex="-1"></a><span class="st"> array[trials, agents] int h;</span></span>
<span id="cb138-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-21" tabindex="-1"></a><span class="st"> array[trials, agents] int other;</span></span>
<span id="cb138-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-22" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb138-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-23" tabindex="-1"></a></span>
<span id="cb138-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-24" tabindex="-1"></a><span class="st">// The parameters accepted by the model. </span></span>
<span id="cb138-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-25" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb138-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-26" tabindex="-1"></a><span class="st">  real biasM;</span></span>
<span id="cb138-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-27" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; biasSD;</span></span>
<span id="cb138-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-28" tabindex="-1"></a><span class="st">  real betaM;</span></span>
<span id="cb138-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-29" tabindex="-1"></a><span class="st">  real&lt;lower = 0&gt; betaSD;</span></span>
<span id="cb138-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-30" tabindex="-1"></a><span class="st">  vector[agents] biasID_z;</span></span>
<span id="cb138-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-31" tabindex="-1"></a><span class="st">  vector[agents] betaID_z;</span></span>
<span id="cb138-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-32" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb138-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-33" tabindex="-1"></a></span>
<span id="cb138-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-34" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb138-35"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-35" tabindex="-1"></a><span class="st">  array[trials, agents] real memory;</span></span>
<span id="cb138-36"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-36" tabindex="-1"></a><span class="st">  vector[agents] biasID;</span></span>
<span id="cb138-37"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-37" tabindex="-1"></a><span class="st">  vector[agents] betaID;</span></span>
<span id="cb138-38"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-38" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb138-39"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-39" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb138-40"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-40" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb138-41"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-41" tabindex="-1"></a><span class="st">      if (trial == 1) {</span></span>
<span id="cb138-42"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-42" tabindex="-1"></a><span class="st">        memory[trial, agent] = 0.5;</span></span>
<span id="cb138-43"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-43" tabindex="-1"></a><span class="st">      } </span></span>
<span id="cb138-44"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-44" tabindex="-1"></a><span class="st">      if (trial &lt; trials){</span></span>
<span id="cb138-45"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-45" tabindex="-1"></a><span class="st">        memory[trial + 1, agent] = memory[trial, agent] + ((other[trial, agent] - memory[trial, agent]) / trial);</span></span>
<span id="cb138-46"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-46" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 0){memory[trial + 1, agent] = 0.01;}</span></span>
<span id="cb138-47"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-47" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 1){memory[trial + 1, agent] = 0.99;}</span></span>
<span id="cb138-48"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-48" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb138-49"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-49" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb138-50"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-50" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb138-51"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-51" tabindex="-1"></a><span class="st">  biasID = biasID_z * biasSD;</span></span>
<span id="cb138-52"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-52" tabindex="-1"></a><span class="st">  betaID = betaID_z * betaSD;</span></span>
<span id="cb138-53"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-53" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb138-54"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-54" tabindex="-1"></a></span>
<span id="cb138-55"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-55" tabindex="-1"></a><span class="st">// The model to be estimated. </span></span>
<span id="cb138-56"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-56" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb138-57"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-57" tabindex="-1"></a><span class="st">  target += normal_lpdf(biasM | 0, 1);</span></span>
<span id="cb138-58"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-58" tabindex="-1"></a><span class="st">  target += normal_lpdf(biasSD | 0, .3)  -</span></span>
<span id="cb138-59"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-59" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb138-60"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-60" tabindex="-1"></a><span class="st">  target += normal_lpdf(betaM | 0, .3);</span></span>
<span id="cb138-61"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-61" tabindex="-1"></a><span class="st">  target += normal_lpdf(betaSD | 0, .3)  -</span></span>
<span id="cb138-62"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-62" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb138-63"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-63" tabindex="-1"></a></span>
<span id="cb138-64"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-64" tabindex="-1"></a><span class="st">  target += std_normal_lpdf(to_vector(biasID_z)); // target += normal_lpdf(to_vector(biasID_z) | 0, 1);</span></span>
<span id="cb138-65"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-65" tabindex="-1"></a><span class="st">  target += std_normal_lpdf(to_vector(betaID_z)); // target += normal_lpdf(to_vector(betaID_z) | 0, 1);</span></span>
<span id="cb138-66"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-66" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb138-67"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-67" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb138-68"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-68" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb138-69"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-69" tabindex="-1"></a><span class="st">      target += bernoulli_logit_lpmf(h[trial,agent] | </span></span>
<span id="cb138-70"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-70" tabindex="-1"></a><span class="st">            biasM + biasID[agent] +  logit(memory[trial, agent]) * (betaM + betaID[agent]));</span></span>
<span id="cb138-71"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-71" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb138-72"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-72" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb138-73"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-73" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb138-74"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-74" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb138-75"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-75" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb138-76"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-76" tabindex="-1"></a></span>
<span id="cb138-77"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-77" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb138-78"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-78" tabindex="-1"></a><span class="st">   real biasM_prior;</span></span>
<span id="cb138-79"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-79" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; biasSD_prior;</span></span>
<span id="cb138-80"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-80" tabindex="-1"></a><span class="st">   real betaM_prior;</span></span>
<span id="cb138-81"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-81" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; betaSD_prior;</span></span>
<span id="cb138-82"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-82" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb138-83"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-83" tabindex="-1"></a><span class="st">   real bias_prior;</span></span>
<span id="cb138-84"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-84" tabindex="-1"></a><span class="st">   real beta_prior;</span></span>
<span id="cb138-85"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-85" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb138-86"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-86" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; prior_preds0;</span></span>
<span id="cb138-87"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-87" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; prior_preds1;</span></span>
<span id="cb138-88"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-88" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; prior_preds2;</span></span>
<span id="cb138-89"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-89" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds0;</span></span>
<span id="cb138-90"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-90" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds1;</span></span>
<span id="cb138-91"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-91" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds2;</span></span>
<span id="cb138-92"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-92" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb138-93"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-93" tabindex="-1"></a><span class="st">   biasM_prior = normal_rng(0,1);</span></span>
<span id="cb138-94"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-94" tabindex="-1"></a><span class="st">   biasSD_prior = normal_lb_rng(0,0.3,0);</span></span>
<span id="cb138-95"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-95" tabindex="-1"></a><span class="st">   betaM_prior = normal_rng(0,1);</span></span>
<span id="cb138-96"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-96" tabindex="-1"></a><span class="st">   betaSD_prior = normal_lb_rng(0,0.3,0);</span></span>
<span id="cb138-97"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-97" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb138-98"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-98" tabindex="-1"></a><span class="st">   bias_prior = normal_rng(biasM_prior, biasSD_prior);</span></span>
<span id="cb138-99"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-99" tabindex="-1"></a><span class="st">   beta_prior = normal_rng(betaM_prior, betaSD_prior);</span></span>
<span id="cb138-100"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-100" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb138-101"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-101" tabindex="-1"></a></span>
<span id="cb138-102"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-102" tabindex="-1"></a></span>
<span id="cb138-103"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-103" tabindex="-1"></a><span class="st">for (agent in 1:agents){</span></span>
<span id="cb138-104"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-104" tabindex="-1"></a><span class="st">    prior_preds0[agent] = binomial_rng(trials, inv_logit(bias_prior + 0 * beta_prior));</span></span>
<span id="cb138-105"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-105" tabindex="-1"></a><span class="st">    prior_preds1[agent] = binomial_rng(trials, inv_logit(bias_prior + 1 * beta_prior));</span></span>
<span id="cb138-106"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-106" tabindex="-1"></a><span class="st">    prior_preds2[agent] = binomial_rng(trials, inv_logit(bias_prior + 2 * beta_prior));</span></span>
<span id="cb138-107"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-107" tabindex="-1"></a><span class="st">      posterior_preds0[agent] = binomial_rng(trials, inv_logit(biasM + biasID[agent] +  0 * (betaM + betaID[agent])));</span></span>
<span id="cb138-108"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-108" tabindex="-1"></a><span class="st">      posterior_preds1[agent] = binomial_rng(trials, inv_logit(biasM + biasID[agent] +  1 * (betaM + betaID[agent])));</span></span>
<span id="cb138-109"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-109" tabindex="-1"></a><span class="st">      posterior_preds2[agent] = binomial_rng(trials, inv_logit(biasM + biasID[agent] +  2 * (betaM + betaID[agent])));</span></span>
<span id="cb138-110"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-110" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb138-111"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-111" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb138-112"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-112" tabindex="-1"></a></span>
<span id="cb138-113"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-113" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb138-114"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-114" tabindex="-1"></a></span>
<span id="cb138-115"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-115" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb138-116"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-116" tabindex="-1"></a>  stan_model_nc,</span>
<span id="cb138-117"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-117" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb138-118"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-118" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W5_MultilevelMemory_nc.stan&quot;</span>)</span>
<span id="cb138-119"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-119" tabindex="-1"></a></span>
<span id="cb138-120"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-120" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W5_MultilevelMemory_nc.stan&quot;</span>)</span>
<span id="cb138-121"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-121" tabindex="-1"></a>mod_nc <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, </span>
<span id="cb138-122"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-122" tabindex="-1"></a>                     <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb138-123"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-123" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span>
<span id="cb138-124"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-124" tabindex="-1"></a></span>
<span id="cb138-125"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-125" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb138-126"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-126" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod_nc<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb138-127"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-127" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb138-128"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-128" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb138-129"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-129" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb138-130"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-130" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb138-131"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-131" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb138-132"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-132" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb138-133"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-133" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb138-134"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-134" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb138-135"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-135" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb138-136"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-136" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb138-137"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-137" tabindex="-1"></a>)</span>
<span id="cb138-138"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-138" tabindex="-1"></a></span>
<span id="cb138-139"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb138-139" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="at">file =</span> <span class="st">&quot;simmodels/W5_MultilevelMemory_noncentered.RDS&quot;</span>)</span></code></pre></div>
</div>
<div id="assessing-multilevel-memory-1" class="section level3 hasAnchor" number="7.7.6">
<h3><span class="header-section-number">7.7.6</span> Assessing multilevel memory<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb139-1" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/W5_MultilevelMemory_noncentered.RDS&quot;</span>)</span>
<span id="cb139-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb139-2" tabindex="-1"></a></span>
<span id="cb139-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb139-3" tabindex="-1"></a><span class="co">#samples$cmdstan_diagnose()</span></span>
<span id="cb139-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb139-4" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;biasM&quot;</span>, <span class="st">&quot;betaM&quot;</span>, <span class="st">&quot;biasSD&quot;</span>, <span class="st">&quot;betaSD&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 10
##   variable  mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
##   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 biasM    0.538  0.537 0.0870 0.0875 0.397 0.683  1.00    1315.    2025.
## 2 betaM    1.02   1.02  0.0726 0.0732 0.901 1.14   1.00    1187.    2168.
## 3 biasSD   0.281  0.281 0.0702 0.0698 0.168 0.401  1.00     630.     956.
## 4 betaSD   0.411  0.409 0.0497 0.0493 0.333 0.499  1.00    1394.    2137.</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-1" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb141-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-2" tabindex="-1"></a></span>
<span id="cb141-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, biasM, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb141-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb141-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb141-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-6" tabindex="-1"></a></span>
<span id="cb141-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, biasSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb141-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb141-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb141-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-10" tabindex="-1"></a></span>
<span id="cb141-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-11" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, betaM, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb141-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-12" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb141-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb141-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-14" tabindex="-1"></a></span>
<span id="cb141-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-15" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, betaSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb141-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-16" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb141-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-17" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb141-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-18" tabindex="-1"></a></span>
<span id="cb141-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb141-19" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20nc:%20markov%20chains-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="predictive-prior-checks-1" class="section level4 hasAnchor" number="7.7.6.1">
<h4><span class="header-section-number">7.7.6.1</span> Predictive prior checks<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#predictive-prior-checks-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-1" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb142-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-2" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb142-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds0[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb142-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds1[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;green&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb142-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds2[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb142-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb142-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20nc:%20prior%20checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="prior-posterior-update-checks-1" class="section level4 hasAnchor" number="7.7.6.2">
<h4><span class="header-section-number">7.7.6.2</span> Prior posterior update checks<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-posterior-update-checks-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>biasM &lt;- 0
biasSD &lt;- 0.1
betaM &lt;- 1.5
betaSD &lt;- 0.3</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-1" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb143-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb143-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">logit_scaled</span>(biasM)), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(biasM_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb143-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb143-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-9" tabindex="-1"></a></span>
<span id="cb143-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-10" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb143-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-11" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(biasSD), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-12" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(biasSD_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-13" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb143-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-14" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variance of bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-15" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-16" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb143-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-17" tabindex="-1"></a></span>
<span id="cb143-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-18" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb143-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-19" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaM), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-20" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaM_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-21" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb143-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-22" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-23" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-24" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb143-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-25" tabindex="-1"></a></span>
<span id="cb143-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-26" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb143-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-27" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaSD), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-28" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(betaSD_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-29" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb143-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-30" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variance of beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-31" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-32" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb143-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-33" tabindex="-1"></a></span>
<span id="cb143-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb143-34" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 </span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20nc:%20prior%20posterior%20update%20checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="posterior-predictive-checks-2" class="section level4 hasAnchor" number="7.7.6.3">
<h4><span class="header-section-number">7.7.6.3</span> Posterior predictive checks<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#posterior-predictive-checks-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb144-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds0[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb144-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">posterior_preds0[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb144-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb144-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-7" tabindex="-1"></a></span>
<span id="cb144-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb144-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds1[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb144-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-10" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">posterior_preds1[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb144-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb144-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-14" tabindex="-1"></a></span>
<span id="cb144-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-15" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb144-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-16" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">prior_preds2[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb144-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-17" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">posterior_preds2[1]</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb144-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-18" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted right hands out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-19" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-20" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb144-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-21" tabindex="-1"></a></span>
<span id="cb144-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb144-22" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20nc:%20posterior%20predictive%20checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(biasM, biasSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb145-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb145-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb145-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-4" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(betaM, betaSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb145-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb145-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb145-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-7" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(biasM, betaM, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb145-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb145-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb145-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-10" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(biasSD, betaSD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb145-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb145-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-12" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb145-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-13" tabindex="-1"></a></span>
<span id="cb145-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb145-14" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20nc:%20posterior%20predictive%20checks-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb146-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">biasID[1]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">biasID[15]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;green&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">biasID[21]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-5" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">biasID[31]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">biasID[41]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-7" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">biasID[51]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-8" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">biasID[61]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-9" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(biasM_prior)), <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-10" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(bias_prior), <span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb146-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Bias parameter&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb146-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20nc:%20posterior%20predictive%20checks-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb147-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">betaID[1]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">betaID[15]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;green&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">betaID[21]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-5" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">betaID[31]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">betaID[41]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-7" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">betaID[51]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-8" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(<span class="st">`</span><span class="at">betaID[61]</span><span class="st">`</span>)), <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-9" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="fu">inv_logit_scaled</span>(betaM_prior)), <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-10" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(beta_prior), <span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb147-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Beta parameter&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb147-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/Assessing%20multilevel%20memory%20nc:%20posterior%20predictive%20checks-4.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multilevel-memory-with-correlation-between-parameters" class="section level3 hasAnchor" number="7.7.7">
<h3><span class="header-section-number">7.7.7</span> Multilevel memory with correlation between parameters<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-1" tabindex="-1"></a>stan_model_nc_cor <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb148-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-2" tabindex="-1"></a><span class="st">//</span></span>
<span id="cb148-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-3" tabindex="-1"></a><span class="st">// This STAN model infers a random bias from a sequences of 1s and 0s (heads and tails)</span></span>
<span id="cb148-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-4" tabindex="-1"></a><span class="st">//</span></span>
<span id="cb148-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-5" tabindex="-1"></a><span class="st">functions{</span></span>
<span id="cb148-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-6" tabindex="-1"></a><span class="st">  real normal_lb_rng(real mu, real sigma, real lb) {</span></span>
<span id="cb148-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-7" tabindex="-1"></a><span class="st">    real p = normal_cdf(lb | mu, sigma);  // cdf for bounds</span></span>
<span id="cb148-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-8" tabindex="-1"></a><span class="st">    real u = uniform_rng(p, 1);</span></span>
<span id="cb148-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-9" tabindex="-1"></a><span class="st">    return (sigma * inv_Phi(u)) + mu;  // inverse cdf for value</span></span>
<span id="cb148-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-10" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb148-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-11" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb148-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-12" tabindex="-1"></a></span>
<span id="cb148-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-13" tabindex="-1"></a><span class="st">// The input (data) for the model. </span></span>
<span id="cb148-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-14" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb148-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-15" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; trials;</span></span>
<span id="cb148-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-16" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; agents;</span></span>
<span id="cb148-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-17" tabindex="-1"></a><span class="st"> array[trials, agents] int h;</span></span>
<span id="cb148-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-18" tabindex="-1"></a><span class="st"> array[trials, agents] int other;</span></span>
<span id="cb148-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-19" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb148-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-20" tabindex="-1"></a></span>
<span id="cb148-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-21" tabindex="-1"></a><span class="st">// The parameters accepted by the model. </span></span>
<span id="cb148-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-22" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb148-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-23" tabindex="-1"></a><span class="st">  real biasM;</span></span>
<span id="cb148-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-24" tabindex="-1"></a><span class="st">  real betaM;</span></span>
<span id="cb148-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-25" tabindex="-1"></a><span class="st">  vector&lt;lower = 0&gt;[2] tau;</span></span>
<span id="cb148-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-26" tabindex="-1"></a><span class="st">  matrix[2, agents] z_IDs;</span></span>
<span id="cb148-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-27" tabindex="-1"></a><span class="st">  cholesky_factor_corr[2] L_u;</span></span>
<span id="cb148-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-28" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb148-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-29" tabindex="-1"></a></span>
<span id="cb148-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-30" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb148-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-31" tabindex="-1"></a><span class="st">  array[trials, agents] real memory;</span></span>
<span id="cb148-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-32" tabindex="-1"></a><span class="st">  matrix[agents,2] IDs;</span></span>
<span id="cb148-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-33" tabindex="-1"></a><span class="st">  IDs = (diag_pre_multiply(tau, L_u) * z_IDs)&#39;;</span></span>
<span id="cb148-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-34" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb148-35"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-35" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb148-36"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-36" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb148-37"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-37" tabindex="-1"></a><span class="st">      if (trial == 1) {</span></span>
<span id="cb148-38"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-38" tabindex="-1"></a><span class="st">        memory[trial, agent] = 0.5;</span></span>
<span id="cb148-39"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-39" tabindex="-1"></a><span class="st">      } </span></span>
<span id="cb148-40"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-40" tabindex="-1"></a><span class="st">      if (trial &lt; trials){</span></span>
<span id="cb148-41"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-41" tabindex="-1"></a><span class="st">        memory[trial + 1, agent] = memory[trial, agent] + ((other[trial, agent] - memory[trial, agent]) / trial);</span></span>
<span id="cb148-42"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-42" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 0){memory[trial + 1, agent] = 0.01;}</span></span>
<span id="cb148-43"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-43" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 1){memory[trial + 1, agent] = 0.99;}</span></span>
<span id="cb148-44"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-44" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb148-45"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-45" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb148-46"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-46" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb148-47"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-47" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb148-48"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-48" tabindex="-1"></a></span>
<span id="cb148-49"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-49" tabindex="-1"></a><span class="st">// The model to be estimated. </span></span>
<span id="cb148-50"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-50" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb148-51"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-51" tabindex="-1"></a><span class="st">  target += normal_lpdf(biasM | 0, 1);</span></span>
<span id="cb148-52"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-52" tabindex="-1"></a><span class="st">  target += normal_lpdf(tau[1] | 0, .3)  -</span></span>
<span id="cb148-53"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-53" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb148-54"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-54" tabindex="-1"></a><span class="st">  target += normal_lpdf(betaM | 0, .3);</span></span>
<span id="cb148-55"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-55" tabindex="-1"></a><span class="st">  target += normal_lpdf(tau[2] | 0, .3)  -</span></span>
<span id="cb148-56"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-56" tabindex="-1"></a><span class="st">    normal_lccdf(0 | 0, .3);</span></span>
<span id="cb148-57"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-57" tabindex="-1"></a><span class="st">  target += lkj_corr_cholesky_lpdf(L_u | 2);</span></span>
<span id="cb148-58"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-58" tabindex="-1"></a></span>
<span id="cb148-59"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-59" tabindex="-1"></a><span class="st">  target += std_normal_lpdf(to_vector(z_IDs));</span></span>
<span id="cb148-60"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-60" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb148-61"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-61" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb148-62"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-62" tabindex="-1"></a><span class="st">      target += bernoulli_logit_lpmf(h[trial, agent] | biasM + IDs[agent, 1] +  memory[trial, agent] * (betaM + IDs[agent, 2]));</span></span>
<span id="cb148-63"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-63" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb148-64"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-64" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb148-65"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-65" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb148-66"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-66" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb148-67"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-67" tabindex="-1"></a></span>
<span id="cb148-68"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-68" tabindex="-1"></a></span>
<span id="cb148-69"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-69" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb148-70"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-70" tabindex="-1"></a><span class="st">   real biasM_prior;</span></span>
<span id="cb148-71"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-71" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; biasSD_prior;</span></span>
<span id="cb148-72"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-72" tabindex="-1"></a><span class="st">   real betaM_prior;</span></span>
<span id="cb148-73"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-73" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; betaSD_prior;</span></span>
<span id="cb148-74"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-74" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb148-75"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-75" tabindex="-1"></a><span class="st">   real bias_prior;</span></span>
<span id="cb148-76"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-76" tabindex="-1"></a><span class="st">   real beta_prior;</span></span>
<span id="cb148-77"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-77" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb148-78"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-78" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; prior_preds0;</span></span>
<span id="cb148-79"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-79" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; prior_preds1;</span></span>
<span id="cb148-80"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-80" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; prior_preds2;</span></span>
<span id="cb148-81"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-81" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds0;</span></span>
<span id="cb148-82"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-82" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds1;</span></span>
<span id="cb148-83"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-83" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds2;</span></span>
<span id="cb148-84"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-84" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb148-85"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-85" tabindex="-1"></a><span class="st">   biasM_prior = normal_rng(0,1);</span></span>
<span id="cb148-86"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-86" tabindex="-1"></a><span class="st">   biasSD_prior = normal_lb_rng(0,0.3,0);</span></span>
<span id="cb148-87"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-87" tabindex="-1"></a><span class="st">   betaM_prior = normal_rng(0,1);</span></span>
<span id="cb148-88"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-88" tabindex="-1"></a><span class="st">   betaSD_prior = normal_lb_rng(0,0.3,0);</span></span>
<span id="cb148-89"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-89" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb148-90"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-90" tabindex="-1"></a><span class="st">   bias_prior = normal_rng(biasM_prior, biasSD_prior);</span></span>
<span id="cb148-91"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-91" tabindex="-1"></a><span class="st">   beta_prior = normal_rng(betaM_prior, betaSD_prior);</span></span>
<span id="cb148-92"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-92" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb148-93"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-93" tabindex="-1"></a><span class="st">   for (i in 1:agents){</span></span>
<span id="cb148-94"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-94" tabindex="-1"></a><span class="st">      prior_preds0[i] = binomial_rng(trials, inv_logit(bias_prior + 0 * beta_prior));</span></span>
<span id="cb148-95"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-95" tabindex="-1"></a><span class="st">      prior_preds1[i] = binomial_rng(trials, inv_logit(bias_prior + 1 * beta_prior));</span></span>
<span id="cb148-96"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-96" tabindex="-1"></a><span class="st">      prior_preds2[i] = binomial_rng(trials, inv_logit(bias_prior + 2 * beta_prior));</span></span>
<span id="cb148-97"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-97" tabindex="-1"></a><span class="st">      posterior_preds0[i] = binomial_rng(trials, inv_logit(biasM + IDs[i,1] +  0 * (betaM + IDs[i,2])));</span></span>
<span id="cb148-98"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-98" tabindex="-1"></a><span class="st">      posterior_preds1[i] = binomial_rng(trials, inv_logit(biasM + IDs[i,1] +  1 * (betaM + IDs[i,2])));</span></span>
<span id="cb148-99"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-99" tabindex="-1"></a><span class="st">      posterior_preds2[i] = binomial_rng(trials, inv_logit(biasM + IDs[i,1] +  2 * (betaM + IDs[i,2])));</span></span>
<span id="cb148-100"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-100" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb148-101"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-101" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb148-102"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-102" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb148-103"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-103" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb148-104"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-104" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb148-105"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-105" tabindex="-1"></a></span>
<span id="cb148-106"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-106" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb148-107"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-107" tabindex="-1"></a>  stan_model_nc_cor,</span>
<span id="cb148-108"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-108" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb148-109"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-109" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W5_MultilevelMemory_nc_cor.stan&quot;</span>)</span>
<span id="cb148-110"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-110" tabindex="-1"></a></span>
<span id="cb148-111"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-111" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W5_MultilevelMemory_nc_cor.stan&quot;</span>)</span>
<span id="cb148-112"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-112" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb148-113"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-113" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span>
<span id="cb148-114"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-114" tabindex="-1"></a></span>
<span id="cb148-115"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-115" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb148-116"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-116" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb148-117"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-117" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb148-118"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-118" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb148-119"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-119" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb148-120"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-120" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb148-121"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-121" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb148-122"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-122" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb148-123"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-123" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb148-124"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-124" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb148-125"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-125" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb148-126"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-126" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb148-127"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-127" tabindex="-1"></a>)</span>
<span id="cb148-128"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-128" tabindex="-1"></a></span>
<span id="cb148-129"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb148-129" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="at">file =</span> <span class="st">&quot;simmodels/Memory_noncentered_corr.RDS&quot;</span>)</span></code></pre></div>
</div>
<div id="assessing-multilevel-memory-2" class="section level3 hasAnchor" number="7.7.8">
<h3><span class="header-section-number">7.7.8</span> Assessing multilevel memory<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>[MISSING LOTS OF EVALUATION]</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb149-1" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/W5_MultilevelMemory_noncentered_corr.RDS&quot;</span>)</span>
<span id="cb149-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb149-2" tabindex="-1"></a></span>
<span id="cb149-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb149-3" tabindex="-1"></a><span class="co">#samples$cmdstan_diagnose()</span></span></code></pre></div>
</div>
<div id="multilevel-memory-no-pooling" class="section level3 hasAnchor" number="7.7.9">
<h3><span class="header-section-number">7.7.9</span> Multilevel memory no pooling<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-no-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>[MISSING: EXPLANATION OF NO POOLING]</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-1" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb150-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-2" tabindex="-1"></a></span>
<span id="cb150-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-3" tabindex="-1"></a><span class="st">// The input (data) for the model. n of trials and h of heads</span></span>
<span id="cb150-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-4" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb150-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-5" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; trials;</span></span>
<span id="cb150-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-6" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; agents;</span></span>
<span id="cb150-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-7" tabindex="-1"></a><span class="st"> array[trials, agents] int h;</span></span>
<span id="cb150-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-8" tabindex="-1"></a><span class="st"> array[trials, agents] int other;</span></span>
<span id="cb150-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-9" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb150-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-10" tabindex="-1"></a></span>
<span id="cb150-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-11" tabindex="-1"></a><span class="st">// The parameters accepted by the model. </span></span>
<span id="cb150-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-12" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb150-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-13" tabindex="-1"></a><span class="st">  array[trials] real bias;</span></span>
<span id="cb150-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-14" tabindex="-1"></a><span class="st">  array[trials] real beta;</span></span>
<span id="cb150-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-15" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb150-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-16" tabindex="-1"></a></span>
<span id="cb150-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-17" tabindex="-1"></a></span>
<span id="cb150-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-18" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb150-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-19" tabindex="-1"></a><span class="st">  array[trials, agents] real memory;</span></span>
<span id="cb150-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-20" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb150-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-21" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb150-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-22" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb150-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-23" tabindex="-1"></a><span class="st">      if (trial == 1) {</span></span>
<span id="cb150-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-24" tabindex="-1"></a><span class="st">        memory[trial, agent] = 0.5;</span></span>
<span id="cb150-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-25" tabindex="-1"></a><span class="st">      } </span></span>
<span id="cb150-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-26" tabindex="-1"></a><span class="st">      if (trial &lt; trials){</span></span>
<span id="cb150-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-27" tabindex="-1"></a><span class="st">        memory[trial + 1, agent] = memory[trial, agent] + ((other[trial, agent] - memory[trial, agent]) / trial);</span></span>
<span id="cb150-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-28" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 0){memory[trial + 1, agent] = 0.01;}</span></span>
<span id="cb150-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-29" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 1){memory[trial + 1, agent] = 0.99;}</span></span>
<span id="cb150-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-30" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb150-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-31" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb150-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-32" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb150-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb150-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-34" tabindex="-1"></a></span>
<span id="cb150-35"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-35" tabindex="-1"></a><span class="st">// The model to be estimated. </span></span>
<span id="cb150-36"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-36" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb150-37"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-37" tabindex="-1"></a><span class="st">  target += normal_lpdf(bias | 0, 1);</span></span>
<span id="cb150-38"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-38" tabindex="-1"></a><span class="st">  target += normal_lpdf(beta | 0, 1);</span></span>
<span id="cb150-39"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-39" tabindex="-1"></a></span>
<span id="cb150-40"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-40" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb150-41"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-41" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb150-42"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-42" tabindex="-1"></a><span class="st">      target += bernoulli_logit_lpmf(h[trial, agent] | bias[agent] +  memory[trial, agent] * (beta[agent]));</span></span>
<span id="cb150-43"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-43" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb150-44"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-44" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb150-45"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-45" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb150-46"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-46" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb150-47"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-47" tabindex="-1"></a></span>
<span id="cb150-48"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-48" tabindex="-1"></a></span>
<span id="cb150-49"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-49" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb150-50"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-50" tabindex="-1"></a><span class="st">   real bias_prior;</span></span>
<span id="cb150-51"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-51" tabindex="-1"></a><span class="st">   real beta_prior;</span></span>
<span id="cb150-52"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-52" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb150-53"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-53" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds0;</span></span>
<span id="cb150-54"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-54" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds1;</span></span>
<span id="cb150-55"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-55" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds2;</span></span>
<span id="cb150-56"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-56" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds0;</span></span>
<span id="cb150-57"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-57" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds1;</span></span>
<span id="cb150-58"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-58" tabindex="-1"></a><span class="st">   array[agents] int&lt;lower=0, upper = trials&gt; posterior_preds2;</span></span>
<span id="cb150-59"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-59" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb150-60"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-60" tabindex="-1"></a><span class="st">   bias_prior = normal_rng(0,1);</span></span>
<span id="cb150-61"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-61" tabindex="-1"></a><span class="st">   beta_prior = normal_rng(0,1);</span></span>
<span id="cb150-62"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-62" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb150-63"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-63" tabindex="-1"></a><span class="st">   prior_preds0 = binomial_rng(trials, inv_logit(bias_prior + 0 * beta_prior));</span></span>
<span id="cb150-64"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-64" tabindex="-1"></a><span class="st">   prior_preds1 = binomial_rng(trials, inv_logit(bias_prior + 1 * beta_prior));</span></span>
<span id="cb150-65"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-65" tabindex="-1"></a><span class="st">   prior_preds2 = binomial_rng(trials, inv_logit(bias_prior + 2 * beta_prior));</span></span>
<span id="cb150-66"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-66" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb150-67"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-67" tabindex="-1"></a><span class="st">   for (i in 1:agents){</span></span>
<span id="cb150-68"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-68" tabindex="-1"></a><span class="st">      posterior_preds0[i] = binomial_rng(trials, inv_logit(bias[i] +  0 * (beta[i])));</span></span>
<span id="cb150-69"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-69" tabindex="-1"></a><span class="st">      posterior_preds1[i] = binomial_rng(trials, inv_logit(bias[i] +  1 * (beta[i])));</span></span>
<span id="cb150-70"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-70" tabindex="-1"></a><span class="st">      posterior_preds2[i] = binomial_rng(trials, inv_logit(bias[i] +  2 * (beta[i])));</span></span>
<span id="cb150-71"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-71" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb150-72"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-72" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb150-73"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-73" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb150-74"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-74" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb150-75"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-75" tabindex="-1"></a></span>
<span id="cb150-76"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-76" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb150-77"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-77" tabindex="-1"></a>  stan_model,</span>
<span id="cb150-78"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-78" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb150-79"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-79" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W5_MultilevelMemory_nopooling.stan&quot;</span>)</span>
<span id="cb150-80"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-80" tabindex="-1"></a></span>
<span id="cb150-81"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-81" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W5_MultilevelMemory_nopooling.stan&quot;</span>)</span>
<span id="cb150-82"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-82" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb150-83"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-83" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span>
<span id="cb150-84"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-84" tabindex="-1"></a></span>
<span id="cb150-85"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-85" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb150-86"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-86" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb150-87"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-87" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb150-88"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-88" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb150-89"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-89" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb150-90"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-90" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb150-91"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-91" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb150-92"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-92" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb150-93"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-93" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb150-94"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-94" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb150-95"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-95" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb150-96"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-96" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb150-97"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-97" tabindex="-1"></a>)</span>
<span id="cb150-98"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-98" tabindex="-1"></a></span>
<span id="cb150-99"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb150-99" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="at">file =</span> <span class="st">&quot;simmodels/W5_MultilevelMemory_nopooling.RDS&quot;</span>)</span></code></pre></div>
<p>[MISSING: Evaluation of NO POOLING]</p>
</div>
</div>
<div id="multilevel-full-pooling" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Multilevel full pooling<a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-full-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>[MISSING: EXPLANATION OF FULL POOLING]</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-1" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb151-2"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-2" tabindex="-1"></a></span>
<span id="cb151-3"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-3" tabindex="-1"></a><span class="st">// The input (data) for the model. n of trials and h of heads</span></span>
<span id="cb151-4"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-4" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb151-5"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-5" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; trials;</span></span>
<span id="cb151-6"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-6" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; agents;</span></span>
<span id="cb151-7"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-7" tabindex="-1"></a><span class="st"> array[trials, agents] int h;</span></span>
<span id="cb151-8"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-8" tabindex="-1"></a><span class="st"> array[trials, agents] int other;</span></span>
<span id="cb151-9"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-9" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb151-10"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-10" tabindex="-1"></a></span>
<span id="cb151-11"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-11" tabindex="-1"></a><span class="st">// The parameters accepted by the model. </span></span>
<span id="cb151-12"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-12" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb151-13"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-13" tabindex="-1"></a><span class="st">  real bias;</span></span>
<span id="cb151-14"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-14" tabindex="-1"></a><span class="st">  real beta;</span></span>
<span id="cb151-15"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-15" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb151-16"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-16" tabindex="-1"></a></span>
<span id="cb151-17"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-17" tabindex="-1"></a></span>
<span id="cb151-18"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-18" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb151-19"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-19" tabindex="-1"></a><span class="st">  array[trials, agents] real memory;</span></span>
<span id="cb151-20"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-20" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb151-21"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-21" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb151-22"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-22" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb151-23"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-23" tabindex="-1"></a><span class="st">      if (trial == 1) {</span></span>
<span id="cb151-24"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-24" tabindex="-1"></a><span class="st">        memory[trial, agent] = 0.5;</span></span>
<span id="cb151-25"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-25" tabindex="-1"></a><span class="st">      } </span></span>
<span id="cb151-26"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-26" tabindex="-1"></a><span class="st">      if (trial &lt; trials){</span></span>
<span id="cb151-27"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-27" tabindex="-1"></a><span class="st">        memory[trial + 1, agent] = memory[trial, agent] + ((other[trial, agent] - memory[trial, agent]) / trial);</span></span>
<span id="cb151-28"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-28" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 0){memory[trial + 1, agent] = 0.01;}</span></span>
<span id="cb151-29"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-29" tabindex="-1"></a><span class="st">        if (memory[trial + 1, agent] == 1){memory[trial + 1, agent] = 0.99;}</span></span>
<span id="cb151-30"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-30" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb151-31"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-31" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb151-32"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-32" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb151-33"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb151-34"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-34" tabindex="-1"></a></span>
<span id="cb151-35"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-35" tabindex="-1"></a><span class="st">// The model to be estimated. </span></span>
<span id="cb151-36"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-36" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb151-37"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-37" tabindex="-1"></a><span class="st">  target += normal_lpdf(bias | 0, 1);</span></span>
<span id="cb151-38"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-38" tabindex="-1"></a><span class="st">  target += normal_lpdf(beta | 0, 1);</span></span>
<span id="cb151-39"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-39" tabindex="-1"></a></span>
<span id="cb151-40"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-40" tabindex="-1"></a><span class="st">  for (agent in 1:agents){</span></span>
<span id="cb151-41"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-41" tabindex="-1"></a><span class="st">    for (trial in 1:trials){</span></span>
<span id="cb151-42"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-42" tabindex="-1"></a><span class="st">      target += bernoulli_logit_lpmf(h[trial, agent] | bias +  memory[trial, agent] * beta);</span></span>
<span id="cb151-43"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-43" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb151-44"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-44" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb151-45"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-45" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb151-46"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-46" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb151-47"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-47" tabindex="-1"></a></span>
<span id="cb151-48"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-48" tabindex="-1"></a></span>
<span id="cb151-49"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-49" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb151-50"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-50" tabindex="-1"></a><span class="st">   real bias_prior;</span></span>
<span id="cb151-51"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-51" tabindex="-1"></a><span class="st">   real beta_prior;</span></span>
<span id="cb151-52"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-52" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb151-53"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-53" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds0;</span></span>
<span id="cb151-54"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-54" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds1;</span></span>
<span id="cb151-55"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-55" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; prior_preds2;</span></span>
<span id="cb151-56"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-56" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; posterior_preds0;</span></span>
<span id="cb151-57"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-57" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; posterior_preds1;</span></span>
<span id="cb151-58"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-58" tabindex="-1"></a><span class="st">   int&lt;lower=0, upper = trials&gt; posterior_preds2;</span></span>
<span id="cb151-59"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-59" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb151-60"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-60" tabindex="-1"></a><span class="st">   bias_prior = normal_rng(0,1);</span></span>
<span id="cb151-61"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-61" tabindex="-1"></a><span class="st">   beta_prior = normal_rng(0,1);</span></span>
<span id="cb151-62"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-62" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb151-63"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-63" tabindex="-1"></a><span class="st">   prior_preds0 = binomial_rng(trials, inv_logit(bias_prior + 0 * beta_prior));</span></span>
<span id="cb151-64"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-64" tabindex="-1"></a><span class="st">   prior_preds1 = binomial_rng(trials, inv_logit(bias_prior + 1 * beta_prior));</span></span>
<span id="cb151-65"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-65" tabindex="-1"></a><span class="st">   prior_preds2 = binomial_rng(trials, inv_logit(bias_prior + 2 * beta_prior));</span></span>
<span id="cb151-66"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-66" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb151-67"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-67" tabindex="-1"></a><span class="st">   posterior_preds0 = binomial_rng(trials, inv_logit(bias +  0 * (beta)));</span></span>
<span id="cb151-68"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-68" tabindex="-1"></a><span class="st">   posterior_preds1 = binomial_rng(trials, inv_logit(bias +  1 * (beta)));</span></span>
<span id="cb151-69"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-69" tabindex="-1"></a><span class="st">   posterior_preds2 = binomial_rng(trials, inv_logit(bias +  2 * (beta)));</span></span>
<span id="cb151-70"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-70" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb151-71"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-71" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb151-72"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-72" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb151-73"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-73" tabindex="-1"></a></span>
<span id="cb151-74"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-74" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb151-75"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-75" tabindex="-1"></a>  stan_model,</span>
<span id="cb151-76"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-76" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb151-77"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-77" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W5_MultilevelMemory_fullpooling.stan&quot;</span>)</span>
<span id="cb151-78"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-78" tabindex="-1"></a></span>
<span id="cb151-79"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-79" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W5_MultilevelMemory_fullpooling.stan&quot;</span>)</span>
<span id="cb151-80"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-80" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb151-81"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-81" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span>
<span id="cb151-82"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-82" tabindex="-1"></a></span>
<span id="cb151-83"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-83" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb151-84"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-84" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb151-85"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-85" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb151-86"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-86" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb151-87"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-87" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb151-88"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-88" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb151-89"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-89" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb151-90"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-90" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb151-91"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-91" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb151-92"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-92" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb151-93"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-93" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb151-94"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-94" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb151-95"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-95" tabindex="-1"></a>)</span>
<span id="cb151-96"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-96" tabindex="-1"></a></span>
<span id="cb151-97"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#cb151-97" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">save_object</span>(<span class="at">file =</span> <span class="st">&quot;simmodels/W5_MultilevelMemory_fullpooling.RDS&quot;</span>)</span></code></pre></div>
<p>[MISSING: Evaluation of FULL POOLING]</p>
<p>[MISSING: PARAMETER RECOVERY IN A MULTILEVEL FRAMEWORK (IND VS POP)]</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-quality-assessment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-comparison-in-cognitive-science.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/06-MultilevelModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
