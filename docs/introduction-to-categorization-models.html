<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Introduction to Categorization Models | 12-CategorizationModelsPrototypes</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Introduction to Categorization Models | 12-CategorizationModelsPrototypes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Introduction to Categorization Models | 12-CategorizationModelsPrototypes" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-models-of-cognition.html"/>
<link rel="next" href="prototype-based-models-of-categorization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.4</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.5</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
<li class="chapter" data-level="5.7.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.7.2</b> Connection to Kalman Filters</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.2</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#bayesian-memory-agent"><i class="fa fa-check"></i><b>5.9</b> Bayesian memory agent</a></li>
<li class="chapter" data-level="5.10" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.10</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#complete-pooling"><i class="fa fa-check"></i><b>7.3.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="7.3.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#no-pooling"><i class="fa fa-check"></i><b>7.3.2</b> No Pooling</a></li>
<li class="chapter" data-level="7.3.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#partial-pooling-multilevel-modeling"><i class="fa fa-check"></i><b>7.3.3</b> Partial Pooling (Multilevel Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#graphical-model-visualization"><i class="fa fa-check"></i><b>7.4</b> Graphical Model Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#biased-agent-model"><i class="fa fa-check"></i><b>7.4.1</b> Biased Agent Model</a></li>
<li class="chapter" data-level="7.4.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#memory-agent-model"><i class="fa fa-check"></i><b>7.4.2</b> Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random-agent-model"><i class="fa fa-check"></i><b>7.8</b> Multilevel Random Agent Model</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.8.1</b> Assessing multilevel random agents</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#lets-look-at-individuals"><i class="fa fa-check"></i><b>7.9</b> Let’s look at individuals</a></li>
<li class="chapter" data-level="7.10" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-sensitivity-checks"><i class="fa fa-check"></i><b>7.10</b> Prior sensitivity checks</a></li>
<li class="chapter" data-level="7.11" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-1"><i class="fa fa-check"></i><b>7.11</b> Parameter recovery</a></li>
<li class="chapter" data-level="7.12" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-agent-model"><i class="fa fa-check"></i><b>7.12</b> Multilevel Memory Agent Model</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.12.1</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#diagnosing-the-issue-with-bias-and-beta"><i class="fa fa-check"></i><b>7.12.2</b> Diagnosing the issue with bias and beta</a></li>
<li class="chapter" data-level="7.12.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.12.3</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.12.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.12.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.12.5</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.12.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.12.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#section"><i class="fa fa-check"></i><b>7.12.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches"><i class="fa fa-check"></i><b>7.13</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.14" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches-1"><i class="fa fa-check"></i><b>7.14</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.15" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-modeling-cheatsheet"><i class="fa fa-check"></i><b>7.15</b> Multilevel Modeling Cheatsheet</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#when-to-use-each-pooling-approach"><i class="fa fa-check"></i><b>7.15.1</b> When to Use Each Pooling Approach:</a></li>
<li class="chapter" data-level="7.15.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-rules-of-thumb"><i class="fa fa-check"></i><b>7.15.2</b> Parameter Recovery Rules of Thumb:</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#conclusion-the-power-and-challenges-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.16</b> Conclusion: The Power and Challenges of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.17" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#exercises-just-some-ideas"><i class="fa fa-check"></i><b>7.17</b> Exercises (just some ideas)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-challenge-of-model-selection"><i class="fa fa-check"></i><b>8.2.1</b> The Challenge of Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-the-foundation-of-model-comparison"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation: The Foundation of Model Comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-problem-of-overfitting"><i class="fa fa-check"></i><b>8.3.1</b> The Problem of Overfitting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-cross-validation-works"><i class="fa fa-check"></i><b>8.3.2</b> How Cross-Validation Works</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-in-bayesian-models"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation in Bayesian Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#expected-log-predictive-density-elpd"><i class="fa fa-check"></i><b>8.3.4</b> Expected Log Predictive Density (ELPD)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-an-efficient-approximation-to-loo-cv"><i class="fa fa-check"></i><b>8.4</b> PSIS-LOO: An Efficient Approximation to LOO-CV</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-importance-sampling-works"><i class="fa fa-check"></i><b>8.4.1</b> How Importance Sampling Works</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#pareto-smoothing-for-stability"><i class="fa fa-check"></i><b>8.4.2</b> Pareto Smoothing for Stability</a></li>
<li class="chapter" data-level="8.4.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-complete-psis-loo-process"><i class="fa fa-check"></i><b>8.4.3</b> The Complete PSIS-LOO Process</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#simulation-based-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Simulation-Based Model Comparison</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-simulation-parameters"><i class="fa fa-check"></i><b>8.5.1</b> Define Simulation Parameters</a></li>
<li class="chapter" data-level="8.5.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-agent-functions"><i class="fa fa-check"></i><b>8.5.2</b> Define Agent Functions</a></li>
<li class="chapter" data-level="8.5.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generate-simulation-data"><i class="fa fa-check"></i><b>8.5.3</b> Generate Simulation Data</a></li>
<li class="chapter" data-level="8.5.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualize-the-simulation-data"><i class="fa fa-check"></i><b>8.5.4</b> Visualize the Simulation Data</a></li>
<li class="chapter" data-level="8.5.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prepare-data-for-stan-models"><i class="fa fa-check"></i><b>8.5.5</b> Prepare Data for Stan Models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-models-for-comparison"><i class="fa fa-check"></i><b>8.6</b> Implementing Models for Comparison</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#understanding-log-likelihood-in-model-comparison"><i class="fa fa-check"></i><b>8.6.1</b> Understanding Log-Likelihood in Model Comparison</a></li>
<li class="chapter" data-level="8.6.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-biased-agent-model"><i class="fa fa-check"></i><b>8.6.2</b> Multilevel Biased Agent Model</a></li>
<li class="chapter" data-level="8.6.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-agent-model-1"><i class="fa fa-check"></i><b>8.6.3</b> Multilevel Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-models-and-calculating-expected-log-predictive-density"><i class="fa fa-check"></i><b>8.7</b> Fitting Models and Calculating Expected Log Predictive Density</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-for-model-comparison"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation for Model Comparison</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-comparison"><i class="fa fa-check"></i><b>8.9.1</b> PSIS-LOO Comparison</a></li>
<li class="chapter" data-level="8.9.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualizing-loo-cv-results"><i class="fa fa-check"></i><b>8.9.2</b> Visualizing LOO-CV Results</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#formal-model-comparison"><i class="fa fa-check"></i><b>8.10</b> Formal Model Comparison</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#k-fold-cross-validation-for-validation"><i class="fa fa-check"></i><b>8.10.1</b> K-Fold Cross-Validation for Validation</a></li>
<li class="chapter" data-level="8.10.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#comparing-loo-and-k-fold-results"><i class="fa fa-check"></i><b>8.10.2</b> Comparing LOO and K-Fold Results</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-approaches"><i class="fa fa-check"></i><b>8.11</b> Limitations of Model Comparison Approaches</a></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#exercises"><i class="fa fa-check"></i><b>8.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.12.1</b> Rant on internal vs external validity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>9</b> Mixture models</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="mixture-models.html"><a href="mixture-models.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.0.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.0.2" data-path="mixture-models.html"><a href="mixture-models.html#chapter-roadmap"><i class="fa fa-check"></i><b>9.0.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="9.1" data-path="mixture-models.html"><a href="mixture-models.html#visualizing-mixture-distributions-reaction-time-example"><i class="fa fa-check"></i><b>9.1</b> Visualizing Mixture Distributions: Reaction Time Example</a></li>
<li class="chapter" data-level="9.2" data-path="mixture-models.html"><a href="mixture-models.html#theoretical-foundation-for-mixture-models"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation for Mixture Models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mixture-models.html"><a href="mixture-models.html#the-mixture-model-framework"><i class="fa fa-check"></i><b>9.2.1</b> The Mixture Model Framework</a></li>
<li class="chapter" data-level="9.2.2" data-path="mixture-models.html"><a href="mixture-models.html#mixture-models-and-latent-variables"><i class="fa fa-check"></i><b>9.2.2</b> Mixture Models and Latent Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-in-cognitive-modeling"><i class="fa fa-check"></i><b>9.2.3</b> Applications in Cognitive Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mixture-models.html"><a href="mixture-models.html#implementing-a-basic-mixture-model"><i class="fa fa-check"></i><b>9.3</b> Implementing a Basic Mixture Model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixture-models.html"><a href="mixture-models.html#simulating-mixed-strategy-data"><i class="fa fa-check"></i><b>9.3.1</b> Simulating Mixed Strategy Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation-of-a-mixture-model"><i class="fa fa-check"></i><b>9.3.2</b> Stan Implementation of a Mixture Model</a></li>
<li class="chapter" data-level="9.3.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-mixture-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting and Evaluating the Mixture Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="mixture-models.html"><a href="mixture-models.html#model-diagnostics"><i class="fa fa-check"></i><b>9.3.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="9.3.5" data-path="mixture-models.html"><a href="mixture-models.html#parameter-recovery-analysis"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="9.3.6" data-path="mixture-models.html"><a href="mixture-models.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>9.3.6</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixture-models.html"><a href="mixture-models.html#parameter-interpretation"><i class="fa fa-check"></i><b>9.4</b> Parameter Interpretation</a></li>
<li class="chapter" data-level="9.5" data-path="mixture-models.html"><a href="mixture-models.html#multilevel-mixture-models"><i class="fa fa-check"></i><b>9.5</b> Multilevel Mixture Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation"><i class="fa fa-check"></i><b>9.5.1</b> Stan Implementation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mixture-models.html"><a href="mixture-models.html#preparing-data-for-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.2</b> Preparing Data for the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.3</b> Fitting and Evaluating the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.4" data-path="mixture-models.html"><a href="mixture-models.html#examining-individual-differences"><i class="fa fa-check"></i><b>9.5.4</b> Examining Individual Differences</a></li>
<li class="chapter" data-level="9.5.5" data-path="mixture-models.html"><a href="mixture-models.html#interpreting-parameter-correlations"><i class="fa fa-check"></i><b>9.5.5</b> Interpreting Parameter Correlations</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mixture-models.html"><a href="mixture-models.html#comparing-single-process-and-mixture-models"><i class="fa fa-check"></i><b>9.6</b> Comparing Single-Process and Mixture Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mixture-models.html"><a href="mixture-models.html#single-process-model"><i class="fa fa-check"></i><b>9.6.1</b> Single-Process Model</a></li>
<li class="chapter" data-level="9.6.2" data-path="mixture-models.html"><a href="mixture-models.html#model-comparison"><i class="fa fa-check"></i><b>9.6.2</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-of-mixture-models-in-cognitive-science"><i class="fa fa-check"></i><b>9.6.3</b> Applications of Mixture Models in Cognitive Science</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mixture-models.html"><a href="mixture-models.html#conclusion-2"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html"><i class="fa fa-check"></i><b>10</b> Win-Stay-Lose-Shift: A Heuristic Decision Strategy</a>
<ul>
<li class="chapter" data-level="10.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#loading-required-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading Required Packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#generating-data-simulating-wsls-agents"><i class="fa fa-check"></i><b>10.2</b> Generating Data: Simulating WSLS Agents</a></li>
<li class="chapter" data-level="10.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#data-processing-and-initial-visualization"><i class="fa fa-check"></i><b>10.3</b> Data Processing and Initial Visualization</a></li>
<li class="chapter" data-level="10.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#verifying-model-properties-and-assumptions"><i class="fa fa-check"></i><b>10.4</b> Verifying Model Properties and Assumptions</a></li>
<li class="chapter" data-level="10.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#modeling-a-single-wsls-agent"><i class="fa fa-check"></i><b>10.5</b> Modeling a Single WSLS Agent</a></li>
<li class="chapter" data-level="10.6" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#multilevel-wsls-model"><i class="fa fa-check"></i><b>10.6</b> Multilevel WSLS Model</a></li>
<li class="chapter" data-level="10.7" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#quality-checks-and-parameter-recovery"><i class="fa fa-check"></i><b>10.7</b> Quality Checks and Parameter Recovery</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#convergence-diagnostics"><i class="fa fa-check"></i><b>10.7.1</b> Convergence Diagnostics</a></li>
<li class="chapter" data-level="10.7.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#prior-posterior-update-visualization"><i class="fa fa-check"></i><b>10.7.2</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="10.7.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#individual-level-parameter-recovery"><i class="fa fa-check"></i><b>10.7.3</b> Individual-Level Parameter Recovery</a></li>
<li class="chapter" data-level="10.7.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#posterior-predictive-checks-2"><i class="fa fa-check"></i><b>10.7.4</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="10.7.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#model-comparison-with-loo-cv"><i class="fa fa-check"></i><b>10.7.5</b> Model Comparison with LOO-CV</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>11</b> Bayesian Models of Cognition</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#introduction-4"><i class="fa fa-check"></i><b>11.0.1</b> Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#learning-objectives-4"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#chapter-roadmap-1"><i class="fa fa-check"></i><b>11.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition"><i class="fa fa-check"></i><b>11.3</b> The Bayesian Framework for Cognition</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating"><i class="fa fa-check"></i><b>11.4</b> Visualizing Bayesian Updating</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science"><i class="fa fa-check"></i><b>11.5</b> Bayesian Models in Cognitive Science</a></li>
<li class="chapter" data-level="11.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making"><i class="fa fa-check"></i><b>11.6</b> Example: Social Influence in Perceptual Decision-Making</a></li>
<li class="chapter" data-level="11.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task"><i class="fa fa-check"></i><b>11.7</b> A Bayesian Integration Model for the Marble Task</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions"><i class="fa fa-check"></i><b>11.7.1</b> Intuitive Explanation Using Beta Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model"><i class="fa fa-check"></i><b>11.8</b> The Mathematical Model</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evidence-representation"><i class="fa fa-check"></i><b>11.8.1</b> Evidence Representation</a></li>
<li class="chapter" data-level="11.8.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration"><i class="fa fa-check"></i><b>11.8.2</b> Integration</a></li>
<li class="chapter" data-level="11.8.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#decision"><i class="fa fa-check"></i><b>11.8.3</b> Decision</a></li>
<li class="chapter" data-level="11.8.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation-in-r"><i class="fa fa-check"></i><b>11.8.4</b> Implementation in R</a></li>
<li class="chapter" data-level="11.8.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios"><i class="fa fa-check"></i><b>11.8.5</b> Simulating Experimental Scenarios</a></li>
<li class="chapter" data-level="11.8.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration"><i class="fa fa-check"></i><b>11.8.6</b> Visualizing Bayesian Integration</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios"><i class="fa fa-check"></i><b>11.9</b> Examining Belief Distributions for Selected Scenarios</a></li>
<li class="chapter" data-level="11.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10</b> Weighted Bayesian Integration</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model-1"><i class="fa fa-check"></i><b>11.10.1</b> The Mathematical Model</a></li>
<li class="chapter" data-level="11.10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation"><i class="fa fa-check"></i><b>11.10.2</b> Implementation</a></li>
<li class="chapter" data-level="11.10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10.3</b> Visualizing Weighted Bayesian Integration</a></li>
<li class="chapter" data-level="11.10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence"><i class="fa fa-check"></i><b>11.10.4</b> Resolving Conflicting Evidence</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#common-misinterpretations"><i class="fa fa-check"></i><b>11.11</b> Common Misinterpretations</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weight-interpretation"><i class="fa fa-check"></i><b>11.11.1</b> Weight Interpretation</a></li>
<li class="chapter" data-level="11.11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration-vs.-averaging"><i class="fa fa-check"></i><b>11.11.2</b> Integration vs. Averaging</a></li>
<li class="chapter" data-level="11.11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#interpreting-confidence"><i class="fa fa-check"></i><b>11.11.3</b> Interpreting Confidence</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies"><i class="fa fa-check"></i><b>11.12</b> Simulating Agents with Different Evidence Weighting Strategies</a></li>
<li class="chapter" data-level="11.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation"><i class="fa fa-check"></i><b>11.13</b> Key Observations from the Simulation</a></li>
<li class="chapter" data-level="11.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-quality-checks"><i class="fa fa-check"></i><b>11.14</b> Model Quality Checks</a>
<ul>
<li class="chapter" data-level="11.14.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#overview"><i class="fa fa-check"></i><b>11.14.1</b> Overview</a></li>
<li class="chapter" data-level="11.14.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks"><i class="fa fa-check"></i><b>11.14.2</b> Prior and Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="11.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization-1"><i class="fa fa-check"></i><b>11.15</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="11.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-2"><i class="fa fa-check"></i><b>11.16</b> Parameter recovery</a></li>
<li class="chapter" data-level="11.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-1"><i class="fa fa-check"></i><b>11.17</b> Model comparison</a></li>
<li class="chapter" data-level="11.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#leave-one-out-cross-validation-and-model-comparison"><i class="fa fa-check"></i><b>11.18</b> Leave-One-Out Cross-Validation and Model Comparison</a>
<ul>
<li class="chapter" data-level="11.18.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-loo-cross-validation-in-bayesian-framework"><i class="fa fa-check"></i><b>11.18.1</b> Understanding LOO Cross-Validation in Bayesian Framework</a></li>
<li class="chapter" data-level="11.18.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#step-by-step-implementation-of-loo-cv"><i class="fa fa-check"></i><b>11.18.2</b> Step-by-Step Implementation of LOO-CV</a></li>
<li class="chapter" data-level="11.18.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-psis-loo-diagnostics"><i class="fa fa-check"></i><b>11.18.3</b> Understanding PSIS-LOO Diagnostics</a></li>
<li class="chapter" data-level="11.18.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-for-each-scenario"><i class="fa fa-check"></i><b>11.18.4</b> Model Comparison for Each Scenario</a></li>
<li class="chapter" data-level="11.18.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-the-comparison-results"><i class="fa fa-check"></i><b>11.18.5</b> Visualizing the Comparison Results</a></li>
<li class="chapter" data-level="11.18.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-results"><i class="fa fa-check"></i><b>11.18.6</b> Understanding the Results</a></li>
<li class="chapter" data-level="11.18.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematics-behind-loo-cv"><i class="fa fa-check"></i><b>11.18.7</b> The Mathematics Behind LOO-CV</a></li>
<li class="chapter" data-level="11.18.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-pointwise-contributions-to-loo"><i class="fa fa-check"></i><b>11.18.8</b> Examining Pointwise Contributions to LOO</a></li>
</ul></li>
<li class="chapter" data-level="11.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models"><i class="fa fa-check"></i><b>11.19</b> Multilevel Bayesian Models</a>
<ul>
<li class="chapter" data-level="11.19.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents"><i class="fa fa-check"></i><b>11.19.1</b> Simulating Data from Multiple Agents</a></li>
<li class="chapter" data-level="11.19.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-simulated-data"><i class="fa fa-check"></i><b>11.19.2</b> Understanding the Simulated Data</a></li>
</ul></li>
<li class="chapter" data-level="11.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models-for-evidence-integration"><i class="fa fa-check"></i><b>11.20</b> Multilevel Bayesian Models for Evidence Integration</a>
<ul>
<li class="chapter" data-level="11.20.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-1-simple-evidence-integration-with-individual-scaling"><i class="fa fa-check"></i><b>11.20.1</b> Model 1: Simple Evidence Integration with Individual Scaling</a></li>
<li class="chapter" data-level="11.20.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-2-weighted-evidence-integration"><i class="fa fa-check"></i><b>11.20.2</b> Model 2: Weighted Evidence Integration</a></li>
<li class="chapter" data-level="11.20.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-allow-scaling-to-vary-in-the-simple-model"><i class="fa fa-check"></i><b>11.20.3</b> Why Allow Scaling to Vary in the Simple Model?</a></li>
</ul></li>
<li class="chapter" data-level="11.21" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#from-single-agent-to-multilevel-extending-bayesian-cognitive-models"><i class="fa fa-check"></i><b>11.21</b> From Single-Agent to Multilevel: Extending Bayesian Cognitive Models</a>
<ul>
<li class="chapter" data-level="11.21.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-components-of-the-multilevel-extension"><i class="fa fa-check"></i><b>11.21.1</b> Key Components of the Multilevel Extension</a></li>
<li class="chapter" data-level="11.21.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#hierarchical-prior-structure"><i class="fa fa-check"></i><b>11.21.2</b> 2. Hierarchical Prior Structure</a></li>
<li class="chapter" data-level="11.21.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#handling-data-from-multiple-individuals"><i class="fa fa-check"></i><b>11.21.3</b> 3. Handling Data from Multiple Individuals</a></li>
<li class="chapter" data-level="11.21.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#likelihood-specification"><i class="fa fa-check"></i><b>11.21.4</b> 4. Likelihood Specification</a></li>
<li class="chapter" data-level="11.21.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-these-changes-matter"><i class="fa fa-check"></i><b>11.21.5</b> Why These Changes Matter</a></li>
<li class="chapter" data-level="11.21.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>11.21.6</b> Implementing the Multilevel Weighted Beta-Binomial Model in Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.22" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-multilevel-models"><i class="fa fa-check"></i><b>11.22</b> Fitting the Multilevel Models</a>
<ul>
<li class="chapter" data-level="11.22.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1"><i class="fa fa-check"></i><b>11.22.1</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="11.22.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-2"><i class="fa fa-check"></i><b>11.22.2</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11.23" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#dynamic-bayesian-evidence-integration-sequential-updating-models"><i class="fa fa-check"></i><b>11.23</b> Dynamic Bayesian Evidence Integration: Sequential Updating Models</a>
<ul>
<li class="chapter" data-level="11.23.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-updating-the-theoretical-framework"><i class="fa fa-check"></i><b>11.23.1</b> Sequential Bayesian Updating: The Theoretical Framework</a></li>
<li class="chapter" data-level="11.23.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#single-agent-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.2</b> Single-Agent Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.3</b> Multilevel Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#generating-data-for-the-sequential-model"><i class="fa fa-check"></i><b>11.23.4</b> Generating Data for the Sequential Model</a></li>
<li class="chapter" data-level="11.23.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-and-evaluating-the-sequential-models"><i class="fa fa-check"></i><b>11.23.5</b> Fitting and Evaluating the Sequential Models</a></li>
</ul></li>
<li class="chapter" data-level="11.24" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-evidence-integration-models"><i class="fa fa-check"></i><b>11.24</b> Sequential Bayesian Evidence Integration Models</a>
<ul>
<li class="chapter" data-level="11.24.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-belief-updating-over-time"><i class="fa fa-check"></i><b>11.24.1</b> Understanding Belief Updating Over Time</a></li>
<li class="chapter" data-level="11.24.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-sequential-updating-framework"><i class="fa fa-check"></i><b>11.24.2</b> The Sequential Updating Framework</a></li>
<li class="chapter" data-level="11.24.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#mathematical-formulation"><i class="fa fa-check"></i><b>11.24.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="11.24.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#moving-from-single-agent-to-multilevel"><i class="fa fa-check"></i><b>11.24.4</b> Moving from Single-Agent to Multilevel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html"><i class="fa fa-check"></i><b>12</b> Introduction to Categorization Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-fundamental-problem-of-categorization"><i class="fa fa-check"></i><b>12.1</b> The Fundamental Problem of Categorization</a></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#why-model-categorization"><i class="fa fa-check"></i><b>12.2</b> Why Model Categorization?</a></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#historical-development-of-categorization-models"><i class="fa fa-check"></i><b>12.3</b> Historical Development of Categorization Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#early-views-the-classical-approach"><i class="fa fa-check"></i><b>12.3.1</b> Early Views: The Classical Approach</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-prototype-revolution"><i class="fa fa-check"></i><b>12.3.2</b> The Prototype Revolution</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-exemplar-alternative"><i class="fa fa-check"></i><b>12.3.3</b> The Exemplar Alternative</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models"><i class="fa fa-check"></i><b>12.3.4</b> Rule-Based Models</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-three-model-classes-core-assumptions-and-predictions"><i class="fa fa-check"></i><b>12.4</b> The Three Model Classes: Core Assumptions and Predictions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#exemplar-models-individual-instances-as-category-representations"><i class="fa fa-check"></i><b>12.4.1</b> Exemplar Models: Individual Instances as Category Representations</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#prototype-models-categories-as-central-tendencies"><i class="fa fa-check"></i><b>12.4.2</b> Prototype Models: Categories as Central Tendencies</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models-categories-as-decision-boundaries"><i class="fa fa-check"></i><b>12.4.3</b> Rule-Based Models: Categories as Decision Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#our-implementation-approach"><i class="fa fa-check"></i><b>12.5</b> Our Implementation Approach</a></li>
<li class="chapter" data-level="12.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.6</b> The Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-foundations-and-cognitive-principles"><i class="fa fa-check"></i><b>12.6.1</b> Mathematical Foundations and Cognitive Principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#core-assumptions-of-the-gcm"><i class="fa fa-check"></i><b>12.6.2</b> Core Assumptions of the GCM</a></li>
<li class="chapter" data-level="12.6.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-1"><i class="fa fa-check"></i><b>12.6.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="12.6.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-gcm-agent-implementation"><i class="fa fa-check"></i><b>12.6.4</b> The GCM Agent Implementation</a></li>
<li class="chapter" data-level="12.6.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-behavior-with-the-gcm"><i class="fa fa-check"></i><b>12.6.5</b> Simulating Behavior with the GCM</a></li>
<li class="chapter" data-level="12.6.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-gcm-in-stan-for-parameter-estimation"><i class="fa fa-check"></i><b>12.6.6</b> Implementing the GCM in Stan for Parameter Estimation</a></li>
<li class="chapter" data-level="12.6.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#key-parameters-and-their-cognitive-interpretations"><i class="fa fa-check"></i><b>12.6.7</b> Key Parameters and Their Cognitive Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#multilevel-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.7</b> Multilevel Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-need-for-a-multilevel-approach"><i class="fa fa-check"></i><b>12.7.1</b> The Need for a Multilevel Approach</a></li>
<li class="chapter" data-level="12.7.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-of-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.2</b> Mathematical Formulation of the Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-data-for-a-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.3</b> Simulating Data for a Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-multilevel-gcm-in-stan"><i class="fa fa-check"></i><b>12.7.4</b> Implementing the Multilevel GCM in Stan</a></li>
<li class="chapter" data-level="12.7.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#fitting-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.5</b> Fitting the Multilevel GCM</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#gcm-in-context-strengths-and-limitations"><i class="fa fa-check"></i><b>12.8</b> GCM in Context: Strengths and Limitations</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#strengths"><i class="fa fa-check"></i><b>12.8.1</b> Strengths</a></li>
<li class="chapter" data-level="12.8.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#limitations"><i class="fa fa-check"></i><b>12.8.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#some-notes-about-student-produced-models-of-categorization"><i class="fa fa-check"></i><b>12.9</b> Some notes about student-produced models of categorization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html"><i class="fa fa-check"></i><b>13</b> Prototype-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="13.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#theoretical-foundations"><i class="fa fa-check"></i><b>13.1</b> Theoretical Foundations</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#core-assumptions-of-prototype-models"><i class="fa fa-check"></i><b>13.1.1</b> Core Assumptions of Prototype Models</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#prototype-models-vs.-exemplar-models"><i class="fa fa-check"></i><b>13.2</b> Prototype Models vs. Exemplar Models</a></li>
<li class="chapter" data-level="13.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-kalman-filter-approach-to-prototype-learning"><i class="fa fa-check"></i><b>13.3</b> The Kalman Filter Approach to Prototype Learning</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#mathematical-formulation-of-the-kalman-filter-prototype-model"><i class="fa fa-check"></i><b>13.3.1</b> Mathematical Formulation of the Kalman Filter Prototype Model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-kalman-filter-prototype-model"><i class="fa fa-check"></i><b>13.4</b> Implementing the Kalman Filter Prototype Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#univariate-kalman-filter-for-clear-explanation"><i class="fa fa-check"></i><b>13.4.1</b> Univariate Kalman Filter (for clear explanation)</a></li>
<li class="chapter" data-level="13.4.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#multivariate-kalman-filter-for-categorization"><i class="fa fa-check"></i><b>13.4.2</b> Multivariate Kalman Filter for Categorization</a></li>
<li class="chapter" data-level="13.4.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-observation-noise-parameter"><i class="fa fa-check"></i><b>13.4.3</b> The Observation Noise Parameter</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior-with-the-prototype-model"><i class="fa fa-check"></i><b>13.5</b> Simulating Categorization Behavior with the Prototype Model</a></li>
<li class="chapter" data-level="13.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#visualizing-prototype-learning"><i class="fa fa-check"></i><b>13.6</b> Visualizing Prototype Learning</a></li>
<li class="chapter" data-level="13.7" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#comparing-prototype-and-exemplar-models"><i class="fa fa-check"></i><b>13.7</b> Comparing Prototype and Exemplar Models</a></li>
<li class="chapter" data-level="13.8" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-prototype-model-in-stan"><i class="fa fa-check"></i><b>13.8</b> Implementing the Prototype Model in Stan</a></li>
<li class="chapter" data-level="13.9" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#parameter-recovery-analysis-for-the-prototype-model"><i class="fa fa-check"></i><b>13.9</b> Parameter Recovery Analysis for the Prototype Model</a></li>
<li class="chapter" data-level="13.10" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#cognitive-insights-from-the-prototype-model"><i class="fa fa-check"></i><b>13.10</b> Cognitive Insights from the Prototype Model</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#incremental-learning"><i class="fa fa-check"></i><b>13.10.1</b> 1. Incremental Learning</a></li>
<li class="chapter" data-level="13.10.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#uncertainty-driven-learning"><i class="fa fa-check"></i><b>13.10.2</b> 2. Uncertainty-Driven Learning</a></li>
<li class="chapter" data-level="13.10.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#selective-attention-emerges-naturally"><i class="fa fa-check"></i><b>13.10.3</b> 3. Selective Attention Emerges Naturally</a></li>
<li class="chapter" data-level="13.10.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#memory-efficiency"><i class="fa fa-check"></i><b>13.10.4</b> 4. Memory Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#contrasting-with-exemplar-models"><i class="fa fa-check"></i><b>13.11</b> Contrasting with Exemplar Models</a></li>
<li class="chapter" data-level="13.12" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#strengths-of-the-prototype-approach"><i class="fa fa-check"></i><b>13.12</b> Strengths of the Prototype Approach</a></li>
<li class="chapter" data-level="13.13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#limitations-of-the-prototype-approach"><i class="fa fa-check"></i><b>13.13</b> Limitations of the Prototype Approach</a></li>
<li class="chapter" data-level="13.14" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#extensions-to-the-basic-model"><i class="fa fa-check"></i><b>13.14</b> Extensions to the Basic Model</a></li>
<li class="chapter" data-level="13.15" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#conclusion-the-prototype-and-exemplar-debate"><i class="fa fa-check"></i><b>13.15</b> Conclusion: The Prototype and Exemplar Debate</a>
<ul>
<li class="chapter" data-level="13.15.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-prototype-exemplar-spectrum-and-multiple-prototype-models"><i class="fa fa-check"></i><b>13.15.1</b> The Prototype-Exemplar Spectrum and Multiple-Prototype Models</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">12-CategorizationModelsPrototypes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-categorization-models" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Introduction to Categorization Models<a href="introduction-to-categorization-models.html#introduction-to-categorization-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="the-fundamental-problem-of-categorization" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> The Fundamental Problem of Categorization<a href="introduction-to-categorization-models.html#the-fundamental-problem-of-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Categorization is one of the most fundamental cognitive abilities that humans possess. From early childhood, we learn to organize the world around us into meaningful categories: distinguishing food from non-food, safe from dangerous, or one letter from another. This process of assigning objects to categories is complex, involving perception, memory, attention, and decision-making.
How do humans learn categories and make categorization decisions? This seemingly simple question has generated decades of research and theoretical debate in cognitive science. The answer matters not only for understanding human cognition but also for developing artificial intelligence systems, designing educational interventions, and understanding cognitive disorders that affect categorization abilities.</p>
</div>
<div id="why-model-categorization" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Why Model Categorization?<a href="introduction-to-categorization-models.html#why-model-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Computational models offer a powerful way to formalize theories about categorization. By implementing these theories as computer algorithms, we can:</p>
<ul>
<li><p>Explore the consequences of different theoretical assumptions</p></li>
<li><p>Make precise predictions about human behavior in categorization tasks</p></li>
<li><p>Test competing theories against empirical data</p></li>
</ul>
<p>In this module, we will explore three major approaches to modeling categorization:</p>
<ul>
<li><p>Exemplar models - which propose that categories are represented by storing individual examples</p></li>
<li><p>Prototype models - which suggest categories are represented by an abstract “average” or central tendency</p></li>
<li><p>Rule-based models - which posit that categories are represented by explicit rules or decision boundaries</p></li>
</ul>
<p>Each approach captures different aspects of human categorization and has generated substantial empirical research. We’ll implement computational versions of each model type, allowing us to compare their behavior and predictions.</p>
</div>
<div id="historical-development-of-categorization-models" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Historical Development of Categorization Models<a href="introduction-to-categorization-models.html#historical-development-of-categorization-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The computational modeling of categorization has a rich history in cognitive psychology:</p>
<div id="early-views-the-classical-approach" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Early Views: The Classical Approach<a href="introduction-to-categorization-models.html#early-views-the-classical-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Early theories of categorization followed what is now called the classical view, where categories were defined by necessary and sufficient features. In this view, category membership is an all-or-nothing affair: an object either satisfies the criteria or it doesn’t. While intuitive, this approach struggled to explain many aspects of human categorization, such as:</p>
<ul>
<li><p>Graded category membership (some members seem “more typical” than others)</p></li>
<li><p>Unclear boundaries between categories</p></li>
<li><p>Context-dependent categorization</p></li>
<li><p>Family resemblance structures (where no single feature is necessary)</p></li>
</ul>
</div>
<div id="the-prototype-revolution" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> The Prototype Revolution<a href="introduction-to-categorization-models.html#the-prototype-revolution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the 1970s, Eleanor Rosch’s pioneering work on prototypes challenged the classical view. She demonstrated that categories appear to be organized around central tendencies or “prototypes,” with membership determined by similarity to these prototypes. Objects closer to the prototype are categorized more quickly and consistently.
Prototype models formalize this idea by representing categories as their central tendency in a psychological feature space. New items are classified based on their similarity to these prototypes.</p>
</div>
<div id="the-exemplar-alternative" class="section level3 hasAnchor" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> The Exemplar Alternative<a href="introduction-to-categorization-models.html#the-exemplar-alternative" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the late 1970s and 1980s, researchers like Douglas Medin and Robert Nosofsky proposed that rather than abstracting prototypes, people might store individual exemplars of categories and make judgments based on similarity to these stored examples.</p>
<p>The Generalized Context Model (GCM), developed by Nosofsky, became the standard exemplar model. It proposes that categorization decisions are based on the summed similarity of a new stimulus to all stored exemplars of each category, weighted by attention to different stimulus dimensions.</p>
</div>
<div id="rule-based-models" class="section level3 hasAnchor" number="12.3.4">
<h3><span class="header-section-number">12.3.4</span> Rule-Based Models<a href="introduction-to-categorization-models.html#rule-based-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While similarity-based approaches (both prototype and exemplar) gained prominence, other researchers argued that people sometimes use explicit rules for categorization. Rule-based models propose that categorization involves applying decision rules that partition the stimulus space.
Models like Bayesian particle filters, multinomial trees, and also COVIS (COmpetition between Verbal and Implicit Systems) and RULEX (RULe-plus-EXception) formalize these ideas, suggesting that rule learning and application form a core part of human categorization, particularly for well-defined categories.
Hybrid Approaches
More recent work has focused on hybrid models that incorporate elements of multiple approaches. Models like SUSTAIN (Supervised and Unsupervised STratified Adaptive Incremental Network) and ATRIUM (Attention to Rules and Instances in a Unified Model) propose that humans can flexibly switch between strategies or that different systems operate in parallel.</p>
</div>
</div>
<div id="the-three-model-classes-core-assumptions-and-predictions" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> The Three Model Classes: Core Assumptions and Predictions<a href="introduction-to-categorization-models.html#the-three-model-classes-core-assumptions-and-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s examine the core assumptions of the three model classes we’ll be implementing:</p>
<div id="exemplar-models-individual-instances-as-category-representations" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Exemplar Models: Individual Instances as Category Representations<a href="introduction-to-categorization-models.html#exemplar-models-individual-instances-as-category-representations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Core Assumption: Categories are represented by storing individual examples (exemplars) in memory.</p>
<p>Key Features:</p>
<ul>
<li><p>No abstraction: All encountered exemplars are stored</p></li>
<li><p>Categorization involves computing similarity to all stored exemplars</p></li>
<li><p>Similarity is often modeled using an exponential decay function of distance</p></li>
<li><p>Different dimensions can receive different attention weights</p></li>
<li><p>Memory effects (recency, frequency) can influence categorization</p></li>
</ul>
<p>Predictions:</p>
<ul>
<li><p>Sensitivity to specific training examples</p></li>
<li><p>Better handling of exceptions and atypical category members</p></li>
<li><p>Categorization of new items depends on their similarity to specific remembered examples</p></li>
<li><p>Learning can be incremental, one example at a time</p></li>
</ul>
</div>
<div id="prototype-models-categories-as-central-tendencies" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Prototype Models: Categories as Central Tendencies<a href="introduction-to-categorization-models.html#prototype-models-categories-as-central-tendencies" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Core Assumption: Categories are represented by their central tendencies or prototypes.</p>
<p>Key Features:</p>
<ul>
<li><p>Abstraction: Information about individual examples is integrated into a summary representation</p></li>
<li><p>Only the prototype (and possibly variance information) is stored for each category</p></li>
<li><p>Categorization involves computing similarity to category prototypes</p></li>
<li><p>Can be updated incrementally (as in Kalman filter approaches)</p></li>
</ul>
<p>Predictions:</p>
<ul>
<li><p>The most typical (average) category members will be categorized most easily</p></li>
<li><p>Less sensitivity to specific examples</p></li>
<li><p>More efficient in terms of memory requirements</p></li>
<li><p>May struggle with categories that have complex structures (e.g., non-linear boundaries)</p></li>
</ul>
</div>
<div id="rule-based-models-categories-as-decision-boundaries" class="section level3 hasAnchor" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Rule-Based Models: Categories as Decision Boundaries<a href="introduction-to-categorization-models.html#rule-based-models-categories-as-decision-boundaries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Core Assumption: Categories are represented by explicit rules that specify the necessary and sufficient conditions for category membership.</p>
<p>Key Features:</p>
<ul>
<li>Rules partition the stimulus space into regions corresponding to different categories</li>
</ul>
<p>*Rules can be simple (single dimension) or complex (combining multiple dimensions)</p>
<ul>
<li><p>Focus is on relevant dimensions while irrelevant dimensions are ignored</p></li>
<li><p>Rule selection often involves hypothesis testing</p></li>
</ul>
<p>Predictions:</p>
<ul>
<li><p>Sharp category boundaries</p></li>
<li><p>Fast decisions once rules are learned</p></li>
<li><p>Selective attention to rule-relevant dimensions</p></li>
<li><p>Less sensitivity to similarity once rules are established</p></li>
<li><p>Often involves a period of hypothesis testing and rule discovery</p></li>
</ul>
<p>In this module, we’ll implement computational versions of these models and apply them to simulated and real data, allowing us to directly compare their behavior and evaluate their cognitive plausibility.</p>
</div>
</div>
<div id="our-implementation-approach" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Our Implementation Approach<a href="introduction-to-categorization-models.html#our-implementation-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll implement three models representing each major theoretical approach:</p>
<ul>
<li><p>Generalized Context Model (GCM) - A canonical exemplar model where categorization is based on similarity to all stored examples</p></li>
<li><p>Kalman Filter Prototype Model - A dynamic prototype model that incrementally updates category representations as new examples are encountered</p></li>
<li><p>Bayesian Particle Filter for Rules - A rule-based model that maintains and updates a distribution over potential categorization rules</p></li>
</ul>
<p>Each implementation will follow a similar structure:</p>
<ul>
<li><p>Core model function that simulates the categorization process</p></li>
<li><p>Stan implementation for parameter estimation</p></li>
<li><p>Simulation framework for generating synthetic data</p></li>
<li><p>Parameter recovery analyses</p></li>
<li><p>Model comparison framework</p></li>
</ul>
<p>Let’s begin with the Generalized Context Model (GCM), which has been the gold standard exemplar model in the field.</p>
</div>
<div id="the-generalized-context-model-gcm" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> The Generalized Context Model (GCM)<a href="introduction-to-categorization-models.html#the-generalized-context-model-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mathematical-foundations-and-cognitive-principles" class="section level3 hasAnchor" number="12.6.1">
<h3><span class="header-section-number">12.6.1</span> Mathematical Foundations and Cognitive Principles<a href="introduction-to-categorization-models.html#mathematical-foundations-and-cognitive-principles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Generalized Context Model (GCM), developed by Robert Nosofsky in the 1980s, represents one of the most influential exemplar-based approaches to categorization. Unlike models that abstract category information into prototypes or rules, the GCM proposes that people store individual exemplars in memory and make categorization decisions based on similarity to these stored examples.</p>
</div>
<div id="core-assumptions-of-the-gcm" class="section level3 hasAnchor" number="12.6.2">
<h3><span class="header-section-number">12.6.2</span> Core Assumptions of the GCM<a href="introduction-to-categorization-models.html#core-assumptions-of-the-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Memory for Instances: Every encountered example is stored in memory with its category label.
Similarity Computation: Categorization decisions are based on computing the similarity between a new stimulus and all stored exemplars.</p></li>
<li><p>Selective Attention: Attention can be distributed differently across stimulus dimensions, effectively stretching or shrinking the psychological space.</p></li>
<li><p>Choice Probability: The probability of assigning a stimulus to a category is proportional to its summed similarity to exemplars of that category.</p></li>
</ul>
</div>
<div id="mathematical-formulation-1" class="section level3 hasAnchor" number="12.6.3">
<h3><span class="header-section-number">12.6.3</span> Mathematical Formulation<a href="introduction-to-categorization-models.html#mathematical-formulation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The GCM is formalized through the following equations:</p>
<ol style="list-style-type: decimal">
<li>Distance Calculation
The psychological distance between two stimuli in a multidimensional space is computed as:</li>
</ol>
<p><span class="math display">\[d_{ij} = \left[ \sum_{m=1}^{M} w_m |x_{im} - x_{jm}|^r \right]^{\frac{1}{r}}\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(d_{ij}\)</span> is the distance between stimuli i and j
<span class="math inline">\(x_{im}\)</span> is the value of stimulus i on dimension m
<span class="math inline">\(w_m\)</span> is the attention weight for dimension m (constrained so that <span class="math inline">\(\sum_{m} w_m = 1\)</span>)</p>
<p>r determines the distance metric (typically 1 for city-block or 2 for Euclidean)</p>
<p>In our implementation, we’ll use the city-block metric (r=1), which is appropriate for separable stimulus dimensions:</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="introduction-to-categorization-models.html#cb600-1" tabindex="-1"></a><span class="co"># Distance </span></span>
<span id="cb600-2"><a href="introduction-to-categorization-models.html#cb600-2" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="cf">function</span>(vect1, vect2, w) {</span>
<span id="cb600-3"><a href="introduction-to-categorization-models.html#cb600-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(w <span class="sc">*</span> <span class="fu">abs</span>(vect1 <span class="sc">-</span> vect2)))</span>
<span id="cb600-4"><a href="introduction-to-categorization-models.html#cb600-4" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Similarity Computation
Similarity is an exponentially decreasing function of distance:</li>
</ol>
<p><span class="math display">\[\eta_{ij} = e^{-c \cdot d_{ij}}\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(\eta_{ij}\)</span> is the similarity between stimuli i and j</p>
<p>c is the sensitivity parameter that determines how quickly similarity decreases with distance</p>
<p>A higher value of c means similarity decreases more rapidly with distance. This can represent factors like increased discriminability, reduced generalization, or greater specificity in memory.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="introduction-to-categorization-models.html#cb601-1" tabindex="-1"></a><span class="co"># Similarity</span></span>
<span id="cb601-2"><a href="introduction-to-categorization-models.html#cb601-2" tabindex="-1"></a>similarity <span class="ot">&lt;-</span> <span class="cf">function</span>(distance, c) {</span>
<span id="cb601-3"><a href="introduction-to-categorization-models.html#cb601-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>c <span class="sc">*</span> distance))</span>
<span id="cb601-4"><a href="introduction-to-categorization-models.html#cb601-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s assess how similarity changes with distance for different values of the sensitivity parameter c:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="introduction-to-categorization-models.html#cb602-1" tabindex="-1"></a><span class="co"># Let&#39;s assess similarity</span></span>
<span id="cb602-2"><a href="introduction-to-categorization-models.html#cb602-2" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb602-3"><a href="introduction-to-categorization-models.html#cb602-3" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb602-4"><a href="introduction-to-categorization-models.html#cb602-4" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>,.<span class="dv">2</span>, .<span class="dv">3</span>,.<span class="dv">4</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), </span>
<span id="cb602-5"><a href="introduction-to-categorization-models.html#cb602-5" tabindex="-1"></a>    <span class="at">c =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb602-6"><a href="introduction-to-categorization-models.html#cb602-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb602-7"><a href="introduction-to-categorization-models.html#cb602-7" tabindex="-1"></a>    <span class="at">similarity =</span> <span class="fu">similarity</span>(distance, c)</span>
<span id="cb602-8"><a href="introduction-to-categorization-models.html#cb602-8" tabindex="-1"></a>  )</span>
<span id="cb602-9"><a href="introduction-to-categorization-models.html#cb602-9" tabindex="-1"></a></span>
<span id="cb602-10"><a href="introduction-to-categorization-models.html#cb602-10" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb602-11"><a href="introduction-to-categorization-models.html#cb602-11" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb602-12"><a href="introduction-to-categorization-models.html#cb602-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(distance, similarity, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span> </span>
<span id="cb602-13"><a href="introduction-to-categorization-models.html#cb602-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/11%20visualizing%20effects%20of%20sensitivity-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>From this visualization, we can observe:</p>
<ul>
<li><p>With low c values (e.g., 0.1), similarity remains high even for distant stimuli</p></li>
<li><p>With high c values (e.g., 6.0), similarity drops rapidly even for small distances</p></li>
<li><p>At intermediate values, there’s a more gradual decrease in similarity</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Category Response Probability</li>
</ol>
<p>The probability of assigning a stimulus i to category A is:</p>
<p><span class="math display">\[P(A|i) = \frac{\beta \sum_{j \in A} \eta_{ij}}{\beta \sum_{j \in A} \eta_{ij} + (1-\beta) \sum_{j \in B} \eta_{ij}}\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(\sum_{j \in A} \eta_{ij}\)</span> is the summed similarity to all exemplars in category A</p>
<p><span class="math inline">\(\beta\)</span> is a potential response bias for category A (often set to 0.5 for unbiased responding)</p>
<p>In our implementation, we calculate this probability as shown in the GCM agent function below.</p>
</div>
<div id="the-gcm-agent-implementation" class="section level3 hasAnchor" number="12.6.4">
<h3><span class="header-section-number">12.6.4</span> The GCM Agent Implementation<a href="introduction-to-categorization-models.html#the-gcm-agent-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With distance and similarity functions in place, we now need to implement an agent that can:</p>
<ul>
<li><p>Observe stimuli</p></li>
<li><p>Store them into categories according to feedback</p></li>
<li><p>Compare new stimuli to stored exemplars to assess which category is more likely</p></li>
</ul>
<p>The agent operates in two modes:</p>
<ul>
<li><p>Cold start: If not enough stimuli have been observed to have exemplars in each category, the agent picks a category at random</p></li>
<li><p>Similarity-based choice: Otherwise, it calculates similarity to each category’s exemplars and makes a probabilistic choice</p></li>
</ul>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="introduction-to-categorization-models.html#cb603-1" tabindex="-1"></a><span class="do">### generative model </span><span class="al">###</span></span>
<span id="cb603-2"><a href="introduction-to-categorization-models.html#cb603-2" tabindex="-1"></a>gcm <span class="ot">&lt;-</span> <span class="cf">function</span>(w, c, obs, cat_one, <span class="at">quiet =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb603-3"><a href="introduction-to-categorization-models.html#cb603-3" tabindex="-1"></a>  <span class="co"># create an empty list to save probability of saying &quot;1&quot; for each trial</span></span>
<span id="cb603-4"><a href="introduction-to-categorization-models.html#cb603-4" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb603-5"><a href="introduction-to-categorization-models.html#cb603-5" tabindex="-1"></a>  </span>
<span id="cb603-6"><a href="introduction-to-categorization-models.html#cb603-6" tabindex="-1"></a>  ntrials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb603-7"><a href="introduction-to-categorization-models.html#cb603-7" tabindex="-1"></a>  </span>
<span id="cb603-8"><a href="introduction-to-categorization-models.html#cb603-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ntrials) {</span>
<span id="cb603-9"><a href="introduction-to-categorization-models.html#cb603-9" tabindex="-1"></a>    <span class="co"># If quiet is FALSE, print every ten trials</span></span>
<span id="cb603-10"><a href="introduction-to-categorization-models.html#cb603-10" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>quiet <span class="sc">&amp;&amp;</span> i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb603-11"><a href="introduction-to-categorization-models.html#cb603-11" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;i =&quot;</span>, i))</span>
<span id="cb603-12"><a href="introduction-to-categorization-models.html#cb603-12" tabindex="-1"></a>    }</span>
<span id="cb603-13"><a href="introduction-to-categorization-models.html#cb603-13" tabindex="-1"></a>    <span class="co"># if this is the first trial, or there any category with no exemplars seen yet, set the choice to random</span></span>
<span id="cb603-14"><a href="introduction-to-categorization-models.html#cb603-14" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> (i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb603-15"><a href="introduction-to-categorization-models.html#cb603-15" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, .<span class="dv">5</span>)</span>
<span id="cb603-16"><a href="introduction-to-categorization-models.html#cb603-16" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb603-17"><a href="introduction-to-categorization-models.html#cb603-17" tabindex="-1"></a>      similarities <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb603-18"><a href="introduction-to-categorization-models.html#cb603-18" tabindex="-1"></a>      <span class="co"># for each previously seen stimulus assess distance and similarity</span></span>
<span id="cb603-19"><a href="introduction-to-categorization-models.html#cb603-19" tabindex="-1"></a>      <span class="cf">for</span> (e <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb603-20"><a href="introduction-to-categorization-models.html#cb603-20" tabindex="-1"></a>        sim <span class="ot">&lt;-</span> <span class="fu">similarity</span>(<span class="fu">distance</span>(obs[i, ], obs[e, ], w), c)</span>
<span id="cb603-21"><a href="introduction-to-categorization-models.html#cb603-21" tabindex="-1"></a>        similarities <span class="ot">&lt;-</span> <span class="fu">c</span>(similarities, sim)</span>
<span id="cb603-22"><a href="introduction-to-categorization-models.html#cb603-22" tabindex="-1"></a>      }</span>
<span id="cb603-23"><a href="introduction-to-categorization-models.html#cb603-23" tabindex="-1"></a>      <span class="co"># Calculate prob of saying &quot;1&quot; by dividing similarity to 1 by the sum of similarity to 1 and to 2</span></span>
<span id="cb603-24"><a href="introduction-to-categorization-models.html#cb603-24" tabindex="-1"></a>      numerator <span class="ot">&lt;-</span> <span class="fu">mean</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb603-25"><a href="introduction-to-categorization-models.html#cb603-25" tabindex="-1"></a>      denominator <span class="ot">&lt;-</span> <span class="fu">mean</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">mean</span>(similarities[cat_one[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb603-26"><a href="introduction-to-categorization-models.html#cb603-26" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">c</span>(r, numerator <span class="sc">/</span> denominator)</span>
<span id="cb603-27"><a href="introduction-to-categorization-models.html#cb603-27" tabindex="-1"></a>    }</span>
<span id="cb603-28"><a href="introduction-to-categorization-models.html#cb603-28" tabindex="-1"></a>  }</span>
<span id="cb603-29"><a href="introduction-to-categorization-models.html#cb603-29" tabindex="-1"></a></span>
<span id="cb603-30"><a href="introduction-to-categorization-models.html#cb603-30" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(ntrials, <span class="dv">1</span>, r))</span>
<span id="cb603-31"><a href="introduction-to-categorization-models.html#cb603-31" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s break down this implementation step by step:</p>
<ul>
<li><p>Initialization: The function sets up an empty vector r to store the probability of assigning each stimulus to category 1.</p></li>
<li><p>Trial Loop: For each trial (stimulus presentation):</p>
<ol style="list-style-type: lower-alpha">
<li><p>First Trial or Missing Categories: If this is the first trial or if one of the categories hasn’t been observed yet, the model can’t make an informed decision and defaults to random guessing (probability 0.5).</p></li>
<li><p>Similarity Computation: For later trials, the model computes the similarity between the current stimulus and all previously observed stimuli.</p></li>
<li><p>Response Probability: The model calculates the probability of assigning the stimulus to category 1 based on the relative similarity to exemplars of each category. Note that we use the mean similarity rather than the sum. This is a common variant that helps the model maintain stable predictions as the number of exemplars grows.</p></li>
</ol></li>
<li><p>Decision: Finally, the model generates actual binary decisions by sampling from a Bernoulli distribution with the calculated probabilities.</p></li>
</ul>
<p>This implementation captures the core cognitive processes proposed by the GCM:</p>
<ul>
<li><p>Storage of exemplars in memory</p></li>
<li><p>Computation of similarity to all stored exemplars</p></li>
<li><p>Categorization based on relative similarity to different categories</p></li>
<li><p>Probabilistic response generation</p></li>
</ul>
</div>
<div id="simulating-behavior-with-the-gcm" class="section level3 hasAnchor" number="12.6.5">
<h3><span class="header-section-number">12.6.5</span> Simulating Behavior with the GCM<a href="introduction-to-categorization-models.html#simulating-behavior-with-the-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To understand how the GCM behaves under different conditions, we can simulate its behavior on categorization tasks. First, we need to set up a task environment with stimuli, features, and category assignments.</p>
<p>We will rely on a setup from Kruschke 1993. Participants go through 8 blocks of trials. Within each block, participants see 8 stimuli, the same across every block. Each stimulus has to be categorised (classified) as belonging to either category A or category B. After categorizing a stimulus, feedback is given, so that the participant knows which category the stimulus truly belongs to.</p>
<p>The stimuli differ along two continuous dimensions (more specifically the height of a square and the position of a line with it).</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="introduction-to-categorization-models.html#cb604-1" tabindex="-1"></a><span class="co"># Defining the stimuli, their height and position features, and their category</span></span>
<span id="cb604-2"><a href="introduction-to-categorization-models.html#cb604-2" tabindex="-1"></a>stimulus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>)</span>
<span id="cb604-3"><a href="introduction-to-categorization-models.html#cb604-3" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">3</span>, <span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb604-4"><a href="introduction-to-categorization-models.html#cb604-4" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb604-5"><a href="introduction-to-categorization-models.html#cb604-5" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb604-6"><a href="introduction-to-categorization-models.html#cb604-6" tabindex="-1"></a></span>
<span id="cb604-7"><a href="introduction-to-categorization-models.html#cb604-7" tabindex="-1"></a><span class="co"># Making this into a tibble</span></span>
<span id="cb604-8"><a href="introduction-to-categorization-models.html#cb604-8" tabindex="-1"></a>stimuli <span class="ot">&lt;-</span> <span class="fu">tibble</span>(stimulus, height, position, category)</span>
<span id="cb604-9"><a href="introduction-to-categorization-models.html#cb604-9" tabindex="-1"></a></span>
<span id="cb604-10"><a href="introduction-to-categorization-models.html#cb604-10" tabindex="-1"></a><span class="co"># Plotting to make sure all looks right</span></span>
<span id="cb604-11"><a href="introduction-to-categorization-models.html#cb604-11" tabindex="-1"></a><span class="fu">ggplot</span>(stimuli, <span class="fu">aes</span>(position, height, <span class="at">color =</span> category, <span class="at">label =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb604-12"><a href="introduction-to-categorization-models.html#cb604-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb604-13"><a href="introduction-to-categorization-models.html#cb604-13" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb604-14"><a href="introduction-to-categorization-models.html#cb604-14" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb604-15"><a href="introduction-to-categorization-models.html#cb604-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/11%20GCM%20experimental%20setup-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="introduction-to-categorization-models.html#cb605-1" tabindex="-1"></a><span class="co"># Generating the sequence of stimuli in the full experiment</span></span>
<span id="cb605-2"><a href="introduction-to-categorization-models.html#cb605-2" tabindex="-1"></a>sequence <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb605-3"><a href="introduction-to-categorization-models.html#cb605-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb605-4"><a href="introduction-to-categorization-models.html#cb605-4" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">8</span>), <span class="dv">8</span>, <span class="at">replace =</span> F)</span>
<span id="cb605-5"><a href="introduction-to-categorization-models.html#cb605-5" tabindex="-1"></a>  sequence <span class="ot">&lt;-</span> <span class="fu">append</span>(sequence, temp)</span>
<span id="cb605-6"><a href="introduction-to-categorization-models.html#cb605-6" tabindex="-1"></a>}</span>
<span id="cb605-7"><a href="introduction-to-categorization-models.html#cb605-7" tabindex="-1"></a></span>
<span id="cb605-8"><a href="introduction-to-categorization-models.html#cb605-8" tabindex="-1"></a>experiment <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">stimulus =</span> sequence, <span class="at">height =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="cn">NA</span>, <span class="at">category =</span> <span class="cn">NA</span>)</span>
<span id="cb605-9"><a href="introduction-to-categorization-models.html#cb605-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment))) {</span>
<span id="cb605-10"><a href="introduction-to-categorization-models.html#cb605-10" tabindex="-1"></a>  experiment<span class="sc">$</span>height[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>height[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb605-11"><a href="introduction-to-categorization-models.html#cb605-11" tabindex="-1"></a>  experiment<span class="sc">$</span>position[i] <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>position[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]</span>
<span id="cb605-12"><a href="introduction-to-categorization-models.html#cb605-12" tabindex="-1"></a>  experiment<span class="sc">$</span>category[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(stimuli<span class="sc">$</span>category[stimuli<span class="sc">$</span>stimulus <span class="sc">==</span> experiment<span class="sc">$</span>stimulus[i]]))</span>
<span id="cb605-13"><a href="introduction-to-categorization-models.html#cb605-13" tabindex="-1"></a>}</span></code></pre></div>
<p>This setup creates a categorization task with:</p>
<ul>
<li><p>8 unique stimuli varying along two dimensions (height and position)</p></li>
<li><p>2 categories (0 and 1)</p></li>
<li><p>A randomized sequence of 64 trials (8 blocks of 8 stimuli each)</p></li>
</ul>
<p>The visualization helps us understand the category structure: stimuli are arranged in a 4×2 grid, with category membership indicated by color. The dashed line shows that the categories are not perfectly linearly separable.
Now we can simulate how agents with different parameter settings would perform on this task:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="introduction-to-categorization-models.html#cb606-1" tabindex="-1"></a><span class="co"># Function to simulate responses with different parameter settings</span></span>
<span id="cb606-2"><a href="introduction-to-categorization-models.html#cb606-2" tabindex="-1"></a>simulate_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, w, c) {</span>
<span id="cb606-3"><a href="introduction-to-categorization-models.html#cb606-3" tabindex="-1"></a>    </span>
<span id="cb606-4"><a href="introduction-to-categorization-models.html#cb606-4" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb606-5"><a href="introduction-to-categorization-models.html#cb606-5" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))</span>
<span id="cb606-6"><a href="introduction-to-categorization-models.html#cb606-6" tabindex="-1"></a>    </span>
<span id="cb606-7"><a href="introduction-to-categorization-models.html#cb606-7" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category</span>
<span id="cb606-8"><a href="introduction-to-categorization-models.html#cb606-8" tabindex="-1"></a>    </span>
<span id="cb606-9"><a href="introduction-to-categorization-models.html#cb606-9" tabindex="-1"></a>    <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;equal&quot;</span>) {</span>
<span id="cb606-10"><a href="introduction-to-categorization-models.html#cb606-10" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb606-11"><a href="introduction-to-categorization-models.html#cb606-11" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed1&quot;</span>) {</span>
<span id="cb606-12"><a href="introduction-to-categorization-models.html#cb606-12" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb606-13"><a href="introduction-to-categorization-models.html#cb606-13" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (w <span class="sc">==</span> <span class="st">&quot;skewed2&quot;</span>) {</span>
<span id="cb606-14"><a href="introduction-to-categorization-models.html#cb606-14" tabindex="-1"></a>        weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)</span>
<span id="cb606-15"><a href="introduction-to-categorization-models.html#cb606-15" tabindex="-1"></a>    }</span>
<span id="cb606-16"><a href="introduction-to-categorization-models.html#cb606-16" tabindex="-1"></a></span>
<span id="cb606-17"><a href="introduction-to-categorization-models.html#cb606-17" tabindex="-1"></a>    <span class="co"># simulate responses</span></span>
<span id="cb606-18"><a href="introduction-to-categorization-models.html#cb606-18" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">gcm</span>(</span>
<span id="cb606-19"><a href="introduction-to-categorization-models.html#cb606-19" tabindex="-1"></a>        weight,</span>
<span id="cb606-20"><a href="introduction-to-categorization-models.html#cb606-20" tabindex="-1"></a>        c,</span>
<span id="cb606-21"><a href="introduction-to-categorization-models.html#cb606-21" tabindex="-1"></a>        observations,</span>
<span id="cb606-22"><a href="introduction-to-categorization-models.html#cb606-22" tabindex="-1"></a>        category</span>
<span id="cb606-23"><a href="introduction-to-categorization-models.html#cb606-23" tabindex="-1"></a>    )</span>
<span id="cb606-24"><a href="introduction-to-categorization-models.html#cb606-24" tabindex="-1"></a>    </span>
<span id="cb606-25"><a href="introduction-to-categorization-models.html#cb606-25" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb606-26"><a href="introduction-to-categorization-models.html#cb606-26" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb606-27"><a href="introduction-to-categorization-models.html#cb606-27" tabindex="-1"></a>            <span class="at">trial =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment)),</span>
<span id="cb606-28"><a href="introduction-to-categorization-models.html#cb606-28" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb606-29"><a href="introduction-to-categorization-models.html#cb606-29" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb606-30"><a href="introduction-to-categorization-models.html#cb606-30" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> <span class="fu">seq_along</span>(correct),</span>
<span id="cb606-31"><a href="introduction-to-categorization-models.html#cb606-31" tabindex="-1"></a>            <span class="at">c =</span> c,</span>
<span id="cb606-32"><a href="introduction-to-categorization-models.html#cb606-32" tabindex="-1"></a>            <span class="at">w =</span> w,</span>
<span id="cb606-33"><a href="introduction-to-categorization-models.html#cb606-33" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb606-34"><a href="introduction-to-categorization-models.html#cb606-34" tabindex="-1"></a>        )</span>
<span id="cb606-35"><a href="introduction-to-categorization-models.html#cb606-35" tabindex="-1"></a></span>
<span id="cb606-36"><a href="introduction-to-categorization-models.html#cb606-36" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb606-37"><a href="introduction-to-categorization-models.html#cb606-37" tabindex="-1"></a>}</span></code></pre></div>
<p>This function allows us to:</p>
<ul>
<li>Vary attention weight settings (equal or skewed toward different dimensions)</li>
<li>Vary the sensitivity parameter (c)</li>
<li>Generate responses for multiple simulated agents</li>
<li>Track performance (accuracy) over trials</li>
</ul>
<p>Let’s run simulations across a range of parameter values:</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="introduction-to-categorization-models.html#cb607-1" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb607-2"><a href="introduction-to-categorization-models.html#cb607-2" tabindex="-1"></a><span class="co"># simulate responses across parameter combinations</span></span>
<span id="cb607-3"><a href="introduction-to-categorization-models.html#cb607-3" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb607-4"><a href="introduction-to-categorization-models.html#cb607-4" tabindex="-1"></a></span>
<span id="cb607-5"><a href="introduction-to-categorization-models.html#cb607-5" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb607-6"><a href="introduction-to-categorization-models.html#cb607-6" tabindex="-1"></a>    <span class="fu">expand_grid</span>(</span>
<span id="cb607-7"><a href="introduction-to-categorization-models.html#cb607-7" tabindex="-1"></a>        <span class="at">agent =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb607-8"><a href="introduction-to-categorization-models.html#cb607-8" tabindex="-1"></a>        <span class="at">c =</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.2</span>),</span>
<span id="cb607-9"><a href="introduction-to-categorization-models.html#cb607-9" tabindex="-1"></a>        <span class="at">w =</span> <span class="fu">c</span>(<span class="st">&quot;equal&quot;</span>, <span class="st">&quot;skewed1&quot;</span>, <span class="st">&quot;skewed2&quot;</span>)</span>
<span id="cb607-10"><a href="introduction-to-categorization-models.html#cb607-10" tabindex="-1"></a>    )</span>
<span id="cb607-11"><a href="introduction-to-categorization-models.html#cb607-11" tabindex="-1"></a>)</span>
<span id="cb607-12"><a href="introduction-to-categorization-models.html#cb607-12" tabindex="-1"></a></span>
<span id="cb607-13"><a href="introduction-to-categorization-models.html#cb607-13" tabindex="-1"></a>simulated_responses <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(param_df,</span>
<span id="cb607-14"><a href="introduction-to-categorization-models.html#cb607-14" tabindex="-1"></a>    simulate_responses,</span>
<span id="cb607-15"><a href="introduction-to-categorization-models.html#cb607-15" tabindex="-1"></a>    <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb607-16"><a href="introduction-to-categorization-models.html#cb607-16" tabindex="-1"></a>)</span>
<span id="cb607-17"><a href="introduction-to-categorization-models.html#cb607-17" tabindex="-1"></a></span>
<span id="cb607-18"><a href="introduction-to-categorization-models.html#cb607-18" tabindex="-1"></a>  <span class="co"># Save model fits</span></span>
<span id="cb607-19"><a href="introduction-to-categorization-models.html#cb607-19" tabindex="-1"></a>  <span class="fu">write_csv</span>(simulated_responses, <span class="st">&quot;simdata/W11_gcm_single_simulated_responses.csv&quot;</span>)</span>
<span id="cb607-20"><a href="introduction-to-categorization-models.html#cb607-20" tabindex="-1"></a>  </span>
<span id="cb607-21"><a href="introduction-to-categorization-models.html#cb607-21" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulation saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb607-22"><a href="introduction-to-categorization-models.html#cb607-22" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb607-23"><a href="introduction-to-categorization-models.html#cb607-23" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb607-24"><a href="introduction-to-categorization-models.html#cb607-24" tabindex="-1"></a>  simulated_responses <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;simdata/W11_gcm_single_simulated_responses.csv&quot;</span>)</span>
<span id="cb607-25"><a href="introduction-to-categorization-models.html#cb607-25" tabindex="-1"></a>  </span>
<span id="cb607-26"><a href="introduction-to-categorization-models.html#cb607-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulation loaded.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb607-27"><a href="introduction-to-categorization-models.html#cb607-27" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Simulation loaded.</code></pre>
<p>We can then visualize how different parameter settings affect learning and performance:</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="introduction-to-categorization-models.html#cb609-1" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb609-2"><a href="introduction-to-categorization-models.html#cb609-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">w =</span> <span class="fu">as.factor</span>(w)) <span class="sc">%&gt;%</span></span>
<span id="cb609-3"><a href="introduction-to-categorization-models.html#cb609-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> w, <span class="at">color =</span> w)) <span class="sc">+</span></span>
<span id="cb609-4"><a href="introduction-to-categorization-models.html#cb609-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb609-5"><a href="introduction-to-categorization-models.html#cb609-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb609-6"><a href="introduction-to-categorization-models.html#cb609-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(c <span class="sc">~</span> .)</span>
<span id="cb609-7"><a href="introduction-to-categorization-models.html#cb609-7" tabindex="-1"></a></span>
<span id="cb609-8"><a href="introduction-to-categorization-models.html#cb609-8" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span></span>
<span id="cb609-9"><a href="introduction-to-categorization-models.html#cb609-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.factor</span>(c)) <span class="sc">%&gt;%</span></span>
<span id="cb609-10"><a href="introduction-to-categorization-models.html#cb609-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> c, <span class="at">color =</span> c)) <span class="sc">+</span></span>
<span id="cb609-11"><a href="introduction-to-categorization-models.html#cb609-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb609-12"><a href="introduction-to-categorization-models.html#cb609-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb609-13"><a href="introduction-to-categorization-models.html#cb609-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(w <span class="sc">~</span> .)</span>
<span id="cb609-14"><a href="introduction-to-categorization-models.html#cb609-14" tabindex="-1"></a></span>
<span id="cb609-15"><a href="introduction-to-categorization-models.html#cb609-15" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/11%20visualize%20parameter%20settings-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>From these plots, we can observe:</p>
<ul>
<li><p>Attention Weights Matter: For this particular category structure, the equal weights condition generally performs better than the highly skewed weight conditions. This makes sense given that both dimensions are relevant for categorization in our stimulus set.</p></li>
<li><p>Sensitivity Parameter Affects Performance: The optimal value of c depends on the category structure. Too low (&lt; 0.5) and the model overgeneralizes; too high (&gt; 1.5) and it may be too specific. Values around 1.0-1.5 typically produce the best performance with our stimulus set.</p></li>
<li><p>Interaction Between Parameters: The effect of the sensitivity parameter c often depends on the attention weight distribution. For example, with skewed weights, higher c values may be needed to compensate for the lost information from the ignored dimension.</p></li>
</ul>
</div>
<div id="implementing-the-gcm-in-stan-for-parameter-estimation" class="section level3 hasAnchor" number="12.6.6">
<h3><span class="header-section-number">12.6.6</span> Implementing the GCM in Stan for Parameter Estimation<a href="introduction-to-categorization-models.html#implementing-the-gcm-in-stan-for-parameter-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While simulating the GCM helps us understand its behavior, we ultimately want to estimate its parameters from observed categorization data. To do this, we implement the GCM in Stan, allowing for Bayesian parameter estimation.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="introduction-to-categorization-models.html#cb610-1" tabindex="-1"></a>gcm_single_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb610-2"><a href="introduction-to-categorization-models.html#cb610-2" tabindex="-1"></a><span class="st">// Generalized Context Model (GCM)</span></span>
<span id="cb610-3"><a href="introduction-to-categorization-models.html#cb610-3" tabindex="-1"></a></span>
<span id="cb610-4"><a href="introduction-to-categorization-models.html#cb610-4" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb610-5"><a href="introduction-to-categorization-models.html#cb610-5" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; ntrials;  // number of trials</span></span>
<span id="cb610-6"><a href="introduction-to-categorization-models.html#cb610-6" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nfeatures;  // number of predefined relevant features</span></span>
<span id="cb610-7"><a href="introduction-to-categorization-models.html#cb610-7" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_one; // true responses on a trial by trial basis</span></span>
<span id="cb610-8"><a href="introduction-to-categorization-models.html#cb610-8" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; y;  // decisions on a trial by trial basis</span></span>
<span id="cb610-9"><a href="introduction-to-categorization-models.html#cb610-9" tabindex="-1"></a><span class="st">    array[ntrials, nfeatures] real obs; // stimuli as vectors of features</span></span>
<span id="cb610-10"><a href="introduction-to-categorization-models.html#cb610-10" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; b;  // initial bias for category one over two</span></span>
<span id="cb610-11"><a href="introduction-to-categorization-models.html#cb610-11" tabindex="-1"></a></span>
<span id="cb610-12"><a href="introduction-to-categorization-models.html#cb610-12" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb610-13"><a href="introduction-to-categorization-models.html#cb610-13" tabindex="-1"></a><span class="st">    vector[nfeatures] w_prior_values;  // concentration parameters for dirichlet distribution &lt;lower=1&gt;</span></span>
<span id="cb610-14"><a href="introduction-to-categorization-models.html#cb610-14" tabindex="-1"></a><span class="st">    array[2] real c_prior_values;  // mean and variance for logit-normal distribution</span></span>
<span id="cb610-15"><a href="introduction-to-categorization-models.html#cb610-15" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb610-16"><a href="introduction-to-categorization-models.html#cb610-16" tabindex="-1"></a></span>
<span id="cb610-17"><a href="introduction-to-categorization-models.html#cb610-17" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb610-18"><a href="introduction-to-categorization-models.html#cb610-18" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_two; // dummy variable for category two over cat 1</span></span>
<span id="cb610-19"><a href="introduction-to-categorization-models.html#cb610-19" tabindex="-1"></a><span class="st">    array[sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_one_idx; // array of which stimuli are cat 1</span></span>
<span id="cb610-20"><a href="introduction-to-categorization-models.html#cb610-20" tabindex="-1"></a><span class="st">    array[ntrials-sum(cat_one)] int&lt;lower=1, upper=ntrials&gt; cat_two_idx; //  array of which stimuli are cat 2</span></span>
<span id="cb610-21"><a href="introduction-to-categorization-models.html#cb610-21" tabindex="-1"></a><span class="st">    int idx_one = 1; // Initializing </span></span>
<span id="cb610-22"><a href="introduction-to-categorization-models.html#cb610-22" tabindex="-1"></a><span class="st">    int idx_two = 1;</span></span>
<span id="cb610-23"><a href="introduction-to-categorization-models.html#cb610-23" tabindex="-1"></a><span class="st">    for (i in 1:ntrials){</span></span>
<span id="cb610-24"><a href="introduction-to-categorization-models.html#cb610-24" tabindex="-1"></a><span class="st">        cat_two[i] = abs(cat_one[i]-1);</span></span>
<span id="cb610-25"><a href="introduction-to-categorization-models.html#cb610-25" tabindex="-1"></a></span>
<span id="cb610-26"><a href="introduction-to-categorization-models.html#cb610-26" tabindex="-1"></a><span class="st">        if (cat_one[i]==1){</span></span>
<span id="cb610-27"><a href="introduction-to-categorization-models.html#cb610-27" tabindex="-1"></a><span class="st">            cat_one_idx[idx_one] = i;</span></span>
<span id="cb610-28"><a href="introduction-to-categorization-models.html#cb610-28" tabindex="-1"></a><span class="st">            idx_one +=1;</span></span>
<span id="cb610-29"><a href="introduction-to-categorization-models.html#cb610-29" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb610-30"><a href="introduction-to-categorization-models.html#cb610-30" tabindex="-1"></a><span class="st">            cat_two_idx[idx_two] = i;</span></span>
<span id="cb610-31"><a href="introduction-to-categorization-models.html#cb610-31" tabindex="-1"></a><span class="st">            idx_two += 1;</span></span>
<span id="cb610-32"><a href="introduction-to-categorization-models.html#cb610-32" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb610-33"><a href="introduction-to-categorization-models.html#cb610-33" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb610-34"><a href="introduction-to-categorization-models.html#cb610-34" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb610-35"><a href="introduction-to-categorization-models.html#cb610-35" tabindex="-1"></a></span>
<span id="cb610-36"><a href="introduction-to-categorization-models.html#cb610-36" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb610-37"><a href="introduction-to-categorization-models.html#cb610-37" tabindex="-1"></a><span class="st">    simplex[nfeatures] w;  // simplex means sum(w)=1</span></span>
<span id="cb610-38"><a href="introduction-to-categorization-models.html#cb610-38" tabindex="-1"></a><span class="st">    real logit_c;</span></span>
<span id="cb610-39"><a href="introduction-to-categorization-models.html#cb610-39" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb610-40"><a href="introduction-to-categorization-models.html#cb610-40" tabindex="-1"></a></span>
<span id="cb610-41"><a href="introduction-to-categorization-models.html#cb610-41" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb610-42"><a href="introduction-to-categorization-models.html#cb610-42" tabindex="-1"></a><span class="st">    // parameter c </span></span>
<span id="cb610-43"><a href="introduction-to-categorization-models.html#cb610-43" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=2&gt; c = inv_logit(logit_c)*2;  // times 2 as c is bounded between 0 and 2</span></span>
<span id="cb610-44"><a href="introduction-to-categorization-models.html#cb610-44" tabindex="-1"></a></span>
<span id="cb610-45"><a href="introduction-to-categorization-models.html#cb610-45" tabindex="-1"></a><span class="st">    // parameter r (probability of response = category 1)</span></span>
<span id="cb610-46"><a href="introduction-to-categorization-models.html#cb610-46" tabindex="-1"></a><span class="st">    array[ntrials] real&lt;lower=0.0001, upper=0.9999&gt; r;</span></span>
<span id="cb610-47"><a href="introduction-to-categorization-models.html#cb610-47" tabindex="-1"></a><span class="st">    array[ntrials] real rr;</span></span>
<span id="cb610-48"><a href="introduction-to-categorization-models.html#cb610-48" tabindex="-1"></a></span>
<span id="cb610-49"><a href="introduction-to-categorization-models.html#cb610-49" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb610-50"><a href="introduction-to-categorization-models.html#cb610-50" tabindex="-1"></a></span>
<span id="cb610-51"><a href="introduction-to-categorization-models.html#cb610-51" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb610-52"><a href="introduction-to-categorization-models.html#cb610-52" tabindex="-1"></a><span class="st">        array[(i-1)] real exemplar_sim;</span></span>
<span id="cb610-53"><a href="introduction-to-categorization-models.html#cb610-53" tabindex="-1"></a><span class="st">        for (e in 1:(i-1)){</span></span>
<span id="cb610-54"><a href="introduction-to-categorization-models.html#cb610-54" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb610-55"><a href="introduction-to-categorization-models.html#cb610-55" tabindex="-1"></a><span class="st">            for (j in 1:nfeatures) {</span></span>
<span id="cb610-56"><a href="introduction-to-categorization-models.html#cb610-56" tabindex="-1"></a><span class="st">                tmp_dist[j] = w[j]*abs(obs[e,j] - obs[i,j]);</span></span>
<span id="cb610-57"><a href="introduction-to-categorization-models.html#cb610-57" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb610-58"><a href="introduction-to-categorization-models.html#cb610-58" tabindex="-1"></a><span class="st">            exemplar_sim[e] = exp(-c * sum(tmp_dist));</span></span>
<span id="cb610-59"><a href="introduction-to-categorization-models.html#cb610-59" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb610-60"><a href="introduction-to-categorization-models.html#cb610-60" tabindex="-1"></a></span>
<span id="cb610-61"><a href="introduction-to-categorization-models.html#cb610-61" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(i-1)])==0 || sum(cat_two[:(i-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb610-62"><a href="introduction-to-categorization-models.html#cb610-62" tabindex="-1"></a><span class="st">            r[i] = 0.5;</span></span>
<span id="cb610-63"><a href="introduction-to-categorization-models.html#cb610-63" tabindex="-1"></a></span>
<span id="cb610-64"><a href="introduction-to-categorization-models.html#cb610-64" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb610-65"><a href="introduction-to-categorization-models.html#cb610-65" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb610-66"><a href="introduction-to-categorization-models.html#cb610-66" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb610-67"><a href="introduction-to-categorization-models.html#cb610-67" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb610-68"><a href="introduction-to-categorization-models.html#cb610-68" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(i-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(i-1)])];</span></span>
<span id="cb610-69"><a href="introduction-to-categorization-models.html#cb610-69" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(i-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(i-1)])];</span></span>
<span id="cb610-70"><a href="introduction-to-categorization-models.html#cb610-70" tabindex="-1"></a><span class="st">            similarities[1] = sum(exemplar_sim[tmp_idx_one]);</span></span>
<span id="cb610-71"><a href="introduction-to-categorization-models.html#cb610-71" tabindex="-1"></a><span class="st">            similarities[2] = sum(exemplar_sim[tmp_idx_two]);</span></span>
<span id="cb610-72"><a href="introduction-to-categorization-models.html#cb610-72" tabindex="-1"></a></span>
<span id="cb610-73"><a href="introduction-to-categorization-models.html#cb610-73" tabindex="-1"></a><span class="st">            // calculate r[i]</span></span>
<span id="cb610-74"><a href="introduction-to-categorization-models.html#cb610-74" tabindex="-1"></a><span class="st">            rr[i] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb610-75"><a href="introduction-to-categorization-models.html#cb610-75" tabindex="-1"></a></span>
<span id="cb610-76"><a href="introduction-to-categorization-models.html#cb610-76" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb610-77"><a href="introduction-to-categorization-models.html#cb610-77" tabindex="-1"></a><span class="st">            if (rr[i] &gt; 0.9999){</span></span>
<span id="cb610-78"><a href="introduction-to-categorization-models.html#cb610-78" tabindex="-1"></a><span class="st">                r[i] = 0.9999;</span></span>
<span id="cb610-79"><a href="introduction-to-categorization-models.html#cb610-79" tabindex="-1"></a><span class="st">            } else if (rr[i] &lt; 0.0001) {</span></span>
<span id="cb610-80"><a href="introduction-to-categorization-models.html#cb610-80" tabindex="-1"></a><span class="st">                r[i] = 0.0001;</span></span>
<span id="cb610-81"><a href="introduction-to-categorization-models.html#cb610-81" tabindex="-1"></a><span class="st">            } else if (rr[i] &gt; 0.0001 &amp;&amp; rr[i] &lt; 0.9999) {</span></span>
<span id="cb610-82"><a href="introduction-to-categorization-models.html#cb610-82" tabindex="-1"></a><span class="st">                r[i] = rr[i];</span></span>
<span id="cb610-83"><a href="introduction-to-categorization-models.html#cb610-83" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb610-84"><a href="introduction-to-categorization-models.html#cb610-84" tabindex="-1"></a><span class="st">                r[i] = 0.5;</span></span>
<span id="cb610-85"><a href="introduction-to-categorization-models.html#cb610-85" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb610-86"><a href="introduction-to-categorization-models.html#cb610-86" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb610-87"><a href="introduction-to-categorization-models.html#cb610-87" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb610-88"><a href="introduction-to-categorization-models.html#cb610-88" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb610-89"><a href="introduction-to-categorization-models.html#cb610-89" tabindex="-1"></a></span>
<span id="cb610-90"><a href="introduction-to-categorization-models.html#cb610-90" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb610-91"><a href="introduction-to-categorization-models.html#cb610-91" tabindex="-1"></a><span class="st">    // Priors</span></span>
<span id="cb610-92"><a href="introduction-to-categorization-models.html#cb610-92" tabindex="-1"></a><span class="st">    target += dirichlet_lpdf(w | w_prior_values);</span></span>
<span id="cb610-93"><a href="introduction-to-categorization-models.html#cb610-93" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c | c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb610-94"><a href="introduction-to-categorization-models.html#cb610-94" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb610-95"><a href="introduction-to-categorization-models.html#cb610-95" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb610-96"><a href="introduction-to-categorization-models.html#cb610-96" tabindex="-1"></a><span class="st">    // Decision Data</span></span>
<span id="cb610-97"><a href="introduction-to-categorization-models.html#cb610-97" tabindex="-1"></a><span class="st">    target += bernoulli_lpmf(y | r);</span></span>
<span id="cb610-98"><a href="introduction-to-categorization-models.html#cb610-98" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb610-99"><a href="introduction-to-categorization-models.html#cb610-99" tabindex="-1"></a></span>
<span id="cb610-100"><a href="introduction-to-categorization-models.html#cb610-100" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb610-101"><a href="introduction-to-categorization-models.html#cb610-101" tabindex="-1"></a><span class="st">    // Prior samples, posterior predictions, and log likelihood calculations...</span></span>
<span id="cb610-102"><a href="introduction-to-categorization-models.html#cb610-102" tabindex="-1"></a><span class="st">    real w_prior;</span></span>
<span id="cb610-103"><a href="introduction-to-categorization-models.html#cb610-103" tabindex="-1"></a><span class="st">    real c_prior;</span></span>
<span id="cb610-104"><a href="introduction-to-categorization-models.html#cb610-104" tabindex="-1"></a><span class="st">    w_prior = dirichlet_rng(w | w_prior_values);</span></span>
<span id="cb610-105"><a href="introduction-to-categorization-models.html#cb610-105" tabindex="-1"></a><span class="st">    c_prior = inv_logit(normal_rng(c_prior_values[1], c_prior_values[2]));</span></span>
<span id="cb610-106"><a href="introduction-to-categorization-models.html#cb610-106" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb610-107"><a href="introduction-to-categorization-models.html#cb610-107" tabindex="-1"></a></span>
<span id="cb610-108"><a href="introduction-to-categorization-models.html#cb610-108" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb610-109"><a href="introduction-to-categorization-models.html#cb610-109" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb610-110"><a href="introduction-to-categorization-models.html#cb610-110" tabindex="-1"></a>  gcm_single_stan,</span>
<span id="cb610-111"><a href="introduction-to-categorization-models.html#cb610-111" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb610-112"><a href="introduction-to-categorization-models.html#cb610-112" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W11_gcm_single.stan&quot;</span></span>
<span id="cb610-113"><a href="introduction-to-categorization-models.html#cb610-113" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W11_gcm_single.stan&quot;</code></pre>
<p>The Stan implementation follows the same mathematical principles as our R implementation but is structured for parameter estimation. Key differences include:</p>
<ul>
<li><p>Parameter Constraints: Attention weights are implemented as a simplex, ensuring they sum to 1, and the sensitivity parameter c is constrained to a reasonable range.</p></li>
<li><p>Preprocessing: The transformed data block creates useful indices for efficient computation.</p></li>
<li><p>Numerical Stability: The implementation includes steps to avoid numerical issues, such as bounding probabilities away from 0 and 1.</p></li>
<li><p>Priors: Priors for attention weights (Dirichlet) and sensitivity (normal on logit scale) are needed for Bayesian inference.</p></li>
</ul>
<p>Let’s fit this model to some of our simulated data to see how well it recovers the true generating parameters:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="introduction-to-categorization-models.html#cb612-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb612-2"><a href="introduction-to-categorization-models.html#cb612-2" tabindex="-1"></a>  c <span class="sc">==</span> <span class="st">&quot;1.1&quot;</span> <span class="sc">&amp;</span> w <span class="sc">==</span> <span class="st">&quot;equal&quot;</span></span>
<span id="cb612-3"><a href="introduction-to-categorization-models.html#cb612-3" tabindex="-1"></a>)</span>
<span id="cb612-4"><a href="introduction-to-categorization-models.html#cb612-4" tabindex="-1"></a></span>
<span id="cb612-5"><a href="introduction-to-categorization-models.html#cb612-5" tabindex="-1"></a>gcm_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb612-6"><a href="introduction-to-categorization-models.html#cb612-6" tabindex="-1"></a>  <span class="at">ntrials =</span> <span class="fu">nrow</span>(d),</span>
<span id="cb612-7"><a href="introduction-to-categorization-models.html#cb612-7" tabindex="-1"></a>  <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb612-8"><a href="introduction-to-categorization-models.html#cb612-8" tabindex="-1"></a>  <span class="at">cat_one =</span> d<span class="sc">$</span>category,</span>
<span id="cb612-9"><a href="introduction-to-categorization-models.html#cb612-9" tabindex="-1"></a>  <span class="at">y =</span> d<span class="sc">$</span>sim_response,</span>
<span id="cb612-10"><a href="introduction-to-categorization-models.html#cb612-10" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(d[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb612-11"><a href="introduction-to-categorization-models.html#cb612-11" tabindex="-1"></a>  <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb612-12"><a href="introduction-to-categorization-models.html#cb612-12" tabindex="-1"></a>  <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb612-13"><a href="introduction-to-categorization-models.html#cb612-13" tabindex="-1"></a>  <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb612-14"><a href="introduction-to-categorization-models.html#cb612-14" tabindex="-1"></a>)</span>
<span id="cb612-15"><a href="introduction-to-categorization-models.html#cb612-15" tabindex="-1"></a></span>
<span id="cb612-16"><a href="introduction-to-categorization-models.html#cb612-16" tabindex="-1"></a><span class="co"># Check if we need to regenerate model fits</span></span>
<span id="cb612-17"><a href="introduction-to-categorization-models.html#cb612-17" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb612-18"><a href="introduction-to-categorization-models.html#cb612-18" tabindex="-1"></a>  <span class="co"># Compile Stan models</span></span>
<span id="cb612-19"><a href="introduction-to-categorization-models.html#cb612-19" tabindex="-1"></a>  mod_gcm_single <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb612-20"><a href="introduction-to-categorization-models.html#cb612-20" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="st">&quot;stan/W11_gcm_single.stan&quot;</span>),</span>
<span id="cb612-21"><a href="introduction-to-categorization-models.html#cb612-21" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb612-22"><a href="introduction-to-categorization-models.html#cb612-22" tabindex="-1"></a>  )</span>
<span id="cb612-23"><a href="introduction-to-categorization-models.html#cb612-23" tabindex="-1"></a>  </span>
<span id="cb612-24"><a href="introduction-to-categorization-models.html#cb612-24" tabindex="-1"></a>  samples_gcm <span class="ot">&lt;-</span> mod_gcm_single<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb612-25"><a href="introduction-to-categorization-models.html#cb612-25" tabindex="-1"></a>    <span class="at">data =</span> gcm_data,</span>
<span id="cb612-26"><a href="introduction-to-categorization-models.html#cb612-26" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb612-27"><a href="introduction-to-categorization-models.html#cb612-27" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb612-28"><a href="introduction-to-categorization-models.html#cb612-28" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb612-29"><a href="introduction-to-categorization-models.html#cb612-29" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb612-30"><a href="introduction-to-categorization-models.html#cb612-30" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb612-31"><a href="introduction-to-categorization-models.html#cb612-31" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb612-32"><a href="introduction-to-categorization-models.html#cb612-32" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb612-33"><a href="introduction-to-categorization-models.html#cb612-33" tabindex="-1"></a>  )</span>
<span id="cb612-34"><a href="introduction-to-categorization-models.html#cb612-34" tabindex="-1"></a>  </span>
<span id="cb612-35"><a href="introduction-to-categorization-models.html#cb612-35" tabindex="-1"></a>  <span class="co"># Save model fits</span></span>
<span id="cb612-36"><a href="introduction-to-categorization-models.html#cb612-36" tabindex="-1"></a>  samples_gcm<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/W11_gcm_single.rds&quot;</span>)</span>
<span id="cb612-37"><a href="introduction-to-categorization-models.html#cb612-37" tabindex="-1"></a>  </span>
<span id="cb612-38"><a href="introduction-to-categorization-models.html#cb612-38" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Models fitted and saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb612-39"><a href="introduction-to-categorization-models.html#cb612-39" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb612-40"><a href="introduction-to-categorization-models.html#cb612-40" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb612-41"><a href="introduction-to-categorization-models.html#cb612-41" tabindex="-1"></a>  samples_gcm <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/W11_gcm_single.rds&quot;</span>)</span>
<span id="cb612-42"><a href="introduction-to-categorization-models.html#cb612-42" tabindex="-1"></a>  </span>
<span id="cb612-43"><a href="introduction-to-categorization-models.html#cb612-43" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb612-44"><a href="introduction-to-categorization-models.html#cb612-44" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing model fits.</code></pre>
<p>Now we can check the parameter recovery:</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="introduction-to-categorization-models.html#cb614-1" tabindex="-1"></a>samples_gcm<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1,285 × 10
##    variable     mean   median     sd    mad        q5      q95   rhat ess_bulk ess_tail
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 lp__     -372.    -372.    0.997  0.732  -374.     -371.     1.00      401.     658.
##  2 w[1]        0.490    0.489 0.0563 0.0557    0.393     0.581  0.999     883.     492.
##  3 w[2]        0.510    0.511 0.0563 0.0557    0.419     0.607  0.999     883.     492.
##  4 logit_c     0.193    0.194 0.166  0.163    -0.0917    0.464  1.00      814.     571.
##  5 c           1.10     1.10  0.0817 0.0804    0.954     1.23   1.00      813.     571.
##  6 r[1]        0.5      0.5   0      0         0.5       0.5   NA          NA       NA 
##  7 r[2]        0.5      0.5   0      0         0.5       0.5   NA          NA       NA 
##  8 r[3]        0.369    0.370 0.0169 0.0174    0.341     0.396  1.00      745.     478.
##  9 r[4]        0.655    0.656 0.0226 0.0214    0.616     0.691  1.00      894.     549.
## 10 r[5]        0.491    0.491 0.0502 0.0491    0.406     0.572  0.999     882.     454.
## # ℹ 1,275 more rows</code></pre>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="introduction-to-categorization-models.html#cb616-1" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb616-2"><a href="introduction-to-categorization-models.html#cb616-2" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> draws_df <span class="sc">%&gt;%</span></span>
<span id="cb616-3"><a href="introduction-to-categorization-models.html#cb616-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_prior =</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(draws_df), <span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb616-4"><a href="introduction-to-categorization-models.html#cb616-4" tabindex="-1"></a>         <span class="at">w_prior1 =</span> <span class="fu">rdirichlet</span>(<span class="fu">nrow</span>(draws_df), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))[,<span class="dv">1</span>],</span>
<span id="cb616-5"><a href="introduction-to-categorization-models.html#cb616-5" tabindex="-1"></a>         <span class="at">w_prior2 =</span> <span class="fu">rdirichlet</span>(<span class="fu">nrow</span>(draws_df), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))[,<span class="dv">2</span>])</span>
<span id="cb616-6"><a href="introduction-to-categorization-models.html#cb616-6" tabindex="-1"></a></span>
<span id="cb616-7"><a href="introduction-to-categorization-models.html#cb616-7" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb616-8"><a href="introduction-to-categorization-models.html#cb616-8" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb616-9"><a href="introduction-to-categorization-models.html#cb616-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb616-10"><a href="introduction-to-categorization-models.html#cb616-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d<span class="sc">$</span>c[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb616-11"><a href="introduction-to-categorization-models.html#cb616-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/11%20visualizing%20gcm%20stan%20model-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="introduction-to-categorization-models.html#cb617-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb617-2"><a href="introduction-to-categorization-models.html#cb617-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb617-3"><a href="introduction-to-categorization-models.html#cb617-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior1</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb617-4"><a href="introduction-to-categorization-models.html#cb617-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb617-5"><a href="introduction-to-categorization-models.html#cb617-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/11%20visualizing%20gcm%20stan%20model-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="introduction-to-categorization-models.html#cb618-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb618-2"><a href="introduction-to-categorization-models.html#cb618-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w[2]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb618-3"><a href="introduction-to-categorization-models.html#cb618-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior2</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb618-4"><a href="introduction-to-categorization-models.html#cb618-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb618-5"><a href="introduction-to-categorization-models.html#cb618-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/11%20visualizing%20gcm%20stan%20model-3.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Recovery seems decent. Let’s look at the larger picture, but looping through the different combinations of parameter values.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="introduction-to-categorization-models.html#cb619-1" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb619-2"><a href="introduction-to-categorization-models.html#cb619-2" tabindex="-1"></a>  </span>
<span id="cb619-3"><a href="introduction-to-categorization-models.html#cb619-3" tabindex="-1"></a>  pacman<span class="sc">::</span><span class="fu">p_load</span>(future, purrr, furrr)</span>
<span id="cb619-4"><a href="introduction-to-categorization-models.html#cb619-4" tabindex="-1"></a>  <span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb619-5"><a href="introduction-to-categorization-models.html#cb619-5" tabindex="-1"></a>  </span>
<span id="cb619-6"><a href="introduction-to-categorization-models.html#cb619-6" tabindex="-1"></a>  sim_d_and_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, scaling, weight1, weight2) {</span>
<span id="cb619-7"><a href="introduction-to-categorization-models.html#cb619-7" tabindex="-1"></a>    </span>
<span id="cb619-8"><a href="introduction-to-categorization-models.html#cb619-8" tabindex="-1"></a>    </span>
<span id="cb619-9"><a href="introduction-to-categorization-models.html#cb619-9" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> simulated_responses <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb619-10"><a href="introduction-to-categorization-models.html#cb619-10" tabindex="-1"></a>      c <span class="sc">==</span> scaling <span class="sc">&amp;</span> w1 <span class="sc">==</span> weight1 <span class="sc">&amp;</span> w2 <span class="sc">==</span> weight2 <span class="sc">&amp;</span> agent <span class="sc">==</span> agent</span>
<span id="cb619-11"><a href="introduction-to-categorization-models.html#cb619-11" tabindex="-1"></a>    )</span>
<span id="cb619-12"><a href="introduction-to-categorization-models.html#cb619-12" tabindex="-1"></a>    </span>
<span id="cb619-13"><a href="introduction-to-categorization-models.html#cb619-13" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb619-14"><a href="introduction-to-categorization-models.html#cb619-14" tabindex="-1"></a>      <span class="at">ntrials =</span> <span class="fu">nrow</span>(temp),</span>
<span id="cb619-15"><a href="introduction-to-categorization-models.html#cb619-15" tabindex="-1"></a>      <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb619-16"><a href="introduction-to-categorization-models.html#cb619-16" tabindex="-1"></a>      <span class="at">cat_one =</span> temp<span class="sc">$</span>category,</span>
<span id="cb619-17"><a href="introduction-to-categorization-models.html#cb619-17" tabindex="-1"></a>      <span class="at">y =</span> temp<span class="sc">$</span>sim_response,</span>
<span id="cb619-18"><a href="introduction-to-categorization-models.html#cb619-18" tabindex="-1"></a>      <span class="at">obs =</span> <span class="fu">as.matrix</span>(temp[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb619-19"><a href="introduction-to-categorization-models.html#cb619-19" tabindex="-1"></a>      <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb619-20"><a href="introduction-to-categorization-models.html#cb619-20" tabindex="-1"></a>      <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb619-21"><a href="introduction-to-categorization-models.html#cb619-21" tabindex="-1"></a>      <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb619-22"><a href="introduction-to-categorization-models.html#cb619-22" tabindex="-1"></a>    )</span>
<span id="cb619-23"><a href="introduction-to-categorization-models.html#cb619-23" tabindex="-1"></a>    </span>
<span id="cb619-24"><a href="introduction-to-categorization-models.html#cb619-24" tabindex="-1"></a>    samples_gcm <span class="ot">&lt;-</span> mod_gcm_single<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb619-25"><a href="introduction-to-categorization-models.html#cb619-25" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb619-26"><a href="introduction-to-categorization-models.html#cb619-26" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb619-27"><a href="introduction-to-categorization-models.html#cb619-27" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb619-28"><a href="introduction-to-categorization-models.html#cb619-28" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb619-29"><a href="introduction-to-categorization-models.html#cb619-29" tabindex="-1"></a>      <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb619-30"><a href="introduction-to-categorization-models.html#cb619-30" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb619-31"><a href="introduction-to-categorization-models.html#cb619-31" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb619-32"><a href="introduction-to-categorization-models.html#cb619-32" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb619-33"><a href="introduction-to-categorization-models.html#cb619-33" tabindex="-1"></a>    )</span>
<span id="cb619-34"><a href="introduction-to-categorization-models.html#cb619-34" tabindex="-1"></a>    </span>
<span id="cb619-35"><a href="introduction-to-categorization-models.html#cb619-35" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb619-36"><a href="introduction-to-categorization-models.html#cb619-36" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trueC =</span> scaling, <span class="at">trueW1 =</span> weight1, <span class="at">trueW2 =</span> weight2, <span class="at">agent =</span> agent,</span>
<span id="cb619-37"><a href="introduction-to-categorization-models.html#cb619-37" tabindex="-1"></a>                   <span class="at">estC =</span> draws_df<span class="sc">$</span>c, </span>
<span id="cb619-38"><a href="introduction-to-categorization-models.html#cb619-38" tabindex="-1"></a>                   <span class="at">estW1 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[1]</span><span class="st">`</span>,</span>
<span id="cb619-39"><a href="introduction-to-categorization-models.html#cb619-39" tabindex="-1"></a>                   <span class="at">estW2 =</span> draws_df<span class="sc">$</span><span class="st">`</span><span class="at">w[2]</span><span class="st">`</span></span>
<span id="cb619-40"><a href="introduction-to-categorization-models.html#cb619-40" tabindex="-1"></a>    )</span>
<span id="cb619-41"><a href="introduction-to-categorization-models.html#cb619-41" tabindex="-1"></a>    </span>
<span id="cb619-42"><a href="introduction-to-categorization-models.html#cb619-42" tabindex="-1"></a>    <span class="fu">return</span>(temp)</span>
<span id="cb619-43"><a href="introduction-to-categorization-models.html#cb619-43" tabindex="-1"></a>    </span>
<span id="cb619-44"><a href="introduction-to-categorization-models.html#cb619-44" tabindex="-1"></a>  }</span>
<span id="cb619-45"><a href="introduction-to-categorization-models.html#cb619-45" tabindex="-1"></a>  </span>
<span id="cb619-46"><a href="introduction-to-categorization-models.html#cb619-46" tabindex="-1"></a>  </span>
<span id="cb619-47"><a href="introduction-to-categorization-models.html#cb619-47" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">unique</span>(simulated_responses[,<span class="fu">c</span>(<span class="st">&quot;agent&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;w1&quot;</span>, <span class="st">&quot;w2&quot;</span>)])) <span class="sc">%&gt;%</span></span>
<span id="cb619-48"><a href="introduction-to-categorization-models.html#cb619-48" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb619-49"><a href="introduction-to-categorization-models.html#cb619-49" tabindex="-1"></a>      <span class="at">scaling =</span> c,</span>
<span id="cb619-50"><a href="introduction-to-categorization-models.html#cb619-50" tabindex="-1"></a>      <span class="at">weight1 =</span> w1,</span>
<span id="cb619-51"><a href="introduction-to-categorization-models.html#cb619-51" tabindex="-1"></a>      <span class="at">weight2 =</span> w2</span>
<span id="cb619-52"><a href="introduction-to-categorization-models.html#cb619-52" tabindex="-1"></a>    )</span>
<span id="cb619-53"><a href="introduction-to-categorization-models.html#cb619-53" tabindex="-1"></a>  </span>
<span id="cb619-54"><a href="introduction-to-categorization-models.html#cb619-54" tabindex="-1"></a>  recovery_df <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(temp, sim_d_and_fit, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb619-55"><a href="introduction-to-categorization-models.html#cb619-55" tabindex="-1"></a>  </span>
<span id="cb619-56"><a href="introduction-to-categorization-models.html#cb619-56" tabindex="-1"></a>  <span class="co"># Save model fits</span></span>
<span id="cb619-57"><a href="introduction-to-categorization-models.html#cb619-57" tabindex="-1"></a>  <span class="fu">write_csv</span>(recovery_df, <span class="st">&quot;simdata/W11_GCM_single_recoverydf.csv&quot;</span>)</span>
<span id="cb619-58"><a href="introduction-to-categorization-models.html#cb619-58" tabindex="-1"></a>  </span>
<span id="cb619-59"><a href="introduction-to-categorization-models.html#cb619-59" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Models fitted and saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb619-60"><a href="introduction-to-categorization-models.html#cb619-60" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb619-61"><a href="introduction-to-categorization-models.html#cb619-61" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb619-62"><a href="introduction-to-categorization-models.html#cb619-62" tabindex="-1"></a>  recovery_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;simdata/W11_GCM_single_recoverydf.csv&quot;</span>)</span>
<span id="cb619-63"><a href="introduction-to-categorization-models.html#cb619-63" tabindex="-1"></a>  </span>
<span id="cb619-64"><a href="introduction-to-categorization-models.html#cb619-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb619-65"><a href="introduction-to-categorization-models.html#cb619-65" tabindex="-1"></a>}</span></code></pre></div>
<p>Time to visualize</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="introduction-to-categorization-models.html#cb620-1" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;simdata/W11_GCM_single_recoverydf.csv&quot;</span>)</span>
<span id="cb620-2"><a href="introduction-to-categorization-models.html#cb620-2" tabindex="-1"></a></span>
<span id="cb620-3"><a href="introduction-to-categorization-models.html#cb620-3" tabindex="-1"></a>vline_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">trueC =</span> <span class="fu">unique</span>(recovery_df<span class="sc">$</span>trueC))</span>
<span id="cb620-4"><a href="introduction-to-categorization-models.html#cb620-4" tabindex="-1"></a></span>
<span id="cb620-5"><a href="introduction-to-categorization-models.html#cb620-5" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb620-6"><a href="introduction-to-categorization-models.html#cb620-6" tabindex="-1"></a>     <span class="fu">geom_density</span>(<span class="fu">aes</span>(estC), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb620-7"><a href="introduction-to-categorization-models.html#cb620-7" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(. <span class="sc">~</span> trueC) <span class="sc">+</span></span>
<span id="cb620-8"><a href="introduction-to-categorization-models.html#cb620-8" tabindex="-1"></a>     <span class="fu">geom_vline</span>(<span class="at">data =</span> vline_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> trueC)) <span class="sc">+</span></span>
<span id="cb620-9"><a href="introduction-to-categorization-models.html#cb620-9" tabindex="-1"></a>     <span class="fu">theme_bw</span>()</span>
<span id="cb620-10"><a href="introduction-to-categorization-models.html#cb620-10" tabindex="-1"></a></span>
<span id="cb620-11"><a href="introduction-to-categorization-models.html#cb620-11" tabindex="-1"></a>vline_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">trueW1 =</span> <span class="fu">unique</span>(recovery_df<span class="sc">$</span>trueW1))</span>
<span id="cb620-12"><a href="introduction-to-categorization-models.html#cb620-12" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb620-13"><a href="introduction-to-categorization-models.html#cb620-13" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estW1), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb620-14"><a href="introduction-to-categorization-models.html#cb620-14" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> trueW1) <span class="sc">+</span></span>
<span id="cb620-15"><a href="introduction-to-categorization-models.html#cb620-15" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> vline_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> trueW1)) <span class="sc">+</span></span>
<span id="cb620-16"><a href="introduction-to-categorization-models.html#cb620-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb620-17"><a href="introduction-to-categorization-models.html#cb620-17" tabindex="-1"></a></span>
<span id="cb620-18"><a href="introduction-to-categorization-models.html#cb620-18" tabindex="-1"></a>vline_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">trueW2 =</span> <span class="fu">unique</span>(recovery_df<span class="sc">$</span>trueW2))</span>
<span id="cb620-19"><a href="introduction-to-categorization-models.html#cb620-19" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recovery_df) <span class="sc">+</span></span>
<span id="cb620-20"><a href="introduction-to-categorization-models.html#cb620-20" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(estW2), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb620-21"><a href="introduction-to-categorization-models.html#cb620-21" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> trueW2) <span class="sc">+</span></span>
<span id="cb620-22"><a href="introduction-to-categorization-models.html#cb620-22" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> vline_data, <span class="fu">aes</span>(<span class="at">xintercept =</span> trueW2)) <span class="sc">+</span></span>
<span id="cb620-23"><a href="introduction-to-categorization-models.html#cb620-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb620-24"><a href="introduction-to-categorization-models.html#cb620-24" tabindex="-1"></a></span>
<span id="cb620-25"><a href="introduction-to-categorization-models.html#cb620-25" tabindex="-1"></a>p1 <span class="sc">/</span> p2 <span class="sc">/</span> p3</span></code></pre></div>
<p><img src="series_files/figure-html/11%20visualize%20parameter%20recovery%20gcm%20single-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="key-parameters-and-their-cognitive-interpretations" class="section level3 hasAnchor" number="12.6.7">
<h3><span class="header-section-number">12.6.7</span> Key Parameters and Their Cognitive Interpretations<a href="introduction-to-categorization-models.html#key-parameters-and-their-cognitive-interpretations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The GCM has two primary parameters.</p>
<ol style="list-style-type: decimal">
<li>Attention Weights (w)</li>
</ol>
<p>The attention weights determine how much each stimulus dimension contributes to similarity calculations:</p>
<ul>
<li><p>Higher weight on a dimension means greater attention to that dimension</p></li>
<li><p>Attention is selective - increasing weight on one dimension necessarily decreases weight on others</p></li>
<li><p>Attention can adapt to category structures, focusing on dimensions that discriminate between categories</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Sensitivity Parameter (c)</li>
</ol>
<p>The sensitivity parameter determines how quickly similarity decreases with distance:</p>
<ul>
<li><p>Higher c values mean similarity decreases more rapidly with distance</p></li>
<li><p>Lower c values lead to more generalization across similar stimuli</p></li>
</ul>
<p>This parameter can be variously interpreted as representing:</p>
<ul>
<li><p>Perceptual discriminability: How easily differences can be perceived</p></li>
<li><p>Memory distinctiveness: How separately items are stored in memory</p></li>
<li><p>Categorization specificity: How narrowly categories are defined</p></li>
</ul>
<p>This multiplicity of interpretation should keep your critical senses on high alert. Math is oblivious of cognitive interpretation. All the interpretive work, triangulating with other evidence sources, making theoretical assumptions explicit, etc. is on you.</p>
</div>
</div>
<div id="multilevel-generalized-context-model-gcm" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Multilevel Generalized Context Model (GCM)<a href="introduction-to-categorization-models.html#multilevel-generalized-context-model-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-need-for-a-multilevel-approach" class="section level3 hasAnchor" number="12.7.1">
<h3><span class="header-section-number">12.7.1</span> The Need for a Multilevel Approach<a href="introduction-to-categorization-models.html#the-need-for-a-multilevel-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are often interested in understanding both individual differences and group-level patterns in categorization. Here is where the multilevel (or hierarchical) approach comes in handy [See chapter 7].</p>
<p>The multilevel GCM extends the standard model by assuming that individual participant parameters are drawn from group-level distributions. This approach bridges the gap between treating all participants identically (ignoring individual differences) and treating all participants completely independently (ignoring shared patterns).</p>
</div>
<div id="mathematical-formulation-of-the-multilevel-gcm" class="section level3 hasAnchor" number="12.7.2">
<h3><span class="header-section-number">12.7.2</span> Mathematical Formulation of the Multilevel GCM<a href="introduction-to-categorization-models.html#mathematical-formulation-of-the-multilevel-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The multilevel GCM extends the standard model in the following ways:</p>
<ol style="list-style-type: decimal">
<li>Population-Level Parameters</li>
</ol>
<p>A population mean for the sensitivity parameter: <span class="math inline">\(\mu_c\)</span></p>
<p>A population standard deviation for the sensitivity parameter: <span class="math inline">\(\sigma_c\)</span></p>
<p>A population distribution for attention weights: <span class="math inline">\(\alpha = \kappa \cdot \omega\)</span>, where:</p>
<p><span class="math inline">\(\omega\)</span> is a population-level simplex (summing to 1)</p>
<p><span class="math inline">\(\kappa\)</span> is a concentration parameter controlling individual variation</p>
<ol start="2" style="list-style-type: decimal">
<li>Individual-Level Parameters</li>
</ol>
<p>Each participant j has a sensitivity parameter <span class="math inline">\(c_j \sim \text{Normal}(\mu_c, \sigma_c)\)</span></p>
<p>Each participant j has attention weights <span class="math inline">\(w_j \sim \text{Dirichlet}(\kappa \cdot \omega)\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Probability of Categorization</li>
</ol>
<p>The probability calculations follow the same principles as the standard GCM but are performed separately for each participant.</p>
</div>
<div id="simulating-data-for-a-multilevel-gcm" class="section level3 hasAnchor" number="12.7.3">
<h3><span class="header-section-number">12.7.3</span> Simulating Data for a Multilevel GCM<a href="introduction-to-categorization-models.html#simulating-data-for-a-multilevel-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To understand the multilevel GCM, let’s first simulate data from agents with varying parameters. We need to simulate hierarchical simplices for the attention weights:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="introduction-to-categorization-models.html#cb621-1" tabindex="-1"></a>simulate_dirichlet <span class="ot">&lt;-</span> <span class="cf">function</span>(weights, kappa, agents){</span>
<span id="cb621-2"><a href="introduction-to-categorization-models.html#cb621-2" tabindex="-1"></a>  </span>
<span id="cb621-3"><a href="introduction-to-categorization-models.html#cb621-3" tabindex="-1"></a>  w_n <span class="ot">&lt;-</span> <span class="fu">length</span>(weights)</span>
<span id="cb621-4"><a href="introduction-to-categorization-models.html#cb621-4" tabindex="-1"></a>  </span>
<span id="cb621-5"><a href="introduction-to-categorization-models.html#cb621-5" tabindex="-1"></a>  w_ind <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(agents, weights <span class="sc">*</span> kappa)</span>
<span id="cb621-6"><a href="introduction-to-categorization-models.html#cb621-6" tabindex="-1"></a>  </span>
<span id="cb621-7"><a href="introduction-to-categorization-models.html#cb621-7" tabindex="-1"></a>  w_ind_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb621-8"><a href="introduction-to-categorization-models.html#cb621-8" tabindex="-1"></a>    <span class="at">agent =</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(agents), <span class="at">each =</span> w_n)),</span>
<span id="cb621-9"><a href="introduction-to-categorization-models.html#cb621-9" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(w_ind),</span>
<span id="cb621-10"><a href="introduction-to-categorization-models.html#cb621-10" tabindex="-1"></a>    <span class="at">weight =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(w_n), agents)</span>
<span id="cb621-11"><a href="introduction-to-categorization-models.html#cb621-11" tabindex="-1"></a>  )</span>
<span id="cb621-12"><a href="introduction-to-categorization-models.html#cb621-12" tabindex="-1"></a>  </span>
<span id="cb621-13"><a href="introduction-to-categorization-models.html#cb621-13" tabindex="-1"></a>  <span class="fu">return</span>(w_ind_df)</span>
<span id="cb621-14"><a href="introduction-to-categorization-models.html#cb621-14" tabindex="-1"></a>}</span>
<span id="cb621-15"><a href="introduction-to-categorization-models.html#cb621-15" tabindex="-1"></a></span>
<span id="cb621-16"><a href="introduction-to-categorization-models.html#cb621-16" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_dirichlet</span>(<span class="at">weights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">kappa =</span> <span class="dv">100</span>, <span class="at">agents =</span> <span class="dv">10</span>)</span>
<span id="cb621-17"><a href="introduction-to-categorization-models.html#cb621-17" tabindex="-1"></a></span>
<span id="cb621-18"><a href="introduction-to-categorization-models.html#cb621-18" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(weight, value, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb621-19"><a href="introduction-to-categorization-models.html#cb621-19" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb621-20"><a href="introduction-to-categorization-models.html#cb621-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb621-21"><a href="introduction-to-categorization-models.html#cb621-21" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb621-22"><a href="introduction-to-categorization-models.html#cb621-22" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb621-23"><a href="introduction-to-categorization-models.html#cb621-23" tabindex="-1"></a></span>
<span id="cb621-24"><a href="introduction-to-categorization-models.html#cb621-24" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_dirichlet</span>(<span class="at">weights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">kappa =</span> <span class="dv">1</span>, <span class="at">agents =</span> <span class="dv">10</span>)</span>
<span id="cb621-25"><a href="introduction-to-categorization-models.html#cb621-25" tabindex="-1"></a></span>
<span id="cb621-26"><a href="introduction-to-categorization-models.html#cb621-26" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(weight, value, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span></span>
<span id="cb621-27"><a href="introduction-to-categorization-models.html#cb621-27" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb621-28"><a href="introduction-to-categorization-models.html#cb621-28" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb621-29"><a href="introduction-to-categorization-models.html#cb621-29" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb621-30"><a href="introduction-to-categorization-models.html#cb621-30" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb621-31"><a href="introduction-to-categorization-models.html#cb621-31" tabindex="-1"></a></span>
<span id="cb621-32"><a href="introduction-to-categorization-models.html#cb621-32" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-69-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>These visualizations show how the concentration parameter <span class="math inline">\(\kappa\)</span>
κ controls individual variation:</p>
<p>With high <span class="math inline">\(\kappa\)</span> (e.g., 100), individual attention weights cluster tightly around the population mean</p>
<p>With low <span class="math inline">\(\kappa\)</span> (e.g., 1), individual attention weights vary widely around the population mean</p>
<p>Now we can simulate responses from multiple agents with parameters drawn from group-level distributions:</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="introduction-to-categorization-models.html#cb622-1" tabindex="-1"></a>simulate_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, w, c) {</span>
<span id="cb622-2"><a href="introduction-to-categorization-models.html#cb622-2" tabindex="-1"></a>    </span>
<span id="cb622-3"><a href="introduction-to-categorization-models.html#cb622-3" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb622-4"><a href="introduction-to-categorization-models.html#cb622-4" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))</span>
<span id="cb622-5"><a href="introduction-to-categorization-models.html#cb622-5" tabindex="-1"></a>    </span>
<span id="cb622-6"><a href="introduction-to-categorization-models.html#cb622-6" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category</span>
<span id="cb622-7"><a href="introduction-to-categorization-models.html#cb622-7" tabindex="-1"></a></span>
<span id="cb622-8"><a href="introduction-to-categorization-models.html#cb622-8" tabindex="-1"></a>    <span class="co"># simulate responses</span></span>
<span id="cb622-9"><a href="introduction-to-categorization-models.html#cb622-9" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">gcm</span>(</span>
<span id="cb622-10"><a href="introduction-to-categorization-models.html#cb622-10" tabindex="-1"></a>        w,</span>
<span id="cb622-11"><a href="introduction-to-categorization-models.html#cb622-11" tabindex="-1"></a>        c,</span>
<span id="cb622-12"><a href="introduction-to-categorization-models.html#cb622-12" tabindex="-1"></a>        observations,</span>
<span id="cb622-13"><a href="introduction-to-categorization-models.html#cb622-13" tabindex="-1"></a>        category</span>
<span id="cb622-14"><a href="introduction-to-categorization-models.html#cb622-14" tabindex="-1"></a>    )</span>
<span id="cb622-15"><a href="introduction-to-categorization-models.html#cb622-15" tabindex="-1"></a>    </span>
<span id="cb622-16"><a href="introduction-to-categorization-models.html#cb622-16" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb622-17"><a href="introduction-to-categorization-models.html#cb622-17" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb622-18"><a href="introduction-to-categorization-models.html#cb622-18" tabindex="-1"></a>            <span class="at">trial =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(experiment)),</span>
<span id="cb622-19"><a href="introduction-to-categorization-models.html#cb622-19" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb622-20"><a href="introduction-to-categorization-models.html#cb622-20" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb622-21"><a href="introduction-to-categorization-models.html#cb622-21" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> <span class="fu">seq_along</span>(correct),</span>
<span id="cb622-22"><a href="introduction-to-categorization-models.html#cb622-22" tabindex="-1"></a>            <span class="at">c =</span> c,</span>
<span id="cb622-23"><a href="introduction-to-categorization-models.html#cb622-23" tabindex="-1"></a>            <span class="at">w1 =</span> w[<span class="dv">1</span>],</span>
<span id="cb622-24"><a href="introduction-to-categorization-models.html#cb622-24" tabindex="-1"></a>            <span class="at">w2 =</span> w[<span class="dv">2</span>],</span>
<span id="cb622-25"><a href="introduction-to-categorization-models.html#cb622-25" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb622-26"><a href="introduction-to-categorization-models.html#cb622-26" tabindex="-1"></a>        )</span>
<span id="cb622-27"><a href="introduction-to-categorization-models.html#cb622-27" tabindex="-1"></a></span>
<span id="cb622-28"><a href="introduction-to-categorization-models.html#cb622-28" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb622-29"><a href="introduction-to-categorization-models.html#cb622-29" tabindex="-1"></a>}</span>
<span id="cb622-30"><a href="introduction-to-categorization-models.html#cb622-30" tabindex="-1"></a></span>
<span id="cb622-31"><a href="introduction-to-categorization-models.html#cb622-31" tabindex="-1"></a>simulate_ml_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agents, scalingM, scalingSD, weights, kappa) {</span>
<span id="cb622-32"><a href="introduction-to-categorization-models.html#cb622-32" tabindex="-1"></a>  </span>
<span id="cb622-33"><a href="introduction-to-categorization-models.html#cb622-33" tabindex="-1"></a>  w_ind <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(agents, weights <span class="sc">*</span> kappa)</span>
<span id="cb622-34"><a href="introduction-to-categorization-models.html#cb622-34" tabindex="-1"></a>  c_ind <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(agents, scalingM, scalingSD)</span>
<span id="cb622-35"><a href="introduction-to-categorization-models.html#cb622-35" tabindex="-1"></a>  </span>
<span id="cb622-36"><a href="introduction-to-categorization-models.html#cb622-36" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb622-37"><a href="introduction-to-categorization-models.html#cb622-37" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">simulate_responses</span>(i, <span class="at">w =</span> <span class="fu">c</span>(w_ind[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="at">c =</span> c_ind[i])</span>
<span id="cb622-38"><a href="introduction-to-categorization-models.html#cb622-38" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb622-39"><a href="introduction-to-categorization-models.html#cb622-39" tabindex="-1"></a>      simulated_responses <span class="ot">&lt;-</span> tmp</span>
<span id="cb622-40"><a href="introduction-to-categorization-models.html#cb622-40" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb622-41"><a href="introduction-to-categorization-models.html#cb622-41" tabindex="-1"></a>      simulated_responses <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simulated_responses, tmp)</span>
<span id="cb622-42"><a href="introduction-to-categorization-models.html#cb622-42" tabindex="-1"></a>    }</span>
<span id="cb622-43"><a href="introduction-to-categorization-models.html#cb622-43" tabindex="-1"></a>  }</span>
<span id="cb622-44"><a href="introduction-to-categorization-models.html#cb622-44" tabindex="-1"></a>  </span>
<span id="cb622-45"><a href="introduction-to-categorization-models.html#cb622-45" tabindex="-1"></a>  <span class="fu">return</span>(simulated_responses)</span>
<span id="cb622-46"><a href="introduction-to-categorization-models.html#cb622-46" tabindex="-1"></a>}</span>
<span id="cb622-47"><a href="introduction-to-categorization-models.html#cb622-47" tabindex="-1"></a></span>
<span id="cb622-48"><a href="introduction-to-categorization-models.html#cb622-48" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb622-49"><a href="introduction-to-categorization-models.html#cb622-49" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb622-50"><a href="introduction-to-categorization-models.html#cb622-50" tabindex="-1"></a>scalingM <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb622-51"><a href="introduction-to-categorization-models.html#cb622-51" tabindex="-1"></a>scalingSD <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb622-52"><a href="introduction-to-categorization-models.html#cb622-52" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb622-53"><a href="introduction-to-categorization-models.html#cb622-53" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb622-54"><a href="introduction-to-categorization-models.html#cb622-54" tabindex="-1"></a></span>
<span id="cb622-55"><a href="introduction-to-categorization-models.html#cb622-55" tabindex="-1"></a><span class="co"># Simulate and visualize</span></span>
<span id="cb622-56"><a href="introduction-to-categorization-models.html#cb622-56" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">simulate_ml_responses</span>(agents, scalingM, scalingSD, weights, kappa)</span>
<span id="cb622-57"><a href="introduction-to-categorization-models.html#cb622-57" tabindex="-1"></a></span>
<span id="cb622-58"><a href="introduction-to-categorization-models.html#cb622-58" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, performance)) <span class="sc">+</span></span>
<span id="cb622-59"><a href="introduction-to-categorization-models.html#cb622-59" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb622-60"><a href="introduction-to-categorization-models.html#cb622-60" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> agent, <span class="at">color =</span> agent), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb622-61"><a href="introduction-to-categorization-models.html#cb622-61" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-70-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This plot shows learning curves for multiple simulated agents. We can observe:</p>
<ul>
<li><p>Individual differences in learning trajectories</p></li>
<li><p>A general group trend toward improved performance at first and a plateau after</p></li>
<li><p>Variability in asymptotic performance levels</p></li>
</ul>
</div>
<div id="implementing-the-multilevel-gcm-in-stan" class="section level3 hasAnchor" number="12.7.4">
<h3><span class="header-section-number">12.7.4</span> Implementing the Multilevel GCM in Stan<a href="introduction-to-categorization-models.html#implementing-the-multilevel-gcm-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Stan implementation of the multilevel GCM extends the standard implementation by adding population-level parameters and hierarchical structure:</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="introduction-to-categorization-models.html#cb623-1" tabindex="-1"></a>gcm_ml_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb623-2"><a href="introduction-to-categorization-models.html#cb623-2" tabindex="-1"></a><span class="st">// Generalized Context Model (GCM) - multilevel version</span></span>
<span id="cb623-3"><a href="introduction-to-categorization-models.html#cb623-3" tabindex="-1"></a></span>
<span id="cb623-4"><a href="introduction-to-categorization-models.html#cb623-4" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb623-5"><a href="introduction-to-categorization-models.html#cb623-5" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nsubjects;  // number of subjects</span></span>
<span id="cb623-6"><a href="introduction-to-categorization-models.html#cb623-6" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; ntrials;  // number of trials</span></span>
<span id="cb623-7"><a href="introduction-to-categorization-models.html#cb623-7" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; nfeatures;  // number of predefined relevant features</span></span>
<span id="cb623-8"><a href="introduction-to-categorization-models.html#cb623-8" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_one; // true responses on a trial by trial basis</span></span>
<span id="cb623-9"><a href="introduction-to-categorization-models.html#cb623-9" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] int&lt;lower=0, upper=1&gt; y;  // decisions on a trial by trial basis</span></span>
<span id="cb623-10"><a href="introduction-to-categorization-models.html#cb623-10" tabindex="-1"></a><span class="st">    array[ntrials, nfeatures] real obs; // stimuli as vectors of features assuming all participants get the same sequence</span></span>
<span id="cb623-11"><a href="introduction-to-categorization-models.html#cb623-11" tabindex="-1"></a><span class="st">    real&lt;lower=0, upper=1&gt; b;  // initial bias for category one over two</span></span>
<span id="cb623-12"><a href="introduction-to-categorization-models.html#cb623-12" tabindex="-1"></a></span>
<span id="cb623-13"><a href="introduction-to-categorization-models.html#cb623-13" tabindex="-1"></a><span class="st">    // priors</span></span>
<span id="cb623-14"><a href="introduction-to-categorization-models.html#cb623-14" tabindex="-1"></a><span class="st">    vector[nfeatures] w_prior_values;  // concentration parameters for dirichlet distribution &lt;lower=1&gt;</span></span>
<span id="cb623-15"><a href="introduction-to-categorization-models.html#cb623-15" tabindex="-1"></a><span class="st">    array[2] real c_prior_values;  // mean and variance for logit-normal distribution</span></span>
<span id="cb623-16"><a href="introduction-to-categorization-models.html#cb623-16" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb623-17"><a href="introduction-to-categorization-models.html#cb623-17" tabindex="-1"></a></span>
<span id="cb623-18"><a href="introduction-to-categorization-models.html#cb623-18" tabindex="-1"></a><span class="st">transformed data { // assuming all participants get the same sequence</span></span>
<span id="cb623-19"><a href="introduction-to-categorization-models.html#cb623-19" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb623-20"><a href="introduction-to-categorization-models.html#cb623-20" tabindex="-1"></a><span class="st">    array[ntrials] int&lt;lower=0, upper=1&gt; cat_two; // dummy variable for category two over cat 1</span></span>
<span id="cb623-21"><a href="introduction-to-categorization-models.html#cb623-21" tabindex="-1"></a><span class="st">    array[sum(cat_one)] int&lt;lower=1, upper = ntrials&gt; cat_one_idx; // array of which stimuli are cat 1</span></span>
<span id="cb623-22"><a href="introduction-to-categorization-models.html#cb623-22" tabindex="-1"></a><span class="st">    array[ntrials - sum(cat_one)] int&lt;lower = 1, upper = ntrials&gt; cat_two_idx; //  array of which stimuli are cat 2</span></span>
<span id="cb623-23"><a href="introduction-to-categorization-models.html#cb623-23" tabindex="-1"></a><span class="st">    int idx_one = 1; // Initializing </span></span>
<span id="cb623-24"><a href="introduction-to-categorization-models.html#cb623-24" tabindex="-1"></a><span class="st">    int idx_two = 1;</span></span>
<span id="cb623-25"><a href="introduction-to-categorization-models.html#cb623-25" tabindex="-1"></a><span class="st">    for (i in 1:ntrials){</span></span>
<span id="cb623-26"><a href="introduction-to-categorization-models.html#cb623-26" tabindex="-1"></a><span class="st">        cat_two[i] = abs(cat_one[i]-1);</span></span>
<span id="cb623-27"><a href="introduction-to-categorization-models.html#cb623-27" tabindex="-1"></a></span>
<span id="cb623-28"><a href="introduction-to-categorization-models.html#cb623-28" tabindex="-1"></a><span class="st">        if (cat_one[i]==1){</span></span>
<span id="cb623-29"><a href="introduction-to-categorization-models.html#cb623-29" tabindex="-1"></a><span class="st">            cat_one_idx[idx_one] = i;</span></span>
<span id="cb623-30"><a href="introduction-to-categorization-models.html#cb623-30" tabindex="-1"></a><span class="st">            idx_one +=1;</span></span>
<span id="cb623-31"><a href="introduction-to-categorization-models.html#cb623-31" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb623-32"><a href="introduction-to-categorization-models.html#cb623-32" tabindex="-1"></a><span class="st">            cat_two_idx[idx_two] = i;</span></span>
<span id="cb623-33"><a href="introduction-to-categorization-models.html#cb623-33" tabindex="-1"></a><span class="st">            idx_two += 1;</span></span>
<span id="cb623-34"><a href="introduction-to-categorization-models.html#cb623-34" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb623-35"><a href="introduction-to-categorization-models.html#cb623-35" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb623-36"><a href="introduction-to-categorization-models.html#cb623-36" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb623-37"><a href="introduction-to-categorization-models.html#cb623-37" tabindex="-1"></a></span>
<span id="cb623-38"><a href="introduction-to-categorization-models.html#cb623-38" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb623-39"><a href="introduction-to-categorization-models.html#cb623-39" tabindex="-1"></a><span class="st">    real logit_c_M;    // Pop Mean of the scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb623-40"><a href="introduction-to-categorization-models.html#cb623-40" tabindex="-1"></a><span class="st">    real&lt;lower = 0&gt; logit_c_SD;    // Pop SD of the scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb623-41"><a href="introduction-to-categorization-models.html#cb623-41" tabindex="-1"></a><span class="st">    vector[nsubjects] logit_c;    // scaling parameter (how fast similarity decrease with distance). </span></span>
<span id="cb623-42"><a href="introduction-to-categorization-models.html#cb623-42" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb623-43"><a href="introduction-to-categorization-models.html#cb623-43" tabindex="-1"></a><span class="st">    simplex[nfeatures] weight;  // simplex means sum(w)=1</span></span>
<span id="cb623-44"><a href="introduction-to-categorization-models.html#cb623-44" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; kappa;</span></span>
<span id="cb623-45"><a href="introduction-to-categorization-models.html#cb623-45" tabindex="-1"></a><span class="st">    array[nsubjects] simplex[nfeatures] w_ind;    // weight parameter (how much attention should be paid to feature 1 related to feature 2 - summing up to 1)</span></span>
<span id="cb623-46"><a href="introduction-to-categorization-models.html#cb623-46" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb623-47"><a href="introduction-to-categorization-models.html#cb623-47" tabindex="-1"></a></span>
<span id="cb623-48"><a href="introduction-to-categorization-models.html#cb623-48" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb623-49"><a href="introduction-to-categorization-models.html#cb623-49" tabindex="-1"></a><span class="st">    // parameter w</span></span>
<span id="cb623-50"><a href="introduction-to-categorization-models.html#cb623-50" tabindex="-1"></a><span class="st">    vector[nfeatures] alpha = kappa * weight;</span></span>
<span id="cb623-51"><a href="introduction-to-categorization-models.html#cb623-51" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb623-52"><a href="introduction-to-categorization-models.html#cb623-52" tabindex="-1"></a><span class="st">    // parameter c </span></span>
<span id="cb623-53"><a href="introduction-to-categorization-models.html#cb623-53" tabindex="-1"></a><span class="st">    vector&lt;lower=0,upper=2&gt;[nsubjects] c = inv_logit(logit_c)*2;  // times 2 as c is bounded between 0 and 2</span></span>
<span id="cb623-54"><a href="introduction-to-categorization-models.html#cb623-54" tabindex="-1"></a></span>
<span id="cb623-55"><a href="introduction-to-categorization-models.html#cb623-55" tabindex="-1"></a><span class="st">    // parameter r (probability of response = category 1)</span></span>
<span id="cb623-56"><a href="introduction-to-categorization-models.html#cb623-56" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] real&lt;lower=0.0001, upper=0.9999&gt; r;</span></span>
<span id="cb623-57"><a href="introduction-to-categorization-models.html#cb623-57" tabindex="-1"></a><span class="st">    array[ntrials, nsubjects] real rr;</span></span>
<span id="cb623-58"><a href="introduction-to-categorization-models.html#cb623-58" tabindex="-1"></a></span>
<span id="cb623-59"><a href="introduction-to-categorization-models.html#cb623-59" tabindex="-1"></a><span class="st">    for (sub in 1:nsubjects) {</span></span>
<span id="cb623-60"><a href="introduction-to-categorization-models.html#cb623-60" tabindex="-1"></a><span class="st">      for (trial in 1:ntrials) {</span></span>
<span id="cb623-61"><a href="introduction-to-categorization-models.html#cb623-61" tabindex="-1"></a></span>
<span id="cb623-62"><a href="introduction-to-categorization-models.html#cb623-62" tabindex="-1"></a><span class="st">        // calculate distance from obs to all exemplars</span></span>
<span id="cb623-63"><a href="introduction-to-categorization-models.html#cb623-63" tabindex="-1"></a><span class="st">        array[(trial-1)] real exemplar_sim;</span></span>
<span id="cb623-64"><a href="introduction-to-categorization-models.html#cb623-64" tabindex="-1"></a><span class="st">        for (e in 1:(trial-1)){</span></span>
<span id="cb623-65"><a href="introduction-to-categorization-models.html#cb623-65" tabindex="-1"></a><span class="st">            array[nfeatures] real tmp_dist;</span></span>
<span id="cb623-66"><a href="introduction-to-categorization-models.html#cb623-66" tabindex="-1"></a><span class="st">            for (feature in 1:nfeatures) {</span></span>
<span id="cb623-67"><a href="introduction-to-categorization-models.html#cb623-67" tabindex="-1"></a><span class="st">                tmp_dist[feature] = w_ind[sub,feature]*abs(obs[e,feature] - obs[trial,feature]);</span></span>
<span id="cb623-68"><a href="introduction-to-categorization-models.html#cb623-68" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb623-69"><a href="introduction-to-categorization-models.html#cb623-69" tabindex="-1"></a><span class="st">            exemplar_sim[e] = exp(-c[sub] * sum(tmp_dist));</span></span>
<span id="cb623-70"><a href="introduction-to-categorization-models.html#cb623-70" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb623-71"><a href="introduction-to-categorization-models.html#cb623-71" tabindex="-1"></a></span>
<span id="cb623-72"><a href="introduction-to-categorization-models.html#cb623-72" tabindex="-1"></a><span class="st">        if (sum(cat_one[:(trial-1)])==0 || sum(cat_two[:(trial-1)])==0){  // if there are no examplars in one of the categories</span></span>
<span id="cb623-73"><a href="introduction-to-categorization-models.html#cb623-73" tabindex="-1"></a><span class="st">            r[trial,sub] = 0.5;</span></span>
<span id="cb623-74"><a href="introduction-to-categorization-models.html#cb623-74" tabindex="-1"></a></span>
<span id="cb623-75"><a href="introduction-to-categorization-models.html#cb623-75" tabindex="-1"></a><span class="st">        } else {</span></span>
<span id="cb623-76"><a href="introduction-to-categorization-models.html#cb623-76" tabindex="-1"></a><span class="st">            // calculate similarity</span></span>
<span id="cb623-77"><a href="introduction-to-categorization-models.html#cb623-77" tabindex="-1"></a><span class="st">            array[2] real similarities;</span></span>
<span id="cb623-78"><a href="introduction-to-categorization-models.html#cb623-78" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb623-79"><a href="introduction-to-categorization-models.html#cb623-79" tabindex="-1"></a><span class="st">            array[sum(cat_one[:(trial-1)])] int tmp_idx_one = cat_one_idx[:sum(cat_one[:(trial-1)])];</span></span>
<span id="cb623-80"><a href="introduction-to-categorization-models.html#cb623-80" tabindex="-1"></a><span class="st">            array[sum(cat_two[:(trial-1)])] int tmp_idx_two = cat_two_idx[:sum(cat_two[:(trial-1)])];</span></span>
<span id="cb623-81"><a href="introduction-to-categorization-models.html#cb623-81" tabindex="-1"></a><span class="st">            similarities[1] = mean(exemplar_sim[tmp_idx_one]);</span></span>
<span id="cb623-82"><a href="introduction-to-categorization-models.html#cb623-82" tabindex="-1"></a><span class="st">            similarities[2] = mean(exemplar_sim[tmp_idx_two]);</span></span>
<span id="cb623-83"><a href="introduction-to-categorization-models.html#cb623-83" tabindex="-1"></a></span>
<span id="cb623-84"><a href="introduction-to-categorization-models.html#cb623-84" tabindex="-1"></a><span class="st">            // calculate r</span></span>
<span id="cb623-85"><a href="introduction-to-categorization-models.html#cb623-85" tabindex="-1"></a><span class="st">            rr[trial,sub] = (b*similarities[1]) / (b*similarities[1] + (1-b)*similarities[2]);</span></span>
<span id="cb623-86"><a href="introduction-to-categorization-models.html#cb623-86" tabindex="-1"></a></span>
<span id="cb623-87"><a href="introduction-to-categorization-models.html#cb623-87" tabindex="-1"></a><span class="st">            // to make the sampling work</span></span>
<span id="cb623-88"><a href="introduction-to-categorization-models.html#cb623-88" tabindex="-1"></a><span class="st">            if (rr[trial,sub] &gt; 0.9999){</span></span>
<span id="cb623-89"><a href="introduction-to-categorization-models.html#cb623-89" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.9999;</span></span>
<span id="cb623-90"><a href="introduction-to-categorization-models.html#cb623-90" tabindex="-1"></a><span class="st">            } else if (rr[trial,sub] &lt; 0.0001) {</span></span>
<span id="cb623-91"><a href="introduction-to-categorization-models.html#cb623-91" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.0001;</span></span>
<span id="cb623-92"><a href="introduction-to-categorization-models.html#cb623-92" tabindex="-1"></a><span class="st">            } else if (rr[trial,sub] &gt; 0.0001 &amp;&amp; rr[trial,sub] &lt; 0.9999) {</span></span>
<span id="cb623-93"><a href="introduction-to-categorization-models.html#cb623-93" tabindex="-1"></a><span class="st">                r[trial,sub] = rr[trial,sub];</span></span>
<span id="cb623-94"><a href="introduction-to-categorization-models.html#cb623-94" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb623-95"><a href="introduction-to-categorization-models.html#cb623-95" tabindex="-1"></a><span class="st">                r[trial,sub] = 0.5;</span></span>
<span id="cb623-96"><a href="introduction-to-categorization-models.html#cb623-96" tabindex="-1"></a><span class="st">            }}}}}</span></span>
<span id="cb623-97"><a href="introduction-to-categorization-models.html#cb623-97" tabindex="-1"></a></span>
<span id="cb623-98"><a href="introduction-to-categorization-models.html#cb623-98" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb623-99"><a href="introduction-to-categorization-models.html#cb623-99" tabindex="-1"></a><span class="st">    // Priors</span></span>
<span id="cb623-100"><a href="introduction-to-categorization-models.html#cb623-100" tabindex="-1"></a><span class="st">    target += exponential_lpdf(kappa | 0.1);</span></span>
<span id="cb623-101"><a href="introduction-to-categorization-models.html#cb623-101" tabindex="-1"></a><span class="st">    target += dirichlet_lpdf(weight | w_prior_values);</span></span>
<span id="cb623-102"><a href="introduction-to-categorization-models.html#cb623-102" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb623-103"><a href="introduction-to-categorization-models.html#cb623-103" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c_M | c_prior_values[1], c_prior_values[2]);</span></span>
<span id="cb623-104"><a href="introduction-to-categorization-models.html#cb623-104" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c_SD | 0, 1) - normal_lccdf(0 | 0, 1);</span></span>
<span id="cb623-105"><a href="introduction-to-categorization-models.html#cb623-105" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb623-106"><a href="introduction-to-categorization-models.html#cb623-106" tabindex="-1"></a><span class="st">    target += normal_lpdf(logit_c | logit_c_M, logit_c_SD);</span></span>
<span id="cb623-107"><a href="introduction-to-categorization-models.html#cb623-107" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb623-108"><a href="introduction-to-categorization-models.html#cb623-108" tabindex="-1"></a><span class="st">    // Decision Data</span></span>
<span id="cb623-109"><a href="introduction-to-categorization-models.html#cb623-109" tabindex="-1"></a><span class="st">    for (sub in 1:nsubjects){</span></span>
<span id="cb623-110"><a href="introduction-to-categorization-models.html#cb623-110" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb623-111"><a href="introduction-to-categorization-models.html#cb623-111" tabindex="-1"></a><span class="st">      target += dirichlet_lpdf(w_ind[sub] | alpha);</span></span>
<span id="cb623-112"><a href="introduction-to-categorization-models.html#cb623-112" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb623-113"><a href="introduction-to-categorization-models.html#cb623-113" tabindex="-1"></a><span class="st">      for (trial in 1:ntrials){</span></span>
<span id="cb623-114"><a href="introduction-to-categorization-models.html#cb623-114" tabindex="-1"></a><span class="st">        target += bernoulli_lpmf(y[trial,sub] | r[trial,sub]);</span></span>
<span id="cb623-115"><a href="introduction-to-categorization-models.html#cb623-115" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb623-116"><a href="introduction-to-categorization-models.html#cb623-116" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb623-117"><a href="introduction-to-categorization-models.html#cb623-117" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb623-118"><a href="introduction-to-categorization-models.html#cb623-118" tabindex="-1"></a></span>
<span id="cb623-119"><a href="introduction-to-categorization-models.html#cb623-119" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb623-120"><a href="introduction-to-categorization-models.html#cb623-120" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb623-121"><a href="introduction-to-categorization-models.html#cb623-121" tabindex="-1"></a>  gcm_ml_stan,</span>
<span id="cb623-122"><a href="introduction-to-categorization-models.html#cb623-122" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb623-123"><a href="introduction-to-categorization-models.html#cb623-123" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W11_gcm_ml.stan&quot;</span></span>
<span id="cb623-124"><a href="introduction-to-categorization-models.html#cb623-124" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W11_gcm_ml.stan&quot;</code></pre>
<p>Key features of this multilevel implementation include:</p>
<p>Population-Level Parameters:</p>
<ul>
<li><p>logit_c_M and logit_c_SD: The mean and standard deviation of the logit-transformed sensitivity parameter</p></li>
<li><p>weight: The population-level attention weight simplex</p></li>
<li><p>kappa: The concentration parameter controlling individual variation in attention weights</p></li>
</ul>
<p>Individual-Level Parameters:</p>
<ul>
<li><p>logit_c: Individual sensitivity parameters (logit-transformed)</p></li>
<li><p>w_ind: Individual attention weight simplices</p></li>
</ul>
<p>Hierarchical Structure:</p>
<ul>
<li><p>Individual sensitivity parameters are drawn from a population normal distribution</p></li>
<li><p>Individual attention weights are drawn from a population Dirichlet distribution</p></li>
<li><p>The Dirichlet concentration is controlled by the kappa parameter</p></li>
</ul>
<p>Parameter Transformations:</p>
<ul>
<li><p>alpha = kappa * weight: The concentration parameters for the Dirichlet distribution</p></li>
<li><p>c = inv_logit(logit_c)*2: Transformation from logit scale to the bounded [0,2] range</p></li>
</ul>
</div>
<div id="fitting-the-multilevel-gcm" class="section level3 hasAnchor" number="12.7.5">
<h3><span class="header-section-number">12.7.5</span> Fitting the Multilevel GCM<a href="introduction-to-categorization-models.html#fitting-the-multilevel-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To fit the multilevel model to our simulated data, we need to prepare the data in the correct format:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="introduction-to-categorization-models.html#cb625-1" tabindex="-1"></a><span class="do">## Fit the simulated data</span></span>
<span id="cb625-2"><a href="introduction-to-categorization-models.html#cb625-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d[,<span class="fu">c</span>(<span class="st">&quot;agent&quot;</span>,<span class="st">&quot;trial&quot;</span>,<span class="st">&quot;sim_response&quot;</span>)] <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb625-3"><a href="introduction-to-categorization-models.html#cb625-3" tabindex="-1"></a>  <span class="at">names_from =</span> agent,</span>
<span id="cb625-4"><a href="introduction-to-categorization-models.html#cb625-4" tabindex="-1"></a>  <span class="at">values_from =</span> <span class="fu">c</span>(sim_response))</span>
<span id="cb625-5"><a href="introduction-to-categorization-models.html#cb625-5" tabindex="-1"></a></span>
<span id="cb625-6"><a href="introduction-to-categorization-models.html#cb625-6" tabindex="-1"></a>gcm_ml_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb625-7"><a href="introduction-to-categorization-models.html#cb625-7" tabindex="-1"></a>  <span class="at">nsubjects =</span> agents,</span>
<span id="cb625-8"><a href="introduction-to-categorization-models.html#cb625-8" tabindex="-1"></a>  <span class="at">ntrials =</span> <span class="fu">nrow</span>(experiment),</span>
<span id="cb625-9"><a href="introduction-to-categorization-models.html#cb625-9" tabindex="-1"></a>  <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb625-10"><a href="introduction-to-categorization-models.html#cb625-10" tabindex="-1"></a>  <span class="at">cat_one =</span> experiment<span class="sc">$</span>category,</span>
<span id="cb625-11"><a href="introduction-to-categorization-models.html#cb625-11" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">as.matrix</span>(d1[, <span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)]),</span>
<span id="cb625-12"><a href="introduction-to-categorization-models.html#cb625-12" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb625-13"><a href="introduction-to-categorization-models.html#cb625-13" tabindex="-1"></a>  <span class="at">b =</span> <span class="fl">0.5</span>,</span>
<span id="cb625-14"><a href="introduction-to-categorization-models.html#cb625-14" tabindex="-1"></a>  <span class="at">w_prior_values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb625-15"><a href="introduction-to-categorization-models.html#cb625-15" tabindex="-1"></a>  <span class="at">c_prior_values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb625-16"><a href="introduction-to-categorization-models.html#cb625-16" tabindex="-1"></a>)</span>
<span id="cb625-17"><a href="introduction-to-categorization-models.html#cb625-17" tabindex="-1"></a></span>
<span id="cb625-18"><a href="introduction-to-categorization-models.html#cb625-18" tabindex="-1"></a><span class="co"># Check if we need to regenerate model fits</span></span>
<span id="cb625-19"><a href="introduction-to-categorization-models.html#cb625-19" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb625-20"><a href="introduction-to-categorization-models.html#cb625-20" tabindex="-1"></a>  <span class="co"># Compile Stan models</span></span>
<span id="cb625-21"><a href="introduction-to-categorization-models.html#cb625-21" tabindex="-1"></a>  mod_GCM_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb625-22"><a href="introduction-to-categorization-models.html#cb625-22" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="st">&quot;stan/W11_gcm_ml.stan&quot;</span>),</span>
<span id="cb625-23"><a href="introduction-to-categorization-models.html#cb625-23" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb625-24"><a href="introduction-to-categorization-models.html#cb625-24" tabindex="-1"></a>  )</span>
<span id="cb625-25"><a href="introduction-to-categorization-models.html#cb625-25" tabindex="-1"></a>  </span>
<span id="cb625-26"><a href="introduction-to-categorization-models.html#cb625-26" tabindex="-1"></a>  <span class="co"># Fit the multilevel model to all agents&#39; data</span></span>
<span id="cb625-27"><a href="introduction-to-categorization-models.html#cb625-27" tabindex="-1"></a>  samples_gcm_ml <span class="ot">&lt;-</span> mod_GCM_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb625-28"><a href="introduction-to-categorization-models.html#cb625-28" tabindex="-1"></a>  <span class="at">data =</span> gcm_ml_data,</span>
<span id="cb625-29"><a href="introduction-to-categorization-models.html#cb625-29" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb625-30"><a href="introduction-to-categorization-models.html#cb625-30" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb625-31"><a href="introduction-to-categorization-models.html#cb625-31" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb625-32"><a href="introduction-to-categorization-models.html#cb625-32" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb625-33"><a href="introduction-to-categorization-models.html#cb625-33" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb625-34"><a href="introduction-to-categorization-models.html#cb625-34" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb625-35"><a href="introduction-to-categorization-models.html#cb625-35" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">1000</span></span>
<span id="cb625-36"><a href="introduction-to-categorization-models.html#cb625-36" tabindex="-1"></a>)</span>
<span id="cb625-37"><a href="introduction-to-categorization-models.html#cb625-37" tabindex="-1"></a>  </span>
<span id="cb625-38"><a href="introduction-to-categorization-models.html#cb625-38" tabindex="-1"></a>  <span class="co"># Save model fits</span></span>
<span id="cb625-39"><a href="introduction-to-categorization-models.html#cb625-39" tabindex="-1"></a>  samples_gcm_ml<span class="sc">$</span><span class="fu">save_object</span>(<span class="st">&quot;simmodels/samples_gcm_ml.rds&quot;</span>)</span>
<span id="cb625-40"><a href="introduction-to-categorization-models.html#cb625-40" tabindex="-1"></a>  </span>
<span id="cb625-41"><a href="introduction-to-categorization-models.html#cb625-41" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Models fitted and saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb625-42"><a href="introduction-to-categorization-models.html#cb625-42" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb625-43"><a href="introduction-to-categorization-models.html#cb625-43" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb625-44"><a href="introduction-to-categorization-models.html#cb625-44" tabindex="-1"></a>  samples_gcm_ml <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;simmodels/samples_gcm_ml.rds&quot;</span>)</span>
<span id="cb625-45"><a href="introduction-to-categorization-models.html#cb625-45" tabindex="-1"></a>  </span>
<span id="cb625-46"><a href="introduction-to-categorization-models.html#cb625-46" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb625-47"><a href="introduction-to-categorization-models.html#cb625-47" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing model fits.</code></pre>
<p>After fitting, we can examine the posterior distributions of both population and individual parameters:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="introduction-to-categorization-models.html#cb627-1" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_gcm_ml)</span>
<span id="cb627-2"><a href="introduction-to-categorization-models.html#cb627-2" tabindex="-1"></a></span>
<span id="cb627-3"><a href="introduction-to-categorization-models.html#cb627-3" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, logit_c_M, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb627-4"><a href="introduction-to-categorization-models.html#cb627-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb627-5"><a href="introduction-to-categorization-models.html#cb627-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-71-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="introduction-to-categorization-models.html#cb628-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, logit_c_SD, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb628-2"><a href="introduction-to-categorization-models.html#cb628-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb628-3"><a href="introduction-to-categorization-models.html#cb628-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-71-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="introduction-to-categorization-models.html#cb629-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, <span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb629-2"><a href="introduction-to-categorization-models.html#cb629-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb629-3"><a href="introduction-to-categorization-models.html#cb629-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-71-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="introduction-to-categorization-models.html#cb630-1" tabindex="-1"></a><span class="fu">ggplot</span>(draws, <span class="fu">aes</span>(.iteration, kappa, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb630-2"><a href="introduction-to-categorization-models.html#cb630-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb630-3"><a href="introduction-to-categorization-models.html#cb630-3" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-71-4.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can also create visualizations showing the posterior distributions compared to the true parameter values:</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="introduction-to-categorization-models.html#cb631-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c_prior =</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(draws), <span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb631-2"><a href="introduction-to-categorization-models.html#cb631-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb631-3"><a href="introduction-to-categorization-models.html#cb631-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(logit_c_M), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb631-4"><a href="introduction-to-categorization-models.html#cb631-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb631-5"><a href="introduction-to-categorization-models.html#cb631-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">logit_scaled</span>(scalingM,<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb631-6"><a href="introduction-to-categorization-models.html#cb631-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-72-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="introduction-to-categorization-models.html#cb632-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">c_prior =</span> TruncatedNormal<span class="sc">::</span><span class="fu">rtnorm</span>(<span class="fu">nrow</span>(draws), <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lb =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb632-2"><a href="introduction-to-categorization-models.html#cb632-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb632-3"><a href="introduction-to-categorization-models.html#cb632-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(logit_c_SD), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb632-4"><a href="introduction-to-categorization-models.html#cb632-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(c_prior), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb632-5"><a href="introduction-to-categorization-models.html#cb632-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb632-6"><a href="introduction-to-categorization-models.html#cb632-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-72-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="introduction-to-categorization-models.html#cb633-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rdirichlet</span>(<span class="fu">nrow</span>(draws), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb633-2"><a href="introduction-to-categorization-models.html#cb633-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb633-3"><a href="introduction-to-categorization-models.html#cb633-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">weight[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb633-4"><a href="introduction-to-categorization-models.html#cb633-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">w_prior[1]</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb633-5"><a href="introduction-to-categorization-models.html#cb633-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb633-6"><a href="introduction-to-categorization-models.html#cb633-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-72-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="introduction-to-categorization-models.html#cb634-1" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">kappa_prior</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rexp</span>(<span class="fu">nrow</span>(draws), <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb634-2"><a href="introduction-to-categorization-models.html#cb634-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb634-3"><a href="introduction-to-categorization-models.html#cb634-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">kappa</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb634-4"><a href="introduction-to-categorization-models.html#cb634-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">kappa_prior</span><span class="st">`</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb634-5"><a href="introduction-to-categorization-models.html#cb634-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb634-6"><a href="introduction-to-categorization-models.html#cb634-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-72-4.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Parameter Recovery in the Multilevel GCM</p>
<p>As with the standard GCM, parameter recovery analysis is crucial for validating our multilevel implementation. Successful parameter recovery would demonstrate that our model can accurately estimate both individual and population parameters from observed categorization data.</p>
<p>For a comprehensive parameter recovery analysis, we would:</p>
<ul>
<li><p>Simulate data across a grid of population parameter values</p></li>
<li><p>Fit the multilevel GCM to each simulated dataset</p></li>
<li><p>Compare recovered parameters to the true generating values</p></li>
<li><p>Assess recovery of both population parameters and individual variability</p></li>
</ul>
<p>The recovery of each parameter type has different implications:</p>
<ul>
<li><p>Sensitivity (c): Successful recovery indicates we can accurately measure generalization gradients</p></li>
<li><p>Attention Weights (w): Successful recovery indicates we can measure how attention is allocated across dimensions</p></li>
<li><p>Concentration (kappa): Successful recovery indicates we can measure the degree of individual variation in attention allocation</p></li>
</ul>
</div>
</div>
<div id="gcm-in-context-strengths-and-limitations" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> GCM in Context: Strengths and Limitations<a href="introduction-to-categorization-models.html#gcm-in-context-strengths-and-limitations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Like all models, the GCM has both strengths and limitations as an account of human categorization:</p>
<div id="strengths" class="section level3 hasAnchor" number="12.8.1">
<h3><span class="header-section-number">12.8.1</span> Strengths<a href="introduction-to-categorization-models.html#strengths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Empirical Support: The GCM has successfully fit human categorization data across numerous experiments.</p></li>
<li><p>Psychological Plausibility: The model’s parameters correspond to psychologically meaningful constructs (attention, sensitivity).</p></li>
<li><p>Flexibility: The GCM can account for a wide range of category structures and learning phenomena.</p></li>
<li><p>Integration with Memory: The model naturally connects categorization to memory for specific instances.</p></li>
</ul>
</div>
<div id="limitations" class="section level3 hasAnchor" number="12.8.2">
<h3><span class="header-section-number">12.8.2</span> Limitations<a href="introduction-to-categorization-models.html#limitations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Memory Requirements: Storing all exemplars becomes computationally intensive for large datasets.</p></li>
<li><p>Complex Categories: The GCM can struggle with categories defined by complex rules or relations.</p></li>
<li><p>Prior Knowledge: The standard GCM doesn’t account for how prior knowledge affects categorization (unless we simulate previous exposure to exemplars).</p></li>
<li><p>Category Construction: The model focuses on categorization decisions rather than how categories are initially constructed.</p></li>
</ul>
<p>In the next sections, we’ll explore alternative approaches - prototype models and rule-based models - that address some of these limitations while introducing their own strengths and challenges.</p>
</div>
</div>
<div id="some-notes-about-student-produced-models-of-categorization" class="section level2 hasAnchor" number="12.9">
<h2><span class="header-section-number">12.9</span> Some notes about student-produced models of categorization<a href="introduction-to-categorization-models.html#some-notes-about-student-produced-models-of-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Attempting to identify features</p></li>
<li><p>Attempting to associate 1 of the features to one of the outcome dimensions (e.g. green as danger), test hypothesis, stay if positive, try different trait if negative. [missing details on how to define the hypothesized association, and how much evidence needed to shift]</p></li>
<li><p>Remembering the rule and/or remembering the single exemplars</p></li>
<li><p>Focusing on 1 feature 1 outcome vs trying to incorporate additional features</p></li>
<li><p>Using arbitrary associations btw features and outcomes vs. relying on intuition (raised arms are dangerous)</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-models-of-cognition.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prototype-based-models-of-categorization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/11-CategorizationModelsExemplars.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
