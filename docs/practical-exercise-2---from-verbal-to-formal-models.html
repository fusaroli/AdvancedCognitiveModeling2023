<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Practical exercise 2 - From verbal to formal models | 04-ModelQualityChecks</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Practical exercise 2 - From verbal to formal models | 04-ModelQualityChecks" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Practical exercise 2 - From verbal to formal models | 04-ModelQualityChecks" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2023" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2023-02-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"/>
<link rel="next" href="practical-exercise-3---getting-into-stan.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-goal-of-the-course"><i class="fa fa-check"></i><b>1.1</b> The goal of the course</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#list-of-lectures-and-practical-exercises"><i class="fa fa-check"></i><b>1.2</b> List of lectures and practical exercises</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation-before-the-course"><i class="fa fa-check"></i><b>1.3</b> Preparation before the course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Practical exercise 1 - Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a></li>
<li class="chapter" data-level="2.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#strategies"><i class="fa fa-check"></i><b>2.4</b> Strategies</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.4.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.4.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.4.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.4.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.4.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.4.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.4.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.4.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.4.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.4.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.4.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.5</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.5.1</b> Memory</a></li>
<li class="chapter" data-level="2.5.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.5.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.6</b> Continuity between models</a></li>
<li class="chapter" data-level="2.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.7</b> Mixture of strategies</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> Practical exercise 2 - From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.1</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.2" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.2</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.4" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.4</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.4.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#data"><i class="fa fa-check"></i><b>4.3.1</b> Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#model"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>4.3.3</b> Compiling and fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a></li>
<li class="chapter" data-level="4.6" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>4.6</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>4.6.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html"><i class="fa fa-check"></i><b>5</b> Practical exercise 4 - Model quality checks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>5.1</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="5.2" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-priors"><i class="fa fa-check"></i><b>5.2</b> Assessing priors</a></li>
<li class="chapter" data-level="5.3" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#assessing-prior-and-posterior-predictions"><i class="fa fa-check"></i><b>5.3</b> Assessing prior and posterior predictions</a></li>
<li class="chapter" data-level="5.4" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="5.5" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#the-memory-model"><i class="fa fa-check"></i><b>5.5</b> The memory model</a></li>
<li class="chapter" data-level="5.6" data-path="practical-exercise-4---model-quality-checks.html"><a href="practical-exercise-4---model-quality-checks.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>5.6</b> Prior sensitivity check for the memory model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">04-ModelQualityChecks</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practical-exercise-2---from-verbal-to-formal-models" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Practical exercise 2 - From verbal to formal models<a href="practical-exercise-2---from-verbal-to-formal-models.html#practical-exercise-2---from-verbal-to-formal-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The aim of this practical exercise is to go from verbal to formal models.
We will not just write a formula, we will implement these models as algorithms in R.
By implementing the models of algorithms,</p>
<ul>
<li><p>we are forced to make them very explicit in their assumptions;</p></li>
<li><p>we become able to simulate the models in a variety of different situations and therefore better understand their implications</p></li>
</ul>
<p>So, the steps for today’s exercise are:</p>
<ol style="list-style-type: decimal">
<li><p>choose two of the models and formalize them, that is, produce an algorithm that enacts the strategy, so we can simulate them.</p></li>
<li><p>implement the algorithms as functions: getting an input and producing an output, so we can more easily implement them across various contexts (e.g. varying amount of trials, input, etc). See R4DataScience, if you need a refresher: <a href="https://r4ds.had.co.nz/functions.html" class="uri">https://r4ds.had.co.nz/functions.html</a></p></li>
<li><p>implement a Random Bias agent (choosing “head” 70% of the times) and get your agents to play against it for 120 trials (and save the data)</p></li>
<li><p>implement a Win-Stay-Lose-Shift agent (keeping the same choice if it won, changing it if it lost) and do the same.</p></li>
<li><p>Now scale up the simulation: have 100 agents for each of your strategy playing against both Random Bias and Win-Stay-Lose-Shift and save their data.</p></li>
<li><p>Figure out a good way to visualize the data to assess which strategy performs better, whether that changes over time and generally explore what the agents are doing.</p></li>
</ol>
<div id="defining-general-conditions" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Defining general conditions<a href="practical-exercise-2---from-verbal-to-formal-models.html#defining-general-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb9-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, patchwork)</span>
<span id="cb9-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb9-3" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb9-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb9-4" aria-hidden="true" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span></span></code></pre></div>
</div>
<div id="implementing-a-random-agent" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Implementing a random agent<a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-random-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Remember a random agent is an agent that picks at random between “right” and “left” independently on what the opponent is doing.
A random agent might be perfectly random (50% chance of choosing “right”, same for “left”) or biased. The variable “rate” determines the rate of choosing “right”.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-1" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb10-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-3" aria-hidden="true" tabindex="-1"></a>RandomAgent <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="dv">1</span>, rate) <span class="co"># we simply sample randomly from a binomial</span></span>
<span id="cb10-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s plot how it&#39;s choosing</span></span>
<span id="cb10-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-6" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> RandomAgent)</span>
<span id="cb10-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> </span>
<span id="cb10-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb10-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb10-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb10-10" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/implementing%20random%20agent-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What if we were to compare it to an agent being biased?</span></span>
<span id="cb11-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-2" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb11-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-4" aria-hidden="true" tabindex="-1"></a>RandomAgent <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(trials, <span class="dv">1</span>, rate) <span class="co"># we simply sample randomly from a binomial</span></span>
<span id="cb11-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s plot how it&#39;s choosing</span></span>
<span id="cb11-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-7" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> RandomAgent)</span>
<span id="cb11-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> </span>
<span id="cb11-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb11-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb11-11"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb11-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/implementing%20random%20agent-2.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tricky to see, let&#39;s try writing the cumulative rate:</span></span>
<span id="cb12-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-3" aria-hidden="true" tabindex="-1"></a>d1<span class="sc">$</span>cumulativerate <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(d1<span class="sc">$</span>choice) <span class="sc">/</span> <span class="fu">seq_along</span>(d1<span class="sc">$</span>choice)</span>
<span id="cb12-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-4" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>cumulativerate <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(d2<span class="sc">$</span>choice) <span class="sc">/</span> <span class="fu">seq_along</span>(d2<span class="sc">$</span>choice)</span>
<span id="cb12-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-6" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(trial, cumulativerate)) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb12-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb12-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-11" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(trial, cumulativerate)) <span class="sc">+</span> </span>
<span id="cb12-12"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb12-13"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-14"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb12-15"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb12-16" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code></pre></div>
<p><img src="series_files/figure-html/implementing%20random%20agent-3.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now in the same plot</span></span>
<span id="cb13-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-2" aria-hidden="true" tabindex="-1"></a>d1<span class="sc">$</span>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb13-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-3" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>rate <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb13-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1,d2)</span>
<span id="cb13-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-6" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, cumulativerate, <span class="at">color =</span> rate, <span class="at">group =</span> rate)) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb13-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb13-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb13-10" aria-hidden="true" tabindex="-1"></a>p5</span></code></pre></div>
<p><img src="series_files/figure-html/implementing%20random%20agent-4.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now as a function</span></span>
<span id="cb14-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-2" aria-hidden="true" tabindex="-1"></a>RandomAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(input, rate){</span>
<span id="cb14-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(input)</span>
<span id="cb14-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, rate)</span>
<span id="cb14-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb14-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-8" aria-hidden="true" tabindex="-1"></a>input <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,trials) <span class="co"># it doesn&#39;t matter, it&#39;s not taken into account</span></span>
<span id="cb14-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-9" aria-hidden="true" tabindex="-1"></a>choice <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(input, rate)</span>
<span id="cb14-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-10" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), choice)</span>
<span id="cb14-11"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d3, <span class="fu">aes</span>(trial, choice)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/implementing%20random%20agent-5.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## What if there&#39;s noise?</span></span>
<span id="cb15-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb15-2" aria-hidden="true" tabindex="-1"></a>RandomAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(input, rate, noise){</span>
<span id="cb15-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(input)</span>
<span id="cb15-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, rate)</span>
<span id="cb15-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)}</span>
<span id="cb15-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb15-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb15-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="implementing-a-win-stay-lose-shift-agent" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Implementing a Win-Stay-Lose-Shift agent<a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as a function</span></span>
<span id="cb16-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-2" aria-hidden="true" tabindex="-1"></a>WSLSAgent_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, Feedback){</span>
<span id="cb16-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb16-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-4" aria-hidden="true" tabindex="-1"></a>    choice <span class="ot">=</span> prevChoice</span>
<span id="cb16-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb16-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-6" aria-hidden="true" tabindex="-1"></a>      choice <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> prevChoice</span>
<span id="cb16-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-7" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb16-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-12" aria-hidden="true" tabindex="-1"></a>WSLSAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(prevChoice, Feedback, noise){</span>
<span id="cb16-13"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb16-14"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-14" aria-hidden="true" tabindex="-1"></a>    choice <span class="ot">=</span> prevChoice</span>
<span id="cb16-15"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Feedback <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb16-16"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-16" aria-hidden="true" tabindex="-1"></a>      choice <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> prevChoice</span>
<span id="cb16-17"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-18"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">5</span>)}</span>
<span id="cb16-19"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb16-20"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-21"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-22" aria-hidden="true" tabindex="-1"></a>WSLSAgent <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb16-23"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Against a random agent</span></span>
<span id="cb16-26"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-27" aria-hidden="true" tabindex="-1"></a>Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb16-28"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-28" aria-hidden="true" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb16-29"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-30" aria-hidden="true" tabindex="-1"></a>Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb16-31"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-31" aria-hidden="true" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="fu">seq</span>(trials), rate)</span>
<span id="cb16-32"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-33"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb16-35"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb16-36"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-36" aria-hidden="true" tabindex="-1"></a>    Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb16-37"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-37" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb16-38"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-38" aria-hidden="true" tabindex="-1"></a>  Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb16-39"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-40"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-41"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Self <span class="sc">==</span> Other)</span></code></pre></div>
<pre><code>## [1] 79</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other))</span>
<span id="cb18-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Self)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, Other))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb19-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Feedback)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, <span class="dv">1</span> <span class="sc">-</span> Feedback))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb20-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateSelf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb20-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb20-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateOther <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb20-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateSelf)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateOther))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Against a Win-Stay-Lose Shift</span></span>
<span id="cb21-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-2" aria-hidden="true" tabindex="-1"></a>Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb21-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-3" aria-hidden="true" tabindex="-1"></a>Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb21-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-5" aria-hidden="true" tabindex="-1"></a>Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb21-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-6" aria-hidden="true" tabindex="-1"></a>Other[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb21-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb21-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb21-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-10" aria-hidden="true" tabindex="-1"></a>    Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb21-11"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb21-12"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-12" aria-hidden="true" tabindex="-1"></a>  Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb21-13"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-13" aria-hidden="true" tabindex="-1"></a>  Other[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Other[i <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> Feedback)</span>
<span id="cb21-14"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-15"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Self <span class="sc">==</span> Other)</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other))</span>
<span id="cb23-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Self)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, Other))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-1-4.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb24-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, Feedback)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, <span class="dv">1</span> <span class="sc">-</span> Feedback))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-1-5.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb25-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateSelf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb25-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb25-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>cumulativerateOther <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>Feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(df<span class="sc">$</span>Feedback)</span>
<span id="cb25-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateSelf)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="fu">aes</span>(trial, cumulativerateOther))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-1-6.png" width="672" /></p>
</div>
<div id="now-we-scale-it-up" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Now we scale it up<a href="practical-exercise-2---from-verbal-to-formal-models.html#now-we-scale-it-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-1" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">=</span> <span class="dv">120</span></span>
<span id="cb26-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-2" aria-hidden="true" tabindex="-1"></a>agents <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb26-3"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># WSLS vs agents with varying rates</span></span>
<span id="cb26-5"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (rate <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.5</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.05</span>)) {</span>
<span id="cb26-7"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-8"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (agent <span class="cf">in</span> <span class="fu">seq</span>(agents)) {</span>
<span id="cb26-9"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-9" aria-hidden="true" tabindex="-1"></a>    Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-10"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-10" aria-hidden="true" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-11"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-12"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-12" aria-hidden="true" tabindex="-1"></a>    Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb26-13"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-13" aria-hidden="true" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="fu">seq</span>(trials), rate)</span>
<span id="cb26-14"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-15"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-16"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb26-17"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb26-18"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-18" aria-hidden="true" tabindex="-1"></a>        Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-19"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-19" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb26-20"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-20" aria-hidden="true" tabindex="-1"></a>      Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb26-21"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-22"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-23"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-23" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other), agent, rate)</span>
<span id="cb26-24"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-25"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (agent <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> rate <span class="sc">==</span> <span class="fl">0.5</span>) {df <span class="ot">&lt;-</span> temp} <span class="cf">else</span> {df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, temp)}</span>
<span id="cb26-26"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-27"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-28"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="do">## WSLS with another WSLS</span></span>
<span id="cb26-30"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (agent <span class="cf">in</span> <span class="fu">seq</span>(agents)) {</span>
<span id="cb26-32"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-32" aria-hidden="true" tabindex="-1"></a>    Self <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-33"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-33" aria-hidden="true" tabindex="-1"></a>    Other <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb26-34"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-35"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-35" aria-hidden="true" tabindex="-1"></a>    Self[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb26-36"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-36" aria-hidden="true" tabindex="-1"></a>    Other[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RandomAgent_f</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb26-37"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-38"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-39"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>trials) {</span>
<span id="cb26-40"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (Self[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">==</span> Other[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb26-41"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-41" aria-hidden="true" tabindex="-1"></a>        Feedback <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-42"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-42" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {Feedback <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb26-43"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-43" aria-hidden="true" tabindex="-1"></a>      Self[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Self[i <span class="sc">-</span> <span class="dv">1</span>], Feedback)</span>
<span id="cb26-44"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-44" aria-hidden="true" tabindex="-1"></a>      Other[i] <span class="ot">&lt;-</span> <span class="fu">WSLSAgent_f</span>(Other[i <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> Feedback)</span>
<span id="cb26-45"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-46"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-47"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-47" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Self, Other, <span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">Feedback =</span> <span class="fu">as.numeric</span>(Self <span class="sc">==</span> Other), agent, rate)</span>
<span id="cb26-48"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-49"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (agent <span class="sc">==</span> <span class="dv">1</span> ) {df1 <span class="ot">&lt;-</span> temp} <span class="cf">else</span> {df1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df1, temp)}</span>
<span id="cb26-50"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb26-50" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div id="and-we-visualize-it" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> And we visualize it<a href="practical-exercise-2---from-verbal-to-formal-models.html#and-we-visualize-it" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(trial, Feedback, <span class="at">group =</span> rate, <span class="at">color =</span> rate)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="practical-exercise-2---from-verbal-to-formal-models.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We can see that the bigger the bias in the random agent, the bigger the performance in the WSLS (the higher the chances the random agent picks the same hand more than once in a row).</p>
<p>Now it’s your turn to follow a similar process for your 2 chosen strategies.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practical-exercise-3---getting-into-stan.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/02-BuildingFormalModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
