<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Practical exercise 3 - Getting into Stan | Advanced Cognitive Modeling Notes</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Practical exercise 3 - Getting into Stan | Advanced Cognitive Modeling Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2023" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Practical exercise 3 - Getting into Stan | Advanced Cognitive Modeling Notes" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2023" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2023-02-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="practical-exercise-2---from-verbal-to-formal-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-goal-of-the-course"><i class="fa fa-check"></i><b>1.1</b> The goal of the course</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#list-of-lectures-and-practical-exercises"><i class="fa fa-check"></i><b>1.2</b> List of lectures and practical exercises</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation-before-the-course"><i class="fa fa-check"></i><b>1.3</b> Preparation before the course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><i class="fa fa-check"></i><b>2</b> Practical exercise 1 - Building verbal models of the matching pennies game</a>
<ul>
<li class="chapter" data-level="2.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#trying-out-the-game-and-collecting-your-own-data"><i class="fa fa-check"></i><b>2.1</b> Trying out the game and collecting your own data</a></li>
<li class="chapter" data-level="2.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#start-theorizing"><i class="fa fa-check"></i><b>2.2</b> Start Theorizing</a></li>
<li class="chapter" data-level="2.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>2.3</b> The distinction between participant and researcher perspectives</a></li>
<li class="chapter" data-level="2.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#strategies"><i class="fa fa-check"></i><b>2.4</b> Strategies</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#random-strategies"><i class="fa fa-check"></i><b>2.4.1</b> Random strategies</a></li>
<li class="chapter" data-level="2.4.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#immediate-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Immediate reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>2.4.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="2.4.4" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>2.4.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="2.4.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#reinforcement-learning"><i class="fa fa-check"></i><b>2.4.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="2.4.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#k-tom"><i class="fa fa-check"></i><b>2.4.6</b> k-ToM</a></li>
<li class="chapter" data-level="2.4.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#other-possible-strategies"><i class="fa fa-check"></i><b>2.4.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#cognitive-constraints"><i class="fa fa-check"></i><b>2.5</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#memory"><i class="fa fa-check"></i><b>2.5.1</b> Memory</a></li>
<li class="chapter" data-level="2.5.2" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#errors"><i class="fa fa-check"></i><b>2.5.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#continuity-between-models"><i class="fa fa-check"></i><b>2.6</b> Continuity between models</a></li>
<li class="chapter" data-level="2.7" data-path="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html"><a href="practical-exercise-1---building-verbal-models-of-the-matching-pennies-game.html#mixture-of-strategies"><i class="fa fa-check"></i><b>2.7</b> Mixture of strategies</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html"><i class="fa fa-check"></i><b>3</b> Practical exercise 2 - From verbal to formal models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>3.1</b> Defining general conditions</a></li>
<li class="chapter" data-level="3.2" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>3.2</b> Implementing a random agent</a></li>
<li class="chapter" data-level="3.3" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>3.3</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="3.4" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>3.4</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="practical-exercise-2---from-verbal-to-formal-models.html"><a href="practical-exercise-2---from-verbal-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>3.4.1</b> And we visualize it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html"><i class="fa fa-check"></i><b>4</b> Practical exercise 3 - Getting into Stan</a>
<ul>
<li class="chapter" data-level="4.1" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#simulating-data"><i class="fa fa-check"></i><b>4.2</b> Simulating data</a></li>
<li class="chapter" data-level="4.3" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>4.3</b> Building our basic model in Stan</a></li>
<li class="chapter" data-level="4.4" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#parameter-recovery"><i class="fa fa-check"></i><b>4.4</b> Parameter recovery</a></li>
<li class="chapter" data-level="4.5" data-path="practical-exercise-3---getting-into-stan.html"><a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>4.5</b> The memory model: conditioning theta</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Cognitive Modeling Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practical-exercise-3---getting-into-stan" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Practical exercise 3 - Getting into Stan<a href="practical-exercise-3---getting-into-stan.html#practical-exercise-3---getting-into-stan" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Overview<a href="practical-exercise-3---getting-into-stan.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The goal of the practical exercise is to build on the simulated data from Practical Exercise 2 to construct our Stan models of the generative processes of the data. Here we know the truth: we simulated the data ourselves, so we can assess how accurate the model is in reconstructing, e.g. the bias of the agents.</p>
</div>
<div id="simulating-data" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Simulating data<a href="practical-exercise-3---getting-into-stan.html#simulating-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we build a new simulation of random agents with bias and noise. The code and visualization is really nothing different from last week’s exercise.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="practical-exercise-3---getting-into-stan.html#cb29-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,</span>
<span id="cb29-2"><a href="practical-exercise-3---getting-into-stan.html#cb29-2" aria-hidden="true" tabindex="-1"></a>        here,</span>
<span id="cb29-3"><a href="practical-exercise-3---getting-into-stan.html#cb29-3" aria-hidden="true" tabindex="-1"></a>        posterior,</span>
<span id="cb29-4"><a href="practical-exercise-3---getting-into-stan.html#cb29-4" aria-hidden="true" tabindex="-1"></a>        cmdstanr,</span>
<span id="cb29-5"><a href="practical-exercise-3---getting-into-stan.html#cb29-5" aria-hidden="true" tabindex="-1"></a>        brms, tidybayes)</span>
<span id="cb29-6"><a href="practical-exercise-3---getting-into-stan.html#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="practical-exercise-3---getting-into-stan.html#cb29-7" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb29-8"><a href="practical-exercise-3---getting-into-stan.html#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="practical-exercise-3---getting-into-stan.html#cb29-9" aria-hidden="true" tabindex="-1"></a>RandomAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(rate, noise) {</span>
<span id="cb29-10"><a href="practical-exercise-3---getting-into-stan.html#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="practical-exercise-3---getting-into-stan.html#cb29-11" aria-hidden="true" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, rate) <span class="co"># generating noiseless choices</span></span>
<span id="cb29-12"><a href="practical-exercise-3---getting-into-stan.html#cb29-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-13"><a href="practical-exercise-3---getting-into-stan.html#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb29-14"><a href="practical-exercise-3---getting-into-stan.html#cb29-14" aria-hidden="true" tabindex="-1"></a>    choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>) <span class="co"># introducing noise</span></span>
<span id="cb29-15"><a href="practical-exercise-3---getting-into-stan.html#cb29-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-16"><a href="practical-exercise-3---getting-into-stan.html#cb29-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-17"><a href="practical-exercise-3---getting-into-stan.html#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb29-18"><a href="practical-exercise-3---getting-into-stan.html#cb29-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-19"><a href="practical-exercise-3---getting-into-stan.html#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="practical-exercise-3---getting-into-stan.html#cb29-20" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb29-21"><a href="practical-exercise-3---getting-into-stan.html#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (noise <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>)) { <span class="co"># looping through noise levels</span></span>
<span id="cb29-22"><a href="practical-exercise-3---getting-into-stan.html#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="practical-exercise-3---getting-into-stan.html#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (rate <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) { <span class="co"># looping through rate levels</span></span>
<span id="cb29-24"><a href="practical-exercise-3---getting-into-stan.html#cb29-24" aria-hidden="true" tabindex="-1"></a>    randomChoice <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)</span>
<span id="cb29-25"><a href="practical-exercise-3---getting-into-stan.html#cb29-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-26"><a href="practical-exercise-3---getting-into-stan.html#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="fu">seq</span>(trials)) { <span class="co"># looping through trials (to make it homologous to more reactive models)</span></span>
<span id="cb29-27"><a href="practical-exercise-3---getting-into-stan.html#cb29-27" aria-hidden="true" tabindex="-1"></a>      randomChoice[t] <span class="ot">&lt;-</span> <span class="fu">RandomAgentNoise_f</span>(rate, noise)</span>
<span id="cb29-28"><a href="practical-exercise-3---getting-into-stan.html#cb29-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-29"><a href="practical-exercise-3---getting-into-stan.html#cb29-29" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> randomChoice, rate, noise)</span>
<span id="cb29-30"><a href="practical-exercise-3---getting-into-stan.html#cb29-30" aria-hidden="true" tabindex="-1"></a>    temp<span class="sc">$</span>cumulativerate <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(temp<span class="sc">$</span>choice) <span class="sc">/</span> <span class="fu">seq_along</span>(temp<span class="sc">$</span>choice)</span>
<span id="cb29-31"><a href="practical-exercise-3---getting-into-stan.html#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="practical-exercise-3---getting-into-stan.html#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;d&quot;</span>)) {</span>
<span id="cb29-33"><a href="practical-exercise-3---getting-into-stan.html#cb29-33" aria-hidden="true" tabindex="-1"></a>      d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d, temp)</span>
<span id="cb29-34"><a href="practical-exercise-3---getting-into-stan.html#cb29-34" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb29-35"><a href="practical-exercise-3---getting-into-stan.html#cb29-35" aria-hidden="true" tabindex="-1"></a>      d <span class="ot">&lt;-</span> temp</span>
<span id="cb29-36"><a href="practical-exercise-3---getting-into-stan.html#cb29-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-37"><a href="practical-exercise-3---getting-into-stan.html#cb29-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-38"><a href="practical-exercise-3---getting-into-stan.html#cb29-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-39"><a href="practical-exercise-3---getting-into-stan.html#cb29-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-40"><a href="practical-exercise-3---getting-into-stan.html#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(d, <span class="st">&quot;simdata/W3_randomnoise.csv&quot;</span>)</span>
<span id="cb29-41"><a href="practical-exercise-3---getting-into-stan.html#cb29-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="practical-exercise-3---getting-into-stan.html#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we visualize it </span></span>
<span id="cb29-43"><a href="practical-exercise-3---getting-into-stan.html#cb29-43" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, cumulativerate, <span class="at">group =</span> rate, <span class="at">color =</span> rate)) <span class="sc">+</span> </span>
<span id="cb29-44"><a href="practical-exercise-3---getting-into-stan.html#cb29-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb29-45"><a href="practical-exercise-3---getting-into-stan.html#cb29-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb29-46"><a href="practical-exercise-3---getting-into-stan.html#cb29-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb29-47"><a href="practical-exercise-3---getting-into-stan.html#cb29-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>noise) <span class="sc">+</span> </span>
<span id="cb29-48"><a href="practical-exercise-3---getting-into-stan.html#cb29-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb29-49"><a href="practical-exercise-3---getting-into-stan.html#cb29-49" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="building-our-basic-model-in-stan" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Building our basic model in Stan<a href="practical-exercise-3---getting-into-stan.html#building-our-basic-model-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>N.B. Refer to the video and slides for the step by step build-up of the Stan code.</p>
<p>Now we subset to a simple case, no noise and rate of 0.8, to focus on the Stan model.
We make it into the right format for Stan, build the Stan model, and fit it.</p>
<p>[MISSING: more step by step explanation and predictive checks]</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="practical-exercise-3---getting-into-stan.html#cb30-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">subset</span>(noise <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> rate <span class="sc">==</span> <span class="fl">0.8</span>)</span>
<span id="cb30-2"><a href="practical-exercise-3---getting-into-stan.html#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="practical-exercise-3---getting-into-stan.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the data</span></span>
<span id="cb30-4"><a href="practical-exercise-3---getting-into-stan.html#cb30-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb30-5"><a href="practical-exercise-3---getting-into-stan.html#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">120</span>,</span>
<span id="cb30-6"><a href="practical-exercise-3---getting-into-stan.html#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> d1<span class="sc">$</span>choice</span>
<span id="cb30-7"><a href="practical-exercise-3---getting-into-stan.html#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="practical-exercise-3---getting-into-stan.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="practical-exercise-3---getting-into-stan.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Specify where the model is</span></span>
<span id="cb30-10"><a href="practical-exercise-3---getting-into-stan.html#cb30-10" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W3_SimpleBernoulli.stan&quot;</span>)</span>
<span id="cb30-11"><a href="practical-exercise-3---getting-into-stan.html#cb30-11" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, </span>
<span id="cb30-12"><a href="practical-exercise-3---getting-into-stan.html#cb30-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-13"><a href="practical-exercise-3---getting-into-stan.html#cb30-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span></code></pre></div>
<pre><code>## Model executable is up to date!</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="practical-exercise-3---getting-into-stan.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb32-2"><a href="practical-exercise-3---getting-into-stan.html#cb32-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb32-3"><a href="practical-exercise-3---getting-into-stan.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb32-4"><a href="practical-exercise-3---getting-into-stan.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb32-5"><a href="practical-exercise-3---getting-into-stan.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb32-6"><a href="practical-exercise-3---getting-into-stan.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb32-7"><a href="practical-exercise-3---getting-into-stan.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb32-8"><a href="practical-exercise-3---getting-into-stan.html#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb32-9"><a href="practical-exercise-3---getting-into-stan.html#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb32-10"><a href="practical-exercise-3---getting-into-stan.html#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb32-11"><a href="practical-exercise-3---getting-into-stan.html#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb32-12"><a href="practical-exercise-3---getting-into-stan.html#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb32-13"><a href="practical-exercise-3---getting-into-stan.html#cb32-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 2 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 2 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 2 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 2 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 2 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 2 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 2 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Chain 2 finished in 0.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.0 seconds.
## Total execution time: 0.1 seconds.</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="practical-exercise-3---getting-into-stan.html#cb34-1" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">summary</span>() </span></code></pre></div>
<pre><code>## # A tibble: 2 × 10
##   variable    mean  median     sd    mad      q5     q95  rhat ess_bulk ess_tail
##   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 lp__     -59.6   -59.3   0.710  0.342  -61.1   -59.1    1.00    1165.     928.
## 2 theta      0.813   0.814 0.0356 0.0361   0.754   0.871  1.00     865.     677.</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="practical-exercise-3---getting-into-stan.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior samples and include sampling of the prior:</span></span>
<span id="cb36-2"><a href="practical-exercise-3---getting-into-stan.html#cb36-2" aria-hidden="true" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb36-3"><a href="practical-exercise-3---getting-into-stan.html#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="practical-exercise-3---getting-into-stan.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking the model&#39;s chains</span></span>
<span id="cb36-5"><a href="practical-exercise-3---getting-into-stan.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, theta, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb36-6"><a href="practical-exercise-3---getting-into-stan.html#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb36-7"><a href="practical-exercise-3---getting-into-stan.html#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="practical-exercise-3---getting-into-stan.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a prior for theta (ugly, but we&#39;ll do better soon)</span></span>
<span id="cb37-2"><a href="practical-exercise-3---getting-into-stan.html#cb37-2" aria-hidden="true" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> draws_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb37-3"><a href="practical-exercise-3---getting-into-stan.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta_prior =</span> <span class="fu">rbeta</span>(<span class="fu">nrow</span>(draws_df), <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb37-4"><a href="practical-exercise-3---getting-into-stan.html#cb37-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-5"><a href="practical-exercise-3---getting-into-stan.html#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="practical-exercise-3---getting-into-stan.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s plot the density for theta (prior and posterior)</span></span>
<span id="cb37-7"><a href="practical-exercise-3---getting-into-stan.html#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb37-8"><a href="practical-exercise-3---getting-into-stan.html#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb37-9"><a href="practical-exercise-3---getting-into-stan.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb37-10"><a href="practical-exercise-3---getting-into-stan.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb37-11"><a href="practical-exercise-3---getting-into-stan.html#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="practical-exercise-3---getting-into-stan.html#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-13"><a href="practical-exercise-3---getting-into-stan.html#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<p>As we can see from the posterior estimates and the prior posterior update check, our model is doing a decent job. It doesn’t exactly reconstruct the rate of 0.8, but 0.755 is pretty close and 0.8 is included within the credible interval.</p>
<p>Now we build the same model, but using the log odds scale for the theta parameter, which will become useful later when we condition theta on variables and build multilevel models (as we can do what we want in a log odds space and it will always be bound between 0 and 1).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="practical-exercise-3---getting-into-stan.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## With the logit format</span></span>
<span id="cb38-2"><a href="practical-exercise-3---getting-into-stan.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Specify where the model is</span></span>
<span id="cb38-3"><a href="practical-exercise-3---getting-into-stan.html#cb38-3" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W3_SimpleBernoulli_logodds.stan&quot;</span>)</span>
<span id="cb38-4"><a href="practical-exercise-3---getting-into-stan.html#cb38-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, </span>
<span id="cb38-5"><a href="practical-exercise-3---getting-into-stan.html#cb38-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-6"><a href="practical-exercise-3---getting-into-stan.html#cb38-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>))</span></code></pre></div>
<pre><code>## Model executable is up to date!</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="practical-exercise-3---getting-into-stan.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb40-2"><a href="practical-exercise-3---getting-into-stan.html#cb40-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb40-3"><a href="practical-exercise-3---getting-into-stan.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb40-4"><a href="practical-exercise-3---getting-into-stan.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb40-5"><a href="practical-exercise-3---getting-into-stan.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb40-6"><a href="practical-exercise-3---getting-into-stan.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb40-7"><a href="practical-exercise-3---getting-into-stan.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb40-8"><a href="practical-exercise-3---getting-into-stan.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb40-9"><a href="practical-exercise-3---getting-into-stan.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb40-10"><a href="practical-exercise-3---getting-into-stan.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb40-11"><a href="practical-exercise-3---getting-into-stan.html#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb40-12"><a href="practical-exercise-3---getting-into-stan.html#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb40-13"><a href="practical-exercise-3---getting-into-stan.html#cb40-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 2 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 2 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 2 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 2 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 2 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 2 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 2 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Chain 2 finished in 0.0 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.0 seconds.
## Total execution time: 0.1 seconds.</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="practical-exercise-3---getting-into-stan.html#cb42-1" aria-hidden="true" tabindex="-1"></a>samples</span></code></pre></div>
<pre><code>##         variable   mean median    sd   mad     q5    q95 rhat ess_bulk ess_tail
##  lp__            -59.64 -59.36  0.74  0.29 -61.01 -59.15 1.00     1466     1139
##  theta             1.44   1.43  0.22  0.22   1.08   1.81 1.00      884     1087
##  theta_prior       0.50   0.50  0.21  0.24   0.16   0.84 1.00     4053     3521
##  theta_posterior   0.81   0.81  0.03  0.03   0.75   0.86 1.00      884     1087
##  prior_preds      59.76  60.00 25.35 29.65  18.00 101.00 1.00     4043     4051
##  posterior_preds  96.63  97.00  5.98  5.93  86.00 106.00 1.00     1572     2272</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="practical-exercise-3---getting-into-stan.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics</span></span>
<span id="cb44-2"><a href="practical-exercise-3---getting-into-stan.html#cb44-2" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">cmdstan_diagnose</span>()</span></code></pre></div>
<pre><code>## Processing csv files: /var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpCa0Wqb/W3_SimpleBernoulli_logodds-202302192226-1-7ad523.csv, /var/folders/lt/zspkqnxd5yg92kybm5f433_cfjr0d6/T/RtmpCa0Wqb/W3_SimpleBernoulli_logodds-202302192226-2-7ad523.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="practical-exercise-3---getting-into-stan.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior samples and include sampling of the prior:</span></span>
<span id="cb46-2"><a href="practical-exercise-3---getting-into-stan.html#cb46-2" aria-hidden="true" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb46-3"><a href="practical-exercise-3---getting-into-stan.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="practical-exercise-3---getting-into-stan.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df, <span class="fu">aes</span>(.iteration, theta, <span class="at">group =</span> .chain, <span class="at">color =</span> .chain)) <span class="sc">+</span></span>
<span id="cb46-5"><a href="practical-exercise-3---getting-into-stan.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb46-6"><a href="practical-exercise-3---getting-into-stan.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="practical-exercise-3---getting-into-stan.html#cb47-1" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">summary</span>() </span></code></pre></div>
<pre><code>## # A tibble: 6 × 10
##   variable           mean  median      sd     mad      q5     q95  rhat ess_bulk ess_tail
##   &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 lp__            -59.6   -59.4    0.736   0.294  -61.0   -59.1    1.00    1467.    1139.
## 2 theta             1.44    1.43   0.224   0.219    1.08    1.81   1.00     884.    1088.
## 3 theta_prior       0.499   0.503  0.208   0.240    0.162   0.835  1.00    4053.    3522.
## 4 theta_posterior   0.805   0.807  0.0346  0.0340   0.746   0.859  1.00     884.    1088.
## 5 prior_preds      59.8    60     25.3    29.7     18     101      1.00    4044.    4052.
## 6 posterior_preds  96.6    97      5.98    5.93    86     106      1.00    1572.    2273.</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="practical-exercise-3---getting-into-stan.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior predictions</span></span>
<span id="cb49-2"><a href="practical-exercise-3---getting-into-stan.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb49-3"><a href="practical-exercise-3---getting-into-stan.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(prior_preds), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="practical-exercise-3---getting-into-stan.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted heads out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="practical-exercise-3---getting-into-stan.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="practical-exercise-3---getting-into-stan.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="practical-exercise-3---getting-into-stan.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s plot the density for theta (prior and posterior)</span></span>
<span id="cb51-2"><a href="practical-exercise-3---getting-into-stan.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb51-3"><a href="practical-exercise-3---getting-into-stan.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta_posterior), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="practical-exercise-3---getting-into-stan.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="practical-exercise-3---getting-into-stan.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-6"><a href="practical-exercise-3---getting-into-stan.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="practical-exercise-3---getting-into-stan.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="practical-exercise-3---getting-into-stan.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb52-2"><a href="practical-exercise-3---getting-into-stan.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(posterior_preds), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">bins =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb52-3"><a href="practical-exercise-3---getting-into-stan.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="fu">sum</span>(data<span class="sc">$</span>h), <span class="at">y =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="practical-exercise-3---getting-into-stan.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted heads out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="practical-exercise-3---getting-into-stan.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="practical-exercise-3---getting-into-stan.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="practical-exercise-3---getting-into-stan.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb53-2"><a href="practical-exercise-3---getting-into-stan.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(prior_preds), <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">bins =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="practical-exercise-3---getting-into-stan.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(posterior_preds), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">bins =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="practical-exercise-3---getting-into-stan.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="fu">sum</span>(data<span class="sc">$</span>h), <span class="at">y =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="practical-exercise-3---getting-into-stan.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted heads out of 120 trials&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-6"><a href="practical-exercise-3---getting-into-stan.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="practical-exercise-3---getting-into-stan.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-6-5.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="practical-exercise-3---getting-into-stan.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb54-2"><a href="practical-exercise-3---getting-into-stan.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta_posterior), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="practical-exercise-3---getting-into-stan.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(theta_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="practical-exercise-3---getting-into-stan.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="practical-exercise-3---getting-into-stan.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-6"><a href="practical-exercise-3---getting-into-stan.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="practical-exercise-3---getting-into-stan.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-6-6.png" width="672" /></p>
<p>We can see that the results are virtually identical, except for a slight shrinkage of the estimate from 0.755 to 0.75 (due to the prior being more conservative closer to 0 and 1).</p>
</div>
<div id="parameter-recovery" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Parameter recovery<a href="practical-exercise-3---getting-into-stan.html#parameter-recovery" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we see that the model works in one case, we can run it throughout all possible rate and noise levels in the simulation.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="practical-exercise-3---getting-into-stan.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we need to scale it up to all possible rates and noises</span></span>
<span id="cb55-2"><a href="practical-exercise-3---getting-into-stan.html#cb55-2" aria-hidden="true" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb55-3"><a href="practical-exercise-3---getting-into-stan.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="practical-exercise-3---getting-into-stan.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (noiseLvl <span class="cf">in</span> <span class="fu">unique</span>(d<span class="sc">$</span>noise)) {</span>
<span id="cb55-5"><a href="practical-exercise-3---getting-into-stan.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-6"><a href="practical-exercise-3---getting-into-stan.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (rateLvl <span class="cf">in</span> <span class="fu">unique</span>(d<span class="sc">$</span>rate)) {</span>
<span id="cb55-7"><a href="practical-exercise-3---getting-into-stan.html#cb55-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-8"><a href="practical-exercise-3---getting-into-stan.html#cb55-8" aria-hidden="true" tabindex="-1"></a>    dd <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb55-9"><a href="practical-exercise-3---getting-into-stan.html#cb55-9" aria-hidden="true" tabindex="-1"></a>      noise <span class="sc">==</span> noiseLvl  <span class="sc">&amp;</span> rate <span class="sc">==</span> rateLvl</span>
<span id="cb55-10"><a href="practical-exercise-3---getting-into-stan.html#cb55-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-11"><a href="practical-exercise-3---getting-into-stan.html#cb55-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-12"><a href="practical-exercise-3---getting-into-stan.html#cb55-12" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb55-13"><a href="practical-exercise-3---getting-into-stan.html#cb55-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">120</span>,</span>
<span id="cb55-14"><a href="practical-exercise-3---getting-into-stan.html#cb55-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">h =</span> dd<span class="sc">$</span>choice</span>
<span id="cb55-15"><a href="practical-exercise-3---getting-into-stan.html#cb55-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-16"><a href="practical-exercise-3---getting-into-stan.html#cb55-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-17"><a href="practical-exercise-3---getting-into-stan.html#cb55-17" aria-hidden="true" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb55-18"><a href="practical-exercise-3---getting-into-stan.html#cb55-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb55-19"><a href="practical-exercise-3---getting-into-stan.html#cb55-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb55-20"><a href="practical-exercise-3---getting-into-stan.html#cb55-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb55-21"><a href="practical-exercise-3---getting-into-stan.html#cb55-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb55-22"><a href="practical-exercise-3---getting-into-stan.html#cb55-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb55-23"><a href="practical-exercise-3---getting-into-stan.html#cb55-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb55-24"><a href="practical-exercise-3---getting-into-stan.html#cb55-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb55-25"><a href="practical-exercise-3---getting-into-stan.html#cb55-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb55-26"><a href="practical-exercise-3---getting-into-stan.html#cb55-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb55-27"><a href="practical-exercise-3---getting-into-stan.html#cb55-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb55-28"><a href="practical-exercise-3---getting-into-stan.html#cb55-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-29"><a href="practical-exercise-3---getting-into-stan.html#cb55-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-30"><a href="practical-exercise-3---getting-into-stan.html#cb55-30" aria-hidden="true" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb55-31"><a href="practical-exercise-3---getting-into-stan.html#cb55-31" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">biasEst =</span> draws_df<span class="sc">$</span>theta_posterior, <span class="at">biasTrue =</span> rateLvl, <span class="at">noise =</span> noiseLvl)</span>
<span id="cb55-32"><a href="practical-exercise-3---getting-into-stan.html#cb55-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-33"><a href="practical-exercise-3---getting-into-stan.html#cb55-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-34"><a href="practical-exercise-3---getting-into-stan.html#cb55-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;recovery_df&quot;</span>)) {recovery_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(recovery_df, temp)} <span class="cf">else</span> {recovery_df <span class="ot">&lt;-</span> temp}</span>
<span id="cb55-35"><a href="practical-exercise-3---getting-into-stan.html#cb55-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-36"><a href="practical-exercise-3---getting-into-stan.html#cb55-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-37"><a href="practical-exercise-3---getting-into-stan.html#cb55-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-38"><a href="practical-exercise-3---getting-into-stan.html#cb55-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="practical-exercise-3---getting-into-stan.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(recovery_df, <span class="st">&quot;simdata/W3_recoverydf_simple.csv&quot;</span>)</span>
<span id="cb57-2"><a href="practical-exercise-3---getting-into-stan.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="practical-exercise-3---getting-into-stan.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_df, <span class="fu">aes</span>(biasTrue, biasEst)) <span class="sc">+</span></span>
<span id="cb57-4"><a href="practical-exercise-3---getting-into-stan.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="practical-exercise-3---getting-into-stan.html#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb57-6"><a href="practical-exercise-3---getting-into-stan.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>noise) <span class="sc">+</span></span>
<span id="cb57-7"><a href="practical-exercise-3---getting-into-stan.html#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>There’s much to be said about the final plot, but for now let’s just say that it looks good. We can reconstruct in a nice ordered way true rate values. However, our ability to do so decreases with the increase in noise. So far no surprises. Wait, you say, shouldn’t we actually model the generative process, that is, include noise in the Stan model? Gold star, there! But let’s wait a bit before we get there, we’ll need mixture models.</p>
<p>One final note before moving to the memory model: what if we parallelized the parameter recovery, so that different models / datasets run on different cores? This was not necessary above (it ran in a few minutes anyway), but will become crucial with more complex models.</p>
<p>To parallelize, we rely on furrr, a neat R package that distributes parallel operations across cores.
First we need to define the function that will define the operations to be run on each core separately, here we simulate the data according to a seed, a n of trials, a rate and a noise, and then we fit the model to them.
Second, we need to create a tibble of the seeds, n of trials, rate and noise values that should be simulated.
Third, we use future_pmap_dfr to run the function on each row of the tibble above separately on a different core. Note that I set the system to split across 4 parallel cores (to work on my computer without clogging it). Do change it according to the system you are using. Note that if you have 40 “jobs” (rows of the tibble, sets of parameter values to run), using e.g. 32 cores will not speed things more than using 20.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="practical-exercise-3---getting-into-stan.html#cb59-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(future, purrr, furrr)</span>
<span id="cb59-2"><a href="practical-exercise-3---getting-into-stan.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">4</span>)</span>
<span id="cb59-3"><a href="practical-exercise-3---getting-into-stan.html#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="practical-exercise-3---getting-into-stan.html#cb59-4" aria-hidden="true" tabindex="-1"></a>sim_d_and_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(seed, trials, rateLvl, noiseLvl) {</span>
<span id="cb59-5"><a href="practical-exercise-3---getting-into-stan.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-6"><a href="practical-exercise-3---getting-into-stan.html#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="fu">seq</span>(trials)) { <span class="co"># looping through trials (to make it homologous to more reactive models)</span></span>
<span id="cb59-7"><a href="practical-exercise-3---getting-into-stan.html#cb59-7" aria-hidden="true" tabindex="-1"></a>      randomChoice[t] <span class="ot">&lt;-</span> <span class="fu">RandomAgentNoise_f</span>(rateLvl, noiseLvl)</span>
<span id="cb59-8"><a href="practical-exercise-3---getting-into-stan.html#cb59-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-9"><a href="practical-exercise-3---getting-into-stan.html#cb59-9" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">seq</span>(trials), <span class="at">choice =</span> randomChoice, rate, noise)</span>
<span id="cb59-10"><a href="practical-exercise-3---getting-into-stan.html#cb59-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-11"><a href="practical-exercise-3---getting-into-stan.html#cb59-11" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb59-12"><a href="practical-exercise-3---getting-into-stan.html#cb59-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">120</span>,</span>
<span id="cb59-13"><a href="practical-exercise-3---getting-into-stan.html#cb59-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">h =</span> temp<span class="sc">$</span>choice</span>
<span id="cb59-14"><a href="practical-exercise-3---getting-into-stan.html#cb59-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-15"><a href="practical-exercise-3---getting-into-stan.html#cb59-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-16"><a href="practical-exercise-3---getting-into-stan.html#cb59-16" aria-hidden="true" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb59-17"><a href="practical-exercise-3---getting-into-stan.html#cb59-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb59-18"><a href="practical-exercise-3---getting-into-stan.html#cb59-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1000</span>,</span>
<span id="cb59-19"><a href="practical-exercise-3---getting-into-stan.html#cb59-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb59-20"><a href="practical-exercise-3---getting-into-stan.html#cb59-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">1</span>,</span>
<span id="cb59-21"><a href="practical-exercise-3---getting-into-stan.html#cb59-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb59-22"><a href="practical-exercise-3---getting-into-stan.html#cb59-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb59-23"><a href="practical-exercise-3---getting-into-stan.html#cb59-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb59-24"><a href="practical-exercise-3---getting-into-stan.html#cb59-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb59-25"><a href="practical-exercise-3---getting-into-stan.html#cb59-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb59-26"><a href="practical-exercise-3---getting-into-stan.html#cb59-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb59-27"><a href="practical-exercise-3---getting-into-stan.html#cb59-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-28"><a href="practical-exercise-3---getting-into-stan.html#cb59-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-29"><a href="practical-exercise-3---getting-into-stan.html#cb59-29" aria-hidden="true" tabindex="-1"></a>    draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>()) </span>
<span id="cb59-30"><a href="practical-exercise-3---getting-into-stan.html#cb59-30" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">biasEst =</span> draws_df<span class="sc">$</span>theta_posterior, <span class="at">biasTrue =</span> rateLvl, <span class="at">noise =</span> noiseLvl)</span>
<span id="cb59-31"><a href="practical-exercise-3---getting-into-stan.html#cb59-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-32"><a href="practical-exercise-3---getting-into-stan.html#cb59-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(temp)</span>
<span id="cb59-33"><a href="practical-exercise-3---getting-into-stan.html#cb59-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-34"><a href="practical-exercise-3---getting-into-stan.html#cb59-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-35"><a href="practical-exercise-3---getting-into-stan.html#cb59-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-36"><a href="practical-exercise-3---getting-into-stan.html#cb59-36" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">unique</span>(d[,<span class="fu">c</span>(<span class="st">&quot;rate&quot;</span>, <span class="st">&quot;noise&quot;</span>)])) <span class="sc">%&gt;%</span> </span>
<span id="cb59-37"><a href="practical-exercise-3---getting-into-stan.html#cb59-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">seed =</span> <span class="dv">1000</span>, <span class="at">trials =</span> <span class="dv">120</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-38"><a href="practical-exercise-3---getting-into-stan.html#cb59-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rateLvl =</span> rate, <span class="at">noiseLvl =</span> noise)</span>
<span id="cb59-39"><a href="practical-exercise-3---getting-into-stan.html#cb59-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-40"><a href="practical-exercise-3---getting-into-stan.html#cb59-40" aria-hidden="true" tabindex="-1"></a>recovery_df <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(temp, sim_d_and_fit, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.
## Running MCMC with 1 chain, with 1 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 3000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 3000 [ 16%]  (Warmup) 
## Chain 1 Iteration: 1000 / 3000 [ 33%]  (Warmup) 
## Chain 1 Iteration: 1001 / 3000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 1500 / 3000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 2000 / 3000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 2500 / 3000 [ 83%]  (Sampling) 
## Chain 1 Iteration: 3000 / 3000 [100%]  (Sampling) 
## Chain 1 finished in 0.0 seconds.</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="practical-exercise-3---getting-into-stan.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_df, <span class="fu">aes</span>(biasTrue, biasEst)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="practical-exercise-3---getting-into-stan.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb61-3"><a href="practical-exercise-3---getting-into-stan.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb61-4"><a href="practical-exercise-3---getting-into-stan.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>noise) <span class="sc">+</span></span>
<span id="cb61-5"><a href="practical-exercise-3---getting-into-stan.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="the-memory-model-conditioning-theta" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> The memory model: conditioning theta<a href="practical-exercise-3---getting-into-stan.html#the-memory-model-conditioning-theta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="practical-exercise-3---getting-into-stan.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Now onto the memory model</span></span>
<span id="cb63-2"><a href="practical-exercise-3---getting-into-stan.html#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="practical-exercise-3---getting-into-stan.html#cb63-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">subset</span>(noise <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> rate <span class="sc">==</span> <span class="fl">0.8</span>)</span>
<span id="cb63-4"><a href="practical-exercise-3---getting-into-stan.html#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="practical-exercise-3---getting-into-stan.html#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the data</span></span>
<span id="cb63-6"><a href="practical-exercise-3---getting-into-stan.html#cb63-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb63-7"><a href="practical-exercise-3---getting-into-stan.html#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">120</span>,</span>
<span id="cb63-8"><a href="practical-exercise-3---getting-into-stan.html#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> d1<span class="sc">$</span>choice,</span>
<span id="cb63-9"><a href="practical-exercise-3---getting-into-stan.html#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">memory =</span> d1<span class="sc">$</span>cumulativerate</span>
<span id="cb63-10"><a href="practical-exercise-3---getting-into-stan.html#cb63-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-11"><a href="practical-exercise-3---getting-into-stan.html#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="practical-exercise-3---getting-into-stan.html#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Specify where the model is</span></span>
<span id="cb63-13"><a href="practical-exercise-3---getting-into-stan.html#cb63-13" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W3_MemoryBernoulli.stan&quot;</span>)</span>
<span id="cb63-14"><a href="practical-exercise-3---getting-into-stan.html#cb63-14" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file, <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Model executable is up to date!</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="practical-exercise-3---getting-into-stan.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following command calls Stan with specific options.</span></span>
<span id="cb65-2"><a href="practical-exercise-3---getting-into-stan.html#cb65-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb65-3"><a href="practical-exercise-3---getting-into-stan.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb65-4"><a href="practical-exercise-3---getting-into-stan.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb65-5"><a href="practical-exercise-3---getting-into-stan.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb65-6"><a href="practical-exercise-3---getting-into-stan.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb65-7"><a href="practical-exercise-3---getting-into-stan.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads_per_chain =</span> <span class="dv">2</span>,</span>
<span id="cb65-8"><a href="practical-exercise-3---getting-into-stan.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb65-9"><a href="practical-exercise-3---getting-into-stan.html#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb65-10"><a href="practical-exercise-3---getting-into-stan.html#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb65-11"><a href="practical-exercise-3---getting-into-stan.html#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb65-12"><a href="practical-exercise-3---getting-into-stan.html#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb65-13"><a href="practical-exercise-3---getting-into-stan.html#cb65-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 1 chain, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 0.2 seconds.</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="practical-exercise-3---getting-into-stan.html#cb67-1" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span><span class="fu">summary</span>() </span></code></pre></div>
<pre><code>## # A tibble: 125 × 10
##    variable    mean  median    sd   mad      q5     q95  rhat ess_bulk ess_tail
##    &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 lp__     -59.6   -59.3   0.951 0.671 -61.5   -58.8   1.00      287.     441.
##  2 alpha      1.30    1.30  0.317 0.284   0.760   1.84  1.00      207.     216.
##  3 beta       0.149   0.169 0.285 0.275  -0.331   0.594 0.999     221.     158.
##  4 preds[1]  96.8    97     5.75  5.93   87     105     1.00      826.     734.
##  5 preds[2]  96.9    97     5.93  5.93   87     106     1.00      878.     872.
##  6 preds[3]  97.2    97     5.89  5.93   87     106.    0.999     854.     815.
##  7 preds[4]  97.0    97     6.02  5.93   86     106     1.00      831.     888.
##  8 preds[5]  97.0    97     5.95  5.93   87     106     0.999     777.     810.
##  9 preds[6]  97.0    97     5.79  5.93   87     106     1.00      774.     766.
## 10 preds[7]  96.3    97     5.76  5.93   86     105     0.999     782.     852.
## # … with 115 more rows</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="practical-exercise-3---getting-into-stan.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior samples and include sampling of the prior:</span></span>
<span id="cb69-2"><a href="practical-exercise-3---getting-into-stan.html#cb69-2" aria-hidden="true" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb69-3"><a href="practical-exercise-3---getting-into-stan.html#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="practical-exercise-3---getting-into-stan.html#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="practical-exercise-3---getting-into-stan.html#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s plot the density for theta (prior and posterior)</span></span>
<span id="cb69-6"><a href="practical-exercise-3---getting-into-stan.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb69-7"><a href="practical-exercise-3---getting-into-stan.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(alpha), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="practical-exercise-3---getting-into-stan.html#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(alpha_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb69-9"><a href="practical-exercise-3---getting-into-stan.html#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-10"><a href="practical-exercise-3---getting-into-stan.html#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-11"><a href="practical-exercise-3---getting-into-stan.html#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="practical-exercise-3---getting-into-stan.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb70-2"><a href="practical-exercise-3---getting-into-stan.html#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(beta), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb70-3"><a href="practical-exercise-3---getting-into-stan.html#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(beta_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb70-4"><a href="practical-exercise-3---getting-into-stan.html#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="practical-exercise-3---getting-into-stan.html#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Posterior Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb70-6"><a href="practical-exercise-3---getting-into-stan.html#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="practical-exercise-2---from-verbal-to-formal-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/03-InferringRates.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
