<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Prototype-Based Models of Categorization | 12-CategorizationModelsPrototypes</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Prototype-Based Models of Categorization | 12-CategorizationModelsPrototypes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Prototype-Based Models of Categorization | 12-CategorizationModelsPrototypes" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-categorization-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.4</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.5</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
<li class="chapter" data-level="5.7.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.7.2</b> Connection to Kalman Filters</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.2</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#bayesian-memory-agent"><i class="fa fa-check"></i><b>5.9</b> Bayesian memory agent</a></li>
<li class="chapter" data-level="5.10" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.10</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#complete-pooling"><i class="fa fa-check"></i><b>7.3.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="7.3.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#no-pooling"><i class="fa fa-check"></i><b>7.3.2</b> No Pooling</a></li>
<li class="chapter" data-level="7.3.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#partial-pooling-multilevel-modeling"><i class="fa fa-check"></i><b>7.3.3</b> Partial Pooling (Multilevel Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#graphical-model-visualization"><i class="fa fa-check"></i><b>7.4</b> Graphical Model Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#biased-agent-model"><i class="fa fa-check"></i><b>7.4.1</b> Biased Agent Model</a></li>
<li class="chapter" data-level="7.4.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#memory-agent-model"><i class="fa fa-check"></i><b>7.4.2</b> Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random-agent-model"><i class="fa fa-check"></i><b>7.8</b> Multilevel Random Agent Model</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.8.1</b> Assessing multilevel random agents</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#lets-look-at-individuals"><i class="fa fa-check"></i><b>7.9</b> Let’s look at individuals</a></li>
<li class="chapter" data-level="7.10" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-sensitivity-checks"><i class="fa fa-check"></i><b>7.10</b> Prior sensitivity checks</a></li>
<li class="chapter" data-level="7.11" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-1"><i class="fa fa-check"></i><b>7.11</b> Parameter recovery</a></li>
<li class="chapter" data-level="7.12" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-agent-model"><i class="fa fa-check"></i><b>7.12</b> Multilevel Memory Agent Model</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.12.1</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#diagnosing-the-issue-with-bias-and-beta"><i class="fa fa-check"></i><b>7.12.2</b> Diagnosing the issue with bias and beta</a></li>
<li class="chapter" data-level="7.12.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.12.3</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.12.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.12.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.12.5</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.12.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.12.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#section"><i class="fa fa-check"></i><b>7.12.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches"><i class="fa fa-check"></i><b>7.13</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.14" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches-1"><i class="fa fa-check"></i><b>7.14</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.15" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-modeling-cheatsheet"><i class="fa fa-check"></i><b>7.15</b> Multilevel Modeling Cheatsheet</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#when-to-use-each-pooling-approach"><i class="fa fa-check"></i><b>7.15.1</b> When to Use Each Pooling Approach:</a></li>
<li class="chapter" data-level="7.15.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-rules-of-thumb"><i class="fa fa-check"></i><b>7.15.2</b> Parameter Recovery Rules of Thumb:</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#conclusion-the-power-and-challenges-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.16</b> Conclusion: The Power and Challenges of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.17" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#exercises-just-some-ideas"><i class="fa fa-check"></i><b>7.17</b> Exercises (just some ideas)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-challenge-of-model-selection"><i class="fa fa-check"></i><b>8.2.1</b> The Challenge of Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-the-foundation-of-model-comparison"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation: The Foundation of Model Comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-problem-of-overfitting"><i class="fa fa-check"></i><b>8.3.1</b> The Problem of Overfitting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-cross-validation-works"><i class="fa fa-check"></i><b>8.3.2</b> How Cross-Validation Works</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-in-bayesian-models"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation in Bayesian Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#expected-log-predictive-density-elpd"><i class="fa fa-check"></i><b>8.3.4</b> Expected Log Predictive Density (ELPD)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-an-efficient-approximation-to-loo-cv"><i class="fa fa-check"></i><b>8.4</b> PSIS-LOO: An Efficient Approximation to LOO-CV</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-importance-sampling-works"><i class="fa fa-check"></i><b>8.4.1</b> How Importance Sampling Works</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#pareto-smoothing-for-stability"><i class="fa fa-check"></i><b>8.4.2</b> Pareto Smoothing for Stability</a></li>
<li class="chapter" data-level="8.4.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-complete-psis-loo-process"><i class="fa fa-check"></i><b>8.4.3</b> The Complete PSIS-LOO Process</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#simulation-based-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Simulation-Based Model Comparison</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-simulation-parameters"><i class="fa fa-check"></i><b>8.5.1</b> Define Simulation Parameters</a></li>
<li class="chapter" data-level="8.5.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-agent-functions"><i class="fa fa-check"></i><b>8.5.2</b> Define Agent Functions</a></li>
<li class="chapter" data-level="8.5.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generate-simulation-data"><i class="fa fa-check"></i><b>8.5.3</b> Generate Simulation Data</a></li>
<li class="chapter" data-level="8.5.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualize-the-simulation-data"><i class="fa fa-check"></i><b>8.5.4</b> Visualize the Simulation Data</a></li>
<li class="chapter" data-level="8.5.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prepare-data-for-stan-models"><i class="fa fa-check"></i><b>8.5.5</b> Prepare Data for Stan Models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-models-for-comparison"><i class="fa fa-check"></i><b>8.6</b> Implementing Models for Comparison</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#understanding-log-likelihood-in-model-comparison"><i class="fa fa-check"></i><b>8.6.1</b> Understanding Log-Likelihood in Model Comparison</a></li>
<li class="chapter" data-level="8.6.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-biased-agent-model"><i class="fa fa-check"></i><b>8.6.2</b> Multilevel Biased Agent Model</a></li>
<li class="chapter" data-level="8.6.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-agent-model-1"><i class="fa fa-check"></i><b>8.6.3</b> Multilevel Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-models-and-calculating-expected-log-predictive-density"><i class="fa fa-check"></i><b>8.7</b> Fitting Models and Calculating Expected Log Predictive Density</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-for-model-comparison"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation for Model Comparison</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-comparison"><i class="fa fa-check"></i><b>8.9.1</b> PSIS-LOO Comparison</a></li>
<li class="chapter" data-level="8.9.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualizing-loo-cv-results"><i class="fa fa-check"></i><b>8.9.2</b> Visualizing LOO-CV Results</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#formal-model-comparison"><i class="fa fa-check"></i><b>8.10</b> Formal Model Comparison</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#k-fold-cross-validation-for-validation"><i class="fa fa-check"></i><b>8.10.1</b> K-Fold Cross-Validation for Validation</a></li>
<li class="chapter" data-level="8.10.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#comparing-loo-and-k-fold-results"><i class="fa fa-check"></i><b>8.10.2</b> Comparing LOO and K-Fold Results</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-approaches"><i class="fa fa-check"></i><b>8.11</b> Limitations of Model Comparison Approaches</a></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#exercises"><i class="fa fa-check"></i><b>8.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.12.1</b> Rant on internal vs external validity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>9</b> Mixture models</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="mixture-models.html"><a href="mixture-models.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.0.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.0.2" data-path="mixture-models.html"><a href="mixture-models.html#chapter-roadmap"><i class="fa fa-check"></i><b>9.0.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="9.1" data-path="mixture-models.html"><a href="mixture-models.html#visualizing-mixture-distributions-reaction-time-example"><i class="fa fa-check"></i><b>9.1</b> Visualizing Mixture Distributions: Reaction Time Example</a></li>
<li class="chapter" data-level="9.2" data-path="mixture-models.html"><a href="mixture-models.html#theoretical-foundation-for-mixture-models"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation for Mixture Models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mixture-models.html"><a href="mixture-models.html#the-mixture-model-framework"><i class="fa fa-check"></i><b>9.2.1</b> The Mixture Model Framework</a></li>
<li class="chapter" data-level="9.2.2" data-path="mixture-models.html"><a href="mixture-models.html#mixture-models-and-latent-variables"><i class="fa fa-check"></i><b>9.2.2</b> Mixture Models and Latent Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-in-cognitive-modeling"><i class="fa fa-check"></i><b>9.2.3</b> Applications in Cognitive Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mixture-models.html"><a href="mixture-models.html#implementing-a-basic-mixture-model"><i class="fa fa-check"></i><b>9.3</b> Implementing a Basic Mixture Model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixture-models.html"><a href="mixture-models.html#simulating-mixed-strategy-data"><i class="fa fa-check"></i><b>9.3.1</b> Simulating Mixed Strategy Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation-of-a-mixture-model"><i class="fa fa-check"></i><b>9.3.2</b> Stan Implementation of a Mixture Model</a></li>
<li class="chapter" data-level="9.3.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-mixture-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting and Evaluating the Mixture Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="mixture-models.html"><a href="mixture-models.html#model-diagnostics"><i class="fa fa-check"></i><b>9.3.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="9.3.5" data-path="mixture-models.html"><a href="mixture-models.html#parameter-recovery-analysis"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="9.3.6" data-path="mixture-models.html"><a href="mixture-models.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>9.3.6</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixture-models.html"><a href="mixture-models.html#parameter-interpretation"><i class="fa fa-check"></i><b>9.4</b> Parameter Interpretation</a></li>
<li class="chapter" data-level="9.5" data-path="mixture-models.html"><a href="mixture-models.html#multilevel-mixture-models"><i class="fa fa-check"></i><b>9.5</b> Multilevel Mixture Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation"><i class="fa fa-check"></i><b>9.5.1</b> Stan Implementation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mixture-models.html"><a href="mixture-models.html#preparing-data-for-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.2</b> Preparing Data for the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.3</b> Fitting and Evaluating the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.4" data-path="mixture-models.html"><a href="mixture-models.html#examining-individual-differences"><i class="fa fa-check"></i><b>9.5.4</b> Examining Individual Differences</a></li>
<li class="chapter" data-level="9.5.5" data-path="mixture-models.html"><a href="mixture-models.html#interpreting-parameter-correlations"><i class="fa fa-check"></i><b>9.5.5</b> Interpreting Parameter Correlations</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mixture-models.html"><a href="mixture-models.html#comparing-single-process-and-mixture-models"><i class="fa fa-check"></i><b>9.6</b> Comparing Single-Process and Mixture Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mixture-models.html"><a href="mixture-models.html#single-process-model"><i class="fa fa-check"></i><b>9.6.1</b> Single-Process Model</a></li>
<li class="chapter" data-level="9.6.2" data-path="mixture-models.html"><a href="mixture-models.html#model-comparison"><i class="fa fa-check"></i><b>9.6.2</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-of-mixture-models-in-cognitive-science"><i class="fa fa-check"></i><b>9.6.3</b> Applications of Mixture Models in Cognitive Science</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mixture-models.html"><a href="mixture-models.html#conclusion-2"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html"><i class="fa fa-check"></i><b>10</b> Win-Stay-Lose-Shift: A Heuristic Decision Strategy</a>
<ul>
<li class="chapter" data-level="10.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#loading-required-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading Required Packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#generating-data-simulating-wsls-agents"><i class="fa fa-check"></i><b>10.2</b> Generating Data: Simulating WSLS Agents</a></li>
<li class="chapter" data-level="10.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#data-processing-and-initial-visualization"><i class="fa fa-check"></i><b>10.3</b> Data Processing and Initial Visualization</a></li>
<li class="chapter" data-level="10.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#verifying-model-properties-and-assumptions"><i class="fa fa-check"></i><b>10.4</b> Verifying Model Properties and Assumptions</a></li>
<li class="chapter" data-level="10.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#modeling-a-single-wsls-agent"><i class="fa fa-check"></i><b>10.5</b> Modeling a Single WSLS Agent</a></li>
<li class="chapter" data-level="10.6" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#multilevel-wsls-model"><i class="fa fa-check"></i><b>10.6</b> Multilevel WSLS Model</a></li>
<li class="chapter" data-level="10.7" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#quality-checks-and-parameter-recovery"><i class="fa fa-check"></i><b>10.7</b> Quality Checks and Parameter Recovery</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#convergence-diagnostics"><i class="fa fa-check"></i><b>10.7.1</b> Convergence Diagnostics</a></li>
<li class="chapter" data-level="10.7.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#prior-posterior-update-visualization"><i class="fa fa-check"></i><b>10.7.2</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="10.7.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#individual-level-parameter-recovery"><i class="fa fa-check"></i><b>10.7.3</b> Individual-Level Parameter Recovery</a></li>
<li class="chapter" data-level="10.7.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#posterior-predictive-checks-2"><i class="fa fa-check"></i><b>10.7.4</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="10.7.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#model-comparison-with-loo-cv"><i class="fa fa-check"></i><b>10.7.5</b> Model Comparison with LOO-CV</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>11</b> Bayesian Models of Cognition</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#introduction-4"><i class="fa fa-check"></i><b>11.0.1</b> Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#learning-objectives-4"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#chapter-roadmap-1"><i class="fa fa-check"></i><b>11.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition"><i class="fa fa-check"></i><b>11.3</b> The Bayesian Framework for Cognition</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating"><i class="fa fa-check"></i><b>11.4</b> Visualizing Bayesian Updating</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science"><i class="fa fa-check"></i><b>11.5</b> Bayesian Models in Cognitive Science</a></li>
<li class="chapter" data-level="11.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making"><i class="fa fa-check"></i><b>11.6</b> Example: Social Influence in Perceptual Decision-Making</a></li>
<li class="chapter" data-level="11.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task"><i class="fa fa-check"></i><b>11.7</b> A Bayesian Integration Model for the Marble Task</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions"><i class="fa fa-check"></i><b>11.7.1</b> Intuitive Explanation Using Beta Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model"><i class="fa fa-check"></i><b>11.8</b> The Mathematical Model</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evidence-representation"><i class="fa fa-check"></i><b>11.8.1</b> Evidence Representation</a></li>
<li class="chapter" data-level="11.8.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration"><i class="fa fa-check"></i><b>11.8.2</b> Integration</a></li>
<li class="chapter" data-level="11.8.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#decision"><i class="fa fa-check"></i><b>11.8.3</b> Decision</a></li>
<li class="chapter" data-level="11.8.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation-in-r"><i class="fa fa-check"></i><b>11.8.4</b> Implementation in R</a></li>
<li class="chapter" data-level="11.8.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios"><i class="fa fa-check"></i><b>11.8.5</b> Simulating Experimental Scenarios</a></li>
<li class="chapter" data-level="11.8.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration"><i class="fa fa-check"></i><b>11.8.6</b> Visualizing Bayesian Integration</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios"><i class="fa fa-check"></i><b>11.9</b> Examining Belief Distributions for Selected Scenarios</a></li>
<li class="chapter" data-level="11.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10</b> Weighted Bayesian Integration</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model-1"><i class="fa fa-check"></i><b>11.10.1</b> The Mathematical Model</a></li>
<li class="chapter" data-level="11.10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation"><i class="fa fa-check"></i><b>11.10.2</b> Implementation</a></li>
<li class="chapter" data-level="11.10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10.3</b> Visualizing Weighted Bayesian Integration</a></li>
<li class="chapter" data-level="11.10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence"><i class="fa fa-check"></i><b>11.10.4</b> Resolving Conflicting Evidence</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#common-misinterpretations"><i class="fa fa-check"></i><b>11.11</b> Common Misinterpretations</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weight-interpretation"><i class="fa fa-check"></i><b>11.11.1</b> Weight Interpretation</a></li>
<li class="chapter" data-level="11.11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration-vs.-averaging"><i class="fa fa-check"></i><b>11.11.2</b> Integration vs. Averaging</a></li>
<li class="chapter" data-level="11.11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#interpreting-confidence"><i class="fa fa-check"></i><b>11.11.3</b> Interpreting Confidence</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies"><i class="fa fa-check"></i><b>11.12</b> Simulating Agents with Different Evidence Weighting Strategies</a></li>
<li class="chapter" data-level="11.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation"><i class="fa fa-check"></i><b>11.13</b> Key Observations from the Simulation</a></li>
<li class="chapter" data-level="11.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-quality-checks"><i class="fa fa-check"></i><b>11.14</b> Model Quality Checks</a>
<ul>
<li class="chapter" data-level="11.14.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#overview"><i class="fa fa-check"></i><b>11.14.1</b> Overview</a></li>
<li class="chapter" data-level="11.14.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks"><i class="fa fa-check"></i><b>11.14.2</b> Prior and Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="11.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization-1"><i class="fa fa-check"></i><b>11.15</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="11.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-2"><i class="fa fa-check"></i><b>11.16</b> Parameter recovery</a></li>
<li class="chapter" data-level="11.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-1"><i class="fa fa-check"></i><b>11.17</b> Model comparison</a></li>
<li class="chapter" data-level="11.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#leave-one-out-cross-validation-and-model-comparison"><i class="fa fa-check"></i><b>11.18</b> Leave-One-Out Cross-Validation and Model Comparison</a>
<ul>
<li class="chapter" data-level="11.18.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-loo-cross-validation-in-bayesian-framework"><i class="fa fa-check"></i><b>11.18.1</b> Understanding LOO Cross-Validation in Bayesian Framework</a></li>
<li class="chapter" data-level="11.18.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#step-by-step-implementation-of-loo-cv"><i class="fa fa-check"></i><b>11.18.2</b> Step-by-Step Implementation of LOO-CV</a></li>
<li class="chapter" data-level="11.18.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-psis-loo-diagnostics"><i class="fa fa-check"></i><b>11.18.3</b> Understanding PSIS-LOO Diagnostics</a></li>
<li class="chapter" data-level="11.18.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-for-each-scenario"><i class="fa fa-check"></i><b>11.18.4</b> Model Comparison for Each Scenario</a></li>
<li class="chapter" data-level="11.18.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-the-comparison-results"><i class="fa fa-check"></i><b>11.18.5</b> Visualizing the Comparison Results</a></li>
<li class="chapter" data-level="11.18.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-results"><i class="fa fa-check"></i><b>11.18.6</b> Understanding the Results</a></li>
<li class="chapter" data-level="11.18.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematics-behind-loo-cv"><i class="fa fa-check"></i><b>11.18.7</b> The Mathematics Behind LOO-CV</a></li>
<li class="chapter" data-level="11.18.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-pointwise-contributions-to-loo"><i class="fa fa-check"></i><b>11.18.8</b> Examining Pointwise Contributions to LOO</a></li>
</ul></li>
<li class="chapter" data-level="11.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models"><i class="fa fa-check"></i><b>11.19</b> Multilevel Bayesian Models</a>
<ul>
<li class="chapter" data-level="11.19.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents"><i class="fa fa-check"></i><b>11.19.1</b> Simulating Data from Multiple Agents</a></li>
<li class="chapter" data-level="11.19.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-simulated-data"><i class="fa fa-check"></i><b>11.19.2</b> Understanding the Simulated Data</a></li>
</ul></li>
<li class="chapter" data-level="11.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models-for-evidence-integration"><i class="fa fa-check"></i><b>11.20</b> Multilevel Bayesian Models for Evidence Integration</a>
<ul>
<li class="chapter" data-level="11.20.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-1-simple-evidence-integration-with-individual-scaling"><i class="fa fa-check"></i><b>11.20.1</b> Model 1: Simple Evidence Integration with Individual Scaling</a></li>
<li class="chapter" data-level="11.20.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-2-weighted-evidence-integration"><i class="fa fa-check"></i><b>11.20.2</b> Model 2: Weighted Evidence Integration</a></li>
<li class="chapter" data-level="11.20.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-allow-scaling-to-vary-in-the-simple-model"><i class="fa fa-check"></i><b>11.20.3</b> Why Allow Scaling to Vary in the Simple Model?</a></li>
</ul></li>
<li class="chapter" data-level="11.21" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#from-single-agent-to-multilevel-extending-bayesian-cognitive-models"><i class="fa fa-check"></i><b>11.21</b> From Single-Agent to Multilevel: Extending Bayesian Cognitive Models</a>
<ul>
<li class="chapter" data-level="11.21.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-components-of-the-multilevel-extension"><i class="fa fa-check"></i><b>11.21.1</b> Key Components of the Multilevel Extension</a></li>
<li class="chapter" data-level="11.21.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#hierarchical-prior-structure"><i class="fa fa-check"></i><b>11.21.2</b> 2. Hierarchical Prior Structure</a></li>
<li class="chapter" data-level="11.21.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#handling-data-from-multiple-individuals"><i class="fa fa-check"></i><b>11.21.3</b> 3. Handling Data from Multiple Individuals</a></li>
<li class="chapter" data-level="11.21.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#likelihood-specification"><i class="fa fa-check"></i><b>11.21.4</b> 4. Likelihood Specification</a></li>
<li class="chapter" data-level="11.21.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-these-changes-matter"><i class="fa fa-check"></i><b>11.21.5</b> Why These Changes Matter</a></li>
<li class="chapter" data-level="11.21.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>11.21.6</b> Implementing the Multilevel Weighted Beta-Binomial Model in Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.22" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-multilevel-models"><i class="fa fa-check"></i><b>11.22</b> Fitting the Multilevel Models</a>
<ul>
<li class="chapter" data-level="11.22.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1"><i class="fa fa-check"></i><b>11.22.1</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="11.22.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-2"><i class="fa fa-check"></i><b>11.22.2</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11.23" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#dynamic-bayesian-evidence-integration-sequential-updating-models"><i class="fa fa-check"></i><b>11.23</b> Dynamic Bayesian Evidence Integration: Sequential Updating Models</a>
<ul>
<li class="chapter" data-level="11.23.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-updating-the-theoretical-framework"><i class="fa fa-check"></i><b>11.23.1</b> Sequential Bayesian Updating: The Theoretical Framework</a></li>
<li class="chapter" data-level="11.23.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#single-agent-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.2</b> Single-Agent Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.3</b> Multilevel Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#generating-data-for-the-sequential-model"><i class="fa fa-check"></i><b>11.23.4</b> Generating Data for the Sequential Model</a></li>
<li class="chapter" data-level="11.23.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-and-evaluating-the-sequential-models"><i class="fa fa-check"></i><b>11.23.5</b> Fitting and Evaluating the Sequential Models</a></li>
</ul></li>
<li class="chapter" data-level="11.24" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-evidence-integration-models"><i class="fa fa-check"></i><b>11.24</b> Sequential Bayesian Evidence Integration Models</a>
<ul>
<li class="chapter" data-level="11.24.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-belief-updating-over-time"><i class="fa fa-check"></i><b>11.24.1</b> Understanding Belief Updating Over Time</a></li>
<li class="chapter" data-level="11.24.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-sequential-updating-framework"><i class="fa fa-check"></i><b>11.24.2</b> The Sequential Updating Framework</a></li>
<li class="chapter" data-level="11.24.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#mathematical-formulation"><i class="fa fa-check"></i><b>11.24.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="11.24.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#moving-from-single-agent-to-multilevel"><i class="fa fa-check"></i><b>11.24.4</b> Moving from Single-Agent to Multilevel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html"><i class="fa fa-check"></i><b>12</b> Introduction to Categorization Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-fundamental-problem-of-categorization"><i class="fa fa-check"></i><b>12.1</b> The Fundamental Problem of Categorization</a></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#why-model-categorization"><i class="fa fa-check"></i><b>12.2</b> Why Model Categorization?</a></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#historical-development-of-categorization-models"><i class="fa fa-check"></i><b>12.3</b> Historical Development of Categorization Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#early-views-the-classical-approach"><i class="fa fa-check"></i><b>12.3.1</b> Early Views: The Classical Approach</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-prototype-revolution"><i class="fa fa-check"></i><b>12.3.2</b> The Prototype Revolution</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-exemplar-alternative"><i class="fa fa-check"></i><b>12.3.3</b> The Exemplar Alternative</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models"><i class="fa fa-check"></i><b>12.3.4</b> Rule-Based Models</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-three-model-classes-core-assumptions-and-predictions"><i class="fa fa-check"></i><b>12.4</b> The Three Model Classes: Core Assumptions and Predictions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#exemplar-models-individual-instances-as-category-representations"><i class="fa fa-check"></i><b>12.4.1</b> Exemplar Models: Individual Instances as Category Representations</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#prototype-models-categories-as-central-tendencies"><i class="fa fa-check"></i><b>12.4.2</b> Prototype Models: Categories as Central Tendencies</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models-categories-as-decision-boundaries"><i class="fa fa-check"></i><b>12.4.3</b> Rule-Based Models: Categories as Decision Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#our-implementation-approach"><i class="fa fa-check"></i><b>12.5</b> Our Implementation Approach</a></li>
<li class="chapter" data-level="12.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.6</b> The Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-foundations-and-cognitive-principles"><i class="fa fa-check"></i><b>12.6.1</b> Mathematical Foundations and Cognitive Principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#core-assumptions-of-the-gcm"><i class="fa fa-check"></i><b>12.6.2</b> Core Assumptions of the GCM</a></li>
<li class="chapter" data-level="12.6.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-1"><i class="fa fa-check"></i><b>12.6.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="12.6.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-gcm-agent-implementation"><i class="fa fa-check"></i><b>12.6.4</b> The GCM Agent Implementation</a></li>
<li class="chapter" data-level="12.6.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-behavior-with-the-gcm"><i class="fa fa-check"></i><b>12.6.5</b> Simulating Behavior with the GCM</a></li>
<li class="chapter" data-level="12.6.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-gcm-in-stan-for-parameter-estimation"><i class="fa fa-check"></i><b>12.6.6</b> Implementing the GCM in Stan for Parameter Estimation</a></li>
<li class="chapter" data-level="12.6.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#key-parameters-and-their-cognitive-interpretations"><i class="fa fa-check"></i><b>12.6.7</b> Key Parameters and Their Cognitive Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#multilevel-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.7</b> Multilevel Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-need-for-a-multilevel-approach"><i class="fa fa-check"></i><b>12.7.1</b> The Need for a Multilevel Approach</a></li>
<li class="chapter" data-level="12.7.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-of-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.2</b> Mathematical Formulation of the Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-data-for-a-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.3</b> Simulating Data for a Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-multilevel-gcm-in-stan"><i class="fa fa-check"></i><b>12.7.4</b> Implementing the Multilevel GCM in Stan</a></li>
<li class="chapter" data-level="12.7.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#fitting-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.5</b> Fitting the Multilevel GCM</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#gcm-in-context-strengths-and-limitations"><i class="fa fa-check"></i><b>12.8</b> GCM in Context: Strengths and Limitations</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#strengths"><i class="fa fa-check"></i><b>12.8.1</b> Strengths</a></li>
<li class="chapter" data-level="12.8.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#limitations"><i class="fa fa-check"></i><b>12.8.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#some-notes-about-student-produced-models-of-categorization"><i class="fa fa-check"></i><b>12.9</b> Some notes about student-produced models of categorization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html"><i class="fa fa-check"></i><b>13</b> Prototype-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="13.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#theoretical-foundations"><i class="fa fa-check"></i><b>13.1</b> Theoretical Foundations</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#core-assumptions-of-prototype-models"><i class="fa fa-check"></i><b>13.1.1</b> Core Assumptions of Prototype Models</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#prototype-models-vs.-exemplar-models"><i class="fa fa-check"></i><b>13.2</b> Prototype Models vs. Exemplar Models</a></li>
<li class="chapter" data-level="13.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-kalman-filter-approach-to-prototype-learning"><i class="fa fa-check"></i><b>13.3</b> The Kalman Filter Approach to Prototype Learning</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#mathematical-formulation-of-the-kalman-filter-prototype-model"><i class="fa fa-check"></i><b>13.3.1</b> Mathematical Formulation of the Kalman Filter Prototype Model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-kalman-filter-prototype-model"><i class="fa fa-check"></i><b>13.4</b> Implementing the Kalman Filter Prototype Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#univariate-kalman-filter-for-clear-explanation"><i class="fa fa-check"></i><b>13.4.1</b> Univariate Kalman Filter (for clear explanation)</a></li>
<li class="chapter" data-level="13.4.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#multivariate-kalman-filter-for-categorization"><i class="fa fa-check"></i><b>13.4.2</b> Multivariate Kalman Filter for Categorization</a></li>
<li class="chapter" data-level="13.4.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-observation-noise-parameter"><i class="fa fa-check"></i><b>13.4.3</b> The Observation Noise Parameter</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior-with-the-prototype-model"><i class="fa fa-check"></i><b>13.5</b> Simulating Categorization Behavior with the Prototype Model</a></li>
<li class="chapter" data-level="13.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#visualizing-prototype-learning"><i class="fa fa-check"></i><b>13.6</b> Visualizing Prototype Learning</a></li>
<li class="chapter" data-level="13.7" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#comparing-prototype-and-exemplar-models"><i class="fa fa-check"></i><b>13.7</b> Comparing Prototype and Exemplar Models</a></li>
<li class="chapter" data-level="13.8" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-prototype-model-in-stan"><i class="fa fa-check"></i><b>13.8</b> Implementing the Prototype Model in Stan</a></li>
<li class="chapter" data-level="13.9" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#parameter-recovery-analysis-for-the-prototype-model"><i class="fa fa-check"></i><b>13.9</b> Parameter Recovery Analysis for the Prototype Model</a></li>
<li class="chapter" data-level="13.10" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#cognitive-insights-from-the-prototype-model"><i class="fa fa-check"></i><b>13.10</b> Cognitive Insights from the Prototype Model</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#incremental-learning"><i class="fa fa-check"></i><b>13.10.1</b> 1. Incremental Learning</a></li>
<li class="chapter" data-level="13.10.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#uncertainty-driven-learning"><i class="fa fa-check"></i><b>13.10.2</b> 2. Uncertainty-Driven Learning</a></li>
<li class="chapter" data-level="13.10.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#selective-attention-emerges-naturally"><i class="fa fa-check"></i><b>13.10.3</b> 3. Selective Attention Emerges Naturally</a></li>
<li class="chapter" data-level="13.10.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#memory-efficiency"><i class="fa fa-check"></i><b>13.10.4</b> 4. Memory Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#contrasting-with-exemplar-models"><i class="fa fa-check"></i><b>13.11</b> Contrasting with Exemplar Models</a></li>
<li class="chapter" data-level="13.12" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#strengths-of-the-prototype-approach"><i class="fa fa-check"></i><b>13.12</b> Strengths of the Prototype Approach</a></li>
<li class="chapter" data-level="13.13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#limitations-of-the-prototype-approach"><i class="fa fa-check"></i><b>13.13</b> Limitations of the Prototype Approach</a></li>
<li class="chapter" data-level="13.14" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#extensions-to-the-basic-model"><i class="fa fa-check"></i><b>13.14</b> Extensions to the Basic Model</a></li>
<li class="chapter" data-level="13.15" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#conclusion-the-prototype-and-exemplar-debate"><i class="fa fa-check"></i><b>13.15</b> Conclusion: The Prototype and Exemplar Debate</a>
<ul>
<li class="chapter" data-level="13.15.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-prototype-exemplar-spectrum-and-multiple-prototype-models"><i class="fa fa-check"></i><b>13.15.1</b> The Prototype-Exemplar Spectrum and Multiple-Prototype Models</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">12-CategorizationModelsPrototypes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prototype-based-models-of-categorization" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Prototype-Based Models of Categorization<a href="prototype-based-models-of-categorization.html#prototype-based-models-of-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="theoretical-foundations" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Theoretical Foundations<a href="prototype-based-models-of-categorization.html#theoretical-foundations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Prototype theory emerged as an alternative to both the classical view of categories (based on necessary and sufficient conditions) and exemplar-based accounts. The core idea is elegantly simple: rather than storing all individual exemplars in memory, the cognitive system abstracts a summary representation—a prototype—for each category. New items are then categorized based on their similarity to these prototypes.</p>
<div id="core-assumptions-of-prototype-models" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Core Assumptions of Prototype Models<a href="prototype-based-models-of-categorization.html#core-assumptions-of-prototype-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>Category Abstraction</strong>: Categories are represented by central tendencies or prototypes rather than collections of exemplars</li>
<li><strong>Economical Representation</strong>: Only prototype information is stored, not individual exemplars</li>
<li><strong>Similarity-Based Decisions</strong>: Categorization is based on similarity to category prototypes</li>
<li><strong>Typicality Effects</strong>: Items more similar to the prototype are processed more fluently and judged as more typical</li>
</ol>
<p>Unlike exemplar models, which maintain that people store individual instances, prototype models propose a more economical representation: the cognitive system extracts and stores the central tendency of the category. This provides a cognitively efficient way to represent categories while capturing many of the phenomena observed in human categorization.</p>
</div>
</div>
<div id="prototype-models-vs.-exemplar-models" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Prototype Models vs. Exemplar Models<a href="prototype-based-models-of-categorization.html#prototype-models-vs.-exemplar-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The debate between prototype and exemplar theories has been one of the most productive in cognitive psychology. The key differences include:</p>
<table>
<colgroup>
<col width="18%" />
<col width="41%" />
<col width="39%" />
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Prototype Models</th>
<th>Exemplar Models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Representation</strong></td>
<td>Abstract summary (central tendency)</td>
<td>Collection of individual instances</td>
</tr>
<tr class="even">
<td><strong>Memory Requirements</strong></td>
<td>Economical (one prototype per category)</td>
<td>Potentially high (all exemplars)</td>
</tr>
<tr class="odd">
<td><strong>Typicality Prediction</strong></td>
<td>Items similar to prototype are most typical</td>
<td>Items similar to many exemplars are most typical</td>
</tr>
<tr class="even">
<td><strong>Category Boundaries</strong></td>
<td>Smoother, based on distance from prototypes</td>
<td>Potentially more complex, based on similarity to all exemplars</td>
</tr>
<tr class="odd">
<td><strong>Unusual Members</strong></td>
<td>May not influence the prototype much</td>
<td>Explicitly represented and influence decisions</td>
</tr>
</tbody>
</table>
</div>
<div id="the-kalman-filter-approach-to-prototype-learning" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> The Kalman Filter Approach to Prototype Learning<a href="prototype-based-models-of-categorization.html#the-kalman-filter-approach-to-prototype-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Traditional prototype models often assumed a static prototype computed as the average of all category members. However, this doesn’t capture the dynamic nature of human learning, where we continuously update our category representations as we encounter new examples.</p>
<p>The Kalman filter provides an elegant mathematical framework for implementing a dynamic prototype model. Originally developed for tracking physical systems, the Kalman filter is ideal for modeling prototype learning because it:</p>
<ol style="list-style-type: decimal">
<li><strong>Updates incrementally</strong> with each new observation</li>
<li><strong>Balances prior knowledge</strong> with new evidence</li>
<li><strong>Maintains uncertainty</strong> about the prototype location</li>
<li><strong>Adjusts learning rate</strong> based on certainty</li>
</ol>
<div id="mathematical-formulation-of-the-kalman-filter-prototype-model" class="section level3 hasAnchor" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Mathematical Formulation of the Kalman Filter Prototype Model<a href="prototype-based-models-of-categorization.html#mathematical-formulation-of-the-kalman-filter-prototype-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Kalman filter prototype model tracks each category’s prototype as a probability distribution rather than a fixed point. Specifically, for each category, we maintain:</p>
<ul>
<li>A prototype location (mean vector μ)</li>
<li>An uncertainty measure (covariance matrix Σ)</li>
</ul>
<div id="initialization" class="section level4 hasAnchor" number="13.3.1.1">
<h4><span class="header-section-number">13.3.1.1</span> 1. Initialization<a href="prototype-based-models-of-categorization.html#initialization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For each category C, we initialize:
- Prototype location: μ₀ (often set to the first exemplar or a prior expectation)
- Uncertainty: Σ₀ (high initial uncertainty)</p>
</div>
<div id="update-equations" class="section level4 hasAnchor" number="13.3.1.2">
<h4><span class="header-section-number">13.3.1.2</span> 2. Update Equations<a href="prototype-based-models-of-categorization.html#update-equations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When a new exemplar x is observed for category C, we update the prototype and uncertainty as follows:</p>
<p><strong>Prototype Update</strong>:
μₜ = μₜ₋₁ + K(x - μₜ₋₁)</p>
<p><strong>Uncertainty Update</strong>:
Σₜ = (I - K)Σₜ₋₁</p>
<p><strong>Kalman Gain</strong>:
K = Σₜ₋₁(Σₜ₋₁ + R)⁻¹</p>
<p>Where:
- μₜ is the updated prototype location
- Σₜ is the updated uncertainty
- K is the Kalman gain (learning rate)
- R is the observation noise (constant or learned)</p>
<p>The Kalman gain K is crucial—it determines how much weight to give to the new observation versus the existing prototype. When uncertainty is high, K is larger, giving more weight to new observations. As uncertainty decreases with more observations, K decreases, making the prototype more stable.</p>
</div>
<div id="categorization-decision" class="section level4 hasAnchor" number="13.3.1.3">
<h4><span class="header-section-number">13.3.1.3</span> 3. Categorization Decision<a href="prototype-based-models-of-categorization.html#categorization-decision" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given multiple categories, the probability of assigning a new stimulus x to category C is given by:</p>
<p>P(C|x) ∝ exp(-0.5(x - μ)ᵀ(Σ + R)⁻¹(x - μ))</p>
<p>This is based on the multivariate normal density, essentially measuring how likely the observation x is under category C’s prototype distribution.</p>
</div>
</div>
</div>
<div id="implementing-the-kalman-filter-prototype-model" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Implementing the Kalman Filter Prototype Model<a href="prototype-based-models-of-categorization.html#implementing-the-kalman-filter-prototype-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s implement a Kalman filter prototype model in R. For simplicity, we’ll start with a univariate case and then extend to the multivariate case needed for our categorization task.</p>
<div id="univariate-kalman-filter-for-clear-explanation" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Univariate Kalman Filter (for clear explanation)<a href="prototype-based-models-of-categorization.html#univariate-kalman-filter-for-clear-explanation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="prototype-based-models-of-categorization.html#cb635-1" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb635-2"><a href="prototype-based-models-of-categorization.html#cb635-2" tabindex="-1"></a><span class="co"># Control regeneration of simulations/fits</span></span>
<span id="cb635-3"><a href="prototype-based-models-of-categorization.html#cb635-3" tabindex="-1"></a>regenerate_simulations <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># Set to FALSE to load saved results</span></span>
<span id="cb635-4"><a href="prototype-based-models-of-categorization.html#cb635-4" tabindex="-1"></a></span>
<span id="cb635-5"><a href="prototype-based-models-of-categorization.html#cb635-5" tabindex="-1"></a><span class="co"># Simple univariate Kalman filter for tracking a prototype</span></span>
<span id="cb635-6"><a href="prototype-based-models-of-categorization.html#cb635-6" tabindex="-1"></a>kalman_update <span class="ot">&lt;-</span> <span class="cf">function</span>(mu_prev, sigma_prev, observation, r) {</span>
<span id="cb635-7"><a href="prototype-based-models-of-categorization.html#cb635-7" tabindex="-1"></a>  <span class="co"># Calculate Kalman gain</span></span>
<span id="cb635-8"><a href="prototype-based-models-of-categorization.html#cb635-8" tabindex="-1"></a>  k <span class="ot">&lt;-</span> sigma_prev <span class="sc">/</span> (sigma_prev <span class="sc">+</span> r)</span>
<span id="cb635-9"><a href="prototype-based-models-of-categorization.html#cb635-9" tabindex="-1"></a>  </span>
<span id="cb635-10"><a href="prototype-based-models-of-categorization.html#cb635-10" tabindex="-1"></a>  <span class="co"># Update mean (prototype location)</span></span>
<span id="cb635-11"><a href="prototype-based-models-of-categorization.html#cb635-11" tabindex="-1"></a>  mu_new <span class="ot">&lt;-</span> mu_prev <span class="sc">+</span> k <span class="sc">*</span> (observation <span class="sc">-</span> mu_prev)</span>
<span id="cb635-12"><a href="prototype-based-models-of-categorization.html#cb635-12" tabindex="-1"></a>  </span>
<span id="cb635-13"><a href="prototype-based-models-of-categorization.html#cb635-13" tabindex="-1"></a>  <span class="co"># Update variance (uncertainty)</span></span>
<span id="cb635-14"><a href="prototype-based-models-of-categorization.html#cb635-14" tabindex="-1"></a>  sigma_new <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> k) <span class="sc">*</span> sigma_prev</span>
<span id="cb635-15"><a href="prototype-based-models-of-categorization.html#cb635-15" tabindex="-1"></a>  </span>
<span id="cb635-16"><a href="prototype-based-models-of-categorization.html#cb635-16" tabindex="-1"></a>  <span class="co"># Return updated values</span></span>
<span id="cb635-17"><a href="prototype-based-models-of-categorization.html#cb635-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mu =</span> mu_new, <span class="at">sigma =</span> sigma_new, <span class="at">k =</span> k))</span>
<span id="cb635-18"><a href="prototype-based-models-of-categorization.html#cb635-18" tabindex="-1"></a>}</span></code></pre></div>
<p>This function:
1. Takes the current prototype (mu_prev), uncertainty (sigma_prev), and a new observation
2. Calculates the Kalman gain (k) based on current uncertainty
3. Updates the prototype by moving it toward the observation, weighted by the gain
4. Updates the uncertainty, which always decreases with more observations
5. Returns the updated prototype, uncertainty, and gain</p>
<p>The beauty of the Kalman filter is that the gain automatically adapts: when uncertainty is high (early learning), the gain is high, leading to larger updates. As uncertainty decreases (more observations), the gain decreases, making the prototype more stable.</p>
</div>
<div id="multivariate-kalman-filter-for-categorization" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Multivariate Kalman Filter for Categorization<a href="prototype-based-models-of-categorization.html#multivariate-kalman-filter-for-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For categorization tasks with multiple feature dimensions, we need a multivariate version of the Kalman filter:</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="prototype-based-models-of-categorization.html#cb636-1" tabindex="-1"></a><span class="co"># Multivariate Kalman filter for tracking category prototypes</span></span>
<span id="cb636-2"><a href="prototype-based-models-of-categorization.html#cb636-2" tabindex="-1"></a>multivariate_kalman_update <span class="ot">&lt;-</span> <span class="cf">function</span>(mu_prev, sigma_prev, observation, r_matrix) {</span>
<span id="cb636-3"><a href="prototype-based-models-of-categorization.html#cb636-3" tabindex="-1"></a>  <span class="co"># Ensure inputs are matrices/vectors</span></span>
<span id="cb636-4"><a href="prototype-based-models-of-categorization.html#cb636-4" tabindex="-1"></a>  mu_prev <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mu_prev)</span>
<span id="cb636-5"><a href="prototype-based-models-of-categorization.html#cb636-5" tabindex="-1"></a>  observation <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(observation)</span>
<span id="cb636-6"><a href="prototype-based-models-of-categorization.html#cb636-6" tabindex="-1"></a>  sigma_prev <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sigma_prev)</span>
<span id="cb636-7"><a href="prototype-based-models-of-categorization.html#cb636-7" tabindex="-1"></a>  r_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(r_matrix)</span>
<span id="cb636-8"><a href="prototype-based-models-of-categorization.html#cb636-8" tabindex="-1"></a>  </span>
<span id="cb636-9"><a href="prototype-based-models-of-categorization.html#cb636-9" tabindex="-1"></a>  n_dim <span class="ot">&lt;-</span> <span class="fu">length</span>(mu_prev)</span>
<span id="cb636-10"><a href="prototype-based-models-of-categorization.html#cb636-10" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">diag</span>(n_dim) <span class="co"># Identity matrix</span></span>
<span id="cb636-11"><a href="prototype-based-models-of-categorization.html#cb636-11" tabindex="-1"></a>  </span>
<span id="cb636-12"><a href="prototype-based-models-of-categorization.html#cb636-12" tabindex="-1"></a>  <span class="co"># Calculate Kalman gain</span></span>
<span id="cb636-13"><a href="prototype-based-models-of-categorization.html#cb636-13" tabindex="-1"></a>  <span class="co"># Use tryCatch for potential singularity, though unlikely with added R</span></span>
<span id="cb636-14"><a href="prototype-based-models-of-categorization.html#cb636-14" tabindex="-1"></a>  S_inv <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">solve</span>(sigma_prev <span class="sc">+</span> r_matrix), <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb636-15"><a href="prototype-based-models-of-categorization.html#cb636-15" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">&quot;Matrix inversion failed in Kalman gain calculation. Using pseudo-inverse or adding jitter might help.&quot;</span>)</span>
<span id="cb636-16"><a href="prototype-based-models-of-categorization.html#cb636-16" tabindex="-1"></a>      MASS<span class="sc">::</span><span class="fu">ginv</span>(sigma_prev <span class="sc">+</span> r_matrix) <span class="co"># Fallback using pseudo-inverse</span></span>
<span id="cb636-17"><a href="prototype-based-models-of-categorization.html#cb636-17" tabindex="-1"></a>  })</span>
<span id="cb636-18"><a href="prototype-based-models-of-categorization.html#cb636-18" tabindex="-1"></a>  k_matrix <span class="ot">&lt;-</span> sigma_prev <span class="sc">%*%</span> S_inv</span>
<span id="cb636-19"><a href="prototype-based-models-of-categorization.html#cb636-19" tabindex="-1"></a>  </span>
<span id="cb636-20"><a href="prototype-based-models-of-categorization.html#cb636-20" tabindex="-1"></a>  <span class="co"># Update mean (prototype location)</span></span>
<span id="cb636-21"><a href="prototype-based-models-of-categorization.html#cb636-21" tabindex="-1"></a>  innovation <span class="ot">&lt;-</span> observation <span class="sc">-</span> mu_prev</span>
<span id="cb636-22"><a href="prototype-based-models-of-categorization.html#cb636-22" tabindex="-1"></a>  mu_new <span class="ot">&lt;-</span> mu_prev <span class="sc">+</span> k_matrix <span class="sc">%*%</span> innovation</span>
<span id="cb636-23"><a href="prototype-based-models-of-categorization.html#cb636-23" tabindex="-1"></a>  </span>
<span id="cb636-24"><a href="prototype-based-models-of-categorization.html#cb636-24" tabindex="-1"></a>  <span class="co"># Update covariance (uncertainty) using Joseph form</span></span>
<span id="cb636-25"><a href="prototype-based-models-of-categorization.html#cb636-25" tabindex="-1"></a>  <span class="co"># sigma_new = (I - K) * sigma_prev * (I - K)&#39; + K * R * K&#39;</span></span>
<span id="cb636-26"><a href="prototype-based-models-of-categorization.html#cb636-26" tabindex="-1"></a>  IK_term <span class="ot">&lt;-</span> (I <span class="sc">-</span> k_matrix)</span>
<span id="cb636-27"><a href="prototype-based-models-of-categorization.html#cb636-27" tabindex="-1"></a>  sigma_new <span class="ot">&lt;-</span> IK_term <span class="sc">%*%</span> sigma_prev <span class="sc">%*%</span> <span class="fu">t</span>(IK_term) <span class="sc">+</span> k_matrix <span class="sc">%*%</span> r_matrix <span class="sc">%*%</span> <span class="fu">t</span>(k_matrix)</span>
<span id="cb636-28"><a href="prototype-based-models-of-categorization.html#cb636-28" tabindex="-1"></a>  </span>
<span id="cb636-29"><a href="prototype-based-models-of-categorization.html#cb636-29" tabindex="-1"></a>  <span class="co"># Ensure symmetry (numerical precision can sometimes cause minor asymmetry)</span></span>
<span id="cb636-30"><a href="prototype-based-models-of-categorization.html#cb636-30" tabindex="-1"></a>  sigma_new <span class="ot">&lt;-</span> (sigma_new <span class="sc">+</span> <span class="fu">t</span>(sigma_new)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb636-31"><a href="prototype-based-models-of-categorization.html#cb636-31" tabindex="-1"></a>  </span>
<span id="cb636-32"><a href="prototype-based-models-of-categorization.html#cb636-32" tabindex="-1"></a>  <span class="co"># Return updated values</span></span>
<span id="cb636-33"><a href="prototype-based-models-of-categorization.html#cb636-33" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mu =</span> <span class="fu">as.numeric</span>(mu_new), <span class="at">sigma =</span> sigma_new, <span class="at">k =</span> k_matrix))</span>
<span id="cb636-34"><a href="prototype-based-models-of-categorization.html#cb636-34" tabindex="-1"></a>}</span></code></pre></div>
<p>For our categorization task, we’ll use this to track prototypes for each category:</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="prototype-based-models-of-categorization.html#cb637-1" tabindex="-1"></a><span class="co"># Prototype model using Kalman filter for categorization</span></span>
<span id="cb637-2"><a href="prototype-based-models-of-categorization.html#cb637-2" tabindex="-1"></a>prototype_kalman <span class="ot">&lt;-</span> <span class="cf">function</span>(r_value, obs, cat_one, <span class="at">quiet =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb637-3"><a href="prototype-based-models-of-categorization.html#cb637-3" tabindex="-1"></a>  <span class="co"># Create empty vector for response probabilities</span></span>
<span id="cb637-4"><a href="prototype-based-models-of-categorization.html#cb637-4" tabindex="-1"></a>  response_probs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb637-5"><a href="prototype-based-models-of-categorization.html#cb637-5" tabindex="-1"></a>  </span>
<span id="cb637-6"><a href="prototype-based-models-of-categorization.html#cb637-6" tabindex="-1"></a>  n_trials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb637-7"><a href="prototype-based-models-of-categorization.html#cb637-7" tabindex="-1"></a>  n_features <span class="ot">&lt;-</span> <span class="fu">ncol</span>(obs)</span>
<span id="cb637-8"><a href="prototype-based-models-of-categorization.html#cb637-8" tabindex="-1"></a>  </span>
<span id="cb637-9"><a href="prototype-based-models-of-categorization.html#cb637-9" tabindex="-1"></a>  <span class="co"># Initialize prototypes for each category (Consistent with Stan)</span></span>
<span id="cb637-10"><a href="prototype-based-models-of-categorization.html#cb637-10" tabindex="-1"></a>  prototype_cat_0 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb637-11"><a href="prototype-based-models-of-categorization.html#cb637-11" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features),      <span class="co"># Initial prototype location (aligned with Stan)</span></span>
<span id="cb637-12"><a href="prototype-based-models-of-categorization.html#cb637-12" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">10</span>, n_features)  <span class="co"># Initial uncertainty (high, aligned with Stan)</span></span>
<span id="cb637-13"><a href="prototype-based-models-of-categorization.html#cb637-13" tabindex="-1"></a>  )</span>
<span id="cb637-14"><a href="prototype-based-models-of-categorization.html#cb637-14" tabindex="-1"></a>  </span>
<span id="cb637-15"><a href="prototype-based-models-of-categorization.html#cb637-15" tabindex="-1"></a>  prototype_cat_1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb637-16"><a href="prototype-based-models-of-categorization.html#cb637-16" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features),      <span class="co"># Initial prototype location (aligned with Stan)</span></span>
<span id="cb637-17"><a href="prototype-based-models-of-categorization.html#cb637-17" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">10</span>, n_features)  <span class="co"># Initial uncertainty (high, aligned with Stan)</span></span>
<span id="cb637-18"><a href="prototype-based-models-of-categorization.html#cb637-18" tabindex="-1"></a>  )</span>
<span id="cb637-19"><a href="prototype-based-models-of-categorization.html#cb637-19" tabindex="-1"></a>  </span>
<span id="cb637-20"><a href="prototype-based-models-of-categorization.html#cb637-20" tabindex="-1"></a>  <span class="co"># Observation noise (fixed for simplicity, could be learned)</span></span>
<span id="cb637-21"><a href="prototype-based-models-of-categorization.html#cb637-21" tabindex="-1"></a>  r_matrix <span class="ot">&lt;-</span> <span class="fu">diag</span>(r_value, n_features)</span>
<span id="cb637-22"><a href="prototype-based-models-of-categorization.html#cb637-22" tabindex="-1"></a>  </span>
<span id="cb637-23"><a href="prototype-based-models-of-categorization.html#cb637-23" tabindex="-1"></a>  <span class="co"># Log-Sum-Exp function for stable normalization</span></span>
<span id="cb637-24"><a href="prototype-based-models-of-categorization.html#cb637-24" tabindex="-1"></a>  log_sum_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(v) {</span>
<span id="cb637-25"><a href="prototype-based-models-of-categorization.html#cb637-25" tabindex="-1"></a>    max_v <span class="ot">&lt;-</span> <span class="fu">max</span>(v)</span>
<span id="cb637-26"><a href="prototype-based-models-of-categorization.html#cb637-26" tabindex="-1"></a>    max_v <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">sum</span>(<span class="fu">exp</span>(v <span class="sc">-</span> max_v)))</span>
<span id="cb637-27"><a href="prototype-based-models-of-categorization.html#cb637-27" tabindex="-1"></a>  }</span>
<span id="cb637-28"><a href="prototype-based-models-of-categorization.html#cb637-28" tabindex="-1"></a>  </span>
<span id="cb637-29"><a href="prototype-based-models-of-categorization.html#cb637-29" tabindex="-1"></a>  <span class="co"># Process each trial</span></span>
<span id="cb637-30"><a href="prototype-based-models-of-categorization.html#cb637-30" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb637-31"><a href="prototype-based-models-of-categorization.html#cb637-31" tabindex="-1"></a>    <span class="co"># Debug info</span></span>
<span id="cb637-32"><a href="prototype-based-models-of-categorization.html#cb637-32" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>quiet <span class="sc">&amp;&amp;</span> i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb637-33"><a href="prototype-based-models-of-categorization.html#cb637-33" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;i =&quot;</span>, i))</span>
<span id="cb637-34"><a href="prototype-based-models-of-categorization.html#cb637-34" tabindex="-1"></a>    }</span>
<span id="cb637-35"><a href="prototype-based-models-of-categorization.html#cb637-35" tabindex="-1"></a>    </span>
<span id="cb637-36"><a href="prototype-based-models-of-categorization.html#cb637-36" tabindex="-1"></a>    current_obs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[i, ])</span>
<span id="cb637-37"><a href="prototype-based-models-of-categorization.html#cb637-37" tabindex="-1"></a>    </span>
<span id="cb637-38"><a href="prototype-based-models-of-categorization.html#cb637-38" tabindex="-1"></a>    <span class="co"># Calculate response probability based on current prototypes using MVN density</span></span>
<span id="cb637-39"><a href="prototype-based-models-of-categorization.html#cb637-39" tabindex="-1"></a>    </span>
<span id="cb637-40"><a href="prototype-based-models-of-categorization.html#cb637-40" tabindex="-1"></a>    <span class="co"># Calculate covariance matrices including observation noise</span></span>
<span id="cb637-41"><a href="prototype-based-models-of-categorization.html#cb637-41" tabindex="-1"></a>    cov_cat_0 <span class="ot">&lt;-</span> prototype_cat_0<span class="sc">$</span>sigma <span class="sc">+</span> r_matrix</span>
<span id="cb637-42"><a href="prototype-based-models-of-categorization.html#cb637-42" tabindex="-1"></a>    cov_cat_1 <span class="ot">&lt;-</span> prototype_cat_1<span class="sc">$</span>sigma <span class="sc">+</span> r_matrix</span>
<span id="cb637-43"><a href="prototype-based-models-of-categorization.html#cb637-43" tabindex="-1"></a>    </span>
<span id="cb637-44"><a href="prototype-based-models-of-categorization.html#cb637-44" tabindex="-1"></a>    <span class="co"># Calculate log determinants</span></span>
<span id="cb637-45"><a href="prototype-based-models-of-categorization.html#cb637-45" tabindex="-1"></a>    <span class="co"># Use determinant() from base R, ensure log = TRUE</span></span>
<span id="cb637-46"><a href="prototype-based-models-of-categorization.html#cb637-46" tabindex="-1"></a>    log_det_0 <span class="ot">&lt;-</span> <span class="fu">determinant</span>(cov_cat_0, <span class="at">logarithm =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>modulus[<span class="dv">1</span>] </span>
<span id="cb637-47"><a href="prototype-based-models-of-categorization.html#cb637-47" tabindex="-1"></a>    log_det_1 <span class="ot">&lt;-</span> <span class="fu">determinant</span>(cov_cat_1, <span class="at">logarithm =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>modulus[<span class="dv">1</span>]</span>
<span id="cb637-48"><a href="prototype-based-models-of-categorization.html#cb637-48" tabindex="-1"></a>    </span>
<span id="cb637-49"><a href="prototype-based-models-of-categorization.html#cb637-49" tabindex="-1"></a>    <span class="co"># Calculate Mahalanobis squared distances</span></span>
<span id="cb637-50"><a href="prototype-based-models-of-categorization.html#cb637-50" tabindex="-1"></a>    <span class="co"># Use tryCatch for potential singularity if cov matrix becomes ill-conditioned</span></span>
<span id="cb637-51"><a href="prototype-based-models-of-categorization.html#cb637-51" tabindex="-1"></a>    prec_cat_0 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">solve</span>(cov_cat_0), <span class="at">error =</span> <span class="cf">function</span>(e) MASS<span class="sc">::</span><span class="fu">ginv</span>(cov_cat_0))</span>
<span id="cb637-52"><a href="prototype-based-models-of-categorization.html#cb637-52" tabindex="-1"></a>    prec_cat_1 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">solve</span>(cov_cat_1), <span class="at">error =</span> <span class="cf">function</span>(e) MASS<span class="sc">::</span><span class="fu">ginv</span>(cov_cat_1))</span>
<span id="cb637-53"><a href="prototype-based-models-of-categorization.html#cb637-53" tabindex="-1"></a>    </span>
<span id="cb637-54"><a href="prototype-based-models-of-categorization.html#cb637-54" tabindex="-1"></a>    diff0 <span class="ot">&lt;-</span> current_obs <span class="sc">-</span> prototype_cat_0<span class="sc">$</span>mu</span>
<span id="cb637-55"><a href="prototype-based-models-of-categorization.html#cb637-55" tabindex="-1"></a>    diff1 <span class="ot">&lt;-</span> current_obs <span class="sc">-</span> prototype_cat_1<span class="sc">$</span>mu</span>
<span id="cb637-56"><a href="prototype-based-models-of-categorization.html#cb637-56" tabindex="-1"></a>    </span>
<span id="cb637-57"><a href="prototype-based-models-of-categorization.html#cb637-57" tabindex="-1"></a>    dist_sq_0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(diff0 <span class="sc">*</span> (prec_cat_0 <span class="sc">%*%</span> diff0)) <span class="co"># Quadratic form: t(diff) %*% prec %*% diff</span></span>
<span id="cb637-58"><a href="prototype-based-models-of-categorization.html#cb637-58" tabindex="-1"></a>    dist_sq_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(diff1 <span class="sc">*</span> (prec_cat_1 <span class="sc">%*%</span> diff1))</span>
<span id="cb637-59"><a href="prototype-based-models-of-categorization.html#cb637-59" tabindex="-1"></a>    </span>
<span id="cb637-60"><a href="prototype-based-models-of-categorization.html#cb637-60" tabindex="-1"></a>    <span class="co"># Calculate log probabilities (proportional to MVN density)</span></span>
<span id="cb637-61"><a href="prototype-based-models-of-categorization.html#cb637-61" tabindex="-1"></a>    log_prob_0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> (dist_sq_0 <span class="sc">+</span> log_det_0 <span class="sc">+</span> n_features <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> pi))</span>
<span id="cb637-62"><a href="prototype-based-models-of-categorization.html#cb637-62" tabindex="-1"></a>    log_prob_1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> (dist_sq_1 <span class="sc">+</span> log_det_1 <span class="sc">+</span> n_features <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> pi))</span>
<span id="cb637-63"><a href="prototype-based-models-of-categorization.html#cb637-63" tabindex="-1"></a>    </span>
<span id="cb637-64"><a href="prototype-based-models-of-categorization.html#cb637-64" tabindex="-1"></a>    <span class="co"># Normalize using log-sum-exp to get probability of category 1</span></span>
<span id="cb637-65"><a href="prototype-based-models-of-categorization.html#cb637-65" tabindex="-1"></a>    <span class="co"># Handle cases where one log_prob might be -Inf (if cov matrix was singular)</span></span>
<span id="cb637-66"><a href="prototype-based-models-of-categorization.html#cb637-66" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(log_prob_0) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.finite</span>(log_prob_1)) {</span>
<span id="cb637-67"><a href="prototype-based-models-of-categorization.html#cb637-67" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># Undefined, default to 0.5</span></span>
<span id="cb637-68"><a href="prototype-based-models-of-categorization.html#cb637-68" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(log_prob_0)) {</span>
<span id="cb637-69"><a href="prototype-based-models-of-categorization.html#cb637-69" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fl">1.0</span> <span class="co"># Only category 1 has finite probability</span></span>
<span id="cb637-70"><a href="prototype-based-models-of-categorization.html#cb637-70" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(log_prob_1)) {</span>
<span id="cb637-71"><a href="prototype-based-models-of-categorization.html#cb637-71" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fl">0.0</span> <span class="co"># Only category 0 has finite probability</span></span>
<span id="cb637-72"><a href="prototype-based-models-of-categorization.html#cb637-72" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb637-73"><a href="prototype-based-models-of-categorization.html#cb637-73" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_prob_1 <span class="sc">-</span> <span class="fu">log_sum_exp</span>(<span class="fu">c</span>(log_prob_0, log_prob_1)))</span>
<span id="cb637-74"><a href="prototype-based-models-of-categorization.html#cb637-74" tabindex="-1"></a>    }</span>
<span id="cb637-75"><a href="prototype-based-models-of-categorization.html#cb637-75" tabindex="-1"></a>    </span>
<span id="cb637-76"><a href="prototype-based-models-of-categorization.html#cb637-76" tabindex="-1"></a>    <span class="co"># Ensure probability is within bounds</span></span>
<span id="cb637-77"><a href="prototype-based-models-of-categorization.html#cb637-77" tabindex="-1"></a>    prob_cat_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">min</span>(prob_cat_1, <span class="fl">0.999</span>), <span class="fl">0.001</span>)</span>
<span id="cb637-78"><a href="prototype-based-models-of-categorization.html#cb637-78" tabindex="-1"></a>    </span>
<span id="cb637-79"><a href="prototype-based-models-of-categorization.html#cb637-79" tabindex="-1"></a>    response_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(response_probs, prob_cat_1)</span>
<span id="cb637-80"><a href="prototype-based-models-of-categorization.html#cb637-80" tabindex="-1"></a>    </span>
<span id="cb637-81"><a href="prototype-based-models-of-categorization.html#cb637-81" tabindex="-1"></a>    <span class="co"># Update prototype for the correct category after decision</span></span>
<span id="cb637-82"><a href="prototype-based-models-of-categorization.html#cb637-82" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&lt;</span> n_trials) {  <span class="co"># No need to update after the last trial</span></span>
<span id="cb637-83"><a href="prototype-based-models-of-categorization.html#cb637-83" tabindex="-1"></a>      <span class="cf">if</span> (cat_one[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb637-84"><a href="prototype-based-models-of-categorization.html#cb637-84" tabindex="-1"></a>        <span class="co"># Update category 1 prototype using revised update function</span></span>
<span id="cb637-85"><a href="prototype-based-models-of-categorization.html#cb637-85" tabindex="-1"></a>        update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb637-86"><a href="prototype-based-models-of-categorization.html#cb637-86" tabindex="-1"></a>          prototype_cat_1<span class="sc">$</span>mu, </span>
<span id="cb637-87"><a href="prototype-based-models-of-categorization.html#cb637-87" tabindex="-1"></a>          prototype_cat_1<span class="sc">$</span>sigma, </span>
<span id="cb637-88"><a href="prototype-based-models-of-categorization.html#cb637-88" tabindex="-1"></a>          current_obs, </span>
<span id="cb637-89"><a href="prototype-based-models-of-categorization.html#cb637-89" tabindex="-1"></a>          r_matrix</span>
<span id="cb637-90"><a href="prototype-based-models-of-categorization.html#cb637-90" tabindex="-1"></a>        )</span>
<span id="cb637-91"><a href="prototype-based-models-of-categorization.html#cb637-91" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb637-92"><a href="prototype-based-models-of-categorization.html#cb637-92" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb637-93"><a href="prototype-based-models-of-categorization.html#cb637-93" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb637-94"><a href="prototype-based-models-of-categorization.html#cb637-94" tabindex="-1"></a>        <span class="co"># Update category 0 prototype using revised update function</span></span>
<span id="cb637-95"><a href="prototype-based-models-of-categorization.html#cb637-95" tabindex="-1"></a>        update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb637-96"><a href="prototype-based-models-of-categorization.html#cb637-96" tabindex="-1"></a>          prototype_cat_0<span class="sc">$</span>mu, </span>
<span id="cb637-97"><a href="prototype-based-models-of-categorization.html#cb637-97" tabindex="-1"></a>          prototype_cat_0<span class="sc">$</span>sigma, </span>
<span id="cb637-98"><a href="prototype-based-models-of-categorization.html#cb637-98" tabindex="-1"></a>          current_obs, </span>
<span id="cb637-99"><a href="prototype-based-models-of-categorization.html#cb637-99" tabindex="-1"></a>          r_matrix</span>
<span id="cb637-100"><a href="prototype-based-models-of-categorization.html#cb637-100" tabindex="-1"></a>        )</span>
<span id="cb637-101"><a href="prototype-based-models-of-categorization.html#cb637-101" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb637-102"><a href="prototype-based-models-of-categorization.html#cb637-102" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb637-103"><a href="prototype-based-models-of-categorization.html#cb637-103" tabindex="-1"></a>      }</span>
<span id="cb637-104"><a href="prototype-based-models-of-categorization.html#cb637-104" tabindex="-1"></a>    }</span>
<span id="cb637-105"><a href="prototype-based-models-of-categorization.html#cb637-105" tabindex="-1"></a>  }</span>
<span id="cb637-106"><a href="prototype-based-models-of-categorization.html#cb637-106" tabindex="-1"></a>  </span>
<span id="cb637-107"><a href="prototype-based-models-of-categorization.html#cb637-107" tabindex="-1"></a>  <span class="co"># Return simulated binary responses based on calculated probabilities</span></span>
<span id="cb637-108"><a href="prototype-based-models-of-categorization.html#cb637-108" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(n_trials, <span class="dv">1</span>, response_probs))</span>
<span id="cb637-109"><a href="prototype-based-models-of-categorization.html#cb637-109" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s break down this implementation:</p>
<ol style="list-style-type: decimal">
<li><strong>Initialization</strong>:
<ul>
<li>We start with uninformative prototypes (centered at 0.5 with high uncertainty)</li>
<li>The observation noise (r_matrix) determines how much variance we expect around the prototype</li>
</ul></li>
<li><strong>Decision Process</strong>:
<ul>
<li>For each new stimulus, we calculate its Mahalanobis distance to each category’s prototype</li>
<li>The Mahalanobis distance accounts for both the prototype location and uncertainty</li>
<li>We convert these distances to probabilities using a softmax function</li>
</ul></li>
<li><strong>Prototype Update</strong>:
<ul>
<li>After each trial, we update the prototype of the correct category using the Kalman filter</li>
<li>The update moves the prototype toward the new observation and reduces uncertainty</li>
<li>The amount of movement depends on the current uncertainty level</li>
</ul></li>
<li><strong>Learning Dynamics</strong>:
<ul>
<li>Early in learning, large updates occur due to high uncertainty</li>
<li>As learning progresses, updates become smaller, stabilizing the prototypes</li>
<li>Eventually, the prototypes converge to the category centers</li>
</ul></li>
</ol>
</div>
<div id="the-observation-noise-parameter" class="section level3 hasAnchor" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> The Observation Noise Parameter<a href="prototype-based-models-of-categorization.html#the-observation-noise-parameter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Small r_value: Assumes observations are very precise; prototypes move less and become more certain quickly</li>
<li>Large r_value: Assumes observations have high variability; prototypes move more and remain uncertain longer</li>
</ul>
<p>This parameter can be interpreted as representing the learner’s assumptions about category variability or their perceptual noise.</p>
</div>
</div>
<div id="simulating-categorization-behavior-with-the-prototype-model" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Simulating Categorization Behavior with the Prototype Model<a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior-with-the-prototype-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s now simulate categorization behavior using our prototype model with the same experimental setup we used for the GCM:</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="prototype-based-models-of-categorization.html#cb638-1" tabindex="-1"></a><span class="co"># Function to simulate responses using the prototype model</span></span>
<span id="cb638-2"><a href="prototype-based-models-of-categorization.html#cb638-2" tabindex="-1"></a>simulate_prototype_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, r_value) {</span>
<span id="cb638-3"><a href="prototype-based-models-of-categorization.html#cb638-3" tabindex="-1"></a>    <span class="co"># Ensure using correct columns from experiment data</span></span>
<span id="cb638-4"><a href="prototype-based-models-of-categorization.html#cb638-4" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(experiment <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>))))</span>
<span id="cb638-5"><a href="prototype-based-models-of-categorization.html#cb638-5" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment<span class="sc">$</span>category <span class="co"># Assuming category is 0/1</span></span>
<span id="cb638-6"><a href="prototype-based-models-of-categorization.html#cb638-6" tabindex="-1"></a>    </span>
<span id="cb638-7"><a href="prototype-based-models-of-categorization.html#cb638-7" tabindex="-1"></a>    <span class="co"># Simulate responses using the REVISED prototype_kalman function</span></span>
<span id="cb638-8"><a href="prototype-based-models-of-categorization.html#cb638-8" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">prototype_kalman</span>(</span>
<span id="cb638-9"><a href="prototype-based-models-of-categorization.html#cb638-9" tabindex="-1"></a>        r_value,</span>
<span id="cb638-10"><a href="prototype-based-models-of-categorization.html#cb638-10" tabindex="-1"></a>        observations,</span>
<span id="cb638-11"><a href="prototype-based-models-of-categorization.html#cb638-11" tabindex="-1"></a>        category</span>
<span id="cb638-12"><a href="prototype-based-models-of-categorization.html#cb638-12" tabindex="-1"></a>    )</span>
<span id="cb638-13"><a href="prototype-based-models-of-categorization.html#cb638-13" tabindex="-1"></a>    </span>
<span id="cb638-14"><a href="prototype-based-models-of-categorization.html#cb638-14" tabindex="-1"></a>    <span class="co"># Record results</span></span>
<span id="cb638-15"><a href="prototype-based-models-of-categorization.html#cb638-15" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment <span class="sc">%&gt;%</span></span>
<span id="cb638-16"><a href="prototype-based-models-of-categorization.html#cb638-16" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb638-17"><a href="prototype-based-models-of-categorization.html#cb638-17" tabindex="-1"></a>            <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), <span class="co"># Ensure trial sequence is correct</span></span>
<span id="cb638-18"><a href="prototype-based-models-of-categorization.html#cb638-18" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb638-19"><a href="prototype-based-models-of-categorization.html#cb638-19" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb638-20"><a href="prototype-based-models-of-categorization.html#cb638-20" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> trial,</span>
<span id="cb638-21"><a href="prototype-based-models-of-categorization.html#cb638-21" tabindex="-1"></a>            <span class="at">r_value =</span> r_value,</span>
<span id="cb638-22"><a href="prototype-based-models-of-categorization.html#cb638-22" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb638-23"><a href="prototype-based-models-of-categorization.html#cb638-23" tabindex="-1"></a>        )</span>
<span id="cb638-24"><a href="prototype-based-models-of-categorization.html#cb638-24" tabindex="-1"></a></span>
<span id="cb638-25"><a href="prototype-based-models-of-categorization.html#cb638-25" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb638-26"><a href="prototype-based-models-of-categorization.html#cb638-26" tabindex="-1"></a>}</span>
<span id="cb638-27"><a href="prototype-based-models-of-categorization.html#cb638-27" tabindex="-1"></a></span>
<span id="cb638-28"><a href="prototype-based-models-of-categorization.html#cb638-28" tabindex="-1"></a><span class="co"># Simulate responses across different r_values</span></span>
<span id="cb638-29"><a href="prototype-based-models-of-categorization.html#cb638-29" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb638-30"><a href="prototype-based-models-of-categorization.html#cb638-30" tabindex="-1"></a></span>
<span id="cb638-31"><a href="prototype-based-models-of-categorization.html#cb638-31" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb638-32"><a href="prototype-based-models-of-categorization.html#cb638-32" tabindex="-1"></a>    <span class="fu">expand_grid</span>(</span>
<span id="cb638-33"><a href="prototype-based-models-of-categorization.html#cb638-33" tabindex="-1"></a>        <span class="at">agent =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb638-34"><a href="prototype-based-models-of-categorization.html#cb638-34" tabindex="-1"></a>        <span class="at">r_value =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">5.0</span>)</span>
<span id="cb638-35"><a href="prototype-based-models-of-categorization.html#cb638-35" tabindex="-1"></a>    )</span>
<span id="cb638-36"><a href="prototype-based-models-of-categorization.html#cb638-36" tabindex="-1"></a>)</span>
<span id="cb638-37"><a href="prototype-based-models-of-categorization.html#cb638-37" tabindex="-1"></a></span>
<span id="cb638-38"><a href="prototype-based-models-of-categorization.html#cb638-38" tabindex="-1"></a>prototype_responses <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(param_df,</span>
<span id="cb638-39"><a href="prototype-based-models-of-categorization.html#cb638-39" tabindex="-1"></a>    simulate_prototype_responses,</span>
<span id="cb638-40"><a href="prototype-based-models-of-categorization.html#cb638-40" tabindex="-1"></a>    <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb638-41"><a href="prototype-based-models-of-categorization.html#cb638-41" tabindex="-1"></a>)</span></code></pre></div>
<p>We can visualize how the observation noise parameter affects performance:</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="prototype-based-models-of-categorization.html#cb639-1" tabindex="-1"></a>prototype_responses <span class="sc">%&gt;%</span></span>
<span id="cb639-2"><a href="prototype-based-models-of-categorization.html#cb639-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r_value =</span> <span class="fu">as.factor</span>(r_value)) <span class="sc">%&gt;%</span></span>
<span id="cb639-3"><a href="prototype-based-models-of-categorization.html#cb639-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trial, performance, <span class="at">group =</span> <span class="fu">interaction</span>(agent, r_value), <span class="at">color =</span> r_value)) <span class="sc">+</span></span>
<span id="cb639-4"><a href="prototype-based-models-of-categorization.html#cb639-4" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="co"># Plot average performance</span></span>
<span id="cb639-5"><a href="prototype-based-models-of-categorization.html#cb639-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;ribbon&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> r_value)) <span class="sc">+</span> <span class="co"># Show SE ribbon</span></span>
<span id="cb639-6"><a href="prototype-based-models-of-categorization.html#cb639-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb639-7"><a href="prototype-based-models-of-categorization.html#cb639-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb639-8"><a href="prototype-based-models-of-categorization.html#cb639-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Categorization Performance with Revised Prototype Model&quot;</span>,</span>
<span id="cb639-9"><a href="prototype-based-models-of-categorization.html#cb639-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Effect of observation noise parameter (r_value)&quot;</span>,</span>
<span id="cb639-10"><a href="prototype-based-models-of-categorization.html#cb639-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb639-11"><a href="prototype-based-models-of-categorization.html#cb639-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion Correct (Average over Agents)&quot;</span>,</span>
<span id="cb639-12"><a href="prototype-based-models-of-categorization.html#cb639-12" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;r-value&quot;</span>,</span>
<span id="cb639-13"><a href="prototype-based-models-of-categorization.html#cb639-13" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;r-value&quot;</span></span>
<span id="cb639-14"><a href="prototype-based-models-of-categorization.html#cb639-14" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="series_files/figure-html/12%20visualize%20observation%20noise-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="visualizing-prototype-learning" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Visualizing Prototype Learning<a href="prototype-based-models-of-categorization.html#visualizing-prototype-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To better understand how prototypes evolve over time, let’s visualize the prototype locations and uncertainty throughout learning:</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="prototype-based-models-of-categorization.html#cb640-1" tabindex="-1"></a>track_prototypes <span class="ot">&lt;-</span> <span class="cf">function</span>(r_value, obs, cat_one) {</span>
<span id="cb640-2"><a href="prototype-based-models-of-categorization.html#cb640-2" tabindex="-1"></a>  n_trials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb640-3"><a href="prototype-based-models-of-categorization.html#cb640-3" tabindex="-1"></a>  n_features <span class="ot">&lt;-</span> <span class="fu">ncol</span>(obs)</span>
<span id="cb640-4"><a href="prototype-based-models-of-categorization.html#cb640-4" tabindex="-1"></a></span>
<span id="cb640-5"><a href="prototype-based-models-of-categorization.html#cb640-5" tabindex="-1"></a>  <span class="co"># Initialize prototypes (Aligned with simulation/Stan)</span></span>
<span id="cb640-6"><a href="prototype-based-models-of-categorization.html#cb640-6" tabindex="-1"></a>  prototype_cat_0 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb640-7"><a href="prototype-based-models-of-categorization.html#cb640-7" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features),</span>
<span id="cb640-8"><a href="prototype-based-models-of-categorization.html#cb640-8" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">10</span>, n_features)</span>
<span id="cb640-9"><a href="prototype-based-models-of-categorization.html#cb640-9" tabindex="-1"></a>  )</span>
<span id="cb640-10"><a href="prototype-based-models-of-categorization.html#cb640-10" tabindex="-1"></a></span>
<span id="cb640-11"><a href="prototype-based-models-of-categorization.html#cb640-11" tabindex="-1"></a>  prototype_cat_1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb640-12"><a href="prototype-based-models-of-categorization.html#cb640-12" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features),</span>
<span id="cb640-13"><a href="prototype-based-models-of-categorization.html#cb640-13" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">10</span>, n_features)</span>
<span id="cb640-14"><a href="prototype-based-models-of-categorization.html#cb640-14" tabindex="-1"></a>  )</span>
<span id="cb640-15"><a href="prototype-based-models-of-categorization.html#cb640-15" tabindex="-1"></a></span>
<span id="cb640-16"><a href="prototype-based-models-of-categorization.html#cb640-16" tabindex="-1"></a>  <span class="co"># Observation noise</span></span>
<span id="cb640-17"><a href="prototype-based-models-of-categorization.html#cb640-17" tabindex="-1"></a>  r_matrix <span class="ot">&lt;-</span> <span class="fu">diag</span>(r_value, n_features)</span>
<span id="cb640-18"><a href="prototype-based-models-of-categorization.html#cb640-18" tabindex="-1"></a></span>
<span id="cb640-19"><a href="prototype-based-models-of-categorization.html#cb640-19" tabindex="-1"></a>  <span class="co"># Storage for tracking prototype evolution</span></span>
<span id="cb640-20"><a href="prototype-based-models-of-categorization.html#cb640-20" tabindex="-1"></a>  prototype_history <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb640-21"><a href="prototype-based-models-of-categorization.html#cb640-21" tabindex="-1"></a>    <span class="at">trial =</span> <span class="fu">integer</span>(),</span>
<span id="cb640-22"><a href="prototype-based-models-of-categorization.html#cb640-22" tabindex="-1"></a>    <span class="at">category =</span> <span class="fu">integer</span>(),</span>
<span id="cb640-23"><a href="prototype-based-models-of-categorization.html#cb640-23" tabindex="-1"></a>    <span class="at">feature1_mean =</span> <span class="fu">numeric</span>(), <span class="co"># Corresponds to height</span></span>
<span id="cb640-24"><a href="prototype-based-models-of-categorization.html#cb640-24" tabindex="-1"></a>    <span class="at">feature2_mean =</span> <span class="fu">numeric</span>(), <span class="co"># Corresponds to position</span></span>
<span id="cb640-25"><a href="prototype-based-models-of-categorization.html#cb640-25" tabindex="-1"></a>    <span class="at">cov_matrix =</span> <span class="fu">list</span>()        <span class="co"># Store the full 2x2 covariance matrix</span></span>
<span id="cb640-26"><a href="prototype-based-models-of-categorization.html#cb640-26" tabindex="-1"></a>  )</span>
<span id="cb640-27"><a href="prototype-based-models-of-categorization.html#cb640-27" tabindex="-1"></a></span>
<span id="cb640-28"><a href="prototype-based-models-of-categorization.html#cb640-28" tabindex="-1"></a>  <span class="co"># Process each trial</span></span>
<span id="cb640-29"><a href="prototype-based-models-of-categorization.html#cb640-29" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb640-30"><a href="prototype-based-models-of-categorization.html#cb640-30" tabindex="-1"></a>    <span class="co"># Store current prototype state before update</span></span>
<span id="cb640-31"><a href="prototype-based-models-of-categorization.html#cb640-31" tabindex="-1"></a>    prototype_history <span class="ot">&lt;-</span> prototype_history <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(</span>
<span id="cb640-32"><a href="prototype-based-models-of-categorization.html#cb640-32" tabindex="-1"></a>      <span class="at">trial =</span> i,</span>
<span id="cb640-33"><a href="prototype-based-models-of-categorization.html#cb640-33" tabindex="-1"></a>      <span class="at">category =</span> <span class="dv">0</span>,</span>
<span id="cb640-34"><a href="prototype-based-models-of-categorization.html#cb640-34" tabindex="-1"></a>      <span class="at">feature1_mean =</span> prototype_cat_0<span class="sc">$</span>mu[<span class="dv">1</span>], <span class="co"># Assuming mu[1] is height</span></span>
<span id="cb640-35"><a href="prototype-based-models-of-categorization.html#cb640-35" tabindex="-1"></a>      <span class="at">feature2_mean =</span> prototype_cat_0<span class="sc">$</span>mu[<span class="dv">2</span>], <span class="co"># Assuming mu[2] is position</span></span>
<span id="cb640-36"><a href="prototype-based-models-of-categorization.html#cb640-36" tabindex="-1"></a>      <span class="at">cov_matrix =</span> <span class="fu">list</span>(prototype_cat_0<span class="sc">$</span>sigma) <span class="co"># Store the matrix</span></span>
<span id="cb640-37"><a href="prototype-based-models-of-categorization.html#cb640-37" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(</span>
<span id="cb640-38"><a href="prototype-based-models-of-categorization.html#cb640-38" tabindex="-1"></a>      <span class="at">trial =</span> i,</span>
<span id="cb640-39"><a href="prototype-based-models-of-categorization.html#cb640-39" tabindex="-1"></a>      <span class="at">category =</span> <span class="dv">1</span>,</span>
<span id="cb640-40"><a href="prototype-based-models-of-categorization.html#cb640-40" tabindex="-1"></a>      <span class="at">feature1_mean =</span> prototype_cat_1<span class="sc">$</span>mu[<span class="dv">1</span>],</span>
<span id="cb640-41"><a href="prototype-based-models-of-categorization.html#cb640-41" tabindex="-1"></a>      <span class="at">feature2_mean =</span> prototype_cat_1<span class="sc">$</span>mu[<span class="dv">2</span>],</span>
<span id="cb640-42"><a href="prototype-based-models-of-categorization.html#cb640-42" tabindex="-1"></a>      <span class="at">cov_matrix =</span> <span class="fu">list</span>(prototype_cat_1<span class="sc">$</span>sigma) <span class="co"># Store the matrix</span></span>
<span id="cb640-43"><a href="prototype-based-models-of-categorization.html#cb640-43" tabindex="-1"></a>    )</span>
<span id="cb640-44"><a href="prototype-based-models-of-categorization.html#cb640-44" tabindex="-1"></a></span>
<span id="cb640-45"><a href="prototype-based-models-of-categorization.html#cb640-45" tabindex="-1"></a>    <span class="co"># Update prototype for the correct category using REVISED update function</span></span>
<span id="cb640-46"><a href="prototype-based-models-of-categorization.html#cb640-46" tabindex="-1"></a>    <span class="co"># Use &lt;= to include update based on the last trial&#39;s feedback</span></span>
<span id="cb640-47"><a href="prototype-based-models-of-categorization.html#cb640-47" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&lt;=</span> n_trials) {</span>
<span id="cb640-48"><a href="prototype-based-models-of-categorization.html#cb640-48" tabindex="-1"></a>      current_obs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[i, ])</span>
<span id="cb640-49"><a href="prototype-based-models-of-categorization.html#cb640-49" tabindex="-1"></a>      <span class="cf">if</span> (cat_one[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb640-50"><a href="prototype-based-models-of-categorization.html#cb640-50" tabindex="-1"></a>        <span class="co"># Update category 1 prototype</span></span>
<span id="cb640-51"><a href="prototype-based-models-of-categorization.html#cb640-51" tabindex="-1"></a>        update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb640-52"><a href="prototype-based-models-of-categorization.html#cb640-52" tabindex="-1"></a>          prototype_cat_1<span class="sc">$</span>mu,</span>
<span id="cb640-53"><a href="prototype-based-models-of-categorization.html#cb640-53" tabindex="-1"></a>          prototype_cat_1<span class="sc">$</span>sigma,</span>
<span id="cb640-54"><a href="prototype-based-models-of-categorization.html#cb640-54" tabindex="-1"></a>          current_obs,</span>
<span id="cb640-55"><a href="prototype-based-models-of-categorization.html#cb640-55" tabindex="-1"></a>          r_matrix</span>
<span id="cb640-56"><a href="prototype-based-models-of-categorization.html#cb640-56" tabindex="-1"></a>        )</span>
<span id="cb640-57"><a href="prototype-based-models-of-categorization.html#cb640-57" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb640-58"><a href="prototype-based-models-of-categorization.html#cb640-58" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb640-59"><a href="prototype-based-models-of-categorization.html#cb640-59" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb640-60"><a href="prototype-based-models-of-categorization.html#cb640-60" tabindex="-1"></a>        <span class="co"># Update category 0 prototype</span></span>
<span id="cb640-61"><a href="prototype-based-models-of-categorization.html#cb640-61" tabindex="-1"></a>        update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb640-62"><a href="prototype-based-models-of-categorization.html#cb640-62" tabindex="-1"></a>          prototype_cat_0<span class="sc">$</span>mu,</span>
<span id="cb640-63"><a href="prototype-based-models-of-categorization.html#cb640-63" tabindex="-1"></a>          prototype_cat_0<span class="sc">$</span>sigma,</span>
<span id="cb640-64"><a href="prototype-based-models-of-categorization.html#cb640-64" tabindex="-1"></a>          current_obs,</span>
<span id="cb640-65"><a href="prototype-based-models-of-categorization.html#cb640-65" tabindex="-1"></a>          r_matrix</span>
<span id="cb640-66"><a href="prototype-based-models-of-categorization.html#cb640-66" tabindex="-1"></a>        )</span>
<span id="cb640-67"><a href="prototype-based-models-of-categorization.html#cb640-67" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb640-68"><a href="prototype-based-models-of-categorization.html#cb640-68" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb640-69"><a href="prototype-based-models-of-categorization.html#cb640-69" tabindex="-1"></a>      }</span>
<span id="cb640-70"><a href="prototype-based-models-of-categorization.html#cb640-70" tabindex="-1"></a>    }</span>
<span id="cb640-71"><a href="prototype-based-models-of-categorization.html#cb640-71" tabindex="-1"></a>  }</span>
<span id="cb640-72"><a href="prototype-based-models-of-categorization.html#cb640-72" tabindex="-1"></a></span>
<span id="cb640-73"><a href="prototype-based-models-of-categorization.html#cb640-73" tabindex="-1"></a>  <span class="co"># Add final state after last update (state at trial n_trials + 1)</span></span>
<span id="cb640-74"><a href="prototype-based-models-of-categorization.html#cb640-74" tabindex="-1"></a>    prototype_history <span class="ot">&lt;-</span> prototype_history <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(</span>
<span id="cb640-75"><a href="prototype-based-models-of-categorization.html#cb640-75" tabindex="-1"></a>      <span class="at">trial =</span> n_trials <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb640-76"><a href="prototype-based-models-of-categorization.html#cb640-76" tabindex="-1"></a>      <span class="at">category =</span> <span class="dv">0</span>,</span>
<span id="cb640-77"><a href="prototype-based-models-of-categorization.html#cb640-77" tabindex="-1"></a>      <span class="at">feature1_mean =</span> prototype_cat_0<span class="sc">$</span>mu[<span class="dv">1</span>],</span>
<span id="cb640-78"><a href="prototype-based-models-of-categorization.html#cb640-78" tabindex="-1"></a>      <span class="at">feature2_mean =</span> prototype_cat_0<span class="sc">$</span>mu[<span class="dv">2</span>],</span>
<span id="cb640-79"><a href="prototype-based-models-of-categorization.html#cb640-79" tabindex="-1"></a>      <span class="at">cov_matrix =</span> <span class="fu">list</span>(prototype_cat_0<span class="sc">$</span>sigma)</span>
<span id="cb640-80"><a href="prototype-based-models-of-categorization.html#cb640-80" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(</span>
<span id="cb640-81"><a href="prototype-based-models-of-categorization.html#cb640-81" tabindex="-1"></a>      <span class="at">trial =</span> n_trials <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb640-82"><a href="prototype-based-models-of-categorization.html#cb640-82" tabindex="-1"></a>      <span class="at">category =</span> <span class="dv">1</span>,</span>
<span id="cb640-83"><a href="prototype-based-models-of-categorization.html#cb640-83" tabindex="-1"></a>      <span class="at">feature1_mean =</span> prototype_cat_1<span class="sc">$</span>mu[<span class="dv">1</span>],</span>
<span id="cb640-84"><a href="prototype-based-models-of-categorization.html#cb640-84" tabindex="-1"></a>      <span class="at">feature2_mean =</span> prototype_cat_1<span class="sc">$</span>mu[<span class="dv">2</span>],</span>
<span id="cb640-85"><a href="prototype-based-models-of-categorization.html#cb640-85" tabindex="-1"></a>      <span class="at">cov_matrix =</span> <span class="fu">list</span>(prototype_cat_1<span class="sc">$</span>sigma)</span>
<span id="cb640-86"><a href="prototype-based-models-of-categorization.html#cb640-86" tabindex="-1"></a>    )</span>
<span id="cb640-87"><a href="prototype-based-models-of-categorization.html#cb640-87" tabindex="-1"></a></span>
<span id="cb640-88"><a href="prototype-based-models-of-categorization.html#cb640-88" tabindex="-1"></a>  <span class="fu">return</span>(prototype_history)</span>
<span id="cb640-89"><a href="prototype-based-models-of-categorization.html#cb640-89" tabindex="-1"></a>}</span>
<span id="cb640-90"><a href="prototype-based-models-of-categorization.html#cb640-90" tabindex="-1"></a></span>
<span id="cb640-91"><a href="prototype-based-models-of-categorization.html#cb640-91" tabindex="-1"></a><span class="co"># Track prototypes for visualization (using the actual experiment data)</span></span>
<span id="cb640-92"><a href="prototype-based-models-of-categorization.html#cb640-92" tabindex="-1"></a><span class="co"># Determine number of trials from experiment data if possible, otherwise use nrow(obs)</span></span>
<span id="cb640-93"><a href="prototype-based-models-of-categorization.html#cb640-93" tabindex="-1"></a>n_trials_actual <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="st">&quot;id&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(experiment)) <span class="fu">max</span>(experiment<span class="sc">$</span>id) <span class="cf">else</span> <span class="fu">nrow</span>(experiment)</span>
<span id="cb640-94"><a href="prototype-based-models-of-categorization.html#cb640-94" tabindex="-1"></a></span>
<span id="cb640-95"><a href="prototype-based-models-of-categorization.html#cb640-95" tabindex="-1"></a>prototype_trajectory <span class="ot">&lt;-</span> <span class="fu">track_prototypes</span>(</span>
<span id="cb640-96"><a href="prototype-based-models-of-categorization.html#cb640-96" tabindex="-1"></a>  <span class="at">r_value =</span> <span class="fl">1.0</span>, <span class="co"># Example r_value</span></span>
<span id="cb640-97"><a href="prototype-based-models-of-categorization.html#cb640-97" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb640-98"><a href="prototype-based-models-of-categorization.html#cb640-98" tabindex="-1"></a>  <span class="at">cat_one =</span> experiment<span class="sc">$</span>category</span>
<span id="cb640-99"><a href="prototype-based-models-of-categorization.html#cb640-99" tabindex="-1"></a>)</span>
<span id="cb640-100"><a href="prototype-based-models-of-categorization.html#cb640-100" tabindex="-1"></a></span>
<span id="cb640-101"><a href="prototype-based-models-of-categorization.html#cb640-101" tabindex="-1"></a><span class="co"># Helper function to create ellipse data from mean and covariance</span></span>
<span id="cb640-102"><a href="prototype-based-models-of-categorization.html#cb640-102" tabindex="-1"></a><span class="co"># Requires the ellipse package</span></span>
<span id="cb640-103"><a href="prototype-based-models-of-categorization.html#cb640-103" tabindex="-1"></a>get_ellipse <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, <span class="at">level =</span> <span class="fl">0.68</span>) {</span>
<span id="cb640-104"><a href="prototype-based-models-of-categorization.html#cb640-104" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;ellipse&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb640-105"><a href="prototype-based-models-of-categorization.html#cb640-105" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">&quot;Package &#39;ellipse&#39; needed for detailed uncertainty ellipses. Install it via install.packages(&#39;ellipse&#39;).&quot;</span>)</span>
<span id="cb640-106"><a href="prototype-based-models-of-categorization.html#cb640-106" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>) <span class="co"># Return NULL if package not available</span></span>
<span id="cb640-107"><a href="prototype-based-models-of-categorization.html#cb640-107" tabindex="-1"></a>  }</span>
<span id="cb640-108"><a href="prototype-based-models-of-categorization.html#cb640-108" tabindex="-1"></a>  <span class="co"># Ensure mu is numeric vector and sigma is matrix</span></span>
<span id="cb640-109"><a href="prototype-based-models-of-categorization.html#cb640-109" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mu)</span>
<span id="cb640-110"><a href="prototype-based-models-of-categorization.html#cb640-110" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sigma)</span>
<span id="cb640-111"><a href="prototype-based-models-of-categorization.html#cb640-111" tabindex="-1"></a>  <span class="co"># Check dimensions</span></span>
<span id="cb640-112"><a href="prototype-based-models-of-categorization.html#cb640-112" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(mu) <span class="sc">!=</span> <span class="dv">2</span> <span class="sc">||</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">dim</span>(sigma) <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))) {</span>
<span id="cb640-113"><a href="prototype-based-models-of-categorization.html#cb640-113" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">&quot;Ellipse plotting requires 2D mean vector and 2x2 covariance matrix.&quot;</span>)</span>
<span id="cb640-114"><a href="prototype-based-models-of-categorization.html#cb640-114" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb640-115"><a href="prototype-based-models-of-categorization.html#cb640-115" tabindex="-1"></a>  }</span>
<span id="cb640-116"><a href="prototype-based-models-of-categorization.html#cb640-116" tabindex="-1"></a>  <span class="co"># Ensure covariance is positive definite for ellipse calculation</span></span>
<span id="cb640-117"><a href="prototype-based-models-of-categorization.html#cb640-117" tabindex="-1"></a>  <span class="co"># Add small jitter if needed</span></span>
<span id="cb640-118"><a href="prototype-based-models-of-categorization.html#cb640-118" tabindex="-1"></a>  eigen_vals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb640-119"><a href="prototype-based-models-of-categorization.html#cb640-119" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(eigen_vals <span class="sc">&lt;=</span> <span class="fl">1e-6</span>)) {</span>
<span id="cb640-120"><a href="prototype-based-models-of-categorization.html#cb640-120" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">&quot;Covariance matrix may not be positive definite for ellipse plotting. Adding jitter.&quot;</span>)</span>
<span id="cb640-121"><a href="prototype-based-models-of-categorization.html#cb640-121" tabindex="-1"></a>      sigma <span class="ot">&lt;-</span> sigma <span class="sc">+</span> <span class="fu">diag</span>(<span class="fu">ncol</span>(sigma)) <span class="sc">*</span> <span class="fl">1e-6</span></span>
<span id="cb640-122"><a href="prototype-based-models-of-categorization.html#cb640-122" tabindex="-1"></a>  }</span>
<span id="cb640-123"><a href="prototype-based-models-of-categorization.html#cb640-123" tabindex="-1"></a></span>
<span id="cb640-124"><a href="prototype-based-models-of-categorization.html#cb640-124" tabindex="-1"></a>  <span class="co"># Calculate points on the ellipse boundary</span></span>
<span id="cb640-125"><a href="prototype-based-models-of-categorization.html#cb640-125" tabindex="-1"></a>  ellipse_points <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(ellipse<span class="sc">::</span><span class="fu">ellipse</span>(sigma, <span class="at">centre =</span> mu, <span class="at">level =</span> level),</span>
<span id="cb640-126"><a href="prototype-based-models-of-categorization.html#cb640-126" tabindex="-1"></a>                             <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb640-127"><a href="prototype-based-models-of-categorization.html#cb640-127" tabindex="-1"></a>                                 <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Ellipse calculation failed:&quot;</span>, e<span class="sc">$</span>message))</span>
<span id="cb640-128"><a href="prototype-based-models-of-categorization.html#cb640-128" tabindex="-1"></a>                                 <span class="cn">NULL</span></span>
<span id="cb640-129"><a href="prototype-based-models-of-categorization.html#cb640-129" tabindex="-1"></a>                             })</span>
<span id="cb640-130"><a href="prototype-based-models-of-categorization.html#cb640-130" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(ellipse_points)) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb640-131"><a href="prototype-based-models-of-categorization.html#cb640-131" tabindex="-1"></a>  <span class="co"># Convert to data frame with expected names (feature1=height, feature2=position)</span></span>
<span id="cb640-132"><a href="prototype-based-models-of-categorization.html#cb640-132" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(ellipse_points) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;feature1_mean&quot;</span>, <span class="st">&quot;feature2_mean&quot;</span>)) <span class="co"># Ensure names match plot aesthetics</span></span>
<span id="cb640-133"><a href="prototype-based-models-of-categorization.html#cb640-133" tabindex="-1"></a>}</span>
<span id="cb640-134"><a href="prototype-based-models-of-categorization.html#cb640-134" tabindex="-1"></a></span>
<span id="cb640-135"><a href="prototype-based-models-of-categorization.html#cb640-135" tabindex="-1"></a></span>
<span id="cb640-136"><a href="prototype-based-models-of-categorization.html#cb640-136" tabindex="-1"></a><span class="co"># Visualize prototype evolution</span></span>
<span id="cb640-137"><a href="prototype-based-models-of-categorization.html#cb640-137" tabindex="-1"></a><span class="co"># Get final prototype states</span></span>
<span id="cb640-138"><a href="prototype-based-models-of-categorization.html#cb640-138" tabindex="-1"></a>final_prototypes <span class="ot">&lt;-</span> prototype_trajectory <span class="sc">%&gt;%</span> <span class="fu">filter</span>(trial <span class="sc">==</span> <span class="fu">max</span>(trial))</span>
<span id="cb640-139"><a href="prototype-based-models-of-categorization.html#cb640-139" tabindex="-1"></a></span>
<span id="cb640-140"><a href="prototype-based-models-of-categorization.html#cb640-140" tabindex="-1"></a><span class="co"># Create ellipse data for final states</span></span>
<span id="cb640-141"><a href="prototype-based-models-of-categorization.html#cb640-141" tabindex="-1"></a><span class="co"># Use rowwise and list columns carefully</span></span>
<span id="cb640-142"><a href="prototype-based-models-of-categorization.html#cb640-142" tabindex="-1"></a>ellipse_data_list <span class="ot">&lt;-</span> final_prototypes <span class="sc">%&gt;%</span></span>
<span id="cb640-143"><a href="prototype-based-models-of-categorization.html#cb640-143" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb640-144"><a href="prototype-based-models-of-categorization.html#cb640-144" tabindex="-1"></a>  <span class="co"># Pass mu in the order expected by get_ellipse (feature1=height, feature2=position)</span></span>
<span id="cb640-145"><a href="prototype-based-models-of-categorization.html#cb640-145" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ellipse_df =</span> <span class="fu">list</span>(<span class="fu">get_ellipse</span>(<span class="fu">c</span>(feature1_mean, feature2_mean), cov_matrix[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb640-146"><a href="prototype-based-models-of-categorization.html#cb640-146" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb640-147"><a href="prototype-based-models-of-categorization.html#cb640-147" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(category, ellipse_df) <span class="sc">%&gt;%</span></span>
<span id="cb640-148"><a href="prototype-based-models-of-categorization.html#cb640-148" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">sapply</span>(ellipse_df, is.null)) <span class="co"># Remove rows where ellipse failed</span></span>
<span id="cb640-149"><a href="prototype-based-models-of-categorization.html#cb640-149" tabindex="-1"></a></span>
<span id="cb640-150"><a href="prototype-based-models-of-categorization.html#cb640-150" tabindex="-1"></a><span class="co"># Check if ellipse data was successfully generated</span></span>
<span id="cb640-151"><a href="prototype-based-models-of-categorization.html#cb640-151" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(ellipse_data_list) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb640-152"><a href="prototype-based-models-of-categorization.html#cb640-152" tabindex="-1"></a>    ellipse_data_unnested <span class="ot">&lt;-</span> ellipse_data_list <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(ellipse_df)</span>
<span id="cb640-153"><a href="prototype-based-models-of-categorization.html#cb640-153" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb640-154"><a href="prototype-based-models-of-categorization.html#cb640-154" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">&quot;Could not generate ellipse data for plotting.&quot;</span>)</span>
<span id="cb640-155"><a href="prototype-based-models-of-categorization.html#cb640-155" tabindex="-1"></a>    ellipse_data_unnested <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Set to NULL if empty</span></span>
<span id="cb640-156"><a href="prototype-based-models-of-categorization.html#cb640-156" tabindex="-1"></a>}</span>
<span id="cb640-157"><a href="prototype-based-models-of-categorization.html#cb640-157" tabindex="-1"></a></span>
<span id="cb640-158"><a href="prototype-based-models-of-categorization.html#cb640-158" tabindex="-1"></a></span>
<span id="cb640-159"><a href="prototype-based-models-of-categorization.html#cb640-159" tabindex="-1"></a><span class="co"># Base plot</span></span>
<span id="cb640-160"><a href="prototype-based-models-of-categorization.html#cb640-160" tabindex="-1"></a>p_trajectory <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb640-161"><a href="prototype-based-models-of-categorization.html#cb640-161" tabindex="-1"></a>  <span class="co"># Plot stimuli</span></span>
<span id="cb640-162"><a href="prototype-based-models-of-categorization.html#cb640-162" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> stimuli,</span>
<span id="cb640-163"><a href="prototype-based-models-of-categorization.html#cb640-163" tabindex="-1"></a>             <span class="fu">aes</span>(position, height, <span class="at">color =</span> <span class="fu">as.factor</span>(category)),</span>
<span id="cb640-164"><a href="prototype-based-models-of-categorization.html#cb640-164" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb640-165"><a href="prototype-based-models-of-categorization.html#cb640-165" tabindex="-1"></a></span>
<span id="cb640-166"><a href="prototype-based-models-of-categorization.html#cb640-166" tabindex="-1"></a>  <span class="co"># Plot prototype trajectory (path during trials 1 to n_trials)</span></span>
<span id="cb640-167"><a href="prototype-based-models-of-categorization.html#cb640-167" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> prototype_trajectory <span class="sc">%&gt;%</span> <span class="fu">filter</span>(trial <span class="sc">&lt;=</span> n_trials_actual), <span class="co"># Use actual number of trials</span></span>
<span id="cb640-168"><a href="prototype-based-models-of-categorization.html#cb640-168" tabindex="-1"></a>            <span class="fu">aes</span>(feature2_mean, feature1_mean, <span class="at">group =</span> category, <span class="at">color =</span> <span class="fu">as.factor</span>(category)),</span>
<span id="cb640-169"><a href="prototype-based-models-of-categorization.html#cb640-169" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;inches&quot;</span>))) <span class="sc">+</span></span>
<span id="cb640-170"><a href="prototype-based-models-of-categorization.html#cb640-170" tabindex="-1"></a></span>
<span id="cb640-171"><a href="prototype-based-models-of-categorization.html#cb640-171" tabindex="-1"></a>  <span class="co"># Plot final prototype means (state after last trial)</span></span>
<span id="cb640-172"><a href="prototype-based-models-of-categorization.html#cb640-172" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> final_prototypes,</span>
<span id="cb640-173"><a href="prototype-based-models-of-categorization.html#cb640-173" tabindex="-1"></a>             <span class="fu">aes</span>(feature2_mean, feature1_mean, <span class="at">color =</span> <span class="fu">as.factor</span>(category)),</span>
<span id="cb640-174"><a href="prototype-based-models-of-categorization.html#cb640-174" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb640-175"><a href="prototype-based-models-of-categorization.html#cb640-175" tabindex="-1"></a></span>
<span id="cb640-176"><a href="prototype-based-models-of-categorization.html#cb640-176" tabindex="-1"></a>  <span class="co"># Labels and theme</span></span>
<span id="cb640-177"><a href="prototype-based-models-of-categorization.html#cb640-177" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb640-178"><a href="prototype-based-models-of-categorization.html#cb640-178" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb640-179"><a href="prototype-based-models-of-categorization.html#cb640-179" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prototype Learning with Kalman Filter (Revised)&quot;</span>,</span>
<span id="cb640-180"><a href="prototype-based-models-of-categorization.html#cb640-180" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Dashed lines show prototype trajectory, ellipses show final 68% uncertainty&quot;</span>,</span>
<span id="cb640-181"><a href="prototype-based-models-of-categorization.html#cb640-181" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Position&quot;</span>,</span>
<span id="cb640-182"><a href="prototype-based-models-of-categorization.html#cb640-182" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Height&quot;</span></span>
<span id="cb640-183"><a href="prototype-based-models-of-categorization.html#cb640-183" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb640-184"><a href="prototype-based-models-of-categorization.html#cb640-184" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb640-185"><a href="prototype-based-models-of-categorization.html#cb640-185" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(stimuli<span class="sc">$</span>position, prototype_trajectory<span class="sc">$</span>feature2_mean, <span class="at">na.rm=</span>T),</span>
<span id="cb640-186"><a href="prototype-based-models-of-categorization.html#cb640-186" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(stimuli<span class="sc">$</span>height, prototype_trajectory<span class="sc">$</span>feature1_mean, <span class="at">na.rm=</span>T))</span>
<span id="cb640-187"><a href="prototype-based-models-of-categorization.html#cb640-187" tabindex="-1"></a></span>
<span id="cb640-188"><a href="prototype-based-models-of-categorization.html#cb640-188" tabindex="-1"></a><span class="co"># Add ellipses if data exists</span></span>
<span id="cb640-189"><a href="prototype-based-models-of-categorization.html#cb640-189" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ellipse_data_unnested)) {</span>
<span id="cb640-190"><a href="prototype-based-models-of-categorization.html#cb640-190" tabindex="-1"></a>  <span class="co"># Plot ellipses using geom_path, mapping x to feature2_mean and y to feature1_mean</span></span>
<span id="cb640-191"><a href="prototype-based-models-of-categorization.html#cb640-191" tabindex="-1"></a>  p_trajectory <span class="ot">&lt;-</span> p_trajectory <span class="sc">+</span></span>
<span id="cb640-192"><a href="prototype-based-models-of-categorization.html#cb640-192" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="at">data =</span> ellipse_data_unnested, <span class="fu">aes</span>(feature2_mean, feature1_mean, <span class="at">color =</span> <span class="fu">as.factor</span>(category)), <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb640-193"><a href="prototype-based-models-of-categorization.html#cb640-193" tabindex="-1"></a>}</span>
<span id="cb640-194"><a href="prototype-based-models-of-categorization.html#cb640-194" tabindex="-1"></a></span>
<span id="cb640-195"><a href="prototype-based-models-of-categorization.html#cb640-195" tabindex="-1"></a><span class="co"># Print the final plot</span></span>
<span id="cb640-196"><a href="prototype-based-models-of-categorization.html#cb640-196" tabindex="-1"></a><span class="fu">print</span>(p_trajectory)</span></code></pre></div>
<p><img src="series_files/figure-html/12%20visualizing%20prorotype%20learning-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This visualization shows:
1. The stimulus space with actual category members
2. The trajectory of each prototype as it updates with new observations
3. The final prototype locations with uncertainty ellipses</p>
<p>Notice how the prototypes start at (2.5,2.5) and gradually move toward the center of each category. The uncertainty ellipses show the model’s confidence about each prototype’s location.</p>
</div>
<div id="comparing-prototype-and-exemplar-models" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Comparing Prototype and Exemplar Models<a href="prototype-based-models-of-categorization.html#comparing-prototype-and-exemplar-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To directly compare the prototype (Kalman filter) model with the exemplar (GCM) model, we can:</p>
<ol style="list-style-type: decimal">
<li>Fit both models to the same data</li>
<li>Compare their fit using methods like LOO-CV</li>
<li>Analyze which model better captures human categorization patterns</li>
</ol>
<p>One way to visualize the difference between these models is to look at their decision boundaries:</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="prototype-based-models-of-categorization.html#cb641-1" tabindex="-1"></a><span class="co"># Create a grid of points in the stimulus space</span></span>
<span id="cb641-2"><a href="prototype-based-models-of-categorization.html#cb641-2" tabindex="-1"></a>grid_points <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb641-3"><a href="prototype-based-models-of-categorization.html#cb641-3" tabindex="-1"></a>  <span class="at">position =</span> <span class="fu">seq</span>(<span class="fu">min</span>(stimuli<span class="sc">$</span>position) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="fu">max</span>(stimuli<span class="sc">$</span>position) <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb641-4"><a href="prototype-based-models-of-categorization.html#cb641-4" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">seq</span>(<span class="fu">min</span>(stimuli<span class="sc">$</span>height) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="fu">max</span>(stimuli<span class="sc">$</span>height) <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb641-5"><a href="prototype-based-models-of-categorization.html#cb641-5" tabindex="-1"></a>)</span>
<span id="cb641-6"><a href="prototype-based-models-of-categorization.html#cb641-6" tabindex="-1"></a></span>
<span id="cb641-7"><a href="prototype-based-models-of-categorization.html#cb641-7" tabindex="-1"></a><span class="co"># Function to get prototype model predictions for grid points</span></span>
<span id="cb641-8"><a href="prototype-based-models-of-categorization.html#cb641-8" tabindex="-1"></a>get_prototype_predictions <span class="ot">&lt;-</span> <span class="cf">function</span>(r_value, training_obs, training_cat) {</span>
<span id="cb641-9"><a href="prototype-based-models-of-categorization.html#cb641-9" tabindex="-1"></a>  <span class="co"># Train the model on observed data</span></span>
<span id="cb641-10"><a href="prototype-based-models-of-categorization.html#cb641-10" tabindex="-1"></a>  n_features <span class="ot">&lt;-</span> <span class="fu">ncol</span>(training_obs)</span>
<span id="cb641-11"><a href="prototype-based-models-of-categorization.html#cb641-11" tabindex="-1"></a>  n_trials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(training_obs)</span>
<span id="cb641-12"><a href="prototype-based-models-of-categorization.html#cb641-12" tabindex="-1"></a>  </span>
<span id="cb641-13"><a href="prototype-based-models-of-categorization.html#cb641-13" tabindex="-1"></a>  <span class="co"># Initialize prototypes</span></span>
<span id="cb641-14"><a href="prototype-based-models-of-categorization.html#cb641-14" tabindex="-1"></a>  prototype_cat_0 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb641-15"><a href="prototype-based-models-of-categorization.html#cb641-15" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features),</span>
<span id="cb641-16"><a href="prototype-based-models-of-categorization.html#cb641-16" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">10</span>, n_features)</span>
<span id="cb641-17"><a href="prototype-based-models-of-categorization.html#cb641-17" tabindex="-1"></a>  )</span>
<span id="cb641-18"><a href="prototype-based-models-of-categorization.html#cb641-18" tabindex="-1"></a>  </span>
<span id="cb641-19"><a href="prototype-based-models-of-categorization.html#cb641-19" tabindex="-1"></a>  prototype_cat_1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb641-20"><a href="prototype-based-models-of-categorization.html#cb641-20" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features),</span>
<span id="cb641-21"><a href="prototype-based-models-of-categorization.html#cb641-21" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">10</span>, n_features)</span>
<span id="cb641-22"><a href="prototype-based-models-of-categorization.html#cb641-22" tabindex="-1"></a>  )</span>
<span id="cb641-23"><a href="prototype-based-models-of-categorization.html#cb641-23" tabindex="-1"></a>  </span>
<span id="cb641-24"><a href="prototype-based-models-of-categorization.html#cb641-24" tabindex="-1"></a>  <span class="co"># Observation noise</span></span>
<span id="cb641-25"><a href="prototype-based-models-of-categorization.html#cb641-25" tabindex="-1"></a>  r_matrix <span class="ot">&lt;-</span> <span class="fu">diag</span>(r_value, n_features)</span>
<span id="cb641-26"><a href="prototype-based-models-of-categorization.html#cb641-26" tabindex="-1"></a>  </span>
<span id="cb641-27"><a href="prototype-based-models-of-categorization.html#cb641-27" tabindex="-1"></a>  <span class="co"># Train model on observed data</span></span>
<span id="cb641-28"><a href="prototype-based-models-of-categorization.html#cb641-28" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb641-29"><a href="prototype-based-models-of-categorization.html#cb641-29" tabindex="-1"></a>    <span class="cf">if</span> (training_cat[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb641-30"><a href="prototype-based-models-of-categorization.html#cb641-30" tabindex="-1"></a>      <span class="co"># Update category 1 prototype</span></span>
<span id="cb641-31"><a href="prototype-based-models-of-categorization.html#cb641-31" tabindex="-1"></a>      update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb641-32"><a href="prototype-based-models-of-categorization.html#cb641-32" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>mu, </span>
<span id="cb641-33"><a href="prototype-based-models-of-categorization.html#cb641-33" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>sigma, </span>
<span id="cb641-34"><a href="prototype-based-models-of-categorization.html#cb641-34" tabindex="-1"></a>        <span class="fu">as.numeric</span>(training_obs[i, ]), </span>
<span id="cb641-35"><a href="prototype-based-models-of-categorization.html#cb641-35" tabindex="-1"></a>        r_matrix</span>
<span id="cb641-36"><a href="prototype-based-models-of-categorization.html#cb641-36" tabindex="-1"></a>      )</span>
<span id="cb641-37"><a href="prototype-based-models-of-categorization.html#cb641-37" tabindex="-1"></a>      prototype_cat_1<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb641-38"><a href="prototype-based-models-of-categorization.html#cb641-38" tabindex="-1"></a>      prototype_cat_1<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb641-39"><a href="prototype-based-models-of-categorization.html#cb641-39" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb641-40"><a href="prototype-based-models-of-categorization.html#cb641-40" tabindex="-1"></a>      <span class="co"># Update category 0 prototype</span></span>
<span id="cb641-41"><a href="prototype-based-models-of-categorization.html#cb641-41" tabindex="-1"></a>      update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb641-42"><a href="prototype-based-models-of-categorization.html#cb641-42" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>mu, </span>
<span id="cb641-43"><a href="prototype-based-models-of-categorization.html#cb641-43" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>sigma, </span>
<span id="cb641-44"><a href="prototype-based-models-of-categorization.html#cb641-44" tabindex="-1"></a>        <span class="fu">as.numeric</span>(training_obs[i, ]), </span>
<span id="cb641-45"><a href="prototype-based-models-of-categorization.html#cb641-45" tabindex="-1"></a>        r_matrix</span>
<span id="cb641-46"><a href="prototype-based-models-of-categorization.html#cb641-46" tabindex="-1"></a>      )</span>
<span id="cb641-47"><a href="prototype-based-models-of-categorization.html#cb641-47" tabindex="-1"></a>      prototype_cat_0<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb641-48"><a href="prototype-based-models-of-categorization.html#cb641-48" tabindex="-1"></a>      prototype_cat_0<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb641-49"><a href="prototype-based-models-of-categorization.html#cb641-49" tabindex="-1"></a>    }</span>
<span id="cb641-50"><a href="prototype-based-models-of-categorization.html#cb641-50" tabindex="-1"></a>  }</span>
<span id="cb641-51"><a href="prototype-based-models-of-categorization.html#cb641-51" tabindex="-1"></a>  </span>
<span id="cb641-52"><a href="prototype-based-models-of-categorization.html#cb641-52" tabindex="-1"></a>  <span class="co"># Get predictions for grid points</span></span>
<span id="cb641-53"><a href="prototype-based-models-of-categorization.html#cb641-53" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(grid_points), <span class="dv">1</span>, <span class="cf">function</span>(point) {</span>
<span id="cb641-54"><a href="prototype-based-models-of-categorization.html#cb641-54" tabindex="-1"></a>    <span class="co"># Calculate distances to prototypes</span></span>
<span id="cb641-55"><a href="prototype-based-models-of-categorization.html#cb641-55" tabindex="-1"></a>    sigma_cat_0 <span class="ot">&lt;-</span> prototype_cat_0<span class="sc">$</span>sigma <span class="sc">+</span> r_matrix</span>
<span id="cb641-56"><a href="prototype-based-models-of-categorization.html#cb641-56" tabindex="-1"></a>    dist_cat_0 <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(point, prototype_cat_0<span class="sc">$</span>mu, <span class="fu">solve</span>(sigma_cat_0))</span>
<span id="cb641-57"><a href="prototype-based-models-of-categorization.html#cb641-57" tabindex="-1"></a>    </span>
<span id="cb641-58"><a href="prototype-based-models-of-categorization.html#cb641-58" tabindex="-1"></a>    sigma_cat_1 <span class="ot">&lt;-</span> prototype_cat_1<span class="sc">$</span>sigma <span class="sc">+</span> r_matrix</span>
<span id="cb641-59"><a href="prototype-based-models-of-categorization.html#cb641-59" tabindex="-1"></a>    dist_cat_1 <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(point, prototype_cat_1<span class="sc">$</span>mu, <span class="fu">solve</span>(sigma_cat_1))</span>
<span id="cb641-60"><a href="prototype-based-models-of-categorization.html#cb641-60" tabindex="-1"></a>    </span>
<span id="cb641-61"><a href="prototype-based-models-of-categorization.html#cb641-61" tabindex="-1"></a>    <span class="co"># Convert to probability</span></span>
<span id="cb641-62"><a href="prototype-based-models-of-categorization.html#cb641-62" tabindex="-1"></a>    prob_cat_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> dist_cat_1) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> dist_cat_0) <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> dist_cat_1))</span>
<span id="cb641-63"><a href="prototype-based-models-of-categorization.html#cb641-63" tabindex="-1"></a>    <span class="fu">return</span>(prob_cat_1)</span>
<span id="cb641-64"><a href="prototype-based-models-of-categorization.html#cb641-64" tabindex="-1"></a>  })</span>
<span id="cb641-65"><a href="prototype-based-models-of-categorization.html#cb641-65" tabindex="-1"></a>  </span>
<span id="cb641-66"><a href="prototype-based-models-of-categorization.html#cb641-66" tabindex="-1"></a>  <span class="fu">return</span>(predictions)</span>
<span id="cb641-67"><a href="prototype-based-models-of-categorization.html#cb641-67" tabindex="-1"></a>}</span>
<span id="cb641-68"><a href="prototype-based-models-of-categorization.html#cb641-68" tabindex="-1"></a></span>
<span id="cb641-69"><a href="prototype-based-models-of-categorization.html#cb641-69" tabindex="-1"></a><span class="co"># Function to get GCM predictions for grid points</span></span>
<span id="cb641-70"><a href="prototype-based-models-of-categorization.html#cb641-70" tabindex="-1"></a>get_gcm_predictions <span class="ot">&lt;-</span> <span class="cf">function</span>(w, c, training_obs, training_cat) {</span>
<span id="cb641-71"><a href="prototype-based-models-of-categorization.html#cb641-71" tabindex="-1"></a>  <span class="co"># Get predictions for grid points</span></span>
<span id="cb641-72"><a href="prototype-based-models-of-categorization.html#cb641-72" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(grid_points), <span class="dv">1</span>, <span class="cf">function</span>(point) {</span>
<span id="cb641-73"><a href="prototype-based-models-of-categorization.html#cb641-73" tabindex="-1"></a>    similarities <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(training_obs))</span>
<span id="cb641-74"><a href="prototype-based-models-of-categorization.html#cb641-74" tabindex="-1"></a>    </span>
<span id="cb641-75"><a href="prototype-based-models-of-categorization.html#cb641-75" tabindex="-1"></a>    <span class="co"># Calculate similarity to all training exemplars</span></span>
<span id="cb641-76"><a href="prototype-based-models-of-categorization.html#cb641-76" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(training_obs)) {</span>
<span id="cb641-77"><a href="prototype-based-models-of-categorization.html#cb641-77" tabindex="-1"></a>      sim <span class="ot">&lt;-</span> <span class="fu">similarity</span>(<span class="fu">distance</span>(point, <span class="fu">as.numeric</span>(training_obs[i,]), w), c)</span>
<span id="cb641-78"><a href="prototype-based-models-of-categorization.html#cb641-78" tabindex="-1"></a>      similarities[i] <span class="ot">&lt;-</span> sim</span>
<span id="cb641-79"><a href="prototype-based-models-of-categorization.html#cb641-79" tabindex="-1"></a>    }</span>
<span id="cb641-80"><a href="prototype-based-models-of-categorization.html#cb641-80" tabindex="-1"></a>    </span>
<span id="cb641-81"><a href="prototype-based-models-of-categorization.html#cb641-81" tabindex="-1"></a>    <span class="co"># Calculate probability of category 1</span></span>
<span id="cb641-82"><a href="prototype-based-models-of-categorization.html#cb641-82" tabindex="-1"></a>    numerator <span class="ot">&lt;-</span> <span class="fu">mean</span>(similarities[training_cat <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb641-83"><a href="prototype-based-models-of-categorization.html#cb641-83" tabindex="-1"></a>    denominator <span class="ot">&lt;-</span> <span class="fu">mean</span>(similarities[training_cat <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">mean</span>(similarities[training_cat <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb641-84"><a href="prototype-based-models-of-categorization.html#cb641-84" tabindex="-1"></a>    </span>
<span id="cb641-85"><a href="prototype-based-models-of-categorization.html#cb641-85" tabindex="-1"></a>    <span class="cf">if</span> (denominator <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fl">0.5</span>)  <span class="co"># Avoid division by zero</span></span>
<span id="cb641-86"><a href="prototype-based-models-of-categorization.html#cb641-86" tabindex="-1"></a>    <span class="fu">return</span>(numerator <span class="sc">/</span> denominator)</span>
<span id="cb641-87"><a href="prototype-based-models-of-categorization.html#cb641-87" tabindex="-1"></a>  })</span>
<span id="cb641-88"><a href="prototype-based-models-of-categorization.html#cb641-88" tabindex="-1"></a>  </span>
<span id="cb641-89"><a href="prototype-based-models-of-categorization.html#cb641-89" tabindex="-1"></a>  <span class="fu">return</span>(predictions)</span>
<span id="cb641-90"><a href="prototype-based-models-of-categorization.html#cb641-90" tabindex="-1"></a>}</span>
<span id="cb641-91"><a href="prototype-based-models-of-categorization.html#cb641-91" tabindex="-1"></a></span>
<span id="cb641-92"><a href="prototype-based-models-of-categorization.html#cb641-92" tabindex="-1"></a><span class="co"># Get predictions for both models</span></span>
<span id="cb641-93"><a href="prototype-based-models-of-categorization.html#cb641-93" tabindex="-1"></a>prototype_preds <span class="ot">&lt;-</span> <span class="fu">get_prototype_predictions</span>(</span>
<span id="cb641-94"><a href="prototype-based-models-of-categorization.html#cb641-94" tabindex="-1"></a>  <span class="at">r_value =</span> <span class="fl">1.0</span>,</span>
<span id="cb641-95"><a href="prototype-based-models-of-categorization.html#cb641-95" tabindex="-1"></a>  <span class="at">training_obs =</span> <span class="fu">as.matrix</span>(stimuli[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb641-96"><a href="prototype-based-models-of-categorization.html#cb641-96" tabindex="-1"></a>  <span class="at">training_cat =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(stimuli<span class="sc">$</span>category))</span>
<span id="cb641-97"><a href="prototype-based-models-of-categorization.html#cb641-97" tabindex="-1"></a>)</span>
<span id="cb641-98"><a href="prototype-based-models-of-categorization.html#cb641-98" tabindex="-1"></a></span>
<span id="cb641-99"><a href="prototype-based-models-of-categorization.html#cb641-99" tabindex="-1"></a>gcm_preds <span class="ot">&lt;-</span> <span class="fu">get_gcm_predictions</span>(</span>
<span id="cb641-100"><a href="prototype-based-models-of-categorization.html#cb641-100" tabindex="-1"></a>  <span class="at">w =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb641-101"><a href="prototype-based-models-of-categorization.html#cb641-101" tabindex="-1"></a>  <span class="at">c =</span> <span class="fl">1.0</span>,</span>
<span id="cb641-102"><a href="prototype-based-models-of-categorization.html#cb641-102" tabindex="-1"></a>  <span class="at">training_obs =</span> <span class="fu">as.matrix</span>(stimuli[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb641-103"><a href="prototype-based-models-of-categorization.html#cb641-103" tabindex="-1"></a>  <span class="at">training_cat =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(stimuli<span class="sc">$</span>category))</span>
<span id="cb641-104"><a href="prototype-based-models-of-categorization.html#cb641-104" tabindex="-1"></a>)</span>
<span id="cb641-105"><a href="prototype-based-models-of-categorization.html#cb641-105" tabindex="-1"></a></span>
<span id="cb641-106"><a href="prototype-based-models-of-categorization.html#cb641-106" tabindex="-1"></a><span class="co"># Create visualization data</span></span>
<span id="cb641-107"><a href="prototype-based-models-of-categorization.html#cb641-107" tabindex="-1"></a>decision_data <span class="ot">&lt;-</span> grid_points <span class="sc">%&gt;%</span></span>
<span id="cb641-108"><a href="prototype-based-models-of-categorization.html#cb641-108" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb641-109"><a href="prototype-based-models-of-categorization.html#cb641-109" tabindex="-1"></a>    <span class="at">prototype_prob =</span> prototype_preds,</span>
<span id="cb641-110"><a href="prototype-based-models-of-categorization.html#cb641-110" tabindex="-1"></a>    <span class="at">gcm_prob =</span> gcm_preds,</span>
<span id="cb641-111"><a href="prototype-based-models-of-categorization.html#cb641-111" tabindex="-1"></a>    <span class="at">prototype_decision =</span> prototype_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>,</span>
<span id="cb641-112"><a href="prototype-based-models-of-categorization.html#cb641-112" tabindex="-1"></a>    <span class="at">gcm_decision =</span> gcm_prob <span class="sc">&gt;</span> <span class="fl">0.5</span></span>
<span id="cb641-113"><a href="prototype-based-models-of-categorization.html#cb641-113" tabindex="-1"></a>  )</span>
<span id="cb641-114"><a href="prototype-based-models-of-categorization.html#cb641-114" tabindex="-1"></a></span>
<span id="cb641-115"><a href="prototype-based-models-of-categorization.html#cb641-115" tabindex="-1"></a><span class="co"># Visualize decision boundaries</span></span>
<span id="cb641-116"><a href="prototype-based-models-of-categorization.html#cb641-116" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb641-117"><a href="prototype-based-models-of-categorization.html#cb641-117" tabindex="-1"></a>  <span class="co"># Background colors for decision regions</span></span>
<span id="cb641-118"><a href="prototype-based-models-of-categorization.html#cb641-118" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> decision_data, </span>
<span id="cb641-119"><a href="prototype-based-models-of-categorization.html#cb641-119" tabindex="-1"></a>            <span class="fu">aes</span>(position, height, <span class="at">fill =</span> prototype_decision), </span>
<span id="cb641-120"><a href="prototype-based-models-of-categorization.html#cb641-120" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb641-121"><a href="prototype-based-models-of-categorization.html#cb641-121" tabindex="-1"></a>  </span>
<span id="cb641-122"><a href="prototype-based-models-of-categorization.html#cb641-122" tabindex="-1"></a>  <span class="co"># Decision boundary contour</span></span>
<span id="cb641-123"><a href="prototype-based-models-of-categorization.html#cb641-123" tabindex="-1"></a>  <span class="fu">stat_contour</span>(<span class="at">data =</span> decision_data, </span>
<span id="cb641-124"><a href="prototype-based-models-of-categorization.html#cb641-124" tabindex="-1"></a>               <span class="fu">aes</span>(position, height, <span class="at">z =</span> prototype_prob),</span>
<span id="cb641-125"><a href="prototype-based-models-of-categorization.html#cb641-125" tabindex="-1"></a>               <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb641-126"><a href="prototype-based-models-of-categorization.html#cb641-126" tabindex="-1"></a>  </span>
<span id="cb641-127"><a href="prototype-based-models-of-categorization.html#cb641-127" tabindex="-1"></a>  <span class="co"># Actual stimuli</span></span>
<span id="cb641-128"><a href="prototype-based-models-of-categorization.html#cb641-128" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> stimuli, </span>
<span id="cb641-129"><a href="prototype-based-models-of-categorization.html#cb641-129" tabindex="-1"></a>             <span class="fu">aes</span>(position, height, <span class="at">color =</span> category),</span>
<span id="cb641-130"><a href="prototype-based-models-of-categorization.html#cb641-130" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb641-131"><a href="prototype-based-models-of-categorization.html#cb641-131" tabindex="-1"></a>  </span>
<span id="cb641-132"><a href="prototype-based-models-of-categorization.html#cb641-132" tabindex="-1"></a>  <span class="co"># Labels and theme</span></span>
<span id="cb641-133"><a href="prototype-based-models-of-categorization.html#cb641-133" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;skyblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb641-134"><a href="prototype-based-models-of-categorization.html#cb641-134" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb641-135"><a href="prototype-based-models-of-categorization.html#cb641-135" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prototype Model Decision Boundary&quot;</span>,</span>
<span id="cb641-136"><a href="prototype-based-models-of-categorization.html#cb641-136" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Position&quot;</span>,</span>
<span id="cb641-137"><a href="prototype-based-models-of-categorization.html#cb641-137" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Height&quot;</span>,</span>
<span id="cb641-138"><a href="prototype-based-models-of-categorization.html#cb641-138" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Category 1&quot;</span>,</span>
<span id="cb641-139"><a href="prototype-based-models-of-categorization.html#cb641-139" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;True Category&quot;</span></span>
<span id="cb641-140"><a href="prototype-based-models-of-categorization.html#cb641-140" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb641-141"><a href="prototype-based-models-of-categorization.html#cb641-141" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb641-142"><a href="prototype-based-models-of-categorization.html#cb641-142" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb641-143"><a href="prototype-based-models-of-categorization.html#cb641-143" tabindex="-1"></a></span>
<span id="cb641-144"><a href="prototype-based-models-of-categorization.html#cb641-144" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb641-145"><a href="prototype-based-models-of-categorization.html#cb641-145" tabindex="-1"></a>  <span class="co"># Background colors for decision regions</span></span>
<span id="cb641-146"><a href="prototype-based-models-of-categorization.html#cb641-146" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> decision_data, </span>
<span id="cb641-147"><a href="prototype-based-models-of-categorization.html#cb641-147" tabindex="-1"></a>            <span class="fu">aes</span>(position, height, <span class="at">fill =</span> gcm_decision), </span>
<span id="cb641-148"><a href="prototype-based-models-of-categorization.html#cb641-148" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb641-149"><a href="prototype-based-models-of-categorization.html#cb641-149" tabindex="-1"></a>  </span>
<span id="cb641-150"><a href="prototype-based-models-of-categorization.html#cb641-150" tabindex="-1"></a>  <span class="co"># Decision boundary contour</span></span>
<span id="cb641-151"><a href="prototype-based-models-of-categorization.html#cb641-151" tabindex="-1"></a>  <span class="fu">stat_contour</span>(<span class="at">data =</span> decision_data, </span>
<span id="cb641-152"><a href="prototype-based-models-of-categorization.html#cb641-152" tabindex="-1"></a>               <span class="fu">aes</span>(position, height, <span class="at">z =</span> gcm_prob),</span>
<span id="cb641-153"><a href="prototype-based-models-of-categorization.html#cb641-153" tabindex="-1"></a>               <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb641-154"><a href="prototype-based-models-of-categorization.html#cb641-154" tabindex="-1"></a>  </span>
<span id="cb641-155"><a href="prototype-based-models-of-categorization.html#cb641-155" tabindex="-1"></a>  <span class="co"># Actual stimuli</span></span>
<span id="cb641-156"><a href="prototype-based-models-of-categorization.html#cb641-156" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> stimuli, </span>
<span id="cb641-157"><a href="prototype-based-models-of-categorization.html#cb641-157" tabindex="-1"></a>             <span class="fu">aes</span>(position, height, <span class="at">color =</span> category),</span>
<span id="cb641-158"><a href="prototype-based-models-of-categorization.html#cb641-158" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb641-159"><a href="prototype-based-models-of-categorization.html#cb641-159" tabindex="-1"></a>  </span>
<span id="cb641-160"><a href="prototype-based-models-of-categorization.html#cb641-160" tabindex="-1"></a>  <span class="co"># Labels and theme</span></span>
<span id="cb641-161"><a href="prototype-based-models-of-categorization.html#cb641-161" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;skyblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb641-162"><a href="prototype-based-models-of-categorization.html#cb641-162" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb641-163"><a href="prototype-based-models-of-categorization.html#cb641-163" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Exemplar Model (GCM) Decision Boundary&quot;</span>,</span>
<span id="cb641-164"><a href="prototype-based-models-of-categorization.html#cb641-164" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Position&quot;</span>,</span>
<span id="cb641-165"><a href="prototype-based-models-of-categorization.html#cb641-165" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Height&quot;</span>,</span>
<span id="cb641-166"><a href="prototype-based-models-of-categorization.html#cb641-166" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Category 1&quot;</span>,</span>
<span id="cb641-167"><a href="prototype-based-models-of-categorization.html#cb641-167" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;True Category&quot;</span></span>
<span id="cb641-168"><a href="prototype-based-models-of-categorization.html#cb641-168" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb641-169"><a href="prototype-based-models-of-categorization.html#cb641-169" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb641-170"><a href="prototype-based-models-of-categorization.html#cb641-170" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb641-171"><a href="prototype-based-models-of-categorization.html#cb641-171" tabindex="-1"></a></span>
<span id="cb641-172"><a href="prototype-based-models-of-categorization.html#cb641-172" tabindex="-1"></a><span class="co"># Compare the two models side by side</span></span>
<span id="cb641-173"><a href="prototype-based-models-of-categorization.html#cb641-173" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/12%20comparing%20exemplars%20and%20gcm-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>While the example is not really fit for this comparison (sorry, I didn’t think of it earlier on!), the visualization highlights a key difference between prototype and exemplar models: the shape of their decision boundaries. The prototype model tends to create smoother, more regular boundaries based on distance from centroids. The exemplar model can create more complex boundaries that conform to the specific distribution of training examples.</p>
</div>
<div id="implementing-the-prototype-model-in-stan" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Implementing the Prototype Model in Stan<a href="prototype-based-models-of-categorization.html#implementing-the-prototype-model-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To estimate the parameters of our prototype model from observed categorization data, we’ll implement it in Stan:</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="prototype-based-models-of-categorization.html#cb642-1" tabindex="-1"></a>prototype_single_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb642-2"><a href="prototype-based-models-of-categorization.html#cb642-2" tabindex="-1"></a><span class="st">// Prototype Model using Kalman Filter</span></span>
<span id="cb642-3"><a href="prototype-based-models-of-categorization.html#cb642-3" tabindex="-1"></a><span class="st">// This model implements a dynamic prototype-based categorization approach</span></span>
<span id="cb642-4"><a href="prototype-based-models-of-categorization.html#cb642-4" tabindex="-1"></a><span class="st">// where category representations are updated sequentially as new examples are observed</span></span>
<span id="cb642-5"><a href="prototype-based-models-of-categorization.html#cb642-5" tabindex="-1"></a></span>
<span id="cb642-6"><a href="prototype-based-models-of-categorization.html#cb642-6" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb642-7"><a href="prototype-based-models-of-categorization.html#cb642-7" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; ntrials;                // Number of trials</span></span>
<span id="cb642-8"><a href="prototype-based-models-of-categorization.html#cb642-8" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; nfeatures;              // Number of feature dimensions</span></span>
<span id="cb642-9"><a href="prototype-based-models-of-categorization.html#cb642-9" tabindex="-1"></a><span class="st">  array[ntrials] int&lt;lower=0, upper=1&gt; cat_one;  // True category labels</span></span>
<span id="cb642-10"><a href="prototype-based-models-of-categorization.html#cb642-10" tabindex="-1"></a><span class="st">  array[ntrials] int&lt;lower=0, upper=1&gt; y;        // Observed decisions</span></span>
<span id="cb642-11"><a href="prototype-based-models-of-categorization.html#cb642-11" tabindex="-1"></a><span class="st">  array[ntrials, nfeatures] real obs;  // Stimulus features</span></span>
<span id="cb642-12"><a href="prototype-based-models-of-categorization.html#cb642-12" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; b;            // Response bias (usually 0.5 for no bias)</span></span>
<span id="cb642-13"><a href="prototype-based-models-of-categorization.html#cb642-13" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-14"><a href="prototype-based-models-of-categorization.html#cb642-14" tabindex="-1"></a></span>
<span id="cb642-15"><a href="prototype-based-models-of-categorization.html#cb642-15" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb642-16"><a href="prototype-based-models-of-categorization.html#cb642-16" tabindex="-1"></a><span class="st">  // We model observation noise on log scale for better sampling</span></span>
<span id="cb642-17"><a href="prototype-based-models-of-categorization.html#cb642-17" tabindex="-1"></a><span class="st">  real log_r;                          // Log observation noise parameter</span></span>
<span id="cb642-18"><a href="prototype-based-models-of-categorization.html#cb642-18" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-19"><a href="prototype-based-models-of-categorization.html#cb642-19" tabindex="-1"></a></span>
<span id="cb642-20"><a href="prototype-based-models-of-categorization.html#cb642-20" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb642-21"><a href="prototype-based-models-of-categorization.html#cb642-21" tabindex="-1"></a><span class="st">  // Transform log_r back to natural scale with reasonable bounds</span></span>
<span id="cb642-22"><a href="prototype-based-models-of-categorization.html#cb642-22" tabindex="-1"></a><span class="st">  real&lt;lower=0.01, upper=10.0&gt; r_value = exp(log_r);</span></span>
<span id="cb642-23"><a href="prototype-based-models-of-categorization.html#cb642-23" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-24"><a href="prototype-based-models-of-categorization.html#cb642-24" tabindex="-1"></a><span class="st">  // Response probabilities for each trial</span></span>
<span id="cb642-25"><a href="prototype-based-models-of-categorization.html#cb642-25" tabindex="-1"></a><span class="st">  array[ntrials] real&lt;lower=0.001, upper=0.999&gt; p;</span></span>
<span id="cb642-26"><a href="prototype-based-models-of-categorization.html#cb642-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-27"><a href="prototype-based-models-of-categorization.html#cb642-27" tabindex="-1"></a><span class="st">  // Initialize prototype means for each category</span></span>
<span id="cb642-28"><a href="prototype-based-models-of-categorization.html#cb642-28" tabindex="-1"></a><span class="st">  // We use the first observation of each category if available,</span></span>
<span id="cb642-29"><a href="prototype-based-models-of-categorization.html#cb642-29" tabindex="-1"></a><span class="st">  // otherwise start with the midpoint of the feature space</span></span>
<span id="cb642-30"><a href="prototype-based-models-of-categorization.html#cb642-30" tabindex="-1"></a><span class="st">  vector[nfeatures] mu_cat0;</span></span>
<span id="cb642-31"><a href="prototype-based-models-of-categorization.html#cb642-31" tabindex="-1"></a><span class="st">  vector[nfeatures] mu_cat1;</span></span>
<span id="cb642-32"><a href="prototype-based-models-of-categorization.html#cb642-32" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-33"><a href="prototype-based-models-of-categorization.html#cb642-33" tabindex="-1"></a><span class="st">  // Initialize uncertainty matrices (covariance) for each prototype</span></span>
<span id="cb642-34"><a href="prototype-based-models-of-categorization.html#cb642-34" tabindex="-1"></a><span class="st">  // High initial values reflect uncertainty before seeing examples</span></span>
<span id="cb642-35"><a href="prototype-based-models-of-categorization.html#cb642-35" tabindex="-1"></a><span class="st">  matrix[nfeatures, nfeatures] sigma_cat0;</span></span>
<span id="cb642-36"><a href="prototype-based-models-of-categorization.html#cb642-36" tabindex="-1"></a><span class="st">  matrix[nfeatures, nfeatures] sigma_cat1;</span></span>
<span id="cb642-37"><a href="prototype-based-models-of-categorization.html#cb642-37" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-38"><a href="prototype-based-models-of-categorization.html#cb642-38" tabindex="-1"></a><span class="st">  // Set initial values based on first observations</span></span>
<span id="cb642-39"><a href="prototype-based-models-of-categorization.html#cb642-39" tabindex="-1"></a><span class="st">  {</span></span>
<span id="cb642-40"><a href="prototype-based-models-of-categorization.html#cb642-40" tabindex="-1"></a><span class="st">    // Find first examples of each category</span></span>
<span id="cb642-41"><a href="prototype-based-models-of-categorization.html#cb642-41" tabindex="-1"></a><span class="st">    int first_cat0 = 0;</span></span>
<span id="cb642-42"><a href="prototype-based-models-of-categorization.html#cb642-42" tabindex="-1"></a><span class="st">    int first_cat1 = 0;</span></span>
<span id="cb642-43"><a href="prototype-based-models-of-categorization.html#cb642-43" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-44"><a href="prototype-based-models-of-categorization.html#cb642-44" tabindex="-1"></a><span class="st">    for (i in 1:ntrials) {</span></span>
<span id="cb642-45"><a href="prototype-based-models-of-categorization.html#cb642-45" tabindex="-1"></a><span class="st">      if (cat_one[i] == 0 &amp;&amp; first_cat0 == 0) first_cat0 = i;</span></span>
<span id="cb642-46"><a href="prototype-based-models-of-categorization.html#cb642-46" tabindex="-1"></a><span class="st">      if (cat_one[i] == 1 &amp;&amp; first_cat1 == 0) first_cat1 = i;</span></span>
<span id="cb642-47"><a href="prototype-based-models-of-categorization.html#cb642-47" tabindex="-1"></a><span class="st">      if (first_cat0 &gt; 0 &amp;&amp; first_cat1 &gt; 0) break;</span></span>
<span id="cb642-48"><a href="prototype-based-models-of-categorization.html#cb642-48" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb642-49"><a href="prototype-based-models-of-categorization.html#cb642-49" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-50"><a href="prototype-based-models-of-categorization.html#cb642-50" tabindex="-1"></a><span class="st">    // Initialize means - if no examples of a category, use middle values</span></span>
<span id="cb642-51"><a href="prototype-based-models-of-categorization.html#cb642-51" tabindex="-1"></a><span class="st">    if (first_cat0 &gt; 0) {</span></span>
<span id="cb642-52"><a href="prototype-based-models-of-categorization.html#cb642-52" tabindex="-1"></a><span class="st">      for (j in 1:nfeatures) mu_cat0[j] = obs[first_cat0, j];</span></span>
<span id="cb642-53"><a href="prototype-based-models-of-categorization.html#cb642-53" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb642-54"><a href="prototype-based-models-of-categorization.html#cb642-54" tabindex="-1"></a><span class="st">      mu_cat0 = rep_vector(2.5, nfeatures); // Middle of typical feature range</span></span>
<span id="cb642-55"><a href="prototype-based-models-of-categorization.html#cb642-55" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb642-56"><a href="prototype-based-models-of-categorization.html#cb642-56" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-57"><a href="prototype-based-models-of-categorization.html#cb642-57" tabindex="-1"></a><span class="st">    if (first_cat1 &gt; 0) {</span></span>
<span id="cb642-58"><a href="prototype-based-models-of-categorization.html#cb642-58" tabindex="-1"></a><span class="st">      for (j in 1:nfeatures) mu_cat1[j] = obs[first_cat1, j];</span></span>
<span id="cb642-59"><a href="prototype-based-models-of-categorization.html#cb642-59" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb642-60"><a href="prototype-based-models-of-categorization.html#cb642-60" tabindex="-1"></a><span class="st">      mu_cat1 = rep_vector(2.5, nfeatures); // Middle of typical feature range</span></span>
<span id="cb642-61"><a href="prototype-based-models-of-categorization.html#cb642-61" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb642-62"><a href="prototype-based-models-of-categorization.html#cb642-62" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-63"><a href="prototype-based-models-of-categorization.html#cb642-63" tabindex="-1"></a><span class="st">    // Initialize uncertainty matrices</span></span>
<span id="cb642-64"><a href="prototype-based-models-of-categorization.html#cb642-64" tabindex="-1"></a><span class="st">    sigma_cat0 = diag_matrix(rep_vector(5.0, nfeatures));</span></span>
<span id="cb642-65"><a href="prototype-based-models-of-categorization.html#cb642-65" tabindex="-1"></a><span class="st">    sigma_cat1 = diag_matrix(rep_vector(5.0, nfeatures));</span></span>
<span id="cb642-66"><a href="prototype-based-models-of-categorization.html#cb642-66" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-67"><a href="prototype-based-models-of-categorization.html#cb642-67" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-68"><a href="prototype-based-models-of-categorization.html#cb642-68" tabindex="-1"></a><span class="st">  // Observation noise matrix - constant for all observations</span></span>
<span id="cb642-69"><a href="prototype-based-models-of-categorization.html#cb642-69" tabindex="-1"></a><span class="st">  matrix[nfeatures, nfeatures] r_matrix = diag_matrix(rep_vector(r_value, nfeatures));</span></span>
<span id="cb642-70"><a href="prototype-based-models-of-categorization.html#cb642-70" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-71"><a href="prototype-based-models-of-categorization.html#cb642-71" tabindex="-1"></a><span class="st">  // Process trials sequentially to simulate the learning process</span></span>
<span id="cb642-72"><a href="prototype-based-models-of-categorization.html#cb642-72" tabindex="-1"></a><span class="st">  for (i in 1:ntrials) {</span></span>
<span id="cb642-73"><a href="prototype-based-models-of-categorization.html#cb642-73" tabindex="-1"></a><span class="st">    // Extract current observation</span></span>
<span id="cb642-74"><a href="prototype-based-models-of-categorization.html#cb642-74" tabindex="-1"></a><span class="st">    vector[nfeatures] current_obs = to_vector(obs[i]);</span></span>
<span id="cb642-75"><a href="prototype-based-models-of-categorization.html#cb642-75" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-76"><a href="prototype-based-models-of-categorization.html#cb642-76" tabindex="-1"></a><span class="st">    // Calculate response probability based on current prototypes</span></span>
<span id="cb642-77"><a href="prototype-based-models-of-categorization.html#cb642-77" tabindex="-1"></a><span class="st">    if (i == 1 || sum(cat_one[1:(i-1)]) == 0 || sum(cat_one[1:(i-1)]) == (i-1)) {</span></span>
<span id="cb642-78"><a href="prototype-based-models-of-categorization.html#cb642-78" tabindex="-1"></a><span class="st">      // No examples of one category, use response bias</span></span>
<span id="cb642-79"><a href="prototype-based-models-of-categorization.html#cb642-79" tabindex="-1"></a><span class="st">      p[i] = b;</span></span>
<span id="cb642-80"><a href="prototype-based-models-of-categorization.html#cb642-80" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb642-81"><a href="prototype-based-models-of-categorization.html#cb642-81" tabindex="-1"></a><span class="st">      // Calculate distances to prototypes using Mahalanobis distance</span></span>
<span id="cb642-82"><a href="prototype-based-models-of-categorization.html#cb642-82" tabindex="-1"></a><span class="st">      // Add observation noise to account for perceptual/memory variance</span></span>
<span id="cb642-83"><a href="prototype-based-models-of-categorization.html#cb642-83" tabindex="-1"></a><span class="st">      matrix[nfeatures, nfeatures] cov_cat0 = sigma_cat0 + r_matrix;</span></span>
<span id="cb642-84"><a href="prototype-based-models-of-categorization.html#cb642-84" tabindex="-1"></a><span class="st">      matrix[nfeatures, nfeatures] cov_cat1 = sigma_cat1 + r_matrix;</span></span>
<span id="cb642-85"><a href="prototype-based-models-of-categorization.html#cb642-85" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb642-86"><a href="prototype-based-models-of-categorization.html#cb642-86" tabindex="-1"></a><span class="st">      // Compute precision matrices for efficiency and stability</span></span>
<span id="cb642-87"><a href="prototype-based-models-of-categorization.html#cb642-87" tabindex="-1"></a><span class="st">      matrix[nfeatures, nfeatures] prec_cat0 = inverse_spd(cov_cat0);</span></span>
<span id="cb642-88"><a href="prototype-based-models-of-categorization.html#cb642-88" tabindex="-1"></a><span class="st">      matrix[nfeatures, nfeatures] prec_cat1 = inverse_spd(cov_cat1);</span></span>
<span id="cb642-89"><a href="prototype-based-models-of-categorization.html#cb642-89" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb642-90"><a href="prototype-based-models-of-categorization.html#cb642-90" tabindex="-1"></a><span class="st">      // Mahalanobis distance calculation - quadratic form</span></span>
<span id="cb642-91"><a href="prototype-based-models-of-categorization.html#cb642-91" tabindex="-1"></a><span class="st">      vector[nfeatures] diff0 = current_obs - mu_cat0;</span></span>
<span id="cb642-92"><a href="prototype-based-models-of-categorization.html#cb642-92" tabindex="-1"></a><span class="st">      vector[nfeatures] diff1 = current_obs - mu_cat1;</span></span>
<span id="cb642-93"><a href="prototype-based-models-of-categorization.html#cb642-93" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb642-94"><a href="prototype-based-models-of-categorization.html#cb642-94" tabindex="-1"></a><span class="st">      real dist_cat0 = dot_product(diff0, prec_cat0 * diff0);</span></span>
<span id="cb642-95"><a href="prototype-based-models-of-categorization.html#cb642-95" tabindex="-1"></a><span class="st">      real dist_cat1 = dot_product(diff1, prec_cat1 * diff1);</span></span>
<span id="cb642-96"><a href="prototype-based-models-of-categorization.html#cb642-96" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb642-97"><a href="prototype-based-models-of-categorization.html#cb642-97" tabindex="-1"></a><span class="st">      // Log determinants for normalization term in multivariate normal</span></span>
<span id="cb642-98"><a href="prototype-based-models-of-categorization.html#cb642-98" tabindex="-1"></a><span class="st">      real logdet_cat0 = log_determinant(cov_cat0);</span></span>
<span id="cb642-99"><a href="prototype-based-models-of-categorization.html#cb642-99" tabindex="-1"></a><span class="st">      real logdet_cat1 = log_determinant(cov_cat1);</span></span>
<span id="cb642-100"><a href="prototype-based-models-of-categorization.html#cb642-100" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb642-101"><a href="prototype-based-models-of-categorization.html#cb642-101" tabindex="-1"></a><span class="st">      // Calculate log probabilities with complete multivariate normal formula</span></span>
<span id="cb642-102"><a href="prototype-based-models-of-categorization.html#cb642-102" tabindex="-1"></a><span class="st">      real log_p0 = -0.5 * (dist_cat0 + logdet_cat0 + nfeatures * log(2 * pi())) + log(1-b);</span></span>
<span id="cb642-103"><a href="prototype-based-models-of-categorization.html#cb642-103" tabindex="-1"></a><span class="st">      real log_p1 = -0.5 * (dist_cat1 + logdet_cat1 + nfeatures * log(2 * pi())) + log(b);</span></span>
<span id="cb642-104"><a href="prototype-based-models-of-categorization.html#cb642-104" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb642-105"><a href="prototype-based-models-of-categorization.html#cb642-105" tabindex="-1"></a><span class="st">      // Convert to probability using log-sum-exp for numerical stability</span></span>
<span id="cb642-106"><a href="prototype-based-models-of-categorization.html#cb642-106" tabindex="-1"></a><span class="st">      p[i] = exp(log_p1 - log_sum_exp(log_p0, log_p1));</span></span>
<span id="cb642-107"><a href="prototype-based-models-of-categorization.html#cb642-107" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb642-108"><a href="prototype-based-models-of-categorization.html#cb642-108" tabindex="-1"></a><span class="st">      // Bound probabilities for numerical stability</span></span>
<span id="cb642-109"><a href="prototype-based-models-of-categorization.html#cb642-109" tabindex="-1"></a><span class="st">      p[i] = fmax(fmin(p[i], 0.999), 0.001);</span></span>
<span id="cb642-110"><a href="prototype-based-models-of-categorization.html#cb642-110" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb642-111"><a href="prototype-based-models-of-categorization.html#cb642-111" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-112"><a href="prototype-based-models-of-categorization.html#cb642-112" tabindex="-1"></a><span class="st">    // After making a prediction, update the prototype of the correct category</span></span>
<span id="cb642-113"><a href="prototype-based-models-of-categorization.html#cb642-113" tabindex="-1"></a><span class="st">    // This simulates learning from feedback (except on the last trial)</span></span>
<span id="cb642-114"><a href="prototype-based-models-of-categorization.html#cb642-114" tabindex="-1"></a><span class="st">    if (i &lt; ntrials) {</span></span>
<span id="cb642-115"><a href="prototype-based-models-of-categorization.html#cb642-115" tabindex="-1"></a><span class="st">      // Select which prototype to update based on true category</span></span>
<span id="cb642-116"><a href="prototype-based-models-of-categorization.html#cb642-116" tabindex="-1"></a><span class="st">      if (cat_one[i] == 1) {</span></span>
<span id="cb642-117"><a href="prototype-based-models-of-categorization.html#cb642-117" tabindex="-1"></a><span class="st">        // Update category 1 prototype using Kalman filter equations</span></span>
<span id="cb642-118"><a href="prototype-based-models-of-categorization.html#cb642-118" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb642-119"><a href="prototype-based-models-of-categorization.html#cb642-119" tabindex="-1"></a><span class="st">        // Innovation: difference between observation and current mean</span></span>
<span id="cb642-120"><a href="prototype-based-models-of-categorization.html#cb642-120" tabindex="-1"></a><span class="st">        vector[nfeatures] innovation = current_obs - mu_cat1;</span></span>
<span id="cb642-121"><a href="prototype-based-models-of-categorization.html#cb642-121" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb642-122"><a href="prototype-based-models-of-categorization.html#cb642-122" tabindex="-1"></a><span class="st">        // Combined uncertainty (prior uncertainty + observation noise)</span></span>
<span id="cb642-123"><a href="prototype-based-models-of-categorization.html#cb642-123" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] S = sigma_cat1 + r_matrix;</span></span>
<span id="cb642-124"><a href="prototype-based-models-of-categorization.html#cb642-124" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb642-125"><a href="prototype-based-models-of-categorization.html#cb642-125" tabindex="-1"></a><span class="st">        // Kalman gain calculation</span></span>
<span id="cb642-126"><a href="prototype-based-models-of-categorization.html#cb642-126" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] K = sigma_cat1 * inverse_spd(S);</span></span>
<span id="cb642-127"><a href="prototype-based-models-of-categorization.html#cb642-127" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb642-128"><a href="prototype-based-models-of-categorization.html#cb642-128" tabindex="-1"></a><span class="st">        // Update mean (prototype location)</span></span>
<span id="cb642-129"><a href="prototype-based-models-of-categorization.html#cb642-129" tabindex="-1"></a><span class="st">        mu_cat1 = mu_cat1 + K * innovation;</span></span>
<span id="cb642-130"><a href="prototype-based-models-of-categorization.html#cb642-130" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb642-131"><a href="prototype-based-models-of-categorization.html#cb642-131" tabindex="-1"></a><span class="st">        // Update covariance (uncertainty)</span></span>
<span id="cb642-132"><a href="prototype-based-models-of-categorization.html#cb642-132" tabindex="-1"></a><span class="st">        // Joseph form ensures numerical stability and symmetry</span></span>
<span id="cb642-133"><a href="prototype-based-models-of-categorization.html#cb642-133" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] I = diag_matrix(rep_vector(1.0, nfeatures));</span></span>
<span id="cb642-134"><a href="prototype-based-models-of-categorization.html#cb642-134" tabindex="-1"></a><span class="st">        sigma_cat1 = (I - K) * sigma_cat1 * (I - K)&#39; + K * r_matrix * K&#39;;</span></span>
<span id="cb642-135"><a href="prototype-based-models-of-categorization.html#cb642-135" tabindex="-1"></a><span class="st">      } else {</span></span>
<span id="cb642-136"><a href="prototype-based-models-of-categorization.html#cb642-136" tabindex="-1"></a><span class="st">        // Update category 0 prototype - same procedure</span></span>
<span id="cb642-137"><a href="prototype-based-models-of-categorization.html#cb642-137" tabindex="-1"></a><span class="st">        vector[nfeatures] innovation = current_obs - mu_cat0;</span></span>
<span id="cb642-138"><a href="prototype-based-models-of-categorization.html#cb642-138" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] S = sigma_cat0 + r_matrix;</span></span>
<span id="cb642-139"><a href="prototype-based-models-of-categorization.html#cb642-139" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] K = sigma_cat0 * inverse_spd(S);</span></span>
<span id="cb642-140"><a href="prototype-based-models-of-categorization.html#cb642-140" tabindex="-1"></a><span class="st">        mu_cat0 = mu_cat0 + K * innovation;</span></span>
<span id="cb642-141"><a href="prototype-based-models-of-categorization.html#cb642-141" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] I = diag_matrix(rep_vector(1.0, nfeatures));</span></span>
<span id="cb642-142"><a href="prototype-based-models-of-categorization.html#cb642-142" tabindex="-1"></a><span class="st">        sigma_cat0 = (I - K) * sigma_cat0 * (I - K)&#39; + K * r_matrix * K&#39;;</span></span>
<span id="cb642-143"><a href="prototype-based-models-of-categorization.html#cb642-143" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb642-144"><a href="prototype-based-models-of-categorization.html#cb642-144" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb642-145"><a href="prototype-based-models-of-categorization.html#cb642-145" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-146"><a href="prototype-based-models-of-categorization.html#cb642-146" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-147"><a href="prototype-based-models-of-categorization.html#cb642-147" tabindex="-1"></a></span>
<span id="cb642-148"><a href="prototype-based-models-of-categorization.html#cb642-148" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb642-149"><a href="prototype-based-models-of-categorization.html#cb642-149" tabindex="-1"></a><span class="st">  // Prior for log observation noise</span></span>
<span id="cb642-150"><a href="prototype-based-models-of-categorization.html#cb642-150" tabindex="-1"></a><span class="st">  // Normal prior centered at 0 (r_value = 1) with reasonable spread</span></span>
<span id="cb642-151"><a href="prototype-based-models-of-categorization.html#cb642-151" tabindex="-1"></a><span class="st">  target += normal_lpdf(log_r | 0, 1);  </span></span>
<span id="cb642-152"><a href="prototype-based-models-of-categorization.html#cb642-152" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-153"><a href="prototype-based-models-of-categorization.html#cb642-153" tabindex="-1"></a><span class="st">  // Likelihood: model choices as a function of calculated probabilities</span></span>
<span id="cb642-154"><a href="prototype-based-models-of-categorization.html#cb642-154" tabindex="-1"></a><span class="st">  target += bernoulli_lpmf(y | p);</span></span>
<span id="cb642-155"><a href="prototype-based-models-of-categorization.html#cb642-155" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-156"><a href="prototype-based-models-of-categorization.html#cb642-156" tabindex="-1"></a></span>
<span id="cb642-157"><a href="prototype-based-models-of-categorization.html#cb642-157" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb642-158"><a href="prototype-based-models-of-categorization.html#cb642-158" tabindex="-1"></a><span class="st">  // Log likelihood for model comparison</span></span>
<span id="cb642-159"><a href="prototype-based-models-of-categorization.html#cb642-159" tabindex="-1"></a><span class="st">  array[ntrials] real log_lik;</span></span>
<span id="cb642-160"><a href="prototype-based-models-of-categorization.html#cb642-160" tabindex="-1"></a><span class="st">  for (i in 1:ntrials) {</span></span>
<span id="cb642-161"><a href="prototype-based-models-of-categorization.html#cb642-161" tabindex="-1"></a><span class="st">    log_lik[i] = bernoulli_lpmf(y[i] | p[i]);</span></span>
<span id="cb642-162"><a href="prototype-based-models-of-categorization.html#cb642-162" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-163"><a href="prototype-based-models-of-categorization.html#cb642-163" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-164"><a href="prototype-based-models-of-categorization.html#cb642-164" tabindex="-1"></a><span class="st">  // Final prototype locations for interpretation</span></span>
<span id="cb642-165"><a href="prototype-based-models-of-categorization.html#cb642-165" tabindex="-1"></a><span class="st">  array[nfeatures] real final_prototype_cat0 = to_array_1d(mu_cat0);</span></span>
<span id="cb642-166"><a href="prototype-based-models-of-categorization.html#cb642-166" tabindex="-1"></a><span class="st">  array[nfeatures] real final_prototype_cat1 = to_array_1d(mu_cat1);</span></span>
<span id="cb642-167"><a href="prototype-based-models-of-categorization.html#cb642-167" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-168"><a href="prototype-based-models-of-categorization.html#cb642-168" tabindex="-1"></a><span class="st">  // Final uncertainty (diagonal elements of covariance matrix)</span></span>
<span id="cb642-169"><a href="prototype-based-models-of-categorization.html#cb642-169" tabindex="-1"></a><span class="st">  array[nfeatures] real final_uncertainty_cat0;</span></span>
<span id="cb642-170"><a href="prototype-based-models-of-categorization.html#cb642-170" tabindex="-1"></a><span class="st">  array[nfeatures] real final_uncertainty_cat1;</span></span>
<span id="cb642-171"><a href="prototype-based-models-of-categorization.html#cb642-171" tabindex="-1"></a><span class="st">  for (j in 1:nfeatures) {</span></span>
<span id="cb642-172"><a href="prototype-based-models-of-categorization.html#cb642-172" tabindex="-1"></a><span class="st">    final_uncertainty_cat0[j] = sqrt(sigma_cat0[j,j]);</span></span>
<span id="cb642-173"><a href="prototype-based-models-of-categorization.html#cb642-173" tabindex="-1"></a><span class="st">    final_uncertainty_cat1[j] = sqrt(sigma_cat1[j,j]);</span></span>
<span id="cb642-174"><a href="prototype-based-models-of-categorization.html#cb642-174" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-175"><a href="prototype-based-models-of-categorization.html#cb642-175" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-176"><a href="prototype-based-models-of-categorization.html#cb642-176" tabindex="-1"></a><span class="st">  // Generate predictions for posterior predictive checks</span></span>
<span id="cb642-177"><a href="prototype-based-models-of-categorization.html#cb642-177" tabindex="-1"></a><span class="st">  array[ntrials] int pred;</span></span>
<span id="cb642-178"><a href="prototype-based-models-of-categorization.html#cb642-178" tabindex="-1"></a><span class="st">  for (i in 1:ntrials) {</span></span>
<span id="cb642-179"><a href="prototype-based-models-of-categorization.html#cb642-179" tabindex="-1"></a><span class="st">    pred[i] = bernoulli_rng(p[i]);</span></span>
<span id="cb642-180"><a href="prototype-based-models-of-categorization.html#cb642-180" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-181"><a href="prototype-based-models-of-categorization.html#cb642-181" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-182"><a href="prototype-based-models-of-categorization.html#cb642-182" tabindex="-1"></a><span class="st">  // Observation noise on original scale for interpretation</span></span>
<span id="cb642-183"><a href="prototype-based-models-of-categorization.html#cb642-183" tabindex="-1"></a><span class="st">  real observation_noise = r_value;</span></span>
<span id="cb642-184"><a href="prototype-based-models-of-categorization.html#cb642-184" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb642-185"><a href="prototype-based-models-of-categorization.html#cb642-185" tabindex="-1"></a></span>
<span id="cb642-186"><a href="prototype-based-models-of-categorization.html#cb642-186" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb642-187"><a href="prototype-based-models-of-categorization.html#cb642-187" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb642-188"><a href="prototype-based-models-of-categorization.html#cb642-188" tabindex="-1"></a>  prototype_single_stan,</span>
<span id="cb642-189"><a href="prototype-based-models-of-categorization.html#cb642-189" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb642-190"><a href="prototype-based-models-of-categorization.html#cb642-190" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W12_prototype_single.stan&quot;</span></span>
<span id="cb642-191"><a href="prototype-based-models-of-categorization.html#cb642-191" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W12_prototype_single.stan&quot;</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="prototype-based-models-of-categorization.html#cb644-1" tabindex="-1"></a>prototype_single_stan <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb644-2"><a href="prototype-based-models-of-categorization.html#cb644-2" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="st">&quot;stan/W12_prototype_single.stan&quot;</span>),</span>
<span id="cb644-3"><a href="prototype-based-models-of-categorization.html#cb644-3" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb644-4"><a href="prototype-based-models-of-categorization.html#cb644-4" tabindex="-1"></a>  )</span></code></pre></div>
<p>This Stan implementation:</p>
<ol style="list-style-type: decimal">
<li>Takes observed categorization decisions and stimuli as input</li>
<li>Estimates the observation noise parameter from the data</li>
<li>Implements the same Kalman filter prototype updating as our R model</li>
<li>Calculates response probabilities based on similarity to prototypes</li>
<li>Returns final prototype locations and predictions</li>
</ol>
<p>We can fit this model to behavioral data and compare it to the GCM to see which better describes human categorization behavior.</p>
</div>
<div id="parameter-recovery-analysis-for-the-prototype-model" class="section level2 hasAnchor" number="13.9">
<h2><span class="header-section-number">13.9</span> Parameter Recovery Analysis for the Prototype Model<a href="prototype-based-models-of-categorization.html#parameter-recovery-analysis-for-the-prototype-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To validate our prototype model implementation, we should perform parameter recovery analysis. This involves:</p>
<ol style="list-style-type: decimal">
<li>Generating synthetic data with known parameter values</li>
<li>Fitting the model to recover these parameters</li>
<li>Comparing recovered parameters to the true generating values</li>
</ol>
<p>Here, we’ll focus on recovering the observation noise parameter (r_value), which is the key parameter in our Kalman filter prototype model:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="prototype-based-models-of-categorization.html#cb645-1" tabindex="-1"></a><span class="co"># Function to simulate data with known r_value</span></span>
<span id="cb645-2"><a href="prototype-based-models-of-categorization.html#cb645-2" tabindex="-1"></a>generate_prototype_data <span class="ot">&lt;-</span> <span class="cf">function</span>(true_r_value, <span class="at">n_trials =</span> <span class="dv">300</span>) {</span>
<span id="cb645-3"><a href="prototype-based-models-of-categorization.html#cb645-3" tabindex="-1"></a>  <span class="co"># Generate new stimuli features and categories</span></span>
<span id="cb645-4"><a href="prototype-based-models-of-categorization.html#cb645-4" tabindex="-1"></a>  features <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_trials, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb645-5"><a href="prototype-based-models-of-categorization.html#cb645-5" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> n_trials<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb645-6"><a href="prototype-based-models-of-categorization.html#cb645-6" tabindex="-1"></a><span class="co"># Generate data around two centroids</span></span>
<span id="cb645-7"><a href="prototype-based-models-of-categorization.html#cb645-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb645-8"><a href="prototype-based-models-of-categorization.html#cb645-8" tabindex="-1"></a>  <span class="cf">if</span> (category[i] <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb645-9"><a href="prototype-based-models-of-categorization.html#cb645-9" tabindex="-1"></a>    features[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="sc">-</span><span class="fl">1.5</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="fl">0.8</span>)</span>
<span id="cb645-10"><a href="prototype-based-models-of-categorization.html#cb645-10" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb645-11"><a href="prototype-based-models-of-categorization.html#cb645-11" tabindex="-1"></a>    features[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="fl">0.8</span>)</span>
<span id="cb645-12"><a href="prototype-based-models-of-categorization.html#cb645-12" tabindex="-1"></a>  }</span>
<span id="cb645-13"><a href="prototype-based-models-of-categorization.html#cb645-13" tabindex="-1"></a>}</span>
<span id="cb645-14"><a href="prototype-based-models-of-categorization.html#cb645-14" tabindex="-1"></a>  </span>
<span id="cb645-15"><a href="prototype-based-models-of-categorization.html#cb645-15" tabindex="-1"></a>  <span class="co"># Generate responses using the prototype model with known r_value</span></span>
<span id="cb645-16"><a href="prototype-based-models-of-categorization.html#cb645-16" tabindex="-1"></a>  responses <span class="ot">&lt;-</span> <span class="fu">prototype_kalman</span>(true_r_value, features, category)</span>
<span id="cb645-17"><a href="prototype-based-models-of-categorization.html#cb645-17" tabindex="-1"></a>  </span>
<span id="cb645-18"><a href="prototype-based-models-of-categorization.html#cb645-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb645-19"><a href="prototype-based-models-of-categorization.html#cb645-19" tabindex="-1"></a>    <span class="at">responses =</span> responses,</span>
<span id="cb645-20"><a href="prototype-based-models-of-categorization.html#cb645-20" tabindex="-1"></a>    <span class="at">true_r_value =</span> true_r_value,</span>
<span id="cb645-21"><a href="prototype-based-models-of-categorization.html#cb645-21" tabindex="-1"></a>    <span class="at">obs =</span> features,</span>
<span id="cb645-22"><a href="prototype-based-models-of-categorization.html#cb645-22" tabindex="-1"></a>    <span class="at">cat_one =</span> category</span>
<span id="cb645-23"><a href="prototype-based-models-of-categorization.html#cb645-23" tabindex="-1"></a>  ))</span>
<span id="cb645-24"><a href="prototype-based-models-of-categorization.html#cb645-24" tabindex="-1"></a>}</span>
<span id="cb645-25"><a href="prototype-based-models-of-categorization.html#cb645-25" tabindex="-1"></a></span>
<span id="cb645-26"><a href="prototype-based-models-of-categorization.html#cb645-26" tabindex="-1"></a><span class="co"># Better function to prepare data for Stan</span></span>
<span id="cb645-27"><a href="prototype-based-models-of-categorization.html#cb645-27" tabindex="-1"></a>prepare_prototype_stan_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb645-28"><a href="prototype-based-models-of-categorization.html#cb645-28" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb645-29"><a href="prototype-based-models-of-categorization.html#cb645-29" tabindex="-1"></a>    <span class="at">ntrials =</span> <span class="fu">length</span>(data<span class="sc">$</span>responses),</span>
<span id="cb645-30"><a href="prototype-based-models-of-categorization.html#cb645-30" tabindex="-1"></a>    <span class="at">nfeatures =</span> <span class="fu">ncol</span>(data<span class="sc">$</span>obs),</span>
<span id="cb645-31"><a href="prototype-based-models-of-categorization.html#cb645-31" tabindex="-1"></a>    <span class="at">cat_one =</span> data<span class="sc">$</span>cat_one,</span>
<span id="cb645-32"><a href="prototype-based-models-of-categorization.html#cb645-32" tabindex="-1"></a>    <span class="at">y =</span> data<span class="sc">$</span>responses,</span>
<span id="cb645-33"><a href="prototype-based-models-of-categorization.html#cb645-33" tabindex="-1"></a>    <span class="at">obs =</span> data<span class="sc">$</span>obs,</span>
<span id="cb645-34"><a href="prototype-based-models-of-categorization.html#cb645-34" tabindex="-1"></a>    <span class="at">b =</span> <span class="fl">0.5</span>  <span class="co"># Assuming no response bias</span></span>
<span id="cb645-35"><a href="prototype-based-models-of-categorization.html#cb645-35" tabindex="-1"></a>  )</span>
<span id="cb645-36"><a href="prototype-based-models-of-categorization.html#cb645-36" tabindex="-1"></a>}</span>
<span id="cb645-37"><a href="prototype-based-models-of-categorization.html#cb645-37" tabindex="-1"></a></span>
<span id="cb645-38"><a href="prototype-based-models-of-categorization.html#cb645-38" tabindex="-1"></a></span>
<span id="cb645-39"><a href="prototype-based-models-of-categorization.html#cb645-39" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations) {</span>
<span id="cb645-40"><a href="prototype-based-models-of-categorization.html#cb645-40" tabindex="-1"></a></span>
<span id="cb645-41"><a href="prototype-based-models-of-categorization.html#cb645-41" tabindex="-1"></a><span class="co"># Generate synthetic data across a range of r_values</span></span>
<span id="cb645-42"><a href="prototype-based-models-of-categorization.html#cb645-42" tabindex="-1"></a>r_values_to_test <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">4.0</span>, <span class="fl">5.0</span>)</span>
<span id="cb645-43"><a href="prototype-based-models-of-categorization.html#cb645-43" tabindex="-1"></a>recovery_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb645-44"><a href="prototype-based-models-of-categorization.html#cb645-44" tabindex="-1"></a>  <span class="at">true_r_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb645-45"><a href="prototype-based-models-of-categorization.html#cb645-45" tabindex="-1"></a>  <span class="at">estimated_r_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb645-46"><a href="prototype-based-models-of-categorization.html#cb645-46" tabindex="-1"></a>  <span class="at">est_lower =</span> <span class="fu">numeric</span>(),</span>
<span id="cb645-47"><a href="prototype-based-models-of-categorization.html#cb645-47" tabindex="-1"></a>  <span class="at">est_upper =</span> <span class="fu">numeric</span>()</span>
<span id="cb645-48"><a href="prototype-based-models-of-categorization.html#cb645-48" tabindex="-1"></a>)</span>
<span id="cb645-49"><a href="prototype-based-models-of-categorization.html#cb645-49" tabindex="-1"></a></span>
<span id="cb645-50"><a href="prototype-based-models-of-categorization.html#cb645-50" tabindex="-1"></a><span class="co"># For each true r_value, generate data and fit the model</span></span>
<span id="cb645-51"><a href="prototype-based-models-of-categorization.html#cb645-51" tabindex="-1"></a><span class="cf">for</span> (r_val <span class="cf">in</span> r_values_to_test) {</span>
<span id="cb645-52"><a href="prototype-based-models-of-categorization.html#cb645-52" tabindex="-1"></a>  <span class="co"># Generate synthetic data</span></span>
<span id="cb645-53"><a href="prototype-based-models-of-categorization.html#cb645-53" tabindex="-1"></a>  synth_data <span class="ot">&lt;-</span> <span class="fu">generate_prototype_data</span>(r_val)</span>
<span id="cb645-54"><a href="prototype-based-models-of-categorization.html#cb645-54" tabindex="-1"></a>  </span>
<span id="cb645-55"><a href="prototype-based-models-of-categorization.html#cb645-55" tabindex="-1"></a>  <span class="co"># Prepare for Stan</span></span>
<span id="cb645-56"><a href="prototype-based-models-of-categorization.html#cb645-56" tabindex="-1"></a>  stan_data <span class="ot">&lt;-</span> <span class="fu">prepare_prototype_stan_data</span>(synth_data)</span>
<span id="cb645-57"><a href="prototype-based-models-of-categorization.html#cb645-57" tabindex="-1"></a>  </span>
<span id="cb645-58"><a href="prototype-based-models-of-categorization.html#cb645-58" tabindex="-1"></a>  <span class="co"># Fit model (assuming the Stan model is already compiled)</span></span>
<span id="cb645-59"><a href="prototype-based-models-of-categorization.html#cb645-59" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> prototype_single_stan<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb645-60"><a href="prototype-based-models-of-categorization.html#cb645-60" tabindex="-1"></a>    <span class="at">data =</span> stan_data,</span>
<span id="cb645-61"><a href="prototype-based-models-of-categorization.html#cb645-61" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb645-62"><a href="prototype-based-models-of-categorization.html#cb645-62" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb645-63"><a href="prototype-based-models-of-categorization.html#cb645-63" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb645-64"><a href="prototype-based-models-of-categorization.html#cb645-64" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb645-65"><a href="prototype-based-models-of-categorization.html#cb645-65" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb645-66"><a href="prototype-based-models-of-categorization.html#cb645-66" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb645-67"><a href="prototype-based-models-of-categorization.html#cb645-67" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb645-68"><a href="prototype-based-models-of-categorization.html#cb645-68" tabindex="-1"></a>  )</span>
<span id="cb645-69"><a href="prototype-based-models-of-categorization.html#cb645-69" tabindex="-1"></a>  </span>
<span id="cb645-70"><a href="prototype-based-models-of-categorization.html#cb645-70" tabindex="-1"></a>  <span class="co"># Extract posterior for r_value</span></span>
<span id="cb645-71"><a href="prototype-based-models-of-categorization.html#cb645-71" tabindex="-1"></a>  draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;r_value&quot;</span>))</span>
<span id="cb645-72"><a href="prototype-based-models-of-categorization.html#cb645-72" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws<span class="sc">$</span>r_value)</span>
<span id="cb645-73"><a href="prototype-based-models-of-categorization.html#cb645-73" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(draws<span class="sc">$</span>r_value, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb645-74"><a href="prototype-based-models-of-categorization.html#cb645-74" tabindex="-1"></a>  </span>
<span id="cb645-75"><a href="prototype-based-models-of-categorization.html#cb645-75" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb645-76"><a href="prototype-based-models-of-categorization.html#cb645-76" tabindex="-1"></a>  recovery_results <span class="ot">&lt;-</span> recovery_results <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(</span>
<span id="cb645-77"><a href="prototype-based-models-of-categorization.html#cb645-77" tabindex="-1"></a>    <span class="at">true_r_value =</span> r_val,</span>
<span id="cb645-78"><a href="prototype-based-models-of-categorization.html#cb645-78" tabindex="-1"></a>    <span class="at">estimated_r_value =</span> estimate,</span>
<span id="cb645-79"><a href="prototype-based-models-of-categorization.html#cb645-79" tabindex="-1"></a>    <span class="at">est_lower =</span> ci[<span class="dv">1</span>],</span>
<span id="cb645-80"><a href="prototype-based-models-of-categorization.html#cb645-80" tabindex="-1"></a>    <span class="at">est_upper =</span> ci[<span class="dv">2</span>]</span>
<span id="cb645-81"><a href="prototype-based-models-of-categorization.html#cb645-81" tabindex="-1"></a>  )</span>
<span id="cb645-82"><a href="prototype-based-models-of-categorization.html#cb645-82" tabindex="-1"></a>}</span>
<span id="cb645-83"><a href="prototype-based-models-of-categorization.html#cb645-83" tabindex="-1"></a></span>
<span id="cb645-84"><a href="prototype-based-models-of-categorization.html#cb645-84" tabindex="-1"></a>  <span class="co"># Save model fits</span></span>
<span id="cb645-85"><a href="prototype-based-models-of-categorization.html#cb645-85" tabindex="-1"></a>  <span class="fu">write_csv</span>(recovery_results, <span class="st">&quot;simdata/W12_prototype_recovery.csv&quot;</span>)</span>
<span id="cb645-86"><a href="prototype-based-models-of-categorization.html#cb645-86" tabindex="-1"></a>  </span>
<span id="cb645-87"><a href="prototype-based-models-of-categorization.html#cb645-87" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Models fitted and saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb645-88"><a href="prototype-based-models-of-categorization.html#cb645-88" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb645-89"><a href="prototype-based-models-of-categorization.html#cb645-89" tabindex="-1"></a>  <span class="co"># Load existing model fits</span></span>
<span id="cb645-90"><a href="prototype-based-models-of-categorization.html#cb645-90" tabindex="-1"></a>  recovery_results <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;simdata/W12_prototype_recovery.csv&quot;</span>)</span>
<span id="cb645-91"><a href="prototype-based-models-of-categorization.html#cb645-91" tabindex="-1"></a>  </span>
<span id="cb645-92"><a href="prototype-based-models-of-categorization.html#cb645-92" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fits.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb645-93"><a href="prototype-based-models-of-categorization.html#cb645-93" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing model fits.</code></pre>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="prototype-based-models-of-categorization.html#cb647-1" tabindex="-1"></a><span class="co"># Visualize parameter recovery</span></span>
<span id="cb647-2"><a href="prototype-based-models-of-categorization.html#cb647-2" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_results, <span class="fu">aes</span>(<span class="at">x =</span> true_r_value, <span class="at">y =</span> estimated_r_value)) <span class="sc">+</span></span>
<span id="cb647-3"><a href="prototype-based-models-of-categorization.html#cb647-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb647-4"><a href="prototype-based-models-of-categorization.html#cb647-4" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> est_lower, <span class="at">ymax =</span> est_upper), <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb647-5"><a href="prototype-based-models-of-categorization.html#cb647-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb647-6"><a href="prototype-based-models-of-categorization.html#cb647-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb647-7"><a href="prototype-based-models-of-categorization.html#cb647-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Parameter Recovery for Prototype Model&quot;</span>,</span>
<span id="cb647-8"><a href="prototype-based-models-of-categorization.html#cb647-8" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Error bars show 95% credible intervals&quot;</span>,</span>
<span id="cb647-9"><a href="prototype-based-models-of-categorization.html#cb647-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True r-value&quot;</span>,</span>
<span id="cb647-10"><a href="prototype-based-models-of-categorization.html#cb647-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated r-value&quot;</span></span>
<span id="cb647-11"><a href="prototype-based-models-of-categorization.html#cb647-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb647-12"><a href="prototype-based-models-of-categorization.html#cb647-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/12%20prototype%20parameter%20recovery-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Good parameter recovery would show estimated values close to the true values (points near the diagonal line) with reasonable uncertainty (error bars that include the true value). Poor recovery would indicate potential issues with the model’s identifiability or implementation.</p>
<p>This parameter recovery clearly sucks :-) Such is the life of the modeler, sometimes your generative model (the simulation) makes perfect sense, but the inference just doesn’t work out. I’ll try different formalizations of the prototype model in the next year(s).</p>
</div>
<div id="cognitive-insights-from-the-prototype-model" class="section level2 hasAnchor" number="13.10">
<h2><span class="header-section-number">13.10</span> Cognitive Insights from the Prototype Model<a href="prototype-based-models-of-categorization.html#cognitive-insights-from-the-prototype-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="incremental-learning" class="section level3 hasAnchor" number="13.10.1">
<h3><span class="header-section-number">13.10.1</span> 1. Incremental Learning<a href="prototype-based-models-of-categorization.html#incremental-learning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Kalman filter model captures the dynamic, incremental nature of human learning (n.b. not all prototype models do that, some compute a static average based on some training data and never update it). People don’t wait to see all examples before forming a category representation—they update their understanding with each new example.</p>
</div>
<div id="uncertainty-driven-learning" class="section level3 hasAnchor" number="13.10.2">
<h3><span class="header-section-number">13.10.2</span> 2. Uncertainty-Driven Learning<a href="prototype-based-models-of-categorization.html#uncertainty-driven-learning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Kalman gain modulates learning based on uncertainty, mirroring how humans learn faster when their knowledge is uncertain and more slowly as they become confident. This creates a natural “fast-then-slow” learning curve similar to what we observe in human behavior.</p>
</div>
<div id="selective-attention-emerges-naturally" class="section level3 hasAnchor" number="13.10.3">
<h3><span class="header-section-number">13.10.3</span> 3. Selective Attention Emerges Naturally<a href="prototype-based-models-of-categorization.html#selective-attention-emerges-naturally" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Though we didn’t implement it explicitly, the Kalman filter can naturally develop different levels of certainty along different feature dimensions (as the uncertainty can vary between dimensions). This creates an emergent form of selective attention without requiring explicit attention parameters like in the GCM. These uncertainty estimates can be extracted and used to better understand the data on which the model is fitted.</p>
</div>
<div id="memory-efficiency" class="section level3 hasAnchor" number="13.10.4">
<h3><span class="header-section-number">13.10.4</span> 4. Memory Efficiency<a href="prototype-based-models-of-categorization.html#memory-efficiency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prototype models provide a computationally efficient account of categorization, storing only summary statistics rather than individual exemplars. This aligns with the fact that humans can effectively categorize even when their memory for specific examples is poor.</p>
</div>
</div>
<div id="contrasting-with-exemplar-models" class="section level2 hasAnchor" number="13.11">
<h2><span class="header-section-number">13.11</span> Contrasting with Exemplar Models<a href="prototype-based-models-of-categorization.html#contrasting-with-exemplar-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p><strong>Memory Requirements</strong>: The prototype model stores only means and covariance matrices—a fixed memory footprint regardless of category size. The exemplar model’s memory requirements grow linearly with the number of examples.</p></li>
<li><p><strong>Abstraction</strong>: The prototype model abstracts away individual examples, focusing on the central tendency. The exemplar model preserves the details of each individual example.</p></li>
<li><p><strong>Decision Boundaries</strong>: Prototype models typically produce smoother, more regular decision boundaries based on distance from category centers. Exemplar models can produce more complex boundaries shaped by the specific distribution of examples.</p></li>
<li><p><strong>Behavioral Predictions</strong>:</p>
<ul>
<li>Prototype models predict that the most typical (central) members will be categorized most easily (e.g. more accurately, but perhaps also faster)</li>
<li>Exemplar models predict advantages for distinctive or isolated exemplars</li>
<li>Prototype models predict poorer memory for specific examples if we encounter them again</li>
</ul></li>
<li><p><strong>Forgetting</strong>: The prototype model naturally accommodates forgetting of specific examples, while the exemplar model would need an explicit forgetting mechanism.</p></li>
</ol>
</div>
<div id="strengths-of-the-prototype-approach" class="section level2 hasAnchor" number="13.12">
<h2><span class="header-section-number">13.12</span> Strengths of the Prototype Approach<a href="prototype-based-models-of-categorization.html#strengths-of-the-prototype-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The prototype approach has several strengths as a model of human categorization:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Cognitive Efficiency</strong>: Prototypes provide an efficient summary of category information, requiring minimal memory resources.</p></li>
<li><p><strong>Handling Noise</strong>: By averaging across examples, prototype models naturally handle noisy or variable data.</p></li>
<li><p><strong>Graceful Degradation</strong>: Prototype representations remain robust even when specific exemplars are forgotten.</p></li>
<li><p><strong>Explanation of Typicality Effects</strong>: Prototype models naturally explain why typical category members are processed more fluently.</p></li>
<li><p><strong>Good Fit for Natural Categories</strong>: Many natural categories have a graded, prototype structure (e.g., birds, furniture) that prototype models capture well.</p></li>
</ol>
</div>
<div id="limitations-of-the-prototype-approach" class="section level2 hasAnchor" number="13.13">
<h2><span class="header-section-number">13.13</span> Limitations of the Prototype Approach<a href="prototype-based-models-of-categorization.html#limitations-of-the-prototype-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Despite its strengths, the prototype approach also has important limitations:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Difficulty with Complex Categories</strong>: Prototype models struggle with categories that have complex internal structure, such as those defined by rules or relations.</p></li>
<li><p><strong>Limited Use of Distributional Information</strong>: By focusing on central tendency, traditional prototype models ignore useful information about the distribution of features.</p></li>
<li><p><strong>Insensitivity to Specific Examples</strong>: Prototype models can’t easily account for cases where specific examples strongly influence categorization decisions.</p></li>
<li><p><strong>Challenge of Disjunctive Categories</strong>: Categories with multiple distinct clusters (e.g., the category of “games”) are difficult for single-prototype models to handle.</p></li>
</ol>
</div>
<div id="extensions-to-the-basic-model" class="section level2 hasAnchor" number="13.14">
<h2><span class="header-section-number">13.14</span> Extensions to the Basic Model<a href="prototype-based-models-of-categorization.html#extensions-to-the-basic-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Several extensions can address some of these limitations:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Multiple Prototypes per Category</strong>: Allow categories to be represented by multiple prototypes, better handling disjunctive categories (e.g. via k-means).</p></li>
<li><p><strong>Feature Correlations</strong>: Explicitly model correlations between features in the prototype representation.</p></li>
<li><p><strong>Hierarchical Structure</strong>: Implement hierarchical prototype models to capture taxonomic category structures.</p></li>
<li><p><strong>Mixture of Prototypes and Exemplars</strong>: Combine elements of both approaches, using prototypes for more similar exemplars and remember the exemplars that are further from the prototype.</p></li>
</ol>
</div>
<div id="conclusion-the-prototype-and-exemplar-debate" class="section level2 hasAnchor" number="13.15">
<h2><span class="header-section-number">13.15</span> Conclusion: The Prototype and Exemplar Debate<a href="prototype-based-models-of-categorization.html#conclusion-the-prototype-and-exemplar-debate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The debate between prototype and exemplar theories of categorization has been one of the most productive in cognitive psychology, leading to refined theories and empirical tests that have deepened our understanding of human categorization.</p>
<p>Current evidence suggests that neither approach alone fully accounts for human categorization behavior:</p>
<ol style="list-style-type: decimal">
<li><p>Humans show prototype effects, categorizing items more quickly and accurately when they’re close to the category center.</p></li>
<li><p>Humans also show exemplar effects, being influenced by specific, distinctive examples and showing correlations between recognition and categorization performance.</p></li>
<li><p>Many researchers now favor hybrid or multiple-system accounts, where prototype-based and exemplar-based processes coexist and potentially interact.</p></li>
</ol>
<p>The Kalman filter implementation of prototype learning provides a dynamic, uncertainty-sensitive approach that addresses some criticisms of traditional prototype models while maintaining their cognitive efficiency. By integrating ideas from Bayesian learning theory with classic prototype models, this approach offers a sophisticated account of category learning that can be directly compared with exemplar models like the GCM.</p>
<div id="the-prototype-exemplar-spectrum-and-multiple-prototype-models" class="section level3 hasAnchor" number="13.15.1">
<h3><span class="header-section-number">13.15.1</span> The Prototype-Exemplar Spectrum and Multiple-Prototype Models<a href="prototype-based-models-of-categorization.html#the-prototype-exemplar-spectrum-and-multiple-prototype-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It’s important to recognize that prototype and exemplar models are not strictly distinct approaches, but rather represent two ends of a theoretical spectrum. The core difference lies in the granularity of representation: exemplar models store all individual instances, while traditional prototype models store a single central tendency. However, we can imagine a continuum of intermediate approaches:</p>
<ul>
<li><p>Pure exemplar models: Store all instances with no abstraction</p></li>
<li><p>Clustered exemplar models: Store instances but group similar ones</p></li>
<li><p>Multiple-prototype models: Store several prototypes per category</p></li>
<li><p>Single-prototype models: Store one prototype per category</p></li>
</ul>
<p>Multiple-prototype models offer an appealing middle ground that maintains much of the computational efficiency of prototype models while capturing more complex category structures. There are several ways to extend our Kalman filter approach to implement multiple centroids per category:</p>
<ul>
<li><p>K-means clustering: First cluster the exemplars of each category into k subclusters, then apply the Kalman filter separately to each cluster</p></li>
<li><p>Mixture of Gaussians: Represent each category as a mixture of Gaussian distributions, with each component tracking a different subcategory prototype</p></li>
<li><p>Adaptive resonance theory: Dynamically create new prototypes when an observation is too dissimilar from existing prototypes</p></li>
<li><p>Splitting criteria: Monitor the variance of exemplars around each prototype and split the prototype when variance exceeds a threshold</p></li>
</ul>
<p>In the next section, we’ll explore the third major approach to categorization: rule-based models, which represent a fundamentally different perspective on how humans organize the world into categories.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-categorization-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/12-CategorizationModelsPrototypes.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
