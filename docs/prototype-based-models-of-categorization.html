<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Prototype-Based Models of Categorization | Chapter 13: Rule-Based Models - Learning Explicit Criteria</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Prototype-Based Models of Categorization | Chapter 13: Rule-Based Models - Learning Explicit Criteria" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Prototype-Based Models of Categorization | Chapter 13: Rule-Based Models - Learning Explicit Criteria" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-04-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-categorization-models.html"/>
<link rel="next" href="rule-based-models-of-categorization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.4</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.5</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
<li class="chapter" data-level="5.7.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.7.2</b> Connection to Kalman Filters</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.2</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#bayesian-memory-agent"><i class="fa fa-check"></i><b>5.9</b> Bayesian memory agent</a></li>
<li class="chapter" data-level="5.10" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.10</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#complete-pooling"><i class="fa fa-check"></i><b>7.3.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="7.3.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#no-pooling"><i class="fa fa-check"></i><b>7.3.2</b> No Pooling</a></li>
<li class="chapter" data-level="7.3.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#partial-pooling-multilevel-modeling"><i class="fa fa-check"></i><b>7.3.3</b> Partial Pooling (Multilevel Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#graphical-model-visualization"><i class="fa fa-check"></i><b>7.4</b> Graphical Model Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#biased-agent-model"><i class="fa fa-check"></i><b>7.4.1</b> Biased Agent Model</a></li>
<li class="chapter" data-level="7.4.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#memory-agent-model"><i class="fa fa-check"></i><b>7.4.2</b> Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random-agent-model"><i class="fa fa-check"></i><b>7.8</b> Multilevel Random Agent Model</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.8.1</b> Assessing multilevel random agents</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#lets-look-at-individuals"><i class="fa fa-check"></i><b>7.9</b> Let’s look at individuals</a></li>
<li class="chapter" data-level="7.10" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-sensitivity-checks"><i class="fa fa-check"></i><b>7.10</b> Prior sensitivity checks</a></li>
<li class="chapter" data-level="7.11" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-1"><i class="fa fa-check"></i><b>7.11</b> Parameter recovery</a></li>
<li class="chapter" data-level="7.12" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-agent-model"><i class="fa fa-check"></i><b>7.12</b> Multilevel Memory Agent Model</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.12.1</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#diagnosing-the-issue-with-bias-and-beta"><i class="fa fa-check"></i><b>7.12.2</b> Diagnosing the issue with bias and beta</a></li>
<li class="chapter" data-level="7.12.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.12.3</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.12.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.12.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.12.5</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.12.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.12.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#section"><i class="fa fa-check"></i><b>7.12.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches"><i class="fa fa-check"></i><b>7.13</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.14" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches-1"><i class="fa fa-check"></i><b>7.14</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.15" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-modeling-cheatsheet"><i class="fa fa-check"></i><b>7.15</b> Multilevel Modeling Cheatsheet</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#when-to-use-each-pooling-approach"><i class="fa fa-check"></i><b>7.15.1</b> When to Use Each Pooling Approach:</a></li>
<li class="chapter" data-level="7.15.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-rules-of-thumb"><i class="fa fa-check"></i><b>7.15.2</b> Parameter Recovery Rules of Thumb:</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#conclusion-the-power-and-challenges-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.16</b> Conclusion: The Power and Challenges of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.17" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#exercises-just-some-ideas"><i class="fa fa-check"></i><b>7.17</b> Exercises (just some ideas)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-challenge-of-model-selection"><i class="fa fa-check"></i><b>8.2.1</b> The Challenge of Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-the-foundation-of-model-comparison"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation: The Foundation of Model Comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-problem-of-overfitting"><i class="fa fa-check"></i><b>8.3.1</b> The Problem of Overfitting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-cross-validation-works"><i class="fa fa-check"></i><b>8.3.2</b> How Cross-Validation Works</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-in-bayesian-models"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation in Bayesian Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#expected-log-predictive-density-elpd"><i class="fa fa-check"></i><b>8.3.4</b> Expected Log Predictive Density (ELPD)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-an-efficient-approximation-to-loo-cv"><i class="fa fa-check"></i><b>8.4</b> PSIS-LOO: An Efficient Approximation to LOO-CV</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-importance-sampling-works"><i class="fa fa-check"></i><b>8.4.1</b> How Importance Sampling Works</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#pareto-smoothing-for-stability"><i class="fa fa-check"></i><b>8.4.2</b> Pareto Smoothing for Stability</a></li>
<li class="chapter" data-level="8.4.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-complete-psis-loo-process"><i class="fa fa-check"></i><b>8.4.3</b> The Complete PSIS-LOO Process</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#simulation-based-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Simulation-Based Model Comparison</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-simulation-parameters"><i class="fa fa-check"></i><b>8.5.1</b> Define Simulation Parameters</a></li>
<li class="chapter" data-level="8.5.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-agent-functions"><i class="fa fa-check"></i><b>8.5.2</b> Define Agent Functions</a></li>
<li class="chapter" data-level="8.5.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generate-simulation-data"><i class="fa fa-check"></i><b>8.5.3</b> Generate Simulation Data</a></li>
<li class="chapter" data-level="8.5.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualize-the-simulation-data"><i class="fa fa-check"></i><b>8.5.4</b> Visualize the Simulation Data</a></li>
<li class="chapter" data-level="8.5.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prepare-data-for-stan-models"><i class="fa fa-check"></i><b>8.5.5</b> Prepare Data for Stan Models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-models-for-comparison"><i class="fa fa-check"></i><b>8.6</b> Implementing Models for Comparison</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#understanding-log-likelihood-in-model-comparison"><i class="fa fa-check"></i><b>8.6.1</b> Understanding Log-Likelihood in Model Comparison</a></li>
<li class="chapter" data-level="8.6.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-biased-agent-model"><i class="fa fa-check"></i><b>8.6.2</b> Multilevel Biased Agent Model</a></li>
<li class="chapter" data-level="8.6.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-agent-model-1"><i class="fa fa-check"></i><b>8.6.3</b> Multilevel Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-models-and-calculating-expected-log-predictive-density"><i class="fa fa-check"></i><b>8.7</b> Fitting Models and Calculating Expected Log Predictive Density</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-for-model-comparison"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation for Model Comparison</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-comparison"><i class="fa fa-check"></i><b>8.9.1</b> PSIS-LOO Comparison</a></li>
<li class="chapter" data-level="8.9.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualizing-loo-cv-results"><i class="fa fa-check"></i><b>8.9.2</b> Visualizing LOO-CV Results</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#formal-model-comparison"><i class="fa fa-check"></i><b>8.10</b> Formal Model Comparison</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#k-fold-cross-validation-for-validation"><i class="fa fa-check"></i><b>8.10.1</b> K-Fold Cross-Validation for Validation</a></li>
<li class="chapter" data-level="8.10.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#comparing-loo-and-k-fold-results"><i class="fa fa-check"></i><b>8.10.2</b> Comparing LOO and K-Fold Results</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-approaches"><i class="fa fa-check"></i><b>8.11</b> Limitations of Model Comparison Approaches</a></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#exercises"><i class="fa fa-check"></i><b>8.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.12.1</b> Rant on internal vs external validity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>9</b> Mixture models</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="mixture-models.html"><a href="mixture-models.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.0.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.0.2" data-path="mixture-models.html"><a href="mixture-models.html#chapter-roadmap"><i class="fa fa-check"></i><b>9.0.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="9.1" data-path="mixture-models.html"><a href="mixture-models.html#visualizing-mixture-distributions-reaction-time-example"><i class="fa fa-check"></i><b>9.1</b> Visualizing Mixture Distributions: Reaction Time Example</a></li>
<li class="chapter" data-level="9.2" data-path="mixture-models.html"><a href="mixture-models.html#theoretical-foundation-for-mixture-models"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation for Mixture Models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mixture-models.html"><a href="mixture-models.html#the-mixture-model-framework"><i class="fa fa-check"></i><b>9.2.1</b> The Mixture Model Framework</a></li>
<li class="chapter" data-level="9.2.2" data-path="mixture-models.html"><a href="mixture-models.html#mixture-models-and-latent-variables"><i class="fa fa-check"></i><b>9.2.2</b> Mixture Models and Latent Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-in-cognitive-modeling"><i class="fa fa-check"></i><b>9.2.3</b> Applications in Cognitive Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mixture-models.html"><a href="mixture-models.html#implementing-a-basic-mixture-model"><i class="fa fa-check"></i><b>9.3</b> Implementing a Basic Mixture Model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixture-models.html"><a href="mixture-models.html#simulating-mixed-strategy-data"><i class="fa fa-check"></i><b>9.3.1</b> Simulating Mixed Strategy Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation-of-a-mixture-model"><i class="fa fa-check"></i><b>9.3.2</b> Stan Implementation of a Mixture Model</a></li>
<li class="chapter" data-level="9.3.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-mixture-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting and Evaluating the Mixture Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="mixture-models.html"><a href="mixture-models.html#model-diagnostics"><i class="fa fa-check"></i><b>9.3.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="9.3.5" data-path="mixture-models.html"><a href="mixture-models.html#parameter-recovery-analysis"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="9.3.6" data-path="mixture-models.html"><a href="mixture-models.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>9.3.6</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixture-models.html"><a href="mixture-models.html#parameter-interpretation"><i class="fa fa-check"></i><b>9.4</b> Parameter Interpretation</a></li>
<li class="chapter" data-level="9.5" data-path="mixture-models.html"><a href="mixture-models.html#multilevel-mixture-models"><i class="fa fa-check"></i><b>9.5</b> Multilevel Mixture Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation"><i class="fa fa-check"></i><b>9.5.1</b> Stan Implementation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mixture-models.html"><a href="mixture-models.html#preparing-data-for-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.2</b> Preparing Data for the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.3</b> Fitting and Evaluating the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.4" data-path="mixture-models.html"><a href="mixture-models.html#examining-individual-differences"><i class="fa fa-check"></i><b>9.5.4</b> Examining Individual Differences</a></li>
<li class="chapter" data-level="9.5.5" data-path="mixture-models.html"><a href="mixture-models.html#interpreting-parameter-correlations"><i class="fa fa-check"></i><b>9.5.5</b> Interpreting Parameter Correlations</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mixture-models.html"><a href="mixture-models.html#comparing-single-process-and-mixture-models"><i class="fa fa-check"></i><b>9.6</b> Comparing Single-Process and Mixture Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mixture-models.html"><a href="mixture-models.html#single-process-model"><i class="fa fa-check"></i><b>9.6.1</b> Single-Process Model</a></li>
<li class="chapter" data-level="9.6.2" data-path="mixture-models.html"><a href="mixture-models.html#model-comparison"><i class="fa fa-check"></i><b>9.6.2</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-of-mixture-models-in-cognitive-science"><i class="fa fa-check"></i><b>9.6.3</b> Applications of Mixture Models in Cognitive Science</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mixture-models.html"><a href="mixture-models.html#conclusion-2"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html"><i class="fa fa-check"></i><b>10</b> Win-Stay-Lose-Shift: A Heuristic Decision Strategy</a>
<ul>
<li class="chapter" data-level="10.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#loading-required-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading Required Packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#generating-data-simulating-wsls-agents"><i class="fa fa-check"></i><b>10.2</b> Generating Data: Simulating WSLS Agents</a></li>
<li class="chapter" data-level="10.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#data-processing-and-initial-visualization"><i class="fa fa-check"></i><b>10.3</b> Data Processing and Initial Visualization</a></li>
<li class="chapter" data-level="10.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#verifying-model-properties-and-assumptions"><i class="fa fa-check"></i><b>10.4</b> Verifying Model Properties and Assumptions</a></li>
<li class="chapter" data-level="10.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#modeling-a-single-wsls-agent"><i class="fa fa-check"></i><b>10.5</b> Modeling a Single WSLS Agent</a></li>
<li class="chapter" data-level="10.6" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#multilevel-wsls-model"><i class="fa fa-check"></i><b>10.6</b> Multilevel WSLS Model</a></li>
<li class="chapter" data-level="10.7" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#quality-checks-and-parameter-recovery"><i class="fa fa-check"></i><b>10.7</b> Quality Checks and Parameter Recovery</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#convergence-diagnostics"><i class="fa fa-check"></i><b>10.7.1</b> Convergence Diagnostics</a></li>
<li class="chapter" data-level="10.7.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#prior-posterior-update-visualization"><i class="fa fa-check"></i><b>10.7.2</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="10.7.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#individual-level-parameter-recovery"><i class="fa fa-check"></i><b>10.7.3</b> Individual-Level Parameter Recovery</a></li>
<li class="chapter" data-level="10.7.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#posterior-predictive-checks-2"><i class="fa fa-check"></i><b>10.7.4</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="10.7.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#model-comparison-with-loo-cv"><i class="fa fa-check"></i><b>10.7.5</b> Model Comparison with LOO-CV</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>11</b> Bayesian Models of Cognition</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#introduction-4"><i class="fa fa-check"></i><b>11.0.1</b> Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#learning-objectives-4"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#chapter-roadmap-1"><i class="fa fa-check"></i><b>11.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition"><i class="fa fa-check"></i><b>11.3</b> The Bayesian Framework for Cognition</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating"><i class="fa fa-check"></i><b>11.4</b> Visualizing Bayesian Updating</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science"><i class="fa fa-check"></i><b>11.5</b> Bayesian Models in Cognitive Science</a></li>
<li class="chapter" data-level="11.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making"><i class="fa fa-check"></i><b>11.6</b> Example: Social Influence in Perceptual Decision-Making</a></li>
<li class="chapter" data-level="11.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task"><i class="fa fa-check"></i><b>11.7</b> A Bayesian Integration Model for the Marble Task</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions"><i class="fa fa-check"></i><b>11.7.1</b> Intuitive Explanation Using Beta Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model"><i class="fa fa-check"></i><b>11.8</b> The Mathematical Model</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evidence-representation"><i class="fa fa-check"></i><b>11.8.1</b> Evidence Representation</a></li>
<li class="chapter" data-level="11.8.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration"><i class="fa fa-check"></i><b>11.8.2</b> Integration</a></li>
<li class="chapter" data-level="11.8.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#decision"><i class="fa fa-check"></i><b>11.8.3</b> Decision</a></li>
<li class="chapter" data-level="11.8.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation-in-r"><i class="fa fa-check"></i><b>11.8.4</b> Implementation in R</a></li>
<li class="chapter" data-level="11.8.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios"><i class="fa fa-check"></i><b>11.8.5</b> Simulating Experimental Scenarios</a></li>
<li class="chapter" data-level="11.8.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration"><i class="fa fa-check"></i><b>11.8.6</b> Visualizing Bayesian Integration</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios"><i class="fa fa-check"></i><b>11.9</b> Examining Belief Distributions for Selected Scenarios</a></li>
<li class="chapter" data-level="11.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10</b> Weighted Bayesian Integration</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model-1"><i class="fa fa-check"></i><b>11.10.1</b> The Mathematical Model</a></li>
<li class="chapter" data-level="11.10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation"><i class="fa fa-check"></i><b>11.10.2</b> Implementation</a></li>
<li class="chapter" data-level="11.10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10.3</b> Visualizing Weighted Bayesian Integration</a></li>
<li class="chapter" data-level="11.10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence"><i class="fa fa-check"></i><b>11.10.4</b> Resolving Conflicting Evidence</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#common-misinterpretations"><i class="fa fa-check"></i><b>11.11</b> Common Misinterpretations</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weight-interpretation"><i class="fa fa-check"></i><b>11.11.1</b> Weight Interpretation</a></li>
<li class="chapter" data-level="11.11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration-vs.-averaging"><i class="fa fa-check"></i><b>11.11.2</b> Integration vs. Averaging</a></li>
<li class="chapter" data-level="11.11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#interpreting-confidence"><i class="fa fa-check"></i><b>11.11.3</b> Interpreting Confidence</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies"><i class="fa fa-check"></i><b>11.12</b> Simulating Agents with Different Evidence Weighting Strategies</a></li>
<li class="chapter" data-level="11.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation"><i class="fa fa-check"></i><b>11.13</b> Key Observations from the Simulation</a></li>
<li class="chapter" data-level="11.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-quality-checks"><i class="fa fa-check"></i><b>11.14</b> Model Quality Checks</a>
<ul>
<li class="chapter" data-level="11.14.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#overview"><i class="fa fa-check"></i><b>11.14.1</b> Overview</a></li>
<li class="chapter" data-level="11.14.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks"><i class="fa fa-check"></i><b>11.14.2</b> Prior and Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="11.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization-1"><i class="fa fa-check"></i><b>11.15</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="11.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-2"><i class="fa fa-check"></i><b>11.16</b> Parameter recovery</a></li>
<li class="chapter" data-level="11.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-1"><i class="fa fa-check"></i><b>11.17</b> Model comparison</a></li>
<li class="chapter" data-level="11.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#leave-one-out-cross-validation-and-model-comparison"><i class="fa fa-check"></i><b>11.18</b> Leave-One-Out Cross-Validation and Model Comparison</a>
<ul>
<li class="chapter" data-level="11.18.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-loo-cross-validation-in-bayesian-framework"><i class="fa fa-check"></i><b>11.18.1</b> Understanding LOO Cross-Validation in Bayesian Framework</a></li>
<li class="chapter" data-level="11.18.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#step-by-step-implementation-of-loo-cv"><i class="fa fa-check"></i><b>11.18.2</b> Step-by-Step Implementation of LOO-CV</a></li>
<li class="chapter" data-level="11.18.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-psis-loo-diagnostics"><i class="fa fa-check"></i><b>11.18.3</b> Understanding PSIS-LOO Diagnostics</a></li>
<li class="chapter" data-level="11.18.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-for-each-scenario"><i class="fa fa-check"></i><b>11.18.4</b> Model Comparison for Each Scenario</a></li>
<li class="chapter" data-level="11.18.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-the-comparison-results"><i class="fa fa-check"></i><b>11.18.5</b> Visualizing the Comparison Results</a></li>
<li class="chapter" data-level="11.18.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-results"><i class="fa fa-check"></i><b>11.18.6</b> Understanding the Results</a></li>
<li class="chapter" data-level="11.18.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematics-behind-loo-cv"><i class="fa fa-check"></i><b>11.18.7</b> The Mathematics Behind LOO-CV</a></li>
<li class="chapter" data-level="11.18.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-pointwise-contributions-to-loo"><i class="fa fa-check"></i><b>11.18.8</b> Examining Pointwise Contributions to LOO</a></li>
</ul></li>
<li class="chapter" data-level="11.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models"><i class="fa fa-check"></i><b>11.19</b> Multilevel Bayesian Models</a>
<ul>
<li class="chapter" data-level="11.19.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents"><i class="fa fa-check"></i><b>11.19.1</b> Simulating Data from Multiple Agents</a></li>
<li class="chapter" data-level="11.19.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-simulated-data"><i class="fa fa-check"></i><b>11.19.2</b> Understanding the Simulated Data</a></li>
</ul></li>
<li class="chapter" data-level="11.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models-for-evidence-integration"><i class="fa fa-check"></i><b>11.20</b> Multilevel Bayesian Models for Evidence Integration</a>
<ul>
<li class="chapter" data-level="11.20.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-1-simple-evidence-integration-with-individual-scaling"><i class="fa fa-check"></i><b>11.20.1</b> Model 1: Simple Evidence Integration with Individual Scaling</a></li>
<li class="chapter" data-level="11.20.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-2-weighted-evidence-integration"><i class="fa fa-check"></i><b>11.20.2</b> Model 2: Weighted Evidence Integration</a></li>
<li class="chapter" data-level="11.20.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-allow-scaling-to-vary-in-the-simple-model"><i class="fa fa-check"></i><b>11.20.3</b> Why Allow Scaling to Vary in the Simple Model?</a></li>
</ul></li>
<li class="chapter" data-level="11.21" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#from-single-agent-to-multilevel-extending-bayesian-cognitive-models"><i class="fa fa-check"></i><b>11.21</b> From Single-Agent to Multilevel: Extending Bayesian Cognitive Models</a>
<ul>
<li class="chapter" data-level="11.21.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-components-of-the-multilevel-extension"><i class="fa fa-check"></i><b>11.21.1</b> Key Components of the Multilevel Extension</a></li>
<li class="chapter" data-level="11.21.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#hierarchical-prior-structure"><i class="fa fa-check"></i><b>11.21.2</b> 2. Hierarchical Prior Structure</a></li>
<li class="chapter" data-level="11.21.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#handling-data-from-multiple-individuals"><i class="fa fa-check"></i><b>11.21.3</b> 3. Handling Data from Multiple Individuals</a></li>
<li class="chapter" data-level="11.21.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#likelihood-specification"><i class="fa fa-check"></i><b>11.21.4</b> 4. Likelihood Specification</a></li>
<li class="chapter" data-level="11.21.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-these-changes-matter"><i class="fa fa-check"></i><b>11.21.5</b> Why These Changes Matter</a></li>
<li class="chapter" data-level="11.21.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>11.21.6</b> Implementing the Multilevel Weighted Beta-Binomial Model in Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.22" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-multilevel-models"><i class="fa fa-check"></i><b>11.22</b> Fitting the Multilevel Models</a>
<ul>
<li class="chapter" data-level="11.22.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1"><i class="fa fa-check"></i><b>11.22.1</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="11.22.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-2"><i class="fa fa-check"></i><b>11.22.2</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11.23" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#dynamic-bayesian-evidence-integration-sequential-updating-models"><i class="fa fa-check"></i><b>11.23</b> Dynamic Bayesian Evidence Integration: Sequential Updating Models</a>
<ul>
<li class="chapter" data-level="11.23.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-updating-the-theoretical-framework"><i class="fa fa-check"></i><b>11.23.1</b> Sequential Bayesian Updating: The Theoretical Framework</a></li>
<li class="chapter" data-level="11.23.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#single-agent-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.2</b> Single-Agent Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.3</b> Multilevel Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#generating-data-for-the-sequential-model"><i class="fa fa-check"></i><b>11.23.4</b> Generating Data for the Sequential Model</a></li>
<li class="chapter" data-level="11.23.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-and-evaluating-the-sequential-models"><i class="fa fa-check"></i><b>11.23.5</b> Fitting and Evaluating the Sequential Models</a></li>
</ul></li>
<li class="chapter" data-level="11.24" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-evidence-integration-models"><i class="fa fa-check"></i><b>11.24</b> Sequential Bayesian Evidence Integration Models</a>
<ul>
<li class="chapter" data-level="11.24.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-belief-updating-over-time"><i class="fa fa-check"></i><b>11.24.1</b> Understanding Belief Updating Over Time</a></li>
<li class="chapter" data-level="11.24.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-sequential-updating-framework"><i class="fa fa-check"></i><b>11.24.2</b> The Sequential Updating Framework</a></li>
<li class="chapter" data-level="11.24.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#mathematical-formulation"><i class="fa fa-check"></i><b>11.24.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="11.24.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#moving-from-single-agent-to-multilevel"><i class="fa fa-check"></i><b>11.24.4</b> Moving from Single-Agent to Multilevel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html"><i class="fa fa-check"></i><b>12</b> Introduction to Categorization Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-fundamental-problem-of-categorization"><i class="fa fa-check"></i><b>12.1</b> The Fundamental Problem of Categorization</a></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#why-model-categorization"><i class="fa fa-check"></i><b>12.2</b> Why Model Categorization?</a></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#historical-development-of-categorization-models"><i class="fa fa-check"></i><b>12.3</b> Historical Development of Categorization Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#early-views-the-classical-approach"><i class="fa fa-check"></i><b>12.3.1</b> Early Views: The Classical Approach</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-prototype-revolution"><i class="fa fa-check"></i><b>12.3.2</b> The Prototype Revolution</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-exemplar-alternative"><i class="fa fa-check"></i><b>12.3.3</b> The Exemplar Alternative</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models"><i class="fa fa-check"></i><b>12.3.4</b> Rule-Based Models</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-three-model-classes-core-assumptions-and-predictions"><i class="fa fa-check"></i><b>12.4</b> The Three Model Classes: Core Assumptions and Predictions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#exemplar-models-individual-instances-as-category-representations"><i class="fa fa-check"></i><b>12.4.1</b> Exemplar Models: Individual Instances as Category Representations</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#prototype-models-categories-as-central-tendencies"><i class="fa fa-check"></i><b>12.4.2</b> Prototype Models: Categories as Central Tendencies</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models-categories-as-decision-boundaries"><i class="fa fa-check"></i><b>12.4.3</b> Rule-Based Models: Categories as Decision Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#our-implementation-approach"><i class="fa fa-check"></i><b>12.5</b> Our Implementation Approach</a></li>
<li class="chapter" data-level="12.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.6</b> The Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-foundations-and-cognitive-principles"><i class="fa fa-check"></i><b>12.6.1</b> Mathematical Foundations and Cognitive Principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#core-assumptions-of-the-gcm"><i class="fa fa-check"></i><b>12.6.2</b> Core Assumptions of the GCM</a></li>
<li class="chapter" data-level="12.6.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-1"><i class="fa fa-check"></i><b>12.6.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="12.6.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-gcm-agent-implementation"><i class="fa fa-check"></i><b>12.6.4</b> The GCM Agent Implementation</a></li>
<li class="chapter" data-level="12.6.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-behavior-with-the-gcm"><i class="fa fa-check"></i><b>12.6.5</b> Simulating Behavior with the GCM</a></li>
<li class="chapter" data-level="12.6.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-gcm-in-stan-for-parameter-estimation"><i class="fa fa-check"></i><b>12.6.6</b> Implementing the GCM in Stan for Parameter Estimation</a></li>
<li class="chapter" data-level="12.6.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#key-parameters-and-their-cognitive-interpretations"><i class="fa fa-check"></i><b>12.6.7</b> Key Parameters and Their Cognitive Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#multilevel-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.7</b> Multilevel Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-need-for-a-multilevel-approach"><i class="fa fa-check"></i><b>12.7.1</b> The Need for a Multilevel Approach</a></li>
<li class="chapter" data-level="12.7.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-of-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.2</b> Mathematical Formulation of the Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-data-for-a-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.3</b> Simulating Data for a Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-multilevel-gcm-in-stan"><i class="fa fa-check"></i><b>12.7.4</b> Implementing the Multilevel GCM in Stan</a></li>
<li class="chapter" data-level="12.7.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#fitting-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.5</b> Fitting the Multilevel GCM</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#gcm-in-context-strengths-and-limitations"><i class="fa fa-check"></i><b>12.8</b> GCM in Context: Strengths and Limitations</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#strengths"><i class="fa fa-check"></i><b>12.8.1</b> Strengths</a></li>
<li class="chapter" data-level="12.8.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#limitations"><i class="fa fa-check"></i><b>12.8.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#some-notes-about-student-produced-models-of-categorization"><i class="fa fa-check"></i><b>12.9</b> Some notes about student-produced models of categorization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html"><i class="fa fa-check"></i><b>13</b> Prototype-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="13.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#rethinking-category-representation-from-examples-to-averages"><i class="fa fa-check"></i><b>13.1</b> Rethinking Category Representation: From Examples to Averages</a></li>
<li class="chapter" data-level="13.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#core-ideas-of-prototype-models"><i class="fa fa-check"></i><b>13.2</b> Core Ideas of Prototype Models:</a></li>
<li class="chapter" data-level="13.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#modeling-dynamic-prototypes-the-kalman-filter"><i class="fa fa-check"></i><b>13.3</b> Modeling Dynamic Prototypes: The Kalman Filter</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-kalman-filter-logic-updating-an-estimate"><i class="fa fa-check"></i><b>13.3.1</b> The Kalman Filter Logic: Updating an Estimate</a></li>
<li class="chapter" data-level="13.3.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#extending-to-multiple-features-multivariate-kalman-filter"><i class="fa fa-check"></i><b>13.3.2</b> Extending to Multiple Features: Multivariate Kalman Filter</a></li>
<li class="chapter" data-level="13.3.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-multivariate-update-in-r"><i class="fa fa-check"></i><b>13.3.3</b> Implementing the Multivariate Update in R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#building-the-full-categorization-model"><i class="fa fa-check"></i><b>13.4</b> Building the Full Categorization Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#initialization"><i class="fa fa-check"></i><b>13.4.1</b> Initialization</a></li>
<li class="chapter" data-level="13.4.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#categorization-decision"><i class="fa fa-check"></i><b>13.4.2</b> Categorization Decision</a></li>
<li class="chapter" data-level="13.4.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-learning-loop"><i class="fa fa-check"></i><b>13.4.3</b> The Learning Loop</a></li>
<li class="chapter" data-level="13.4.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#r-implementation-of-the-prototype-agent"><i class="fa fa-check"></i><b>13.4.4</b> R Implementation of the Prototype Agent</a></li>
<li class="chapter" data-level="13.4.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior"><i class="fa fa-check"></i><b>13.4.5</b> Simulating Categorization Behavior</a></li>
<li class="chapter" data-level="13.4.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#visualizing-prototype-evolution"><i class="fa fa-check"></i><b>13.4.6</b> Visualizing Prototype Evolution</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#estimating-parameters-implementing-the-prototype-model-in-stan"><i class="fa fa-check"></i><b>13.5</b> Estimating Parameters: Implementing the Prototype Model in Stan</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-stan-model-w12_prototype_single.stan"><i class="fa fa-check"></i><b>13.5.1</b> The Stan Model (W12_prototype_single.stan)</a></li>
<li class="chapter" data-level="13.5.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#parameter-recovery-can-we-retrieve-the-noise-parameter"><i class="fa fa-check"></i><b>13.5.2</b> Parameter Recovery: Can We Retrieve the Noise Parameter?</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#cognitive-insights-and-model-comparison"><i class="fa fa-check"></i><b>13.6</b> Cognitive Insights and Model Comparison</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#comparing-to-exemplar-models-gcm"><i class="fa fa-check"></i><b>13.6.1</b> Comparing to Exemplar Models (GCM):</a></li>
<li class="chapter" data-level="13.6.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#limitations-1"><i class="fa fa-check"></i><b>13.6.2</b> Limitations:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html"><i class="fa fa-check"></i><b>14</b> Rule-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#theoretical-foundations"><i class="fa fa-check"></i><b>14.1</b> Theoretical Foundations</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#core-assumptions-of-rule-based-models"><i class="fa fa-check"></i><b>14.1.1</b> Core Assumptions of Rule-Based Models</a></li>
<li class="chapter" data-level="14.1.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#rules-vs.-similarity-based-approaches"><i class="fa fa-check"></i><b>14.1.2</b> Rules vs. Similarity-Based Approaches</a></li>
<li class="chapter" data-level="14.1.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#representing-and-evaluating-rules"><i class="fa fa-check"></i><b>14.1.3</b> Representing and Evaluating Rules</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#the-challenge-searching-the-space-of-rules"><i class="fa fa-check"></i><b>14.2</b> The Challenge: Searching the Space of Rules</a></li>
<li class="chapter" data-level="14.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#the-bayesian-particle-filter-tracking-rule-hypotheses"><i class="fa fa-check"></i><b>14.3</b> The Bayesian Particle Filter: Tracking Rule Hypotheses</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-1-generating-initial-rule-particles"><i class="fa fa-check"></i><b>14.3.1</b> Step 1: Generating Initial Rule Particles</a></li>
<li class="chapter" data-level="14.3.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-2-updating-particle-weights"><i class="fa fa-check"></i><b>14.3.2</b> Step 2: Updating Particle Weights</a></li>
<li class="chapter" data-level="14.3.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-3-resampling-particles"><i class="fa fa-check"></i><b>14.3.3</b> Step 3: Resampling Particles</a></li>
<li class="chapter" data-level="14.3.4" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#putting-it-together-the-particle-filter-agent"><i class="fa fa-check"></i><b>14.3.4</b> Putting it Together: The Particle Filter Agent</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#simulating-categorization-behavior-1"><i class="fa fa-check"></i><b>14.4</b> Simulating Categorization Behavior</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#visualizing-rule-learning-over-time"><i class="fa fa-check"></i><b>14.4.1</b> Visualizing Rule Learning Over Time</a></li>
<li class="chapter" data-level="14.4.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#visualizing-the-decision-boundary"><i class="fa fa-check"></i><b>14.4.2</b> Visualizing the Decision Boundary</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#implementing-rule-based-logic-in-stan-simplified"><i class="fa fa-check"></i><b>14.5</b> Implementing Rule-Based Logic in Stan (Simplified)</a></li>
<li class="chapter" data-level="14.6" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#cognitive-insights-from-rule-based-models"><i class="fa fa-check"></i><b>14.6</b> Cognitive Insights from Rule-Based Models</a></li>
<li class="chapter" data-level="14.7" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#strengths-and-limitations"><i class="fa fa-check"></i><b>14.7</b> Strengths and Limitations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Chapter 13: Rule-Based Models - Learning Explicit Criteria</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prototype-based-models-of-categorization" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Prototype-Based Models of Categorization<a href="prototype-based-models-of-categorization.html#prototype-based-models-of-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="rethinking-category-representation-from-examples-to-averages" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Rethinking Category Representation: From Examples to Averages<a href="prototype-based-models-of-categorization.html#rethinking-category-representation-from-examples-to-averages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous chapter, we explored the Generalized Context Model (GCM), an exemplar model where every encountered example is stored in memory. This approach is powerful but raises questions about cognitive efficiency. Do we really store every single instance we encounter?
Consider learning about common categories like “birds” or “chairs”. While specific examples matter, we also seem to develop a general sense of what constitutes a typical member. Prototype theory offers an alternative perspective: instead of storing individual exemplars, the mind abstracts a summary representation — a prototype — for each category. This prototype often represents the central tendency or “average” member.</p>
</div>
<div id="core-ideas-of-prototype-models" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Core Ideas of Prototype Models:<a href="prototype-based-models-of-categorization.html#core-ideas-of-prototype-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Abstraction, Not Storage: The primary representation is a summary (the prototype), not a collection of instances.</p></li>
<li><p>Cognitive Economy: Storing one prototype per category is potentially much more memory-efficient than storing numerous exemplars.</p></li>
<li><p>Similarity to Prototype: New items are categorized based on their similarity to the stored prototypes of different categories.</p></li>
<li><p>Typicality: Items closer to a category’s prototype are judged as more “typical” members and are often categorized faster and more accurately. This contrasts with exemplar models, which emphasize detailed memory for specific instances.</p></li>
</ul>
<div class="line-block">Feature | Prototype Models | Exemplar Models (GCM) |<br />
Representation | Abstract summary (e.g., average) | Collection of individual examples |<br />
Memory Cost | Low (one prototype per category) | High (potentially all examples) |<br />
Key Information | Central tendency &amp; variance | Specific instances &amp; their labels |<br />
Sensitivity | Less sensitive to specific examples | Highly sensitive to specific examples |</div>
</div>
<div id="modeling-dynamic-prototypes-the-kalman-filter" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Modeling Dynamic Prototypes: The Kalman Filter<a href="prototype-based-models-of-categorization.html#modeling-dynamic-prototypes-the-kalman-filter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Early prototype models often calculated a static average. However, human learning is dynamic; our understanding evolves with experience. How can we model a prototype that updates incrementally as new examples are encountered?
The Kalman filter provides a suitable mathematical framework. Originally developed for tracking physical systems amidst noise, it’s well-suited for modeling prototype learning because it allows us to:</p>
<ul>
<li><p>Track an Estimate: The category prototype (its average feature values).</p></li>
<li><p>Represent Uncertainty: Maintain not just the prototype’s location but also our uncertainty about it.</p></li>
<li><p>Update Incrementally: Refine the prototype with each new example.</p></li>
<li><p>Balance Old and New: Optimally combine the current prototype (prior belief) with the new example (evidence).</p></li>
<li><p>Implement an Adaptive Learning Rate: Automatically adjust how much influence a new example has (the “Kalman gain”) based on current uncertainty. Learning is faster when uncertainty is high and slows as confidence grows.</p></li>
</ul>
<div id="the-kalman-filter-logic-updating-an-estimate" class="section level3 hasAnchor" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> The Kalman Filter Logic: Updating an Estimate<a href="prototype-based-models-of-categorization.html#the-kalman-filter-logic-updating-an-estimate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Imagine tracking a prototype based on a single feature (e.g., average height). The Kalman filter maintains:</p>
<ul>
<li><p>Estimate (<span class="math inline">\(\mu\)</span>): The current best guess for the prototype’s feature value.</p></li>
<li><p>Uncertainty (<span class="math inline">\(\sigma^2\)</span>): The variance around that estimate (higher variance = more uncertainty).</p></li>
</ul>
<p>When a new category member (observation x) arrives, we update <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>:</p>
<ul>
<li>Calculate Kalman Gain (K): This determines the learning rate, balancing current uncertainty (<span class="math inline">\(\sigma^2_{prev}\)</span>) and assumed observation noise (<span class="math inline">\(R\)</span>, variance of observations around the true prototype): <span class="math inline">\(K = \frac{\sigma^2_{prev}}{\sigma^2_{prev} + R}\)</span></li>
</ul>
<p>** If uncertainty (<span class="math inline">\(\sigma^2_{prev}\)</span>) is high, <span class="math inline">\(K\)</span> is large <span class="math inline">\(\implies\)</span> trust the new observation more.</p>
<p>** If uncertainty is low, <span class="math inline">\(K\)</span> is small <span class="math inline">\(\implies\)</span> stick closer to the current estimate.</p>
<ul>
<li>Update Estimate (<span class="math inline">\(\mu\)</span>): Move the old estimate towards the new observation, weighted by the gain: <span class="math inline">\(\mu_{new} = \mu_{prev} + K \cdot (x - \mu_{prev})\)</span></li>
</ul>
<p>** The term <span class="math inline">\((x - \mu_{prev})\)</span> is the “prediction error” or “innovation”.</p>
<ul>
<li>Update Uncertainty (<span class="math inline">\(\sigma^2\)</span>): Uncertainty always decreases (or stays the same) after incorporating an observation: <span class="math inline">\(\sigma^2_{new} = (1 - K) \cdot \sigma^2_{prev}\)</span></li>
</ul>
<p>This process repeats for every new example belonging to that category.</p>
</div>
<div id="extending-to-multiple-features-multivariate-kalman-filter" class="section level3 hasAnchor" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Extending to Multiple Features: Multivariate Kalman Filter<a href="prototype-based-models-of-categorization.html#extending-to-multiple-features-multivariate-kalman-filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our stimuli have two features (height and position). We need a multivariate version:</p>
<ul>
<li><p>Estimate (<span class="math inline">\(\vec{\mu}\)</span>): Now a vector of means (e.g., <span class="math inline">\([\mu_{height}, \mu_{position}]\)</span>).</p></li>
<li><p>Uncertainty (<span class="math inline">\(\Sigma\)</span>): Now a covariance matrix, capturing variance in each dimension and the covariance between dimensions.</p></li>
<li><p>Observation Noise (<span class="math inline">\(R\)</span>): Also a covariance matrix, representing noise in observing features. Often simplified to a diagonal matrix, assuming independent noise per feature.</p></li>
<li><p>Kalman Gain (<span class="math inline">\(K\)</span>): Now a matrix.</p></li>
</ul>
<p>The update equations become matrix operations:</p>
<ul>
<li><p>Kalman Gain (<span class="math inline">\(K\)</span>): <span class="math inline">\(K = \Sigma_{prev} (\Sigma_{prev} + R)^{-1}\)</span></p></li>
<li><p>Update Estimate (<span class="math inline">\(\vec{\mu}\)</span>): <span class="math inline">\(\vec{\mu}{new} = \vec{\mu}{prev} + K (\vec{x} - \vec{\mu}_{prev})\)</span></p></li>
<li><p>Update Uncertainty (<span class="math inline">\(\Sigma\)</span>): (Using the robust “Joseph form”) <span class="math inline">\(\Sigma_{new} = (I - K) \Sigma_{prev} (I - K)^T + K R K^T\)</span> (Where <span class="math inline">\(I\)</span> is the identity matrix)</p></li>
</ul>
</div>
<div id="implementing-the-multivariate-update-in-r" class="section level3 hasAnchor" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> Implementing the Multivariate Update in R<a href="prototype-based-models-of-categorization.html#implementing-the-multivariate-update-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s write an R function for this multivariate update step.</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="prototype-based-models-of-categorization.html#cb635-1" tabindex="-1"></a><span class="co"># Function for one update step of a multivariate Kalman filter</span></span>
<span id="cb635-2"><a href="prototype-based-models-of-categorization.html#cb635-2" tabindex="-1"></a>multivariate_kalman_update <span class="ot">&lt;-</span> <span class="cf">function</span>(mu_prev, <span class="co"># Vector of previous means</span></span>
<span id="cb635-3"><a href="prototype-based-models-of-categorization.html#cb635-3" tabindex="-1"></a>                                       sigma_prev, <span class="co"># Previous covariance matrix</span></span>
<span id="cb635-4"><a href="prototype-based-models-of-categorization.html#cb635-4" tabindex="-1"></a>                                       observation, <span class="co"># Vector of observed features</span></span>
<span id="cb635-5"><a href="prototype-based-models-of-categorization.html#cb635-5" tabindex="-1"></a>                                       r_matrix <span class="co"># Observation noise matrix</span></span>
<span id="cb635-6"><a href="prototype-based-models-of-categorization.html#cb635-6" tabindex="-1"></a>                                       ) {</span>
<span id="cb635-7"><a href="prototype-based-models-of-categorization.html#cb635-7" tabindex="-1"></a>  <span class="co"># Ensure inputs are numeric/matrix</span></span>
<span id="cb635-8"><a href="prototype-based-models-of-categorization.html#cb635-8" tabindex="-1"></a>  mu_prev <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mu_prev)</span>
<span id="cb635-9"><a href="prototype-based-models-of-categorization.html#cb635-9" tabindex="-1"></a>  observation <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(observation)</span>
<span id="cb635-10"><a href="prototype-based-models-of-categorization.html#cb635-10" tabindex="-1"></a>  sigma_prev <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sigma_prev)</span>
<span id="cb635-11"><a href="prototype-based-models-of-categorization.html#cb635-11" tabindex="-1"></a>  r_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(r_matrix)</span>
<span id="cb635-12"><a href="prototype-based-models-of-categorization.html#cb635-12" tabindex="-1"></a>  </span>
<span id="cb635-13"><a href="prototype-based-models-of-categorization.html#cb635-13" tabindex="-1"></a>  n_dim <span class="ot">&lt;-</span> <span class="fu">length</span>(mu_prev)</span>
<span id="cb635-14"><a href="prototype-based-models-of-categorization.html#cb635-14" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">diag</span>(n_dim) <span class="co"># Identity matrix</span></span>
<span id="cb635-15"><a href="prototype-based-models-of-categorization.html#cb635-15" tabindex="-1"></a>  </span>
<span id="cb635-16"><a href="prototype-based-models-of-categorization.html#cb635-16" tabindex="-1"></a>  <span class="co"># Calculate Kalman gain (K)</span></span>
<span id="cb635-17"><a href="prototype-based-models-of-categorization.html#cb635-17" tabindex="-1"></a>  <span class="co"># Use tryCatch for potential numerical issues during inversion</span></span>
<span id="cb635-18"><a href="prototype-based-models-of-categorization.html#cb635-18" tabindex="-1"></a>  combined_cov <span class="ot">&lt;-</span> sigma_prev <span class="sc">+</span> r_matrix</span>
<span id="cb635-19"><a href="prototype-based-models-of-categorization.html#cb635-19" tabindex="-1"></a>  S_inv <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">solve</span>(combined_cov), <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb635-20"><a href="prototype-based-models-of-categorization.html#cb635-20" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">&quot;Matrix inversion failed (possibly singular). Using pseudo-inverse.&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb635-21"><a href="prototype-based-models-of-categorization.html#cb635-21" tabindex="-1"></a>      MASS<span class="sc">::</span><span class="fu">ginv</span>(combined_cov) <span class="co"># Fallback using pseudo-inverse</span></span>
<span id="cb635-22"><a href="prototype-based-models-of-categorization.html#cb635-22" tabindex="-1"></a>  })</span>
<span id="cb635-23"><a href="prototype-based-models-of-categorization.html#cb635-23" tabindex="-1"></a>  k_matrix <span class="ot">&lt;-</span> sigma_prev <span class="sc">%*%</span> S_inv</span>
<span id="cb635-24"><a href="prototype-based-models-of-categorization.html#cb635-24" tabindex="-1"></a>  </span>
<span id="cb635-25"><a href="prototype-based-models-of-categorization.html#cb635-25" tabindex="-1"></a>  <span class="co"># Update mean (mu)</span></span>
<span id="cb635-26"><a href="prototype-based-models-of-categorization.html#cb635-26" tabindex="-1"></a>  innovation <span class="ot">&lt;-</span> observation <span class="sc">-</span> mu_prev <span class="co"># Prediction error</span></span>
<span id="cb635-27"><a href="prototype-based-models-of-categorization.html#cb635-27" tabindex="-1"></a>  mu_new <span class="ot">&lt;-</span> mu_prev <span class="sc">+</span> k_matrix <span class="sc">%*%</span> innovation</span>
<span id="cb635-28"><a href="prototype-based-models-of-categorization.html#cb635-28" tabindex="-1"></a>  </span>
<span id="cb635-29"><a href="prototype-based-models-of-categorization.html#cb635-29" tabindex="-1"></a>  <span class="co"># Update covariance (sigma) using Joseph form for numerical stability</span></span>
<span id="cb635-30"><a href="prototype-based-models-of-categorization.html#cb635-30" tabindex="-1"></a>  IK_term <span class="ot">&lt;-</span> (I <span class="sc">-</span> k_matrix)</span>
<span id="cb635-31"><a href="prototype-based-models-of-categorization.html#cb635-31" tabindex="-1"></a>  sigma_new <span class="ot">&lt;-</span> IK_term <span class="sc">%*%</span> sigma_prev <span class="sc">%*%</span> <span class="fu">t</span>(IK_term) <span class="sc">+</span> k_matrix <span class="sc">%*%</span> r_matrix <span class="sc">%*%</span> <span class="fu">t</span>(k_matrix)</span>
<span id="cb635-32"><a href="prototype-based-models-of-categorization.html#cb635-32" tabindex="-1"></a>  </span>
<span id="cb635-33"><a href="prototype-based-models-of-categorization.html#cb635-33" tabindex="-1"></a>  <span class="co"># Ensure symmetry (numerical precision can sometimes cause minor asymmetry)</span></span>
<span id="cb635-34"><a href="prototype-based-models-of-categorization.html#cb635-34" tabindex="-1"></a>  sigma_new <span class="ot">&lt;-</span> (sigma_new <span class="sc">+</span> <span class="fu">t</span>(sigma_new)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb635-35"><a href="prototype-based-models-of-categorization.html#cb635-35" tabindex="-1"></a>  </span>
<span id="cb635-36"><a href="prototype-based-models-of-categorization.html#cb635-36" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mu =</span> <span class="fu">as.numeric</span>(mu_new), <span class="at">sigma =</span> sigma_new, <span class="at">k =</span> k_matrix))</span>
<span id="cb635-37"><a href="prototype-based-models-of-categorization.html#cb635-37" tabindex="-1"></a>}</span></code></pre></div>
<p>This function performs a single update for one category’s prototype when it observes a new member.</p>
</div>
</div>
<div id="building-the-full-categorization-model" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Building the Full Categorization Model<a href="prototype-based-models-of-categorization.html#building-the-full-categorization-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we integrate this update mechanism into a full agent that learns prototypes for two categories and makes categorization decisions.</p>
<div id="initialization" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Initialization<a href="prototype-based-models-of-categorization.html#initialization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>We need separate prototypes (<span class="math inline">\(\mu_0, \Sigma_0\)</span> and <span class="math inline">\(\mu_1, \Sigma_1\)</span>) for Category 0 and Category 1.</p></li>
<li><p>We start with high uncertainty (large initial <span class="math inline">\(\Sigma\)</span>) and potentially uninformative means (e.g., center of the feature space or rep(0, n_features)).</p></li>
<li><p>We need to define the observation noise matrix <span class="math inline">\(R\)</span>. For simplicity, we’ll assume independent noise with the same variance <span class="math inline">\(r_{val}\)</span> for each feature: <span class="math inline">\(R = \text{diag}(r_{val}, r_{val})\)</span>. The parameter <span class="math inline">\(r_{val}\)</span> represents how much variability we assume exists within categories or in our perception of the stimuli.</p></li>
</ul>
</div>
<div id="categorization-decision" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Categorization Decision<a href="prototype-based-models-of-categorization.html#categorization-decision" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How does the model decide the category for a new stimulus <span class="math inline">\(\vec{x}\)</span>? It compares <span class="math inline">\(\vec{x}\)</span> to both prototypes, considering their current means (<span class="math inline">\(\vec{\mu}\)</span>) and uncertainties (<span class="math inline">\(\Sigma\)</span>). A natural way is to use the probability density of the multivariate normal distribution:</p>
<p><span class="math display">\[P(\vec{x} | \text{Category } C) \propto \exp\left(-\frac{1}{2}(\vec{x} - \vec{\mu}_C)^T (\Sigma_C + R)^{-1} (\vec{x} - \vec{\mu}_C)\right)\]</span></p>
<p>This essentially calculates how likely the observation <span class="math inline">\(\vec{x}\)</span> is, given the prototype distribution for category <span class="math inline">\(C\)</span> (including observation noise <span class="math inline">\(R\)</span>).</p>
<p>The probability of choosing Category 1 is then calculated using the Luce choice rule (softmax):</p>
<p><span class="math display">\[P(\text{Choose Cat 1} | \vec{x}) = \frac{P(\vec{x} | \text{Category } 1)}{P(\vec{x} | \text{Category } 0) + P(\vec{x} | \text{Category } 1)}\]</span></p>
<p>We often work with log-probabilities for numerical stability.</p>
</div>
<div id="the-learning-loop" class="section level3 hasAnchor" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> The Learning Loop<a href="prototype-based-models-of-categorization.html#the-learning-loop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The agent processes trials sequentially:</p>
<ul>
<li><p>Observe stimulus <span class="math inline">\(\vec{x}_i\)</span>.</p></li>
<li><p>Calculate <span class="math inline">\(P(\text{Choose Cat 1} | \vec{x}_i)\)</span> based on current <span class="math inline">\(\mu_0, \Sigma_0, \mu_1, \Sigma_1\)</span>.</p></li>
<li><p>Generate a response (e.g., sample from Bernoulli distribution with this probability).</p></li>
<li><p>Receive feedback (true category <span class="math inline">\(y_i\)</span>).</p></li>
<li><p>Update the prototype (<span class="math inline">\(\mu, \Sigma\)</span>) of the correct category <span class="math inline">\(y_i\)</span> using the multivariate_kalman_update function and <span class="math inline">\(\vec{x}_i\)</span>.</p></li>
</ul>
</div>
<div id="r-implementation-of-the-prototype-agent" class="section level3 hasAnchor" number="13.4.4">
<h3><span class="header-section-number">13.4.4</span> R Implementation of the Prototype Agent<a href="prototype-based-models-of-categorization.html#r-implementation-of-the-prototype-agent" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="prototype-based-models-of-categorization.html#cb636-1" tabindex="-1"></a><span class="co"># Prototype model agent using Kalman filter for categorization</span></span>
<span id="cb636-2"><a href="prototype-based-models-of-categorization.html#cb636-2" tabindex="-1"></a>prototype_kalman <span class="ot">&lt;-</span> <span class="cf">function</span>(r_value, <span class="co"># Observation noise variance (scalar)</span></span>
<span id="cb636-3"><a href="prototype-based-models-of-categorization.html#cb636-3" tabindex="-1"></a>                             obs, <span class="co"># Matrix of observations (trials x features)</span></span>
<span id="cb636-4"><a href="prototype-based-models-of-categorization.html#cb636-4" tabindex="-1"></a>                             cat_one, <span class="co"># Vector of true category labels (0 or 1)</span></span>
<span id="cb636-5"><a href="prototype-based-models-of-categorization.html#cb636-5" tabindex="-1"></a>                             <span class="at">initial_mu =</span> <span class="cn">NULL</span>, <span class="co"># Optional initial means</span></span>
<span id="cb636-6"><a href="prototype-based-models-of-categorization.html#cb636-6" tabindex="-1"></a>                             <span class="at">initial_sigma_diag =</span> <span class="fl">10.0</span>, <span class="co"># Initial uncertainty (diagonal of Sigma)</span></span>
<span id="cb636-7"><a href="prototype-based-models-of-categorization.html#cb636-7" tabindex="-1"></a>                             <span class="at">quiet =</span> <span class="cn">TRUE</span>) { </span>
<span id="cb636-8"><a href="prototype-based-models-of-categorization.html#cb636-8" tabindex="-1"></a>  </span>
<span id="cb636-9"><a href="prototype-based-models-of-categorization.html#cb636-9" tabindex="-1"></a>  n_trials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb636-10"><a href="prototype-based-models-of-categorization.html#cb636-10" tabindex="-1"></a>  n_features <span class="ot">&lt;-</span> <span class="fu">ncol</span>(obs)</span>
<span id="cb636-11"><a href="prototype-based-models-of-categorization.html#cb636-11" tabindex="-1"></a>  </span>
<span id="cb636-12"><a href="prototype-based-models-of-categorization.html#cb636-12" tabindex="-1"></a>  <span class="co"># --- Initialization ---</span></span>
<span id="cb636-13"><a href="prototype-based-models-of-categorization.html#cb636-13" tabindex="-1"></a>  <span class="co"># Use provided initial means or default to zeros</span></span>
<span id="cb636-14"><a href="prototype-based-models-of-categorization.html#cb636-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(initial_mu)) {</span>
<span id="cb636-15"><a href="prototype-based-models-of-categorization.html#cb636-15" tabindex="-1"></a>    mu0_init <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features)</span>
<span id="cb636-16"><a href="prototype-based-models-of-categorization.html#cb636-16" tabindex="-1"></a>    mu1_init <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_features)</span>
<span id="cb636-17"><a href="prototype-based-models-of-categorization.html#cb636-17" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb636-18"><a href="prototype-based-models-of-categorization.html#cb636-18" tabindex="-1"></a>    <span class="co"># Ensure initial_mu is a list with elements for cat 0 and 1</span></span>
<span id="cb636-19"><a href="prototype-based-models-of-categorization.html#cb636-19" tabindex="-1"></a>    mu0_init <span class="ot">&lt;-</span> initial_mu[[<span class="dv">1</span>]] </span>
<span id="cb636-20"><a href="prototype-based-models-of-categorization.html#cb636-20" tabindex="-1"></a>    mu1_init <span class="ot">&lt;-</span> initial_mu[[<span class="dv">2</span>]]</span>
<span id="cb636-21"><a href="prototype-based-models-of-categorization.html#cb636-21" tabindex="-1"></a>  }</span>
<span id="cb636-22"><a href="prototype-based-models-of-categorization.html#cb636-22" tabindex="-1"></a>  </span>
<span id="cb636-23"><a href="prototype-based-models-of-categorization.html#cb636-23" tabindex="-1"></a>  prototype_cat_0 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb636-24"><a href="prototype-based-models-of-categorization.html#cb636-24" tabindex="-1"></a>    <span class="at">mu =</span> mu0_init, </span>
<span id="cb636-25"><a href="prototype-based-models-of-categorization.html#cb636-25" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(initial_sigma_diag, n_features) </span>
<span id="cb636-26"><a href="prototype-based-models-of-categorization.html#cb636-26" tabindex="-1"></a>  )</span>
<span id="cb636-27"><a href="prototype-based-models-of-categorization.html#cb636-27" tabindex="-1"></a>  prototype_cat_1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb636-28"><a href="prototype-based-models-of-categorization.html#cb636-28" tabindex="-1"></a>    <span class="at">mu =</span> mu1_init, </span>
<span id="cb636-29"><a href="prototype-based-models-of-categorization.html#cb636-29" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">diag</span>(initial_sigma_diag, n_features)</span>
<span id="cb636-30"><a href="prototype-based-models-of-categorization.html#cb636-30" tabindex="-1"></a>  )</span>
<span id="cb636-31"><a href="prototype-based-models-of-categorization.html#cb636-31" tabindex="-1"></a>  </span>
<span id="cb636-32"><a href="prototype-based-models-of-categorization.html#cb636-32" tabindex="-1"></a>  <span class="co"># Observation noise matrix (diagonal)</span></span>
<span id="cb636-33"><a href="prototype-based-models-of-categorization.html#cb636-33" tabindex="-1"></a>  r_matrix <span class="ot">&lt;-</span> <span class="fu">diag</span>(r_value, n_features)</span>
<span id="cb636-34"><a href="prototype-based-models-of-categorization.html#cb636-34" tabindex="-1"></a>  </span>
<span id="cb636-35"><a href="prototype-based-models-of-categorization.html#cb636-35" tabindex="-1"></a>  <span class="co"># Storage for response probabilities</span></span>
<span id="cb636-36"><a href="prototype-based-models-of-categorization.html#cb636-36" tabindex="-1"></a>  response_probs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb636-37"><a href="prototype-based-models-of-categorization.html#cb636-37" tabindex="-1"></a>  </span>
<span id="cb636-38"><a href="prototype-based-models-of-categorization.html#cb636-38" tabindex="-1"></a>  <span class="co"># Log-Sum-Exp function for stable normalization</span></span>
<span id="cb636-39"><a href="prototype-based-models-of-categorization.html#cb636-39" tabindex="-1"></a>  log_sum_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(v) {</span>
<span id="cb636-40"><a href="prototype-based-models-of-categorization.html#cb636-40" tabindex="-1"></a>    max_v <span class="ot">&lt;-</span> <span class="fu">max</span>(v)</span>
<span id="cb636-41"><a href="prototype-based-models-of-categorization.html#cb636-41" tabindex="-1"></a>    max_v <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">sum</span>(<span class="fu">exp</span>(v <span class="sc">-</span> max_v)))</span>
<span id="cb636-42"><a href="prototype-based-models-of-categorization.html#cb636-42" tabindex="-1"></a>  }</span>
<span id="cb636-43"><a href="prototype-based-models-of-categorization.html#cb636-43" tabindex="-1"></a>  </span>
<span id="cb636-44"><a href="prototype-based-models-of-categorization.html#cb636-44" tabindex="-1"></a>  <span class="co"># --- Trial Loop ---</span></span>
<span id="cb636-45"><a href="prototype-based-models-of-categorization.html#cb636-45" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb636-46"><a href="prototype-based-models-of-categorization.html#cb636-46" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>quiet <span class="sc">&amp;&amp;</span> i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Trial&quot;</span>, i))</span>
<span id="cb636-47"><a href="prototype-based-models-of-categorization.html#cb636-47" tabindex="-1"></a>    </span>
<span id="cb636-48"><a href="prototype-based-models-of-categorization.html#cb636-48" tabindex="-1"></a>    current_obs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[i, ])</span>
<span id="cb636-49"><a href="prototype-based-models-of-categorization.html#cb636-49" tabindex="-1"></a>    </span>
<span id="cb636-50"><a href="prototype-based-models-of-categorization.html#cb636-50" tabindex="-1"></a>    <span class="co"># --- Categorization Decision ---</span></span>
<span id="cb636-51"><a href="prototype-based-models-of-categorization.html#cb636-51" tabindex="-1"></a>    <span class="co"># Calculate log probability density for each category prototype</span></span>
<span id="cb636-52"><a href="prototype-based-models-of-categorization.html#cb636-52" tabindex="-1"></a>    </span>
<span id="cb636-53"><a href="prototype-based-models-of-categorization.html#cb636-53" tabindex="-1"></a>    <span class="co"># Covariance matrix for density calculation (Sigma + R)</span></span>
<span id="cb636-54"><a href="prototype-based-models-of-categorization.html#cb636-54" tabindex="-1"></a>    cov_cat_0 <span class="ot">&lt;-</span> prototype_cat_0<span class="sc">$</span>sigma <span class="sc">+</span> r_matrix</span>
<span id="cb636-55"><a href="prototype-based-models-of-categorization.html#cb636-55" tabindex="-1"></a>    cov_cat_1 <span class="ot">&lt;-</span> prototype_cat_1<span class="sc">$</span>sigma <span class="sc">+</span> r_matrix</span>
<span id="cb636-56"><a href="prototype-based-models-of-categorization.html#cb636-56" tabindex="-1"></a>    </span>
<span id="cb636-57"><a href="prototype-based-models-of-categorization.html#cb636-57" tabindex="-1"></a>    <span class="co"># Use dmvnorm for robust calculation (handles potential issues)</span></span>
<span id="cb636-58"><a href="prototype-based-models-of-categorization.html#cb636-58" tabindex="-1"></a>    <span class="co"># Note: We need log probability, so log = TRUE</span></span>
<span id="cb636-59"><a href="prototype-based-models-of-categorization.html#cb636-59" tabindex="-1"></a>    log_prob_0 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb636-60"><a href="prototype-based-models-of-categorization.html#cb636-60" tabindex="-1"></a>      mvtnorm<span class="sc">::</span><span class="fu">dmvnorm</span>(current_obs, <span class="at">mean =</span> prototype_cat_0<span class="sc">$</span>mu, <span class="at">sigma =</span> cov_cat_0, <span class="at">log =</span> <span class="cn">TRUE</span>),</span>
<span id="cb636-61"><a href="prototype-based-models-of-categorization.html#cb636-61" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e) <span class="sc">-</span><span class="cn">Inf</span> <span class="co"># Return -Inf log prob if density calculation fails</span></span>
<span id="cb636-62"><a href="prototype-based-models-of-categorization.html#cb636-62" tabindex="-1"></a>    )</span>
<span id="cb636-63"><a href="prototype-based-models-of-categorization.html#cb636-63" tabindex="-1"></a>    log_prob_1 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb636-64"><a href="prototype-based-models-of-categorization.html#cb636-64" tabindex="-1"></a>      mvtnorm<span class="sc">::</span><span class="fu">dmvnorm</span>(current_obs, <span class="at">mean =</span> prototype_cat_1<span class="sc">$</span>mu, <span class="at">sigma =</span> cov_cat_1, <span class="at">log =</span> <span class="cn">TRUE</span>),</span>
<span id="cb636-65"><a href="prototype-based-models-of-categorization.html#cb636-65" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e) <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb636-66"><a href="prototype-based-models-of-categorization.html#cb636-66" tabindex="-1"></a>    )</span>
<span id="cb636-67"><a href="prototype-based-models-of-categorization.html#cb636-67" tabindex="-1"></a>      </span>
<span id="cb636-68"><a href="prototype-based-models-of-categorization.html#cb636-68" tabindex="-1"></a>    <span class="co"># Normalize using log-sum-exp to get probability of category 1</span></span>
<span id="cb636-69"><a href="prototype-based-models-of-categorization.html#cb636-69" tabindex="-1"></a>    <span class="co"># Handle cases where one log_prob might be -Inf</span></span>
<span id="cb636-70"><a href="prototype-based-models-of-categorization.html#cb636-70" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(log_prob_0) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.finite</span>(log_prob_1)) {</span>
<span id="cb636-71"><a href="prototype-based-models-of-categorization.html#cb636-71" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># Undefined, default to 0.5</span></span>
<span id="cb636-72"><a href="prototype-based-models-of-categorization.html#cb636-72" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(log_prob_0)) {</span>
<span id="cb636-73"><a href="prototype-based-models-of-categorization.html#cb636-73" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fl">1.0</span> <span class="co"># Only category 1 has finite probability</span></span>
<span id="cb636-74"><a href="prototype-based-models-of-categorization.html#cb636-74" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(log_prob_1)) {</span>
<span id="cb636-75"><a href="prototype-based-models-of-categorization.html#cb636-75" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fl">0.0</span> <span class="co"># Only category 0 has finite probability</span></span>
<span id="cb636-76"><a href="prototype-based-models-of-categorization.html#cb636-76" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb636-77"><a href="prototype-based-models-of-categorization.html#cb636-77" tabindex="-1"></a>        <span class="co"># Apply bias (b=0.5 means no bias) towards category 1</span></span>
<span id="cb636-78"><a href="prototype-based-models-of-categorization.html#cb636-78" tabindex="-1"></a>        b <span class="ot">=</span> <span class="fl">0.5</span> </span>
<span id="cb636-79"><a href="prototype-based-models-of-categorization.html#cb636-79" tabindex="-1"></a>        log_p0_biased <span class="ot">=</span> log_prob_0 <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>b)</span>
<span id="cb636-80"><a href="prototype-based-models-of-categorization.html#cb636-80" tabindex="-1"></a>        log_p1_biased <span class="ot">=</span> log_prob_1 <span class="sc">+</span> <span class="fu">log</span>(b)</span>
<span id="cb636-81"><a href="prototype-based-models-of-categorization.html#cb636-81" tabindex="-1"></a>        prob_cat_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_p1_biased <span class="sc">-</span> <span class="fu">log_sum_exp</span>(<span class="fu">c</span>(log_p0_biased, log_p1_biased)))</span>
<span id="cb636-82"><a href="prototype-based-models-of-categorization.html#cb636-82" tabindex="-1"></a>    }</span>
<span id="cb636-83"><a href="prototype-based-models-of-categorization.html#cb636-83" tabindex="-1"></a>    </span>
<span id="cb636-84"><a href="prototype-based-models-of-categorization.html#cb636-84" tabindex="-1"></a>    <span class="co"># Ensure probability is within bounds for rbinom</span></span>
<span id="cb636-85"><a href="prototype-based-models-of-categorization.html#cb636-85" tabindex="-1"></a>    response_probs[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">min</span>(prob_cat_1, <span class="fl">0.9999</span>), <span class="fl">0.0001</span>)</span>
<span id="cb636-86"><a href="prototype-based-models-of-categorization.html#cb636-86" tabindex="-1"></a>    </span>
<span id="cb636-87"><a href="prototype-based-models-of-categorization.html#cb636-87" tabindex="-1"></a>    <span class="co"># --- Learning Update ---</span></span>
<span id="cb636-88"><a href="prototype-based-models-of-categorization.html#cb636-88" tabindex="-1"></a>    <span class="co"># Update the prototype for the *correct* category based on feedback</span></span>
<span id="cb636-89"><a href="prototype-based-models-of-categorization.html#cb636-89" tabindex="-1"></a>    true_cat <span class="ot">&lt;-</span> cat_one[i]</span>
<span id="cb636-90"><a href="prototype-based-models-of-categorization.html#cb636-90" tabindex="-1"></a>    </span>
<span id="cb636-91"><a href="prototype-based-models-of-categorization.html#cb636-91" tabindex="-1"></a>    <span class="cf">if</span> (true_cat <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb636-92"><a href="prototype-based-models-of-categorization.html#cb636-92" tabindex="-1"></a>      update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb636-93"><a href="prototype-based-models-of-categorization.html#cb636-93" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>mu, </span>
<span id="cb636-94"><a href="prototype-based-models-of-categorization.html#cb636-94" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>sigma, </span>
<span id="cb636-95"><a href="prototype-based-models-of-categorization.html#cb636-95" tabindex="-1"></a>        current_obs, </span>
<span id="cb636-96"><a href="prototype-based-models-of-categorization.html#cb636-96" tabindex="-1"></a>        r_matrix</span>
<span id="cb636-97"><a href="prototype-based-models-of-categorization.html#cb636-97" tabindex="-1"></a>      )</span>
<span id="cb636-98"><a href="prototype-based-models-of-categorization.html#cb636-98" tabindex="-1"></a>      prototype_cat_1<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb636-99"><a href="prototype-based-models-of-categorization.html#cb636-99" tabindex="-1"></a>      prototype_cat_1<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb636-100"><a href="prototype-based-models-of-categorization.html#cb636-100" tabindex="-1"></a>    } <span class="cf">else</span> { <span class="co"># true_cat == 0</span></span>
<span id="cb636-101"><a href="prototype-based-models-of-categorization.html#cb636-101" tabindex="-1"></a>      update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(</span>
<span id="cb636-102"><a href="prototype-based-models-of-categorization.html#cb636-102" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>mu, </span>
<span id="cb636-103"><a href="prototype-based-models-of-categorization.html#cb636-103" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>sigma, </span>
<span id="cb636-104"><a href="prototype-based-models-of-categorization.html#cb636-104" tabindex="-1"></a>        current_obs, </span>
<span id="cb636-105"><a href="prototype-based-models-of-categorization.html#cb636-105" tabindex="-1"></a>        r_matrix</span>
<span id="cb636-106"><a href="prototype-based-models-of-categorization.html#cb636-106" tabindex="-1"></a>      )</span>
<span id="cb636-107"><a href="prototype-based-models-of-categorization.html#cb636-107" tabindex="-1"></a>      prototype_cat_0<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb636-108"><a href="prototype-based-models-of-categorization.html#cb636-108" tabindex="-1"></a>      prototype_cat_0<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb636-109"><a href="prototype-based-models-of-categorization.html#cb636-109" tabindex="-1"></a>    }</span>
<span id="cb636-110"><a href="prototype-based-models-of-categorization.html#cb636-110" tabindex="-1"></a>  } <span class="co"># End trial loop</span></span>
<span id="cb636-111"><a href="prototype-based-models-of-categorization.html#cb636-111" tabindex="-1"></a>  </span>
<span id="cb636-112"><a href="prototype-based-models-of-categorization.html#cb636-112" tabindex="-1"></a>  <span class="co"># Return simulated binary responses based on calculated probabilities</span></span>
<span id="cb636-113"><a href="prototype-based-models-of-categorization.html#cb636-113" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(n_trials, <span class="dv">1</span>, response_probs))</span>
<span id="cb636-114"><a href="prototype-based-models-of-categorization.html#cb636-114" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="simulating-categorization-behavior" class="section level3 hasAnchor" number="13.4.5">
<h3><span class="header-section-number">13.4.5</span> Simulating Categorization Behavior<a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s simulate behavior using this model on the same experimental setup from Chapter 11. The key parameter here is r_value, the observation noise. This parameter reflects the model’s assumption about how much variability exists within categories or arises from perceptual noise.</p>
<ul>
<li><p>Low r_value: Model assumes observations are precise representations of the category; prototypes may change rapidly initially but might overfit to early examples.</p></li>
<li><p>High r_value: Model assumes observations are noisy; learning is slower as each example has less influence, but the model might generalize better.</p></li>
</ul>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="prototype-based-models-of-categorization.html#cb637-1" tabindex="-1"></a><span class="co"># Function to wrap simulation for different parameters</span></span>
<span id="cb637-2"><a href="prototype-based-models-of-categorization.html#cb637-2" tabindex="-1"></a>simulate_prototype_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, r_value, experiment_data) {</span>
<span id="cb637-3"><a href="prototype-based-models-of-categorization.html#cb637-3" tabindex="-1"></a>    </span>
<span id="cb637-4"><a href="prototype-based-models-of-categorization.html#cb637-4" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(experiment_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(height, position))</span>
<span id="cb637-5"><a href="prototype-based-models-of-categorization.html#cb637-5" tabindex="-1"></a>    category <span class="ot">&lt;-</span> experiment_data<span class="sc">$</span>category </span>
<span id="cb637-6"><a href="prototype-based-models-of-categorization.html#cb637-6" tabindex="-1"></a>    </span>
<span id="cb637-7"><a href="prototype-based-models-of-categorization.html#cb637-7" tabindex="-1"></a>    <span class="co"># Simulate responses using the prototype_kalman function</span></span>
<span id="cb637-8"><a href="prototype-based-models-of-categorization.html#cb637-8" tabindex="-1"></a>    responses <span class="ot">&lt;-</span> <span class="fu">prototype_kalman</span>(</span>
<span id="cb637-9"><a href="prototype-based-models-of-categorization.html#cb637-9" tabindex="-1"></a>        <span class="at">r_value =</span> r_value,</span>
<span id="cb637-10"><a href="prototype-based-models-of-categorization.html#cb637-10" tabindex="-1"></a>        <span class="at">obs =</span> observations,</span>
<span id="cb637-11"><a href="prototype-based-models-of-categorization.html#cb637-11" tabindex="-1"></a>        <span class="at">cat_one =</span> category,</span>
<span id="cb637-12"><a href="prototype-based-models-of-categorization.html#cb637-12" tabindex="-1"></a>        <span class="at">initial_mu =</span> <span class="fu">list</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>)), <span class="co"># Start prototypes at 0</span></span>
<span id="cb637-13"><a href="prototype-based-models-of-categorization.html#cb637-13" tabindex="-1"></a>        <span class="at">initial_sigma_diag =</span> <span class="fl">10.0</span>, <span class="co"># High initial uncertainty</span></span>
<span id="cb637-14"><a href="prototype-based-models-of-categorization.html#cb637-14" tabindex="-1"></a>        <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb637-15"><a href="prototype-based-models-of-categorization.html#cb637-15" tabindex="-1"></a>    )</span>
<span id="cb637-16"><a href="prototype-based-models-of-categorization.html#cb637-16" tabindex="-1"></a>    </span>
<span id="cb637-17"><a href="prototype-based-models-of-categorization.html#cb637-17" tabindex="-1"></a>    <span class="co"># Record results</span></span>
<span id="cb637-18"><a href="prototype-based-models-of-categorization.html#cb637-18" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment_data <span class="sc">%&gt;%</span></span>
<span id="cb637-19"><a href="prototype-based-models-of-categorization.html#cb637-19" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb637-20"><a href="prototype-based-models-of-categorization.html#cb637-20" tabindex="-1"></a>            <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), </span>
<span id="cb637-21"><a href="prototype-based-models-of-categorization.html#cb637-21" tabindex="-1"></a>            <span class="at">sim_response =</span> responses,</span>
<span id="cb637-22"><a href="prototype-based-models-of-categorization.html#cb637-22" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb637-23"><a href="prototype-based-models-of-categorization.html#cb637-23" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> trial,</span>
<span id="cb637-24"><a href="prototype-based-models-of-categorization.html#cb637-24" tabindex="-1"></a>            <span class="at">r_value =</span> r_value,</span>
<span id="cb637-25"><a href="prototype-based-models-of-categorization.html#cb637-25" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb637-26"><a href="prototype-based-models-of-categorization.html#cb637-26" tabindex="-1"></a>        )</span>
<span id="cb637-27"><a href="prototype-based-models-of-categorization.html#cb637-27" tabindex="-1"></a></span>
<span id="cb637-28"><a href="prototype-based-models-of-categorization.html#cb637-28" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb637-29"><a href="prototype-based-models-of-categorization.html#cb637-29" tabindex="-1"></a>}</span>
<span id="cb637-30"><a href="prototype-based-models-of-categorization.html#cb637-30" tabindex="-1"></a></span>
<span id="cb637-31"><a href="prototype-based-models-of-categorization.html#cb637-31" tabindex="-1"></a><span class="co"># Define parameters for simulation</span></span>
<span id="cb637-32"><a href="prototype-based-models-of-categorization.html#cb637-32" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb637-33"><a href="prototype-based-models-of-categorization.html#cb637-33" tabindex="-1"></a>    <span class="fu">expand_grid</span>(</span>
<span id="cb637-34"><a href="prototype-based-models-of-categorization.html#cb637-34" tabindex="-1"></a>        <span class="at">agent =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="co"># Simulate 10 agents per condition</span></span>
<span id="cb637-35"><a href="prototype-based-models-of-categorization.html#cb637-35" tabindex="-1"></a>        <span class="at">r_value =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">5.0</span>) <span class="co"># Different levels of observation noise</span></span>
<span id="cb637-36"><a href="prototype-based-models-of-categorization.html#cb637-36" tabindex="-1"></a>    )</span>
<span id="cb637-37"><a href="prototype-based-models-of-categorization.html#cb637-37" tabindex="-1"></a>)</span>
<span id="cb637-38"><a href="prototype-based-models-of-categorization.html#cb637-38" tabindex="-1"></a></span>
<span id="cb637-39"><a href="prototype-based-models-of-categorization.html#cb637-39" tabindex="-1"></a><span class="co"># Run simulations in parallel</span></span>
<span id="cb637-40"><a href="prototype-based-models-of-categorization.html#cb637-40" tabindex="-1"></a><span class="co"># (Load pre-computed results if regenerate_simulations is FALSE)</span></span>
<span id="cb637-41"><a href="prototype-based-models-of-categorization.html#cb637-41" tabindex="-1"></a>sim_file <span class="ot">&lt;-</span> <span class="st">&quot;simdata/W12_prototype_simulated_responses.csv&quot;</span></span>
<span id="cb637-42"><a href="prototype-based-models-of-categorization.html#cb637-42" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(sim_file)) {</span>
<span id="cb637-43"><a href="prototype-based-models-of-categorization.html#cb637-43" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Regenerating prototype simulations...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb637-44"><a href="prototype-based-models-of-categorization.html#cb637-44" tabindex="-1"></a>  <span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>()) <span class="co"># Ensure parallel plan is active</span></span>
<span id="cb637-45"><a href="prototype-based-models-of-categorization.html#cb637-45" tabindex="-1"></a>  </span>
<span id="cb637-46"><a href="prototype-based-models-of-categorization.html#cb637-46" tabindex="-1"></a>  <span class="co"># Pass &#39;experiment&#39; tibble explicitly to the mapping function</span></span>
<span id="cb637-47"><a href="prototype-based-models-of-categorization.html#cb637-47" tabindex="-1"></a>  prototype_responses <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(param_df,</span>
<span id="cb637-48"><a href="prototype-based-models-of-categorization.html#cb637-48" tabindex="-1"></a>      simulate_prototype_responses,</span>
<span id="cb637-49"><a href="prototype-based-models-of-categorization.html#cb637-49" tabindex="-1"></a>      <span class="at">experiment_data =</span> experiment, <span class="co"># Pass the experiment data here</span></span>
<span id="cb637-50"><a href="prototype-based-models-of-categorization.html#cb637-50" tabindex="-1"></a>      <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb637-51"><a href="prototype-based-models-of-categorization.html#cb637-51" tabindex="-1"></a>  )</span>
<span id="cb637-52"><a href="prototype-based-models-of-categorization.html#cb637-52" tabindex="-1"></a>  </span>
<span id="cb637-53"><a href="prototype-based-models-of-categorization.html#cb637-53" tabindex="-1"></a>  <span class="co"># Create simdata directory if it doesn&#39;t exist</span></span>
<span id="cb637-54"><a href="prototype-based-models-of-categorization.html#cb637-54" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;simdata&quot;</span>)) <span class="fu">dir.create</span>(<span class="st">&quot;simdata&quot;</span>)</span>
<span id="cb637-55"><a href="prototype-based-models-of-categorization.html#cb637-55" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb637-56"><a href="prototype-based-models-of-categorization.html#cb637-56" tabindex="-1"></a>  <span class="fu">write_csv</span>(prototype_responses, sim_file)</span>
<span id="cb637-57"><a href="prototype-based-models-of-categorization.html#cb637-57" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulations saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb637-58"><a href="prototype-based-models-of-categorization.html#cb637-58" tabindex="-1"></a>  </span>
<span id="cb637-59"><a href="prototype-based-models-of-categorization.html#cb637-59" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb637-60"><a href="prototype-based-models-of-categorization.html#cb637-60" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loading existing prototype simulations...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb637-61"><a href="prototype-based-models-of-categorization.html#cb637-61" tabindex="-1"></a>  prototype_responses <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(sim_file)</span>
<span id="cb637-62"><a href="prototype-based-models-of-categorization.html#cb637-62" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulations loaded.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb637-63"><a href="prototype-based-models-of-categorization.html#cb637-63" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loading existing prototype simulations...</code></pre>
<pre><code>## Simulations loaded.</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="prototype-based-models-of-categorization.html#cb640-1" tabindex="-1"></a><span class="co"># Visualize how observation noise affects learning</span></span>
<span id="cb640-2"><a href="prototype-based-models-of-categorization.html#cb640-2" tabindex="-1"></a><span class="fu">ggplot</span>(prototype_responses, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> performance, <span class="at">color =</span> <span class="fu">factor</span>(r_value))) <span class="sc">+</span></span>
<span id="cb640-3"><a href="prototype-based-models-of-categorization.html#cb640-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb640-4"><a href="prototype-based-models-of-categorization.html#cb640-4" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;ribbon&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(r_value))) <span class="sc">+</span> </span>
<span id="cb640-5"><a href="prototype-based-models-of-categorization.html#cb640-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb640-6"><a href="prototype-based-models-of-categorization.html#cb640-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb640-7"><a href="prototype-based-models-of-categorization.html#cb640-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prototype Model Learning Performance&quot;</span>,</span>
<span id="cb640-8"><a href="prototype-based-models-of-categorization.html#cb640-8" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Effect of Observation Noise (r_value)&quot;</span>,</span>
<span id="cb640-9"><a href="prototype-based-models-of-categorization.html#cb640-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb640-10"><a href="prototype-based-models-of-categorization.html#cb640-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion Correct (Mean +/- SE)&quot;</span>,</span>
<span id="cb640-11"><a href="prototype-based-models-of-categorization.html#cb640-11" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;r_value&quot;</span>,</span>
<span id="cb640-12"><a href="prototype-based-models-of-categorization.html#cb640-12" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;r_value&quot;</span></span>
<span id="cb640-13"><a href="prototype-based-models-of-categorization.html#cb640-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb640-14"><a href="prototype-based-models-of-categorization.html#cb640-14" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.4</span>, <span class="fl">1.0</span>) <span class="co"># Adjust ylim for better visibility</span></span></code></pre></div>
<p><img src="series_files/figure-html/12%20simulate_prototype_responses-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Interpretation: This plot shows average learning curves. Different values of r_value impact learning. Very low noise (r_value = 0.1) might lead to overfitting initial examples, while very high noise (r_value = 5.0) might slow down learning as the model trusts observations less. An intermediate value often performs best, balancing trust in new data with reliance on the established prototype.</p>
</div>
<div id="visualizing-prototype-evolution" class="section level3 hasAnchor" number="13.4.6">
<h3><span class="header-section-number">13.4.6</span> Visualizing Prototype Evolution<a href="prototype-based-models-of-categorization.html#visualizing-prototype-evolution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Where do the prototypes end up? Let’s track their movement and uncertainty over trials.</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="prototype-based-models-of-categorization.html#cb641-1" tabindex="-1"></a><span class="co"># Function to track prototype means and covariances over trials</span></span>
<span id="cb641-2"><a href="prototype-based-models-of-categorization.html#cb641-2" tabindex="-1"></a>track_prototypes <span class="ot">&lt;-</span> <span class="cf">function</span>(r_value, obs, cat_one, <span class="at">initial_mu =</span> <span class="cn">NULL</span>, <span class="at">initial_sigma_diag =</span> <span class="fl">10.0</span>) {</span>
<span id="cb641-3"><a href="prototype-based-models-of-categorization.html#cb641-3" tabindex="-1"></a>  n_trials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb641-4"><a href="prototype-based-models-of-categorization.html#cb641-4" tabindex="-1"></a>  n_features <span class="ot">&lt;-</span> <span class="fu">ncol</span>(obs)</span>
<span id="cb641-5"><a href="prototype-based-models-of-categorization.html#cb641-5" tabindex="-1"></a></span>
<span id="cb641-6"><a href="prototype-based-models-of-categorization.html#cb641-6" tabindex="-1"></a>  <span class="co"># --- Initialization ---</span></span>
<span id="cb641-7"><a href="prototype-based-models-of-categorization.html#cb641-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(initial_mu)) {</span>
<span id="cb641-8"><a href="prototype-based-models-of-categorization.html#cb641-8" tabindex="-1"></a>    mu0_init <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">2.5</span>, n_features)</span>
<span id="cb641-9"><a href="prototype-based-models-of-categorization.html#cb641-9" tabindex="-1"></a>    mu1_init <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">2.5</span>, n_features)</span>
<span id="cb641-10"><a href="prototype-based-models-of-categorization.html#cb641-10" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb641-11"><a href="prototype-based-models-of-categorization.html#cb641-11" tabindex="-1"></a>    mu0_init <span class="ot">&lt;-</span> initial_mu[[<span class="dv">1</span>]] </span>
<span id="cb641-12"><a href="prototype-based-models-of-categorization.html#cb641-12" tabindex="-1"></a>    mu1_init <span class="ot">&lt;-</span> initial_mu[[<span class="dv">2</span>]]</span>
<span id="cb641-13"><a href="prototype-based-models-of-categorization.html#cb641-13" tabindex="-1"></a>  }</span>
<span id="cb641-14"><a href="prototype-based-models-of-categorization.html#cb641-14" tabindex="-1"></a>  prototype_cat_0 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu =</span> mu0_init, <span class="at">sigma =</span> <span class="fu">diag</span>(initial_sigma_diag, n_features))</span>
<span id="cb641-15"><a href="prototype-based-models-of-categorization.html#cb641-15" tabindex="-1"></a>  prototype_cat_1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu =</span> mu1_init, <span class="at">sigma =</span> <span class="fu">diag</span>(initial_sigma_diag, n_features))</span>
<span id="cb641-16"><a href="prototype-based-models-of-categorization.html#cb641-16" tabindex="-1"></a>  r_matrix <span class="ot">&lt;-</span> <span class="fu">diag</span>(r_value, n_features)</span>
<span id="cb641-17"><a href="prototype-based-models-of-categorization.html#cb641-17" tabindex="-1"></a></span>
<span id="cb641-18"><a href="prototype-based-models-of-categorization.html#cb641-18" tabindex="-1"></a>  <span class="co"># Storage for history</span></span>
<span id="cb641-19"><a href="prototype-based-models-of-categorization.html#cb641-19" tabindex="-1"></a>  <span class="co"># Store the full 2x2 covariance matrix in a list column</span></span>
<span id="cb641-20"><a href="prototype-based-models-of-categorization.html#cb641-20" tabindex="-1"></a>  prototype_history <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb641-21"><a href="prototype-based-models-of-categorization.html#cb641-21" tabindex="-1"></a></span>
<span id="cb641-22"><a href="prototype-based-models-of-categorization.html#cb641-22" tabindex="-1"></a>  <span class="co"># --- Trial Loop ---</span></span>
<span id="cb641-23"><a href="prototype-based-models-of-categorization.html#cb641-23" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_trials <span class="sc">+</span> <span class="dv">1</span>)) { <span class="co"># Loop one extra time to capture final state</span></span>
<span id="cb641-24"><a href="prototype-based-models-of-categorization.html#cb641-24" tabindex="-1"></a>    <span class="co"># Store current state *before* update (or final state)</span></span>
<span id="cb641-25"><a href="prototype-based-models-of-categorization.html#cb641-25" tabindex="-1"></a>     prototype_history[[<span class="fu">length</span>(prototype_history) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb641-26"><a href="prototype-based-models-of-categorization.html#cb641-26" tabindex="-1"></a>        <span class="at">trial =</span> i, <span class="at">category =</span> <span class="dv">0</span>, </span>
<span id="cb641-27"><a href="prototype-based-models-of-categorization.html#cb641-27" tabindex="-1"></a>        <span class="at">feature1_mean =</span> prototype_cat_0<span class="sc">$</span>mu[<span class="dv">1</span>], <span class="co"># Assuming feature 1 is height</span></span>
<span id="cb641-28"><a href="prototype-based-models-of-categorization.html#cb641-28" tabindex="-1"></a>        <span class="at">feature2_mean =</span> prototype_cat_0<span class="sc">$</span>mu[<span class="dv">2</span>], <span class="co"># Assuming feature 2 is position</span></span>
<span id="cb641-29"><a href="prototype-based-models-of-categorization.html#cb641-29" tabindex="-1"></a>        <span class="at">cov_matrix =</span> <span class="fu">list</span>(prototype_cat_0<span class="sc">$</span>sigma) </span>
<span id="cb641-30"><a href="prototype-based-models-of-categorization.html#cb641-30" tabindex="-1"></a>     )</span>
<span id="cb641-31"><a href="prototype-based-models-of-categorization.html#cb641-31" tabindex="-1"></a>     prototype_history[[<span class="fu">length</span>(prototype_history) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb641-32"><a href="prototype-based-models-of-categorization.html#cb641-32" tabindex="-1"></a>        <span class="at">trial =</span> i, <span class="at">category =</span> <span class="dv">1</span>, </span>
<span id="cb641-33"><a href="prototype-based-models-of-categorization.html#cb641-33" tabindex="-1"></a>        <span class="at">feature1_mean =</span> prototype_cat_1<span class="sc">$</span>mu[<span class="dv">1</span>], </span>
<span id="cb641-34"><a href="prototype-based-models-of-categorization.html#cb641-34" tabindex="-1"></a>        <span class="at">feature2_mean =</span> prototype_cat_1<span class="sc">$</span>mu[<span class="dv">2</span>], </span>
<span id="cb641-35"><a href="prototype-based-models-of-categorization.html#cb641-35" tabindex="-1"></a>        <span class="at">cov_matrix =</span> <span class="fu">list</span>(prototype_cat_1<span class="sc">$</span>sigma)</span>
<span id="cb641-36"><a href="prototype-based-models-of-categorization.html#cb641-36" tabindex="-1"></a>     )</span>
<span id="cb641-37"><a href="prototype-based-models-of-categorization.html#cb641-37" tabindex="-1"></a></span>
<span id="cb641-38"><a href="prototype-based-models-of-categorization.html#cb641-38" tabindex="-1"></a>    <span class="co"># Update only if within actual trials</span></span>
<span id="cb641-39"><a href="prototype-based-models-of-categorization.html#cb641-39" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&lt;=</span> n_trials) {</span>
<span id="cb641-40"><a href="prototype-based-models-of-categorization.html#cb641-40" tabindex="-1"></a>      current_obs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[i, ])</span>
<span id="cb641-41"><a href="prototype-based-models-of-categorization.html#cb641-41" tabindex="-1"></a>      true_cat <span class="ot">&lt;-</span> cat_one[i]</span>
<span id="cb641-42"><a href="prototype-based-models-of-categorization.html#cb641-42" tabindex="-1"></a>      </span>
<span id="cb641-43"><a href="prototype-based-models-of-categorization.html#cb641-43" tabindex="-1"></a>      <span class="cf">if</span> (true_cat <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb641-44"><a href="prototype-based-models-of-categorization.html#cb641-44" tabindex="-1"></a>        update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(prototype_cat_1<span class="sc">$</span>mu, prototype_cat_1<span class="sc">$</span>sigma, current_obs, r_matrix)</span>
<span id="cb641-45"><a href="prototype-based-models-of-categorization.html#cb641-45" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb641-46"><a href="prototype-based-models-of-categorization.html#cb641-46" tabindex="-1"></a>        prototype_cat_1<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb641-47"><a href="prototype-based-models-of-categorization.html#cb641-47" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb641-48"><a href="prototype-based-models-of-categorization.html#cb641-48" tabindex="-1"></a>        update <span class="ot">&lt;-</span> <span class="fu">multivariate_kalman_update</span>(prototype_cat_0<span class="sc">$</span>mu, prototype_cat_0<span class="sc">$</span>sigma, current_obs, r_matrix)</span>
<span id="cb641-49"><a href="prototype-based-models-of-categorization.html#cb641-49" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>mu <span class="ot">&lt;-</span> update<span class="sc">$</span>mu</span>
<span id="cb641-50"><a href="prototype-based-models-of-categorization.html#cb641-50" tabindex="-1"></a>        prototype_cat_0<span class="sc">$</span>sigma <span class="ot">&lt;-</span> update<span class="sc">$</span>sigma</span>
<span id="cb641-51"><a href="prototype-based-models-of-categorization.html#cb641-51" tabindex="-1"></a>      }</span>
<span id="cb641-52"><a href="prototype-based-models-of-categorization.html#cb641-52" tabindex="-1"></a>    }</span>
<span id="cb641-53"><a href="prototype-based-models-of-categorization.html#cb641-53" tabindex="-1"></a>  } <span class="co"># End trial loop</span></span>
<span id="cb641-54"><a href="prototype-based-models-of-categorization.html#cb641-54" tabindex="-1"></a>  </span>
<span id="cb641-55"><a href="prototype-based-models-of-categorization.html#cb641-55" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">bind_rows</span>(prototype_history)) <span class="co"># Combine list into single tibble</span></span>
<span id="cb641-56"><a href="prototype-based-models-of-categorization.html#cb641-56" tabindex="-1"></a>}</span>
<span id="cb641-57"><a href="prototype-based-models-of-categorization.html#cb641-57" tabindex="-1"></a></span>
<span id="cb641-58"><a href="prototype-based-models-of-categorization.html#cb641-58" tabindex="-1"></a><span class="co"># Helper function to get ellipse data for plotting uncertainty</span></span>
<span id="cb641-59"><a href="prototype-based-models-of-categorization.html#cb641-59" tabindex="-1"></a><span class="co"># Requires the &#39;ellipse&#39; package</span></span>
<span id="cb641-60"><a href="prototype-based-models-of-categorization.html#cb641-60" tabindex="-1"></a>get_ellipse <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, <span class="at">level =</span> <span class="fl">0.68</span>) { <span class="co"># 68% CI (approx 1 SD)</span></span>
<span id="cb641-61"><a href="prototype-based-models-of-categorization.html#cb641-61" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;ellipse&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb641-62"><a href="prototype-based-models-of-categorization.html#cb641-62" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">&quot;Package &#39;ellipse&#39; needed for uncertainty ellipses.&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb641-63"><a href="prototype-based-models-of-categorization.html#cb641-63" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>) </span>
<span id="cb641-64"><a href="prototype-based-models-of-categorization.html#cb641-64" tabindex="-1"></a>  }</span>
<span id="cb641-65"><a href="prototype-based-models-of-categorization.html#cb641-65" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mu)</span>
<span id="cb641-66"><a href="prototype-based-models-of-categorization.html#cb641-66" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sigma)</span>
<span id="cb641-67"><a href="prototype-based-models-of-categorization.html#cb641-67" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(mu) <span class="sc">!=</span> <span class="dv">2</span> <span class="sc">||</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">dim</span>(sigma) <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))) {</span>
<span id="cb641-68"><a href="prototype-based-models-of-categorization.html#cb641-68" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">&quot;Ellipse plotting requires 2D mean vector and 2x2 covariance matrix.&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb641-69"><a href="prototype-based-models-of-categorization.html#cb641-69" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb641-70"><a href="prototype-based-models-of-categorization.html#cb641-70" tabindex="-1"></a>  }</span>
<span id="cb641-71"><a href="prototype-based-models-of-categorization.html#cb641-71" tabindex="-1"></a>  <span class="co"># Check positive definiteness for ellipse calculation</span></span>
<span id="cb641-72"><a href="prototype-based-models-of-categorization.html#cb641-72" tabindex="-1"></a>  eigen_vals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma, <span class="at">symmetric =</span> <span class="cn">TRUE</span>, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb641-73"><a href="prototype-based-models-of-categorization.html#cb641-73" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(eigen_vals <span class="sc">&lt;=</span> <span class="fl">1e-6</span>)) {</span>
<span id="cb641-74"><a href="prototype-based-models-of-categorization.html#cb641-74" tabindex="-1"></a>      <span class="co"># warning(&quot;Covariance matrix near non-positive definite. Adding jitter for ellipse.&quot;, call. = FALSE)</span></span>
<span id="cb641-75"><a href="prototype-based-models-of-categorization.html#cb641-75" tabindex="-1"></a>      sigma <span class="ot">&lt;-</span> sigma <span class="sc">+</span> <span class="fu">diag</span>(<span class="fu">ncol</span>(sigma)) <span class="sc">*</span> <span class="fl">1e-6</span> <span class="co"># Add tiny jitter</span></span>
<span id="cb641-76"><a href="prototype-based-models-of-categorization.html#cb641-76" tabindex="-1"></a>  }</span>
<span id="cb641-77"><a href="prototype-based-models-of-categorization.html#cb641-77" tabindex="-1"></a></span>
<span id="cb641-78"><a href="prototype-based-models-of-categorization.html#cb641-78" tabindex="-1"></a>  <span class="co"># Calculate points on the ellipse boundary</span></span>
<span id="cb641-79"><a href="prototype-based-models-of-categorization.html#cb641-79" tabindex="-1"></a>  ellipse_points <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(ellipse<span class="sc">::</span><span class="fu">ellipse</span>(sigma, <span class="at">centre =</span> mu, <span class="at">level =</span> level),</span>
<span id="cb641-80"><a href="prototype-based-models-of-categorization.html#cb641-80" tabindex="-1"></a>                             <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb641-81"><a href="prototype-based-models-of-categorization.html#cb641-81" tabindex="-1"></a>                                 <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Ellipse calculation failed:&quot;</span>, e<span class="sc">$</span>message), <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb641-82"><a href="prototype-based-models-of-categorization.html#cb641-82" tabindex="-1"></a>                                 <span class="cn">NULL</span></span>
<span id="cb641-83"><a href="prototype-based-models-of-categorization.html#cb641-83" tabindex="-1"></a>                             })</span>
<span id="cb641-84"><a href="prototype-based-models-of-categorization.html#cb641-84" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(ellipse_points)) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb641-85"><a href="prototype-based-models-of-categorization.html#cb641-85" tabindex="-1"></a>  <span class="co"># Return as tibble with consistent names (feature1=height, feature2=position)</span></span>
<span id="cb641-86"><a href="prototype-based-models-of-categorization.html#cb641-86" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(ellipse_points) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;feature1_mean&quot;</span>, <span class="st">&quot;feature2_mean&quot;</span>)) </span>
<span id="cb641-87"><a href="prototype-based-models-of-categorization.html#cb641-87" tabindex="-1"></a>}</span>
<span id="cb641-88"><a href="prototype-based-models-of-categorization.html#cb641-88" tabindex="-1"></a></span>
<span id="cb641-89"><a href="prototype-based-models-of-categorization.html#cb641-89" tabindex="-1"></a></span>
<span id="cb641-90"><a href="prototype-based-models-of-categorization.html#cb641-90" tabindex="-1"></a><span class="co"># --- Run tracking and prepare plot data ---</span></span>
<span id="cb641-91"><a href="prototype-based-models-of-categorization.html#cb641-91" tabindex="-1"></a><span class="co"># Track prototypes using the actual experiment data</span></span>
<span id="cb641-92"><a href="prototype-based-models-of-categorization.html#cb641-92" tabindex="-1"></a>prototype_trajectory <span class="ot">&lt;-</span> <span class="fu">track_prototypes</span>(</span>
<span id="cb641-93"><a href="prototype-based-models-of-categorization.html#cb641-93" tabindex="-1"></a>  <span class="at">r_value =</span> <span class="fl">1.0</span>, <span class="co"># Example r_value</span></span>
<span id="cb641-94"><a href="prototype-based-models-of-categorization.html#cb641-94" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb641-95"><a href="prototype-based-models-of-categorization.html#cb641-95" tabindex="-1"></a>  <span class="at">cat_one =</span> experiment<span class="sc">$</span>category,</span>
<span id="cb641-96"><a href="prototype-based-models-of-categorization.html#cb641-96" tabindex="-1"></a>  <span class="at">initial_mu =</span> <span class="fu">list</span>(<span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">2</span>)), <span class="co"># Start at 0</span></span>
<span id="cb641-97"><a href="prototype-based-models-of-categorization.html#cb641-97" tabindex="-1"></a>  <span class="at">initial_sigma_diag =</span> <span class="fl">10.0</span></span>
<span id="cb641-98"><a href="prototype-based-models-of-categorization.html#cb641-98" tabindex="-1"></a>)</span>
<span id="cb641-99"><a href="prototype-based-models-of-categorization.html#cb641-99" tabindex="-1"></a></span>
<span id="cb641-100"><a href="prototype-based-models-of-categorization.html#cb641-100" tabindex="-1"></a><span class="co"># Get final prototype states (after the last update, trial = n_trials + 1)</span></span>
<span id="cb641-101"><a href="prototype-based-models-of-categorization.html#cb641-101" tabindex="-1"></a>final_prototypes <span class="ot">&lt;-</span> prototype_trajectory <span class="sc">%&gt;%</span> <span class="fu">filter</span>(trial <span class="sc">==</span> <span class="fu">max</span>(trial))</span>
<span id="cb641-102"><a href="prototype-based-models-of-categorization.html#cb641-102" tabindex="-1"></a></span>
<span id="cb641-103"><a href="prototype-based-models-of-categorization.html#cb641-103" tabindex="-1"></a><span class="co"># Create ellipse data for the final states</span></span>
<span id="cb641-104"><a href="prototype-based-models-of-categorization.html#cb641-104" tabindex="-1"></a><span class="co"># Use rowwise and map to handle list column &#39;cov_matrix&#39;</span></span>
<span id="cb641-105"><a href="prototype-based-models-of-categorization.html#cb641-105" tabindex="-1"></a>ellipse_data_list <span class="ot">&lt;-</span> final_prototypes <span class="sc">%&gt;%</span></span>
<span id="cb641-106"><a href="prototype-based-models-of-categorization.html#cb641-106" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb641-107"><a href="prototype-based-models-of-categorization.html#cb641-107" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ellipse_df =</span> <span class="fu">list</span>(<span class="fu">get_ellipse</span>(<span class="fu">c</span>(feature1_mean, feature2_mean), cov_matrix[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb641-108"><a href="prototype-based-models-of-categorization.html#cb641-108" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb641-109"><a href="prototype-based-models-of-categorization.html#cb641-109" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">sapply</span>(ellipse_df, is.null)) <span class="co"># Remove rows where ellipse failed</span></span>
<span id="cb641-110"><a href="prototype-based-models-of-categorization.html#cb641-110" tabindex="-1"></a></span>
<span id="cb641-111"><a href="prototype-based-models-of-categorization.html#cb641-111" tabindex="-1"></a><span class="co"># Check if ellipse data was successfully generated</span></span>
<span id="cb641-112"><a href="prototype-based-models-of-categorization.html#cb641-112" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(ellipse_data_list) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb641-113"><a href="prototype-based-models-of-categorization.html#cb641-113" tabindex="-1"></a>    ellipse_data_unnested <span class="ot">&lt;-</span> ellipse_data_list <span class="sc">%&gt;%</span> </span>
<span id="cb641-114"><a href="prototype-based-models-of-categorization.html#cb641-114" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(category, ellipse_df) <span class="sc">%&gt;%</span> <span class="co"># Select only needed columns</span></span>
<span id="cb641-115"><a href="prototype-based-models-of-categorization.html#cb641-115" tabindex="-1"></a>      <span class="fu">unnest</span>(ellipse_df)</span>
<span id="cb641-116"><a href="prototype-based-models-of-categorization.html#cb641-116" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb641-117"><a href="prototype-based-models-of-categorization.html#cb641-117" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">&quot;Could not generate ellipse data for plotting.&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb641-118"><a href="prototype-based-models-of-categorization.html#cb641-118" tabindex="-1"></a>    ellipse_data_unnested <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Set to NULL if empty</span></span>
<span id="cb641-119"><a href="prototype-based-models-of-categorization.html#cb641-119" tabindex="-1"></a>}</span>
<span id="cb641-120"><a href="prototype-based-models-of-categorization.html#cb641-120" tabindex="-1"></a></span>
<span id="cb641-121"><a href="prototype-based-models-of-categorization.html#cb641-121" tabindex="-1"></a></span>
<span id="cb641-122"><a href="prototype-based-models-of-categorization.html#cb641-122" tabindex="-1"></a><span class="co"># --- Create the Plot ---</span></span>
<span id="cb641-123"><a href="prototype-based-models-of-categorization.html#cb641-123" tabindex="-1"></a>p_trajectory <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb641-124"><a href="prototype-based-models-of-categorization.html#cb641-124" tabindex="-1"></a>  <span class="co"># Plot stimuli points (make them slightly transparent)</span></span>
<span id="cb641-125"><a href="prototype-based-models-of-categorization.html#cb641-125" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> stimuli,</span>
<span id="cb641-126"><a href="prototype-based-models-of-categorization.html#cb641-126" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> height, <span class="at">color =</span> <span class="fu">factor</span>(category), <span class="at">shape =</span> <span class="fu">factor</span>(category)),</span>
<span id="cb641-127"><a href="prototype-based-models-of-categorization.html#cb641-127" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb641-128"><a href="prototype-based-models-of-categorization.html#cb641-128" tabindex="-1"></a></span>
<span id="cb641-129"><a href="prototype-based-models-of-categorization.html#cb641-129" tabindex="-1"></a>  <span class="co"># Plot prototype trajectory path (use trial &lt;= n_trials for the path itself)</span></span>
<span id="cb641-130"><a href="prototype-based-models-of-categorization.html#cb641-130" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> prototype_trajectory <span class="sc">%&gt;%</span> <span class="fu">filter</span>(trial <span class="sc">&lt;=</span> <span class="fu">nrow</span>(experiment)), </span>
<span id="cb641-131"><a href="prototype-based-models-of-categorization.html#cb641-131" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> feature2_mean, <span class="at">y =</span> feature1_mean, <span class="at">group =</span> category, <span class="at">color =</span> <span class="fu">factor</span>(category)),</span>
<span id="cb641-132"><a href="prototype-based-models-of-categorization.html#cb641-132" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb641-133"><a href="prototype-based-models-of-categorization.html#cb641-133" tabindex="-1"></a>            <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.08</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">angle =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb641-134"><a href="prototype-based-models-of-categorization.html#cb641-134" tabindex="-1"></a></span>
<span id="cb641-135"><a href="prototype-based-models-of-categorization.html#cb641-135" tabindex="-1"></a>  <span class="co"># Plot final prototype means (points at the end of the path)</span></span>
<span id="cb641-136"><a href="prototype-based-models-of-categorization.html#cb641-136" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> final_prototypes,</span>
<span id="cb641-137"><a href="prototype-based-models-of-categorization.html#cb641-137" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> feature2_mean, <span class="at">y =</span> feature1_mean, <span class="at">color =</span> <span class="fu">factor</span>(category)),</span>
<span id="cb641-138"><a href="prototype-based-models-of-categorization.html#cb641-138" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="co"># Use a different shape for final point</span></span>
<span id="cb641-139"><a href="prototype-based-models-of-categorization.html#cb641-139" tabindex="-1"></a></span>
<span id="cb641-140"><a href="prototype-based-models-of-categorization.html#cb641-140" tabindex="-1"></a><span class="co"># Add ellipses if data exists</span></span>
<span id="cb641-141"><a href="prototype-based-models-of-categorization.html#cb641-141" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ellipse_data_unnested)) {</span>
<span id="cb641-142"><a href="prototype-based-models-of-categorization.html#cb641-142" tabindex="-1"></a>  <span class="co"># Plot ellipses using geom_path, mapping x to feature2_mean and y to feature1_mean</span></span>
<span id="cb641-143"><a href="prototype-based-models-of-categorization.html#cb641-143" tabindex="-1"></a>  p_trajectory <span class="ot">&lt;-</span> p_trajectory <span class="sc">+</span></span>
<span id="cb641-144"><a href="prototype-based-models-of-categorization.html#cb641-144" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="at">data =</span> ellipse_data_unnested, </span>
<span id="cb641-145"><a href="prototype-based-models-of-categorization.html#cb641-145" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> feature2_mean, <span class="at">y =</span> feature1_mean, <span class="at">group =</span> category, <span class="at">color =</span> <span class="fu">factor</span>(category)), </span>
<span id="cb641-146"><a href="prototype-based-models-of-categorization.html#cb641-146" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>)</span>
<span id="cb641-147"><a href="prototype-based-models-of-categorization.html#cb641-147" tabindex="-1"></a>}</span>
<span id="cb641-148"><a href="prototype-based-models-of-categorization.html#cb641-148" tabindex="-1"></a></span>
<span id="cb641-149"><a href="prototype-based-models-of-categorization.html#cb641-149" tabindex="-1"></a><span class="co"># Add labels and theme</span></span>
<span id="cb641-150"><a href="prototype-based-models-of-categorization.html#cb641-150" tabindex="-1"></a>p_trajectory <span class="ot">&lt;-</span> p_trajectory <span class="sc">+</span> </span>
<span id="cb641-151"><a href="prototype-based-models-of-categorization.html#cb641-151" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb641-152"><a href="prototype-based-models-of-categorization.html#cb641-152" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb641-153"><a href="prototype-based-models-of-categorization.html#cb641-153" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb641-154"><a href="prototype-based-models-of-categorization.html#cb641-154" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prototype Learning Trajectory (Kalman Filter)&quot;</span>,</span>
<span id="cb641-155"><a href="prototype-based-models-of-categorization.html#cb641-155" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Prototypes start at (2.5,2.5). Dashed lines show path, ellipses show final 68% uncertainty.&quot;</span>,</span>
<span id="cb641-156"><a href="prototype-based-models-of-categorization.html#cb641-156" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Position Feature&quot;</span>,</span>
<span id="cb641-157"><a href="prototype-based-models-of-categorization.html#cb641-157" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Height Feature&quot;</span></span>
<span id="cb641-158"><a href="prototype-based-models-of-categorization.html#cb641-158" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb641-159"><a href="prototype-based-models-of-categorization.html#cb641-159" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb641-160"><a href="prototype-based-models-of-categorization.html#cb641-160" tabindex="-1"></a>  <span class="co"># Set coordinate limits to ensure all points/paths are visible</span></span>
<span id="cb641-161"><a href="prototype-based-models-of-categorization.html#cb641-161" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">c</span>(stimuli<span class="sc">$</span>position, prototype_trajectory<span class="sc">$</span>feature2_mean), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb641-162"><a href="prototype-based-models-of-categorization.html#cb641-162" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(stimuli<span class="sc">$</span>height, prototype_trajectory<span class="sc">$</span>feature1_mean), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb641-163"><a href="prototype-based-models-of-categorization.html#cb641-163" tabindex="-1"></a></span>
<span id="cb641-164"><a href="prototype-based-models-of-categorization.html#cb641-164" tabindex="-1"></a><span class="co"># Print the final plot</span></span>
<span id="cb641-165"><a href="prototype-based-models-of-categorization.html#cb641-165" tabindex="-1"></a><span class="fu">print</span>(p_trajectory)</span></code></pre></div>
<p><img src="series_files/figure-html/12%20track_prototypes-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Interpretation: This plot shows the stimuli (circles/triangles) and the path the prototypes took during learning (dashed lines starting in the middle). The final prototype locations are marked with diamonds, and the ellipses represent the model’s final uncertainty (68% confidence interval) about the true prototype location for each category. We see the prototypes moving towards the center of their respective category members and uncertainty shrinking over time (though the ellipses represent only the final uncertainty).</p>
</div>
</div>
<div id="estimating-parameters-implementing-the-prototype-model-in-stan" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Estimating Parameters: Implementing the Prototype Model in Stan<a href="prototype-based-models-of-categorization.html#estimating-parameters-implementing-the-prototype-model-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simulations help us understand the model, but we usually want to fit the model to real experimental data to estimate its parameters. Here, the key free parameter is the observation noise variance, r_value. We’ll implement the Kalman filter prototype model in Stan to estimate r_value from data.</p>
<div id="the-stan-model-w12_prototype_single.stan" class="section level3 hasAnchor" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> The Stan Model (W12_prototype_single.stan)<a href="prototype-based-models-of-categorization.html#the-stan-model-w12_prototype_single.stan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Stan code mirrors the logic of our R simulation (prototype_kalman) but within Stan’s framework for Bayesian inference. The Stan code needs to replicate the trial-by-trial Kalman filter process within its transformed parameters block to calculate the choice probabilities, which are then used in the model block to compare against observed choices (y). We estimate r_value (specifically, log_r for better sampling).</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="prototype-based-models-of-categorization.html#cb642-1" tabindex="-1"></a>prototype_single_stan <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb642-2"><a href="prototype-based-models-of-categorization.html#cb642-2" tabindex="-1"></a><span class="st">// Stan Code for Prototype Model using Kalman Filter (W12_prototype_single.stan)</span></span>
<span id="cb642-3"><a href="prototype-based-models-of-categorization.html#cb642-3" tabindex="-1"></a></span>
<span id="cb642-4"><a href="prototype-based-models-of-categorization.html#cb642-4" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb642-5"><a href="prototype-based-models-of-categorization.html#cb642-5" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; ntrials;                // Number of trials</span></span>
<span id="cb642-6"><a href="prototype-based-models-of-categorization.html#cb642-6" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; nfeatures;              // Number of feature dimensions (e.g., 2)</span></span>
<span id="cb642-7"><a href="prototype-based-models-of-categorization.html#cb642-7" tabindex="-1"></a><span class="st">  array[ntrials] int&lt;lower=0, upper=1&gt; cat_one;  // True category labels (0 or 1) provided as feedback</span></span>
<span id="cb642-8"><a href="prototype-based-models-of-categorization.html#cb642-8" tabindex="-1"></a><span class="st">  array[ntrials] int&lt;lower=0, upper=1&gt; y;        // Observed participant decisions (0 or 1)</span></span>
<span id="cb642-9"><a href="prototype-based-models-of-categorization.html#cb642-9" tabindex="-1"></a><span class="st">  array[ntrials, nfeatures] real obs;  // Stimulus features (trials x features)</span></span>
<span id="cb642-10"><a href="prototype-based-models-of-categorization.html#cb642-10" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-11"><a href="prototype-based-models-of-categorization.html#cb642-11" tabindex="-1"></a><span class="st">  // Priors / Fixed Values</span></span>
<span id="cb642-12"><a href="prototype-based-models-of-categorization.html#cb642-12" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; b;            // Response bias (e.g., 0.5 for no bias)</span></span>
<span id="cb642-13"><a href="prototype-based-models-of-categorization.html#cb642-13" tabindex="-1"></a><span class="st">  vector[nfeatures] initial_mu_cat0;   // Initial mean vector for prototype 0</span></span>
<span id="cb642-14"><a href="prototype-based-models-of-categorization.html#cb642-14" tabindex="-1"></a><span class="st">  vector[nfeatures] initial_mu_cat1;   // Initial mean vector for prototype 1</span></span>
<span id="cb642-15"><a href="prototype-based-models-of-categorization.html#cb642-15" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; initial_sigma_diag;    // Initial diagonal value for covariance matrices</span></span>
<span id="cb642-16"><a href="prototype-based-models-of-categorization.html#cb642-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-17"><a href="prototype-based-models-of-categorization.html#cb642-17" tabindex="-1"></a><span class="st">  // Prior parameters for log_r</span></span>
<span id="cb642-18"><a href="prototype-based-models-of-categorization.html#cb642-18" tabindex="-1"></a><span class="st">  real prior_logr_mean;</span></span>
<span id="cb642-19"><a href="prototype-based-models-of-categorization.html#cb642-19" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; prior_logr_sd;</span></span>
<span id="cb642-20"><a href="prototype-based-models-of-categorization.html#cb642-20" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-21"><a href="prototype-based-models-of-categorization.html#cb642-21" tabindex="-1"></a></span>
<span id="cb642-22"><a href="prototype-based-models-of-categorization.html#cb642-22" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb642-23"><a href="prototype-based-models-of-categorization.html#cb642-23" tabindex="-1"></a><span class="st">  // Parameter to estimate: Observation noise variance on log scale</span></span>
<span id="cb642-24"><a href="prototype-based-models-of-categorization.html#cb642-24" tabindex="-1"></a><span class="st">  real log_r;                          </span></span>
<span id="cb642-25"><a href="prototype-based-models-of-categorization.html#cb642-25" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-26"><a href="prototype-based-models-of-categorization.html#cb642-26" tabindex="-1"></a></span>
<span id="cb642-27"><a href="prototype-based-models-of-categorization.html#cb642-27" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb642-28"><a href="prototype-based-models-of-categorization.html#cb642-28" tabindex="-1"></a><span class="st">  // Transform log_r to observation noise variance (r_value)</span></span>
<span id="cb642-29"><a href="prototype-based-models-of-categorization.html#cb642-29" tabindex="-1"></a><span class="st">  // Using exp() ensures positivity. Add a small epsilon for stability if needed.</span></span>
<span id="cb642-30"><a href="prototype-based-models-of-categorization.html#cb642-30" tabindex="-1"></a><span class="st">  real&lt;lower=1e-6&gt; r_value = exp(log_r); </span></span>
<span id="cb642-31"><a href="prototype-based-models-of-categorization.html#cb642-31" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-32"><a href="prototype-based-models-of-categorization.html#cb642-32" tabindex="-1"></a><span class="st">  // Store response probabilities for each trial</span></span>
<span id="cb642-33"><a href="prototype-based-models-of-categorization.html#cb642-33" tabindex="-1"></a><span class="st">  array[ntrials] real&lt;lower=0.0001, upper=0.9999&gt; p; // Prob of choosing category 1</span></span>
<span id="cb642-34"><a href="prototype-based-models-of-categorization.html#cb642-34" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-35"><a href="prototype-based-models-of-categorization.html#cb642-35" tabindex="-1"></a><span class="st">  // --- Kalman Filter Simulation within Stan ---</span></span>
<span id="cb642-36"><a href="prototype-based-models-of-categorization.html#cb642-36" tabindex="-1"></a><span class="st">  // Initialize prototypes (means and covariance matrices)</span></span>
<span id="cb642-37"><a href="prototype-based-models-of-categorization.html#cb642-37" tabindex="-1"></a><span class="st">  vector[nfeatures] mu_cat0 = initial_mu_cat0;</span></span>
<span id="cb642-38"><a href="prototype-based-models-of-categorization.html#cb642-38" tabindex="-1"></a><span class="st">  vector[nfeatures] mu_cat1 = initial_mu_cat1;</span></span>
<span id="cb642-39"><a href="prototype-based-models-of-categorization.html#cb642-39" tabindex="-1"></a><span class="st">  matrix[nfeatures, nfeatures] sigma_cat0 = diag_matrix(rep_vector(initial_sigma_diag, nfeatures));</span></span>
<span id="cb642-40"><a href="prototype-based-models-of-categorization.html#cb642-40" tabindex="-1"></a><span class="st">  matrix[nfeatures, nfeatures] sigma_cat1 = diag_matrix(rep_vector(initial_sigma_diag, nfeatures));</span></span>
<span id="cb642-41"><a href="prototype-based-models-of-categorization.html#cb642-41" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-42"><a href="prototype-based-models-of-categorization.html#cb642-42" tabindex="-1"></a><span class="st">  // Observation noise matrix (diagonal)</span></span>
<span id="cb642-43"><a href="prototype-based-models-of-categorization.html#cb642-43" tabindex="-1"></a><span class="st">  matrix[nfeatures, nfeatures] r_matrix = diag_matrix(rep_vector(r_value, nfeatures));</span></span>
<span id="cb642-44"><a href="prototype-based-models-of-categorization.html#cb642-44" tabindex="-1"></a><span class="st">  matrix[nfeatures, nfeatures] I = diag_matrix(rep_vector(1.0, nfeatures)); // Identity matrix</span></span>
<span id="cb642-45"><a href="prototype-based-models-of-categorization.html#cb642-45" tabindex="-1"></a></span>
<span id="cb642-46"><a href="prototype-based-models-of-categorization.html#cb642-46" tabindex="-1"></a><span class="st">  // Process trials sequentially </span></span>
<span id="cb642-47"><a href="prototype-based-models-of-categorization.html#cb642-47" tabindex="-1"></a><span class="st">  for (i in 1:ntrials) {</span></span>
<span id="cb642-48"><a href="prototype-based-models-of-categorization.html#cb642-48" tabindex="-1"></a><span class="st">    vector[nfeatures] current_obs = to_vector(obs[i]);</span></span>
<span id="cb642-49"><a href="prototype-based-models-of-categorization.html#cb642-49" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-50"><a href="prototype-based-models-of-categorization.html#cb642-50" tabindex="-1"></a><span class="st">    // --- Categorization Decision Probability ---</span></span>
<span id="cb642-51"><a href="prototype-based-models-of-categorization.html#cb642-51" tabindex="-1"></a><span class="st">    matrix[nfeatures, nfeatures] cov_cat0 = sigma_cat0 + r_matrix;</span></span>
<span id="cb642-52"><a href="prototype-based-models-of-categorization.html#cb642-52" tabindex="-1"></a><span class="st">    matrix[nfeatures, nfeatures] cov_cat1 = sigma_cat1 + r_matrix;</span></span>
<span id="cb642-53"><a href="prototype-based-models-of-categorization.html#cb642-53" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-54"><a href="prototype-based-models-of-categorization.html#cb642-54" tabindex="-1"></a><span class="st">    // Calculate log probability densities using multi_normal_lpdf for robustness</span></span>
<span id="cb642-55"><a href="prototype-based-models-of-categorization.html#cb642-55" tabindex="-1"></a><span class="st">    // Add bias term b (log(b) for cat 1, log(1-b) for cat 0)</span></span>
<span id="cb642-56"><a href="prototype-based-models-of-categorization.html#cb642-56" tabindex="-1"></a><span class="st">    real log_p0 = multi_normal_lpdf(current_obs | mu_cat0, cov_cat0) + log(1 - b);</span></span>
<span id="cb642-57"><a href="prototype-based-models-of-categorization.html#cb642-57" tabindex="-1"></a><span class="st">    real log_p1 = multi_normal_lpdf(current_obs | mu_cat1, cov_cat1) + log(b);</span></span>
<span id="cb642-58"><a href="prototype-based-models-of-categorization.html#cb642-58" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-59"><a href="prototype-based-models-of-categorization.html#cb642-59" tabindex="-1"></a><span class="st">    // Calculate probability of choosing category 1 using log_sum_exp</span></span>
<span id="cb642-60"><a href="prototype-based-models-of-categorization.html#cb642-60" tabindex="-1"></a><span class="st">    real log_sum_p = log_sum_exp(log_p0, log_p1);</span></span>
<span id="cb642-61"><a href="prototype-based-models-of-categorization.html#cb642-61" tabindex="-1"></a><span class="st">    real prob_cat_1 = exp(log_p1 - log_sum_p);</span></span>
<span id="cb642-62"><a href="prototype-based-models-of-categorization.html#cb642-62" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb642-63"><a href="prototype-based-models-of-categorization.html#cb642-63" tabindex="-1"></a><span class="st">    // Bound probabilities away from 0 and 1 for numerical stability</span></span>
<span id="cb642-64"><a href="prototype-based-models-of-categorization.html#cb642-64" tabindex="-1"></a><span class="st">    p[i] = fmax(fmin(prob_cat_1, 0.9999), 0.0001);</span></span>
<span id="cb642-65"><a href="prototype-based-models-of-categorization.html#cb642-65" tabindex="-1"></a></span>
<span id="cb642-66"><a href="prototype-based-models-of-categorization.html#cb642-66" tabindex="-1"></a><span class="st">    // --- Learning Update (based on true feedback cat_one[i]) ---</span></span>
<span id="cb642-67"><a href="prototype-based-models-of-categorization.html#cb642-67" tabindex="-1"></a><span class="st">    // Only update if it&#39;s not the very last observation </span></span>
<span id="cb642-68"><a href="prototype-based-models-of-categorization.html#cb642-68" tabindex="-1"></a><span class="st">    // (or adjust loop if feedback influences next trial&#39;s decision directly)</span></span>
<span id="cb642-69"><a href="prototype-based-models-of-categorization.html#cb642-69" tabindex="-1"></a><span class="st">    // This logic assumes decision P is based on state *before* update for trial i.</span></span>
<span id="cb642-70"><a href="prototype-based-models-of-categorization.html#cb642-70" tabindex="-1"></a><span class="st">    if (i &lt; ntrials) { // Optional: only update if there are future trials</span></span>
<span id="cb642-71"><a href="prototype-based-models-of-categorization.html#cb642-71" tabindex="-1"></a><span class="st">      if (cat_one[i] == 1) { // Update prototype 1</span></span>
<span id="cb642-72"><a href="prototype-based-models-of-categorization.html#cb642-72" tabindex="-1"></a><span class="st">        vector[nfeatures] innovation = current_obs - mu_cat1;</span></span>
<span id="cb642-73"><a href="prototype-based-models-of-categorization.html#cb642-73" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] S = sigma_cat1 + r_matrix;</span></span>
<span id="cb642-74"><a href="prototype-based-models-of-categorization.html#cb642-74" tabindex="-1"></a><span class="st">        // Use mdivide_right_spd for K = Sigma * S^-1 (more stable)</span></span>
<span id="cb642-75"><a href="prototype-based-models-of-categorization.html#cb642-75" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] K = mdivide_right_spd(sigma_cat1, S); </span></span>
<span id="cb642-76"><a href="prototype-based-models-of-categorization.html#cb642-76" tabindex="-1"></a><span class="st">        mu_cat1 = mu_cat1 + K * innovation;</span></span>
<span id="cb642-77"><a href="prototype-based-models-of-categorization.html#cb642-77" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] IK = I - K;</span></span>
<span id="cb642-78"><a href="prototype-based-models-of-categorization.html#cb642-78" tabindex="-1"></a><span class="st">        // Joseph form update for sigma</span></span>
<span id="cb642-79"><a href="prototype-based-models-of-categorization.html#cb642-79" tabindex="-1"></a><span class="st">        sigma_cat1 = IK * sigma_cat1 * IK&#39; + K * r_matrix * K&#39;; </span></span>
<span id="cb642-80"><a href="prototype-based-models-of-categorization.html#cb642-80" tabindex="-1"></a><span class="st">      } else { // Update prototype 0</span></span>
<span id="cb642-81"><a href="prototype-based-models-of-categorization.html#cb642-81" tabindex="-1"></a><span class="st">        vector[nfeatures] innovation = current_obs - mu_cat0;</span></span>
<span id="cb642-82"><a href="prototype-based-models-of-categorization.html#cb642-82" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] S = sigma_cat0 + r_matrix;</span></span>
<span id="cb642-83"><a href="prototype-based-models-of-categorization.html#cb642-83" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] K = mdivide_right_spd(sigma_cat0, S);</span></span>
<span id="cb642-84"><a href="prototype-based-models-of-categorization.html#cb642-84" tabindex="-1"></a><span class="st">        mu_cat0 = mu_cat0 + K * innovation;</span></span>
<span id="cb642-85"><a href="prototype-based-models-of-categorization.html#cb642-85" tabindex="-1"></a><span class="st">        matrix[nfeatures, nfeatures] IK = I - K;</span></span>
<span id="cb642-86"><a href="prototype-based-models-of-categorization.html#cb642-86" tabindex="-1"></a><span class="st">        sigma_cat0 = IK * sigma_cat0 * IK&#39; + K * r_matrix * K&#39;;</span></span>
<span id="cb642-87"><a href="prototype-based-models-of-categorization.html#cb642-87" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb642-88"><a href="prototype-based-models-of-categorization.html#cb642-88" tabindex="-1"></a><span class="st">       // Ensure symmetry after update (optional but good practice)</span></span>
<span id="cb642-89"><a href="prototype-based-models-of-categorization.html#cb642-89" tabindex="-1"></a><span class="st">       sigma_cat0 = 0.5 * (sigma_cat0 + sigma_cat0&#39;);</span></span>
<span id="cb642-90"><a href="prototype-based-models-of-categorization.html#cb642-90" tabindex="-1"></a><span class="st">       sigma_cat1 = 0.5 * (sigma_cat1 + sigma_cat1&#39;);</span></span>
<span id="cb642-91"><a href="prototype-based-models-of-categorization.html#cb642-91" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb642-92"><a href="prototype-based-models-of-categorization.html#cb642-92" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-93"><a href="prototype-based-models-of-categorization.html#cb642-93" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-94"><a href="prototype-based-models-of-categorization.html#cb642-94" tabindex="-1"></a></span>
<span id="cb642-95"><a href="prototype-based-models-of-categorization.html#cb642-95" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb642-96"><a href="prototype-based-models-of-categorization.html#cb642-96" tabindex="-1"></a><span class="st">  // Prior for the observation noise parameter (on log scale)</span></span>
<span id="cb642-97"><a href="prototype-based-models-of-categorization.html#cb642-97" tabindex="-1"></a><span class="st">  target += normal_lpdf(log_r | prior_logr_mean, prior_logr_sd);  </span></span>
<span id="cb642-98"><a href="prototype-based-models-of-categorization.html#cb642-98" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-99"><a href="prototype-based-models-of-categorization.html#cb642-99" tabindex="-1"></a><span class="st">  // Likelihood: Observed decisions y follow a Bernoulli distribution</span></span>
<span id="cb642-100"><a href="prototype-based-models-of-categorization.html#cb642-100" tabindex="-1"></a><span class="st">  // with probabilities p calculated in transformed parameters</span></span>
<span id="cb642-101"><a href="prototype-based-models-of-categorization.html#cb642-101" tabindex="-1"></a><span class="st">  target += bernoulli_lpmf(y | p);</span></span>
<span id="cb642-102"><a href="prototype-based-models-of-categorization.html#cb642-102" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb642-103"><a href="prototype-based-models-of-categorization.html#cb642-103" tabindex="-1"></a></span>
<span id="cb642-104"><a href="prototype-based-models-of-categorization.html#cb642-104" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb642-105"><a href="prototype-based-models-of-categorization.html#cb642-105" tabindex="-1"></a><span class="st">  // Calculate log likelihood for each trial for model comparison (e.g., LOO)</span></span>
<span id="cb642-106"><a href="prototype-based-models-of-categorization.html#cb642-106" tabindex="-1"></a><span class="st">  array[ntrials] real log_lik;</span></span>
<span id="cb642-107"><a href="prototype-based-models-of-categorization.html#cb642-107" tabindex="-1"></a><span class="st">  for (i in 1:ntrials) {</span></span>
<span id="cb642-108"><a href="prototype-based-models-of-categorization.html#cb642-108" tabindex="-1"></a><span class="st">    log_lik[i] = bernoulli_lpmf(y[i] | p[i]);</span></span>
<span id="cb642-109"><a href="prototype-based-models-of-categorization.html#cb642-109" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-110"><a href="prototype-based-models-of-categorization.html#cb642-110" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb642-111"><a href="prototype-based-models-of-categorization.html#cb642-111" tabindex="-1"></a><span class="st">  // Posterior predictive checks: simulate data based on estimated parameters</span></span>
<span id="cb642-112"><a href="prototype-based-models-of-categorization.html#cb642-112" tabindex="-1"></a><span class="st">  array[ntrials] int y_pred;</span></span>
<span id="cb642-113"><a href="prototype-based-models-of-categorization.html#cb642-113" tabindex="-1"></a><span class="st">  for (i in 1:ntrials) {</span></span>
<span id="cb642-114"><a href="prototype-based-models-of-categorization.html#cb642-114" tabindex="-1"></a><span class="st">    y_pred[i] = bernoulli_rng(p[i]);</span></span>
<span id="cb642-115"><a href="prototype-based-models-of-categorization.html#cb642-115" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb642-116"><a href="prototype-based-models-of-categorization.html#cb642-116" tabindex="-1"></a></span>
<span id="cb642-117"><a href="prototype-based-models-of-categorization.html#cb642-117" tabindex="-1"></a><span class="st">  // Save estimated r_value on original scale</span></span>
<span id="cb642-118"><a href="prototype-based-models-of-categorization.html#cb642-118" tabindex="-1"></a><span class="st">  real estimated_r_value = r_value; </span></span>
<span id="cb642-119"><a href="prototype-based-models-of-categorization.html#cb642-119" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb642-120"><a href="prototype-based-models-of-categorization.html#cb642-120" tabindex="-1"></a></span>
<span id="cb642-121"><a href="prototype-based-models-of-categorization.html#cb642-121" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb642-122"><a href="prototype-based-models-of-categorization.html#cb642-122" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb642-123"><a href="prototype-based-models-of-categorization.html#cb642-123" tabindex="-1"></a>  prototype_single_stan,</span>
<span id="cb642-124"><a href="prototype-based-models-of-categorization.html#cb642-124" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb642-125"><a href="prototype-based-models-of-categorization.html#cb642-125" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W12_prototype_single.stan&quot;</span></span>
<span id="cb642-126"><a href="prototype-based-models-of-categorization.html#cb642-126" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W12_prototype_single.stan&quot;</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="prototype-based-models-of-categorization.html#cb644-1" tabindex="-1"></a><span class="co"># Compile the Stan model using cmdstanr</span></span>
<span id="cb644-2"><a href="prototype-based-models-of-categorization.html#cb644-2" tabindex="-1"></a><span class="co"># This might take a minute or two the first time it&#39;s run</span></span>
<span id="cb644-3"><a href="prototype-based-models-of-categorization.html#cb644-3" tabindex="-1"></a>mod_prototype_single <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb644-4"><a href="prototype-based-models-of-categorization.html#cb644-4" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="st">&quot;stan/W12_prototype_single.stan&quot;</span>),</span>
<span id="cb644-5"><a href="prototype-based-models-of-categorization.html#cb644-5" tabindex="-1"></a>    <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>)</span>
<span id="cb644-6"><a href="prototype-based-models-of-categorization.html#cb644-6" tabindex="-1"></a>  )</span>
<span id="cb644-7"><a href="prototype-based-models-of-categorization.html#cb644-7" tabindex="-1"></a></span>
<span id="cb644-8"><a href="prototype-based-models-of-categorization.html#cb644-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Stan model compiled successfully.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Stan model compiled successfully.</code></pre>
<p>Key aspects of the Stan implementation:</p>
<ul>
<li><p>Data: Takes trial-by-trial observations (obs), true categories (cat_one for updates), and participant responses (y). Also requires initial prototype states and prior parameters.</p></li>
<li><p>Parameters: Estimates log_r, the logarithm of the observation noise variance. Estimating on the log scale helps with sampling as variance must be positive.</p></li>
<li><p>Transformed Parameters:</p></li>
</ul>
<p>** Calculates r_value = exp(log_r).</p>
<p>** Re-simulates the Kalman filter trial-by-trial, updating mu and sigma based on cat_one.</p>
<p>** Calculates the probability p[i] of choosing Category 1 for each trial before the update for that trial, using the current mu, sigma, and estimated r_value.</p>
<ul>
<li>Model Block:</li>
</ul>
<p>** Sets a prior on log_r (e.g., normal(0, 1), meaning r_value is centered around exp(0)=1).</p>
<p>** Defines the likelihood using bernoulli_lpmf(y | p), stating that the observed responses y are Bernoulli distributed with the calculated probabilities p.</p>
<ul>
<li>Generated Quantities: Calculates log-likelihood for model comparison and generates posterior predictions (y_pred).</li>
</ul>
</div>
<div id="parameter-recovery-can-we-retrieve-the-noise-parameter" class="section level3 hasAnchor" number="13.5.2">
<h3><span class="header-section-number">13.5.2</span> Parameter Recovery: Can We Retrieve the Noise Parameter?<a href="prototype-based-models-of-categorization.html#parameter-recovery-can-we-retrieve-the-noise-parameter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A crucial check is parameter recovery. If we simulate data with a known r_value, can our Stan model accurately estimate it back?</p>
<p>We will simulate data using the same experimental structure (experiment) and the prototype_kalman R function used earlier. This ensures we test recovery on data generated precisely by the model logic we’re trying to fit.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="prototype-based-models-of-categorization.html#cb646-1" tabindex="-1"></a><span class="co"># Function to run one simulation and prepare Stan data</span></span>
<span id="cb646-2"><a href="prototype-based-models-of-categorization.html#cb646-2" tabindex="-1"></a>run_single_recovery_trial <span class="ot">&lt;-</span> <span class="cf">function</span>(true_r_value, experiment_data) {</span>
<span id="cb646-3"><a href="prototype-based-models-of-categorization.html#cb646-3" tabindex="-1"></a>  </span>
<span id="cb646-4"><a href="prototype-based-models-of-categorization.html#cb646-4" tabindex="-1"></a>  <span class="co"># Simulate responses using prototype_kalman</span></span>
<span id="cb646-5"><a href="prototype-based-models-of-categorization.html#cb646-5" tabindex="-1"></a>  sim_responses <span class="ot">&lt;-</span> <span class="fu">prototype_kalman</span>(</span>
<span id="cb646-6"><a href="prototype-based-models-of-categorization.html#cb646-6" tabindex="-1"></a>    <span class="at">r_value =</span> true_r_value,</span>
<span id="cb646-7"><a href="prototype-based-models-of-categorization.html#cb646-7" tabindex="-1"></a>    <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment_data[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb646-8"><a href="prototype-based-models-of-categorization.html#cb646-8" tabindex="-1"></a>    <span class="at">cat_one =</span> experiment_data<span class="sc">$</span>category,</span>
<span id="cb646-9"><a href="prototype-based-models-of-categorization.html#cb646-9" tabindex="-1"></a>    <span class="at">initial_mu =</span> <span class="fu">list</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>)),</span>
<span id="cb646-10"><a href="prototype-based-models-of-categorization.html#cb646-10" tabindex="-1"></a>    <span class="at">initial_sigma_diag =</span> <span class="fl">10.0</span>,</span>
<span id="cb646-11"><a href="prototype-based-models-of-categorization.html#cb646-11" tabindex="-1"></a>    <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb646-12"><a href="prototype-based-models-of-categorization.html#cb646-12" tabindex="-1"></a>  )</span>
<span id="cb646-13"><a href="prototype-based-models-of-categorization.html#cb646-13" tabindex="-1"></a>  </span>
<span id="cb646-14"><a href="prototype-based-models-of-categorization.html#cb646-14" tabindex="-1"></a>  <span class="co"># Prepare data list for Stan</span></span>
<span id="cb646-15"><a href="prototype-based-models-of-categorization.html#cb646-15" tabindex="-1"></a>  stan_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb646-16"><a href="prototype-based-models-of-categorization.html#cb646-16" tabindex="-1"></a>    <span class="at">ntrials =</span> <span class="fu">nrow</span>(experiment_data),</span>
<span id="cb646-17"><a href="prototype-based-models-of-categorization.html#cb646-17" tabindex="-1"></a>    <span class="at">nfeatures =</span> <span class="dv">2</span>,</span>
<span id="cb646-18"><a href="prototype-based-models-of-categorization.html#cb646-18" tabindex="-1"></a>    <span class="at">cat_one =</span> experiment_data<span class="sc">$</span>category,</span>
<span id="cb646-19"><a href="prototype-based-models-of-categorization.html#cb646-19" tabindex="-1"></a>    <span class="at">y =</span> sim_responses, <span class="co"># Use simulated responses as &#39;observed&#39; data</span></span>
<span id="cb646-20"><a href="prototype-based-models-of-categorization.html#cb646-20" tabindex="-1"></a>    <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment_data[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb646-21"><a href="prototype-based-models-of-categorization.html#cb646-21" tabindex="-1"></a>    <span class="at">b =</span> <span class="fl">0.5</span>, <span class="co"># No bias</span></span>
<span id="cb646-22"><a href="prototype-based-models-of-categorization.html#cb646-22" tabindex="-1"></a>    <span class="at">initial_mu_cat0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb646-23"><a href="prototype-based-models-of-categorization.html#cb646-23" tabindex="-1"></a>    <span class="at">initial_mu_cat1 =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb646-24"><a href="prototype-based-models-of-categorization.html#cb646-24" tabindex="-1"></a>    <span class="at">initial_sigma_diag =</span> <span class="fl">10.0</span>,</span>
<span id="cb646-25"><a href="prototype-based-models-of-categorization.html#cb646-25" tabindex="-1"></a>    <span class="at">prior_logr_mean =</span> <span class="dv">0</span>, <span class="co"># Prior centered on r_value=1</span></span>
<span id="cb646-26"><a href="prototype-based-models-of-categorization.html#cb646-26" tabindex="-1"></a>    <span class="at">prior_logr_sd =</span> <span class="fl">1.0</span>  <span class="co"># Reasonably broad prior</span></span>
<span id="cb646-27"><a href="prototype-based-models-of-categorization.html#cb646-27" tabindex="-1"></a>  )</span>
<span id="cb646-28"><a href="prototype-based-models-of-categorization.html#cb646-28" tabindex="-1"></a>  </span>
<span id="cb646-29"><a href="prototype-based-models-of-categorization.html#cb646-29" tabindex="-1"></a>  <span class="fu">return</span>(stan_data)</span>
<span id="cb646-30"><a href="prototype-based-models-of-categorization.html#cb646-30" tabindex="-1"></a>}</span>
<span id="cb646-31"><a href="prototype-based-models-of-categorization.html#cb646-31" tabindex="-1"></a></span>
<span id="cb646-32"><a href="prototype-based-models-of-categorization.html#cb646-32" tabindex="-1"></a><span class="co"># Define true r_values to test</span></span>
<span id="cb646-33"><a href="prototype-based-models-of-categorization.html#cb646-33" tabindex="-1"></a>r_values_to_test <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">5.0</span>)</span>
<span id="cb646-34"><a href="prototype-based-models-of-categorization.html#cb646-34" tabindex="-1"></a></span>
<span id="cb646-35"><a href="prototype-based-models-of-categorization.html#cb646-35" tabindex="-1"></a><span class="co"># Data frame to store recovery results</span></span>
<span id="cb646-36"><a href="prototype-based-models-of-categorization.html#cb646-36" tabindex="-1"></a>recovery_results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb646-37"><a href="prototype-based-models-of-categorization.html#cb646-37" tabindex="-1"></a></span>
<span id="cb646-38"><a href="prototype-based-models-of-categorization.html#cb646-38" tabindex="-1"></a><span class="co"># (Load pre-computed results if regenerate_simulations is FALSE)</span></span>
<span id="cb646-39"><a href="prototype-based-models-of-categorization.html#cb646-39" tabindex="-1"></a>recovery_file <span class="ot">&lt;-</span> <span class="st">&quot;simdata/W12_prototype_recovery_results.rds&quot;</span></span>
<span id="cb646-40"><a href="prototype-based-models-of-categorization.html#cb646-40" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(recovery_file)) {</span>
<span id="cb646-41"><a href="prototype-based-models-of-categorization.html#cb646-41" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Regenerating parameter recovery simulations...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb646-42"><a href="prototype-based-models-of-categorization.html#cb646-42" tabindex="-1"></a>  </span>
<span id="cb646-43"><a href="prototype-based-models-of-categorization.html#cb646-43" tabindex="-1"></a>  <span class="co"># Loop through each true r_value</span></span>
<span id="cb646-44"><a href="prototype-based-models-of-categorization.html#cb646-44" tabindex="-1"></a>  <span class="cf">for</span> (r_val <span class="cf">in</span> r_values_to_test) {</span>
<span id="cb646-45"><a href="prototype-based-models-of-categorization.html#cb646-45" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;  Testing r_value =&quot;</span>, r_val, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb646-46"><a href="prototype-based-models-of-categorization.html#cb646-46" tabindex="-1"></a>    </span>
<span id="cb646-47"><a href="prototype-based-models-of-categorization.html#cb646-47" tabindex="-1"></a>    <span class="co"># 1. Generate synthetic data for this r_value</span></span>
<span id="cb646-48"><a href="prototype-based-models-of-categorization.html#cb646-48" tabindex="-1"></a>    current_stan_data <span class="ot">&lt;-</span> <span class="fu">run_single_recovery_trial</span>(r_val, experiment)</span>
<span id="cb646-49"><a href="prototype-based-models-of-categorization.html#cb646-49" tabindex="-1"></a>    </span>
<span id="cb646-50"><a href="prototype-based-models-of-categorization.html#cb646-50" tabindex="-1"></a>    <span class="co"># 2. Fit the Stan model (using pre-compiled model)</span></span>
<span id="cb646-51"><a href="prototype-based-models-of-categorization.html#cb646-51" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> mod_prototype_single<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb646-52"><a href="prototype-based-models-of-categorization.html#cb646-52" tabindex="-1"></a>      <span class="at">data =</span> current_stan_data,</span>
<span id="cb646-53"><a href="prototype-based-models-of-categorization.html#cb646-53" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb646-54"><a href="prototype-based-models-of-categorization.html#cb646-54" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">2</span>, <span class="co"># Use at least 2 chains</span></span>
<span id="cb646-55"><a href="prototype-based-models-of-categorization.html#cb646-55" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb646-56"><a href="prototype-based-models-of-categorization.html#cb646-56" tabindex="-1"></a>      <span class="at">threads_per_chain =</span> <span class="dv">1</span>, <span class="co"># Adjust based on system cores</span></span>
<span id="cb646-57"><a href="prototype-based-models-of-categorization.html#cb646-57" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">500</span>, <span class="co"># Reduced iterations for faster recovery check</span></span>
<span id="cb646-58"><a href="prototype-based-models-of-categorization.html#cb646-58" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb646-59"><a href="prototype-based-models-of-categorization.html#cb646-59" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">0</span>, <span class="co"># Suppress verbose output</span></span>
<span id="cb646-60"><a href="prototype-based-models-of-categorization.html#cb646-60" tabindex="-1"></a>      <span class="at">show_messages =</span> <span class="cn">FALSE</span></span>
<span id="cb646-61"><a href="prototype-based-models-of-categorization.html#cb646-61" tabindex="-1"></a>    )</span>
<span id="cb646-62"><a href="prototype-based-models-of-categorization.html#cb646-62" tabindex="-1"></a>    </span>
<span id="cb646-63"><a href="prototype-based-models-of-categorization.html#cb646-63" tabindex="-1"></a>    <span class="co"># 3. Extract estimated r_value posterior</span></span>
<span id="cb646-64"><a href="prototype-based-models-of-categorization.html#cb646-64" tabindex="-1"></a>    <span class="co"># Use the variable saved in generated quantities</span></span>
<span id="cb646-65"><a href="prototype-based-models-of-categorization.html#cb646-65" tabindex="-1"></a>    draws <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="st">&quot;estimated_r_value&quot;</span>, <span class="at">format =</span> <span class="st">&quot;df&quot;</span>) </span>
<span id="cb646-66"><a href="prototype-based-models-of-categorization.html#cb646-66" tabindex="-1"></a>    estimate_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws<span class="sc">$</span>estimated_r_value)</span>
<span id="cb646-67"><a href="prototype-based-models-of-categorization.html#cb646-67" tabindex="-1"></a>    ci_lower <span class="ot">&lt;-</span> <span class="fu">quantile</span>(draws<span class="sc">$</span>estimated_r_value, <span class="fl">0.025</span>)</span>
<span id="cb646-68"><a href="prototype-based-models-of-categorization.html#cb646-68" tabindex="-1"></a>    ci_upper <span class="ot">&lt;-</span> <span class="fu">quantile</span>(draws<span class="sc">$</span>estimated_r_value, <span class="fl">0.975</span>)</span>
<span id="cb646-69"><a href="prototype-based-models-of-categorization.html#cb646-69" tabindex="-1"></a>    </span>
<span id="cb646-70"><a href="prototype-based-models-of-categorization.html#cb646-70" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb646-71"><a href="prototype-based-models-of-categorization.html#cb646-71" tabindex="-1"></a>    recovery_results_list[[<span class="fu">length</span>(recovery_results_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb646-72"><a href="prototype-based-models-of-categorization.html#cb646-72" tabindex="-1"></a>      <span class="at">true_r_value =</span> r_val,</span>
<span id="cb646-73"><a href="prototype-based-models-of-categorization.html#cb646-73" tabindex="-1"></a>      <span class="at">estimated_r_mean =</span> estimate_mean,</span>
<span id="cb646-74"><a href="prototype-based-models-of-categorization.html#cb646-74" tabindex="-1"></a>      <span class="at">est_lower_95 =</span> ci_lower,</span>
<span id="cb646-75"><a href="prototype-based-models-of-categorization.html#cb646-75" tabindex="-1"></a>      <span class="at">est_upper_95 =</span> ci_upper</span>
<span id="cb646-76"><a href="prototype-based-models-of-categorization.html#cb646-76" tabindex="-1"></a>    )</span>
<span id="cb646-77"><a href="prototype-based-models-of-categorization.html#cb646-77" tabindex="-1"></a>  } <span class="co"># End loop over r_values</span></span>
<span id="cb646-78"><a href="prototype-based-models-of-categorization.html#cb646-78" tabindex="-1"></a>  </span>
<span id="cb646-79"><a href="prototype-based-models-of-categorization.html#cb646-79" tabindex="-1"></a>  recovery_results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(recovery_results_list)</span>
<span id="cb646-80"><a href="prototype-based-models-of-categorization.html#cb646-80" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb646-81"><a href="prototype-based-models-of-categorization.html#cb646-81" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;simdata&quot;</span>)) <span class="fu">dir.create</span>(<span class="st">&quot;simdata&quot;</span>)</span>
<span id="cb646-82"><a href="prototype-based-models-of-categorization.html#cb646-82" tabindex="-1"></a>  <span class="fu">saveRDS</span>(recovery_results, recovery_file)</span>
<span id="cb646-83"><a href="prototype-based-models-of-categorization.html#cb646-83" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Parameter recovery simulations saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb646-84"><a href="prototype-based-models-of-categorization.html#cb646-84" tabindex="-1"></a></span>
<span id="cb646-85"><a href="prototype-based-models-of-categorization.html#cb646-85" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb646-86"><a href="prototype-based-models-of-categorization.html#cb646-86" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loading existing parameter recovery results...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb646-87"><a href="prototype-based-models-of-categorization.html#cb646-87" tabindex="-1"></a>  recovery_results <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(recovery_file)</span>
<span id="cb646-88"><a href="prototype-based-models-of-categorization.html#cb646-88" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Results loaded.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb646-89"><a href="prototype-based-models-of-categorization.html#cb646-89" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loading existing parameter recovery results...
## Results loaded.</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="prototype-based-models-of-categorization.html#cb648-1" tabindex="-1"></a><span class="co"># --- Visualize parameter recovery ---</span></span>
<span id="cb648-2"><a href="prototype-based-models-of-categorization.html#cb648-2" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_results, <span class="fu">aes</span>(<span class="at">x =</span> true_r_value, <span class="at">y =</span> estimated_r_mean)) <span class="sc">+</span></span>
<span id="cb648-3"><a href="prototype-based-models-of-categorization.html#cb648-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb648-4"><a href="prototype-based-models-of-categorization.html#cb648-4" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> est_lower_95, <span class="at">ymax =</span> est_upper_95), <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb648-5"><a href="prototype-based-models-of-categorization.html#cb648-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;dodgerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb648-6"><a href="prototype-based-models-of-categorization.html#cb648-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb648-7"><a href="prototype-based-models-of-categorization.html#cb648-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Parameter Recovery for Prototype Model (r_value)&quot;</span>,</span>
<span id="cb648-8"><a href="prototype-based-models-of-categorization.html#cb648-8" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Points are posterior means, bars are 95% Credible Intervals.</span><span class="sc">\n</span><span class="st">Dashed line is perfect recovery.&quot;</span>,</span>
<span id="cb648-9"><a href="prototype-based-models-of-categorization.html#cb648-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Observation Noise Variance (r_value)&quot;</span>,</span>
<span id="cb648-10"><a href="prototype-based-models-of-categorization.html#cb648-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Observation Noise Variance&quot;</span></span>
<span id="cb648-11"><a href="prototype-based-models-of-categorization.html#cb648-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb648-12"><a href="prototype-based-models-of-categorization.html#cb648-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb648-13"><a href="prototype-based-models-of-categorization.html#cb648-13" tabindex="-1"></a>  <span class="co"># Adjust scale if needed, e.g., scale_x_log10() + scale_y_log10() if range is large</span></span>
<span id="cb648-14"><a href="prototype-based-models-of-categorization.html#cb648-14" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(recovery_results<span class="sc">$</span>true_r_value) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb648-15"><a href="prototype-based-models-of-categorization.html#cb648-15" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(recovery_results<span class="sc">$</span>est_lower_95, recovery_results<span class="sc">$</span>est_upper_95)) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>) )</span></code></pre></div>
<p><img src="series_files/figure-html/12%20recovery_simulation-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Discussion of Recovery Results: Examine the plot. Ideally, the points should fall close to the dashed diagonal line, and the error bars (95% credible intervals) should overlap the true value.</p>
</div>
</div>
<div id="cognitive-insights-and-model-comparison" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Cognitive Insights and Model Comparison<a href="prototype-based-models-of-categorization.html#cognitive-insights-and-model-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Kalman filter prototype model offers valuable insights:</p>
<ul>
<li><p>Incremental, Adaptive Learning: It formalizes how category knowledge can be built up one example at a time, with learning automatically slowing down as confidence increases.
Uncertainty Representation: It explicitly models the learner’s uncertainty about category prototypes.</p></li>
<li><p>Memory Efficiency: It achieves learning by storing only summary statistics (mean and covariance) per category, aligning with intuitions about cognitive limits.</p></li>
</ul>
<div id="comparing-to-exemplar-models-gcm" class="section level3 hasAnchor" number="13.6.1">
<h3><span class="header-section-number">13.6.1</span> Comparing to Exemplar Models (GCM):<a href="prototype-based-models-of-categorization.html#comparing-to-exemplar-models-gcm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>The GCM stores every detail; the prototype model abstracts.</p></li>
<li><p>The GCM is sensitive to specific outliers; the prototype model is less so (outliers get averaged in).</p></li>
<li><p>The GCM requires explicit attention weights; attention in the Kalman filter can emerge implicitly if uncertainty differs across dimensions (though not explored in detail here).</p></li>
</ul>
</div>
<div id="limitations-1" class="section level3 hasAnchor" number="13.6.2">
<h3><span class="header-section-number">13.6.2</span> Limitations:<a href="prototype-based-models-of-categorization.html#limitations-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Abstraction Loses Detail: Information about specific examples and category variance beyond the covariance matrix is lost. There are models that try to combine both approaches [MISSING REFS].</p></li>
<li><p>Single Prototype: Assumes categories have a single central tendency, struggling with disjunctive categories (e.g., “mammals that fly or swim”). Extensions like multiple-prototype models address this[MISSING REFS].</p></li>
</ul>
<p>Conclusion</p>
<p>The Kalman filter prototype model provides a dynamic, computationally plausible account of how categories might be learned by abstracting central tendencies and tracking uncertainty. While parameter estimation can be challenging, the model captures key aspects of incremental learning and memory efficiency. It stands as a compelling alternative to exemplar-based approaches, highlighting the fundamental trade-off between detailed instance memory and abstract summary representation in categorization. The next chapter will introduce a third perspective: rule-based models.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-categorization-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rule-based-models-of-categorization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/12-CategorizationModelsPrototypes.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
