<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Rule-Based Models of Categorization | Chapter 13: Rule-Based Models - Learning Explicit Criteria</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Rule-Based Models of Categorization | Chapter 13: Rule-Based Models - Learning Explicit Criteria" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Rule-Based Models of Categorization | Chapter 13: Rule-Based Models - Learning Explicit Criteria" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-04-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prototype-based-models-of-categorization.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.4</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.5</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
<li class="chapter" data-level="5.7.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.7.2</b> Connection to Kalman Filters</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.2</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#bayesian-memory-agent"><i class="fa fa-check"></i><b>5.9</b> Bayesian memory agent</a></li>
<li class="chapter" data-level="5.10" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.10</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#complete-pooling"><i class="fa fa-check"></i><b>7.3.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="7.3.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#no-pooling"><i class="fa fa-check"></i><b>7.3.2</b> No Pooling</a></li>
<li class="chapter" data-level="7.3.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#partial-pooling-multilevel-modeling"><i class="fa fa-check"></i><b>7.3.3</b> Partial Pooling (Multilevel Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#graphical-model-visualization"><i class="fa fa-check"></i><b>7.4</b> Graphical Model Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#biased-agent-model"><i class="fa fa-check"></i><b>7.4.1</b> Biased Agent Model</a></li>
<li class="chapter" data-level="7.4.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#memory-agent-model"><i class="fa fa-check"></i><b>7.4.2</b> Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random-agent-model"><i class="fa fa-check"></i><b>7.8</b> Multilevel Random Agent Model</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.8.1</b> Assessing multilevel random agents</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#lets-look-at-individuals"><i class="fa fa-check"></i><b>7.9</b> Let’s look at individuals</a></li>
<li class="chapter" data-level="7.10" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-sensitivity-checks"><i class="fa fa-check"></i><b>7.10</b> Prior sensitivity checks</a></li>
<li class="chapter" data-level="7.11" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-1"><i class="fa fa-check"></i><b>7.11</b> Parameter recovery</a></li>
<li class="chapter" data-level="7.12" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-agent-model"><i class="fa fa-check"></i><b>7.12</b> Multilevel Memory Agent Model</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.12.1</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#diagnosing-the-issue-with-bias-and-beta"><i class="fa fa-check"></i><b>7.12.2</b> Diagnosing the issue with bias and beta</a></li>
<li class="chapter" data-level="7.12.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.12.3</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.12.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.12.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.12.5</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.12.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.12.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#section"><i class="fa fa-check"></i><b>7.12.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches"><i class="fa fa-check"></i><b>7.13</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.14" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches-1"><i class="fa fa-check"></i><b>7.14</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.15" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-modeling-cheatsheet"><i class="fa fa-check"></i><b>7.15</b> Multilevel Modeling Cheatsheet</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#when-to-use-each-pooling-approach"><i class="fa fa-check"></i><b>7.15.1</b> When to Use Each Pooling Approach:</a></li>
<li class="chapter" data-level="7.15.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-rules-of-thumb"><i class="fa fa-check"></i><b>7.15.2</b> Parameter Recovery Rules of Thumb:</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#conclusion-the-power-and-challenges-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.16</b> Conclusion: The Power and Challenges of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.17" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#exercises-just-some-ideas"><i class="fa fa-check"></i><b>7.17</b> Exercises (just some ideas)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-challenge-of-model-selection"><i class="fa fa-check"></i><b>8.2.1</b> The Challenge of Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-the-foundation-of-model-comparison"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation: The Foundation of Model Comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-problem-of-overfitting"><i class="fa fa-check"></i><b>8.3.1</b> The Problem of Overfitting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-cross-validation-works"><i class="fa fa-check"></i><b>8.3.2</b> How Cross-Validation Works</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-in-bayesian-models"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation in Bayesian Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#expected-log-predictive-density-elpd"><i class="fa fa-check"></i><b>8.3.4</b> Expected Log Predictive Density (ELPD)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-an-efficient-approximation-to-loo-cv"><i class="fa fa-check"></i><b>8.4</b> PSIS-LOO: An Efficient Approximation to LOO-CV</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-importance-sampling-works"><i class="fa fa-check"></i><b>8.4.1</b> How Importance Sampling Works</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#pareto-smoothing-for-stability"><i class="fa fa-check"></i><b>8.4.2</b> Pareto Smoothing for Stability</a></li>
<li class="chapter" data-level="8.4.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-complete-psis-loo-process"><i class="fa fa-check"></i><b>8.4.3</b> The Complete PSIS-LOO Process</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#simulation-based-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Simulation-Based Model Comparison</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-simulation-parameters"><i class="fa fa-check"></i><b>8.5.1</b> Define Simulation Parameters</a></li>
<li class="chapter" data-level="8.5.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-agent-functions"><i class="fa fa-check"></i><b>8.5.2</b> Define Agent Functions</a></li>
<li class="chapter" data-level="8.5.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generate-simulation-data"><i class="fa fa-check"></i><b>8.5.3</b> Generate Simulation Data</a></li>
<li class="chapter" data-level="8.5.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualize-the-simulation-data"><i class="fa fa-check"></i><b>8.5.4</b> Visualize the Simulation Data</a></li>
<li class="chapter" data-level="8.5.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prepare-data-for-stan-models"><i class="fa fa-check"></i><b>8.5.5</b> Prepare Data for Stan Models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-models-for-comparison"><i class="fa fa-check"></i><b>8.6</b> Implementing Models for Comparison</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#understanding-log-likelihood-in-model-comparison"><i class="fa fa-check"></i><b>8.6.1</b> Understanding Log-Likelihood in Model Comparison</a></li>
<li class="chapter" data-level="8.6.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-biased-agent-model"><i class="fa fa-check"></i><b>8.6.2</b> Multilevel Biased Agent Model</a></li>
<li class="chapter" data-level="8.6.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-agent-model-1"><i class="fa fa-check"></i><b>8.6.3</b> Multilevel Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-models-and-calculating-expected-log-predictive-density"><i class="fa fa-check"></i><b>8.7</b> Fitting Models and Calculating Expected Log Predictive Density</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-for-model-comparison"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation for Model Comparison</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-comparison"><i class="fa fa-check"></i><b>8.9.1</b> PSIS-LOO Comparison</a></li>
<li class="chapter" data-level="8.9.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualizing-loo-cv-results"><i class="fa fa-check"></i><b>8.9.2</b> Visualizing LOO-CV Results</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#formal-model-comparison"><i class="fa fa-check"></i><b>8.10</b> Formal Model Comparison</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#k-fold-cross-validation-for-validation"><i class="fa fa-check"></i><b>8.10.1</b> K-Fold Cross-Validation for Validation</a></li>
<li class="chapter" data-level="8.10.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#comparing-loo-and-k-fold-results"><i class="fa fa-check"></i><b>8.10.2</b> Comparing LOO and K-Fold Results</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-approaches"><i class="fa fa-check"></i><b>8.11</b> Limitations of Model Comparison Approaches</a></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#exercises"><i class="fa fa-check"></i><b>8.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.12.1</b> Rant on internal vs external validity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>9</b> Mixture models</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="mixture-models.html"><a href="mixture-models.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.0.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.0.2" data-path="mixture-models.html"><a href="mixture-models.html#chapter-roadmap"><i class="fa fa-check"></i><b>9.0.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="9.1" data-path="mixture-models.html"><a href="mixture-models.html#visualizing-mixture-distributions-reaction-time-example"><i class="fa fa-check"></i><b>9.1</b> Visualizing Mixture Distributions: Reaction Time Example</a></li>
<li class="chapter" data-level="9.2" data-path="mixture-models.html"><a href="mixture-models.html#theoretical-foundation-for-mixture-models"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation for Mixture Models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mixture-models.html"><a href="mixture-models.html#the-mixture-model-framework"><i class="fa fa-check"></i><b>9.2.1</b> The Mixture Model Framework</a></li>
<li class="chapter" data-level="9.2.2" data-path="mixture-models.html"><a href="mixture-models.html#mixture-models-and-latent-variables"><i class="fa fa-check"></i><b>9.2.2</b> Mixture Models and Latent Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-in-cognitive-modeling"><i class="fa fa-check"></i><b>9.2.3</b> Applications in Cognitive Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mixture-models.html"><a href="mixture-models.html#implementing-a-basic-mixture-model"><i class="fa fa-check"></i><b>9.3</b> Implementing a Basic Mixture Model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixture-models.html"><a href="mixture-models.html#simulating-mixed-strategy-data"><i class="fa fa-check"></i><b>9.3.1</b> Simulating Mixed Strategy Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation-of-a-mixture-model"><i class="fa fa-check"></i><b>9.3.2</b> Stan Implementation of a Mixture Model</a></li>
<li class="chapter" data-level="9.3.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-mixture-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting and Evaluating the Mixture Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="mixture-models.html"><a href="mixture-models.html#model-diagnostics"><i class="fa fa-check"></i><b>9.3.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="9.3.5" data-path="mixture-models.html"><a href="mixture-models.html#parameter-recovery-analysis"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="9.3.6" data-path="mixture-models.html"><a href="mixture-models.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>9.3.6</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixture-models.html"><a href="mixture-models.html#parameter-interpretation"><i class="fa fa-check"></i><b>9.4</b> Parameter Interpretation</a></li>
<li class="chapter" data-level="9.5" data-path="mixture-models.html"><a href="mixture-models.html#multilevel-mixture-models"><i class="fa fa-check"></i><b>9.5</b> Multilevel Mixture Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation"><i class="fa fa-check"></i><b>9.5.1</b> Stan Implementation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mixture-models.html"><a href="mixture-models.html#preparing-data-for-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.2</b> Preparing Data for the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.3</b> Fitting and Evaluating the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.4" data-path="mixture-models.html"><a href="mixture-models.html#examining-individual-differences"><i class="fa fa-check"></i><b>9.5.4</b> Examining Individual Differences</a></li>
<li class="chapter" data-level="9.5.5" data-path="mixture-models.html"><a href="mixture-models.html#interpreting-parameter-correlations"><i class="fa fa-check"></i><b>9.5.5</b> Interpreting Parameter Correlations</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mixture-models.html"><a href="mixture-models.html#comparing-single-process-and-mixture-models"><i class="fa fa-check"></i><b>9.6</b> Comparing Single-Process and Mixture Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mixture-models.html"><a href="mixture-models.html#single-process-model"><i class="fa fa-check"></i><b>9.6.1</b> Single-Process Model</a></li>
<li class="chapter" data-level="9.6.2" data-path="mixture-models.html"><a href="mixture-models.html#model-comparison"><i class="fa fa-check"></i><b>9.6.2</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-of-mixture-models-in-cognitive-science"><i class="fa fa-check"></i><b>9.6.3</b> Applications of Mixture Models in Cognitive Science</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mixture-models.html"><a href="mixture-models.html#conclusion-2"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html"><i class="fa fa-check"></i><b>10</b> Win-Stay-Lose-Shift: A Heuristic Decision Strategy</a>
<ul>
<li class="chapter" data-level="10.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#loading-required-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading Required Packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#generating-data-simulating-wsls-agents"><i class="fa fa-check"></i><b>10.2</b> Generating Data: Simulating WSLS Agents</a></li>
<li class="chapter" data-level="10.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#data-processing-and-initial-visualization"><i class="fa fa-check"></i><b>10.3</b> Data Processing and Initial Visualization</a></li>
<li class="chapter" data-level="10.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#verifying-model-properties-and-assumptions"><i class="fa fa-check"></i><b>10.4</b> Verifying Model Properties and Assumptions</a></li>
<li class="chapter" data-level="10.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#modeling-a-single-wsls-agent"><i class="fa fa-check"></i><b>10.5</b> Modeling a Single WSLS Agent</a></li>
<li class="chapter" data-level="10.6" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#multilevel-wsls-model"><i class="fa fa-check"></i><b>10.6</b> Multilevel WSLS Model</a></li>
<li class="chapter" data-level="10.7" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#quality-checks-and-parameter-recovery"><i class="fa fa-check"></i><b>10.7</b> Quality Checks and Parameter Recovery</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#convergence-diagnostics"><i class="fa fa-check"></i><b>10.7.1</b> Convergence Diagnostics</a></li>
<li class="chapter" data-level="10.7.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#prior-posterior-update-visualization"><i class="fa fa-check"></i><b>10.7.2</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="10.7.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#individual-level-parameter-recovery"><i class="fa fa-check"></i><b>10.7.3</b> Individual-Level Parameter Recovery</a></li>
<li class="chapter" data-level="10.7.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#posterior-predictive-checks-2"><i class="fa fa-check"></i><b>10.7.4</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="10.7.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#model-comparison-with-loo-cv"><i class="fa fa-check"></i><b>10.7.5</b> Model Comparison with LOO-CV</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>11</b> Bayesian Models of Cognition</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#introduction-4"><i class="fa fa-check"></i><b>11.0.1</b> Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#learning-objectives-4"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#chapter-roadmap-1"><i class="fa fa-check"></i><b>11.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition"><i class="fa fa-check"></i><b>11.3</b> The Bayesian Framework for Cognition</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating"><i class="fa fa-check"></i><b>11.4</b> Visualizing Bayesian Updating</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science"><i class="fa fa-check"></i><b>11.5</b> Bayesian Models in Cognitive Science</a></li>
<li class="chapter" data-level="11.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making"><i class="fa fa-check"></i><b>11.6</b> Example: Social Influence in Perceptual Decision-Making</a></li>
<li class="chapter" data-level="11.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task"><i class="fa fa-check"></i><b>11.7</b> A Bayesian Integration Model for the Marble Task</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions"><i class="fa fa-check"></i><b>11.7.1</b> Intuitive Explanation Using Beta Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model"><i class="fa fa-check"></i><b>11.8</b> The Mathematical Model</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evidence-representation"><i class="fa fa-check"></i><b>11.8.1</b> Evidence Representation</a></li>
<li class="chapter" data-level="11.8.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration"><i class="fa fa-check"></i><b>11.8.2</b> Integration</a></li>
<li class="chapter" data-level="11.8.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#decision"><i class="fa fa-check"></i><b>11.8.3</b> Decision</a></li>
<li class="chapter" data-level="11.8.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation-in-r"><i class="fa fa-check"></i><b>11.8.4</b> Implementation in R</a></li>
<li class="chapter" data-level="11.8.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios"><i class="fa fa-check"></i><b>11.8.5</b> Simulating Experimental Scenarios</a></li>
<li class="chapter" data-level="11.8.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration"><i class="fa fa-check"></i><b>11.8.6</b> Visualizing Bayesian Integration</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios"><i class="fa fa-check"></i><b>11.9</b> Examining Belief Distributions for Selected Scenarios</a></li>
<li class="chapter" data-level="11.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10</b> Weighted Bayesian Integration</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model-1"><i class="fa fa-check"></i><b>11.10.1</b> The Mathematical Model</a></li>
<li class="chapter" data-level="11.10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation"><i class="fa fa-check"></i><b>11.10.2</b> Implementation</a></li>
<li class="chapter" data-level="11.10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10.3</b> Visualizing Weighted Bayesian Integration</a></li>
<li class="chapter" data-level="11.10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence"><i class="fa fa-check"></i><b>11.10.4</b> Resolving Conflicting Evidence</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#common-misinterpretations"><i class="fa fa-check"></i><b>11.11</b> Common Misinterpretations</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weight-interpretation"><i class="fa fa-check"></i><b>11.11.1</b> Weight Interpretation</a></li>
<li class="chapter" data-level="11.11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration-vs.-averaging"><i class="fa fa-check"></i><b>11.11.2</b> Integration vs. Averaging</a></li>
<li class="chapter" data-level="11.11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#interpreting-confidence"><i class="fa fa-check"></i><b>11.11.3</b> Interpreting Confidence</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies"><i class="fa fa-check"></i><b>11.12</b> Simulating Agents with Different Evidence Weighting Strategies</a></li>
<li class="chapter" data-level="11.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation"><i class="fa fa-check"></i><b>11.13</b> Key Observations from the Simulation</a></li>
<li class="chapter" data-level="11.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-quality-checks"><i class="fa fa-check"></i><b>11.14</b> Model Quality Checks</a>
<ul>
<li class="chapter" data-level="11.14.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#overview"><i class="fa fa-check"></i><b>11.14.1</b> Overview</a></li>
<li class="chapter" data-level="11.14.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks"><i class="fa fa-check"></i><b>11.14.2</b> Prior and Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="11.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization-1"><i class="fa fa-check"></i><b>11.15</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="11.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-2"><i class="fa fa-check"></i><b>11.16</b> Parameter recovery</a></li>
<li class="chapter" data-level="11.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-1"><i class="fa fa-check"></i><b>11.17</b> Model comparison</a></li>
<li class="chapter" data-level="11.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#leave-one-out-cross-validation-and-model-comparison"><i class="fa fa-check"></i><b>11.18</b> Leave-One-Out Cross-Validation and Model Comparison</a>
<ul>
<li class="chapter" data-level="11.18.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-loo-cross-validation-in-bayesian-framework"><i class="fa fa-check"></i><b>11.18.1</b> Understanding LOO Cross-Validation in Bayesian Framework</a></li>
<li class="chapter" data-level="11.18.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#step-by-step-implementation-of-loo-cv"><i class="fa fa-check"></i><b>11.18.2</b> Step-by-Step Implementation of LOO-CV</a></li>
<li class="chapter" data-level="11.18.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-psis-loo-diagnostics"><i class="fa fa-check"></i><b>11.18.3</b> Understanding PSIS-LOO Diagnostics</a></li>
<li class="chapter" data-level="11.18.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-for-each-scenario"><i class="fa fa-check"></i><b>11.18.4</b> Model Comparison for Each Scenario</a></li>
<li class="chapter" data-level="11.18.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-the-comparison-results"><i class="fa fa-check"></i><b>11.18.5</b> Visualizing the Comparison Results</a></li>
<li class="chapter" data-level="11.18.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-results"><i class="fa fa-check"></i><b>11.18.6</b> Understanding the Results</a></li>
<li class="chapter" data-level="11.18.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematics-behind-loo-cv"><i class="fa fa-check"></i><b>11.18.7</b> The Mathematics Behind LOO-CV</a></li>
<li class="chapter" data-level="11.18.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-pointwise-contributions-to-loo"><i class="fa fa-check"></i><b>11.18.8</b> Examining Pointwise Contributions to LOO</a></li>
</ul></li>
<li class="chapter" data-level="11.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models"><i class="fa fa-check"></i><b>11.19</b> Multilevel Bayesian Models</a>
<ul>
<li class="chapter" data-level="11.19.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents"><i class="fa fa-check"></i><b>11.19.1</b> Simulating Data from Multiple Agents</a></li>
<li class="chapter" data-level="11.19.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-simulated-data"><i class="fa fa-check"></i><b>11.19.2</b> Understanding the Simulated Data</a></li>
</ul></li>
<li class="chapter" data-level="11.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models-for-evidence-integration"><i class="fa fa-check"></i><b>11.20</b> Multilevel Bayesian Models for Evidence Integration</a>
<ul>
<li class="chapter" data-level="11.20.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-1-simple-evidence-integration-with-individual-scaling"><i class="fa fa-check"></i><b>11.20.1</b> Model 1: Simple Evidence Integration with Individual Scaling</a></li>
<li class="chapter" data-level="11.20.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-2-weighted-evidence-integration"><i class="fa fa-check"></i><b>11.20.2</b> Model 2: Weighted Evidence Integration</a></li>
<li class="chapter" data-level="11.20.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-allow-scaling-to-vary-in-the-simple-model"><i class="fa fa-check"></i><b>11.20.3</b> Why Allow Scaling to Vary in the Simple Model?</a></li>
</ul></li>
<li class="chapter" data-level="11.21" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#from-single-agent-to-multilevel-extending-bayesian-cognitive-models"><i class="fa fa-check"></i><b>11.21</b> From Single-Agent to Multilevel: Extending Bayesian Cognitive Models</a>
<ul>
<li class="chapter" data-level="11.21.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-components-of-the-multilevel-extension"><i class="fa fa-check"></i><b>11.21.1</b> Key Components of the Multilevel Extension</a></li>
<li class="chapter" data-level="11.21.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#hierarchical-prior-structure"><i class="fa fa-check"></i><b>11.21.2</b> 2. Hierarchical Prior Structure</a></li>
<li class="chapter" data-level="11.21.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#handling-data-from-multiple-individuals"><i class="fa fa-check"></i><b>11.21.3</b> 3. Handling Data from Multiple Individuals</a></li>
<li class="chapter" data-level="11.21.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#likelihood-specification"><i class="fa fa-check"></i><b>11.21.4</b> 4. Likelihood Specification</a></li>
<li class="chapter" data-level="11.21.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-these-changes-matter"><i class="fa fa-check"></i><b>11.21.5</b> Why These Changes Matter</a></li>
<li class="chapter" data-level="11.21.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>11.21.6</b> Implementing the Multilevel Weighted Beta-Binomial Model in Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.22" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-multilevel-models"><i class="fa fa-check"></i><b>11.22</b> Fitting the Multilevel Models</a>
<ul>
<li class="chapter" data-level="11.22.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1"><i class="fa fa-check"></i><b>11.22.1</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="11.22.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-2"><i class="fa fa-check"></i><b>11.22.2</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11.23" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#dynamic-bayesian-evidence-integration-sequential-updating-models"><i class="fa fa-check"></i><b>11.23</b> Dynamic Bayesian Evidence Integration: Sequential Updating Models</a>
<ul>
<li class="chapter" data-level="11.23.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-updating-the-theoretical-framework"><i class="fa fa-check"></i><b>11.23.1</b> Sequential Bayesian Updating: The Theoretical Framework</a></li>
<li class="chapter" data-level="11.23.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#single-agent-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.2</b> Single-Agent Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.3</b> Multilevel Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#generating-data-for-the-sequential-model"><i class="fa fa-check"></i><b>11.23.4</b> Generating Data for the Sequential Model</a></li>
<li class="chapter" data-level="11.23.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-and-evaluating-the-sequential-models"><i class="fa fa-check"></i><b>11.23.5</b> Fitting and Evaluating the Sequential Models</a></li>
</ul></li>
<li class="chapter" data-level="11.24" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-evidence-integration-models"><i class="fa fa-check"></i><b>11.24</b> Sequential Bayesian Evidence Integration Models</a>
<ul>
<li class="chapter" data-level="11.24.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-belief-updating-over-time"><i class="fa fa-check"></i><b>11.24.1</b> Understanding Belief Updating Over Time</a></li>
<li class="chapter" data-level="11.24.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-sequential-updating-framework"><i class="fa fa-check"></i><b>11.24.2</b> The Sequential Updating Framework</a></li>
<li class="chapter" data-level="11.24.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#mathematical-formulation"><i class="fa fa-check"></i><b>11.24.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="11.24.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#moving-from-single-agent-to-multilevel"><i class="fa fa-check"></i><b>11.24.4</b> Moving from Single-Agent to Multilevel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html"><i class="fa fa-check"></i><b>12</b> Introduction to Categorization Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-fundamental-problem-of-categorization"><i class="fa fa-check"></i><b>12.1</b> The Fundamental Problem of Categorization</a></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#why-model-categorization"><i class="fa fa-check"></i><b>12.2</b> Why Model Categorization?</a></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#historical-development-of-categorization-models"><i class="fa fa-check"></i><b>12.3</b> Historical Development of Categorization Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#early-views-the-classical-approach"><i class="fa fa-check"></i><b>12.3.1</b> Early Views: The Classical Approach</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-prototype-revolution"><i class="fa fa-check"></i><b>12.3.2</b> The Prototype Revolution</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-exemplar-alternative"><i class="fa fa-check"></i><b>12.3.3</b> The Exemplar Alternative</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models"><i class="fa fa-check"></i><b>12.3.4</b> Rule-Based Models</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-three-model-classes-core-assumptions-and-predictions"><i class="fa fa-check"></i><b>12.4</b> The Three Model Classes: Core Assumptions and Predictions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#exemplar-models-individual-instances-as-category-representations"><i class="fa fa-check"></i><b>12.4.1</b> Exemplar Models: Individual Instances as Category Representations</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#prototype-models-categories-as-central-tendencies"><i class="fa fa-check"></i><b>12.4.2</b> Prototype Models: Categories as Central Tendencies</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models-categories-as-decision-boundaries"><i class="fa fa-check"></i><b>12.4.3</b> Rule-Based Models: Categories as Decision Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#our-implementation-approach"><i class="fa fa-check"></i><b>12.5</b> Our Implementation Approach</a></li>
<li class="chapter" data-level="12.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.6</b> The Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-foundations-and-cognitive-principles"><i class="fa fa-check"></i><b>12.6.1</b> Mathematical Foundations and Cognitive Principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#core-assumptions-of-the-gcm"><i class="fa fa-check"></i><b>12.6.2</b> Core Assumptions of the GCM</a></li>
<li class="chapter" data-level="12.6.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-1"><i class="fa fa-check"></i><b>12.6.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="12.6.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-gcm-agent-implementation"><i class="fa fa-check"></i><b>12.6.4</b> The GCM Agent Implementation</a></li>
<li class="chapter" data-level="12.6.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-behavior-with-the-gcm"><i class="fa fa-check"></i><b>12.6.5</b> Simulating Behavior with the GCM</a></li>
<li class="chapter" data-level="12.6.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-gcm-in-stan-for-parameter-estimation"><i class="fa fa-check"></i><b>12.6.6</b> Implementing the GCM in Stan for Parameter Estimation</a></li>
<li class="chapter" data-level="12.6.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#key-parameters-and-their-cognitive-interpretations"><i class="fa fa-check"></i><b>12.6.7</b> Key Parameters and Their Cognitive Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#multilevel-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.7</b> Multilevel Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-need-for-a-multilevel-approach"><i class="fa fa-check"></i><b>12.7.1</b> The Need for a Multilevel Approach</a></li>
<li class="chapter" data-level="12.7.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-of-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.2</b> Mathematical Formulation of the Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-data-for-a-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.3</b> Simulating Data for a Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-multilevel-gcm-in-stan"><i class="fa fa-check"></i><b>12.7.4</b> Implementing the Multilevel GCM in Stan</a></li>
<li class="chapter" data-level="12.7.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#fitting-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.5</b> Fitting the Multilevel GCM</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#gcm-in-context-strengths-and-limitations"><i class="fa fa-check"></i><b>12.8</b> GCM in Context: Strengths and Limitations</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#strengths"><i class="fa fa-check"></i><b>12.8.1</b> Strengths</a></li>
<li class="chapter" data-level="12.8.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#limitations"><i class="fa fa-check"></i><b>12.8.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#some-notes-about-student-produced-models-of-categorization"><i class="fa fa-check"></i><b>12.9</b> Some notes about student-produced models of categorization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html"><i class="fa fa-check"></i><b>13</b> Prototype-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="13.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#rethinking-category-representation-from-examples-to-averages"><i class="fa fa-check"></i><b>13.1</b> Rethinking Category Representation: From Examples to Averages</a></li>
<li class="chapter" data-level="13.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#core-ideas-of-prototype-models"><i class="fa fa-check"></i><b>13.2</b> Core Ideas of Prototype Models:</a></li>
<li class="chapter" data-level="13.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#modeling-dynamic-prototypes-the-kalman-filter"><i class="fa fa-check"></i><b>13.3</b> Modeling Dynamic Prototypes: The Kalman Filter</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-kalman-filter-logic-updating-an-estimate"><i class="fa fa-check"></i><b>13.3.1</b> The Kalman Filter Logic: Updating an Estimate</a></li>
<li class="chapter" data-level="13.3.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#extending-to-multiple-features-multivariate-kalman-filter"><i class="fa fa-check"></i><b>13.3.2</b> Extending to Multiple Features: Multivariate Kalman Filter</a></li>
<li class="chapter" data-level="13.3.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-multivariate-update-in-r"><i class="fa fa-check"></i><b>13.3.3</b> Implementing the Multivariate Update in R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#building-the-full-categorization-model"><i class="fa fa-check"></i><b>13.4</b> Building the Full Categorization Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#initialization"><i class="fa fa-check"></i><b>13.4.1</b> Initialization</a></li>
<li class="chapter" data-level="13.4.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#categorization-decision"><i class="fa fa-check"></i><b>13.4.2</b> Categorization Decision</a></li>
<li class="chapter" data-level="13.4.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-learning-loop"><i class="fa fa-check"></i><b>13.4.3</b> The Learning Loop</a></li>
<li class="chapter" data-level="13.4.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#r-implementation-of-the-prototype-agent"><i class="fa fa-check"></i><b>13.4.4</b> R Implementation of the Prototype Agent</a></li>
<li class="chapter" data-level="13.4.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior"><i class="fa fa-check"></i><b>13.4.5</b> Simulating Categorization Behavior</a></li>
<li class="chapter" data-level="13.4.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#visualizing-prototype-evolution"><i class="fa fa-check"></i><b>13.4.6</b> Visualizing Prototype Evolution</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#estimating-parameters-implementing-the-prototype-model-in-stan"><i class="fa fa-check"></i><b>13.5</b> Estimating Parameters: Implementing the Prototype Model in Stan</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-stan-model-w12_prototype_single.stan"><i class="fa fa-check"></i><b>13.5.1</b> The Stan Model (W12_prototype_single.stan)</a></li>
<li class="chapter" data-level="13.5.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#parameter-recovery-can-we-retrieve-the-noise-parameter"><i class="fa fa-check"></i><b>13.5.2</b> Parameter Recovery: Can We Retrieve the Noise Parameter?</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#cognitive-insights-and-model-comparison"><i class="fa fa-check"></i><b>13.6</b> Cognitive Insights and Model Comparison</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#comparing-to-exemplar-models-gcm"><i class="fa fa-check"></i><b>13.6.1</b> Comparing to Exemplar Models (GCM):</a></li>
<li class="chapter" data-level="13.6.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#limitations-1"><i class="fa fa-check"></i><b>13.6.2</b> Limitations:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html"><i class="fa fa-check"></i><b>14</b> Rule-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#theoretical-foundations"><i class="fa fa-check"></i><b>14.1</b> Theoretical Foundations</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#core-assumptions-of-rule-based-models"><i class="fa fa-check"></i><b>14.1.1</b> Core Assumptions of Rule-Based Models</a></li>
<li class="chapter" data-level="14.1.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#rules-vs.-similarity-based-approaches"><i class="fa fa-check"></i><b>14.1.2</b> Rules vs. Similarity-Based Approaches</a></li>
<li class="chapter" data-level="14.1.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#representing-and-evaluating-rules"><i class="fa fa-check"></i><b>14.1.3</b> Representing and Evaluating Rules</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#the-challenge-searching-the-space-of-rules"><i class="fa fa-check"></i><b>14.2</b> The Challenge: Searching the Space of Rules</a></li>
<li class="chapter" data-level="14.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#the-bayesian-particle-filter-tracking-rule-hypotheses"><i class="fa fa-check"></i><b>14.3</b> The Bayesian Particle Filter: Tracking Rule Hypotheses</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-1-generating-initial-rule-particles"><i class="fa fa-check"></i><b>14.3.1</b> Step 1: Generating Initial Rule Particles</a></li>
<li class="chapter" data-level="14.3.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-2-updating-particle-weights"><i class="fa fa-check"></i><b>14.3.2</b> Step 2: Updating Particle Weights</a></li>
<li class="chapter" data-level="14.3.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-3-resampling-particles"><i class="fa fa-check"></i><b>14.3.3</b> Step 3: Resampling Particles</a></li>
<li class="chapter" data-level="14.3.4" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#putting-it-together-the-particle-filter-agent"><i class="fa fa-check"></i><b>14.3.4</b> Putting it Together: The Particle Filter Agent</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#simulating-categorization-behavior-1"><i class="fa fa-check"></i><b>14.4</b> Simulating Categorization Behavior</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#visualizing-rule-learning-over-time"><i class="fa fa-check"></i><b>14.4.1</b> Visualizing Rule Learning Over Time</a></li>
<li class="chapter" data-level="14.4.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#visualizing-the-decision-boundary"><i class="fa fa-check"></i><b>14.4.2</b> Visualizing the Decision Boundary</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#implementing-rule-based-logic-in-stan-simplified"><i class="fa fa-check"></i><b>14.5</b> Implementing Rule-Based Logic in Stan (Simplified)</a></li>
<li class="chapter" data-level="14.6" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#cognitive-insights-from-rule-based-models"><i class="fa fa-check"></i><b>14.6</b> Cognitive Insights from Rule-Based Models</a></li>
<li class="chapter" data-level="14.7" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#strengths-and-limitations"><i class="fa fa-check"></i><b>14.7</b> Strengths and Limitations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Chapter 13: Rule-Based Models - Learning Explicit Criteria</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rule-based-models-of-categorization" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Rule-Based Models of Categorization<a href="rule-based-models-of-categorization.html#rule-based-models-of-categorization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="theoretical-foundations" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Theoretical Foundations<a href="rule-based-models-of-categorization.html#theoretical-foundations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous chapters, we explored models based on similarity. Exemplar models compute similarity to stored instances, while prototype models compute similarity to category averages. However, humans sometimes categorize using explicit criteria or rules. Think about definitions like “a square is a shape with four equal sides and four right angles” or simple diagnostic rules like “if the animal has feathers, it’s a bird.”</p>
<p>Rule-based models propose that categorization often involves learning and applying such explicit rules that define category membership by partitioning the feature space.</p>
<div id="core-assumptions-of-rule-based-models" class="section level3 hasAnchor" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Core Assumptions of Rule-Based Models<a href="rule-based-models-of-categorization.html#core-assumptions-of-rule-based-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p><strong>Explicit Rules</strong>: Categories are represented by rules specifying conditions for membership (e.g., “Height &gt; 2.5 AND Position &lt; 3.0”).</p></li>
<li><p><strong>Rule Testing</strong>: Learning involves generating, testing, weighting and refining candidate rules based on feedback.</p></li>
<li><p><strong>Selective Attention</strong>: Rules typically focus attention on specific, relevant features mentioned in the rule, ignoring irrelevant ones.</p></li>
<li><p><strong>Deterministic Boundaries</strong>: Simple rules often create sharp, axis-aligned boundaries in the feature space.</p></li>
<li><p><strong>Verbal Representation</strong>: Rules are often easily verbalizable (e.g., “If height &gt; 2.5, then Category A”), and might actually become easier to learn and represent through verbalization.</p></li>
</ol>
</div>
<div id="rules-vs.-similarity-based-approaches" class="section level3 hasAnchor" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> Rules vs. Similarity-Based Approaches<a href="rule-based-models-of-categorization.html#rules-vs.-similarity-based-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distinction between rule-based and similarity-based approaches lies not just in the computational details, but in fundamental assumptions about how the mind represents categories:</p>
<table>
<colgroup>
<col width="16%" />
<col width="36%" />
<col width="48%" />
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Rule-Based Models</th>
<th>Similarity-Based Models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Representation</strong></td>
<td>Explicit decision criteria</td>
<td>Stored examples or prototypes</td>
</tr>
<tr class="even">
<td><strong>Decision Process</strong></td>
<td>Rule application</td>
<td>Similarity computation</td>
</tr>
<tr class="odd">
<td><strong>Feature Use</strong></td>
<td>Selective (focus on rule-relevant features)</td>
<td>Holistic (all features might contribute, tho’ attention might say otherwise)</td>
</tr>
<tr class="even">
<td><strong>Category Boundaries</strong></td>
<td>Sharp and often axis-aligned</td>
<td>Fuzzy and sensitive to overall similarity</td>
</tr>
<tr class="odd">
<td><strong>Individual Differences</strong></td>
<td>Different rules</td>
<td>Different attention weights</td>
</tr>
<tr class="even">
<td><strong>Generalization Pattern</strong></td>
<td>Rectangle-like regions</td>
<td>Similarity-gradient regions</td>
</tr>
</tbody>
</table>
</div>
<div id="representing-and-evaluating-rules" class="section level3 hasAnchor" number="14.1.3">
<h3><span class="header-section-number">14.1.3</span> Representing and Evaluating Rules<a href="rule-based-models-of-categorization.html#representing-and-evaluating-rules" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How can we represent a rule computationally? For our 2D stimuli (height, position), a simple rule might involve one or both dimensions and a threshold.</p>
<p>Example Rule: “If Height &gt; 3.5, then predict Category 1, otherwise Category 0.”</p>
<p>We can represent this rule in R using a list:</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="rule-based-models-of-categorization.html#cb649-1" tabindex="-1"></a><span class="co"># Example representation of a simple 1D rule</span></span>
<span id="cb649-2"><a href="rule-based-models-of-categorization.html#cb649-2" tabindex="-1"></a>rule_example_1d <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb649-3"><a href="rule-based-models-of-categorization.html#cb649-3" tabindex="-1"></a>  <span class="at">dimensions =</span> <span class="dv">1</span>,         <span class="co"># Uses the 1st feature (Height)</span></span>
<span id="cb649-4"><a href="rule-based-models-of-categorization.html#cb649-4" tabindex="-1"></a>  <span class="at">thresholds =</span> <span class="fl">3.5</span>,       <span class="co"># The threshold value</span></span>
<span id="cb649-5"><a href="rule-based-models-of-categorization.html#cb649-5" tabindex="-1"></a>  <span class="at">operations =</span> <span class="st">&quot;&gt;&quot;</span>,       <span class="co"># The comparison operation</span></span>
<span id="cb649-6"><a href="rule-based-models-of-categorization.html#cb649-6" tabindex="-1"></a>  <span class="at">prediction_if_true =</span> <span class="dv">1</span>  <span class="co"># Predict Category 1 if condition is TRUE</span></span>
<span id="cb649-7"><a href="rule-based-models-of-categorization.html#cb649-7" tabindex="-1"></a>)</span>
<span id="cb649-8"><a href="rule-based-models-of-categorization.html#cb649-8" tabindex="-1"></a></span>
<span id="cb649-9"><a href="rule-based-models-of-categorization.html#cb649-9" tabindex="-1"></a><span class="co"># Example representation of a 2D rule (Height &gt; 2 AND Position &lt; 3 =&gt; Cat 0)</span></span>
<span id="cb649-10"><a href="rule-based-models-of-categorization.html#cb649-10" tabindex="-1"></a>rule_example_2d <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb649-11"><a href="rule-based-models-of-categorization.html#cb649-11" tabindex="-1"></a>  <span class="at">dimensions =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),    <span class="co"># Uses Height (1) and Position (2)</span></span>
<span id="cb649-12"><a href="rule-based-models-of-categorization.html#cb649-12" tabindex="-1"></a>  <span class="at">thresholds =</span> <span class="fu">c</span>(<span class="fl">2.0</span>, <span class="fl">3.0</span>),<span class="co"># Thresholds for Height, then Position</span></span>
<span id="cb649-13"><a href="rule-based-models-of-categorization.html#cb649-13" tabindex="-1"></a>  <span class="at">operations =</span> <span class="fu">c</span>(<span class="st">&quot;&gt;&quot;</span>, <span class="st">&quot;&lt;&quot;</span>),<span class="co"># Operations for Height, then Position</span></span>
<span id="cb649-14"><a href="rule-based-models-of-categorization.html#cb649-14" tabindex="-1"></a>  <span class="at">logic =</span> <span class="st">&quot;AND&quot;</span>,           <span class="co"># How conditions are combined (AND/OR)</span></span>
<span id="cb649-15"><a href="rule-based-models-of-categorization.html#cb649-15" tabindex="-1"></a>  <span class="at">prediction_if_true =</span> <span class="dv">0</span>   <span class="co"># Predict Category 0 if combined condition is TRUE</span></span>
<span id="cb649-16"><a href="rule-based-models-of-categorization.html#cb649-16" tabindex="-1"></a>)</span></code></pre></div>
<p>Now, we need a function to see if a given stimulus satisfies a rule and what category the rule predicts.</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="rule-based-models-of-categorization.html#cb650-1" tabindex="-1"></a><span class="co"># Function to evaluate a rule for a given stimulus</span></span>
<span id="cb650-2"><a href="rule-based-models-of-categorization.html#cb650-2" tabindex="-1"></a><span class="co"># Takes a rule (represented as a list) and a stimulus (numeric vector)</span></span>
<span id="cb650-3"><a href="rule-based-models-of-categorization.html#cb650-3" tabindex="-1"></a><span class="co"># Returns the category prediction (0 or 1) made by the rule for that stimulus.</span></span>
<span id="cb650-4"><a href="rule-based-models-of-categorization.html#cb650-4" tabindex="-1"></a>evaluate_rule <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, stimulus) {</span>
<span id="cb650-5"><a href="rule-based-models-of-categorization.html#cb650-5" tabindex="-1"></a>  </span>
<span id="cb650-6"><a href="rule-based-models-of-categorization.html#cb650-6" tabindex="-1"></a>  <span class="co"># Handle single-dimension rules</span></span>
<span id="cb650-7"><a href="rule-based-models-of-categorization.html#cb650-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(rule<span class="sc">$</span>dimensions) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb650-8"><a href="rule-based-models-of-categorization.html#cb650-8" tabindex="-1"></a>    dim_idx <span class="ot">&lt;-</span> rule<span class="sc">$</span>dimensions[<span class="dv">1</span>]</span>
<span id="cb650-9"><a href="rule-based-models-of-categorization.html#cb650-9" tabindex="-1"></a>    threshold <span class="ot">&lt;-</span> rule<span class="sc">$</span>thresholds[<span class="dv">1</span>]</span>
<span id="cb650-10"><a href="rule-based-models-of-categorization.html#cb650-10" tabindex="-1"></a>    operation <span class="ot">&lt;-</span> rule<span class="sc">$</span>operations[<span class="dv">1</span>]</span>
<span id="cb650-11"><a href="rule-based-models-of-categorization.html#cb650-11" tabindex="-1"></a>    </span>
<span id="cb650-12"><a href="rule-based-models-of-categorization.html#cb650-12" tabindex="-1"></a>    <span class="co"># Check if the stimulus meets the condition</span></span>
<span id="cb650-13"><a href="rule-based-models-of-categorization.html#cb650-13" tabindex="-1"></a>    condition_met <span class="ot">&lt;-</span> <span class="cf">switch</span>(operation,</span>
<span id="cb650-14"><a href="rule-based-models-of-categorization.html#cb650-14" tabindex="-1"></a>                           <span class="st">&quot;&gt;&quot;</span> <span class="ot">=</span> stimulus[dim_idx] <span class="sc">&gt;</span> threshold,</span>
<span id="cb650-15"><a href="rule-based-models-of-categorization.html#cb650-15" tabindex="-1"></a>                           <span class="st">&quot;&lt;&quot;</span> <span class="ot">=</span> stimulus[dim_idx] <span class="sc">&lt;</span> threshold,</span>
<span id="cb650-16"><a href="rule-based-models-of-categorization.html#cb650-16" tabindex="-1"></a>                           <span class="fu">stop</span>(<span class="st">&quot;Invalid operation in rule&quot;</span>) <span class="co"># Error handling</span></span>
<span id="cb650-17"><a href="rule-based-models-of-categorization.html#cb650-17" tabindex="-1"></a>                           )</span>
<span id="cb650-18"><a href="rule-based-models-of-categorization.html#cb650-18" tabindex="-1"></a>    </span>
<span id="cb650-19"><a href="rule-based-models-of-categorization.html#cb650-19" tabindex="-1"></a>  <span class="co"># Handle two-dimension rules (extendable to more)</span></span>
<span id="cb650-20"><a href="rule-based-models-of-categorization.html#cb650-20" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">length</span>(rule<span class="sc">$</span>dimensions) <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb650-21"><a href="rule-based-models-of-categorization.html#cb650-21" tabindex="-1"></a>    <span class="co"># Evaluate condition for the first dimension</span></span>
<span id="cb650-22"><a href="rule-based-models-of-categorization.html#cb650-22" tabindex="-1"></a>    dim1_idx <span class="ot">&lt;-</span> rule<span class="sc">$</span>dimensions[<span class="dv">1</span>]</span>
<span id="cb650-23"><a href="rule-based-models-of-categorization.html#cb650-23" tabindex="-1"></a>    thresh1 <span class="ot">&lt;-</span> rule<span class="sc">$</span>thresholds[<span class="dv">1</span>]</span>
<span id="cb650-24"><a href="rule-based-models-of-categorization.html#cb650-24" tabindex="-1"></a>    op1 <span class="ot">&lt;-</span> rule<span class="sc">$</span>operations[<span class="dv">1</span>]</span>
<span id="cb650-25"><a href="rule-based-models-of-categorization.html#cb650-25" tabindex="-1"></a>    cond1_met <span class="ot">&lt;-</span> <span class="cf">switch</span>(op1, <span class="st">&quot;&gt;&quot;</span> <span class="ot">=</span> stimulus[dim1_idx] <span class="sc">&gt;</span> thresh1, <span class="st">&quot;&lt;&quot;</span> <span class="ot">=</span> stimulus[dim1_idx] <span class="sc">&lt;</span> thresh1)</span>
<span id="cb650-26"><a href="rule-based-models-of-categorization.html#cb650-26" tabindex="-1"></a>    </span>
<span id="cb650-27"><a href="rule-based-models-of-categorization.html#cb650-27" tabindex="-1"></a>    <span class="co"># Evaluate condition for the second dimension</span></span>
<span id="cb650-28"><a href="rule-based-models-of-categorization.html#cb650-28" tabindex="-1"></a>    dim2_idx <span class="ot">&lt;-</span> rule<span class="sc">$</span>dimensions[<span class="dv">2</span>]</span>
<span id="cb650-29"><a href="rule-based-models-of-categorization.html#cb650-29" tabindex="-1"></a>    thresh2 <span class="ot">&lt;-</span> rule<span class="sc">$</span>thresholds[<span class="dv">2</span>]</span>
<span id="cb650-30"><a href="rule-based-models-of-categorization.html#cb650-30" tabindex="-1"></a>    op2 <span class="ot">&lt;-</span> rule<span class="sc">$</span>operations[<span class="dv">2</span>]</span>
<span id="cb650-31"><a href="rule-based-models-of-categorization.html#cb650-31" tabindex="-1"></a>    cond2_met <span class="ot">&lt;-</span> <span class="cf">switch</span>(op2, <span class="st">&quot;&gt;&quot;</span> <span class="ot">=</span> stimulus[dim2_idx] <span class="sc">&gt;</span> thresh2, <span class="st">&quot;&lt;&quot;</span> <span class="ot">=</span> stimulus[dim2_idx] <span class="sc">&lt;</span> thresh2)</span>
<span id="cb650-32"><a href="rule-based-models-of-categorization.html#cb650-32" tabindex="-1"></a>    </span>
<span id="cb650-33"><a href="rule-based-models-of-categorization.html#cb650-33" tabindex="-1"></a>    <span class="co"># Combine conditions using the specified logic (AND/OR)</span></span>
<span id="cb650-34"><a href="rule-based-models-of-categorization.html#cb650-34" tabindex="-1"></a>    <span class="cf">if</span> (rule<span class="sc">$</span>logic <span class="sc">==</span> <span class="st">&quot;AND&quot;</span>) {</span>
<span id="cb650-35"><a href="rule-based-models-of-categorization.html#cb650-35" tabindex="-1"></a>      condition_met <span class="ot">&lt;-</span> cond1_met <span class="sc">&amp;</span> cond2_met</span>
<span id="cb650-36"><a href="rule-based-models-of-categorization.html#cb650-36" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (rule<span class="sc">$</span>logic <span class="sc">==</span> <span class="st">&quot;OR&quot;</span>) {</span>
<span id="cb650-37"><a href="rule-based-models-of-categorization.html#cb650-37" tabindex="-1"></a>      condition_met <span class="ot">&lt;-</span> cond1_met <span class="sc">|</span> cond2_met</span>
<span id="cb650-38"><a href="rule-based-models-of-categorization.html#cb650-38" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb650-39"><a href="rule-based-models-of-categorization.html#cb650-39" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;Invalid logic in 2D rule&quot;</span>) <span class="co"># Error handling</span></span>
<span id="cb650-40"><a href="rule-based-models-of-categorization.html#cb650-40" tabindex="-1"></a>    }</span>
<span id="cb650-41"><a href="rule-based-models-of-categorization.html#cb650-41" tabindex="-1"></a>    </span>
<span id="cb650-42"><a href="rule-based-models-of-categorization.html#cb650-42" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb650-43"><a href="rule-based-models-of-categorization.html#cb650-43" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Rule dimension count not supported (only 1 or 2)&quot;</span>) <span class="co"># Error handling</span></span>
<span id="cb650-44"><a href="rule-based-models-of-categorization.html#cb650-44" tabindex="-1"></a>  }</span>
<span id="cb650-45"><a href="rule-based-models-of-categorization.html#cb650-45" tabindex="-1"></a>  </span>
<span id="cb650-46"><a href="rule-based-models-of-categorization.html#cb650-46" tabindex="-1"></a>  <span class="co"># Return the rule&#39;s prediction based on whether the condition was met</span></span>
<span id="cb650-47"><a href="rule-based-models-of-categorization.html#cb650-47" tabindex="-1"></a>  <span class="co"># If condition is TRUE, return prediction_if_true.</span></span>
<span id="cb650-48"><a href="rule-based-models-of-categorization.html#cb650-48" tabindex="-1"></a>  <span class="co"># If condition is FALSE, return the *other* category (1 - prediction_if_true).</span></span>
<span id="cb650-49"><a href="rule-based-models-of-categorization.html#cb650-49" tabindex="-1"></a>  prediction <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(condition_met, rule<span class="sc">$</span>prediction_if_true, <span class="dv">1</span> <span class="sc">-</span> rule<span class="sc">$</span>prediction_if_true)</span>
<span id="cb650-50"><a href="rule-based-models-of-categorization.html#cb650-50" tabindex="-1"></a>  </span>
<span id="cb650-51"><a href="rule-based-models-of-categorization.html#cb650-51" tabindex="-1"></a>  <span class="fu">return</span>(prediction)</span>
<span id="cb650-52"><a href="rule-based-models-of-categorization.html#cb650-52" tabindex="-1"></a>}</span>
<span id="cb650-53"><a href="rule-based-models-of-categorization.html#cb650-53" tabindex="-1"></a></span>
<span id="cb650-54"><a href="rule-based-models-of-categorization.html#cb650-54" tabindex="-1"></a><span class="co"># --- Test the function ---</span></span>
<span id="cb650-55"><a href="rule-based-models-of-categorization.html#cb650-55" tabindex="-1"></a><span class="co"># Stimulus: Height=2.5, Position=3.8</span></span>
<span id="cb650-56"><a href="rule-based-models-of-categorization.html#cb650-56" tabindex="-1"></a>test_stimulus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.8</span>) </span>
<span id="cb650-57"><a href="rule-based-models-of-categorization.html#cb650-57" tabindex="-1"></a></span>
<span id="cb650-58"><a href="rule-based-models-of-categorization.html#cb650-58" tabindex="-1"></a><span class="co"># Rule 1: Height &gt; 3.5 =&gt; Cat 1 (Condition FALSE, predicts 0)</span></span>
<span id="cb650-59"><a href="rule-based-models-of-categorization.html#cb650-59" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="fu">evaluate_rule</span>(rule_example_1d, test_stimulus) </span>
<span id="cb650-60"><a href="rule-based-models-of-categorization.html#cb650-60" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Rule 1 Prediction:&quot;</span>, pred1, <span class="st">&quot;(Expected: 0)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Rule 1 Prediction: 0 (Expected: 0)</code></pre>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="rule-based-models-of-categorization.html#cb652-1" tabindex="-1"></a><span class="co"># Rule 2: Height &gt; 2 AND Position &lt; 3 =&gt; Cat 0 (Cond1 TRUE, Cond2 FALSE. AND -&gt; FALSE. Predicts 1)</span></span>
<span id="cb652-2"><a href="rule-based-models-of-categorization.html#cb652-2" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">evaluate_rule</span>(rule_example_2d, test_stimulus)</span>
<span id="cb652-3"><a href="rule-based-models-of-categorization.html#cb652-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Rule 2 Prediction:&quot;</span>, pred2, <span class="st">&quot;(Expected: 1)</span><span class="sc">\n</span><span class="st">&quot;</span>) </span></code></pre></div>
<pre><code>## Rule 2 Prediction: 1 (Expected: 1)</code></pre>
</div>
</div>
<div id="the-challenge-searching-the-space-of-rules" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> The Challenge: Searching the Space of Rules<a href="rule-based-models-of-categorization.html#the-challenge-searching-the-space-of-rules" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evaluating a given rule is easy. The hard part of rule-based learning is finding the right rule. The number of possible rules (combinations of dimensions, thresholds, operations, logic) is vast. How can a learner efficiently search this space?</p>
<p>Unlike exemplar and prototype models, where the representation is straightforward, rule-based models need mechanisms for:</p>
<ol style="list-style-type: decimal">
<li>Generating candidate rules</li>
<li>Testing rules against observed data</li>
<li>Switching between rules when necessary</li>
<li>Maintaining uncertainty about which rule is correct</li>
</ol>
</div>
<div id="the-bayesian-particle-filter-tracking-rule-hypotheses" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> The Bayesian Particle Filter: Tracking Rule Hypotheses<a href="rule-based-models-of-categorization.html#the-bayesian-particle-filter-tracking-rule-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Bayesian particle filter provides an elegant solution to these challenges. Originally developed for tracking physical objects, particle filters have been adapted to model how humans track and update hypotheses. In our context, each “particle” represents a possible categorization rule, and the filter maintains and updates a distribution over these rules.</p>
<p>The core idea:</p>
<ol style="list-style-type: decimal">
<li><p>Particles = Rules: Each particle is a specific candidate rule (like the list structures above).</p></li>
<li><p>Weights = Belief: Each particle has a weight (<span class="math inline">\(w_{i}\)</span>) representing the probability or belief that this specific rule is the “true” rule generating the data. Initially, all weights are equal (<span class="math inline">\(1/N\)</span>, where N is the number of particles).</p></li>
<li><p>Update Weights: When a new stimulus and its correct category are observed, we update the weights. Rules that correctly predict the category get their weights increased, while rules that predict incorrectly get their weights decreased. The amount of increase/decrease depends on how likely the observation was under that rule.</p></li>
<li><p>Resample: Over time, many particles might end up with near-zero weights (representing rules that don’t fit the data). To focus computational effort, we periodically resample the particles. We draw N new particles from the current set, with the probability of drawing each particle being proportional to its weight. This effectively eliminates low-weight rules and duplicates high-weight rules. After resampling, weights are reset to equal (<span class="math inline">\(1/N\)</span>).</p></li>
</ol>
<p>This process allows the model to maintain a distribution of belief over many rules, dynamically focusing on the most promising ones as more data arrives.</p>
<div id="step-1-generating-initial-rule-particles" class="section level3 hasAnchor" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Step 1: Generating Initial Rule Particles<a href="rule-based-models-of-categorization.html#step-1-generating-initial-rule-particles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need a way to create a diverse set of random rules to start the filter.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="rule-based-models-of-categorization.html#cb654-1" tabindex="-1"></a><span class="co"># Function to generate a single random rule</span></span>
<span id="cb654-2"><a href="rule-based-models-of-categorization.html#cb654-2" tabindex="-1"></a>generate_random_rule <span class="ot">&lt;-</span> <span class="cf">function</span>(n_features, <span class="co"># Total number of features available (e.g., 2)</span></span>
<span id="cb654-3"><a href="rule-based-models-of-categorization.html#cb654-3" tabindex="-1"></a>                                 <span class="at">max_dims =</span> <span class="dv">2</span>, <span class="co"># Max dimensions per rule (1 or 2)</span></span>
<span id="cb654-4"><a href="rule-based-models-of-categorization.html#cb654-4" tabindex="-1"></a>                                 <span class="at">feature_range =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) <span class="co"># Assumed range for thresholds</span></span>
<span id="cb654-5"><a href="rule-based-models-of-categorization.html#cb654-5" tabindex="-1"></a>                                 ) {</span>
<span id="cb654-6"><a href="rule-based-models-of-categorization.html#cb654-6" tabindex="-1"></a>  </span>
<span id="cb654-7"><a href="rule-based-models-of-categorization.html#cb654-7" tabindex="-1"></a>  <span class="co"># Randomly select how many dimensions this rule uses (1 or max_dims)</span></span>
<span id="cb654-8"><a href="rule-based-models-of-categorization.html#cb654-8" tabindex="-1"></a>  num_dims_in_rule <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>max_dims, <span class="dv">1</span>)</span>
<span id="cb654-9"><a href="rule-based-models-of-categorization.html#cb654-9" tabindex="-1"></a>  </span>
<span id="cb654-10"><a href="rule-based-models-of-categorization.html#cb654-10" tabindex="-1"></a>  <span class="co"># Randomly select which specific dimensions to use</span></span>
<span id="cb654-11"><a href="rule-based-models-of-categorization.html#cb654-11" tabindex="-1"></a>  dimensions_used <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_features, <span class="at">size =</span> num_dims_in_rule, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb654-12"><a href="rule-based-models-of-categorization.html#cb654-12" tabindex="-1"></a>  </span>
<span id="cb654-13"><a href="rule-based-models-of-categorization.html#cb654-13" tabindex="-1"></a>  <span class="co"># Generate thresholds and operations for each selected dimension</span></span>
<span id="cb654-14"><a href="rule-based-models-of-categorization.html#cb654-14" tabindex="-1"></a>  thresholds <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_dims_in_rule)</span>
<span id="cb654-15"><a href="rule-based-models-of-categorization.html#cb654-15" tabindex="-1"></a>  operations <span class="ot">&lt;-</span> <span class="fu">character</span>(num_dims_in_rule)</span>
<span id="cb654-16"><a href="rule-based-models-of-categorization.html#cb654-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_dims_in_rule) {</span>
<span id="cb654-17"><a href="rule-based-models-of-categorization.html#cb654-17" tabindex="-1"></a>    dim_idx <span class="ot">&lt;-</span> dimensions_used[i]</span>
<span id="cb654-18"><a href="rule-based-models-of-categorization.html#cb654-18" tabindex="-1"></a>    <span class="co"># Sample threshold uniformly within the feature&#39;s assumed range</span></span>
<span id="cb654-19"><a href="rule-based-models-of-categorization.html#cb654-19" tabindex="-1"></a>    thresholds[i] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> feature_range[[dim_idx]][<span class="dv">1</span>], <span class="at">max =</span> feature_range[[dim_idx]][<span class="dv">2</span>])</span>
<span id="cb654-20"><a href="rule-based-models-of-categorization.html#cb654-20" tabindex="-1"></a>    <span class="co"># Randomly choose &#39;&gt;&#39; or &#39;&lt;&#39; operation</span></span>
<span id="cb654-21"><a href="rule-based-models-of-categorization.html#cb654-21" tabindex="-1"></a>    operations[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;&gt;&quot;</span>, <span class="st">&quot;&lt;&quot;</span>), <span class="dv">1</span>)</span>
<span id="cb654-22"><a href="rule-based-models-of-categorization.html#cb654-22" tabindex="-1"></a>  }</span>
<span id="cb654-23"><a href="rule-based-models-of-categorization.html#cb654-23" tabindex="-1"></a>  </span>
<span id="cb654-24"><a href="rule-based-models-of-categorization.html#cb654-24" tabindex="-1"></a>  <span class="co"># If it&#39;s a 2D rule, randomly choose logic (AND/OR)</span></span>
<span id="cb654-25"><a href="rule-based-models-of-categorization.html#cb654-25" tabindex="-1"></a>  rule_logic <span class="ot">&lt;-</span> <span class="cf">if</span> (num_dims_in_rule <span class="sc">==</span> <span class="dv">2</span>) <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;AND&quot;</span>, <span class="st">&quot;OR&quot;</span>), <span class="dv">1</span>) <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb654-26"><a href="rule-based-models-of-categorization.html#cb654-26" tabindex="-1"></a>  </span>
<span id="cb654-27"><a href="rule-based-models-of-categorization.html#cb654-27" tabindex="-1"></a>  <span class="co"># Randomly choose which category (0 or 1) the rule predicts if the condition is TRUE</span></span>
<span id="cb654-28"><a href="rule-based-models-of-categorization.html#cb654-28" tabindex="-1"></a>  prediction_if_true <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb654-29"><a href="rule-based-models-of-categorization.html#cb654-29" tabindex="-1"></a>  </span>
<span id="cb654-30"><a href="rule-based-models-of-categorization.html#cb654-30" tabindex="-1"></a>  <span class="co"># Return the rule as a list</span></span>
<span id="cb654-31"><a href="rule-based-models-of-categorization.html#cb654-31" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb654-32"><a href="rule-based-models-of-categorization.html#cb654-32" tabindex="-1"></a>    <span class="at">dimensions =</span> dimensions_used,</span>
<span id="cb654-33"><a href="rule-based-models-of-categorization.html#cb654-33" tabindex="-1"></a>    <span class="at">thresholds =</span> thresholds,</span>
<span id="cb654-34"><a href="rule-based-models-of-categorization.html#cb654-34" tabindex="-1"></a>    <span class="at">operations =</span> operations,</span>
<span id="cb654-35"><a href="rule-based-models-of-categorization.html#cb654-35" tabindex="-1"></a>    <span class="at">logic =</span> rule_logic,</span>
<span id="cb654-36"><a href="rule-based-models-of-categorization.html#cb654-36" tabindex="-1"></a>    <span class="at">prediction_if_true =</span> prediction_if_true</span>
<span id="cb654-37"><a href="rule-based-models-of-categorization.html#cb654-37" tabindex="-1"></a>  )</span>
<span id="cb654-38"><a href="rule-based-models-of-categorization.html#cb654-38" tabindex="-1"></a>}</span>
<span id="cb654-39"><a href="rule-based-models-of-categorization.html#cb654-39" tabindex="-1"></a></span>
<span id="cb654-40"><a href="rule-based-models-of-categorization.html#cb654-40" tabindex="-1"></a><span class="co"># --- Initialize a set of particles ---</span></span>
<span id="cb654-41"><a href="rule-based-models-of-categorization.html#cb654-41" tabindex="-1"></a>initialize_particles <span class="ot">&lt;-</span> <span class="cf">function</span>(n_particles, n_features, <span class="at">max_dims =</span> <span class="dv">2</span>, <span class="at">feature_range =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>))) {</span>
<span id="cb654-42"><a href="rule-based-models-of-categorization.html#cb654-42" tabindex="-1"></a>  particles <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, n_particles) <span class="co"># Pre-allocate list</span></span>
<span id="cb654-43"><a href="rule-based-models-of-categorization.html#cb654-43" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_particles) {</span>
<span id="cb654-44"><a href="rule-based-models-of-categorization.html#cb654-44" tabindex="-1"></a>    particles[[i]] <span class="ot">&lt;-</span> <span class="fu">generate_random_rule</span>(n_features, max_dims, feature_range)</span>
<span id="cb654-45"><a href="rule-based-models-of-categorization.html#cb654-45" tabindex="-1"></a>  }</span>
<span id="cb654-46"><a href="rule-based-models-of-categorization.html#cb654-46" tabindex="-1"></a>  </span>
<span id="cb654-47"><a href="rule-based-models-of-categorization.html#cb654-47" tabindex="-1"></a>  <span class="co"># Assign equal initial weights</span></span>
<span id="cb654-48"><a href="rule-based-models-of-categorization.html#cb654-48" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_particles, n_particles)</span>
<span id="cb654-49"><a href="rule-based-models-of-categorization.html#cb654-49" tabindex="-1"></a>  </span>
<span id="cb654-50"><a href="rule-based-models-of-categorization.html#cb654-50" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">particles =</span> particles, <span class="at">weights =</span> weights))</span>
<span id="cb654-51"><a href="rule-based-models-of-categorization.html#cb654-51" tabindex="-1"></a>}</span>
<span id="cb654-52"><a href="rule-based-models-of-categorization.html#cb654-52" tabindex="-1"></a></span>
<span id="cb654-53"><a href="rule-based-models-of-categorization.html#cb654-53" tabindex="-1"></a><span class="co"># --- Example Initialization ---</span></span>
<span id="cb654-54"><a href="rule-based-models-of-categorization.html#cb654-54" tabindex="-1"></a>n_particles_example <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb654-55"><a href="rule-based-models-of-categorization.html#cb654-55" tabindex="-1"></a>n_features_example <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb654-56"><a href="rule-based-models-of-categorization.html#cb654-56" tabindex="-1"></a>initial_system <span class="ot">&lt;-</span> <span class="fu">initialize_particles</span>(n_particles_example, n_features_example)</span>
<span id="cb654-57"><a href="rule-based-models-of-categorization.html#cb654-57" tabindex="-1"></a></span>
<span id="cb654-58"><a href="rule-based-models-of-categorization.html#cb654-58" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;Initialized&quot;</span>, n_particles_example, <span class="st">&quot;particles (rules). Example rule 1:</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
<pre><code>## Initialized 5 particles (rules). Example rule 1:</code></pre>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="rule-based-models-of-categorization.html#cb656-1" tabindex="-1"></a><span class="fu">print</span>(initial_system<span class="sc">$</span>particles[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## $dimensions
## [1] 1
## 
## $thresholds
## [1] 1.109728
## 
## $operations
## [1] &quot;&lt;&quot;
## 
## $logic
## [1] NA
## 
## $prediction_if_true
## [1] 1</code></pre>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="rule-based-models-of-categorization.html#cb658-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Initial weights:&quot;</span>, initial_system<span class="sc">$</span>weights, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Initial weights: 0.2 0.2 0.2 0.2 0.2</code></pre>
</div>
<div id="step-2-updating-particle-weights" class="section level3 hasAnchor" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> Step 2: Updating Particle Weights<a href="rule-based-models-of-categorization.html#step-2-updating-particle-weights" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we observe a stimulus <span class="math inline">\(x\)</span> and its true category <span class="math inline">\(y\)</span>, we update the weight <span class="math inline">\(w_{i}\)</span> for each particle (rule i). The update is based on the likelihood of observing y given x under rule i, <span class="math inline">\(P(y∣x ,rule_{i})\)</span>.</p>
<p>Since rules are often assumed deterministic, we can introduce a small error_prob (ϵ) to allow for occasional noise or misapplication.</p>
<p>If rule i correctly predicts y (i.e., evaluate_rule(rule_i, x) == y), then <span class="math inline">\(P(y∣x ,rule_{i})=1−ϵ\)</span>.</p>
<p>If rule i incorrectly predicts y, then <span class="math inline">\(P(y∣x ,rule_{i})=ϵ\)</span>.</p>
<p>The updated weight <span class="math inline">\(w_{i}&#39;\)</span> is proportional to the old weight times this likelihood:
<span class="math inline">\(\omega_i&#39; \propto \omega_i \times P(y \mid x, \text{rule}_i)\)</span>.</p>
<p>After calculating these new unnormalized weights, we normalize them so they sum to 1 again.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="rule-based-models-of-categorization.html#cb660-1" tabindex="-1"></a><span class="co"># Function to update particle weights based on one observation (stimulus + true category)</span></span>
<span id="cb660-2"><a href="rule-based-models-of-categorization.html#cb660-2" tabindex="-1"></a>update_weights <span class="ot">&lt;-</span> <span class="cf">function</span>(particles, <span class="co"># List of current rule particles</span></span>
<span id="cb660-3"><a href="rule-based-models-of-categorization.html#cb660-3" tabindex="-1"></a>                           weights,   <span class="co"># Vector of current weights</span></span>
<span id="cb660-4"><a href="rule-based-models-of-categorization.html#cb660-4" tabindex="-1"></a>                           stimulus,  <span class="co"># Observed stimulus features</span></span>
<span id="cb660-5"><a href="rule-based-models-of-categorization.html#cb660-5" tabindex="-1"></a>                           true_category, <span class="co"># True category label (0 or 1)</span></span>
<span id="cb660-6"><a href="rule-based-models-of-categorization.html#cb660-6" tabindex="-1"></a>                           <span class="at">error_prob =</span> <span class="fl">0.05</span> <span class="co"># Probability of error/noise</span></span>
<span id="cb660-7"><a href="rule-based-models-of-categorization.html#cb660-7" tabindex="-1"></a>                           ) {</span>
<span id="cb660-8"><a href="rule-based-models-of-categorization.html#cb660-8" tabindex="-1"></a>  </span>
<span id="cb660-9"><a href="rule-based-models-of-categorization.html#cb660-9" tabindex="-1"></a>  n_particles <span class="ot">&lt;-</span> <span class="fu">length</span>(particles)</span>
<span id="cb660-10"><a href="rule-based-models-of-categorization.html#cb660-10" tabindex="-1"></a>  new_unnormalized_weights <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_particles)</span>
<span id="cb660-11"><a href="rule-based-models-of-categorization.html#cb660-11" tabindex="-1"></a>  </span>
<span id="cb660-12"><a href="rule-based-models-of-categorization.html#cb660-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_particles) {</span>
<span id="cb660-13"><a href="rule-based-models-of-categorization.html#cb660-13" tabindex="-1"></a>    <span class="co"># Get the prediction made by this particle&#39;s rule</span></span>
<span id="cb660-14"><a href="rule-based-models-of-categorization.html#cb660-14" tabindex="-1"></a>    rule_prediction <span class="ot">&lt;-</span> <span class="fu">evaluate_rule</span>(particles[[i]], stimulus)</span>
<span id="cb660-15"><a href="rule-based-models-of-categorization.html#cb660-15" tabindex="-1"></a>    </span>
<span id="cb660-16"><a href="rule-based-models-of-categorization.html#cb660-16" tabindex="-1"></a>    <span class="co"># Calculate the likelihood P(true_category | stimulus, rule_i)</span></span>
<span id="cb660-17"><a href="rule-based-models-of-categorization.html#cb660-17" tabindex="-1"></a>    <span class="cf">if</span> (rule_prediction <span class="sc">==</span> true_category) {</span>
<span id="cb660-18"><a href="rule-based-models-of-categorization.html#cb660-18" tabindex="-1"></a>      likelihood <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> error_prob</span>
<span id="cb660-19"><a href="rule-based-models-of-categorization.html#cb660-19" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb660-20"><a href="rule-based-models-of-categorization.html#cb660-20" tabindex="-1"></a>      likelihood <span class="ot">&lt;-</span> error_prob</span>
<span id="cb660-21"><a href="rule-based-models-of-categorization.html#cb660-21" tabindex="-1"></a>    }</span>
<span id="cb660-22"><a href="rule-based-models-of-categorization.html#cb660-22" tabindex="-1"></a>    </span>
<span id="cb660-23"><a href="rule-based-models-of-categorization.html#cb660-23" tabindex="-1"></a>    <span class="co"># Update weight: new_weight proportional to old_weight * likelihood</span></span>
<span id="cb660-24"><a href="rule-based-models-of-categorization.html#cb660-24" tabindex="-1"></a>    new_unnormalized_weights[i] <span class="ot">&lt;-</span> weights[i] <span class="sc">*</span> likelihood</span>
<span id="cb660-25"><a href="rule-based-models-of-categorization.html#cb660-25" tabindex="-1"></a>  }</span>
<span id="cb660-26"><a href="rule-based-models-of-categorization.html#cb660-26" tabindex="-1"></a>  </span>
<span id="cb660-27"><a href="rule-based-models-of-categorization.html#cb660-27" tabindex="-1"></a>  <span class="co"># Normalize the weights to sum to 1</span></span>
<span id="cb660-28"><a href="rule-based-models-of-categorization.html#cb660-28" tabindex="-1"></a>  total_weight <span class="ot">&lt;-</span> <span class="fu">sum</span>(new_unnormalized_weights)</span>
<span id="cb660-29"><a href="rule-based-models-of-categorization.html#cb660-29" tabindex="-1"></a>  <span class="cf">if</span> (total_weight <span class="sc">&gt;</span> <span class="fl">1e-9</span>) { <span class="co"># Avoid division by zero if all weights become tiny</span></span>
<span id="cb660-30"><a href="rule-based-models-of-categorization.html#cb660-30" tabindex="-1"></a>      normalized_weights <span class="ot">&lt;-</span> new_unnormalized_weights <span class="sc">/</span> total_weight</span>
<span id="cb660-31"><a href="rule-based-models-of-categorization.html#cb660-31" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb660-32"><a href="rule-based-models-of-categorization.html#cb660-32" tabindex="-1"></a>      <span class="co"># If all weights are effectively zero, reset to uniform </span></span>
<span id="cb660-33"><a href="rule-based-models-of-categorization.html#cb660-33" tabindex="-1"></a>      <span class="co"># (could indicate a problem or very surprising data)</span></span>
<span id="cb660-34"><a href="rule-based-models-of-categorization.html#cb660-34" tabindex="-1"></a>      normalized_weights <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_particles, n_particles)</span>
<span id="cb660-35"><a href="rule-based-models-of-categorization.html#cb660-35" tabindex="-1"></a>      <span class="co"># warning(&quot;All particle weights near zero; resetting to uniform.&quot;, call. = FALSE)</span></span>
<span id="cb660-36"><a href="rule-based-models-of-categorization.html#cb660-36" tabindex="-1"></a>  }</span>
<span id="cb660-37"><a href="rule-based-models-of-categorization.html#cb660-37" tabindex="-1"></a>  </span>
<span id="cb660-38"><a href="rule-based-models-of-categorization.html#cb660-38" tabindex="-1"></a>  <span class="fu">return</span>(normalized_weights)</span>
<span id="cb660-39"><a href="rule-based-models-of-categorization.html#cb660-39" tabindex="-1"></a>}</span>
<span id="cb660-40"><a href="rule-based-models-of-categorization.html#cb660-40" tabindex="-1"></a></span>
<span id="cb660-41"><a href="rule-based-models-of-categorization.html#cb660-41" tabindex="-1"></a><span class="co"># --- Example Update ---</span></span>
<span id="cb660-42"><a href="rule-based-models-of-categorization.html#cb660-42" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">--- Example Weight Update ---</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## --- Example Weight Update ---</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="rule-based-models-of-categorization.html#cb662-1" tabindex="-1"></a><span class="co"># Use the initial system from before</span></span>
<span id="cb662-2"><a href="rule-based-models-of-categorization.html#cb662-2" tabindex="-1"></a>current_particles <span class="ot">&lt;-</span> initial_system<span class="sc">$</span>particles</span>
<span id="cb662-3"><a href="rule-based-models-of-categorization.html#cb662-3" tabindex="-1"></a>current_weights <span class="ot">&lt;-</span> initial_system<span class="sc">$</span>weights</span>
<span id="cb662-4"><a href="rule-based-models-of-categorization.html#cb662-4" tabindex="-1"></a><span class="co"># Observe stimulus: Height=4, Position=3 (True Category = 1)</span></span>
<span id="cb662-5"><a href="rule-based-models-of-categorization.html#cb662-5" tabindex="-1"></a>observed_stimulus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb662-6"><a href="rule-based-models-of-categorization.html#cb662-6" tabindex="-1"></a>observed_category <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb662-7"><a href="rule-based-models-of-categorization.html#cb662-7" tabindex="-1"></a></span>
<span id="cb662-8"><a href="rule-based-models-of-categorization.html#cb662-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weights BEFORE update:&quot;</span>, <span class="fu">round</span>(current_weights, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weights BEFORE update: 0.2 0.2 0.2 0.2 0.2</code></pre>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="rule-based-models-of-categorization.html#cb664-1" tabindex="-1"></a><span class="co"># Update weights based on this observation</span></span>
<span id="cb664-2"><a href="rule-based-models-of-categorization.html#cb664-2" tabindex="-1"></a>updated_weights <span class="ot">&lt;-</span> <span class="fu">update_weights</span>(current_particles, current_weights, </span>
<span id="cb664-3"><a href="rule-based-models-of-categorization.html#cb664-3" tabindex="-1"></a>                                  observed_stimulus, observed_category, <span class="at">error_prob =</span> <span class="fl">0.1</span>)</span>
<span id="cb664-4"><a href="rule-based-models-of-categorization.html#cb664-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weights AFTER update:&quot;</span>, <span class="fu">round</span>(updated_weights, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weights AFTER update: 0.077 0.077 0.077 0.692 0.077</code></pre>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="rule-based-models-of-categorization.html#cb666-1" tabindex="-1"></a><span class="co"># Check which rules predicted correctly (prediction == 1)</span></span>
<span id="cb666-2"><a href="rule-based-models-of-categorization.html#cb666-2" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">sapply</span>(current_particles, evaluate_rule, <span class="at">stimulus =</span> observed_stimulus)</span>
<span id="cb666-3"><a href="rule-based-models-of-categorization.html#cb666-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Rule predictions for stimulus [4, 3]:&quot;</span>, predictions, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Rule predictions for stimulus [4, 3]: 0 0 0 1 0</code></pre>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="rule-based-models-of-categorization.html#cb668-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;(Weights increase for rules predicting 1, decrease for rules predicting 0)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## (Weights increase for rules predicting 1, decrease for rules predicting 0)</code></pre>
</div>
<div id="step-3-resampling-particles" class="section level3 hasAnchor" number="14.3.3">
<h3><span class="header-section-number">14.3.3</span> Step 3: Resampling Particles<a href="rule-based-models-of-categorization.html#step-3-resampling-particles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we only update weights, eventually most weights become tiny, and only a few particles dominate. This is inefficient (“particle degeneracy”). Resampling revitalizes the particle set.</p>
<p>We draw N new particles from the current set, where the probability of selecting particle i is equal to its current weight <span class="math inline">\(w_{i}\)</span>. High-weight particles are likely to be selected multiple times, while low-weight particles are likely to be dropped. After resampling, all N particles in the new set are assigned equal weights (1/N).</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="rule-based-models-of-categorization.html#cb670-1" tabindex="-1"></a><span class="co"># Function to resample particles based on their weights</span></span>
<span id="cb670-2"><a href="rule-based-models-of-categorization.html#cb670-2" tabindex="-1"></a>resample_particles <span class="ot">&lt;-</span> <span class="cf">function</span>(particles, <span class="co"># List of current particles</span></span>
<span id="cb670-3"><a href="rule-based-models-of-categorization.html#cb670-3" tabindex="-1"></a>                               weights    <span class="co"># Vector of current weights</span></span>
<span id="cb670-4"><a href="rule-based-models-of-categorization.html#cb670-4" tabindex="-1"></a>                               ) {</span>
<span id="cb670-5"><a href="rule-based-models-of-categorization.html#cb670-5" tabindex="-1"></a>  n_particles <span class="ot">&lt;-</span> <span class="fu">length</span>(particles)</span>
<span id="cb670-6"><a href="rule-based-models-of-categorization.html#cb670-6" tabindex="-1"></a>  </span>
<span id="cb670-7"><a href="rule-based-models-of-categorization.html#cb670-7" tabindex="-1"></a>  <span class="co"># Generate indices by sampling 1:n_particles with probabilities given by weights</span></span>
<span id="cb670-8"><a href="rule-based-models-of-categorization.html#cb670-8" tabindex="-1"></a>  <span class="co"># Using sample.int is efficient</span></span>
<span id="cb670-9"><a href="rule-based-models-of-categorization.html#cb670-9" tabindex="-1"></a>  resampled_indices <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="at">n =</span> n_particles, </span>
<span id="cb670-10"><a href="rule-based-models-of-categorization.html#cb670-10" tabindex="-1"></a>                                  <span class="at">size =</span> n_particles, </span>
<span id="cb670-11"><a href="rule-based-models-of-categorization.html#cb670-11" tabindex="-1"></a>                                  <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb670-12"><a href="rule-based-models-of-categorization.html#cb670-12" tabindex="-1"></a>                                  <span class="at">prob =</span> weights)</span>
<span id="cb670-13"><a href="rule-based-models-of-categorization.html#cb670-13" tabindex="-1"></a>  </span>
<span id="cb670-14"><a href="rule-based-models-of-categorization.html#cb670-14" tabindex="-1"></a>  <span class="co"># Create the new set of particles based on the resampled indices</span></span>
<span id="cb670-15"><a href="rule-based-models-of-categorization.html#cb670-15" tabindex="-1"></a>  new_particles <span class="ot">&lt;-</span> particles[resampled_indices]</span>
<span id="cb670-16"><a href="rule-based-models-of-categorization.html#cb670-16" tabindex="-1"></a>  </span>
<span id="cb670-17"><a href="rule-based-models-of-categorization.html#cb670-17" tabindex="-1"></a>  <span class="co"># Reset weights to be uniform after resampling</span></span>
<span id="cb670-18"><a href="rule-based-models-of-categorization.html#cb670-18" tabindex="-1"></a>  new_weights <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_particles, n_particles)</span>
<span id="cb670-19"><a href="rule-based-models-of-categorization.html#cb670-19" tabindex="-1"></a>  </span>
<span id="cb670-20"><a href="rule-based-models-of-categorization.html#cb670-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">particles =</span> new_particles, <span class="at">weights =</span> new_weights))</span>
<span id="cb670-21"><a href="rule-based-models-of-categorization.html#cb670-21" tabindex="-1"></a>}</span>
<span id="cb670-22"><a href="rule-based-models-of-categorization.html#cb670-22" tabindex="-1"></a></span>
<span id="cb670-23"><a href="rule-based-models-of-categorization.html#cb670-23" tabindex="-1"></a><span class="co"># --- Example Resampling ---</span></span>
<span id="cb670-24"><a href="rule-based-models-of-categorization.html#cb670-24" tabindex="-1"></a><span class="co"># Let&#39;s assume weights became skewed after several updates</span></span>
<span id="cb670-25"><a href="rule-based-models-of-categorization.html#cb670-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">--- Example Resampling ---</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## --- Example Resampling ---</code></pre>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="rule-based-models-of-categorization.html#cb672-1" tabindex="-1"></a>skewed_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.6</span>, <span class="fl">0.02</span>, <span class="fl">0.35</span>, <span class="fl">0.02</span>) </span>
<span id="cb672-2"><a href="rule-based-models-of-categorization.html#cb672-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weights BEFORE resampling:&quot;</span>, skewed_weights, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weights BEFORE resampling: 0.01 0.6 0.02 0.35 0.02</code></pre>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="rule-based-models-of-categorization.html#cb674-1" tabindex="-1"></a><span class="co"># Perform resampling</span></span>
<span id="cb674-2"><a href="rule-based-models-of-categorization.html#cb674-2" tabindex="-1"></a>resampled_system <span class="ot">&lt;-</span> <span class="fu">resample_particles</span>(current_particles, skewed_weights)</span>
<span id="cb674-3"><a href="rule-based-models-of-categorization.html#cb674-3" tabindex="-1"></a></span>
<span id="cb674-4"><a href="rule-based-models-of-categorization.html#cb674-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Weights AFTER resampling:&quot;</span>, resampled_system<span class="sc">$</span>weights, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Weights AFTER resampling: 0.2 0.2 0.2 0.2 0.2</code></pre>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="rule-based-models-of-categorization.html#cb676-1" tabindex="-1"></a><span class="co"># Note: The specific particles duplicated/dropped depend on the random sample</span></span>
<span id="cb676-2"><a href="rule-based-models-of-categorization.html#cb676-2" tabindex="-1"></a><span class="co"># You can inspect resampled_system$particles to see which rules survived.</span></span>
<span id="cb676-3"><a href="rule-based-models-of-categorization.html#cb676-3" tabindex="-1"></a><span class="co"># Example: table(sapply(resampled_system$particles, function(p) paste(p$dimensions, collapse=&quot;,&quot;)))</span></span></code></pre></div>
<p>When to resample? A common heuristic is to resample when the “Effective Sample Size” (ESS) drops below a threshold (e.g., N/2). ESS can be estimated as <span class="math inline">\(1 / \sum w_i^2\)</span>. Low ESS indicates high degeneracy. [I know talking about ESS within a model, when we discussed it in the context of the sampler is confusing. This is because the particle filter is a sampling method too. The ESS here is a measure of how many particles are effectively contributing to the model, given their weights. In the context of the sampler, we were discussing ESS in terms of how many samples are effectively independent. The two concepts are related but distinct.]</p>
<p>Step 4: Making Predictions
How does the particle filter make a categorization decision for a new stimulus <span class="math inline">\(\vec{x}\)</span>? It takes a weighted average of the predictions made by all individual particles (rules):</p>
<p><span class="math display">\[
P(\text{Choose Cat 1} \mid \vec{x}) = \sum_{i=1}^{N} w_i \times P(\text{Cat 1} \mid \vec{x}, \text{rule}_i)
\]</span></p>
<p>where <span class="math inline">\(P(\text{Cat 1} \mid \vec{x}, \text{rule}_i)\)</span> is 1 if rule i predicts category 1 for stimulus x, and 0 otherwise. (We can incorporate the error_prob here too if desired, but often the simple weighted vote is used for the final choice probability).</p>
</div>
<div id="putting-it-together-the-particle-filter-agent" class="section level3 hasAnchor" number="14.3.4">
<h3><span class="header-section-number">14.3.4</span> Putting it Together: The Particle Filter Agent<a href="rule-based-models-of-categorization.html#putting-it-together-the-particle-filter-agent" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we combine these steps into a function that simulates the entire learning process over multiple trials.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="rule-based-models-of-categorization.html#cb677-1" tabindex="-1"></a><span class="co"># Rule-based model agent using a Bayesian Particle Filter</span></span>
<span id="cb677-2"><a href="rule-based-models-of-categorization.html#cb677-2" tabindex="-1"></a>rule_particle_filter <span class="ot">&lt;-</span> <span class="cf">function</span>(n_particles,    <span class="co"># Number of rule hypotheses (particles)</span></span>
<span id="cb677-3"><a href="rule-based-models-of-categorization.html#cb677-3" tabindex="-1"></a>                                 error_prob,     <span class="co"># Assumed error/noise probability</span></span>
<span id="cb677-4"><a href="rule-based-models-of-categorization.html#cb677-4" tabindex="-1"></a>                                 obs,            <span class="co"># Matrix of observations (trials x features)</span></span>
<span id="cb677-5"><a href="rule-based-models-of-categorization.html#cb677-5" tabindex="-1"></a>                                 cat_one,        <span class="co"># Vector of true category labels for feedback</span></span>
<span id="cb677-6"><a href="rule-based-models-of-categorization.html#cb677-6" tabindex="-1"></a>                                 <span class="at">max_dims =</span> <span class="dv">2</span>,   <span class="co"># Max dimensions per rule (1 or 2)</span></span>
<span id="cb677-7"><a href="rule-based-models-of-categorization.html#cb677-7" tabindex="-1"></a>                                 <span class="at">resample_threshold_factor =</span> <span class="fl">0.5</span>, <span class="co"># Resample if ESS &lt; N * factor</span></span>
<span id="cb677-8"><a href="rule-based-models-of-categorization.html#cb677-8" tabindex="-1"></a>                                 <span class="at">quiet =</span> <span class="cn">TRUE</span>    <span class="co"># Suppress trial progress messages</span></span>
<span id="cb677-9"><a href="rule-based-models-of-categorization.html#cb677-9" tabindex="-1"></a>                                 ) {</span>
<span id="cb677-10"><a href="rule-based-models-of-categorization.html#cb677-10" tabindex="-1"></a>  </span>
<span id="cb677-11"><a href="rule-based-models-of-categorization.html#cb677-11" tabindex="-1"></a>  n_trials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb677-12"><a href="rule-based-models-of-categorization.html#cb677-12" tabindex="-1"></a>  n_features <span class="ot">&lt;-</span> <span class="fu">ncol</span>(obs)</span>
<span id="cb677-13"><a href="rule-based-models-of-categorization.html#cb677-13" tabindex="-1"></a>  </span>
<span id="cb677-14"><a href="rule-based-models-of-categorization.html#cb677-14" tabindex="-1"></a>  <span class="co"># --- Initialization ---</span></span>
<span id="cb677-15"><a href="rule-based-models-of-categorization.html#cb677-15" tabindex="-1"></a>  <span class="co"># Assume feature ranges based on typical experiment data (adjust if needed)</span></span>
<span id="cb677-16"><a href="rule-based-models-of-categorization.html#cb677-16" tabindex="-1"></a>  feature_range <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) </span>
<span id="cb677-17"><a href="rule-based-models-of-categorization.html#cb677-17" tabindex="-1"></a>  particle_system <span class="ot">&lt;-</span> <span class="fu">initialize_particles</span>(n_particles, n_features, max_dims, feature_range)</span>
<span id="cb677-18"><a href="rule-based-models-of-categorization.html#cb677-18" tabindex="-1"></a>  particles <span class="ot">&lt;-</span> particle_system<span class="sc">$</span>particles</span>
<span id="cb677-19"><a href="rule-based-models-of-categorization.html#cb677-19" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> particle_system<span class="sc">$</span>weights</span>
<span id="cb677-20"><a href="rule-based-models-of-categorization.html#cb677-20" tabindex="-1"></a>  </span>
<span id="cb677-21"><a href="rule-based-models-of-categorization.html#cb677-21" tabindex="-1"></a>  <span class="co"># Storage for response probabilities (prob of choosing category 1)</span></span>
<span id="cb677-22"><a href="rule-based-models-of-categorization.html#cb677-22" tabindex="-1"></a>  response_probs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb677-23"><a href="rule-based-models-of-categorization.html#cb677-23" tabindex="-1"></a>  </span>
<span id="cb677-24"><a href="rule-based-models-of-categorization.html#cb677-24" tabindex="-1"></a>  <span class="co"># --- Trial Loop ---</span></span>
<span id="cb677-25"><a href="rule-based-models-of-categorization.html#cb677-25" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb677-26"><a href="rule-based-models-of-categorization.html#cb677-26" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>quiet <span class="sc">&amp;&amp;</span> i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Trial&quot;</span>, i))</span>
<span id="cb677-27"><a href="rule-based-models-of-categorization.html#cb677-27" tabindex="-1"></a>    </span>
<span id="cb677-28"><a href="rule-based-models-of-categorization.html#cb677-28" tabindex="-1"></a>    current_stimulus <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[i, ])</span>
<span id="cb677-29"><a href="rule-based-models-of-categorization.html#cb677-29" tabindex="-1"></a>    </span>
<span id="cb677-30"><a href="rule-based-models-of-categorization.html#cb677-30" tabindex="-1"></a>    <span class="co"># --- Make Prediction for current stimulus ---</span></span>
<span id="cb677-31"><a href="rule-based-models-of-categorization.html#cb677-31" tabindex="-1"></a>    <span class="co"># Get prediction from each particle (0 or 1)</span></span>
<span id="cb677-32"><a href="rule-based-models-of-categorization.html#cb677-32" tabindex="-1"></a>    rule_predictions <span class="ot">&lt;-</span> <span class="fu">sapply</span>(particles, evaluate_rule, <span class="at">stimulus =</span> current_stimulus)</span>
<span id="cb677-33"><a href="rule-based-models-of-categorization.html#cb677-33" tabindex="-1"></a>    </span>
<span id="cb677-34"><a href="rule-based-models-of-categorization.html#cb677-34" tabindex="-1"></a>    <span class="co"># Calculate overall probability of choosing category 1 (weighted vote)</span></span>
<span id="cb677-35"><a href="rule-based-models-of-categorization.html#cb677-35" tabindex="-1"></a>    <span class="co"># P(Cat 1) = Sum(weight_i * I(prediction_i == 1))</span></span>
<span id="cb677-36"><a href="rule-based-models-of-categorization.html#cb677-36" tabindex="-1"></a>    <span class="co"># Incorporate error_prob for smoother probability:</span></span>
<span id="cb677-37"><a href="rule-based-models-of-categorization.html#cb677-37" tabindex="-1"></a>    <span class="co"># P(Cat 1 | rule_i) = (1-error_prob) if pred_i=1 else error_prob</span></span>
<span id="cb677-38"><a href="rule-based-models-of-categorization.html#cb677-38" tabindex="-1"></a>    prob_cat1_given_rules <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rule_predictions <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">-</span> error_prob, error_prob)</span>
<span id="cb677-39"><a href="rule-based-models-of-categorization.html#cb677-39" tabindex="-1"></a>    response_probs[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(weights <span class="sc">*</span> prob_cat1_given_rules)</span>
<span id="cb677-40"><a href="rule-based-models-of-categorization.html#cb677-40" tabindex="-1"></a>    </span>
<span id="cb677-41"><a href="rule-based-models-of-categorization.html#cb677-41" tabindex="-1"></a>    <span class="co"># Ensure probability is within bounds for rbinom</span></span>
<span id="cb677-42"><a href="rule-based-models-of-categorization.html#cb677-42" tabindex="-1"></a>    response_probs[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">min</span>(response_probs[i], <span class="fl">0.9999</span>), <span class="fl">0.0001</span>)</span>
<span id="cb677-43"><a href="rule-based-models-of-categorization.html#cb677-43" tabindex="-1"></a></span>
<span id="cb677-44"><a href="rule-based-models-of-categorization.html#cb677-44" tabindex="-1"></a>    <span class="co"># --- Learning Update (based on true feedback) ---</span></span>
<span id="cb677-45"><a href="rule-based-models-of-categorization.html#cb677-45" tabindex="-1"></a>    true_category <span class="ot">&lt;-</span> cat_one[i]</span>
<span id="cb677-46"><a href="rule-based-models-of-categorization.html#cb677-46" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <span class="fu">update_weights</span>(particles, weights, current_stimulus, true_category, error_prob)</span>
<span id="cb677-47"><a href="rule-based-models-of-categorization.html#cb677-47" tabindex="-1"></a>    </span>
<span id="cb677-48"><a href="rule-based-models-of-categorization.html#cb677-48" tabindex="-1"></a>    <span class="co"># --- Resampling Step ---</span></span>
<span id="cb677-49"><a href="rule-based-models-of-categorization.html#cb677-49" tabindex="-1"></a>    <span class="co"># Calculate Effective Sample Size (ESS)</span></span>
<span id="cb677-50"><a href="rule-based-models-of-categorization.html#cb677-50" tabindex="-1"></a>    ess <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sum</span>(weights<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb677-51"><a href="rule-based-models-of-categorization.html#cb677-51" tabindex="-1"></a>    </span>
<span id="cb677-52"><a href="rule-based-models-of-categorization.html#cb677-52" tabindex="-1"></a>    <span class="co"># Resample if ESS is below the threshold (e.g., N/2)</span></span>
<span id="cb677-53"><a href="rule-based-models-of-categorization.html#cb677-53" tabindex="-1"></a>    <span class="cf">if</span> (ess <span class="sc">&lt;</span> n_particles <span class="sc">*</span> resample_threshold_factor) {</span>
<span id="cb677-54"><a href="rule-based-models-of-categorization.html#cb677-54" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span>quiet) <span class="fu">cat</span>(<span class="st">&quot; Resampling at trial&quot;</span>, i, <span class="st">&quot;ESS =&quot;</span>, <span class="fu">round</span>(ess, <span class="dv">1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb677-55"><a href="rule-based-models-of-categorization.html#cb677-55" tabindex="-1"></a>      resampled_system <span class="ot">&lt;-</span> <span class="fu">resample_particles</span>(particles, weights)</span>
<span id="cb677-56"><a href="rule-based-models-of-categorization.html#cb677-56" tabindex="-1"></a>      particles <span class="ot">&lt;-</span> resampled_system<span class="sc">$</span>particles</span>
<span id="cb677-57"><a href="rule-based-models-of-categorization.html#cb677-57" tabindex="-1"></a>      weights <span class="ot">&lt;-</span> resampled_system<span class="sc">$</span>weights</span>
<span id="cb677-58"><a href="rule-based-models-of-categorization.html#cb677-58" tabindex="-1"></a>    }</span>
<span id="cb677-59"><a href="rule-based-models-of-categorization.html#cb677-59" tabindex="-1"></a>    </span>
<span id="cb677-60"><a href="rule-based-models-of-categorization.html#cb677-60" tabindex="-1"></a>  } <span class="co"># End trial loop</span></span>
<span id="cb677-61"><a href="rule-based-models-of-categorization.html#cb677-61" tabindex="-1"></a>  </span>
<span id="cb677-62"><a href="rule-based-models-of-categorization.html#cb677-62" tabindex="-1"></a>  <span class="co"># Return simulated binary responses based on calculated probabilities</span></span>
<span id="cb677-63"><a href="rule-based-models-of-categorization.html#cb677-63" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(n_trials, <span class="dv">1</span>, response_probs))</span>
<span id="cb677-64"><a href="rule-based-models-of-categorization.html#cb677-64" tabindex="-1"></a>}</span>
<span id="cb677-65"><a href="rule-based-models-of-categorization.html#cb677-65" tabindex="-1"></a></span>
<span id="cb677-66"><a href="rule-based-models-of-categorization.html#cb677-66" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Rule particle filter agent function defined.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Rule particle filter agent function defined.</code></pre>
<p>This implementation captures the core cognitive processes hypothesized by rule-based models involving hypothesis generation, testing against evidence, belief updating, and adapting the set of considered hypotheses.</p>
</div>
</div>
<div id="simulating-categorization-behavior-1" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Simulating Categorization Behavior<a href="rule-based-models-of-categorization.html#simulating-categorization-behavior-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s simulate how this rule-based model performs on our standard categorization task (experiment data). We’ll vary parameters like the number of particles and the assumed error probability.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="rule-based-models-of-categorization.html#cb679-1" tabindex="-1"></a><span class="co"># Function to wrap simulation runs for the rule-based model</span></span>
<span id="cb679-2"><a href="rule-based-models-of-categorization.html#cb679-2" tabindex="-1"></a>simulate_rule_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(agent, n_particles, max_dims, error_prob, experiment_data) {</span>
<span id="cb679-3"><a href="rule-based-models-of-categorization.html#cb679-3" tabindex="-1"></a>    </span>
<span id="cb679-4"><a href="rule-based-models-of-categorization.html#cb679-4" tabindex="-1"></a>    observations <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(experiment_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(height, position))</span>
<span id="cb679-5"><a href="rule-based-models-of-categorization.html#cb679-5" tabindex="-1"></a>    category_feedback <span class="ot">&lt;-</span> experiment_data<span class="sc">$</span>category</span>
<span id="cb679-6"><a href="rule-based-models-of-categorization.html#cb679-6" tabindex="-1"></a>    </span>
<span id="cb679-7"><a href="rule-based-models-of-categorization.html#cb679-7" tabindex="-1"></a>    <span class="co"># Simulate responses using the rule_particle_filter function</span></span>
<span id="cb679-8"><a href="rule-based-models-of-categorization.html#cb679-8" tabindex="-1"></a>    sim_responses <span class="ot">&lt;-</span> <span class="fu">rule_particle_filter</span>(</span>
<span id="cb679-9"><a href="rule-based-models-of-categorization.html#cb679-9" tabindex="-1"></a>        <span class="at">n_particles =</span> n_particles,</span>
<span id="cb679-10"><a href="rule-based-models-of-categorization.html#cb679-10" tabindex="-1"></a>        <span class="at">error_prob =</span> error_prob,</span>
<span id="cb679-11"><a href="rule-based-models-of-categorization.html#cb679-11" tabindex="-1"></a>        <span class="at">obs =</span> observations,</span>
<span id="cb679-12"><a href="rule-based-models-of-categorization.html#cb679-12" tabindex="-1"></a>        <span class="at">cat_one =</span> category_feedback,</span>
<span id="cb679-13"><a href="rule-based-models-of-categorization.html#cb679-13" tabindex="-1"></a>        <span class="at">max_dims =</span> max_dims, <span class="co"># Allow 1D or 2D rules</span></span>
<span id="cb679-14"><a href="rule-based-models-of-categorization.html#cb679-14" tabindex="-1"></a>        <span class="at">resample_threshold_factor =</span> <span class="fl">0.5</span>,</span>
<span id="cb679-15"><a href="rule-based-models-of-categorization.html#cb679-15" tabindex="-1"></a>        <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb679-16"><a href="rule-based-models-of-categorization.html#cb679-16" tabindex="-1"></a>    )</span>
<span id="cb679-17"><a href="rule-based-models-of-categorization.html#cb679-17" tabindex="-1"></a>    </span>
<span id="cb679-18"><a href="rule-based-models-of-categorization.html#cb679-18" tabindex="-1"></a>    <span class="co"># Record results</span></span>
<span id="cb679-19"><a href="rule-based-models-of-categorization.html#cb679-19" tabindex="-1"></a>    tmp_simulated_responses <span class="ot">&lt;-</span> experiment_data <span class="sc">%&gt;%</span></span>
<span id="cb679-20"><a href="rule-based-models-of-categorization.html#cb679-20" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb679-21"><a href="rule-based-models-of-categorization.html#cb679-21" tabindex="-1"></a>            <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb679-22"><a href="rule-based-models-of-categorization.html#cb679-22" tabindex="-1"></a>            <span class="at">sim_response =</span> sim_responses,</span>
<span id="cb679-23"><a href="rule-based-models-of-categorization.html#cb679-23" tabindex="-1"></a>            <span class="at">correct =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> sim_response, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb679-24"><a href="rule-based-models-of-categorization.html#cb679-24" tabindex="-1"></a>            <span class="at">performance =</span> <span class="fu">cumsum</span>(correct) <span class="sc">/</span> trial,</span>
<span id="cb679-25"><a href="rule-based-models-of-categorization.html#cb679-25" tabindex="-1"></a>            <span class="at">n_particles =</span> n_particles,</span>
<span id="cb679-26"><a href="rule-based-models-of-categorization.html#cb679-26" tabindex="-1"></a>            <span class="at">max_dims =</span> max_dims,</span>
<span id="cb679-27"><a href="rule-based-models-of-categorization.html#cb679-27" tabindex="-1"></a>            <span class="at">error_prob =</span> error_prob,</span>
<span id="cb679-28"><a href="rule-based-models-of-categorization.html#cb679-28" tabindex="-1"></a>            <span class="at">agent =</span> agent</span>
<span id="cb679-29"><a href="rule-based-models-of-categorization.html#cb679-29" tabindex="-1"></a>        )</span>
<span id="cb679-30"><a href="rule-based-models-of-categorization.html#cb679-30" tabindex="-1"></a></span>
<span id="cb679-31"><a href="rule-based-models-of-categorization.html#cb679-31" tabindex="-1"></a>    <span class="fu">return</span>(tmp_simulated_responses)</span>
<span id="cb679-32"><a href="rule-based-models-of-categorization.html#cb679-32" tabindex="-1"></a>}</span>
<span id="cb679-33"><a href="rule-based-models-of-categorization.html#cb679-33" tabindex="-1"></a></span>
<span id="cb679-34"><a href="rule-based-models-of-categorization.html#cb679-34" tabindex="-1"></a><span class="co"># --- Run Rule-Based Simulations ---</span></span>
<span id="cb679-35"><a href="rule-based-models-of-categorization.html#cb679-35" tabindex="-1"></a><span class="co"># Define parameters for simulation grid</span></span>
<span id="cb679-36"><a href="rule-based-models-of-categorization.html#cb679-36" tabindex="-1"></a>param_df_rules <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb679-37"><a href="rule-based-models-of-categorization.html#cb679-37" tabindex="-1"></a>    <span class="fu">expand_grid</span>(</span>
<span id="cb679-38"><a href="rule-based-models-of-categorization.html#cb679-38" tabindex="-1"></a>        <span class="at">agent =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="co"># Simulate 10 agents per condition</span></span>
<span id="cb679-39"><a href="rule-based-models-of-categorization.html#cb679-39" tabindex="-1"></a>        <span class="at">n_particles =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">200</span>), <span class="co"># Fewer vs. More rule hypotheses</span></span>
<span id="cb679-40"><a href="rule-based-models-of-categorization.html#cb679-40" tabindex="-1"></a>        <span class="at">max_dims =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),      <span class="co"># Allow only 1D rules vs. 1D &amp; 2D rules</span></span>
<span id="cb679-41"><a href="rule-based-models-of-categorization.html#cb679-41" tabindex="-1"></a>        <span class="at">error_prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>) <span class="co"># Low vs. High assumed noise/error</span></span>
<span id="cb679-42"><a href="rule-based-models-of-categorization.html#cb679-42" tabindex="-1"></a>    )</span>
<span id="cb679-43"><a href="rule-based-models-of-categorization.html#cb679-43" tabindex="-1"></a>)</span>
<span id="cb679-44"><a href="rule-based-models-of-categorization.html#cb679-44" tabindex="-1"></a></span>
<span id="cb679-45"><a href="rule-based-models-of-categorization.html#cb679-45" tabindex="-1"></a><span class="co"># Define file path for saving/loading results</span></span>
<span id="cb679-46"><a href="rule-based-models-of-categorization.html#cb679-46" tabindex="-1"></a>rule_sim_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;simdata&quot;</span>, <span class="st">&quot;W13_rule_simulated_responses.csv&quot;</span>)</span>
<span id="cb679-47"><a href="rule-based-models-of-categorization.html#cb679-47" tabindex="-1"></a></span>
<span id="cb679-48"><a href="rule-based-models-of-categorization.html#cb679-48" tabindex="-1"></a><span class="co"># Run simulations (or load pre-computed results)</span></span>
<span id="cb679-49"><a href="rule-based-models-of-categorization.html#cb679-49" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(rule_sim_file)) {</span>
<span id="cb679-50"><a href="rule-based-models-of-categorization.html#cb679-50" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Regenerating rule-based simulations...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb679-51"><a href="rule-based-models-of-categorization.html#cb679-51" tabindex="-1"></a>  <span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>()) <span class="co"># Ensure parallel plan</span></span>
<span id="cb679-52"><a href="rule-based-models-of-categorization.html#cb679-52" tabindex="-1"></a>  </span>
<span id="cb679-53"><a href="rule-based-models-of-categorization.html#cb679-53" tabindex="-1"></a>  rule_responses <span class="ot">&lt;-</span> <span class="fu">future_pmap_dfr</span>(param_df_rules,</span>
<span id="cb679-54"><a href="rule-based-models-of-categorization.html#cb679-54" tabindex="-1"></a>      simulate_rule_responses,</span>
<span id="cb679-55"><a href="rule-based-models-of-categorization.html#cb679-55" tabindex="-1"></a>      <span class="at">experiment_data =</span> experiment,</span>
<span id="cb679-56"><a href="rule-based-models-of-categorization.html#cb679-56" tabindex="-1"></a>      <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb679-57"><a href="rule-based-models-of-categorization.html#cb679-57" tabindex="-1"></a>  )</span>
<span id="cb679-58"><a href="rule-based-models-of-categorization.html#cb679-58" tabindex="-1"></a>  </span>
<span id="cb679-59"><a href="rule-based-models-of-categorization.html#cb679-59" tabindex="-1"></a>  <span class="fu">write_csv</span>(rule_responses, rule_sim_file)</span>
<span id="cb679-60"><a href="rule-based-models-of-categorization.html#cb679-60" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Rule-based simulations saved to:&quot;</span>, rule_sim_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb679-61"><a href="rule-based-models-of-categorization.html#cb679-61" tabindex="-1"></a>  </span>
<span id="cb679-62"><a href="rule-based-models-of-categorization.html#cb679-62" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb679-63"><a href="rule-based-models-of-categorization.html#cb679-63" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loading existing rule-based simulations from:&quot;</span>, rule_sim_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb679-64"><a href="rule-based-models-of-categorization.html#cb679-64" tabindex="-1"></a>  rule_responses <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(rule_sim_file, <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb679-65"><a href="rule-based-models-of-categorization.html#cb679-65" tabindex="-1"></a>      <span class="at">stimulus =</span> <span class="fu">col_double</span>(), <span class="at">height =</span> <span class="fu">col_double</span>(), <span class="at">position =</span> <span class="fu">col_double</span>(),</span>
<span id="cb679-66"><a href="rule-based-models-of-categorization.html#cb679-66" tabindex="-1"></a>      <span class="at">category =</span> <span class="fu">col_double</span>(), <span class="at">trial =</span> <span class="fu">col_integer</span>(), <span class="at">sim_response =</span> <span class="fu">col_double</span>(),</span>
<span id="cb679-67"><a href="rule-based-models-of-categorization.html#cb679-67" tabindex="-1"></a>      <span class="at">correct =</span> <span class="fu">col_double</span>(), <span class="at">performance =</span> <span class="fu">col_double</span>(), <span class="at">n_particles =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb679-68"><a href="rule-based-models-of-categorization.html#cb679-68" tabindex="-1"></a>      <span class="at">max_dims =</span> <span class="fu">col_integer</span>(), <span class="at">error_prob =</span> <span class="fu">col_double</span>(), <span class="at">agent =</span> <span class="fu">col_integer</span>()</span>
<span id="cb679-69"><a href="rule-based-models-of-categorization.html#cb679-69" tabindex="-1"></a>    ))</span>
<span id="cb679-70"><a href="rule-based-models-of-categorization.html#cb679-70" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Rule-based simulations loaded.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb679-71"><a href="rule-based-models-of-categorization.html#cb679-71" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loading existing rule-based simulations from: simdata/W13_rule_simulated_responses.csv 
## Rule-based simulations loaded.</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="rule-based-models-of-categorization.html#cb681-1" tabindex="-1"></a><span class="co"># --- Visualize Rule-Based Learning Curves ---</span></span>
<span id="cb681-2"><a href="rule-based-models-of-categorization.html#cb681-2" tabindex="-1"></a><span class="fu">ggplot</span>(rule_responses, </span>
<span id="cb681-3"><a href="rule-based-models-of-categorization.html#cb681-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> performance, <span class="at">color =</span> <span class="fu">factor</span>(n_particles))) <span class="sc">+</span></span>
<span id="cb681-4"><a href="rule-based-models-of-categorization.html#cb681-4" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb681-5"><a href="rule-based-models-of-categorization.html#cb681-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;ribbon&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(n_particles)), <span class="at">linetype =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb681-6"><a href="rule-based-models-of-categorization.html#cb681-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(max_dims <span class="sc">~</span> error_prob, </span>
<span id="cb681-7"><a href="rule-based-models-of-categorization.html#cb681-7" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb681-8"><a href="rule-based-models-of-categorization.html#cb681-8" tabindex="-1"></a>               <span class="at">max_dims =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Max Dims:&quot;</span>, x),</span>
<span id="cb681-9"><a href="rule-based-models-of-categorization.html#cb681-9" tabindex="-1"></a>               <span class="at">error_prob =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;Error Prob:&quot;</span>, x)</span>
<span id="cb681-10"><a href="rule-based-models-of-categorization.html#cb681-10" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb681-11"><a href="rule-based-models-of-categorization.html#cb681-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb681-12"><a href="rule-based-models-of-categorization.html#cb681-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb681-13"><a href="rule-based-models-of-categorization.html#cb681-13" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Rule-Based Model Learning Performance&quot;</span>,</span>
<span id="cb681-14"><a href="rule-based-models-of-categorization.html#cb681-14" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Facets show effect of max rule dimensions and error probability&quot;</span>,</span>
<span id="cb681-15"><a href="rule-based-models-of-categorization.html#cb681-15" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span>,</span>
<span id="cb681-16"><a href="rule-based-models-of-categorization.html#cb681-16" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion Correct (Mean +/- SE across 10 agents)&quot;</span>,</span>
<span id="cb681-17"><a href="rule-based-models-of-categorization.html#cb681-17" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;N Particles&quot;</span>,</span>
<span id="cb681-18"><a href="rule-based-models-of-categorization.html#cb681-18" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;N Particles&quot;</span></span>
<span id="cb681-19"><a href="rule-based-models-of-categorization.html#cb681-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb681-20"><a href="rule-based-models-of-categorization.html#cb681-20" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.4</span>, <span class="fl">1.0</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-79-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Simulation Interpretation: This visualization shows how the model’s performance is affected by:</p>
<ul>
<li><p>Number of Particles: More particles generally allow for a better exploration of the rule space, potentially leading to faster learning or higher final accuracy, though gains may diminish.</p></li>
<li><p>Maximum Rule Dimensions: Allowing 2D rules (max_dims = 2) might be necessary if the true category boundary requires integrating information across dimensions. If a simple 1D rule suffices, allowing 2D rules might slightly slow down learning initially.</p></li>
<li><p>Error Probability: A higher error_prob makes the model more tolerant of rules that aren’t perfect predictors, which can be helpful if the data is noisy or categories overlap, but might prevent convergence on a precise rule if one exists.</p></li>
</ul>
<div id="visualizing-rule-learning-over-time" class="section level3 hasAnchor" number="14.4.1">
<h3><span class="header-section-number">14.4.1</span> Visualizing Rule Learning Over Time<a href="rule-based-models-of-categorization.html#visualizing-rule-learning-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A key feature of rule-based models is the explicit nature of the hypotheses. We can track which rules the particle filter believes are most likely at different points during learning.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="rule-based-models-of-categorization.html#cb682-1" tabindex="-1"></a><span class="co"># Function to track the top K rules and their weights during learning</span></span>
<span id="cb682-2"><a href="rule-based-models-of-categorization.html#cb682-2" tabindex="-1"></a>track_rule_learning <span class="ot">&lt;-</span> <span class="cf">function</span>(n_particles, error_prob, obs, cat_one, </span>
<span id="cb682-3"><a href="rule-based-models-of-categorization.html#cb682-3" tabindex="-1"></a>                                <span class="at">max_dims =</span> <span class="dv">2</span>, <span class="at">top_k =</span> <span class="dv">1</span>, </span>
<span id="cb682-4"><a href="rule-based-models-of-categorization.html#cb682-4" tabindex="-1"></a>                                <span class="at">resample_threshold_factor =</span> <span class="fl">0.5</span>) {</span>
<span id="cb682-5"><a href="rule-based-models-of-categorization.html#cb682-5" tabindex="-1"></a>  <span class="co"># Initialize</span></span>
<span id="cb682-6"><a href="rule-based-models-of-categorization.html#cb682-6" tabindex="-1"></a>  n_trials <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs)</span>
<span id="cb682-7"><a href="rule-based-models-of-categorization.html#cb682-7" tabindex="-1"></a>  n_features <span class="ot">&lt;-</span> <span class="fu">ncol</span>(obs)</span>
<span id="cb682-8"><a href="rule-based-models-of-categorization.html#cb682-8" tabindex="-1"></a>  feature_range <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) <span class="co"># Assumed range</span></span>
<span id="cb682-9"><a href="rule-based-models-of-categorization.html#cb682-9" tabindex="-1"></a>  </span>
<span id="cb682-10"><a href="rule-based-models-of-categorization.html#cb682-10" tabindex="-1"></a>  particle_system <span class="ot">&lt;-</span> <span class="fu">initialize_particles</span>(n_particles, n_features, max_dims, feature_range)</span>
<span id="cb682-11"><a href="rule-based-models-of-categorization.html#cb682-11" tabindex="-1"></a>  particles <span class="ot">&lt;-</span> particle_system<span class="sc">$</span>particles</span>
<span id="cb682-12"><a href="rule-based-models-of-categorization.html#cb682-12" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> particle_system<span class="sc">$</span>weights</span>
<span id="cb682-13"><a href="rule-based-models-of-categorization.html#cb682-13" tabindex="-1"></a>  </span>
<span id="cb682-14"><a href="rule-based-models-of-categorization.html#cb682-14" tabindex="-1"></a>  <span class="co"># Store top rules at each step</span></span>
<span id="cb682-15"><a href="rule-based-models-of-categorization.html#cb682-15" tabindex="-1"></a>  rule_trajectory_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb682-16"><a href="rule-based-models-of-categorization.html#cb682-16" tabindex="-1"></a>  </span>
<span id="cb682-17"><a href="rule-based-models-of-categorization.html#cb682-17" tabindex="-1"></a>  <span class="co"># Helper function to format a rule for storage/display</span></span>
<span id="cb682-18"><a href="rule-based-models-of-categorization.html#cb682-18" tabindex="-1"></a>  format_rule_info <span class="ot">&lt;-</span> <span class="cf">function</span>(rule) {</span>
<span id="cb682-19"><a href="rule-based-models-of-categorization.html#cb682-19" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb682-20"><a href="rule-based-models-of-categorization.html#cb682-20" tabindex="-1"></a>        <span class="at">dimension1 =</span> <span class="cf">if</span>(<span class="fu">length</span>(rule<span class="sc">$</span>dimensions) <span class="sc">&gt;=</span> <span class="dv">1</span>) rule<span class="sc">$</span>dimensions[<span class="dv">1</span>] <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb682-21"><a href="rule-based-models-of-categorization.html#cb682-21" tabindex="-1"></a>        <span class="at">operation1 =</span> <span class="cf">if</span>(<span class="fu">length</span>(rule<span class="sc">$</span>operations) <span class="sc">&gt;=</span> <span class="dv">1</span>) rule<span class="sc">$</span>operations[<span class="dv">1</span>] <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb682-22"><a href="rule-based-models-of-categorization.html#cb682-22" tabindex="-1"></a>        <span class="at">threshold1 =</span> <span class="cf">if</span>(<span class="fu">length</span>(rule<span class="sc">$</span>thresholds) <span class="sc">&gt;=</span> <span class="dv">1</span>) rule<span class="sc">$</span>thresholds[<span class="dv">1</span>] <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb682-23"><a href="rule-based-models-of-categorization.html#cb682-23" tabindex="-1"></a>        <span class="at">dimension2 =</span> <span class="cf">if</span>(<span class="fu">length</span>(rule<span class="sc">$</span>dimensions) <span class="sc">&gt;=</span> <span class="dv">2</span>) rule<span class="sc">$</span>dimensions[<span class="dv">2</span>] <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb682-24"><a href="rule-based-models-of-categorization.html#cb682-24" tabindex="-1"></a>        <span class="at">operation2 =</span> <span class="cf">if</span>(<span class="fu">length</span>(rule<span class="sc">$</span>operations) <span class="sc">&gt;=</span> <span class="dv">2</span>) rule<span class="sc">$</span>operations[<span class="dv">2</span>] <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb682-25"><a href="rule-based-models-of-categorization.html#cb682-25" tabindex="-1"></a>        <span class="at">threshold2 =</span> <span class="cf">if</span>(<span class="fu">length</span>(rule<span class="sc">$</span>thresholds) <span class="sc">&gt;=</span> <span class="dv">2</span>) rule<span class="sc">$</span>thresholds[<span class="dv">2</span>] <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb682-26"><a href="rule-based-models-of-categorization.html#cb682-26" tabindex="-1"></a>        <span class="at">logic =</span> <span class="cf">if</span>(<span class="fu">is.na</span>(rule<span class="sc">$</span>logic)) <span class="st">&quot;N/A&quot;</span> <span class="cf">else</span> rule<span class="sc">$</span>logic,</span>
<span id="cb682-27"><a href="rule-based-models-of-categorization.html#cb682-27" tabindex="-1"></a>        <span class="at">prediction =</span> rule<span class="sc">$</span>prediction_if_true</span>
<span id="cb682-28"><a href="rule-based-models-of-categorization.html#cb682-28" tabindex="-1"></a>      )</span>
<span id="cb682-29"><a href="rule-based-models-of-categorization.html#cb682-29" tabindex="-1"></a>  }</span>
<span id="cb682-30"><a href="rule-based-models-of-categorization.html#cb682-30" tabindex="-1"></a></span>
<span id="cb682-31"><a href="rule-based-models-of-categorization.html#cb682-31" tabindex="-1"></a>  <span class="co"># Process each trial</span></span>
<span id="cb682-32"><a href="rule-based-models-of-categorization.html#cb682-32" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb682-33"><a href="rule-based-models-of-categorization.html#cb682-33" tabindex="-1"></a>    current_stimulus <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[i, ])</span>
<span id="cb682-34"><a href="rule-based-models-of-categorization.html#cb682-34" tabindex="-1"></a>    </span>
<span id="cb682-35"><a href="rule-based-models-of-categorization.html#cb682-35" tabindex="-1"></a>    <span class="co"># Record top K rules *before* update for this trial</span></span>
<span id="cb682-36"><a href="rule-based-models-of-categorization.html#cb682-36" tabindex="-1"></a>    ordered_idx <span class="ot">&lt;-</span> <span class="fu">order</span>(weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(top_k, n_particles)]</span>
<span id="cb682-37"><a href="rule-based-models-of-categorization.html#cb682-37" tabindex="-1"></a>    top_rules_info <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(ordered_idx, <span class="sc">~</span><span class="fu">tibble</span>(</span>
<span id="cb682-38"><a href="rule-based-models-of-categorization.html#cb682-38" tabindex="-1"></a>        <span class="at">rank =</span> <span class="fu">which</span>(ordered_idx <span class="sc">==</span> .x),</span>
<span id="cb682-39"><a href="rule-based-models-of-categorization.html#cb682-39" tabindex="-1"></a>        <span class="at">weight =</span> weights[.x],</span>
<span id="cb682-40"><a href="rule-based-models-of-categorization.html#cb682-40" tabindex="-1"></a>        <span class="sc">!!!</span><span class="fu">format_rule_info</span>(particles[[.x]]) <span class="co"># Splice the list columns</span></span>
<span id="cb682-41"><a href="rule-based-models-of-categorization.html#cb682-41" tabindex="-1"></a>    ))</span>
<span id="cb682-42"><a href="rule-based-models-of-categorization.html#cb682-42" tabindex="-1"></a>    </span>
<span id="cb682-43"><a href="rule-based-models-of-categorization.html#cb682-43" tabindex="-1"></a>    rule_trajectory_list[[i]] <span class="ot">&lt;-</span> top_rules_info <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">trial =</span> i)</span>
<span id="cb682-44"><a href="rule-based-models-of-categorization.html#cb682-44" tabindex="-1"></a></span>
<span id="cb682-45"><a href="rule-based-models-of-categorization.html#cb682-45" tabindex="-1"></a>    <span class="co"># --- Learning Update ---</span></span>
<span id="cb682-46"><a href="rule-based-models-of-categorization.html#cb682-46" tabindex="-1"></a>    true_category <span class="ot">&lt;-</span> cat_one[i]</span>
<span id="cb682-47"><a href="rule-based-models-of-categorization.html#cb682-47" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <span class="fu">update_weights</span>(particles, weights, current_stimulus, true_category, error_prob)</span>
<span id="cb682-48"><a href="rule-based-models-of-categorization.html#cb682-48" tabindex="-1"></a>    </span>
<span id="cb682-49"><a href="rule-based-models-of-categorization.html#cb682-49" tabindex="-1"></a>    <span class="co"># --- Resampling Step ---</span></span>
<span id="cb682-50"><a href="rule-based-models-of-categorization.html#cb682-50" tabindex="-1"></a>    ess <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sum</span>(weights<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb682-51"><a href="rule-based-models-of-categorization.html#cb682-51" tabindex="-1"></a>    <span class="cf">if</span> (ess <span class="sc">&lt;</span> n_particles <span class="sc">*</span> resample_threshold_factor) {</span>
<span id="cb682-52"><a href="rule-based-models-of-categorization.html#cb682-52" tabindex="-1"></a>      resampled_system <span class="ot">&lt;-</span> <span class="fu">resample_particles</span>(particles, weights)</span>
<span id="cb682-53"><a href="rule-based-models-of-categorization.html#cb682-53" tabindex="-1"></a>      particles <span class="ot">&lt;-</span> resampled_system<span class="sc">$</span>particles</span>
<span id="cb682-54"><a href="rule-based-models-of-categorization.html#cb682-54" tabindex="-1"></a>      weights <span class="ot">&lt;-</span> resampled_system<span class="sc">$</span>weights</span>
<span id="cb682-55"><a href="rule-based-models-of-categorization.html#cb682-55" tabindex="-1"></a>    }</span>
<span id="cb682-56"><a href="rule-based-models-of-categorization.html#cb682-56" tabindex="-1"></a>  } <span class="co"># End trial loop</span></span>
<span id="cb682-57"><a href="rule-based-models-of-categorization.html#cb682-57" tabindex="-1"></a>  </span>
<span id="cb682-58"><a href="rule-based-models-of-categorization.html#cb682-58" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">bind_rows</span>(rule_trajectory_list))</span>
<span id="cb682-59"><a href="rule-based-models-of-categorization.html#cb682-59" tabindex="-1"></a>}</span>
<span id="cb682-60"><a href="rule-based-models-of-categorization.html#cb682-60" tabindex="-1"></a></span>
<span id="cb682-61"><a href="rule-based-models-of-categorization.html#cb682-61" tabindex="-1"></a><span class="co"># --- Run Rule Tracking ---</span></span>
<span id="cb682-62"><a href="rule-based-models-of-categorization.html#cb682-62" tabindex="-1"></a><span class="co"># Track rule learning for visualization (use fewer particles for faster tracking)</span></span>
<span id="cb682-63"><a href="rule-based-models-of-categorization.html#cb682-63" tabindex="-1"></a>rule_tracking_data <span class="ot">&lt;-</span> <span class="fu">track_rule_learning</span>(</span>
<span id="cb682-64"><a href="rule-based-models-of-categorization.html#cb682-64" tabindex="-1"></a>  <span class="at">n_particles =</span> <span class="dv">100</span>, <span class="co"># Fewer particles OK for visualization</span></span>
<span id="cb682-65"><a href="rule-based-models-of-categorization.html#cb682-65" tabindex="-1"></a>  <span class="at">error_prob =</span> <span class="fl">0.1</span>,</span>
<span id="cb682-66"><a href="rule-based-models-of-categorization.html#cb682-66" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">as.matrix</span>(experiment[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb682-67"><a href="rule-based-models-of-categorization.html#cb682-67" tabindex="-1"></a>  <span class="at">cat_one =</span> experiment<span class="sc">$</span>category,</span>
<span id="cb682-68"><a href="rule-based-models-of-categorization.html#cb682-68" tabindex="-1"></a>  <span class="at">max_dims =</span> <span class="dv">2</span>, <span class="co"># Allow 2D rules</span></span>
<span id="cb682-69"><a href="rule-based-models-of-categorization.html#cb682-69" tabindex="-1"></a>  <span class="at">top_k =</span> <span class="dv">1</span> <span class="co"># Track only the single best rule at each step</span></span>
<span id="cb682-70"><a href="rule-based-models-of-categorization.html#cb682-70" tabindex="-1"></a>)</span>
<span id="cb682-71"><a href="rule-based-models-of-categorization.html#cb682-71" tabindex="-1"></a></span>
<span id="cb682-72"><a href="rule-based-models-of-categorization.html#cb682-72" tabindex="-1"></a><span class="co"># --- Visualize Top Rule Evolution ---</span></span>
<span id="cb682-73"><a href="rule-based-models-of-categorization.html#cb682-73" tabindex="-1"></a><span class="co"># Create a function to convert tracked rule info to human-readable text</span></span>
<span id="cb682-74"><a href="rule-based-models-of-categorization.html#cb682-74" tabindex="-1"></a>rule_to_text <span class="ot">&lt;-</span> <span class="cf">function</span>(rule_row) {</span>
<span id="cb682-75"><a href="rule-based-models-of-categorization.html#cb682-75" tabindex="-1"></a>  <span class="co"># Map dimension indices to names (adjust if features change)</span></span>
<span id="cb682-76"><a href="rule-based-models-of-categorization.html#cb682-76" tabindex="-1"></a>  dim_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Position&quot;</span>) </span>
<span id="cb682-77"><a href="rule-based-models-of-categorization.html#cb682-77" tabindex="-1"></a>  </span>
<span id="cb682-78"><a href="rule-based-models-of-categorization.html#cb682-78" tabindex="-1"></a>  <span class="co"># Format 1D rules</span></span>
<span id="cb682-79"><a href="rule-based-models-of-categorization.html#cb682-79" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(rule_row<span class="sc">$</span>dimension2)) {</span>
<span id="cb682-80"><a href="rule-based-models-of-categorization.html#cb682-80" tabindex="-1"></a>    dim_name <span class="ot">&lt;-</span> dim_names[rule_row<span class="sc">$</span>dimension1]</span>
<span id="cb682-81"><a href="rule-based-models-of-categorization.html#cb682-81" tabindex="-1"></a>    rule_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;IF %s %s %.1f THEN Cat %d&quot;</span>, </span>
<span id="cb682-82"><a href="rule-based-models-of-categorization.html#cb682-82" tabindex="-1"></a>                         dim_name, rule_row<span class="sc">$</span>operation1, rule_row<span class="sc">$</span>threshold1, </span>
<span id="cb682-83"><a href="rule-based-models-of-categorization.html#cb682-83" tabindex="-1"></a>                         rule_row<span class="sc">$</span>prediction)</span>
<span id="cb682-84"><a href="rule-based-models-of-categorization.html#cb682-84" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="co"># Format 2D rules</span></span>
<span id="cb682-85"><a href="rule-based-models-of-categorization.html#cb682-85" tabindex="-1"></a>    dim1_name <span class="ot">&lt;-</span> dim_names[rule_row<span class="sc">$</span>dimension1]</span>
<span id="cb682-86"><a href="rule-based-models-of-categorization.html#cb682-86" tabindex="-1"></a>    dim2_name <span class="ot">&lt;-</span> dim_names[rule_row<span class="sc">$</span>dimension2]</span>
<span id="cb682-87"><a href="rule-based-models-of-categorization.html#cb682-87" tabindex="-1"></a>    rule_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;IF %s %s %.1f %s %s %s %.1f THEN Cat %d&quot;</span>, </span>
<span id="cb682-88"><a href="rule-based-models-of-categorization.html#cb682-88" tabindex="-1"></a>                         dim1_name, rule_row<span class="sc">$</span>operation1, rule_row<span class="sc">$</span>threshold1,</span>
<span id="cb682-89"><a href="rule-based-models-of-categorization.html#cb682-89" tabindex="-1"></a>                         rule_row<span class="sc">$</span>logic,</span>
<span id="cb682-90"><a href="rule-based-models-of-categorization.html#cb682-90" tabindex="-1"></a>                         dim2_name, rule_row<span class="sc">$</span>operation2, rule_row<span class="sc">$</span>threshold2, </span>
<span id="cb682-91"><a href="rule-based-models-of-categorization.html#cb682-91" tabindex="-1"></a>                         rule_row<span class="sc">$</span>prediction)</span>
<span id="cb682-92"><a href="rule-based-models-of-categorization.html#cb682-92" tabindex="-1"></a>  }</span>
<span id="cb682-93"><a href="rule-based-models-of-categorization.html#cb682-93" tabindex="-1"></a>  <span class="fu">return</span>(rule_text)</span>
<span id="cb682-94"><a href="rule-based-models-of-categorization.html#cb682-94" tabindex="-1"></a>}</span>
<span id="cb682-95"><a href="rule-based-models-of-categorization.html#cb682-95" tabindex="-1"></a></span>
<span id="cb682-96"><a href="rule-based-models-of-categorization.html#cb682-96" tabindex="-1"></a><span class="co"># Add rule text to our tracking data</span></span>
<span id="cb682-97"><a href="rule-based-models-of-categorization.html#cb682-97" tabindex="-1"></a>rule_tracking_plot_data <span class="ot">&lt;-</span> rule_tracking_data <span class="sc">%&gt;%</span></span>
<span id="cb682-98"><a href="rule-based-models-of-categorization.html#cb682-98" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># Focus on the top-ranked rule</span></span>
<span id="cb682-99"><a href="rule-based-models-of-categorization.html#cb682-99" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb682-100"><a href="rule-based-models-of-categorization.html#cb682-100" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rule_text =</span> <span class="fu">rule_to_text</span>(<span class="fu">cur_data</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb682-101"><a href="rule-based-models-of-categorization.html#cb682-101" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb682-102"><a href="rule-based-models-of-categorization.html#cb682-102" tabindex="-1"></a>  <span class="co"># Identify blocks where the same rule is dominant</span></span>
<span id="cb682-103"><a href="rule-based-models-of-categorization.html#cb682-103" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rule_block =</span> <span class="fu">consecutive_id</span>(rule_text))</span>
<span id="cb682-104"><a href="rule-based-models-of-categorization.html#cb682-104" tabindex="-1"></a></span>
<span id="cb682-105"><a href="rule-based-models-of-categorization.html#cb682-105" tabindex="-1"></a><span class="co"># Create plot showing the weight of the top rule over time</span></span>
<span id="cb682-106"><a href="rule-based-models-of-categorization.html#cb682-106" tabindex="-1"></a><span class="fu">ggplot</span>(rule_tracking_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb682-107"><a href="rule-based-models-of-categorization.html#cb682-107" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span> <span class="co"># Line showing weight trajectory</span></span>
<span id="cb682-108"><a href="rule-based-models-of-categorization.html#cb682-108" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb682-109"><a href="rule-based-models-of-categorization.html#cb682-109" tabindex="-1"></a>  <span class="co"># Add text label for the rule, placed strategically</span></span>
<span id="cb682-110"><a href="rule-based-models-of-categorization.html#cb682-110" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(rule_block, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>), <span class="co"># Label only once per block</span></span>
<span id="cb682-111"><a href="rule-based-models-of-categorization.html#cb682-111" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> rule_text), </span>
<span id="cb682-112"><a href="rule-based-models-of-categorization.html#cb682-112" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb682-113"><a href="rule-based-models-of-categorization.html#cb682-113" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">name =</span> <span class="st">&quot;Weight (Probability) of Top Rule&quot;</span>) <span class="sc">+</span></span>
<span id="cb682-114"><a href="rule-based-models-of-categorization.html#cb682-114" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(experiment) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># Add space for labels</span></span>
<span id="cb682-115"><a href="rule-based-models-of-categorization.html#cb682-115" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb682-116"><a href="rule-based-models-of-categorization.html#cb682-116" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Evolution of the Top Rule Hypothesis Over Time&quot;</span>,</span>
<span id="cb682-117"><a href="rule-based-models-of-categorization.html#cb682-117" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Line shows the probability assigned to the single best rule at each trial.&quot;</span>,</span>
<span id="cb682-118"><a href="rule-based-models-of-categorization.html#cb682-118" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial Number&quot;</span></span>
<span id="cb682-119"><a href="rule-based-models-of-categorization.html#cb682-119" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb682-120"><a href="rule-based-models-of-categorization.html#cb682-120" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-80-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Rule Evolution Interpretation: This plot shows how the model’s belief (weight) in its single best rule hypothesis changes over trials. We can see periods where one rule dominates (high weight) and transitions where the model might be uncertain or switching between competing rules. The text labels identify the specific rule currently considered most likely.</p>
</div>
<div id="visualizing-the-decision-boundary" class="section level3 hasAnchor" number="14.4.2">
<h3><span class="header-section-number">14.4.2</span> Visualizing the Decision Boundary<a href="rule-based-models-of-categorization.html#visualizing-the-decision-boundary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rule-based models typically create axis-aligned, rectangular decision boundaries. Let’s visualize the boundary created by the final, most probable rule found by the particle filter.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="rule-based-models-of-categorization.html#cb683-1" tabindex="-1"></a><span class="co"># Function to get predictions across a grid for the *final* state of the particle filter</span></span>
<span id="cb683-2"><a href="rule-based-models-of-categorization.html#cb683-2" tabindex="-1"></a><span class="co"># (This requires running the filter and extracting the final particle set)</span></span>
<span id="cb683-3"><a href="rule-based-models-of-categorization.html#cb683-3" tabindex="-1"></a>get_final_rule_predictions <span class="ot">&lt;-</span> <span class="cf">function</span>(n_particles, error_prob, obs_train, cat_one_train, </span>
<span id="cb683-4"><a href="rule-based-models-of-categorization.html#cb683-4" tabindex="-1"></a>                                       grid_points, <span class="at">max_dims =</span> <span class="dv">2</span>) {</span>
<span id="cb683-5"><a href="rule-based-models-of-categorization.html#cb683-5" tabindex="-1"></a>    </span>
<span id="cb683-6"><a href="rule-based-models-of-categorization.html#cb683-6" tabindex="-1"></a>    n_trials_train <span class="ot">&lt;-</span> <span class="fu">nrow</span>(obs_train)</span>
<span id="cb683-7"><a href="rule-based-models-of-categorization.html#cb683-7" tabindex="-1"></a>    n_features_train <span class="ot">&lt;-</span> <span class="fu">ncol</span>(obs_train)</span>
<span id="cb683-8"><a href="rule-based-models-of-categorization.html#cb683-8" tabindex="-1"></a>    feature_range <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) </span>
<span id="cb683-9"><a href="rule-based-models-of-categorization.html#cb683-9" tabindex="-1"></a>    </span>
<span id="cb683-10"><a href="rule-based-models-of-categorization.html#cb683-10" tabindex="-1"></a>    <span class="co"># Run the particle filter to get the final state</span></span>
<span id="cb683-11"><a href="rule-based-models-of-categorization.html#cb683-11" tabindex="-1"></a>    <span class="co"># Initialize</span></span>
<span id="cb683-12"><a href="rule-based-models-of-categorization.html#cb683-12" tabindex="-1"></a>    particle_system <span class="ot">&lt;-</span> <span class="fu">initialize_particles</span>(n_particles, n_features_train, max_dims, feature_range)</span>
<span id="cb683-13"><a href="rule-based-models-of-categorization.html#cb683-13" tabindex="-1"></a>    particles <span class="ot">&lt;-</span> particle_system<span class="sc">$</span>particles</span>
<span id="cb683-14"><a href="rule-based-models-of-categorization.html#cb683-14" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> particle_system<span class="sc">$</span>weights</span>
<span id="cb683-15"><a href="rule-based-models-of-categorization.html#cb683-15" tabindex="-1"></a>    </span>
<span id="cb683-16"><a href="rule-based-models-of-categorization.html#cb683-16" tabindex="-1"></a>    <span class="co"># Train the filter</span></span>
<span id="cb683-17"><a href="rule-based-models-of-categorization.html#cb683-17" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials_train) {</span>
<span id="cb683-18"><a href="rule-based-models-of-categorization.html#cb683-18" tabindex="-1"></a>        current_stimulus <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs_train[i, ])</span>
<span id="cb683-19"><a href="rule-based-models-of-categorization.html#cb683-19" tabindex="-1"></a>        true_category <span class="ot">&lt;-</span> cat_one_train[i]</span>
<span id="cb683-20"><a href="rule-based-models-of-categorization.html#cb683-20" tabindex="-1"></a>        weights <span class="ot">&lt;-</span> <span class="fu">update_weights</span>(particles, weights, current_stimulus, true_category, error_prob)</span>
<span id="cb683-21"><a href="rule-based-models-of-categorization.html#cb683-21" tabindex="-1"></a>        ess <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sum</span>(weights<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb683-22"><a href="rule-based-models-of-categorization.html#cb683-22" tabindex="-1"></a>        <span class="cf">if</span> (ess <span class="sc">&lt;</span> n_particles <span class="sc">*</span> <span class="fl">0.5</span>) {</span>
<span id="cb683-23"><a href="rule-based-models-of-categorization.html#cb683-23" tabindex="-1"></a>            resampled_system <span class="ot">&lt;-</span> <span class="fu">resample_particles</span>(particles, weights)</span>
<span id="cb683-24"><a href="rule-based-models-of-categorization.html#cb683-24" tabindex="-1"></a>            particles <span class="ot">&lt;-</span> resampled_system<span class="sc">$</span>particles</span>
<span id="cb683-25"><a href="rule-based-models-of-categorization.html#cb683-25" tabindex="-1"></a>            weights <span class="ot">&lt;-</span> resampled_system<span class="sc">$</span>weights</span>
<span id="cb683-26"><a href="rule-based-models-of-categorization.html#cb683-26" tabindex="-1"></a>        }</span>
<span id="cb683-27"><a href="rule-based-models-of-categorization.html#cb683-27" tabindex="-1"></a>    }</span>
<span id="cb683-28"><a href="rule-based-models-of-categorization.html#cb683-28" tabindex="-1"></a>    </span>
<span id="cb683-29"><a href="rule-based-models-of-categorization.html#cb683-29" tabindex="-1"></a>    <span class="co"># Now, use the final particles and weights to predict on the grid</span></span>
<span id="cb683-30"><a href="rule-based-models-of-categorization.html#cb683-30" tabindex="-1"></a>    grid_predictions <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(grid_points), <span class="dv">1</span>, <span class="cf">function</span>(point) {</span>
<span id="cb683-31"><a href="rule-based-models-of-categorization.html#cb683-31" tabindex="-1"></a>        rule_preds <span class="ot">&lt;-</span> <span class="fu">sapply</span>(particles, evaluate_rule, <span class="at">stimulus =</span> point)</span>
<span id="cb683-32"><a href="rule-based-models-of-categorization.html#cb683-32" tabindex="-1"></a>        <span class="co"># Calculate weighted probability of predicting category 1</span></span>
<span id="cb683-33"><a href="rule-based-models-of-categorization.html#cb683-33" tabindex="-1"></a>        prob_cat1_given_rules <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rule_preds <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">-</span> error_prob, error_prob)</span>
<span id="cb683-34"><a href="rule-based-models-of-categorization.html#cb683-34" tabindex="-1"></a>        prob_cat1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(weights <span class="sc">*</span> prob_cat1_given_rules)</span>
<span id="cb683-35"><a href="rule-based-models-of-categorization.html#cb683-35" tabindex="-1"></a>        <span class="fu">return</span>(prob_cat1)</span>
<span id="cb683-36"><a href="rule-based-models-of-categorization.html#cb683-36" tabindex="-1"></a>    })</span>
<span id="cb683-37"><a href="rule-based-models-of-categorization.html#cb683-37" tabindex="-1"></a>    </span>
<span id="cb683-38"><a href="rule-based-models-of-categorization.html#cb683-38" tabindex="-1"></a>    <span class="fu">return</span>(grid_predictions)</span>
<span id="cb683-39"><a href="rule-based-models-of-categorization.html#cb683-39" tabindex="-1"></a>}</span>
<span id="cb683-40"><a href="rule-based-models-of-categorization.html#cb683-40" tabindex="-1"></a></span>
<span id="cb683-41"><a href="rule-based-models-of-categorization.html#cb683-41" tabindex="-1"></a></span>
<span id="cb683-42"><a href="rule-based-models-of-categorization.html#cb683-42" tabindex="-1"></a><span class="co"># Create a grid of points in the stimulus space</span></span>
<span id="cb683-43"><a href="rule-based-models-of-categorization.html#cb683-43" tabindex="-1"></a>grid_points <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb683-44"><a href="rule-based-models-of-categorization.html#cb683-44" tabindex="-1"></a>  <span class="co"># Use feature names consistent with &#39;experiment&#39; data</span></span>
<span id="cb683-45"><a href="rule-based-models-of-categorization.html#cb683-45" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">seq</span>(<span class="fu">min</span>(stimuli<span class="sc">$</span>height) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="fu">max</span>(stimuli<span class="sc">$</span>height) <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb683-46"><a href="rule-based-models-of-categorization.html#cb683-46" tabindex="-1"></a>  <span class="at">position =</span> <span class="fu">seq</span>(<span class="fu">min</span>(stimuli<span class="sc">$</span>position) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="fu">max</span>(stimuli<span class="sc">$</span>position) <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb683-47"><a href="rule-based-models-of-categorization.html#cb683-47" tabindex="-1"></a>)</span>
<span id="cb683-48"><a href="rule-based-models-of-categorization.html#cb683-48" tabindex="-1"></a></span>
<span id="cb683-49"><a href="rule-based-models-of-categorization.html#cb683-49" tabindex="-1"></a><span class="co"># Get predictions across the grid using the final state of a trained filter</span></span>
<span id="cb683-50"><a href="rule-based-models-of-categorization.html#cb683-50" tabindex="-1"></a>rule_grid_preds <span class="ot">&lt;-</span> <span class="fu">get_final_rule_predictions</span>(</span>
<span id="cb683-51"><a href="rule-based-models-of-categorization.html#cb683-51" tabindex="-1"></a>  <span class="at">n_particles =</span> <span class="dv">200</span>, <span class="co"># Use a reasonable number of particles</span></span>
<span id="cb683-52"><a href="rule-based-models-of-categorization.html#cb683-52" tabindex="-1"></a>  <span class="at">error_prob =</span> <span class="fl">0.1</span>,</span>
<span id="cb683-53"><a href="rule-based-models-of-categorization.html#cb683-53" tabindex="-1"></a>  <span class="at">obs_train =</span> <span class="fu">as.matrix</span>(experiment[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)]),</span>
<span id="cb683-54"><a href="rule-based-models-of-categorization.html#cb683-54" tabindex="-1"></a>  <span class="at">cat_one_train =</span> experiment<span class="sc">$</span>category,</span>
<span id="cb683-55"><a href="rule-based-models-of-categorization.html#cb683-55" tabindex="-1"></a>  <span class="at">grid_points =</span> grid_points[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;position&quot;</span>)], <span class="co"># Pass grid features in correct order</span></span>
<span id="cb683-56"><a href="rule-based-models-of-categorization.html#cb683-56" tabindex="-1"></a>  <span class="at">max_dims =</span> <span class="dv">2</span></span>
<span id="cb683-57"><a href="rule-based-models-of-categorization.html#cb683-57" tabindex="-1"></a>)</span>
<span id="cb683-58"><a href="rule-based-models-of-categorization.html#cb683-58" tabindex="-1"></a></span>
<span id="cb683-59"><a href="rule-based-models-of-categorization.html#cb683-59" tabindex="-1"></a><span class="co"># Add predictions to the grid data</span></span>
<span id="cb683-60"><a href="rule-based-models-of-categorization.html#cb683-60" tabindex="-1"></a>grid_decision_data <span class="ot">&lt;-</span> grid_points <span class="sc">%&gt;%</span></span>
<span id="cb683-61"><a href="rule-based-models-of-categorization.html#cb683-61" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb683-62"><a href="rule-based-models-of-categorization.html#cb683-62" tabindex="-1"></a>    <span class="at">rule_prob_cat1 =</span> rule_grid_preds,</span>
<span id="cb683-63"><a href="rule-based-models-of-categorization.html#cb683-63" tabindex="-1"></a>    <span class="at">rule_decision =</span> <span class="fu">ifelse</span>(rule_prob_cat1 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Predicted category</span></span>
<span id="cb683-64"><a href="rule-based-models-of-categorization.html#cb683-64" tabindex="-1"></a>  )</span>
<span id="cb683-65"><a href="rule-based-models-of-categorization.html#cb683-65" tabindex="-1"></a></span>
<span id="cb683-66"><a href="rule-based-models-of-categorization.html#cb683-66" tabindex="-1"></a><span class="co"># Visualize the decision boundary</span></span>
<span id="cb683-67"><a href="rule-based-models-of-categorization.html#cb683-67" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb683-68"><a href="rule-based-models-of-categorization.html#cb683-68" tabindex="-1"></a>  <span class="co"># Background color based on predicted category</span></span>
<span id="cb683-69"><a href="rule-based-models-of-categorization.html#cb683-69" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> grid_decision_data, </span>
<span id="cb683-70"><a href="rule-based-models-of-categorization.html#cb683-70" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> height, <span class="at">fill =</span> <span class="fu">factor</span>(rule_decision)), </span>
<span id="cb683-71"><a href="rule-based-models-of-categorization.html#cb683-71" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb683-72"><a href="rule-based-models-of-categorization.html#cb683-72" tabindex="-1"></a>  </span>
<span id="cb683-73"><a href="rule-based-models-of-categorization.html#cb683-73" tabindex="-1"></a>  <span class="co"># Contour line at the 0.5 probability boundary</span></span>
<span id="cb683-74"><a href="rule-based-models-of-categorization.html#cb683-74" tabindex="-1"></a>  <span class="fu">stat_contour</span>(<span class="at">data =</span> grid_decision_data, </span>
<span id="cb683-75"><a href="rule-based-models-of-categorization.html#cb683-75" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> height, <span class="at">z =</span> rule_prob_cat1),</span>
<span id="cb683-76"><a href="rule-based-models-of-categorization.html#cb683-76" tabindex="-1"></a>               <span class="at">breaks =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb683-77"><a href="rule-based-models-of-categorization.html#cb683-77" tabindex="-1"></a>  </span>
<span id="cb683-78"><a href="rule-based-models-of-categorization.html#cb683-78" tabindex="-1"></a>  <span class="co"># Actual stimuli points</span></span>
<span id="cb683-79"><a href="rule-based-models-of-categorization.html#cb683-79" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> stimuli, </span>
<span id="cb683-80"><a href="rule-based-models-of-categorization.html#cb683-80" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> height, <span class="at">color =</span> <span class="fu">factor</span>(category), <span class="at">shape =</span> <span class="fu">factor</span>(category)),</span>
<span id="cb683-81"><a href="rule-based-models-of-categorization.html#cb683-81" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb683-82"><a href="rule-based-models-of-categorization.html#cb683-82" tabindex="-1"></a>  </span>
<span id="cb683-83"><a href="rule-based-models-of-categorization.html#cb683-83" tabindex="-1"></a>  <span class="co"># Labels and theme</span></span>
<span id="cb683-84"><a href="rule-based-models-of-categorization.html#cb683-84" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;skyblue&quot;</span>), <span class="at">name =</span> <span class="st">&quot;Predicted Cat&quot;</span>) <span class="sc">+</span></span>
<span id="cb683-85"><a href="rule-based-models-of-categorization.html#cb683-85" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;True Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb683-86"><a href="rule-based-models-of-categorization.html#cb683-86" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name =</span> <span class="st">&quot;True Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb683-87"><a href="rule-based-models-of-categorization.html#cb683-87" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb683-88"><a href="rule-based-models-of-categorization.html#cb683-88" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Rule-Based Model Decision Boundary (Particle Filter)&quot;</span>,</span>
<span id="cb683-89"><a href="rule-based-models-of-categorization.html#cb683-89" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Boundary based on weighted average of final particle set (N=200, error=0.1)&quot;</span>,</span>
<span id="cb683-90"><a href="rule-based-models-of-categorization.html#cb683-90" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Position Feature&quot;</span>,</span>
<span id="cb683-91"><a href="rule-based-models-of-categorization.html#cb683-91" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Height Feature&quot;</span></span>
<span id="cb683-92"><a href="rule-based-models-of-categorization.html#cb683-92" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb683-93"><a href="rule-based-models-of-categorization.html#cb683-93" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb683-94"><a href="rule-based-models-of-categorization.html#cb683-94" tabindex="-1"></a>   <span class="fu">coord_cartesian</span>(</span>
<span id="cb683-95"><a href="rule-based-models-of-categorization.html#cb683-95" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">range</span>(grid_decision_data<span class="sc">$</span>position),</span>
<span id="cb683-96"><a href="rule-based-models-of-categorization.html#cb683-96" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">range</span>(grid_decision_data<span class="sc">$</span>height)</span>
<span id="cb683-97"><a href="rule-based-models-of-categorization.html#cb683-97" tabindex="-1"></a>   )</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-81-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Boundary Interpretation: This plot shows the characteristic decision boundary produced by the rule-based particle filter. It’s often composed of axis-aligned segments, reflecting the nature of the underlying rule hypotheses. The background color shows the predicted category for each point in the feature space, based on the weighted vote of the final set of rule particles. The black contour line marks the 50% probability threshold.</p>
</div>
</div>
<div id="implementing-rule-based-logic-in-stan-simplified" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> Implementing Rule-Based Logic in Stan (Simplified)<a href="rule-based-models-of-categorization.html#implementing-rule-based-logic-in-stan-simplified" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fitting the dynamic particle filter directly in Stan is complex due to its discrete nature and resampling steps. However, we can implement a simplified Stan model to estimate global parameters related to rule use, assuming a fixed, predefined set of candidate rules.</p>
<p>Important: This Stan model does not implement the particle filter learning process. Instead, it evaluates how well a few specific, hand-coded rules explain the entire dataset, potentially estimating parameters like a general error_prob or a preference for simpler vs. complex rules (complexity_weight).</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb684-1"><a href="rule-based-models-of-categorization.html#cb684-1" tabindex="-1"></a><span class="co">// Stan Code: Simplified Rule Model (W13_rule_simplified.stan)</span></span>
<span id="cb684-2"><a href="rule-based-models-of-categorization.html#cb684-2" tabindex="-1"></a><span class="co">// </span><span class="al">NOTE</span><span class="co">: This model evaluates a FIXED set of predefined rules. </span></span>
<span id="cb684-3"><a href="rule-based-models-of-categorization.html#cb684-3" tabindex="-1"></a><span class="co">// It does NOT implement the dynamic particle filter learning process.</span></span>
<span id="cb684-4"><a href="rule-based-models-of-categorization.html#cb684-4" tabindex="-1"></a><span class="co">// Its purpose is limited, e.g., estimating global error rate assuming these rules.</span></span>
<span id="cb684-5"><a href="rule-based-models-of-categorization.html#cb684-5" tabindex="-1"></a></span>
<span id="cb684-6"><a href="rule-based-models-of-categorization.html#cb684-6" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb684-7"><a href="rule-based-models-of-categorization.html#cb684-7" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; ntrials;               <span class="co">// Number of trials</span></span>
<span id="cb684-8"><a href="rule-based-models-of-categorization.html#cb684-8" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; nfeatures;             <span class="co">// Number of feature dimensions (must be 2 for this example)</span></span>
<span id="cb684-9"><a href="rule-based-models-of-categorization.html#cb684-9" tabindex="-1"></a>  <span class="dt">array</span>[ntrials] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; cat_one;  <span class="co">// True category labels (used for likelihood only here)</span></span>
<span id="cb684-10"><a href="rule-based-models-of-categorization.html#cb684-10" tabindex="-1"></a>  <span class="dt">array</span>[ntrials] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; y;        <span class="co">// Observed decisions</span></span>
<span id="cb684-11"><a href="rule-based-models-of-categorization.html#cb684-11" tabindex="-1"></a>  <span class="dt">array</span>[ntrials, nfeatures] <span class="dt">real</span> obs;  <span class="co">// Stimulus features (obs[,1]=Height, obs[,2]=Position)</span></span>
<span id="cb684-12"><a href="rule-based-models-of-categorization.html#cb684-12" tabindex="-1"></a>}</span>
<span id="cb684-13"><a href="rule-based-models-of-categorization.html#cb684-13" tabindex="-1"></a></span>
<span id="cb684-14"><a href="rule-based-models-of-categorization.html#cb684-14" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb684-15"><a href="rule-based-models-of-categorization.html#cb684-15" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="fl">0.001</span>, <span class="kw">upper</span>=<span class="fl">0.999</span>&gt; error_prob; <span class="co">// Global error probability</span></span>
<span id="cb684-16"><a href="rule-based-models-of-categorization.html#cb684-16" tabindex="-1"></a>  <span class="co">// Optional: Parameter representing preference for complex (2D) rules</span></span>
<span id="cb684-17"><a href="rule-based-models-of-categorization.html#cb684-17" tabindex="-1"></a>  <span class="co">// real complexity_weight; // e.g., normal(0,1) prior; positive favors complex</span></span>
<span id="cb684-18"><a href="rule-based-models-of-categorization.html#cb684-18" tabindex="-1"></a>}</span>
<span id="cb684-19"><a href="rule-based-models-of-categorization.html#cb684-19" tabindex="-1"></a></span>
<span id="cb684-20"><a href="rule-based-models-of-categorization.html#cb684-20" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb684-21"><a href="rule-based-models-of-categorization.html#cb684-21" tabindex="-1"></a>  <span class="co">// --- Priors ---</span></span>
<span id="cb684-22"><a href="rule-based-models-of-categorization.html#cb684-22" tabindex="-1"></a>  <span class="co">// Prior for error probability (e.g., favoring low error)</span></span>
<span id="cb684-23"><a href="rule-based-models-of-categorization.html#cb684-23" tabindex="-1"></a>  <span class="kw">target +=</span> beta_lpdf(error_prob | <span class="fl">1.1</span>, <span class="dv">10</span>); <span class="co">// Weakly informative prior favoring lower error</span></span>
<span id="cb684-24"><a href="rule-based-models-of-categorization.html#cb684-24" tabindex="-1"></a>  <span class="co">// Optional prior for complexity weight</span></span>
<span id="cb684-25"><a href="rule-based-models-of-categorization.html#cb684-25" tabindex="-1"></a>  <span class="co">// target += normal_lpdf(complexity_weight | 0, 1); </span></span>
<span id="cb684-26"><a href="rule-based-models-of-categorization.html#cb684-26" tabindex="-1"></a></span>
<span id="cb684-27"><a href="rule-based-models-of-categorization.html#cb684-27" tabindex="-1"></a>  <span class="co">// --- Likelihood Calculation ---</span></span>
<span id="cb684-28"><a href="rule-based-models-of-categorization.html#cb684-28" tabindex="-1"></a>  <span class="co">// This calculates the likelihood averaged over a FIXED set of candidate rules.</span></span>
<span id="cb684-29"><a href="rule-based-models-of-categorization.html#cb684-29" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:ntrials) {</span>
<span id="cb684-30"><a href="rule-based-models-of-categorization.html#cb684-30" tabindex="-1"></a>    <span class="co">// Log probabilities for each predefined rule predicting the OBSERVED choice y[i]</span></span>
<span id="cb684-31"><a href="rule-based-models-of-categorization.html#cb684-31" tabindex="-1"></a>    <span class="dt">vector</span>[<span class="dv">4</span>] log_prob_rules; </span>
<span id="cb684-32"><a href="rule-based-models-of-categorization.html#cb684-32" tabindex="-1"></a>    </span>
<span id="cb684-33"><a href="rule-based-models-of-categorization.html#cb684-33" tabindex="-1"></a>    <span class="co">// --- Define the FIXED set of candidate rules ---</span></span>
<span id="cb684-34"><a href="rule-based-models-of-categorization.html#cb684-34" tabindex="-1"></a>    <span class="co">// Rule 1: Height &gt; 2.5 =&gt; Predicts Cat 1</span></span>
<span id="cb684-35"><a href="rule-based-models-of-categorization.html#cb684-35" tabindex="-1"></a>    <span class="dt">int</span> pred1 = obs[i, <span class="dv">1</span>] &gt; <span class="fl">2.5</span> ? <span class="dv">1</span> : <span class="dv">0</span>;</span>
<span id="cb684-36"><a href="rule-based-models-of-categorization.html#cb684-36" tabindex="-1"></a>    log_prob_rules[<span class="dv">1</span>] = bernoulli_lpmf(y[i] | pred1 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-37"><a href="rule-based-models-of-categorization.html#cb684-37" tabindex="-1"></a>    <span class="co">// Add complexity penalty/bonus (0 for 1D rules)</span></span>
<span id="cb684-38"><a href="rule-based-models-of-categorization.html#cb684-38" tabindex="-1"></a>    <span class="co">// log_prob_rules[1] += 0; </span></span>
<span id="cb684-39"><a href="rule-based-models-of-categorization.html#cb684-39" tabindex="-1"></a></span>
<span id="cb684-40"><a href="rule-based-models-of-categorization.html#cb684-40" tabindex="-1"></a>    <span class="co">// Rule 2: Position &lt; 2.5 =&gt; Predicts Cat 1 </span></span>
<span id="cb684-41"><a href="rule-based-models-of-categorization.html#cb684-41" tabindex="-1"></a>    <span class="dt">int</span> pred2 = obs[i, <span class="dv">2</span>] &lt; <span class="fl">2.5</span> ? <span class="dv">1</span> : <span class="dv">0</span>; </span>
<span id="cb684-42"><a href="rule-based-models-of-categorization.html#cb684-42" tabindex="-1"></a>    log_prob_rules[<span class="dv">2</span>] = bernoulli_lpmf(y[i] | pred2 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-43"><a href="rule-based-models-of-categorization.html#cb684-43" tabindex="-1"></a>    <span class="co">// log_prob_rules[2] += 0; </span></span>
<span id="cb684-44"><a href="rule-based-models-of-categorization.html#cb684-44" tabindex="-1"></a></span>
<span id="cb684-45"><a href="rule-based-models-of-categorization.html#cb684-45" tabindex="-1"></a>    <span class="co">// Rule 3: Height &gt; 2.0 AND Position &gt; 3.0 =&gt; Predicts Cat 1</span></span>
<span id="cb684-46"><a href="rule-based-models-of-categorization.html#cb684-46" tabindex="-1"></a>    <span class="dt">int</span> pred3 = (obs[i, <span class="dv">1</span>] &gt; <span class="fl">2.0</span> &amp;&amp; obs[i, <span class="dv">2</span>] &gt; <span class="fl">3.0</span>) ? <span class="dv">1</span> : <span class="dv">0</span>;</span>
<span id="cb684-47"><a href="rule-based-models-of-categorization.html#cb684-47" tabindex="-1"></a>    log_prob_rules[<span class="dv">3</span>] = bernoulli_lpmf(y[i] | pred3 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-48"><a href="rule-based-models-of-categorization.html#cb684-48" tabindex="-1"></a>    <span class="co">// Optional: Add complexity weight for 2D rules</span></span>
<span id="cb684-49"><a href="rule-based-models-of-categorization.html#cb684-49" tabindex="-1"></a>    <span class="co">// log_prob_rules[3] += complexity_weight; </span></span>
<span id="cb684-50"><a href="rule-based-models-of-categorization.html#cb684-50" tabindex="-1"></a></span>
<span id="cb684-51"><a href="rule-based-models-of-categorization.html#cb684-51" tabindex="-1"></a>    <span class="co">// Rule 4: Height &lt; 2.0 OR Position &lt; 2.0 =&gt; Predicts Cat 0</span></span>
<span id="cb684-52"><a href="rule-based-models-of-categorization.html#cb684-52" tabindex="-1"></a>    <span class="dt">int</span> pred4 = (obs[i, <span class="dv">1</span>] &lt; <span class="fl">2.0</span> || obs[i, <span class="dv">2</span>] &lt; <span class="fl">2.0</span>) ? <span class="dv">0</span> : <span class="dv">1</span>; <span class="co">// Predicts 0 if condition met</span></span>
<span id="cb684-53"><a href="rule-based-models-of-categorization.html#cb684-53" tabindex="-1"></a>    log_prob_rules[<span class="dv">4</span>] = bernoulli_lpmf(y[i] | pred4 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-54"><a href="rule-based-models-of-categorization.html#cb684-54" tabindex="-1"></a>    <span class="co">// log_prob_rules[4] += complexity_weight; </span></span>
<span id="cb684-55"><a href="rule-based-models-of-categorization.html#cb684-55" tabindex="-1"></a>    </span>
<span id="cb684-56"><a href="rule-based-models-of-categorization.html#cb684-56" tabindex="-1"></a>    <span class="co">// --- Combine Rule Likelihoods ---</span></span>
<span id="cb684-57"><a href="rule-based-models-of-categorization.html#cb684-57" tabindex="-1"></a>    <span class="co">// Assume equal prior probability for each rule (log(1/4) = -log(4))</span></span>
<span id="cb684-58"><a href="rule-based-models-of-categorization.html#cb684-58" tabindex="-1"></a>    <span class="co">// Use log_sum_exp to calculate the marginal likelihood for trial i</span></span>
<span id="cb684-59"><a href="rule-based-models-of-categorization.html#cb684-59" tabindex="-1"></a>    <span class="kw">target +=</span> log_sum_exp(log_prob_rules) - log(<span class="dv">4</span>); </span>
<span id="cb684-60"><a href="rule-based-models-of-categorization.html#cb684-60" tabindex="-1"></a>  }</span>
<span id="cb684-61"><a href="rule-based-models-of-categorization.html#cb684-61" tabindex="-1"></a>}</span>
<span id="cb684-62"><a href="rule-based-models-of-categorization.html#cb684-62" tabindex="-1"></a></span>
<span id="cb684-63"><a href="rule-based-models-of-categorization.html#cb684-63" tabindex="-1"></a><span class="kw">generated quantities</span> {</span>
<span id="cb684-64"><a href="rule-based-models-of-categorization.html#cb684-64" tabindex="-1"></a>  <span class="co">// Optional: Calculate log likelihood per trial for model comparison</span></span>
<span id="cb684-65"><a href="rule-based-models-of-categorization.html#cb684-65" tabindex="-1"></a>  <span class="dt">array</span>[ntrials] <span class="dt">real</span> log_lik;</span>
<span id="cb684-66"><a href="rule-based-models-of-categorization.html#cb684-66" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:ntrials) {</span>
<span id="cb684-67"><a href="rule-based-models-of-categorization.html#cb684-67" tabindex="-1"></a>      <span class="dt">vector</span>[<span class="dv">4</span>] log_prob_rules; </span>
<span id="cb684-68"><a href="rule-based-models-of-categorization.html#cb684-68" tabindex="-1"></a>      <span class="dt">int</span> pred1 = obs[i, <span class="dv">1</span>] &gt; <span class="fl">2.5</span> ? <span class="dv">1</span> : <span class="dv">0</span>;</span>
<span id="cb684-69"><a href="rule-based-models-of-categorization.html#cb684-69" tabindex="-1"></a>      log_prob_rules[<span class="dv">1</span>] = bernoulli_lpmf(y[i] | pred1 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-70"><a href="rule-based-models-of-categorization.html#cb684-70" tabindex="-1"></a>      <span class="dt">int</span> pred2 = obs[i, <span class="dv">2</span>] &lt; <span class="fl">2.5</span> ? <span class="dv">1</span> : <span class="dv">0</span>; </span>
<span id="cb684-71"><a href="rule-based-models-of-categorization.html#cb684-71" tabindex="-1"></a>      log_prob_rules[<span class="dv">2</span>] = bernoulli_lpmf(y[i] | pred2 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-72"><a href="rule-based-models-of-categorization.html#cb684-72" tabindex="-1"></a>      <span class="dt">int</span> pred3 = (obs[i, <span class="dv">1</span>] &gt; <span class="fl">2.0</span> &amp;&amp; obs[i, <span class="dv">2</span>] &gt; <span class="fl">3.0</span>) ? <span class="dv">1</span> : <span class="dv">0</span>;</span>
<span id="cb684-73"><a href="rule-based-models-of-categorization.html#cb684-73" tabindex="-1"></a>      log_prob_rules[<span class="dv">3</span>] = bernoulli_lpmf(y[i] | pred3 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-74"><a href="rule-based-models-of-categorization.html#cb684-74" tabindex="-1"></a>      <span class="dt">int</span> pred4 = (obs[i, <span class="dv">1</span>] &lt; <span class="fl">2.0</span> || obs[i, <span class="dv">2</span>] &lt; <span class="fl">2.0</span>) ? <span class="dv">0</span> : <span class="dv">1</span>;</span>
<span id="cb684-75"><a href="rule-based-models-of-categorization.html#cb684-75" tabindex="-1"></a>      log_prob_rules[<span class="dv">4</span>] = bernoulli_lpmf(y[i] | pred4 == <span class="dv">1</span> ? (<span class="fl">1.0</span> - error_prob) : error_prob);</span>
<span id="cb684-76"><a href="rule-based-models-of-categorization.html#cb684-76" tabindex="-1"></a>      </span>
<span id="cb684-77"><a href="rule-based-models-of-categorization.html#cb684-77" tabindex="-1"></a>      <span class="co">// Optional: Add complexity weights if estimating them</span></span>
<span id="cb684-78"><a href="rule-based-models-of-categorization.html#cb684-78" tabindex="-1"></a>      <span class="co">// log_prob_rules[3] += complexity_weight; </span></span>
<span id="cb684-79"><a href="rule-based-models-of-categorization.html#cb684-79" tabindex="-1"></a>      <span class="co">// log_prob_rules[4] += complexity_weight; </span></span>
<span id="cb684-80"><a href="rule-based-models-of-categorization.html#cb684-80" tabindex="-1"></a></span>
<span id="cb684-81"><a href="rule-based-models-of-categorization.html#cb684-81" tabindex="-1"></a>      log_lik[i] = log_sum_exp(log_prob_rules) - log(<span class="dv">4</span>);</span>
<span id="cb684-82"><a href="rule-based-models-of-categorization.html#cb684-82" tabindex="-1"></a>   }</span>
<span id="cb684-83"><a href="rule-based-models-of-categorization.html#cb684-83" tabindex="-1"></a>}</span></code></pre></div>
<p>Using this Stan model: You would compile and run this like other Stan models, providing the necessary data (ntrials, nfeatures, y, obs). It would provide posterior estimates for error_prob (and complexity_weight if included), assuming the participant’s behavior is best described as an average over the specific rules hardcoded in the model. Its utility depends heavily on choosing a relevant set of candidate rules.</p>
</div>
<div id="cognitive-insights-from-rule-based-models" class="section level2 hasAnchor" number="14.6">
<h2><span class="header-section-number">14.6</span> Cognitive Insights from Rule-Based Models<a href="rule-based-models-of-categorization.html#cognitive-insights-from-rule-based-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Rule-based models, particularly the particle filter implementation, offer several cognitive insights:</p></li>
<li><p>Explicit Hypothesis Testing: They model the process of generating, testing, and refining explicit hypotheses about category structure.</p></li>
<li><p>Abrupt Learning: Performance can change sharply when a highly effective rule is discovered and gains high weight.</p></li>
<li><p>Selective Attention: Attention is modeled as selecting specific dimensions relevant to the current best rules, rather than continuous weighting.</p></li>
<li><p>Verbalizability: The explicit nature of rules often aligns with people’s ability and tendency to verbalize their categorization strategies.</p></li>
<li><p>Individual Differences: Different individuals might converge on different (but potentially equally effective) rules, explaining variations in reported strategies.</p></li>
</ul>
</div>
<div id="strengths-and-limitations" class="section level2 hasAnchor" number="14.7">
<h2><span class="header-section-number">14.7</span> Strengths and Limitations<a href="rule-based-models-of-categorization.html#strengths-and-limitations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Strengths:</p>
<ul>
<li><p>Cognitive Plausibility: Aligns with introspection and verbal reports of using rules.</p></li>
<li><p>Efficiency for Simple Structures: Very effective when categories are defined by simple, logical rules.</p></li>
<li><p>Sharp Boundaries: Naturally captures categories with clear-cut criteria.</p></li>
<li><p>Handles Logic: Easily incorporates logical operators like AND, OR, NOT.</p></li>
</ul>
<p>Limitations:</p>
<ul>
<li><p>Family Resemblance Categories: Struggles with categories defined by overall similarity where no single rule applies to all members (e.g., “game”).</p></li>
<li><p>Complex Boundaries: Requires very complex rules or many simple rules to approximate non-axis-aligned or curved boundaries.</p></li>
<li><p>Graded Typicality: Doesn’t easily explain why some category members seem more typical than others (unless rules have probabilistic application).</p></li>
<li><p>Feature Learning: Standard models assume predefined features; they don’t typically learn which features are relevant from raw input.</p></li>
</ul>
<p>##Conclusion: The Role of Rules</p>
<p>Rule-based models offer a distinct perspective on categorization, emphasizing explicit criteria and logical operations rather than overall similarity. The Bayesian particle filter provides a sophisticated framework for modeling how learners might search the space of possible rules, maintain uncertainty, and update beliefs based on evidence.</p>
<p>While pure rule-based models may not account for all aspects of human categorization (especially for natural categories with fuzzy boundaries), they capture an important element of human cognition, particularly in domains involving definitions, instruction, or well-defined criteria. Often, human behavior might reflect a blend or interplay between rule-based and similarity-based processing, a topic explored in hybrid models (like COVIS or RULEX) and discussed further in the next chapter comparing all three approaches.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prototype-based-models-of-categorization.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/13-CategorizationModelsRules.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
