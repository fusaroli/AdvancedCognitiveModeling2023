<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 The Pizza Experiment | Advanced Cognitive Modeling Notes</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2026" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 The Pizza Experiment | Advanced Cognitive Modeling Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2026" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 The Pizza Experiment | Advanced Cognitive Modeling Notes" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2026" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2026-02-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="building-models-of-strategic-decision-making.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html"><i class="fa fa-check"></i><b>2</b> The Pizza Experiment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="the-pizza-experiment.html"><a href="the-pizza-experiment.html#conclusion-from-pizza-to-cognitive-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Cognitive Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning Goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction-observing-behavior-to-theorize-mechanisms"><i class="fa fa-check"></i><b>3.2</b> Introduction: Observing Behavior to Theorize Mechanisms</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory-identifying-potential-mechanisms"><i class="fa fa-check"></i><b>3.6.1</b> From Observation to Theory: Identifying Potential Mechanisms</a></li>
<li class="chapter" data-level="3.6.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.6.2</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#candidate-verbal-models"><i class="fa fa-check"></i><b>3.7</b> Candidate Verbal Models</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#plausibility-check-cognitive-constraints"><i class="fa fa-check"></i><b>3.7.1</b> Plausibility Check: Cognitive Constraints</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#relationships-between-models"><i class="fa fa-check"></i><b>3.7.2</b> Relationships Between Models</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#handling-heterogeneity-mixture-models"><i class="fa fa-check"></i><b>3.7.3</b> Handling Heterogeneity: Mixture Models</a></li>
<li class="chapter" data-level="3.7.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-modeling-vs.-traditional-statistical-approaches-e.g.-glm"><i class="fa fa-check"></i><b>3.7.4</b> Cognitive Modeling vs. Traditional Statistical Approaches (e.g., GLM)</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#conclusion-from-observations-to-verbal-theories"><i class="fa fa-check"></i><b>3.8</b> Conclusion: From Observations to Verbal Theories</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization-and-simulation"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization and Simulation</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a Random Agent</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#encapsulating-the-agent-in-a-function"><i class="fa fa-check"></i><b>4.4.1</b> Encapsulating the Agent in a Function</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-wsls-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift (WSLS) Agent</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-the-wsls-function"><i class="fa fa-check"></i><b>4.5.1</b> Implementing the WSLS Function</a></li>
<li class="chapter" data-level="4.5.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#simulating-wsls-vs.-opponents"><i class="fa fa-check"></i><b>4.5.2</b> Simulating WSLS vs. Opponents</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#scaling-up-the-virtual-experiment"><i class="fa fa-check"></i><b>4.6</b> Scaling Up: The Virtual Experiment</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#visualizing-results"><i class="fa fa-check"></i><b>4.6.1</b> Visualizing Results</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion-the-forward-model"><i class="fa fa-check"></i><b>4.7</b> Conclusion: The Forward Model</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-problem-of-inference"><i class="fa fa-check"></i><b>4.7.1</b> The Problem of Inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-inferring-latent-parameters"><i class="fa fa-check"></i><b>5.2</b> The Challenge: Inferring Latent Parameters</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-first-stan-model-inferring-bias-rate"><i class="fa fa-check"></i><b>5.4</b> Building our First Stan Model: Inferring Bias Rate</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.1</b> Model</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.2</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.3</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#validating-the-model-parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Validating the Model: Parameter Recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#moving-beyond-simple-bias-memory-models"><i class="fa fa-check"></i><b>5.6</b> Moving Beyond Simple Bias: Memory Models</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-1-glm-like-approach-external-predictor"><i class="fa fa-check"></i><b>5.6.1</b> Memory Model 1: GLM-like Approach (External Predictor)</a></li>
<li class="chapter" data-level="5.6.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.2</b> Summarizing the results</a></li>
<li class="chapter" data-level="5.6.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-2-internal-state-variable"><i class="fa fa-check"></i><b>5.6.3</b> Memory Model 2: Internal State Variable</a></li>
<li class="chapter" data-level="5.6.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-3-exponential-forgetting-relation-to-rl"><i class="fa fa-check"></i><b>5.6.4</b> Memory Model 3: Exponential Forgetting (Relation to RL)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-model-4-bayesian-agent-optimal-updating"><i class="fa fa-check"></i><b>5.7</b> Memory Model 4: Bayesian Agent (Optimal Updating)</a></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Kalman Filters</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.2</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.3</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-estimating-parameters-and-exploring-memory"><i class="fa fa-check"></i><b>5.9</b> Conclusion: Estimating Parameters and Exploring Memory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Cognitive Modeling Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-pizza-experiment" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> The Pizza Experiment<a href="the-pizza-experiment.html#the-pizza-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="from-pizza-to-cognitive-models-an-introduction" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> From Pizza to Cognitive Models: An Introduction<a href="the-pizza-experiment.html#from-pizza-to-cognitive-models-an-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter introduces core modeling concepts through a delicious lens: the physics of pizza stone heating. While this might seem far removed from cognitive science, it provides an insightful introduction to the challenges and methodologies of modeling complex phenomena.</p>
</div>
<div id="why-start-with-pizza" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Why Start with Pizza?<a href="the-pizza-experiment.html#why-start-with-pizza" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Do I even need to answer that question? Because pizza, obviously.</p>
<p>Beyond the universal appeal of pizza, starting with a physical system like a heating pizza stone offers a tangible way to grasp core principles fundamental to cognitive modeling. Understanding human cognition involves tackling immense complexity – often dealing with hidden mental states, noisy behavioral data, and competing theories. Modeling a pizza stone allows us to isolate and understand key methodological challenges in a more constrained environment.</p>
<p>First, it demonstrates how to bridge theory and math. We rely on <em>Prior Knowledge</em> — using Newton’s Law of Cooling to structure our equations — just as cognitive scientists use theories of memory or attention to guide their models. This forces us to critically determine our <em>Levels of Analysis</em>: just as we simplify complex thermodynamics into a basic cooling formula, cognitive scientists must decide whether to model neurons, beliefs, or behavioral choices.</p>
<p>It also highlights the problem of <em>Latent Variables</em>. Just as we cannot “see” a heating coefficient—only the noisy temperatures it produces—we cannot see a “learning rate” in the brain, only the choices it drives.</p>
<p>Finally, this example acts as a sandbox for <em>Model Complexity</em> and <em>Validation</em>. We will explicitly compare detailed physics-based models against simpler statistical approximations to see which performs better on empirical data. This mirrors the central trade-off in cognitive science: balancing theoretical completeness with the practical utility of generating testable predictions from available data.</p>
</div>
<div id="learning-objectives" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Learning Objectives<a href="the-pizza-experiment.html#learning-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter uses the seemingly simple example of a heating pizza stone to introduce fundamental principles of computational modeling that are directly applicable to cognitive science. While the specific physics and code are illustrative, the core goals are to understand the <em>process</em> of modeling.</p>
<p>By completing this chapter, you will be able to:</p>
<ul>
<li><p><strong>Appreciate Generative Modeling:</strong> Understand the value of building models based on underlying mechanisms (like physics or cognitive processes) rather than just describing data patterns.</p></li>
<li><p><strong>Connect Theory and Data:</strong> See how theoretical knowledge (physics laws) informs model structure and how data is used to estimate unknown model parameters (like the heating coefficient).</p></li>
<li><p><strong>Implement and Fit Models:</strong> Gain initial experience implementing mathematical models in code (R and Stan) and using Bayesian inference (<code>brms</code>, <code>cmdstanr</code>) to fit them to empirical data.</p></li>
<li><p><strong>Evaluate Model Fit:</strong> Learn basic techniques for visualizing model predictions against data and understand the limitations of purely statistical models compared to theory-driven ones.</p></li>
<li><p><strong>Recognize Modeling Trade-offs:</strong> Understand the balance between model complexity, theoretical grounding, and practical utility through comparing statistical vs. physics-based approaches.</p></li>
<li><p><strong>Apply Modeling Principles:</strong> Recognize how the steps taken here – data exploration, model building, parameter estimation, validation – form a general workflow applicable to cognitive modeling problems explored later in the course.</p></li>
</ul>
<p>Oh, and you’ll probably get hungry as well!</p>
<p>Required Packages</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="the-pizza-experiment.html#cb1-1" tabindex="-1"></a><span class="co"># 1. Ensure &#39;pacman&#39; is installed</span></span>
<span id="cb1-2"><a href="the-pizza-experiment.html#cb1-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span>
<span id="cb1-3"><a href="the-pizza-experiment.html#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="the-pizza-experiment.html#cb1-4" tabindex="-1"></a><span class="co"># 2. Load packages (pacman will verify, install if missing, and load them)</span></span>
<span id="cb1-5"><a href="the-pizza-experiment.html#cb1-5" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-6"><a href="the-pizza-experiment.html#cb1-6" tabindex="-1"></a>  tidyverse,  <span class="co"># Core package for data manipulation and visualization</span></span>
<span id="cb1-7"><a href="the-pizza-experiment.html#cb1-7" tabindex="-1"></a>  brms,       <span class="co"># Interface for Bayesian regression models using Stan</span></span>
<span id="cb1-8"><a href="the-pizza-experiment.html#cb1-8" tabindex="-1"></a>  bayesplot,  <span class="co"># Convenient functions for plotting Bayesian model results</span></span>
<span id="cb1-9"><a href="the-pizza-experiment.html#cb1-9" tabindex="-1"></a>  tidybayes,  <span class="co"># Utilities for working with Bayesian model outputs in a tidy format</span></span>
<span id="cb1-10"><a href="the-pizza-experiment.html#cb1-10" tabindex="-1"></a>  cmdstanr,    <span class="co"># Backend interface for running Stan models efficiently</span></span>
<span id="cb1-11"><a href="the-pizza-experiment.html#cb1-11" tabindex="-1"></a>  here        <span class="co"># For constructing file paths relative to project root</span></span>
<span id="cb1-12"><a href="the-pizza-experiment.html#cb1-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="part-1-exploring-the-pizza-stone-temperature-data" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Part 1: Exploring the Pizza Stone Temperature Data<a href="the-pizza-experiment.html#part-1-exploring-the-pizza-stone-temperature-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this study, we collected temperature measurements from a pizza stone in a gas-fired oven using an infrared temperature gun. Three different raters (N, TR, and R) took measurements over time to track how the stone heated up. Understanding how pizza stones heat up is crucial for achieving the perfect pizza crust, as consistent and sufficient stone temperature is essential for proper baking.</p>
<p>The measurements were taken as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="the-pizza-experiment.html#cb2-1" tabindex="-1"></a><span class="co"># Load and examine the data</span></span>
<span id="cb2-2"><a href="the-pizza-experiment.html#cb2-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-3"><a href="the-pizza-experiment.html#cb2-3" tabindex="-1"></a>  <span class="at">Order =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">18</span>, <span class="dv">3</span>),</span>
<span id="cb2-4"><a href="the-pizza-experiment.html#cb2-4" tabindex="-1"></a>  <span class="at">Seconds =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">175</span>, <span class="dv">278</span>, <span class="dv">333</span>, <span class="dv">443</span>, <span class="dv">568</span>, <span class="dv">731</span>, <span class="dv">773</span>, <span class="dv">851</span>, <span class="dv">912</span>, <span class="dv">980</span>, </span>
<span id="cb2-5"><a href="the-pizza-experiment.html#cb2-5" tabindex="-1"></a>                  <span class="dv">1040</span>, <span class="dv">1074</span>, <span class="dv">1124</span>, <span class="dv">1175</span>, <span class="dv">1237</span>, <span class="dv">1298</span>, <span class="dv">1359</span>, <span class="dv">1394</span>), <span class="dv">3</span>),</span>
<span id="cb2-6"><a href="the-pizza-experiment.html#cb2-6" tabindex="-1"></a>  <span class="at">Temperature =</span> <span class="fu">c</span>(<span class="fl">15.1</span>, <span class="dv">233</span>, <span class="dv">244</span>, <span class="dv">280</span>, <span class="dv">289</span>, <span class="dv">304</span>, <span class="dv">343</span>, <span class="cn">NA</span>, <span class="dv">333</span>, <span class="dv">341</span>, <span class="dv">320</span>, </span>
<span id="cb2-7"><a href="the-pizza-experiment.html#cb2-7" tabindex="-1"></a>                  <span class="dv">370</span>, <span class="dv">325</span>, <span class="dv">362</span>, <span class="dv">363</span>, <span class="dv">357</span>, <span class="dv">380</span>, <span class="dv">376</span>, <span class="dv">380</span>,</span>
<span id="cb2-8"><a href="the-pizza-experiment.html#cb2-8" tabindex="-1"></a>                  <span class="fl">14.5</span>, <span class="fl">139.9</span>, <span class="dv">153</span>, <span class="fl">36.1</span>, <span class="dv">254</span>, <span class="dv">459</span>, <span class="dv">263</span>, <span class="dv">369</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">11</span>),</span>
<span id="cb2-9"><a href="the-pizza-experiment.html#cb2-9" tabindex="-1"></a>                  <span class="fl">12.9</span>, <span class="fl">149.5</span>, <span class="dv">159</span>, <span class="fl">179.4</span>, <span class="fl">191.7</span>, <span class="dv">201</span>, <span class="dv">210</span>, <span class="cn">NA</span>, <span class="dv">256</span>, <span class="dv">257</span>, </span>
<span id="cb2-10"><a href="the-pizza-experiment.html#cb2-10" tabindex="-1"></a>                  <span class="dv">281</span>, <span class="dv">293</span>, <span class="dv">297</span>, <span class="dv">309</span>, <span class="dv">318</span>, <span class="dv">321</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">3</span>)),</span>
<span id="cb2-11"><a href="the-pizza-experiment.html#cb2-11" tabindex="-1"></a>  <span class="at">Rater =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;TR&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">each =</span> <span class="dv">19</span>)</span>
<span id="cb2-12"><a href="the-pizza-experiment.html#cb2-12" tabindex="-1"></a>)</span>
<span id="cb2-13"><a href="the-pizza-experiment.html#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="the-pizza-experiment.html#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="the-pizza-experiment.html#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="the-pizza-experiment.html#cb2-16" tabindex="-1"></a><span class="co"># Create summary statistics</span></span>
<span id="cb2-17"><a href="the-pizza-experiment.html#cb2-17" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="the-pizza-experiment.html#cb2-18" tabindex="-1"></a>  <span class="fu">group_by</span>(Rater) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="the-pizza-experiment.html#cb2-19" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb2-20"><a href="the-pizza-experiment.html#cb2-20" tabindex="-1"></a>    <span class="at">n_measurements =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Temperature)),</span>
<span id="cb2-21"><a href="the-pizza-experiment.html#cb2-21" tabindex="-1"></a>    <span class="at">mean_temp =</span> <span class="fu">mean</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-22"><a href="the-pizza-experiment.html#cb2-22" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-23"><a href="the-pizza-experiment.html#cb2-23" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-24"><a href="the-pizza-experiment.html#cb2-24" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-25"><a href="the-pizza-experiment.html#cb2-25" tabindex="-1"></a>  )</span>
<span id="cb2-26"><a href="the-pizza-experiment.html#cb2-26" tabindex="-1"></a></span>
<span id="cb2-27"><a href="the-pizza-experiment.html#cb2-27" tabindex="-1"></a><span class="co"># Display summary statistics</span></span>
<span id="cb2-28"><a href="the-pizza-experiment.html#cb2-28" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats, <span class="at">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Rater</th>
<th align="right">n_measurements</th>
<th align="right">mean_temp</th>
<th align="right">sd_temp</th>
<th align="right">min_temp</th>
<th align="right">max_temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">18</td>
<td align="right">312.0</td>
<td align="right">86.4</td>
<td align="right">15.1</td>
<td align="right">380</td>
</tr>
<tr class="even">
<td align="left">R</td>
<td align="right">15</td>
<td align="right">229.0</td>
<td align="right">83.9</td>
<td align="right">12.9</td>
<td align="right">321</td>
</tr>
<tr class="odd">
<td align="left">TR</td>
<td align="right">8</td>
<td align="right">211.1</td>
<td align="right">155.2</td>
<td align="right">14.5</td>
<td align="right">459</td>
</tr>
</tbody>
</table>
<div id="initial-data-visualization" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Initial Data Visualization<a href="the-pizza-experiment.html#initial-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s visualize how the temperature evolves over time for each rater:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="the-pizza-experiment.html#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Temperature, <span class="at">color =</span> Rater)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="the-pizza-experiment.html#cb3-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="the-pizza-experiment.html#cb3-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="the-pizza-experiment.html#cb3-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-5"><a href="the-pizza-experiment.html#cb3-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Pizza Stone Temperature Evolution&quot;</span>,</span>
<span id="cb3-6"><a href="the-pizza-experiment.html#cb3-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Measurements by three different raters&quot;</span>,</span>
<span id="cb3-7"><a href="the-pizza-experiment.html#cb3-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Time (minutes)&quot;</span>,</span>
<span id="cb3-8"><a href="the-pizza-experiment.html#cb3-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Temperature (°C)&quot;</span>,</span>
<span id="cb3-9"><a href="the-pizza-experiment.html#cb3-9" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Rater&quot;</span></span>
<span id="cb3-10"><a href="the-pizza-experiment.html#cb3-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-11"><a href="the-pizza-experiment.html#cb3-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-12"><a href="the-pizza-experiment.html#cb3-12" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/01%20datav-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="key-observations" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Key Observations<a href="the-pizza-experiment.html#key-observations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Several interesting patterns emerge from our data:</p>
<p><em>Heating Patterns</em>: The temperature generally increases over time, but not uniformly. We observe some fluctuations that might be due to:</p>
<ul>
<li>Variation in gas flame intensity</li>
<li>Different measurement locations on the stone</li>
<li>Measurement technique differences between raters</li>
</ul>
<p><em>Measurement Patterns by Rater</em></p>
<ul>
<li>Rater N maintained consistent measurements throughout the experiment</li>
<li>Rater TR shows more variability and fewer total measurements</li>
<li>Rater R shows a more gradual temperature increase pattern</li>
</ul>
<p><em>Missing Data</em>: Some measurements are missing (NA values), particularly in the later time points for Rater TR. This is common in real-world data collection and needs to be considered in our analysis.</p>
<p>Let’s examine the rate of temperature change:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="the-pizza-experiment.html#cb4-1" tabindex="-1"></a><span class="co"># --- Calculate Rate of Temperature Change ---</span></span>
<span id="cb4-2"><a href="the-pizza-experiment.html#cb4-2" tabindex="-1"></a><span class="co"># To understand how quickly the stone heats up, calculate the change rate per minute.</span></span>
<span id="cb4-3"><a href="the-pizza-experiment.html#cb4-3" tabindex="-1"></a>data_with_rate <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="the-pizza-experiment.html#cb4-4" tabindex="-1"></a>  <span class="fu">group_by</span>(Rater) <span class="sc">%&gt;%</span> <span class="co"># Perform calculation separately for each rater</span></span>
<span id="cb4-5"><a href="the-pizza-experiment.html#cb4-5" tabindex="-1"></a>  <span class="fu">arrange</span>(Seconds) <span class="sc">%&gt;%</span> <span class="co"># Ensure data is sorted chronologically for lag function</span></span>
<span id="cb4-6"><a href="the-pizza-experiment.html#cb4-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-7"><a href="the-pizza-experiment.html#cb4-7" tabindex="-1"></a>    <span class="co"># Calculate difference in temperature from previous measurement</span></span>
<span id="cb4-8"><a href="the-pizza-experiment.html#cb4-8" tabindex="-1"></a>    <span class="at">delta_temp =</span> Temperature <span class="sc">-</span> <span class="fu">lag</span>(Temperature),</span>
<span id="cb4-9"><a href="the-pizza-experiment.html#cb4-9" tabindex="-1"></a>    <span class="co"># Calculate time elapsed since previous measurement</span></span>
<span id="cb4-10"><a href="the-pizza-experiment.html#cb4-10" tabindex="-1"></a>    <span class="at">delta_secs =</span> Seconds <span class="sc">-</span> <span class="fu">lag</span>(Seconds),</span>
<span id="cb4-11"><a href="the-pizza-experiment.html#cb4-11" tabindex="-1"></a>    <span class="co"># Calculate rate in degrees C per second, then convert to degrees C per minute</span></span>
<span id="cb4-12"><a href="the-pizza-experiment.html#cb4-12" tabindex="-1"></a>    <span class="at">temp_change_per_min =</span> (delta_temp <span class="sc">/</span> delta_secs) <span class="sc">*</span> <span class="dv">60</span>,</span>
<span id="cb4-13"><a href="the-pizza-experiment.html#cb4-13" tabindex="-1"></a>    <span class="co"># Convert time to minutes for plotting</span></span>
<span id="cb4-14"><a href="the-pizza-experiment.html#cb4-14" tabindex="-1"></a>    <span class="at">minutes =</span> Seconds <span class="sc">/</span> <span class="dv">60</span></span>
<span id="cb4-15"><a href="the-pizza-experiment.html#cb4-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="the-pizza-experiment.html#cb4-16" tabindex="-1"></a>  <span class="co"># Remove rows where rate couldn&#39;t be calculated (i.e., the first row for each rater)</span></span>
<span id="cb4-17"><a href="the-pizza-experiment.html#cb4-17" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(temp_change_per_min))</span>
<span id="cb4-18"><a href="the-pizza-experiment.html#cb4-18" tabindex="-1"></a></span>
<span id="cb4-19"><a href="the-pizza-experiment.html#cb4-19" tabindex="-1"></a><span class="co"># Visualize temperature change rate</span></span>
<span id="cb4-20"><a href="the-pizza-experiment.html#cb4-20" tabindex="-1"></a><span class="fu">ggplot</span>(data_with_rate, <span class="fu">aes</span>(<span class="at">x =</span> minutes, <span class="at">y =</span> temp_change_per_min, <span class="at">color =</span> Rater)) <span class="sc">+</span></span>
<span id="cb4-21"><a href="the-pizza-experiment.html#cb4-21" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-22"><a href="the-pizza-experiment.html#cb4-22" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-23"><a href="the-pizza-experiment.html#cb4-23" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-24"><a href="the-pizza-experiment.html#cb4-24" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Rate of Temperature Change Over Time&quot;</span>,</span>
<span id="cb4-25"><a href="the-pizza-experiment.html#cb4-25" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Degrees Celsius per minute&quot;</span>,</span>
<span id="cb4-26"><a href="the-pizza-experiment.html#cb4-26" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Time (minutes)&quot;</span>,</span>
<span id="cb4-27"><a href="the-pizza-experiment.html#cb4-27" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Temperature Change Rate (°C/min)&quot;</span>,</span>
<span id="cb4-28"><a href="the-pizza-experiment.html#cb4-28" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Rater&quot;</span></span>
<span id="cb4-29"><a href="the-pizza-experiment.html#cb4-29" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-30"><a href="the-pizza-experiment.html#cb4-30" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-31"><a href="the-pizza-experiment.html#cb4-31" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/01%20temp%20change-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This visualization reveals that the heating rate is (likely) highest in the first few minutes and gradually decreases as the stone temperature approaches the oven temperature. This aligns with Newton’s Law of Cooling/Heating, which we will explore in the next section.</p>
</div>
</div>
<div id="part-2-initial-statistical-modeling" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Part 2: Initial Statistical Modeling<a href="the-pizza-experiment.html#part-2-initial-statistical-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before developing our physics-based model, let’s explore how standard statistical approaches perform in modeling our temperature data. We’ll implement two types of models using the brms package: a linear mixed-effects model and a lognormal mixed-effects model. Both models will account for variations between raters.</p>
<div id="model-setup-and-priors" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Model Setup and Priors<a href="the-pizza-experiment.html#model-setup-and-priors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, let’s ensure we have a directory for our models and set up our computational parameters:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="the-pizza-experiment.html#cb5-1" tabindex="-1"></a><span class="co"># --- Model Fitting Setup ---</span></span>
<span id="cb5-2"><a href="the-pizza-experiment.html#cb5-2" tabindex="-1"></a><span class="co"># Define relative paths for saving model objects and Stan code.</span></span>
<span id="cb5-3"><a href="the-pizza-experiment.html#cb5-3" tabindex="-1"></a>linear_model_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;models&quot;</span>, <span class="st">&quot;01_pizza_linear_model&quot;</span>)</span>
<span id="cb5-4"><a href="the-pizza-experiment.html#cb5-4" tabindex="-1"></a>lognormal_model_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;models&quot;</span>, <span class="st">&quot;01_pizza_lognormal_model&quot;</span>)</span>
<span id="cb5-5"><a href="the-pizza-experiment.html#cb5-5" tabindex="-1"></a>stan_model_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;models&quot;</span>, <span class="st">&quot;pizza_physics_model.stan&quot;</span>)</span>
<span id="cb5-6"><a href="the-pizza-experiment.html#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="the-pizza-experiment.html#cb5-7" tabindex="-1"></a><span class="co"># Create the &#39;models&#39; directory if it doesn&#39;t already exist</span></span>
<span id="cb5-8"><a href="the-pizza-experiment.html#cb5-8" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;models&quot;</span>)) {</span>
<span id="cb5-9"><a href="the-pizza-experiment.html#cb5-9" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">&quot;models&quot;</span>)</span>
<span id="cb5-10"><a href="the-pizza-experiment.html#cb5-10" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Created &#39;models&#39; directory.&quot;</span>)</span>
<span id="cb5-11"><a href="the-pizza-experiment.html#cb5-11" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="the-pizza-experiment.html#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="the-pizza-experiment.html#cb5-13" tabindex="-1"></a><span class="co"># Define computational parameters</span></span>
<span id="cb5-14"><a href="the-pizza-experiment.html#cb5-14" tabindex="-1"></a>mc_settings <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-15"><a href="the-pizza-experiment.html#cb5-15" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb5-16"><a href="the-pizza-experiment.html#cb5-16" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">6000</span>,</span>
<span id="cb5-17"><a href="the-pizza-experiment.html#cb5-17" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb5-18"><a href="the-pizza-experiment.html#cb5-18" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span></span>
<span id="cb5-19"><a href="the-pizza-experiment.html#cb5-19" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="linear-mixed-effects-model" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Linear Mixed-Effects Model<a href="the-pizza-experiment.html#linear-mixed-effects-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We begin with a linear mixed-effects model, which assumes that temperature increases linearly with time but allows for different patterns across raters. This model includes both fixed effects (overall time trend) and random effects (rater-specific variations).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="the-pizza-experiment.html#cb6-1" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="the-pizza-experiment.html#cb6-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Minutes =</span> Seconds <span class="sc">/</span> <span class="dv">60</span>)</span>
<span id="cb6-3"><a href="the-pizza-experiment.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="the-pizza-experiment.html#cb6-4" tabindex="-1"></a><span class="co"># Define priors for linear model</span></span>
<span id="cb6-5"><a href="the-pizza-experiment.html#cb6-5" tabindex="-1"></a>linear_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb6-6"><a href="the-pizza-experiment.html#cb6-6" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">15</span>, <span class="dv">20</span>), <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),  <span class="co"># Centered around room temperature</span></span>
<span id="cb6-7"><a href="the-pizza-experiment.html#cb6-7" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),          <span class="co"># Expected temperature change per minute</span></span>
<span id="cb6-8"><a href="the-pizza-experiment.html#cb6-8" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>),         <span class="co"># Residual variation</span></span>
<span id="cb6-9"><a href="the-pizza-experiment.html#cb6-9" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),            <span class="co"># Random effects variation</span></span>
<span id="cb6-10"><a href="the-pizza-experiment.html#cb6-10" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">3</span>), <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>)                    <span class="co"># Random effects correlation</span></span>
<span id="cb6-11"><a href="the-pizza-experiment.html#cb6-11" tabindex="-1"></a>)</span>
<span id="cb6-12"><a href="the-pizza-experiment.html#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="the-pizza-experiment.html#cb6-13" tabindex="-1"></a><span class="co"># --- Linear Model ---</span></span>
<span id="cb6-14"><a href="the-pizza-experiment.html#cb6-14" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb6-15"><a href="the-pizza-experiment.html#cb6-15" tabindex="-1"></a>  Temperature <span class="sc">~</span> Minutes <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Minutes <span class="sc">|</span> Rater),</span>
<span id="cb6-16"><a href="the-pizza-experiment.html#cb6-16" tabindex="-1"></a>  <span class="at">data =</span> data_scaled,</span>
<span id="cb6-17"><a href="the-pizza-experiment.html#cb6-17" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb6-18"><a href="the-pizza-experiment.html#cb6-18" tabindex="-1"></a>  <span class="at">prior =</span> linear_priors,</span>
<span id="cb6-19"><a href="the-pizza-experiment.html#cb6-19" tabindex="-1"></a>  <span class="at">chains =</span> mc_settings<span class="sc">$</span>chains,</span>
<span id="cb6-20"><a href="the-pizza-experiment.html#cb6-20" tabindex="-1"></a>  <span class="at">iter =</span> mc_settings<span class="sc">$</span>iter,</span>
<span id="cb6-21"><a href="the-pizza-experiment.html#cb6-21" tabindex="-1"></a>  <span class="at">seed =</span> mc_settings<span class="sc">$</span>seed, <span class="co"># Ensures reproducibility of MCMC sampling</span></span>
<span id="cb6-22"><a href="the-pizza-experiment.html#cb6-22" tabindex="-1"></a>  <span class="at">backend =</span> mc_settings<span class="sc">$</span>backend,</span>
<span id="cb6-23"><a href="the-pizza-experiment.html#cb6-23" tabindex="-1"></a>  <span class="at">file =</span> linear_model_path, <span class="co"># Use relative path</span></span>
<span id="cb6-24"><a href="the-pizza-experiment.html#cb6-24" tabindex="-1"></a>  <span class="at">file_refit =</span> <span class="st">&quot;on_change&quot;</span>, <span class="co"># Refit if model code or data changes</span></span>
<span id="cb6-25"><a href="the-pizza-experiment.html#cb6-25" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">2</span>, <span class="co"># Specify cores used for parallel chains</span></span>
<span id="cb6-26"><a href="the-pizza-experiment.html#cb6-26" tabindex="-1"></a>  <span class="co"># Increased adapt_delta and max_treedepth help prevent divergent transitions</span></span>
<span id="cb6-27"><a href="the-pizza-experiment.html#cb6-27" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb6-28"><a href="the-pizza-experiment.html#cb6-28" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span></span>
<span id="cb6-29"><a href="the-pizza-experiment.html#cb6-29" tabindex="-1"></a>)</span>
<span id="cb6-30"><a href="the-pizza-experiment.html#cb6-30" tabindex="-1"></a></span>
<span id="cb6-31"><a href="the-pizza-experiment.html#cb6-31" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb6-32"><a href="the-pizza-experiment.html#cb6-32" tabindex="-1"></a><span class="fu">summary</span>(linear_model)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity 
## Formula: Temperature ~ Minutes + (1 + Minutes | Rater) 
##    Data: data_scaled (Number of observations: 41) 
##   Draws: 2 chains, each with iter = 6000; warmup = 3000; thin = 1;
##          total post-warmup draws = 6000
## 
## Multilevel Hyperparameters:
## ~Rater (Number of levels: 3) 
##                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)             57.01     28.21     7.42   120.86 1.00     2014     1104
## sd(Minutes)               31.39     15.76    11.83    71.91 1.00     1655     2789
## cor(Intercept,Minutes)     0.00      0.35    -0.65     0.65 1.00     2075     3209
## 
## Regression Coefficients:
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    84.92     45.64   -13.93   166.45 1.00     1809     2567
## Minutes      -5.54      4.21   -13.23     3.41 1.00     1816     2506
## 
## Further Distributional Parameters:
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    57.45      6.87    45.63    72.47 1.00     3734     3283
## 
## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="the-pizza-experiment.html#cb8-1" tabindex="-1"></a><span class="co"># Generate predictions</span></span>
<span id="cb8-2"><a href="the-pizza-experiment.html#cb8-2" tabindex="-1"></a>linear_preds <span class="ot">&lt;-</span> <span class="fu">fitted</span>(</span>
<span id="cb8-3"><a href="the-pizza-experiment.html#cb8-3" tabindex="-1"></a>  linear_model,</span>
<span id="cb8-4"><a href="the-pizza-experiment.html#cb8-4" tabindex="-1"></a>  <span class="at">newdata =</span> data_scaled,</span>
<span id="cb8-5"><a href="the-pizza-experiment.html#cb8-5" tabindex="-1"></a>  <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb8-6"><a href="the-pizza-experiment.html#cb8-6" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="the-pizza-experiment.html#cb8-7" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="the-pizza-experiment.html#cb8-8" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data)</span></code></pre></div>
</div>
<div id="lognormal-mixed-effects-model" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Lognormal Mixed-Effects Model<a href="the-pizza-experiment.html#lognormal-mixed-effects-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The lognormal model accounts for the fact that temperature changes might be proportional rather than additive, and ensures predictions cannot go below zero (I don’t bring my oven out in the freezing cold!).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="the-pizza-experiment.html#cb9-1" tabindex="-1"></a><span class="co"># Define priors for lognormal model</span></span>
<span id="cb9-2"><a href="the-pizza-experiment.html#cb9-2" tabindex="-1"></a>lognormal_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb9-3"><a href="the-pizza-experiment.html#cb9-3" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">2.7</span>, <span class="fl">0.5</span>), <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),     <span class="co"># Log scale for room temperature</span></span>
<span id="cb9-4"><a href="the-pizza-experiment.html#cb9-4" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),     <span class="co"># Expected log-scale change per minute</span></span>
<span id="cb9-5"><a href="the-pizza-experiment.html#cb9-5" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>),        <span class="co"># Log-scale residual variation</span></span>
<span id="cb9-6"><a href="the-pizza-experiment.html#cb9-6" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),           <span class="co"># Random effects variation</span></span>
<span id="cb9-7"><a href="the-pizza-experiment.html#cb9-7" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">3</span>), <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>)                   <span class="co"># Random effects correlation</span></span>
<span id="cb9-8"><a href="the-pizza-experiment.html#cb9-8" tabindex="-1"></a>)</span>
<span id="cb9-9"><a href="the-pizza-experiment.html#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="the-pizza-experiment.html#cb9-10" tabindex="-1"></a><span class="co"># --- Lognormal Model ---</span></span>
<span id="cb9-11"><a href="the-pizza-experiment.html#cb9-11" tabindex="-1"></a>lognormal_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb9-12"><a href="the-pizza-experiment.html#cb9-12" tabindex="-1"></a>  Temperature <span class="sc">~</span> Minutes <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Minutes <span class="sc">|</span> Rater),</span>
<span id="cb9-13"><a href="the-pizza-experiment.html#cb9-13" tabindex="-1"></a>  <span class="at">data =</span> data_scaled,</span>
<span id="cb9-14"><a href="the-pizza-experiment.html#cb9-14" tabindex="-1"></a>  <span class="at">family =</span> lognormal, <span class="co"># Use lognormal distribution</span></span>
<span id="cb9-15"><a href="the-pizza-experiment.html#cb9-15" tabindex="-1"></a>  <span class="at">prior =</span> lognormal_priors,</span>
<span id="cb9-16"><a href="the-pizza-experiment.html#cb9-16" tabindex="-1"></a>  <span class="at">chains =</span> mc_settings<span class="sc">$</span>chains,</span>
<span id="cb9-17"><a href="the-pizza-experiment.html#cb9-17" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">2</span>,</span>
<span id="cb9-18"><a href="the-pizza-experiment.html#cb9-18" tabindex="-1"></a>  <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb9-19"><a href="the-pizza-experiment.html#cb9-19" tabindex="-1"></a>  <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb9-20"><a href="the-pizza-experiment.html#cb9-20" tabindex="-1"></a>  <span class="at">iter =</span> mc_settings<span class="sc">$</span>iter,</span>
<span id="cb9-21"><a href="the-pizza-experiment.html#cb9-21" tabindex="-1"></a>  <span class="at">seed =</span> mc_settings<span class="sc">$</span>seed, <span class="co"># Use the same seed for comparison if desired</span></span>
<span id="cb9-22"><a href="the-pizza-experiment.html#cb9-22" tabindex="-1"></a>  <span class="at">backend =</span> mc_settings<span class="sc">$</span>backend,</span>
<span id="cb9-23"><a href="the-pizza-experiment.html#cb9-23" tabindex="-1"></a>  <span class="at">file =</span> lognormal_model_path <span class="co"># Use relative path</span></span>
<span id="cb9-24"><a href="the-pizza-experiment.html#cb9-24" tabindex="-1"></a>)</span>
<span id="cb9-25"><a href="the-pizza-experiment.html#cb9-25" tabindex="-1"></a></span>
<span id="cb9-26"><a href="the-pizza-experiment.html#cb9-26" tabindex="-1"></a><span class="co"># Generate predictions</span></span>
<span id="cb9-27"><a href="the-pizza-experiment.html#cb9-27" tabindex="-1"></a>lognormal_preds <span class="ot">&lt;-</span> <span class="fu">fitted</span>(</span>
<span id="cb9-28"><a href="the-pizza-experiment.html#cb9-28" tabindex="-1"></a>  lognormal_model,</span>
<span id="cb9-29"><a href="the-pizza-experiment.html#cb9-29" tabindex="-1"></a>  <span class="at">newdata =</span> data_scaled,</span>
<span id="cb9-30"><a href="the-pizza-experiment.html#cb9-30" tabindex="-1"></a>  <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb9-31"><a href="the-pizza-experiment.html#cb9-31" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb9-32"><a href="the-pizza-experiment.html#cb9-32" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-33"><a href="the-pizza-experiment.html#cb9-33" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data)</span></code></pre></div>
</div>
<div id="model-comparison-and-visualization" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Model Comparison and Visualization<a href="the-pizza-experiment.html#model-comparison-and-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s compare how these models fit our data:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="the-pizza-experiment.html#cb10-1" tabindex="-1"></a><span class="co"># Compare models using LOO</span></span>
<span id="cb10-2"><a href="the-pizza-experiment.html#cb10-2" tabindex="-1"></a>model_comparison <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(</span>
<span id="cb10-3"><a href="the-pizza-experiment.html#cb10-3" tabindex="-1"></a>  <span class="fu">loo</span>(linear_model),</span>
<span id="cb10-4"><a href="the-pizza-experiment.html#cb10-4" tabindex="-1"></a>  <span class="fu">loo</span>(lognormal_model)</span>
<span id="cb10-5"><a href="the-pizza-experiment.html#cb10-5" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="the-pizza-experiment.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="the-pizza-experiment.html#cb10-7" tabindex="-1"></a><span class="co"># Create comparison plot</span></span>
<span id="cb10-8"><a href="the-pizza-experiment.html#cb10-8" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-9"><a href="the-pizza-experiment.html#cb10-9" tabindex="-1"></a>  <span class="co"># Raw data points</span></span>
<span id="cb10-10"><a href="the-pizza-experiment.html#cb10-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data, </span>
<span id="cb10-11"><a href="the-pizza-experiment.html#cb10-11" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Temperature, <span class="at">color =</span> Rater),</span>
<span id="cb10-12"><a href="the-pizza-experiment.html#cb10-12" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-13"><a href="the-pizza-experiment.html#cb10-13" tabindex="-1"></a>  <span class="co"># Linear model predictions</span></span>
<span id="cb10-14"><a href="the-pizza-experiment.html#cb10-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> linear_preds,</span>
<span id="cb10-15"><a href="the-pizza-experiment.html#cb10-15" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Estimate, <span class="at">linetype =</span> <span class="st">&quot;Linear&quot;</span>),</span>
<span id="cb10-16"><a href="the-pizza-experiment.html#cb10-16" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-17"><a href="the-pizza-experiment.html#cb10-17" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> linear_preds,</span>
<span id="cb10-18"><a href="the-pizza-experiment.html#cb10-18" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb10-19"><a href="the-pizza-experiment.html#cb10-19" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb10-20"><a href="the-pizza-experiment.html#cb10-20" tabindex="-1"></a>  <span class="co"># Lognormal model predictions</span></span>
<span id="cb10-21"><a href="the-pizza-experiment.html#cb10-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lognormal_preds,</span>
<span id="cb10-22"><a href="the-pizza-experiment.html#cb10-22" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Estimate, <span class="at">linetype =</span> <span class="st">&quot;Lognormal&quot;</span>),</span>
<span id="cb10-23"><a href="the-pizza-experiment.html#cb10-23" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-24"><a href="the-pizza-experiment.html#cb10-24" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> lognormal_preds,</span>
<span id="cb10-25"><a href="the-pizza-experiment.html#cb10-25" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb10-26"><a href="the-pizza-experiment.html#cb10-26" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb10-27"><a href="the-pizza-experiment.html#cb10-27" tabindex="-1"></a>  <span class="co"># Formatting</span></span>
<span id="cb10-28"><a href="the-pizza-experiment.html#cb10-28" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Rater) <span class="sc">+</span></span>
<span id="cb10-29"><a href="the-pizza-experiment.html#cb10-29" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-30"><a href="the-pizza-experiment.html#cb10-30" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Comparison of Statistical Models&quot;</span>,</span>
<span id="cb10-31"><a href="the-pizza-experiment.html#cb10-31" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Linear vs Lognormal Mixed-Effects Models&quot;</span>,</span>
<span id="cb10-32"><a href="the-pizza-experiment.html#cb10-32" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Time (minutes)&quot;</span>,</span>
<span id="cb10-33"><a href="the-pizza-experiment.html#cb10-33" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Temperature (°C)&quot;</span>,</span>
<span id="cb10-34"><a href="the-pizza-experiment.html#cb10-34" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;Model Type&quot;</span></span>
<span id="cb10-35"><a href="the-pizza-experiment.html#cb10-35" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-36"><a href="the-pizza-experiment.html#cb10-36" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/01%20model%20comparison-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="the-pizza-experiment.html#cb11-1" tabindex="-1"></a><span class="co"># Create comparison plot but capping the y axis</span></span>
<span id="cb11-2"><a href="the-pizza-experiment.html#cb11-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="the-pizza-experiment.html#cb11-3" tabindex="-1"></a>  <span class="co"># Raw data points</span></span>
<span id="cb11-4"><a href="the-pizza-experiment.html#cb11-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data, </span>
<span id="cb11-5"><a href="the-pizza-experiment.html#cb11-5" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Temperature, <span class="at">color =</span> Rater),</span>
<span id="cb11-6"><a href="the-pizza-experiment.html#cb11-6" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="the-pizza-experiment.html#cb11-7" tabindex="-1"></a>  <span class="co"># Linear model predictions</span></span>
<span id="cb11-8"><a href="the-pizza-experiment.html#cb11-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> linear_preds,</span>
<span id="cb11-9"><a href="the-pizza-experiment.html#cb11-9" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Estimate, <span class="at">linetype =</span> <span class="st">&quot;Linear&quot;</span>),</span>
<span id="cb11-10"><a href="the-pizza-experiment.html#cb11-10" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="the-pizza-experiment.html#cb11-11" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> linear_preds,</span>
<span id="cb11-12"><a href="the-pizza-experiment.html#cb11-12" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb11-13"><a href="the-pizza-experiment.html#cb11-13" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb11-14"><a href="the-pizza-experiment.html#cb11-14" tabindex="-1"></a>  <span class="co"># Lognormal model predictions</span></span>
<span id="cb11-15"><a href="the-pizza-experiment.html#cb11-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lognormal_preds,</span>
<span id="cb11-16"><a href="the-pizza-experiment.html#cb11-16" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Estimate, <span class="at">linetype =</span> <span class="st">&quot;Lognormal&quot;</span>),</span>
<span id="cb11-17"><a href="the-pizza-experiment.html#cb11-17" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href="the-pizza-experiment.html#cb11-18" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> lognormal_preds,</span>
<span id="cb11-19"><a href="the-pizza-experiment.html#cb11-19" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb11-20"><a href="the-pizza-experiment.html#cb11-20" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb11-21"><a href="the-pizza-experiment.html#cb11-21" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1000</span>) <span class="sc">+</span></span>
<span id="cb11-22"><a href="the-pizza-experiment.html#cb11-22" tabindex="-1"></a>  <span class="co"># Formatting</span></span>
<span id="cb11-23"><a href="the-pizza-experiment.html#cb11-23" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Rater) <span class="sc">+</span></span>
<span id="cb11-24"><a href="the-pizza-experiment.html#cb11-24" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-25"><a href="the-pizza-experiment.html#cb11-25" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Comparison of Statistical Models&quot;</span>,</span>
<span id="cb11-26"><a href="the-pizza-experiment.html#cb11-26" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Linear vs Lognormal Mixed-Effects Models&quot;</span>,</span>
<span id="cb11-27"><a href="the-pizza-experiment.html#cb11-27" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Time (minutes)&quot;</span>,</span>
<span id="cb11-28"><a href="the-pizza-experiment.html#cb11-28" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Temperature (°C)&quot;</span>,</span>
<span id="cb11-29"><a href="the-pizza-experiment.html#cb11-29" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;Model Type&quot;</span></span>
<span id="cb11-30"><a href="the-pizza-experiment.html#cb11-30" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-31"><a href="the-pizza-experiment.html#cb11-31" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/01%20model%20comparison-2.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="model-assessment" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> Model Assessment<a href="the-pizza-experiment.html#model-assessment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I have seen worse models in my time, but they do seem to have important issues:</p>
<ul>
<li><p>The linear mixed-effects model assumes a constant rate of temperature change, which we can see is not at all accurate. The actual temperature increase is fast at the beginning and appears to slow down over time, particularly at higher temperatures. While this model has the advantage of simplicity, it is not likely to produce accurate predictions as it seem to fail to capture the underlying physics of heat transfer.</p></li>
<li><p>The lognormal mixed-effects model is completely off.</p></li>
</ul>
<p>Further, the lognormal model produce some divergences, which is often a sign that they are not well suited to the data.
I would argue that the core issue is that neither model incorporates our knowledge of heat transfer physics, which suggests an exponential approach to equilibrium temperature. This limitation motivates our next section, where we’ll develop a physics-based model.</p>
</div>
</div>
<div id="part-3-understanding-the-physics-model" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Part 3: Understanding the Physics Model<a href="the-pizza-experiment.html#part-3-understanding-the-physics-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Temperature evolution in a pizza stone follows Newton’s Law of Cooling/Heating. We’ll start by exploring this physical model before applying it to real data.</p>
<div id="the-basic-temperature-evolution-equation" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> The Basic Temperature Evolution Equation<a href="the-pizza-experiment.html#the-basic-temperature-evolution-equation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The temperature evolution of a pizza stone in a gas-fired oven is governed by the heat diffusion equation, which describes how heat flows through solid materials:</p>
<p><span class="math display">\[\rho c_p \frac{\partial T}{\partial t} = k\nabla^2T + Q\]</span></p>
<p>where:
<span class="math inline">\(\rho\)</span> represents the stone’s density (kg/m³)
<span class="math inline">\(c_p\)</span> denotes specific heat capacity (J/kg·K)
<span class="math inline">\(T\)</span> is temperature (K)
<span class="math inline">\(t\)</span> represents time (s)
<span class="math inline">\(k\)</span> is thermal conductivity (W/m·K)
<span class="math inline">\(\nabla^2\)</span> is the Laplacian operator
<span class="math inline">\(Q\)</span> represents heat input from the oven (W/m³)</p>
<p>While this equation provides a complete description of heat flow, we can significantly simplify our analysis by applying the lumped capacitance model. his simplification assumes that the stone conducts heat internally much faster than it absorbs it from the surface. This allows us to ignore the complex internal gradients (<span class="math inline">\(\nabla^2T\)</span>) and focus purely on the surface heat transfer, reducing our model to:</p>
<p><span class="math display">\[\frac{dT}{dt} = \frac{hA}{mc_p}(T_{\infty} - T)\]</span></p>
<p>where:
<span class="math inline">\(h\)</span> is the heat transfer coefficient (W/m²·K)
<span class="math inline">\(A\)</span> is the surface area exposed to heat (m²)
<span class="math inline">\(m\)</span> is the stone’s mass (kg)
<span class="math inline">\(T_{\infty}\)</span> is the oven temperature (K)</p>
<p>This simplified equation relates the rate of temperature change to the difference between the current stone temperature T and the ambient temperature T∞ (as determined by the flame). The coefficient h represents the heat transfer coefficient between the ambient and stone, A is the stone’s surface area exposed to heat, m is its mass, and cp remains the specific heat capacity.</p>
<p>To solve this differential equation, we begin by separating variables:</p>
<p><span class="math display">\[\frac{dT}{T_{\infty} - T} = \left(\frac{hA}{mc_p}\right)dt\]</span></p>
<p>Integration of both sides yields:</p>
<p><span class="math display">\[-\ln|T_{\infty} - T| = \left(\frac{hA}{mc_p}\right)t + C\]</span></p>
<p>where C is an integration constant.</p>
<p>Using the initial condition <span class="math inline">\(T = T_i\)</span> at <span class="math inline">\(t = 0\)</span>, we can determine the integration constant:</p>
<p><span class="math display">\[C = -\ln|T_{\infty} - T_i|\]</span></p>
<p>Substituting this back and solving for temperature gives us:</p>
<p><span class="math display">\[T = T_{\infty} + (T_i - T_{\infty})\exp\left(-\frac{hA}{mc_p}t\right)\]</span></p>
<p>For practical reasons, we combine physical parameters into a single coefficient, which we will call HOT:</p>
<p><span class="math display">\[HOT = \frac{hA}{mc_p}\]</span>
Giving our working equation:
<span class="math display">\[T = T_{\infty} + (T_i - T_{\infty})\exp(-HOT * t)\]</span></p>
<p>This equation retains the essential physics while providing a practical model for analyzing our experimental data. The HOT coefficient encapsulates the combined effects of heat transfer efficiency, stone geometry, and material properties into a single parameter that determines how quickly the stone approaches the flame temperature.</p>
</div>
</div>
<div id="part-4-implementing-the-physics-based-model" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Part 4: Implementing the Physics-Based Model<a href="the-pizza-experiment.html#part-4-implementing-the-physics-based-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Having established the theoretical foundation, we now face a practical challenge: we cannot measure <span class="math inline">\(h\)</span>, <span class="math inline">\(A\)</span>, or <span class="math inline">\(c_p\)</span> directly during the bake. Instead, we must infer the aggregate parameter HOT from the noisy temperature data collected by our raters. This is where Stan comes in, enabling us to create a Bayesian implementation of our physics-based model, and to account for measurement uncertainty and variation between raters.
First, we prepare our data for the Stan model. Our model requires initial temperatures, time measurements, and observed temperatures from each rater:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="the-pizza-experiment.html#cb12-1" tabindex="-1"></a><span class="co"># Create data structure for Stan</span></span>
<span id="cb12-2"><a href="the-pizza-experiment.html#cb12-2" tabindex="-1"></a>stan_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-3"><a href="the-pizza-experiment.html#cb12-3" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Temperature))),</span>
<span id="cb12-4"><a href="the-pizza-experiment.html#cb12-4" tabindex="-1"></a>  <span class="at">time =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Temperature)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Seconds),</span>
<span id="cb12-5"><a href="the-pizza-experiment.html#cb12-5" tabindex="-1"></a>  <span class="at">temp =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Temperature)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature),</span>
<span id="cb12-6"><a href="the-pizza-experiment.html#cb12-6" tabindex="-1"></a>  <span class="at">n_raters =</span> <span class="dv">3</span>,</span>
<span id="cb12-7"><a href="the-pizza-experiment.html#cb12-7" tabindex="-1"></a>  <span class="at">rater =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(data <span class="sc">%&gt;%</span> </span>
<span id="cb12-8"><a href="the-pizza-experiment.html#cb12-8" tabindex="-1"></a>                           <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Temperature)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="the-pizza-experiment.html#cb12-9" tabindex="-1"></a>                           <span class="fu">pull</span>(Rater))),</span>
<span id="cb12-10"><a href="the-pizza-experiment.html#cb12-10" tabindex="-1"></a>  <span class="at">Ti =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>),  <span class="co"># Initial temperature estimates</span></span>
<span id="cb12-11"><a href="the-pizza-experiment.html#cb12-11" tabindex="-1"></a>  <span class="at">Tinf =</span> <span class="dv">450</span>              <span class="co"># Flame temperature estimate</span></span>
<span id="cb12-12"><a href="the-pizza-experiment.html#cb12-12" tabindex="-1"></a>)</span></code></pre></div>
<p>Next, we implement our physics-based model in Stan. The model incorporates our derived equation while allowing for rater-specific heating coefficients:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="the-pizza-experiment.html#cb13-1" tabindex="-1"></a>stan_code <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb13-2"><a href="the-pizza-experiment.html#cb13-2" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb13-3"><a href="the-pizza-experiment.html#cb13-3" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;                   // Number of observations</span></span>
<span id="cb13-4"><a href="the-pizza-experiment.html#cb13-4" tabindex="-1"></a><span class="st">  vector[N] time;                   // Time points</span></span>
<span id="cb13-5"><a href="the-pizza-experiment.html#cb13-5" tabindex="-1"></a><span class="st">  vector[N] temp;                   // Observed temperatures</span></span>
<span id="cb13-6"><a href="the-pizza-experiment.html#cb13-6" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; n_raters;           // Number of raters</span></span>
<span id="cb13-7"><a href="the-pizza-experiment.html#cb13-7" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1,upper=n_raters&gt; rater;  // Rater indices</span></span>
<span id="cb13-8"><a href="the-pizza-experiment.html#cb13-8" tabindex="-1"></a><span class="st">  vector[n_raters] Ti;             // Initial temperatures</span></span>
<span id="cb13-9"><a href="the-pizza-experiment.html#cb13-9" tabindex="-1"></a><span class="st">  real Tinf;                       // Flame temperature</span></span>
<span id="cb13-10"><a href="the-pizza-experiment.html#cb13-10" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb13-11"><a href="the-pizza-experiment.html#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="the-pizza-experiment.html#cb13-12" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb13-13"><a href="the-pizza-experiment.html#cb13-13" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[n_raters] HOT;   // Heating coefficients</span></span>
<span id="cb13-14"><a href="the-pizza-experiment.html#cb13-14" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[n_raters] sigma; // Measurement error</span></span>
<span id="cb13-15"><a href="the-pizza-experiment.html#cb13-15" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb13-16"><a href="the-pizza-experiment.html#cb13-16" tabindex="-1"></a></span>
<span id="cb13-17"><a href="the-pizza-experiment.html#cb13-17" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb13-18"><a href="the-pizza-experiment.html#cb13-18" tabindex="-1"></a><span class="st">  // Physics-based temperature prediction</span></span>
<span id="cb13-19"><a href="the-pizza-experiment.html#cb13-19" tabindex="-1"></a><span class="st">  vector[N] mu = Tinf + (Ti[rater] - Tinf) .* exp(-HOT[rater] .* time);</span></span>
<span id="cb13-20"><a href="the-pizza-experiment.html#cb13-20" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb13-21"><a href="the-pizza-experiment.html#cb13-21" tabindex="-1"></a><span class="st">  // Prior distributions</span></span>
<span id="cb13-22"><a href="the-pizza-experiment.html#cb13-22" tabindex="-1"></a><span class="st">  target += normal_lpdf(HOT | 0.005, 0.005);    // Prior for heating rate</span></span>
<span id="cb13-23"><a href="the-pizza-experiment.html#cb13-23" tabindex="-1"></a><span class="st">  target += exponential_lpdf(sigma | 1);         // Prior for measurement error</span></span>
<span id="cb13-24"><a href="the-pizza-experiment.html#cb13-24" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb13-25"><a href="the-pizza-experiment.html#cb13-25" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb13-26"><a href="the-pizza-experiment.html#cb13-26" tabindex="-1"></a><span class="st">  target += normal_lpdf(temp | mu, sigma[rater]);</span></span>
<span id="cb13-27"><a href="the-pizza-experiment.html#cb13-27" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb13-28"><a href="the-pizza-experiment.html#cb13-28" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb13-29"><a href="the-pizza-experiment.html#cb13-29" tabindex="-1"></a></span>
<span id="cb13-30"><a href="the-pizza-experiment.html#cb13-30" tabindex="-1"></a><span class="co"># Save the Stan model code using the relative path</span></span>
<span id="cb13-31"><a href="the-pizza-experiment.html#cb13-31" tabindex="-1"></a><span class="fu">writeLines</span>(stan_code, stan_model_path)</span>
<span id="cb13-32"><a href="the-pizza-experiment.html#cb13-32" tabindex="-1"></a></span>
<span id="cb13-33"><a href="the-pizza-experiment.html#cb13-33" tabindex="-1"></a><span class="co"># Compile and fit the Stan model using the relative path</span></span>
<span id="cb13-34"><a href="the-pizza-experiment.html#cb13-34" tabindex="-1"></a><span class="co"># Compilation happens once; subsequent runs load the compiled object if unchanged.</span></span>
<span id="cb13-35"><a href="the-pizza-experiment.html#cb13-35" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">&quot;models/pizza_physics_model.stan&quot;</span>)</span>
<span id="cb13-36"><a href="the-pizza-experiment.html#cb13-36" tabindex="-1"></a></span>
<span id="cb13-37"><a href="the-pizza-experiment.html#cb13-37" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb13-38"><a href="the-pizza-experiment.html#cb13-38" tabindex="-1"></a>  <span class="at">data =</span> stan_data,</span>
<span id="cb13-39"><a href="the-pizza-experiment.html#cb13-39" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb13-40"><a href="the-pizza-experiment.html#cb13-40" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb13-41"><a href="the-pizza-experiment.html#cb13-41" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">2</span></span>
<span id="cb13-42"><a href="the-pizza-experiment.html#cb13-42" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running MCMC with 2 parallel chains...
## 
## Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
## Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
## Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
## Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
## Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
## Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
## Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
## Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
## Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
## Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
## Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
## Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
## Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
## Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
## Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
## Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
## Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
## Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
## Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
## Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
## Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
## Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
## Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
## Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
## Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
## Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
## Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
## Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
## Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
## Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
## Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
## Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
## Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
## Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
## Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
## Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
## Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
## Chain 1 finished in 0.1 seconds.
## Chain 2 finished in 0.1 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 0.1 seconds.
## Total execution time: 0.2 seconds.</code></pre>
<p>The Stan implementation translates our mathematical model into a computational framework. We assign informative priors to our parameters based on physical understanding: the heating coefficient (HOT) is expected to be small but positive, while measurement error (sigma) follows an exponential distribution to ensure positivity while allowing for varying levels of uncertainty between raters.
To visualize our model’s predictions and assess its performance, we extract posterior samples and generate predictions across our time range:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="the-pizza-experiment.html#cb15-1" tabindex="-1"></a><span class="co"># Extract draws</span></span>
<span id="cb15-2"><a href="the-pizza-experiment.html#cb15-2" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit<span class="sc">$</span><span class="fu">draws</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="the-pizza-experiment.html#cb15-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;HOT&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;sigma&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="the-pizza-experiment.html#cb15-4" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb15-5"><a href="the-pizza-experiment.html#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="the-pizza-experiment.html#cb15-6" tabindex="-1"></a><span class="co"># Create prediction grid</span></span>
<span id="cb15-7"><a href="the-pizza-experiment.html#cb15-7" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">crossing</span>(</span>
<span id="cb15-8"><a href="the-pizza-experiment.html#cb15-8" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(stan_data<span class="sc">$</span>time), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb15-9"><a href="the-pizza-experiment.html#cb15-9" tabindex="-1"></a>  <span class="at">rater =</span> <span class="dv">1</span><span class="sc">:</span>stan_data<span class="sc">$</span>n_raters</span>
<span id="cb15-10"><a href="the-pizza-experiment.html#cb15-10" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="the-pizza-experiment.html#cb15-11" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-12"><a href="the-pizza-experiment.html#cb15-12" tabindex="-1"></a>    <span class="at">Ti =</span> stan_data<span class="sc">$</span>Ti[rater],</span>
<span id="cb15-13"><a href="the-pizza-experiment.html#cb15-13" tabindex="-1"></a>    <span class="at">Tinf =</span> stan_data<span class="sc">$</span>Tinf</span>
<span id="cb15-14"><a href="the-pizza-experiment.html#cb15-14" tabindex="-1"></a>  )</span>
<span id="cb15-15"><a href="the-pizza-experiment.html#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="the-pizza-experiment.html#cb15-16" tabindex="-1"></a><span class="co"># Generate predictions</span></span>
<span id="cb15-17"><a href="the-pizza-experiment.html#cb15-17" tabindex="-1"></a>pred_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(pred_data), <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb15-18"><a href="the-pizza-experiment.html#cb15-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pred_data)) {</span>
<span id="cb15-19"><a href="the-pizza-experiment.html#cb15-19" tabindex="-1"></a>  pred_matrix[i,] <span class="ot">&lt;-</span> <span class="fu">with</span>(pred_data[i,], </span>
<span id="cb15-20"><a href="the-pizza-experiment.html#cb15-20" tabindex="-1"></a>                         Tinf <span class="sc">+</span> (Ti <span class="sc">-</span> Tinf) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">as.matrix</span>(post)[,rater] <span class="sc">*</span> time))</span>
<span id="cb15-21"><a href="the-pizza-experiment.html#cb15-21" tabindex="-1"></a>}</span>
<span id="cb15-22"><a href="the-pizza-experiment.html#cb15-22" tabindex="-1"></a></span>
<span id="cb15-23"><a href="the-pizza-experiment.html#cb15-23" tabindex="-1"></a><span class="co"># Summarize predictions</span></span>
<span id="cb15-24"><a href="the-pizza-experiment.html#cb15-24" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> pred_data <span class="sc">%&gt;%</span></span>
<span id="cb15-25"><a href="the-pizza-experiment.html#cb15-25" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-26"><a href="the-pizza-experiment.html#cb15-26" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">rowMeans</span>(pred_matrix),</span>
<span id="cb15-27"><a href="the-pizza-experiment.html#cb15-27" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">apply</span>(pred_matrix, <span class="dv">1</span>, quantile, <span class="fl">0.025</span>),</span>
<span id="cb15-28"><a href="the-pizza-experiment.html#cb15-28" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">apply</span>(pred_matrix, <span class="dv">1</span>, quantile, <span class="fl">0.975</span>)</span>
<span id="cb15-29"><a href="the-pizza-experiment.html#cb15-29" tabindex="-1"></a>  )</span>
<span id="cb15-30"><a href="the-pizza-experiment.html#cb15-30" tabindex="-1"></a></span>
<span id="cb15-31"><a href="the-pizza-experiment.html#cb15-31" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb15-32"><a href="the-pizza-experiment.html#cb15-32" tabindex="-1"></a><span class="fu">ggplot</span>(predictions, <span class="fu">aes</span>(<span class="at">x =</span> time<span class="sc">/</span><span class="dv">60</span>)) <span class="sc">+</span></span>
<span id="cb15-33"><a href="the-pizza-experiment.html#cb15-33" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb15-34"><a href="the-pizza-experiment.html#cb15-34" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb15-35"><a href="the-pizza-experiment.html#cb15-35" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb15-36"><a href="the-pizza-experiment.html#cb15-36" tabindex="-1"></a>    <span class="at">data =</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb15-37"><a href="the-pizza-experiment.html#cb15-37" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Temperature)) <span class="sc">%&gt;%</span></span>
<span id="cb15-38"><a href="the-pizza-experiment.html#cb15-38" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">rater =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-39"><a href="the-pizza-experiment.html#cb15-39" tabindex="-1"></a>        Rater <span class="sc">==</span> <span class="st">&quot;N&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb15-40"><a href="the-pizza-experiment.html#cb15-40" tabindex="-1"></a>        Rater <span class="sc">==</span> <span class="st">&quot;TR&quot;</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb15-41"><a href="the-pizza-experiment.html#cb15-41" tabindex="-1"></a>        Rater <span class="sc">==</span> <span class="st">&quot;R&quot;</span> <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb15-42"><a href="the-pizza-experiment.html#cb15-42" tabindex="-1"></a>      )), </span>
<span id="cb15-43"><a href="the-pizza-experiment.html#cb15-43" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Seconds<span class="sc">/</span><span class="dv">60</span>, <span class="at">y =</span> Temperature)</span>
<span id="cb15-44"><a href="the-pizza-experiment.html#cb15-44" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-45"><a href="the-pizza-experiment.html#cb15-45" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rater, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">rater =</span> <span class="fu">c</span>(</span>
<span id="cb15-46"><a href="the-pizza-experiment.html#cb15-46" tabindex="-1"></a>    <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rater N&quot;</span>, </span>
<span id="cb15-47"><a href="the-pizza-experiment.html#cb15-47" tabindex="-1"></a>    <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rater TR&quot;</span>, </span>
<span id="cb15-48"><a href="the-pizza-experiment.html#cb15-48" tabindex="-1"></a>    <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rater R&quot;</span></span>
<span id="cb15-49"><a href="the-pizza-experiment.html#cb15-49" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb15-50"><a href="the-pizza-experiment.html#cb15-50" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-51"><a href="the-pizza-experiment.html#cb15-51" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Physics-Based Model Predictions&quot;</span>,</span>
<span id="cb15-52"><a href="the-pizza-experiment.html#cb15-52" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Time (minutes)&quot;</span>,</span>
<span id="cb15-53"><a href="the-pizza-experiment.html#cb15-53" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Temperature (°C)&quot;</span></span>
<span id="cb15-54"><a href="the-pizza-experiment.html#cb15-54" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-55"><a href="the-pizza-experiment.html#cb15-55" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/01%20physics%20model%20preds-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Our implementation combines the theoretical understanding developed in Part 3 with practical considerations for real-world data analysis. The model accounts for measurement uncertainty while maintaining the fundamental physics of heat transfer, providing a robust framework for understanding pizza stone temperature evolution.</p>
</div>
<div id="part-5-model-analysis-and-practical-applications" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Part 5: Model Analysis and Practical Applications<a href="the-pizza-experiment.html#part-5-model-analysis-and-practical-applications" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Having fitted our physics-based model, we must first verify that it actually describes the data well (Validation) before we can use it to make predictions. Once we trust our estimates of the HOT parameter, we can develop practical insights for pizza stone management. A key question for any pizzaiolo is: How long must I wait before the stone is ready? To answer this, we don’t need a new model; we simply need to look at our physics equation from a different angle. By rearranging our original cooling law to solve for time (<span class="math inline">\(t\)</span>) instead of temperature (<span class="math inline">\(T\)</span>), we create a predictive tool:</p>
<p><span class="math display">\[t = -\frac{1}{HOT} \ln\left( \frac{T_{\text{target}} - T_{\infty}}{T_{\text{initial}} - T_{\infty}} \right)\]</span></p>
<p>We will now implement this function in R to calculate precise waiting times under different conditions.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="the-pizza-experiment.html#cb16-1" tabindex="-1"></a>time_to_temp <span class="ot">&lt;-</span> <span class="cf">function</span>(target_temp, HOT, Ti, Tinf) {</span>
<span id="cb16-2"><a href="the-pizza-experiment.html#cb16-2" tabindex="-1"></a>  <span class="co"># Solve: target = Tinf + (Ti - Tinf) * exp(-HOT * t)</span></span>
<span id="cb16-3"><a href="the-pizza-experiment.html#cb16-3" tabindex="-1"></a>  <span class="co"># for t</span></span>
<span id="cb16-4"><a href="the-pizza-experiment.html#cb16-4" tabindex="-1"></a>  t <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>HOT <span class="sc">*</span> <span class="fu">log</span>((target_temp <span class="sc">-</span> Tinf)<span class="sc">/</span>(Ti <span class="sc">-</span> Tinf))</span>
<span id="cb16-5"><a href="the-pizza-experiment.html#cb16-5" tabindex="-1"></a>  <span class="fu">return</span>(t<span class="sc">/</span><span class="dv">60</span>)  <span class="co"># Convert seconds to minutes</span></span>
<span id="cb16-6"><a href="the-pizza-experiment.html#cb16-6" tabindex="-1"></a>}</span></code></pre></div>
<p>To understand heating times across different oven conditions, we examine how varying flame temperatures affect the time needed to reach pizza-making temperatures. We extract the heating coefficients from our fitted model and analyze temperature scenarios:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="the-pizza-experiment.html#cb17-1" tabindex="-1"></a><span class="co"># Extract HOT samples from our posterior</span></span>
<span id="cb17-2"><a href="the-pizza-experiment.html#cb17-2" tabindex="-1"></a>hot_samples <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit<span class="sc">$</span><span class="fu">draws</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="the-pizza-experiment.html#cb17-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;HOT&quot;</span>))</span>
<span id="cb17-4"><a href="the-pizza-experiment.html#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="the-pizza-experiment.html#cb17-5" tabindex="-1"></a><span class="co"># Create prediction grid for different flame temperatures</span></span>
<span id="cb17-6"><a href="the-pizza-experiment.html#cb17-6" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">crossing</span>(</span>
<span id="cb17-7"><a href="the-pizza-experiment.html#cb17-7" tabindex="-1"></a>  <span class="at">Tinf =</span> <span class="fu">seq</span>(<span class="dv">450</span>, <span class="dv">1200</span>, <span class="at">by =</span> <span class="dv">50</span>),  <span class="co"># Range of flame temperatures</span></span>
<span id="cb17-8"><a href="the-pizza-experiment.html#cb17-8" tabindex="-1"></a>  <span class="at">rater =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb17-9"><a href="the-pizza-experiment.html#cb17-9" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="the-pizza-experiment.html#cb17-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-11"><a href="the-pizza-experiment.html#cb17-11" tabindex="-1"></a>    <span class="at">Ti =</span> stan_data<span class="sc">$</span>Ti[rater],</span>
<span id="cb17-12"><a href="the-pizza-experiment.html#cb17-12" tabindex="-1"></a>    <span class="at">target_temp =</span> <span class="dv">400</span>  <span class="co"># Target temperature for pizza cooking</span></span>
<span id="cb17-13"><a href="the-pizza-experiment.html#cb17-13" tabindex="-1"></a>  )</span>
<span id="cb17-14"><a href="the-pizza-experiment.html#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="the-pizza-experiment.html#cb17-15" tabindex="-1"></a><span class="co"># Calculate heating times across conditions</span></span>
<span id="cb17-16"><a href="the-pizza-experiment.html#cb17-16" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb17-17"><a href="the-pizza-experiment.html#cb17-17" tabindex="-1"></a>time_preds <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pred_data), <span class="cf">function</span>(i) {</span>
<span id="cb17-18"><a href="the-pizza-experiment.html#cb17-18" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_samples, <span class="cf">function</span>(j) {</span>
<span id="cb17-19"><a href="the-pizza-experiment.html#cb17-19" tabindex="-1"></a>    hot <span class="ot">&lt;-</span> hot_samples[j, <span class="fu">paste0</span>(<span class="st">&quot;HOT[&quot;</span>, pred_data<span class="sc">$</span>rater[i], <span class="st">&quot;]&quot;</span>)][[<span class="dv">1</span>]]</span>
<span id="cb17-20"><a href="the-pizza-experiment.html#cb17-20" tabindex="-1"></a>    <span class="fu">time_to_temp</span>(</span>
<span id="cb17-21"><a href="the-pizza-experiment.html#cb17-21" tabindex="-1"></a>      pred_data<span class="sc">$</span>target_temp[i], </span>
<span id="cb17-22"><a href="the-pizza-experiment.html#cb17-22" tabindex="-1"></a>      hot, </span>
<span id="cb17-23"><a href="the-pizza-experiment.html#cb17-23" tabindex="-1"></a>      pred_data<span class="sc">$</span>Ti[i], </span>
<span id="cb17-24"><a href="the-pizza-experiment.html#cb17-24" tabindex="-1"></a>      pred_data<span class="sc">$</span>Tinf[i]</span>
<span id="cb17-25"><a href="the-pizza-experiment.html#cb17-25" tabindex="-1"></a>    )</span>
<span id="cb17-26"><a href="the-pizza-experiment.html#cb17-26" tabindex="-1"></a>  })</span>
<span id="cb17-27"><a href="the-pizza-experiment.html#cb17-27" tabindex="-1"></a>  </span>
<span id="cb17-28"><a href="the-pizza-experiment.html#cb17-28" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb17-29"><a href="the-pizza-experiment.html#cb17-29" tabindex="-1"></a>    <span class="at">rater =</span> pred_data<span class="sc">$</span>rater[i],</span>
<span id="cb17-30"><a href="the-pizza-experiment.html#cb17-30" tabindex="-1"></a>    <span class="at">Tinf =</span> pred_data<span class="sc">$</span>Tinf[i],</span>
<span id="cb17-31"><a href="the-pizza-experiment.html#cb17-31" tabindex="-1"></a>    <span class="at">mean_time =</span> <span class="fu">mean</span>(times),</span>
<span id="cb17-32"><a href="the-pizza-experiment.html#cb17-32" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(times, <span class="fl">0.025</span>),</span>
<span id="cb17-33"><a href="the-pizza-experiment.html#cb17-33" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(times, <span class="fl">0.975</span>)</span>
<span id="cb17-34"><a href="the-pizza-experiment.html#cb17-34" tabindex="-1"></a>  )</span>
<span id="cb17-35"><a href="the-pizza-experiment.html#cb17-35" tabindex="-1"></a>})</span>
<span id="cb17-36"><a href="the-pizza-experiment.html#cb17-36" tabindex="-1"></a></span>
<span id="cb17-37"><a href="the-pizza-experiment.html#cb17-37" tabindex="-1"></a><span class="co"># Visualize heating time predictions</span></span>
<span id="cb17-38"><a href="the-pizza-experiment.html#cb17-38" tabindex="-1"></a><span class="fu">ggplot</span>(time_preds, <span class="fu">aes</span>(<span class="at">x =</span> Tinf)) <span class="sc">+</span></span>
<span id="cb17-39"><a href="the-pizza-experiment.html#cb17-39" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb17-40"><a href="the-pizza-experiment.html#cb17-40" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_time)) <span class="sc">+</span></span>
<span id="cb17-41"><a href="the-pizza-experiment.html#cb17-41" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rater, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">rater =</span> <span class="fu">c</span>(</span>
<span id="cb17-42"><a href="the-pizza-experiment.html#cb17-42" tabindex="-1"></a>    <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rater N&quot;</span>, </span>
<span id="cb17-43"><a href="the-pizza-experiment.html#cb17-43" tabindex="-1"></a>    <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rater TR&quot;</span>, </span>
<span id="cb17-44"><a href="the-pizza-experiment.html#cb17-44" tabindex="-1"></a>    <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rater R&quot;</span></span>
<span id="cb17-45"><a href="the-pizza-experiment.html#cb17-45" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb17-46"><a href="the-pizza-experiment.html#cb17-46" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-47"><a href="the-pizza-experiment.html#cb17-47" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Time Required to Reach Pizza-Making Temperature&quot;</span>,</span>
<span id="cb17-48"><a href="the-pizza-experiment.html#cb17-48" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Target temperature: 400°C&quot;</span>,</span>
<span id="cb17-49"><a href="the-pizza-experiment.html#cb17-49" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Flame Temperature (°C)&quot;</span>, </span>
<span id="cb17-50"><a href="the-pizza-experiment.html#cb17-50" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Minutes to reach target&quot;</span></span>
<span id="cb17-51"><a href="the-pizza-experiment.html#cb17-51" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-52"><a href="the-pizza-experiment.html#cb17-52" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/01%20heating%20time%20preds-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Our analysis reveals several important insights for practical pizza making. First, the heating time decreases non-linearly with flame temperature, showing diminishing returns at very high temperatures.
We also observed differences between raters in their measured heating times. These variations likely stem from differences in measurement technique and location on the stone, highlighting the importance of consistent temperature monitoring practices. E.g. N measure the temperature at the boundary between flame and stone, which matches the model’s assumptions better than R, who measures at the center of the stone.</p>
<p>For practical application, we can provide specific heating guidelines based on our model. At a typical flame temperature of 800°C, the model predicts it will take approximately 20-30 minutes to reach optimal pizza-making temperature, assuming room temperature start. However, this time can vary significantly based on:</p>
<ul>
<li>Initial stone temperature</li>
<li>Flame temperature and consistency</li>
<li>Environmental conditions.</li>
</ul>
<p>Can we really wait that long? Well, the model is telling us that there are no shortcuts to the perfect crust!</p>
</div>
<div id="conclusion-from-pizza-to-cognitive-principles" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Conclusion: From Pizza to Cognitive Principles<a href="the-pizza-experiment.html#conclusion-from-pizza-to-cognitive-principles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The journey from modeling a heating pizza stone to understanding cognitive processes might seem unusual, but it illustrates fundamental principles that will guide us throughout this course.</p>
<p>Through this seemingly simple physics problem, we have encountered core challenges faced daily by cognitive modelers:</p>
<ul>
<li><p><em>Levels of Analysis</em>: We saw how simplifying complex equations (heat diffusion) mirrors the need to choose the right level of abstraction when modeling cognition (e.g., neural vs. behavioral).</p></li>
<li><p><em>Prior Knowledge</em>: We used physics laws to build a generative model, much like cognitive theories guide model development.</p></li>
<li><p><em>Validation</em>: We confronted the necessity of comparing model predictions to real data, a process central to testing theories.</p></li>
<li><p><em>Parameter Estimation</em>: We used the model to quantify an unobservable property (HOT) from noisy data, analogous to estimating latent cognitive parameters like learning rates or decision thresholds.</p></li>
</ul>
<p>Crucially, the comparison between purely statistical models (linear/lognormal) and the physics-based Stan model highlighted the value of mechanistic understanding. While the statistical models struggled to capture the saturation curve — often predicting impossible temperatures via extrapolation — the physics model offered deeper insight and robust predictions. This is a primary goal in cognitive modeling: we do not simply to describe <em>which</em> decisions were made, but we want to capture the underlying mechanism that can increase our understanding of <em>how</em> decisions were made, and generalize to novel unseen decisions.</p>
<p>The pizza stone experiment also demonstrated the importance of rigorous methodology. We saw how multiple measurements from different raters revealed variability in our data, leading us to consider measurement error and individual differences—themes that will become crucial when studying human behavior.</p>
<p>As we progress, these principles – careful data handling, theoretically motivated model specification (generative models), parameter estimation, rigorous validation, and balancing complexity – will be our guide. In the next chapter, we shift focus to cognition, applying these ideas to model strategic decision-making in the <strong>Matching Pennies game</strong>. We’ll encounter similar challenges: translating verbal theories of strategy into formal models, simulating agent behavior, and beginning the process of fitting models to observed choices, using the statistical and computational tools introduced here.</p>
<p>Finally, I hope this has whetted your appetite – both for pizza and for computational modeling!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-models-of-strategic-decision-making.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/01-PizzaExperiment.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
