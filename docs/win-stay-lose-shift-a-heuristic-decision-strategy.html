<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Win-Stay-Lose-Shift: A Heuristic Decision Strategy | Chapter 13: Rule-Based Models - Learning Explicit Criteria</title>
  <meta name="description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Win-Stay-Lose-Shift: A Heuristic Decision Strategy | Chapter 13: Rule-Based Models - Learning Explicit Criteria" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="My notes for the advanced cognitive modeling course - 2025" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Win-Stay-Lose-Shift: A Heuristic Decision Strategy | Chapter 13: Rule-Based Models - Learning Explicit Criteria" />
  
  <meta name="twitter:description" content="My notes for the advanced cognitive modeling course - 2025" />
  

<meta name="author" content="Riccardo Fusaroli" />


<meta name="date" content="2025-04-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mixture-models.html"/>
<link rel="next" href="bayesian-models-of-cognition.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Cognitive Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Advanced Cognitive Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-philosophy-and-approach"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy and Approach</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-structure-and-learning-path"><i class="fa fa-check"></i><b>1.2</b> Course Structure and Learning Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites-and-preparation"><i class="fa fa-check"></i><b>1.3</b> Prerequisites and Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course Resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.5</b> About These Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i><b>2</b> Foundations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="foundations.html"><a href="foundations.html#from-pizza-to-cognitive-models-an-introduction"><i class="fa fa-check"></i><b>2.1</b> From Pizza to Cognitive Models: An Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="foundations.html"><a href="foundations.html#why-start-with-pizza"><i class="fa fa-check"></i><b>2.2</b> Why Start with Pizza?</a></li>
<li class="chapter" data-level="2.3" data-path="foundations.html"><a href="foundations.html#learning-objectives"><i class="fa fa-check"></i><b>2.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.4" data-path="foundations.html"><a href="foundations.html#part-1-exploring-the-pizza-stone-temperature-data"><i class="fa fa-check"></i><b>2.4</b> Part 1: Exploring the Pizza Stone Temperature Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="foundations.html"><a href="foundations.html#initial-data-visualization"><i class="fa fa-check"></i><b>2.4.1</b> Initial Data Visualization</a></li>
<li class="chapter" data-level="2.4.2" data-path="foundations.html"><a href="foundations.html#key-observations"><i class="fa fa-check"></i><b>2.4.2</b> Key Observations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="foundations.html"><a href="foundations.html#part-2-initial-statistical-modeling"><i class="fa fa-check"></i><b>2.5</b> Part 2: Initial Statistical Modeling</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="foundations.html"><a href="foundations.html#model-setup-and-priors"><i class="fa fa-check"></i><b>2.5.1</b> Model Setup and Priors</a></li>
<li class="chapter" data-level="2.5.2" data-path="foundations.html"><a href="foundations.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.2</b> Linear Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.3" data-path="foundations.html"><a href="foundations.html#lognormal-mixed-effects-model"><i class="fa fa-check"></i><b>2.5.3</b> Lognormal Mixed-Effects Model</a></li>
<li class="chapter" data-level="2.5.4" data-path="foundations.html"><a href="foundations.html#model-comparison-and-visualization"><i class="fa fa-check"></i><b>2.5.4</b> Model Comparison and Visualization</a></li>
<li class="chapter" data-level="2.5.5" data-path="foundations.html"><a href="foundations.html#model-assessment"><i class="fa fa-check"></i><b>2.5.5</b> Model Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="foundations.html"><a href="foundations.html#part-3-understanding-the-physics-model"><i class="fa fa-check"></i><b>2.6</b> Part 3: Understanding the Physics Model</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="foundations.html"><a href="foundations.html#the-basic-temperature-evolution-equation"><i class="fa fa-check"></i><b>2.6.1</b> The Basic Temperature Evolution Equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="foundations.html"><a href="foundations.html#part-4-implementing-the-physics-based-model"><i class="fa fa-check"></i><b>2.7</b> Part 4: Implementing the Physics-Based Model</a></li>
<li class="chapter" data-level="2.8" data-path="foundations.html"><a href="foundations.html#part-5-model-analysis-and-practical-applications"><i class="fa fa-check"></i><b>2.8</b> Part 5: Model Analysis and Practical Applications</a></li>
<li class="chapter" data-level="2.9" data-path="foundations.html"><a href="foundations.html#conclusion-from-pizza-to-principles"><i class="fa fa-check"></i><b>2.9</b> Conclusion: From Pizza to Principles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html"><i class="fa fa-check"></i><b>3</b> Building Models of Strategic Decision-Making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-matching-pennies-game"><i class="fa fa-check"></i><b>3.3</b> The Matching Pennies Game</a></li>
<li class="chapter" data-level="3.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#game-structure"><i class="fa fa-check"></i><b>3.4</b> Game Structure</a></li>
<li class="chapter" data-level="3.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-investigation"><i class="fa fa-check"></i><b>3.5</b> Empirical Investigation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#data-collection-protocol"><i class="fa fa-check"></i><b>3.5.1</b> Data Collection Protocol</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#initial-observations"><i class="fa fa-check"></i><b>3.5.2</b> Initial Observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#empirical-explorations"><i class="fa fa-check"></i><b>3.6</b> Empirical explorations</a></li>
<li class="chapter" data-level="3.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#notes-from-previous-years"><i class="fa fa-check"></i><b>3.7</b> Notes from previous years</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#from-observation-to-theory"><i class="fa fa-check"></i><b>3.7.1</b> From Observation to Theory</a></li>
<li class="chapter" data-level="3.7.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#core-modeling-considerations"><i class="fa fa-check"></i><b>3.7.2</b> Core Modeling Considerations</a></li>
<li class="chapter" data-level="3.7.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#the-distinction-between-participant-and-researcher-perspectives"><i class="fa fa-check"></i><b>3.7.3</b> The distinction between participant and researcher perspectives</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#building-formal-models"><i class="fa fa-check"></i><b>3.8</b> Building Formal Models</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#random-choice-model"><i class="fa fa-check"></i><b>3.8.1</b> Random Choice Model</a></li>
<li class="chapter" data-level="3.8.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#immediate-reaction-win-stay-lose-shift"><i class="fa fa-check"></i><b>3.8.2</b> Immediate reaction (Win-Stay-Lose-Shift)</a></li>
<li class="chapter" data-level="3.8.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-perfect-memory"><i class="fa fa-check"></i><b>3.8.3</b> Keep track of the bias (perfect memory)</a></li>
<li class="chapter" data-level="3.8.4" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#keep-track-of-the-bias-imperfect-memory"><i class="fa fa-check"></i><b>3.8.4</b> Keep track of the bias (imperfect memory)</a></li>
<li class="chapter" data-level="3.8.5" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#reinforcement-learning"><i class="fa fa-check"></i><b>3.8.5</b> Reinforcement learning</a></li>
<li class="chapter" data-level="3.8.6" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#k-tom"><i class="fa fa-check"></i><b>3.8.6</b> k-ToM</a></li>
<li class="chapter" data-level="3.8.7" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#other-possible-strategies"><i class="fa fa-check"></i><b>3.8.7</b> Other possible strategies</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#cognitive-constraints"><i class="fa fa-check"></i><b>3.9</b> Cognitive constraints</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#memory"><i class="fa fa-check"></i><b>3.9.1</b> Memory</a></li>
<li class="chapter" data-level="3.9.2" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#perseveration"><i class="fa fa-check"></i><b>3.9.2</b> Perseveration</a></li>
<li class="chapter" data-level="3.9.3" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#errors"><i class="fa fa-check"></i><b>3.9.3</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#continuity-between-models"><i class="fa fa-check"></i><b>3.10</b> Continuity between models</a></li>
<li class="chapter" data-level="3.11" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#mixture-of-strategies"><i class="fa fa-check"></i><b>3.11</b> Mixture of strategies</a></li>
<li class="chapter" data-level="3.12" data-path="building-models-of-strategic-decision-making.html"><a href="building-models-of-strategic-decision-making.html#differences-from-more-traditional-general-linear-model-based-approaches"><i class="fa fa-check"></i><b>3.12</b> Differences from more traditional (general linear model-based) approaches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html"><i class="fa fa-check"></i><b>4</b> From verbal descriptions to formal models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning Goals</a></li>
<li class="chapter" data-level="4.2" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#the-value-of-formalization"><i class="fa fa-check"></i><b>4.2</b> The Value of Formalization</a></li>
<li class="chapter" data-level="4.3" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#defining-general-conditions"><i class="fa fa-check"></i><b>4.3</b> Defining general conditions</a></li>
<li class="chapter" data-level="4.4" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-random-agent"><i class="fa fa-check"></i><b>4.4</b> Implementing a random agent</a></li>
<li class="chapter" data-level="4.5" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#implementing-a-win-stay-lose-shift-agent"><i class="fa fa-check"></i><b>4.5</b> Implementing a Win-Stay-Lose-Shift agent</a></li>
<li class="chapter" data-level="4.6" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#now-we-scale-it-up"><i class="fa fa-check"></i><b>4.6</b> Now we scale it up</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#and-we-visualize-it"><i class="fa fa-check"></i><b>4.6.1</b> And we visualize it</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="from-verbal-descriptions-to-formal-models.html"><a href="from-verbal-descriptions-to-formal-models.html#conclusion"><i class="fa fa-check"></i><b>4.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html"><i class="fa fa-check"></i><b>5</b> From simulation to model fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-challenge-of-model-fitting"><i class="fa fa-check"></i><b>5.2</b> The Challenge of Model Fitting</a></li>
<li class="chapter" data-level="5.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#simulating-data"><i class="fa fa-check"></i><b>5.3</b> Simulating data</a></li>
<li class="chapter" data-level="5.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#building-our-basic-model-in-stan"><i class="fa fa-check"></i><b>5.4</b> Building our basic model in Stan</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#model"><i class="fa fa-check"></i><b>5.4.2</b> Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#compiling-and-fitting-the-model"><i class="fa fa-check"></i><b>5.4.3</b> Compiling and fitting the model</a></li>
<li class="chapter" data-level="5.4.4" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#assessing-model-quality"><i class="fa fa-check"></i><b>5.4.4</b> Assessing model quality</a></li>
<li class="chapter" data-level="5.4.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results"><i class="fa fa-check"></i><b>5.4.5</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#parameter-recovery"><i class="fa fa-check"></i><b>5.5</b> Parameter recovery</a></li>
<li class="chapter" data-level="5.6" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#the-memory-model-conditioning-theta"><i class="fa fa-check"></i><b>5.6</b> The memory model: conditioning theta</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#summarizing-the-results-1"><i class="fa fa-check"></i><b>5.6.1</b> Summarizing the results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#memory-agent-with-internal-parameter"><i class="fa fa-check"></i><b>5.7</b> Memory agent with internal parameter</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#trying-out-a-more-complex-memory-model-with-a-rate-of-forgetting-that-exponentially-discounts-the-past"><i class="fa fa-check"></i><b>5.7.1</b> Trying out a more complex memory model, with a rate of forgetting that exponentially discounts the past</a></li>
<li class="chapter" data-level="5.7.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-kalman-filters"><i class="fa fa-check"></i><b>5.7.2</b> Connection to Kalman Filters</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#relationship-to-rescorla-wagner"><i class="fa fa-check"></i><b>5.8</b> Relationship to Rescorla-Wagner</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#connection-to-hierarchical-gaussian-filter-hgf"><i class="fa fa-check"></i><b>5.8.1</b> Connection to Hierarchical Gaussian Filter (HGF)</a></li>
<li class="chapter" data-level="5.8.2" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#implications-for-model-development"><i class="fa fa-check"></i><b>5.8.2</b> Implications for Model Development</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#bayesian-memory-agent"><i class="fa fa-check"></i><b>5.9</b> Bayesian memory agent</a></li>
<li class="chapter" data-level="5.10" data-path="from-simulation-to-model-fitting.html"><a href="from-simulation-to-model-fitting.html#conclusion-from-simple-models-to-complex-cognitive-processes"><i class="fa fa-check"></i><b>5.10</b> Conclusion: From Simple Models to Complex Cognitive Processes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html"><i class="fa fa-check"></i><b>6</b> Model Quality Assessment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#generating-and-plotting-additional-variables"><i class="fa fa-check"></i><b>6.2</b> Generating and plotting additional variables</a></li>
<li class="chapter" data-level="6.3" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#assessing-priors"><i class="fa fa-check"></i><b>6.3</b> Assessing priors</a></li>
<li class="chapter" data-level="6.4" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-predictive-checks"><i class="fa fa-check"></i><b>6.4</b> Prior Predictive Checks</a></li>
<li class="chapter" data-level="6.5" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.5</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="6.6" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>6.6</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="6.7" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#the-memory-model"><i class="fa fa-check"></i><b>6.7</b> The memory model</a></li>
<li class="chapter" data-level="6.8" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#prior-sensitivity-check-for-the-memory-model"><i class="fa fa-check"></i><b>6.8</b> Prior sensitivity check for the memory model</a></li>
<li class="chapter" data-level="6.9" data-path="model-quality-assessment.html"><a href="model-quality-assessment.html#conclusion-1"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><i class="fa fa-check"></i><b>7</b> Individual Differences in Cognitive Strategies (Multilevel modeling)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#the-value-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.3</b> The Value of Multilevel Modeling</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#complete-pooling"><i class="fa fa-check"></i><b>7.3.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="7.3.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#no-pooling"><i class="fa fa-check"></i><b>7.3.2</b> No Pooling</a></li>
<li class="chapter" data-level="7.3.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#partial-pooling-multilevel-modeling"><i class="fa fa-check"></i><b>7.3.3</b> Partial Pooling (Multilevel Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#graphical-model-visualization"><i class="fa fa-check"></i><b>7.4</b> Graphical Model Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#biased-agent-model"><i class="fa fa-check"></i><b>7.4.1</b> Biased Agent Model</a></li>
<li class="chapter" data-level="7.4.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#memory-agent-model"><i class="fa fa-check"></i><b>7.4.2</b> Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#generating-the-agents"><i class="fa fa-check"></i><b>7.5</b> Generating the agents</a></li>
<li class="chapter" data-level="7.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#plotting-the-agents"><i class="fa fa-check"></i><b>7.6</b> Plotting the agents</a></li>
<li class="chapter" data-level="7.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#coding-the-multilevel-agents"><i class="fa fa-check"></i><b>7.7</b> Coding the multilevel agents</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random"><i class="fa fa-check"></i><b>7.7.1</b> Multilevel random</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-random-agent-model"><i class="fa fa-check"></i><b>7.8</b> Multilevel Random Agent Model</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-random-agents"><i class="fa fa-check"></i><b>7.8.1</b> Assessing multilevel random agents</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#lets-look-at-individuals"><i class="fa fa-check"></i><b>7.9</b> Letâ€™s look at individuals</a></li>
<li class="chapter" data-level="7.10" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#prior-sensitivity-checks"><i class="fa fa-check"></i><b>7.10</b> Prior sensitivity checks</a></li>
<li class="chapter" data-level="7.11" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-1"><i class="fa fa-check"></i><b>7.11</b> Parameter recovery</a></li>
<li class="chapter" data-level="7.12" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-agent-model"><i class="fa fa-check"></i><b>7.12</b> Multilevel Memory Agent Model</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory"><i class="fa fa-check"></i><b>7.12.1</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#diagnosing-the-issue-with-bias-and-beta"><i class="fa fa-check"></i><b>7.12.2</b> Diagnosing the issue with bias and beta</a></li>
<li class="chapter" data-level="7.12.3" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-non-centered-parameterization"><i class="fa fa-check"></i><b>7.12.3</b> Multilevel memory with non centered parameterization</a></li>
<li class="chapter" data-level="7.12.4" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-1"><i class="fa fa-check"></i><b>7.12.4</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.5" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-memory-with-correlation-between-parameters"><i class="fa fa-check"></i><b>7.12.5</b> Multilevel memory with correlation between parameters</a></li>
<li class="chapter" data-level="7.12.6" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#assessing-multilevel-memory-2"><i class="fa fa-check"></i><b>7.12.6</b> Assessing multilevel memory</a></li>
<li class="chapter" data-level="7.12.7" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#section"><i class="fa fa-check"></i><b>7.12.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches"><i class="fa fa-check"></i><b>7.13</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.14" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#comparing-pooling-approaches-1"><i class="fa fa-check"></i><b>7.14</b> Comparing Pooling Approaches</a></li>
<li class="chapter" data-level="7.15" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#multilevel-modeling-cheatsheet"><i class="fa fa-check"></i><b>7.15</b> Multilevel Modeling Cheatsheet</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#when-to-use-each-pooling-approach"><i class="fa fa-check"></i><b>7.15.1</b> When to Use Each Pooling Approach:</a></li>
<li class="chapter" data-level="7.15.2" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#parameter-recovery-rules-of-thumb"><i class="fa fa-check"></i><b>7.15.2</b> Parameter Recovery Rules of Thumb:</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#conclusion-the-power-and-challenges-of-multilevel-modeling"><i class="fa fa-check"></i><b>7.16</b> Conclusion: The Power and Challenges of Multilevel Modeling</a></li>
<li class="chapter" data-level="7.17" data-path="individual-differences-in-cognitive-strategies-multilevel-modeling.html"><a href="individual-differences-in-cognitive-strategies-multilevel-modeling.html#exercises-just-some-ideas"><i class="fa fa-check"></i><b>7.17</b> Exercises (just some ideas)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html"><i class="fa fa-check"></i><b>8</b> Model Comparison in Cognitive Science</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#why-compare-models"><i class="fa fa-check"></i><b>8.2</b> Why Compare Models?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-challenge-of-model-selection"><i class="fa fa-check"></i><b>8.2.1</b> The Challenge of Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-the-foundation-of-model-comparison"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation: The Foundation of Model Comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-problem-of-overfitting"><i class="fa fa-check"></i><b>8.3.1</b> The Problem of Overfitting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-cross-validation-works"><i class="fa fa-check"></i><b>8.3.2</b> How Cross-Validation Works</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-in-bayesian-models"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation in Bayesian Models</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#expected-log-predictive-density-elpd"><i class="fa fa-check"></i><b>8.3.4</b> Expected Log Predictive Density (ELPD)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-an-efficient-approximation-to-loo-cv"><i class="fa fa-check"></i><b>8.4</b> PSIS-LOO: An Efficient Approximation to LOO-CV</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#how-importance-sampling-works"><i class="fa fa-check"></i><b>8.4.1</b> How Importance Sampling Works</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#pareto-smoothing-for-stability"><i class="fa fa-check"></i><b>8.4.2</b> Pareto Smoothing for Stability</a></li>
<li class="chapter" data-level="8.4.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#the-complete-psis-loo-process"><i class="fa fa-check"></i><b>8.4.3</b> The Complete PSIS-LOO Process</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#simulation-based-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Simulation-Based Model Comparison</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-simulation-parameters"><i class="fa fa-check"></i><b>8.5.1</b> Define Simulation Parameters</a></li>
<li class="chapter" data-level="8.5.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#define-agent-functions"><i class="fa fa-check"></i><b>8.5.2</b> Define Agent Functions</a></li>
<li class="chapter" data-level="8.5.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#generate-simulation-data"><i class="fa fa-check"></i><b>8.5.3</b> Generate Simulation Data</a></li>
<li class="chapter" data-level="8.5.4" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualize-the-simulation-data"><i class="fa fa-check"></i><b>8.5.4</b> Visualize the Simulation Data</a></li>
<li class="chapter" data-level="8.5.5" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#prepare-data-for-stan-models"><i class="fa fa-check"></i><b>8.5.5</b> Prepare Data for Stan Models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#implementing-models-for-comparison"><i class="fa fa-check"></i><b>8.6</b> Implementing Models for Comparison</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#understanding-log-likelihood-in-model-comparison"><i class="fa fa-check"></i><b>8.6.1</b> Understanding Log-Likelihood in Model Comparison</a></li>
<li class="chapter" data-level="8.6.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-biased-agent-model"><i class="fa fa-check"></i><b>8.6.2</b> Multilevel Biased Agent Model</a></li>
<li class="chapter" data-level="8.6.3" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#multilevel-memory-agent-model-1"><i class="fa fa-check"></i><b>8.6.3</b> Multilevel Memory Agent Model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-models-and-calculating-expected-log-predictive-density"><i class="fa fa-check"></i><b>8.7</b> Fitting Models and Calculating Expected Log Predictive Density</a></li>
<li class="chapter" data-level="8.8" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#fitting-the-models-to-the-data"><i class="fa fa-check"></i><b>8.8</b> Fitting the models to the data</a></li>
<li class="chapter" data-level="8.9" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#cross-validation-for-model-comparison"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation for Model Comparison</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#psis-loo-comparison"><i class="fa fa-check"></i><b>8.9.1</b> PSIS-LOO Comparison</a></li>
<li class="chapter" data-level="8.9.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#visualizing-loo-cv-results"><i class="fa fa-check"></i><b>8.9.2</b> Visualizing LOO-CV Results</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#formal-model-comparison"><i class="fa fa-check"></i><b>8.10</b> Formal Model Comparison</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#k-fold-cross-validation-for-validation"><i class="fa fa-check"></i><b>8.10.1</b> K-Fold Cross-Validation for Validation</a></li>
<li class="chapter" data-level="8.10.2" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#comparing-loo-and-k-fold-results"><i class="fa fa-check"></i><b>8.10.2</b> Comparing LOO and K-Fold Results</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#limitations-of-model-comparison-approaches"><i class="fa fa-check"></i><b>8.11</b> Limitations of Model Comparison Approaches</a></li>
<li class="chapter" data-level="8.12" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#exercises"><i class="fa fa-check"></i><b>8.12</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="model-comparison-in-cognitive-science.html"><a href="model-comparison-in-cognitive-science.html#rant-on-internal-vs-external-validity"><i class="fa fa-check"></i><b>8.12.1</b> Rant on internal vs external validity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>9</b> Mixture models</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="mixture-models.html"><a href="mixture-models.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.0.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.0.2" data-path="mixture-models.html"><a href="mixture-models.html#chapter-roadmap"><i class="fa fa-check"></i><b>9.0.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="9.1" data-path="mixture-models.html"><a href="mixture-models.html#visualizing-mixture-distributions-reaction-time-example"><i class="fa fa-check"></i><b>9.1</b> Visualizing Mixture Distributions: Reaction Time Example</a></li>
<li class="chapter" data-level="9.2" data-path="mixture-models.html"><a href="mixture-models.html#theoretical-foundation-for-mixture-models"><i class="fa fa-check"></i><b>9.2</b> Theoretical Foundation for Mixture Models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mixture-models.html"><a href="mixture-models.html#the-mixture-model-framework"><i class="fa fa-check"></i><b>9.2.1</b> The Mixture Model Framework</a></li>
<li class="chapter" data-level="9.2.2" data-path="mixture-models.html"><a href="mixture-models.html#mixture-models-and-latent-variables"><i class="fa fa-check"></i><b>9.2.2</b> Mixture Models and Latent Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-in-cognitive-modeling"><i class="fa fa-check"></i><b>9.2.3</b> Applications in Cognitive Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mixture-models.html"><a href="mixture-models.html#implementing-a-basic-mixture-model"><i class="fa fa-check"></i><b>9.3</b> Implementing a Basic Mixture Model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixture-models.html"><a href="mixture-models.html#simulating-mixed-strategy-data"><i class="fa fa-check"></i><b>9.3.1</b> Simulating Mixed Strategy Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation-of-a-mixture-model"><i class="fa fa-check"></i><b>9.3.2</b> Stan Implementation of a Mixture Model</a></li>
<li class="chapter" data-level="9.3.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-mixture-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting and Evaluating the Mixture Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="mixture-models.html"><a href="mixture-models.html#model-diagnostics"><i class="fa fa-check"></i><b>9.3.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="9.3.5" data-path="mixture-models.html"><a href="mixture-models.html#parameter-recovery-analysis"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="9.3.6" data-path="mixture-models.html"><a href="mixture-models.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>9.3.6</b> Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixture-models.html"><a href="mixture-models.html#parameter-interpretation"><i class="fa fa-check"></i><b>9.4</b> Parameter Interpretation</a></li>
<li class="chapter" data-level="9.5" data-path="mixture-models.html"><a href="mixture-models.html#multilevel-mixture-models"><i class="fa fa-check"></i><b>9.5</b> Multilevel Mixture Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mixture-models.html"><a href="mixture-models.html#stan-implementation"><i class="fa fa-check"></i><b>9.5.1</b> Stan Implementation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mixture-models.html"><a href="mixture-models.html#preparing-data-for-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.2</b> Preparing Data for the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.3" data-path="mixture-models.html"><a href="mixture-models.html#fitting-and-evaluating-the-multilevel-model"><i class="fa fa-check"></i><b>9.5.3</b> Fitting and Evaluating the Multilevel Model</a></li>
<li class="chapter" data-level="9.5.4" data-path="mixture-models.html"><a href="mixture-models.html#examining-individual-differences"><i class="fa fa-check"></i><b>9.5.4</b> Examining Individual Differences</a></li>
<li class="chapter" data-level="9.5.5" data-path="mixture-models.html"><a href="mixture-models.html#interpreting-parameter-correlations"><i class="fa fa-check"></i><b>9.5.5</b> Interpreting Parameter Correlations</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mixture-models.html"><a href="mixture-models.html#comparing-single-process-and-mixture-models"><i class="fa fa-check"></i><b>9.6</b> Comparing Single-Process and Mixture Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mixture-models.html"><a href="mixture-models.html#single-process-model"><i class="fa fa-check"></i><b>9.6.1</b> Single-Process Model</a></li>
<li class="chapter" data-level="9.6.2" data-path="mixture-models.html"><a href="mixture-models.html#model-comparison"><i class="fa fa-check"></i><b>9.6.2</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6.3" data-path="mixture-models.html"><a href="mixture-models.html#applications-of-mixture-models-in-cognitive-science"><i class="fa fa-check"></i><b>9.6.3</b> Applications of Mixture Models in Cognitive Science</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mixture-models.html"><a href="mixture-models.html#conclusion-2"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html"><i class="fa fa-check"></i><b>10</b> Win-Stay-Lose-Shift: A Heuristic Decision Strategy</a>
<ul>
<li class="chapter" data-level="10.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#loading-required-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading Required Packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#generating-data-simulating-wsls-agents"><i class="fa fa-check"></i><b>10.2</b> Generating Data: Simulating WSLS Agents</a></li>
<li class="chapter" data-level="10.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#data-processing-and-initial-visualization"><i class="fa fa-check"></i><b>10.3</b> Data Processing and Initial Visualization</a></li>
<li class="chapter" data-level="10.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#verifying-model-properties-and-assumptions"><i class="fa fa-check"></i><b>10.4</b> Verifying Model Properties and Assumptions</a></li>
<li class="chapter" data-level="10.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#modeling-a-single-wsls-agent"><i class="fa fa-check"></i><b>10.5</b> Modeling a Single WSLS Agent</a></li>
<li class="chapter" data-level="10.6" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#multilevel-wsls-model"><i class="fa fa-check"></i><b>10.6</b> Multilevel WSLS Model</a></li>
<li class="chapter" data-level="10.7" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#quality-checks-and-parameter-recovery"><i class="fa fa-check"></i><b>10.7</b> Quality Checks and Parameter Recovery</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#convergence-diagnostics"><i class="fa fa-check"></i><b>10.7.1</b> Convergence Diagnostics</a></li>
<li class="chapter" data-level="10.7.2" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#prior-posterior-update-visualization"><i class="fa fa-check"></i><b>10.7.2</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="10.7.3" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#individual-level-parameter-recovery"><i class="fa fa-check"></i><b>10.7.3</b> Individual-Level Parameter Recovery</a></li>
<li class="chapter" data-level="10.7.4" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#posterior-predictive-checks-2"><i class="fa fa-check"></i><b>10.7.4</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="10.7.5" data-path="win-stay-lose-shift-a-heuristic-decision-strategy.html"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#model-comparison-with-loo-cv"><i class="fa fa-check"></i><b>10.7.5</b> Model Comparison with LOO-CV</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html"><i class="fa fa-check"></i><b>11</b> Bayesian Models of Cognition</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#introduction-4"><i class="fa fa-check"></i><b>11.0.1</b> Introduction</a></li>
<li class="chapter" data-level="11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#learning-objectives-4"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#chapter-roadmap-1"><i class="fa fa-check"></i><b>11.2</b> Chapter Roadmap</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-bayesian-framework-for-cognition"><i class="fa fa-check"></i><b>11.3</b> The Bayesian Framework for Cognition</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-updating"><i class="fa fa-check"></i><b>11.4</b> Visualizing Bayesian Updating</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#bayesian-models-in-cognitive-science"><i class="fa fa-check"></i><b>11.5</b> Bayesian Models in Cognitive Science</a></li>
<li class="chapter" data-level="11.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#example-social-influence-in-perceptual-decision-making"><i class="fa fa-check"></i><b>11.6</b> Example: Social Influence in Perceptual Decision-Making</a></li>
<li class="chapter" data-level="11.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#a-bayesian-integration-model-for-the-marble-task"><i class="fa fa-check"></i><b>11.7</b> A Bayesian Integration Model for the Marble Task</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#intuitive-explanation-using-beta-distributions"><i class="fa fa-check"></i><b>11.7.1</b> Intuitive Explanation Using Beta Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model"><i class="fa fa-check"></i><b>11.8</b> The Mathematical Model</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#evidence-representation"><i class="fa fa-check"></i><b>11.8.1</b> Evidence Representation</a></li>
<li class="chapter" data-level="11.8.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration"><i class="fa fa-check"></i><b>11.8.2</b> Integration</a></li>
<li class="chapter" data-level="11.8.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#decision"><i class="fa fa-check"></i><b>11.8.3</b> Decision</a></li>
<li class="chapter" data-level="11.8.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation-in-r"><i class="fa fa-check"></i><b>11.8.4</b> Implementation in R</a></li>
<li class="chapter" data-level="11.8.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-experimental-scenarios"><i class="fa fa-check"></i><b>11.8.5</b> Simulating Experimental Scenarios</a></li>
<li class="chapter" data-level="11.8.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-bayesian-integration"><i class="fa fa-check"></i><b>11.8.6</b> Visualizing Bayesian Integration</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-belief-distributions-for-selected-scenarios"><i class="fa fa-check"></i><b>11.9</b> Examining Belief Distributions for Selected Scenarios</a></li>
<li class="chapter" data-level="11.10" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10</b> Weighted Bayesian Integration</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematical-model-1"><i class="fa fa-check"></i><b>11.10.1</b> The Mathematical Model</a></li>
<li class="chapter" data-level="11.10.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementation"><i class="fa fa-check"></i><b>11.10.2</b> Implementation</a></li>
<li class="chapter" data-level="11.10.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-weighted-bayesian-integration"><i class="fa fa-check"></i><b>11.10.3</b> Visualizing Weighted Bayesian Integration</a></li>
<li class="chapter" data-level="11.10.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#resolving-conflicting-evidence"><i class="fa fa-check"></i><b>11.10.4</b> Resolving Conflicting Evidence</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#common-misinterpretations"><i class="fa fa-check"></i><b>11.11</b> Common Misinterpretations</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#weight-interpretation"><i class="fa fa-check"></i><b>11.11.1</b> Weight Interpretation</a></li>
<li class="chapter" data-level="11.11.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#integration-vs.-averaging"><i class="fa fa-check"></i><b>11.11.2</b> Integration vs.Â Averaging</a></li>
<li class="chapter" data-level="11.11.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#interpreting-confidence"><i class="fa fa-check"></i><b>11.11.3</b> Interpreting Confidence</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-agents-with-different-evidence-weighting-strategies"><i class="fa fa-check"></i><b>11.12</b> Simulating Agents with Different Evidence Weighting Strategies</a></li>
<li class="chapter" data-level="11.13" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-observations-from-the-simulation"><i class="fa fa-check"></i><b>11.13</b> Key Observations from the Simulation</a></li>
<li class="chapter" data-level="11.14" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-quality-checks"><i class="fa fa-check"></i><b>11.14</b> Model Quality Checks</a>
<ul>
<li class="chapter" data-level="11.14.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#overview"><i class="fa fa-check"></i><b>11.14.1</b> Overview</a></li>
<li class="chapter" data-level="11.14.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-and-posterior-predictive-checks"><i class="fa fa-check"></i><b>11.14.2</b> Prior and Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="11.15" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#prior-posterior-update-visualization-1"><i class="fa fa-check"></i><b>11.15</b> Prior-Posterior Update Visualization</a></li>
<li class="chapter" data-level="11.16" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-2"><i class="fa fa-check"></i><b>11.16</b> Parameter recovery</a></li>
<li class="chapter" data-level="11.17" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-1"><i class="fa fa-check"></i><b>11.17</b> Model comparison</a></li>
<li class="chapter" data-level="11.18" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#leave-one-out-cross-validation-and-model-comparison"><i class="fa fa-check"></i><b>11.18</b> Leave-One-Out Cross-Validation and Model Comparison</a>
<ul>
<li class="chapter" data-level="11.18.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-loo-cross-validation-in-bayesian-framework"><i class="fa fa-check"></i><b>11.18.1</b> Understanding LOO Cross-Validation in Bayesian Framework</a></li>
<li class="chapter" data-level="11.18.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#step-by-step-implementation-of-loo-cv"><i class="fa fa-check"></i><b>11.18.2</b> Step-by-Step Implementation of LOO-CV</a></li>
<li class="chapter" data-level="11.18.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-psis-loo-diagnostics"><i class="fa fa-check"></i><b>11.18.3</b> Understanding PSIS-LOO Diagnostics</a></li>
<li class="chapter" data-level="11.18.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-for-each-scenario"><i class="fa fa-check"></i><b>11.18.4</b> Model Comparison for Each Scenario</a></li>
<li class="chapter" data-level="11.18.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#visualizing-the-comparison-results"><i class="fa fa-check"></i><b>11.18.5</b> Visualizing the Comparison Results</a></li>
<li class="chapter" data-level="11.18.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-results"><i class="fa fa-check"></i><b>11.18.6</b> Understanding the Results</a></li>
<li class="chapter" data-level="11.18.7" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-mathematics-behind-loo-cv"><i class="fa fa-check"></i><b>11.18.7</b> The Mathematics Behind LOO-CV</a></li>
<li class="chapter" data-level="11.18.8" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#examining-pointwise-contributions-to-loo"><i class="fa fa-check"></i><b>11.18.8</b> Examining Pointwise Contributions to LOO</a></li>
</ul></li>
<li class="chapter" data-level="11.19" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models"><i class="fa fa-check"></i><b>11.19</b> Multilevel Bayesian Models</a>
<ul>
<li class="chapter" data-level="11.19.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#simulating-data-from-multiple-agents"><i class="fa fa-check"></i><b>11.19.1</b> Simulating Data from Multiple Agents</a></li>
<li class="chapter" data-level="11.19.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-the-simulated-data"><i class="fa fa-check"></i><b>11.19.2</b> Understanding the Simulated Data</a></li>
</ul></li>
<li class="chapter" data-level="11.20" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-bayesian-models-for-evidence-integration"><i class="fa fa-check"></i><b>11.20</b> Multilevel Bayesian Models for Evidence Integration</a>
<ul>
<li class="chapter" data-level="11.20.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-1-simple-evidence-integration-with-individual-scaling"><i class="fa fa-check"></i><b>11.20.1</b> Model 1: Simple Evidence Integration with Individual Scaling</a></li>
<li class="chapter" data-level="11.20.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-2-weighted-evidence-integration"><i class="fa fa-check"></i><b>11.20.2</b> Model 2: Weighted Evidence Integration</a></li>
<li class="chapter" data-level="11.20.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-allow-scaling-to-vary-in-the-simple-model"><i class="fa fa-check"></i><b>11.20.3</b> Why Allow Scaling to Vary in the Simple Model?</a></li>
</ul></li>
<li class="chapter" data-level="11.21" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#from-single-agent-to-multilevel-extending-bayesian-cognitive-models"><i class="fa fa-check"></i><b>11.21</b> From Single-Agent to Multilevel: Extending Bayesian Cognitive Models</a>
<ul>
<li class="chapter" data-level="11.21.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#key-components-of-the-multilevel-extension"><i class="fa fa-check"></i><b>11.21.1</b> Key Components of the Multilevel Extension</a></li>
<li class="chapter" data-level="11.21.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#hierarchical-prior-structure"><i class="fa fa-check"></i><b>11.21.2</b> 2. Hierarchical Prior Structure</a></li>
<li class="chapter" data-level="11.21.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#handling-data-from-multiple-individuals"><i class="fa fa-check"></i><b>11.21.3</b> 3. Handling Data from Multiple Individuals</a></li>
<li class="chapter" data-level="11.21.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#likelihood-specification"><i class="fa fa-check"></i><b>11.21.4</b> 4. Likelihood Specification</a></li>
<li class="chapter" data-level="11.21.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#why-these-changes-matter"><i class="fa fa-check"></i><b>11.21.5</b> Why These Changes Matter</a></li>
<li class="chapter" data-level="11.21.6" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#implementing-the-multilevel-weighted-beta-binomial-model-in-stan"><i class="fa fa-check"></i><b>11.21.6</b> Implementing the Multilevel Weighted Beta-Binomial Model in Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.22" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-the-multilevel-models"><i class="fa fa-check"></i><b>11.22</b> Fitting the Multilevel Models</a>
<ul>
<li class="chapter" data-level="11.22.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#parameter-recovery-analysis-1"><i class="fa fa-check"></i><b>11.22.1</b> Parameter Recovery Analysis</a></li>
<li class="chapter" data-level="11.22.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#model-comparison-2"><i class="fa fa-check"></i><b>11.22.2</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11.23" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#dynamic-bayesian-evidence-integration-sequential-updating-models"><i class="fa fa-check"></i><b>11.23</b> Dynamic Bayesian Evidence Integration: Sequential Updating Models</a>
<ul>
<li class="chapter" data-level="11.23.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-updating-the-theoretical-framework"><i class="fa fa-check"></i><b>11.23.1</b> Sequential Bayesian Updating: The Theoretical Framework</a></li>
<li class="chapter" data-level="11.23.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#single-agent-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.2</b> Single-Agent Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#multilevel-sequential-updating-model"><i class="fa fa-check"></i><b>11.23.3</b> Multilevel Sequential Updating Model</a></li>
<li class="chapter" data-level="11.23.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#generating-data-for-the-sequential-model"><i class="fa fa-check"></i><b>11.23.4</b> Generating Data for the Sequential Model</a></li>
<li class="chapter" data-level="11.23.5" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#fitting-and-evaluating-the-sequential-models"><i class="fa fa-check"></i><b>11.23.5</b> Fitting and Evaluating the Sequential Models</a></li>
</ul></li>
<li class="chapter" data-level="11.24" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#sequential-bayesian-evidence-integration-models"><i class="fa fa-check"></i><b>11.24</b> Sequential Bayesian Evidence Integration Models</a>
<ul>
<li class="chapter" data-level="11.24.1" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#understanding-belief-updating-over-time"><i class="fa fa-check"></i><b>11.24.1</b> Understanding Belief Updating Over Time</a></li>
<li class="chapter" data-level="11.24.2" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#the-sequential-updating-framework"><i class="fa fa-check"></i><b>11.24.2</b> The Sequential Updating Framework</a></li>
<li class="chapter" data-level="11.24.3" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#mathematical-formulation"><i class="fa fa-check"></i><b>11.24.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="11.24.4" data-path="bayesian-models-of-cognition.html"><a href="bayesian-models-of-cognition.html#moving-from-single-agent-to-multilevel"><i class="fa fa-check"></i><b>11.24.4</b> Moving from Single-Agent to Multilevel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html"><i class="fa fa-check"></i><b>12</b> Introduction to Categorization Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-fundamental-problem-of-categorization"><i class="fa fa-check"></i><b>12.1</b> The Fundamental Problem of Categorization</a></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#why-model-categorization"><i class="fa fa-check"></i><b>12.2</b> Why Model Categorization?</a></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#historical-development-of-categorization-models"><i class="fa fa-check"></i><b>12.3</b> Historical Development of Categorization Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#early-views-the-classical-approach"><i class="fa fa-check"></i><b>12.3.1</b> Early Views: The Classical Approach</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-prototype-revolution"><i class="fa fa-check"></i><b>12.3.2</b> The Prototype Revolution</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-exemplar-alternative"><i class="fa fa-check"></i><b>12.3.3</b> The Exemplar Alternative</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models"><i class="fa fa-check"></i><b>12.3.4</b> Rule-Based Models</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-three-model-classes-core-assumptions-and-predictions"><i class="fa fa-check"></i><b>12.4</b> The Three Model Classes: Core Assumptions and Predictions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#exemplar-models-individual-instances-as-category-representations"><i class="fa fa-check"></i><b>12.4.1</b> Exemplar Models: Individual Instances as Category Representations</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#prototype-models-categories-as-central-tendencies"><i class="fa fa-check"></i><b>12.4.2</b> Prototype Models: Categories as Central Tendencies</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#rule-based-models-categories-as-decision-boundaries"><i class="fa fa-check"></i><b>12.4.3</b> Rule-Based Models: Categories as Decision Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#our-implementation-approach"><i class="fa fa-check"></i><b>12.5</b> Our Implementation Approach</a></li>
<li class="chapter" data-level="12.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.6</b> The Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-foundations-and-cognitive-principles"><i class="fa fa-check"></i><b>12.6.1</b> Mathematical Foundations and Cognitive Principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#core-assumptions-of-the-gcm"><i class="fa fa-check"></i><b>12.6.2</b> Core Assumptions of the GCM</a></li>
<li class="chapter" data-level="12.6.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-1"><i class="fa fa-check"></i><b>12.6.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="12.6.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-gcm-agent-implementation"><i class="fa fa-check"></i><b>12.6.4</b> The GCM Agent Implementation</a></li>
<li class="chapter" data-level="12.6.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-behavior-with-the-gcm"><i class="fa fa-check"></i><b>12.6.5</b> Simulating Behavior with the GCM</a></li>
<li class="chapter" data-level="12.6.6" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-gcm-in-stan-for-parameter-estimation"><i class="fa fa-check"></i><b>12.6.6</b> Implementing the GCM in Stan for Parameter Estimation</a></li>
<li class="chapter" data-level="12.6.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#key-parameters-and-their-cognitive-interpretations"><i class="fa fa-check"></i><b>12.6.7</b> Key Parameters and Their Cognitive Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#multilevel-generalized-context-model-gcm"><i class="fa fa-check"></i><b>12.7</b> Multilevel Generalized Context Model (GCM)</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#the-need-for-a-multilevel-approach"><i class="fa fa-check"></i><b>12.7.1</b> The Need for a Multilevel Approach</a></li>
<li class="chapter" data-level="12.7.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#mathematical-formulation-of-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.2</b> Mathematical Formulation of the Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.3" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#simulating-data-for-a-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.3</b> Simulating Data for a Multilevel GCM</a></li>
<li class="chapter" data-level="12.7.4" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#implementing-the-multilevel-gcm-in-stan"><i class="fa fa-check"></i><b>12.7.4</b> Implementing the Multilevel GCM in Stan</a></li>
<li class="chapter" data-level="12.7.5" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#fitting-the-multilevel-gcm"><i class="fa fa-check"></i><b>12.7.5</b> Fitting the Multilevel GCM</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#gcm-in-context-strengths-and-limitations"><i class="fa fa-check"></i><b>12.8</b> GCM in Context: Strengths and Limitations</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#strengths"><i class="fa fa-check"></i><b>12.8.1</b> Strengths</a></li>
<li class="chapter" data-level="12.8.2" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#limitations"><i class="fa fa-check"></i><b>12.8.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="introduction-to-categorization-models.html"><a href="introduction-to-categorization-models.html#some-notes-about-student-produced-models-of-categorization"><i class="fa fa-check"></i><b>12.9</b> Some notes about student-produced models of categorization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html"><i class="fa fa-check"></i><b>13</b> Prototype-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="13.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#rethinking-category-representation-from-examples-to-averages"><i class="fa fa-check"></i><b>13.1</b> Rethinking Category Representation: From Examples to Averages</a></li>
<li class="chapter" data-level="13.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#core-ideas-of-prototype-models"><i class="fa fa-check"></i><b>13.2</b> Core Ideas of Prototype Models:</a></li>
<li class="chapter" data-level="13.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#modeling-dynamic-prototypes-the-kalman-filter"><i class="fa fa-check"></i><b>13.3</b> Modeling Dynamic Prototypes: The Kalman Filter</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-kalman-filter-logic-updating-an-estimate"><i class="fa fa-check"></i><b>13.3.1</b> The Kalman Filter Logic: Updating an Estimate</a></li>
<li class="chapter" data-level="13.3.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#extending-to-multiple-features-multivariate-kalman-filter"><i class="fa fa-check"></i><b>13.3.2</b> Extending to Multiple Features: Multivariate Kalman Filter</a></li>
<li class="chapter" data-level="13.3.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#implementing-the-multivariate-update-in-r"><i class="fa fa-check"></i><b>13.3.3</b> Implementing the Multivariate Update in R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#building-the-full-categorization-model"><i class="fa fa-check"></i><b>13.4</b> Building the Full Categorization Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#initialization"><i class="fa fa-check"></i><b>13.4.1</b> Initialization</a></li>
<li class="chapter" data-level="13.4.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#categorization-decision"><i class="fa fa-check"></i><b>13.4.2</b> Categorization Decision</a></li>
<li class="chapter" data-level="13.4.3" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-learning-loop"><i class="fa fa-check"></i><b>13.4.3</b> The Learning Loop</a></li>
<li class="chapter" data-level="13.4.4" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#r-implementation-of-the-prototype-agent"><i class="fa fa-check"></i><b>13.4.4</b> R Implementation of the Prototype Agent</a></li>
<li class="chapter" data-level="13.4.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#simulating-categorization-behavior"><i class="fa fa-check"></i><b>13.4.5</b> Simulating Categorization Behavior</a></li>
<li class="chapter" data-level="13.4.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#visualizing-prototype-evolution"><i class="fa fa-check"></i><b>13.4.6</b> Visualizing Prototype Evolution</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#estimating-parameters-implementing-the-prototype-model-in-stan"><i class="fa fa-check"></i><b>13.5</b> Estimating Parameters: Implementing the Prototype Model in Stan</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#the-stan-model-w12_prototype_single.stan"><i class="fa fa-check"></i><b>13.5.1</b> The Stan Model (W12_prototype_single.stan)</a></li>
<li class="chapter" data-level="13.5.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#parameter-recovery-can-we-retrieve-the-noise-parameter"><i class="fa fa-check"></i><b>13.5.2</b> Parameter Recovery: Can We Retrieve the Noise Parameter?</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#cognitive-insights-and-model-comparison"><i class="fa fa-check"></i><b>13.6</b> Cognitive Insights and Model Comparison</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#comparing-to-exemplar-models-gcm"><i class="fa fa-check"></i><b>13.6.1</b> Comparing to Exemplar Models (GCM):</a></li>
<li class="chapter" data-level="13.6.2" data-path="prototype-based-models-of-categorization.html"><a href="prototype-based-models-of-categorization.html#limitations-1"><i class="fa fa-check"></i><b>13.6.2</b> Limitations:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html"><i class="fa fa-check"></i><b>14</b> Rule-Based Models of Categorization</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#theoretical-foundations"><i class="fa fa-check"></i><b>14.1</b> Theoretical Foundations</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#core-assumptions-of-rule-based-models"><i class="fa fa-check"></i><b>14.1.1</b> Core Assumptions of Rule-Based Models</a></li>
<li class="chapter" data-level="14.1.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#rules-vs.-similarity-based-approaches"><i class="fa fa-check"></i><b>14.1.2</b> Rules vs.Â Similarity-Based Approaches</a></li>
<li class="chapter" data-level="14.1.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#representing-and-evaluating-rules"><i class="fa fa-check"></i><b>14.1.3</b> Representing and Evaluating Rules</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#the-challenge-searching-the-space-of-rules"><i class="fa fa-check"></i><b>14.2</b> The Challenge: Searching the Space of Rules</a></li>
<li class="chapter" data-level="14.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#the-bayesian-particle-filter-tracking-rule-hypotheses"><i class="fa fa-check"></i><b>14.3</b> The Bayesian Particle Filter: Tracking Rule Hypotheses</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-1-generating-initial-rule-particles"><i class="fa fa-check"></i><b>14.3.1</b> Step 1: Generating Initial Rule Particles</a></li>
<li class="chapter" data-level="14.3.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-2-updating-particle-weights"><i class="fa fa-check"></i><b>14.3.2</b> Step 2: Updating Particle Weights</a></li>
<li class="chapter" data-level="14.3.3" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#step-3-resampling-particles"><i class="fa fa-check"></i><b>14.3.3</b> Step 3: Resampling Particles</a></li>
<li class="chapter" data-level="14.3.4" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#putting-it-together-the-particle-filter-agent"><i class="fa fa-check"></i><b>14.3.4</b> Putting it Together: The Particle Filter Agent</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#simulating-categorization-behavior-1"><i class="fa fa-check"></i><b>14.4</b> Simulating Categorization Behavior</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#visualizing-rule-learning-over-time"><i class="fa fa-check"></i><b>14.4.1</b> Visualizing Rule Learning Over Time</a></li>
<li class="chapter" data-level="14.4.2" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#visualizing-the-decision-boundary"><i class="fa fa-check"></i><b>14.4.2</b> Visualizing the Decision Boundary</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#implementing-rule-based-logic-in-stan-simplified"><i class="fa fa-check"></i><b>14.5</b> Implementing Rule-Based Logic in Stan (Simplified)</a></li>
<li class="chapter" data-level="14.6" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#cognitive-insights-from-rule-based-models"><i class="fa fa-check"></i><b>14.6</b> Cognitive Insights from Rule-Based Models</a></li>
<li class="chapter" data-level="14.7" data-path="rule-based-models-of-categorization.html"><a href="rule-based-models-of-categorization.html#strengths-and-limitations"><i class="fa fa-check"></i><b>14.7</b> Strengths and Limitations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Chapter 13: Rule-Based Models - Learning Explicit Criteria</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="win-stay-lose-shift-a-heuristic-decision-strategy" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Win-Stay-Lose-Shift: A Heuristic Decision Strategy<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#win-stay-lose-shift-a-heuristic-decision-strategy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-3" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Introduction<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Win-Stay-Lose-Shift (WSLS) represents one of the simplest yet most fascinating decision-making strategies observed in both human and animal behavior. The core principle is intuitive: if an action leads to success, repeat it; if it leads to failure, try something else. Despite its simplicity, this strategy can produce sophisticated behavioral patterns and proves surprisingly effective in many scenarios.
In this chapter, weâ€™ll explore WSLS through computational modeling, building on our previous work with random agents. Weâ€™ll see how this apparently simple strategy can capture important aspects of learning and adaptation. Through careful implementation and testing, weâ€™ll develop insights into both the strengths and limitations of WSLS as a model of decision-making.</p>
<p>Our exploration will follow several key steps:</p>
<ul>
<li><p>Implementing the basic WSLS strategy in code</p></li>
<li><p>Testing it against different opponents</p></li>
<li><p>Scaling up to multiple agents</p></li>
<li><p>Analyzing patterns in the resulting data</p></li>
</ul>
<p>The WSLS strategy differs significantly from our previous random agent models. Rather than making choices based on fixed probabilities, a WSLS agent:</p>
<ul>
<li><p>Remembers its previous choice</p></li>
<li><p>Tracks whether that choice was successful</p></li>
<li><p>Uses this information to determine its next move</p></li>
</ul>
<p>This creates an interesting form of path dependence - the agentâ€™s choices are shaped by its history of interactions (and we need to ensure that memory is calculated for the correct trial and applied to the following trial).</p>
<div id="loading-required-packages" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Loading Required Packages<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#loading-required-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Letâ€™s begin by loading the packages weâ€™ll need for our analysis:</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-1" tabindex="-1"></a><span class="co"># Load necessary packages for simulation and analysis</span></span>
<span id="cb411-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-2" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,   <span class="co"># For data manipulation and visualization</span></span>
<span id="cb411-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-3" tabindex="-1"></a>               here,        <span class="co"># For file path management</span></span>
<span id="cb411-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-4" tabindex="-1"></a>               posterior,   <span class="co"># For working with posterior samples</span></span>
<span id="cb411-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-5" tabindex="-1"></a>               cmdstanr,    <span class="co"># For interfacing with Stan</span></span>
<span id="cb411-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-6" tabindex="-1"></a>               brms,        <span class="co"># For Bayesian regression models</span></span>
<span id="cb411-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-7" tabindex="-1"></a>               tidybayes,   <span class="co"># For working with Bayesian samples</span></span>
<span id="cb411-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-8" tabindex="-1"></a>               loo,         <span class="co"># For model comparison</span></span>
<span id="cb411-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb411-9" tabindex="-1"></a>               patchwork)   <span class="co"># For combining multiple plots</span></span></code></pre></div>
</div>
</div>
<div id="generating-data-simulating-wsls-agents" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Generating Data: Simulating WSLS Agents<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#generating-data-simulating-wsls-agents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now weâ€™ll set up a simulation environment where WSLS agents interact with random agents. The parameters we define here will shape our simulation. Weâ€™ll create 100 agents who each play 120 trials, allowing us to observe both individual behavior and broader patterns across many interactions.</p>
<p>Our WSLS agent implementation uses a parameterized approach where:</p>
<ul>
<li><p>alpha represents a baseline bias toward choosing one option over another</p></li>
<li><p>betaWin represents the strength of the â€œstayâ€ response after a win</p></li>
<li><p>betaLose represents the strength of the â€œshiftâ€ response after a loss</p></li>
<li><p>noise allows for occasional random deviations from the strategy</p></li>
</ul>
<p>This parameterization lets us explore variants of the WSLS strategy with different sensitivities to wins and losses.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-1" tabindex="-1"></a><span class="co"># Define simulation parameters</span></span>
<span id="cb412-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-2" tabindex="-1"></a>agents <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co"># Number of agents to simulate</span></span>
<span id="cb412-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-3" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">120</span>    <span class="co"># Number of trials per agent</span></span>
<span id="cb412-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-4" tabindex="-1"></a></span>
<span id="cb412-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-5" tabindex="-1"></a><span class="co"># Noise parameter (probability of random choice regardless of strategy)</span></span>
<span id="cb412-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-6" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb412-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-7" tabindex="-1"></a></span>
<span id="cb412-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-8" tabindex="-1"></a><span class="co"># Parameters for random agent (on log-odds scale)</span></span>
<span id="cb412-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-9" tabindex="-1"></a>rateM <span class="ot">&lt;-</span> <span class="fl">1.4</span>     <span class="co"># Population mean bias for random agent</span></span>
<span id="cb412-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-10" tabindex="-1"></a>rateSD <span class="ot">&lt;-</span> <span class="fl">0.3</span>    <span class="co"># Population SD of bias</span></span>
<span id="cb412-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-11" tabindex="-1"></a></span>
<span id="cb412-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-12" tabindex="-1"></a><span class="co"># Parameters for WSLS agent (on log-odds scale)</span></span>
<span id="cb412-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-13" tabindex="-1"></a>alphaM <span class="ot">&lt;-</span> <span class="dv">0</span>      <span class="co"># Population mean baseline bias</span></span>
<span id="cb412-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-14" tabindex="-1"></a>alphaSD <span class="ot">&lt;-</span> <span class="fl">0.1</span>   <span class="co"># Population SD of baseline bias</span></span>
<span id="cb412-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-15" tabindex="-1"></a></span>
<span id="cb412-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-16" tabindex="-1"></a>betaWinM <span class="ot">&lt;-</span> <span class="fl">1.5</span>  <span class="co"># Population mean win-stay parameter</span></span>
<span id="cb412-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-17" tabindex="-1"></a>betaWinSD <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># Population SD of win-stay parameter</span></span>
<span id="cb412-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-18" tabindex="-1"></a></span>
<span id="cb412-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-19" tabindex="-1"></a>betaLoseM <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># Population mean lose-shift parameter </span></span>
<span id="cb412-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb412-20" tabindex="-1"></a>betaLoseSD <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># Population SD of lose-shift parameter</span></span></code></pre></div>
<p>Next, weâ€™ll define functions to implement our agent strategies:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-1" tabindex="-1"></a><span class="co"># Random agent function: makes choices based on bias parameter (on log-odds scale)</span></span>
<span id="cb413-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-2" tabindex="-1"></a><span class="co"># with possibility of random noise</span></span>
<span id="cb413-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-3" tabindex="-1"></a>RandomAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(rate, noise) {</span>
<span id="cb413-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-4" tabindex="-1"></a>  <span class="co"># Generate choice based on agent&#39;s bias parameter</span></span>
<span id="cb413-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-5" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">inv_logit_scaled</span>(rate))</span>
<span id="cb413-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-6" tabindex="-1"></a>  </span>
<span id="cb413-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-7" tabindex="-1"></a>  <span class="co"># With probability &#39;noise&#39;, override choice with random 50/50 selection</span></span>
<span id="cb413-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-8" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb413-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-9" tabindex="-1"></a>    choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb413-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-10" tabindex="-1"></a>  }</span>
<span id="cb413-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-11" tabindex="-1"></a>  </span>
<span id="cb413-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-12" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb413-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-13" tabindex="-1"></a>}</span>
<span id="cb413-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-14" tabindex="-1"></a></span>
<span id="cb413-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-15" tabindex="-1"></a><span class="co"># Win-Stay-Lose-Shift agent function:</span></span>
<span id="cb413-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-16" tabindex="-1"></a><span class="co"># - alpha: baseline bias parameter</span></span>
<span id="cb413-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-17" tabindex="-1"></a><span class="co"># - betaWin: parameter controlling the tendency to repeat winning choices</span></span>
<span id="cb413-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-18" tabindex="-1"></a><span class="co"># - betaLose: parameter controlling the tendency to switch after losing</span></span>
<span id="cb413-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-19" tabindex="-1"></a><span class="co"># - win: indicator of previous win (+1 if won with choice 1, -1 if won with choice 0, 0 if lost)</span></span>
<span id="cb413-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-20" tabindex="-1"></a><span class="co"># - lose: indicator of previous loss (+1 if lost with choice 0, -1 if lost with choice 1, 0 if won)</span></span>
<span id="cb413-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-21" tabindex="-1"></a><span class="co"># - noise: probability of making a random choice</span></span>
<span id="cb413-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-22" tabindex="-1"></a>WSLSAgentNoise_f <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, betaWin, betaLose, win, lose, noise) {</span>
<span id="cb413-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-23" tabindex="-1"></a>  <span class="co"># Calculate choice probability based on WSLS parameters and previous outcomes</span></span>
<span id="cb413-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-24" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> alpha <span class="sc">+</span> betaWin <span class="sc">*</span> win <span class="sc">+</span> betaLose <span class="sc">*</span> lose</span>
<span id="cb413-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-25" tabindex="-1"></a>  </span>
<span id="cb413-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-26" tabindex="-1"></a>  <span class="co"># Generate choice based on calculated probability</span></span>
<span id="cb413-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-27" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">inv_logit_scaled</span>(rate))</span>
<span id="cb413-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-28" tabindex="-1"></a>  </span>
<span id="cb413-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-29" tabindex="-1"></a>  <span class="co"># With probability &#39;noise&#39;, override choice with random 50/50 selection</span></span>
<span id="cb413-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-30" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, noise) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb413-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-31" tabindex="-1"></a>    choice <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb413-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-32" tabindex="-1"></a>  }</span>
<span id="cb413-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-33" tabindex="-1"></a>  </span>
<span id="cb413-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-34" tabindex="-1"></a>  <span class="fu">return</span>(choice)</span>
<span id="cb413-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb413-35" tabindex="-1"></a>}</span></code></pre></div>
<p>Now letâ€™s generate the simulation data. Weâ€™ll simulate each agent playing against a random opponent, and track their choices, wins, and losses:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-1" tabindex="-1"></a><span class="co"># File path for saved simulation results</span></span>
<span id="cb414-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-2" tabindex="-1"></a>sim_data_file <span class="ot">&lt;-</span> <span class="st">&quot;simdata/W9_WSLS_data.RDS&quot;</span></span>
<span id="cb414-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-3" tabindex="-1"></a></span>
<span id="cb414-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-4" tabindex="-1"></a><span class="co"># Check if we need to regenerate the simulation data</span></span>
<span id="cb414-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-5" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(sim_data_file)) {</span>
<span id="cb414-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-6" tabindex="-1"></a>  <span class="co"># Initialize dataframe to store results</span></span>
<span id="cb414-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-7" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb414-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-8" tabindex="-1"></a>  </span>
<span id="cb414-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-9" tabindex="-1"></a>  <span class="co"># Loop through all agents</span></span>
<span id="cb414-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-10" tabindex="-1"></a>  <span class="cf">for</span> (agent <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb414-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-11" tabindex="-1"></a>    <span class="co"># Sample individual agent parameters from population distributions</span></span>
<span id="cb414-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-12" tabindex="-1"></a>    rate <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, rateM, rateSD)         <span class="co"># Individual bias for random agent</span></span>
<span id="cb414-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-13" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, alphaM, alphaSD)      <span class="co"># Individual baseline bias for WSLS agent</span></span>
<span id="cb414-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-14" tabindex="-1"></a>    betaWin <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, betaWinM, betaWinSD)  <span class="co"># Individual win-stay parameter</span></span>
<span id="cb414-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-15" tabindex="-1"></a>    betaLose <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, betaLoseM, betaLoseSD) <span class="co"># Individual lose-shift parameter</span></span>
<span id="cb414-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-16" tabindex="-1"></a>    </span>
<span id="cb414-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-17" tabindex="-1"></a>    <span class="co"># Initialize vectors to store data for this agent</span></span>
<span id="cb414-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-18" tabindex="-1"></a>    randomChoice <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)  <span class="co"># Choices of random agent</span></span>
<span id="cb414-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-19" tabindex="-1"></a>    wslsChoice <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)    <span class="co"># Choices of WSLS agent</span></span>
<span id="cb414-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-20" tabindex="-1"></a>    win <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)           <span class="co"># Win indicator for WSLS agent</span></span>
<span id="cb414-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-21" tabindex="-1"></a>    lose <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)          <span class="co"># Lose indicator for WSLS agent</span></span>
<span id="cb414-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-22" tabindex="-1"></a>    feedback <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, trials)      <span class="co"># Whether WSLS agent won (1) or lost (0)</span></span>
<span id="cb414-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-23" tabindex="-1"></a>    </span>
<span id="cb414-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-24" tabindex="-1"></a>    <span class="co"># Generate choices for each trial</span></span>
<span id="cb414-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-25" tabindex="-1"></a>    <span class="cf">for</span> (trial <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>trials) {</span>
<span id="cb414-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-26" tabindex="-1"></a>      <span class="co"># Random agent makes choice</span></span>
<span id="cb414-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-27" tabindex="-1"></a>      randomChoice[trial] <span class="ot">&lt;-</span> <span class="fu">RandomAgentNoise_f</span>(rate, noise)</span>
<span id="cb414-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-28" tabindex="-1"></a>      </span>
<span id="cb414-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-29" tabindex="-1"></a>      <span class="co"># WSLS agent makes first choice randomly, then follows strategy</span></span>
<span id="cb414-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-30" tabindex="-1"></a>      <span class="cf">if</span> (trial <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb414-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-31" tabindex="-1"></a>        wslsChoice[trial] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)  <span class="co"># First choice is random</span></span>
<span id="cb414-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-32" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb414-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-33" tabindex="-1"></a>        <span class="co"># Use WSLS strategy based on previous outcome</span></span>
<span id="cb414-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-34" tabindex="-1"></a>        wslsChoice[trial] <span class="ot">&lt;-</span> <span class="fu">WSLSAgentNoise_f</span>(</span>
<span id="cb414-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-35" tabindex="-1"></a>          alpha, betaWin, betaLose, win[trial <span class="sc">-</span> <span class="dv">1</span>], lose[trial <span class="sc">-</span> <span class="dv">1</span>], noise</span>
<span id="cb414-36"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-36" tabindex="-1"></a>        )</span>
<span id="cb414-37"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-37" tabindex="-1"></a>      }</span>
<span id="cb414-38"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-38" tabindex="-1"></a>      </span>
<span id="cb414-39"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-39" tabindex="-1"></a>      <span class="co"># Determine outcome (1 = WSLS agent wins, 0 = WSLS agent loses)</span></span>
<span id="cb414-40"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-40" tabindex="-1"></a>      feedback[trial] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wslsChoice[trial] <span class="sc">==</span> randomChoice[trial], <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb414-41"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-41" tabindex="-1"></a>      </span>
<span id="cb414-42"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-42" tabindex="-1"></a>      <span class="co"># Encode win/lose signals for WSLS strategy:</span></span>
<span id="cb414-43"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-43" tabindex="-1"></a>      <span class="co"># win: +1 if won with choice 1, -1 if won with choice 0, 0 if lost</span></span>
<span id="cb414-44"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-44" tabindex="-1"></a>      win[trial] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(feedback[trial] <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb414-45"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-45" tabindex="-1"></a>                          <span class="fu">ifelse</span>(wslsChoice[trial] <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), </span>
<span id="cb414-46"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-46" tabindex="-1"></a>                          <span class="dv">0</span>)</span>
<span id="cb414-47"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-47" tabindex="-1"></a>      </span>
<span id="cb414-48"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-48" tabindex="-1"></a>      <span class="co"># lose: +1 if lost with choice 0, -1 if lost with choice 1, 0 if won</span></span>
<span id="cb414-49"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-49" tabindex="-1"></a>      lose[trial] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(feedback[trial] <span class="sc">==</span> <span class="dv">0</span>, </span>
<span id="cb414-50"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-50" tabindex="-1"></a>                           <span class="fu">ifelse</span>(wslsChoice[trial] <span class="sc">==</span> <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb414-51"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-51" tabindex="-1"></a>                           <span class="dv">0</span>)</span>
<span id="cb414-52"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-52" tabindex="-1"></a>    }</span>
<span id="cb414-53"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-53" tabindex="-1"></a>    </span>
<span id="cb414-54"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-54" tabindex="-1"></a>    <span class="co"># Create data frames for this agent</span></span>
<span id="cb414-55"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-55" tabindex="-1"></a>    tempRandom <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb414-56"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-56" tabindex="-1"></a>      agent, </span>
<span id="cb414-57"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-57" tabindex="-1"></a>      <span class="at">trial =</span> <span class="fu">seq</span>(trials), </span>
<span id="cb414-58"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-58" tabindex="-1"></a>      <span class="at">choice =</span> randomChoice, </span>
<span id="cb414-59"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-59" tabindex="-1"></a>      rate, </span>
<span id="cb414-60"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-60" tabindex="-1"></a>      noise, </span>
<span id="cb414-61"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-61" tabindex="-1"></a>      rateM, </span>
<span id="cb414-62"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-62" tabindex="-1"></a>      rateSD, </span>
<span id="cb414-63"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-63" tabindex="-1"></a>      alpha, </span>
<span id="cb414-64"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-64" tabindex="-1"></a>      alphaM, </span>
<span id="cb414-65"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-65" tabindex="-1"></a>      alphaSD, </span>
<span id="cb414-66"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-66" tabindex="-1"></a>      betaWin, </span>
<span id="cb414-67"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-67" tabindex="-1"></a>      betaWinM, </span>
<span id="cb414-68"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-68" tabindex="-1"></a>      betaWinSD, </span>
<span id="cb414-69"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-69" tabindex="-1"></a>      betaLose, </span>
<span id="cb414-70"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-70" tabindex="-1"></a>      betaLoseM, </span>
<span id="cb414-71"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-71" tabindex="-1"></a>      betaLoseSD, </span>
<span id="cb414-72"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-72" tabindex="-1"></a>      win, </span>
<span id="cb414-73"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-73" tabindex="-1"></a>      lose, </span>
<span id="cb414-74"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-74" tabindex="-1"></a>      feedback, </span>
<span id="cb414-75"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-75" tabindex="-1"></a>      <span class="at">strategy =</span> <span class="st">&quot;Random&quot;</span></span>
<span id="cb414-76"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-76" tabindex="-1"></a>    )</span>
<span id="cb414-77"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-77" tabindex="-1"></a>    </span>
<span id="cb414-78"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-78" tabindex="-1"></a>    tempWSLS <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb414-79"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-79" tabindex="-1"></a>      agent, </span>
<span id="cb414-80"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-80" tabindex="-1"></a>      <span class="at">trial =</span> <span class="fu">seq</span>(trials), </span>
<span id="cb414-81"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-81" tabindex="-1"></a>      <span class="at">choice =</span> wslsChoice, </span>
<span id="cb414-82"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-82" tabindex="-1"></a>      rate, </span>
<span id="cb414-83"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-83" tabindex="-1"></a>      noise, </span>
<span id="cb414-84"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-84" tabindex="-1"></a>      rateM, </span>
<span id="cb414-85"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-85" tabindex="-1"></a>      rateSD, </span>
<span id="cb414-86"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-86" tabindex="-1"></a>      alpha, </span>
<span id="cb414-87"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-87" tabindex="-1"></a>      alphaM, </span>
<span id="cb414-88"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-88" tabindex="-1"></a>      alphaSD, </span>
<span id="cb414-89"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-89" tabindex="-1"></a>      betaWin, </span>
<span id="cb414-90"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-90" tabindex="-1"></a>      betaWinM, </span>
<span id="cb414-91"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-91" tabindex="-1"></a>      betaWinSD, </span>
<span id="cb414-92"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-92" tabindex="-1"></a>      betaLose, </span>
<span id="cb414-93"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-93" tabindex="-1"></a>      betaLoseM, </span>
<span id="cb414-94"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-94" tabindex="-1"></a>      betaLoseSD, </span>
<span id="cb414-95"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-95" tabindex="-1"></a>      win, </span>
<span id="cb414-96"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-96" tabindex="-1"></a>      lose, </span>
<span id="cb414-97"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-97" tabindex="-1"></a>      feedback, </span>
<span id="cb414-98"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-98" tabindex="-1"></a>      <span class="at">strategy =</span> <span class="st">&quot;WSLS&quot;</span></span>
<span id="cb414-99"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-99" tabindex="-1"></a>    )</span>
<span id="cb414-100"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-100" tabindex="-1"></a>    </span>
<span id="cb414-101"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-101" tabindex="-1"></a>    <span class="co"># Combine data for both agent types</span></span>
<span id="cb414-102"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-102" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tempRandom, tempWSLS)</span>
<span id="cb414-103"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-103" tabindex="-1"></a>    </span>
<span id="cb414-104"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-104" tabindex="-1"></a>    <span class="co"># Append to main dataframe</span></span>
<span id="cb414-105"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-105" tabindex="-1"></a>    <span class="cf">if</span> (agent <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb414-106"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-106" tabindex="-1"></a>      d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d, temp)</span>
<span id="cb414-107"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-107" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb414-108"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-108" tabindex="-1"></a>      d <span class="ot">&lt;-</span> temp</span>
<span id="cb414-109"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-109" tabindex="-1"></a>    }</span>
<span id="cb414-110"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-110" tabindex="-1"></a>  }</span>
<span id="cb414-111"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-111" tabindex="-1"></a>  </span>
<span id="cb414-112"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-112" tabindex="-1"></a>  <span class="co"># Save the simulation results</span></span>
<span id="cb414-113"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-113" tabindex="-1"></a>  <span class="fu">saveRDS</span>(d, sim_data_file)</span>
<span id="cb414-114"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-114" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Generated new simulation data and saved to&quot;</span>, sim_data_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb414-115"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-115" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb414-116"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-116" tabindex="-1"></a>  <span class="co"># Load existing simulation results</span></span>
<span id="cb414-117"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-117" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(sim_data_file)</span>
<span id="cb414-118"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-118" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing simulation data from&quot;</span>, sim_data_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb414-119"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb414-119" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing simulation data from simdata/W9_WSLS_data.RDS</code></pre>
</div>
<div id="data-processing-and-initial-visualization" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Data Processing and Initial Visualization<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#data-processing-and-initial-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Letâ€™s process our data to create useful variables for analysis and visualization:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-1" tabindex="-1"></a><span class="co"># Process data: add lead/lag variables and calculate cumulative statistics</span></span>
<span id="cb416-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb416-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-3" tabindex="-1"></a>  <span class="fu">group_by</span>(agent, strategy) <span class="sc">%&gt;%</span> </span>
<span id="cb416-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb416-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-5" tabindex="-1"></a>    <span class="co"># Next and previous choices/outcomes</span></span>
<span id="cb416-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-6" tabindex="-1"></a>    <span class="at">nextChoice =</span> <span class="fu">lead</span>(choice),            <span class="co"># Next choice (for analysis)</span></span>
<span id="cb416-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-7" tabindex="-1"></a>    <span class="at">prevWin =</span> <span class="fu">lag</span>(win),                   <span class="co"># Previous win indicator</span></span>
<span id="cb416-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-8" tabindex="-1"></a>    <span class="at">prevLose =</span> <span class="fu">lag</span>(lose),                 <span class="co"># Previous lose indicator</span></span>
<span id="cb416-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-9" tabindex="-1"></a>    </span>
<span id="cb416-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-10" tabindex="-1"></a>    <span class="co"># Performance metrics</span></span>
<span id="cb416-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-11" tabindex="-1"></a>    <span class="at">cumulativerate =</span> <span class="fu">cumsum</span>(choice) <span class="sc">/</span> <span class="fu">seq_along</span>(choice),  <span class="co"># Running proportion of &quot;right&quot; choices</span></span>
<span id="cb416-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-12" tabindex="-1"></a>    <span class="at">performance =</span> <span class="fu">cumsum</span>(feedback) <span class="sc">/</span> <span class="fu">seq_along</span>(feedback)  <span class="co"># Running proportion of wins</span></span>
<span id="cb416-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb416-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-14" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb416-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-15" tabindex="-1"></a>    <span class="co"># identify win and lose as 0 during first trial</span></span>
<span id="cb416-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-16" tabindex="-1"></a>    <span class="at">prevWin =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prevWin), <span class="dv">0</span>, prevWin),</span>
<span id="cb416-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-17" tabindex="-1"></a>    <span class="at">prevLose =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prevLose), <span class="dv">0</span>, prevLose)</span>
<span id="cb416-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb416-18" tabindex="-1"></a>  )</span></code></pre></div>
<p>Now letâ€™s visualize the choice patterns of our agents to get a sense of their behavior:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-1" tabindex="-1"></a><span class="co"># First visualization: Proportion of &quot;right&quot; choices over time for both strategies</span></span>
<span id="cb417-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(trial, cumulativerate, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span> </span>
<span id="cb417-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb417-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb417-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-5" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb417-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb417-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Choice Patterns by Strategy&quot;</span>,</span>
<span id="cb417-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-8" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Each line represents one agent&#39;s running proportion of &#39;right&#39; choices&quot;</span>,</span>
<span id="cb417-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb417-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion of &#39;Right&#39; Choices&quot;</span></span>
<span id="cb417-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb417-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-12" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb417-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>strategy) <span class="sc">+</span></span>
<span id="cb417-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co"># Hide individual agent legend for clarity</span></span>
<span id="cb417-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-15" tabindex="-1"></a></span>
<span id="cb417-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-16" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb417-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb417-17" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="series_files/figure-html/09-visualize-choice-patterns-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The visualization above shows how the choice patterns evolve over time for both the Random and WSLS agents. The random agents show an approximately stable choice pattern (though with individual biases), while the WSLS agents show more varied patterns as they adapt to their opponents.</p>
<p>Letâ€™s also examine how each strategy performs against its opponent:</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-1" tabindex="-1"></a><span class="co"># Create visualization for performance against opponent</span></span>
<span id="cb418-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-2" tabindex="-1"></a>p2a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(d, strategy <span class="sc">==</span> <span class="st">&quot;Random&quot;</span>), </span>
<span id="cb418-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-3" tabindex="-1"></a>             <span class="fu">aes</span>(trial, <span class="dv">1</span> <span class="sc">-</span> performance, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span> </span>
<span id="cb418-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb418-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb418-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-6" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb418-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb418-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Performance of Random Agents&quot;</span>,</span>
<span id="cb418-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Lower values indicate better performance against WSLS opponents&quot;</span>,</span>
<span id="cb418-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb418-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion of Losses&quot;</span></span>
<span id="cb418-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb418-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb418-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb418-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-15" tabindex="-1"></a></span>
<span id="cb418-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-16" tabindex="-1"></a>p2b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(d, strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>), </span>
<span id="cb418-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-17" tabindex="-1"></a>             <span class="fu">aes</span>(trial, performance, <span class="at">group =</span> agent, <span class="at">color =</span> agent)) <span class="sc">+</span> </span>
<span id="cb418-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-18" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb418-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb418-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-20" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb418-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb418-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Performance of WSLS Agents&quot;</span>,</span>
<span id="cb418-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-23" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher values indicate better performance against Random opponents&quot;</span>,</span>
<span id="cb418-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-24" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb418-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-25" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion of Wins&quot;</span></span>
<span id="cb418-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb418-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-27" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb418-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-28" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb418-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-29" tabindex="-1"></a></span>
<span id="cb418-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-30" tabindex="-1"></a><span class="co"># Combine plots using patchwork</span></span>
<span id="cb418-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb418-31" tabindex="-1"></a>p2a <span class="sc">/</span> p2b</span></code></pre></div>
<p><img src="series_files/figure-html/09-visualize-performance-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The performance plots reveal an interesting pattern. The WSLS agents generally maintain a winning percentage above 0.5 (the dashed line), indicating they can effectively exploit the biases in the random agents. This demonstrates a key strength of the WSLS strategy - it can adapt to and take advantage of predictable patterns in opponent behavior.</p>
</div>
<div id="verifying-model-properties-and-assumptions" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Verifying Model Properties and Assumptions<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#verifying-model-properties-and-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Letâ€™s check some key properties of our simulation to ensure itâ€™s working as expected:</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-1" tabindex="-1"></a><span class="co"># Check that win and lose indicators are orthogonal as expected</span></span>
<span id="cb419-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-2" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(win, lose)) <span class="sc">+</span> </span>
<span id="cb419-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb419-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Orthogonality of Win and Lose Indicators&quot;</span>,</span>
<span id="cb419-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Confirms that win and lose signals are mutually exclusive&quot;</span>,</span>
<span id="cb419-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Win Indicator&quot;</span>,</span>
<span id="cb419-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Lose Indicator&quot;</span></span>
<span id="cb419-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb419-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-11" tabindex="-1"></a></span>
<span id="cb419-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb419-12" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="series_files/figure-html/09-check-win-lose-orthogonality-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The plot confirms that our win and lose indicators are mutually exclusive - when the win signal is active (Â±1), the lose signal is 0, and vice versa. This is important for the proper functioning of our WSLS model.</p>
<p>Now letâ€™s check that the WSLS agents are indeed responding to win and lose signals as expected:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-1" tabindex="-1"></a><span class="co"># Check that WSLS agents respond to win/lose signals appropriately</span></span>
<span id="cb420-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-2" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb420-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-3" tabindex="-1"></a>  <span class="fu">subset</span>(strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb420-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nextChoice =</span> <span class="fu">lead</span>(choice)) <span class="sc">%&gt;%</span></span>
<span id="cb420-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-5" tabindex="-1"></a>  <span class="fu">group_by</span>(agent, win, lose) <span class="sc">%&gt;%</span></span>
<span id="cb420-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-6" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">heads =</span> <span class="fu">mean</span>(nextChoice), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb420-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(win, heads)) <span class="sc">+</span></span>
<span id="cb420-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb420-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb420-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;WSLS Strategy Implementation Check&quot;</span>,</span>
<span id="cb420-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-11" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Shows how next choice probability depends on win/lose signals&quot;</span>,</span>
<span id="cb420-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Win Signal (-1 = won with &#39;left&#39;, +1 = won with &#39;right&#39;, 0 = lost)&quot;</span>,</span>
<span id="cb420-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Probability of Choosing &#39;Right&#39; on Next Trial&quot;</span></span>
<span id="cb420-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb420-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb420-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-16" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lose, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb420-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-17" tabindex="-1"></a>    <span class="at">lose =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Lose = -1</span><span class="sc">\n</span><span class="st">(lost with &#39;right&#39;)&quot;</span>, </span>
<span id="cb420-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-18" tabindex="-1"></a>             <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;Lose = 0</span><span class="sc">\n</span><span class="st">(won)&quot;</span>, </span>
<span id="cb420-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-19" tabindex="-1"></a>             <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Lose = 1</span><span class="sc">\n</span><span class="st">(lost with &#39;left&#39;)&quot;</span>)</span>
<span id="cb420-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-20" tabindex="-1"></a>  ))</span>
<span id="cb420-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-21" tabindex="-1"></a></span>
<span id="cb420-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb420-22" tabindex="-1"></a>p4</span></code></pre></div>
<p><img src="series_files/figure-html/09-check-wsls-behavior-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This plot confirms that our WSLS agents are behaving as expected:</p>
<ul>
<li>When win = +1 (won with â€˜rightâ€™), the agents tend to choose â€˜rightâ€™ again</li>
<li>When win = -1 (won with â€˜leftâ€™), the agents tend to choose â€˜leftâ€™ again</li>
<li>When lose = +1 (lost with â€˜leftâ€™), the agents tend to switch to â€˜rightâ€™</li>
<li>When lose = -1 (lost with â€˜rightâ€™), the agents tend to switch to â€˜leftâ€™</li>
</ul>
<p>The variation in probabilities reflects the individual differences in our agentsâ€™ parameters.</p>
</div>
<div id="modeling-a-single-wsls-agent" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Modeling a Single WSLS Agent<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#modeling-a-single-wsls-agent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Letâ€™s first build a model to infer the parameters of a single WSLS agent. This will help us understand the basic mechanics before scaling up to the multilevel model:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-1" tabindex="-1"></a><span class="co"># Select one agent&#39;s data for single-agent model</span></span>
<span id="cb421-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-2" tabindex="-1"></a>d_a <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">subset</span>(</span>
<span id="cb421-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-3" tabindex="-1"></a>  strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span> <span class="sc">&amp;</span> agent <span class="sc">==</span> <span class="dv">2</span>  <span class="co"># Arbitrarily select agent #2 Note that trial 1 is already excluded</span></span>
<span id="cb421-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-4" tabindex="-1"></a>)</span>
<span id="cb421-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-5" tabindex="-1"></a></span>
<span id="cb421-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-6" tabindex="-1"></a><span class="co"># Prepare data for Stan model</span></span>
<span id="cb421-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-7" tabindex="-1"></a>data_wsls_simple <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb421-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-8" tabindex="-1"></a>  <span class="at">trials =</span> trials,       <span class="co"># trials</span></span>
<span id="cb421-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-9" tabindex="-1"></a>  <span class="at">h =</span> d_a<span class="sc">$</span>choice,            <span class="co"># Choices (0/1)</span></span>
<span id="cb421-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-10" tabindex="-1"></a>  <span class="at">win =</span> d_a<span class="sc">$</span>prevWin,         <span class="co"># Previous win signal</span></span>
<span id="cb421-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-11" tabindex="-1"></a>  <span class="at">lose =</span> d_a<span class="sc">$</span>prevLose        <span class="co"># Previous lose signal</span></span>
<span id="cb421-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb421-12" tabindex="-1"></a>)</span></code></pre></div>
<p>Now letâ€™s define the Stan model for a single WSLS agent:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-1" tabindex="-1"></a><span class="co"># Stan model code for single WSLS agent</span></span>
<span id="cb422-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-2" tabindex="-1"></a>stan_wsls_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb422-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-3" tabindex="-1"></a><span class="st">functions{</span></span>
<span id="cb422-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-4" tabindex="-1"></a><span class="st">  // Helper function for generating truncated normal random numbers</span></span>
<span id="cb422-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-5" tabindex="-1"></a><span class="st">  real normal_lb_rng(real mu, real sigma, real lb) {</span></span>
<span id="cb422-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-6" tabindex="-1"></a><span class="st">    real p = normal_cdf(lb | mu, sigma);  // cdf for bounds</span></span>
<span id="cb422-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-7" tabindex="-1"></a><span class="st">    real u = uniform_rng(p, 1);</span></span>
<span id="cb422-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-8" tabindex="-1"></a><span class="st">    return (sigma * inv_Phi(u)) + mu;  // inverse cdf for value</span></span>
<span id="cb422-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-9" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb422-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-10" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb422-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-11" tabindex="-1"></a></span>
<span id="cb422-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-12" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb422-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-13" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; trials;        // Number of trials</span></span>
<span id="cb422-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-14" tabindex="-1"></a><span class="st"> array[trials] int h;          // Choices (0/1)</span></span>
<span id="cb422-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-15" tabindex="-1"></a><span class="st"> vector[trials] win;           // Win signal for each trial</span></span>
<span id="cb422-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-16" tabindex="-1"></a><span class="st"> vector[trials] lose;          // Lose signal for each trial</span></span>
<span id="cb422-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-17" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb422-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-18" tabindex="-1"></a></span>
<span id="cb422-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-19" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb422-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-20" tabindex="-1"></a><span class="st">  real alpha;                  // Baseline bias parameter</span></span>
<span id="cb422-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-21" tabindex="-1"></a><span class="st">  real winB;                   // Win-stay parameter</span></span>
<span id="cb422-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-22" tabindex="-1"></a><span class="st">  real loseB;                  // Lose-shift parameter</span></span>
<span id="cb422-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-23" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb422-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-24" tabindex="-1"></a></span>
<span id="cb422-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-25" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb422-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-26" tabindex="-1"></a><span class="st">  // Priors</span></span>
<span id="cb422-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-27" tabindex="-1"></a><span class="st">  target += normal_lpdf(alpha | 0, .3);   // Prior for baseline bias</span></span>
<span id="cb422-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-28" tabindex="-1"></a><span class="st">  target += normal_lpdf(winB | 1, 1);     // Prior for win-stay parameter</span></span>
<span id="cb422-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-29" tabindex="-1"></a><span class="st">  target += normal_lpdf(loseB | 1, 1);    // Prior for lose-shift parameter</span></span>
<span id="cb422-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-30" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb422-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-31" tabindex="-1"></a><span class="st">  // Likelihood: WSLS choice model</span></span>
<span id="cb422-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-32" tabindex="-1"></a><span class="st">  // Remember that in the first trial we ensured win and lose have a value of 0,</span></span>
<span id="cb422-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-33" tabindex="-1"></a><span class="st">  // which correspond to a fixed 0.5 probability (0 on logit scale)</span></span>
<span id="cb422-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-34" tabindex="-1"></a><span class="st">  // since there is no previous outcome to guide the choice</span></span>
<span id="cb422-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-35" tabindex="-1"></a><span class="st">  target += bernoulli_logit_lpmf(h | alpha + winB * win + loseB * lose);</span></span>
<span id="cb422-36"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-36" tabindex="-1"></a></span>
<span id="cb422-37"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-37" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb422-38"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-38" tabindex="-1"></a></span>
<span id="cb422-39"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-39" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb422-40"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-40" tabindex="-1"></a><span class="st">   // Prior predictive samples</span></span>
<span id="cb422-41"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-41" tabindex="-1"></a><span class="st">   real alpha_prior;</span></span>
<span id="cb422-42"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-42" tabindex="-1"></a><span class="st">   real winB_prior;</span></span>
<span id="cb422-43"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-43" tabindex="-1"></a><span class="st">   real loseB_prior;</span></span>
<span id="cb422-44"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-44" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb422-45"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-45" tabindex="-1"></a><span class="st">   // Posterior and prior predictions</span></span>
<span id="cb422-46"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-46" tabindex="-1"></a><span class="st">   array[trials] int prior_preds;</span></span>
<span id="cb422-47"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-47" tabindex="-1"></a><span class="st">   array[trials] int posterior_preds;</span></span>
<span id="cb422-48"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-48" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb422-49"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-49" tabindex="-1"></a><span class="st">   // Log likelihood for model comparison</span></span>
<span id="cb422-50"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-50" tabindex="-1"></a><span class="st">   vector[trials] log_lik;</span></span>
<span id="cb422-51"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-51" tabindex="-1"></a></span>
<span id="cb422-52"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-52" tabindex="-1"></a><span class="st">   // Generate prior samples</span></span>
<span id="cb422-53"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-53" tabindex="-1"></a><span class="st">   alpha_prior = normal_rng(0, 1);</span></span>
<span id="cb422-54"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-54" tabindex="-1"></a><span class="st">   winB_prior = normal_rng(0, 1);</span></span>
<span id="cb422-55"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-55" tabindex="-1"></a><span class="st">   loseB_prior = normal_rng(0, 1);</span></span>
<span id="cb422-56"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-56" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb422-57"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-57" tabindex="-1"></a><span class="st">   // Prior predictive simulations</span></span>
<span id="cb422-58"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-58" tabindex="-1"></a><span class="st">   for (t in 1:trials) {</span></span>
<span id="cb422-59"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-59" tabindex="-1"></a><span class="st">     prior_preds[t] = bernoulli_logit_rng(alpha_prior + winB_prior * win[t] + loseB_prior * lose[t]);</span></span>
<span id="cb422-60"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-60" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb422-61"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-61" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb422-62"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-62" tabindex="-1"></a><span class="st">   // Posterior predictive simulations</span></span>
<span id="cb422-63"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-63" tabindex="-1"></a><span class="st">   for (t in 1:trials) {</span></span>
<span id="cb422-64"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-64" tabindex="-1"></a><span class="st">     posterior_preds[t] = bernoulli_logit_rng(alpha + winB * win[t] + loseB * lose[t]);</span></span>
<span id="cb422-65"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-65" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb422-66"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-66" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb422-67"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-67" tabindex="-1"></a><span class="st">   // Calculate log likelihood for each observation</span></span>
<span id="cb422-68"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-68" tabindex="-1"></a><span class="st">   for (t in 1:trials){</span></span>
<span id="cb422-69"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-69" tabindex="-1"></a><span class="st">     log_lik[t] = bernoulli_logit_lpmf(h[t] | alpha + winB * win[t] + loseB * lose[t]);</span></span>
<span id="cb422-70"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-70" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb422-71"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-71" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb422-72"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-72" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb422-73"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-73" tabindex="-1"></a></span>
<span id="cb422-74"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-74" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb422-75"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-75" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb422-76"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-76" tabindex="-1"></a>  stan_wsls_model,</span>
<span id="cb422-77"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-77" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb422-78"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb422-78" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W9_WSLS.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W9_WSLS.stan&quot;</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-1" tabindex="-1"></a><span class="co"># Compile the model</span></span>
<span id="cb424-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W9_WSLS.stan&quot;</span>)</span>
<span id="cb424-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-3" tabindex="-1"></a>mod_wsls_simple <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb424-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-4" tabindex="-1"></a>  file, </span>
<span id="cb424-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-5" tabindex="-1"></a>  <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb424-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-6" tabindex="-1"></a>  <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>), </span>
<span id="cb424-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-7" tabindex="-1"></a>  <span class="at">pedantic =</span> <span class="cn">TRUE</span></span>
<span id="cb424-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb424-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Now letâ€™s fit the model to our single agentâ€™s data:</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-1" tabindex="-1"></a><span class="co"># File path for saved model results</span></span>
<span id="cb425-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-2" tabindex="-1"></a>single_model_file <span class="ot">&lt;-</span> <span class="st">&quot;simmodels/W9_WSLS_simple.RDS&quot;</span></span>
<span id="cb425-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-3" tabindex="-1"></a></span>
<span id="cb425-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-4" tabindex="-1"></a><span class="co"># Check if we need to rerun the model</span></span>
<span id="cb425-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-5" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(single_model_file)) {</span>
<span id="cb425-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-6" tabindex="-1"></a>  <span class="co"># Fit the model</span></span>
<span id="cb425-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-7" tabindex="-1"></a>  samples_wsls_simple <span class="ot">&lt;-</span> mod_wsls_simple<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb425-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-8" tabindex="-1"></a>    <span class="at">data =</span> data_wsls_simple,</span>
<span id="cb425-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-9" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb425-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-10" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb425-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-11" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb425-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-12" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb425-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-13" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb425-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-14" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb425-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-15" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">1000</span>,</span>
<span id="cb425-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-16" tabindex="-1"></a>    <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb425-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-17" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.99</span></span>
<span id="cb425-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-18" tabindex="-1"></a>  )</span>
<span id="cb425-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-19" tabindex="-1"></a>  </span>
<span id="cb425-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-20" tabindex="-1"></a>  <span class="co"># Save the results</span></span>
<span id="cb425-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-21" tabindex="-1"></a>  samples_wsls_simple<span class="sc">$</span><span class="fu">save_object</span>(<span class="at">file =</span> single_model_file)</span>
<span id="cb425-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-22" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Generated new model fit and saved to&quot;</span>, single_model_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb425-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-23" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb425-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-24" tabindex="-1"></a>  <span class="co"># Load existing results</span></span>
<span id="cb425-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-25" tabindex="-1"></a>  samples_wsls_simple <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(single_model_file)</span>
<span id="cb425-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing model fit from&quot;</span>, single_model_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb425-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb425-27" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing model fit from simmodels/W9_WSLS_simple.RDS</code></pre>
<p>Letâ€™s examine the parameter estimates and convergence for the single agent model:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb427-1" tabindex="-1"></a><span class="co"># Display summary statistics for the parameters</span></span>
<span id="cb427-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb427-2" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> samples_wsls_simple<span class="sc">$</span><span class="fu">summary</span>() </span>
<span id="cb427-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb427-3" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span></code></pre></div>
<pre><code>## # A tibble: 367 Ã— 10
##    variable           mean   median    sd   mad      q5     q95  rhat ess_bulk ess_tail
##    &lt;chr&gt;             &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 lp__           -58.4    -58.1    1.20  0.997 -60.7   -57.1    1.00    1606.    2161.
##  2 alpha            0.172    0.174  0.224 0.228  -0.190   0.532  1.00    1950.    2217.
##  3 winB             1.16     1.15   0.332 0.337   0.628   1.70   1.00    1845.    2075.
##  4 loseB            1.90     1.90   0.413 0.413   1.24    2.60   1.00    2039.    1774.
##  5 alpha_prior     -0.0314  -0.0233 0.993 0.978  -1.69    1.60   1.00    3888.    3857.
##  6 winB_prior       0.0165   0.0208 1.00  1.01   -1.62    1.66   1.00    3845.    3867.
##  7 loseB_prior     -0.0254  -0.0333 1.02  1.01   -1.71    1.65   1.00    3926.    3728.
##  8 prior_preds[1]   0.484    0      0.500 0       0       1      1.00    3927.      NA 
##  9 prior_preds[2]   0.490    0      0.500 0       0       1      1.00    3597.      NA 
## 10 prior_preds[3]   0.491    0      0.500 0       0       1      1.00    3847.      NA 
## # â„¹ 357 more rows</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-1" tabindex="-1"></a><span class="co"># Extract posterior samples and include sampling of the prior</span></span>
<span id="cb429-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-2" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_wsls_simple<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb429-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-3" tabindex="-1"></a></span>
<span id="cb429-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-4" tabindex="-1"></a><span class="co"># Create plot grid for parameter recovery</span></span>
<span id="cb429-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-5" tabindex="-1"></a>p5a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb429-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(alpha), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb429-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(alpha_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb429-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-8" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d_a<span class="sc">$</span>alpha[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb429-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb429-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Baseline Bias Parameter (Alpha)&quot;</span>,</span>
<span id="cb429-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-11" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Blue = posterior, Red = prior, Dashed line = true value&quot;</span>,</span>
<span id="cb429-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Parameter Value&quot;</span>,</span>
<span id="cb429-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span></span>
<span id="cb429-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb429-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-15" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb429-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-16" tabindex="-1"></a></span>
<span id="cb429-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-17" tabindex="-1"></a>p5b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb429-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-18" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(winB), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb429-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-19" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(winB_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb429-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-20" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d_a<span class="sc">$</span>betaWin[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb429-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb429-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Win-Stay Parameter (Beta Win)&quot;</span>,</span>
<span id="cb429-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-23" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Blue = posterior, Red = prior, Dashed line = true value&quot;</span>,</span>
<span id="cb429-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-24" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Parameter Value&quot;</span>,</span>
<span id="cb429-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-25" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span></span>
<span id="cb429-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb429-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-27" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb429-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-28" tabindex="-1"></a></span>
<span id="cb429-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-29" tabindex="-1"></a>p5c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(draws_df) <span class="sc">+</span></span>
<span id="cb429-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-30" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(loseB), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb429-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-31" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(loseB_prior), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb429-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-32" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d_a<span class="sc">$</span>betaLose[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb429-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-33" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb429-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-34" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lose-Shift Parameter (Beta Lose)&quot;</span>,</span>
<span id="cb429-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-35" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Blue = posterior, Red = prior, Dashed line = true value&quot;</span>,</span>
<span id="cb429-36"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-36" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Parameter Value&quot;</span>,</span>
<span id="cb429-37"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-37" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span></span>
<span id="cb429-38"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-38" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb429-39"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-39" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb429-40"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-40" tabindex="-1"></a></span>
<span id="cb429-41"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-41" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb429-42"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb429-42" tabindex="-1"></a>(p5a <span class="sc">|</span> p5b) <span class="sc">/</span> p5c</span></code></pre></div>
<p><img src="series_files/figure-html/09-examine-single-agent-results-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The parameter recovery for our single agent looks good. The posterior distributions (blue) are centered around the true parameter values (dashed lines), showing that our model can accurately recover the underlying parameters that generated the agentâ€™s behavior. The posteriors are also substantially narrower than the priors (red), indicating that the data is informative.</p>
<p>[MISSING A FULL PARAMETER RECOVERY]</p>
</div>
<div id="multilevel-wsls-model" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Multilevel WSLS Model<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#multilevel-wsls-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now letâ€™s scale up to model all agents simultaneously with a multilevel (hierarchical) model. This allows us to estimate both population-level parameters and individual differences:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-1" tabindex="-1"></a><span class="do">## Prepare data for multilevel model</span></span>
<span id="cb430-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-2" tabindex="-1"></a><span class="co"># Transform data into matrices where columns are agents, rows are trials</span></span>
<span id="cb430-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-3" tabindex="-1"></a>d_wsls1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb430-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-4" tabindex="-1"></a>  <span class="fu">subset</span>(strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb430-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-5" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, choice)) <span class="sc">%&gt;%</span> </span>
<span id="cb430-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb430-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-7" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> choice)</span>
<span id="cb430-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-8" tabindex="-1"></a></span>
<span id="cb430-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-9" tabindex="-1"></a>d_wsls2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb430-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-10" tabindex="-1"></a>  <span class="fu">subset</span>(strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb430-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-11" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, prevWin)) <span class="sc">%&gt;%</span> </span>
<span id="cb430-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb430-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-13" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> prevWin)</span>
<span id="cb430-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-14" tabindex="-1"></a></span>
<span id="cb430-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-15" tabindex="-1"></a>d_wsls3 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb430-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-16" tabindex="-1"></a>  <span class="fu">subset</span>(strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb430-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-17" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(agent, prevLose)) <span class="sc">%&gt;%</span> </span>
<span id="cb430-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb430-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-19" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agent, <span class="at">values_from =</span> prevLose)</span>
<span id="cb430-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-20" tabindex="-1"></a></span>
<span id="cb430-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-21" tabindex="-1"></a><span class="co"># Create the data list for Stan</span></span>
<span id="cb430-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-22" tabindex="-1"></a>data_wsls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb430-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-23" tabindex="-1"></a>  <span class="at">trials =</span> trials,</span>
<span id="cb430-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-24" tabindex="-1"></a>  <span class="at">agents =</span> agents,</span>
<span id="cb430-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-25" tabindex="-1"></a>  <span class="at">h =</span> <span class="fu">as.matrix</span>(d_wsls1[, <span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)]),    <span class="co"># Choice matrix</span></span>
<span id="cb430-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-26" tabindex="-1"></a>  <span class="at">win =</span> <span class="fu">as.matrix</span>(d_wsls2[, <span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)]),  <span class="co"># Win signal matrix</span></span>
<span id="cb430-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-27" tabindex="-1"></a>  <span class="at">lose =</span> <span class="fu">as.matrix</span>(d_wsls3[, <span class="dv">2</span><span class="sc">:</span>(agents <span class="sc">+</span> <span class="dv">1</span>)])  <span class="co"># Lose signal matrix</span></span>
<span id="cb430-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb430-28" tabindex="-1"></a>)</span></code></pre></div>
<p>Now letâ€™s define the multilevel Stan model:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-1" tabindex="-1"></a><span class="co"># Stan code for multilevel WSLS model</span></span>
<span id="cb431-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-2" tabindex="-1"></a>stan_wsls_ml_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb431-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-3" tabindex="-1"></a><span class="st">functions{</span></span>
<span id="cb431-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-4" tabindex="-1"></a><span class="st">  real normal_lb_rng(real mu, real sigma, real lb) {</span></span>
<span id="cb431-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-5" tabindex="-1"></a><span class="st">    real p = normal_cdf(lb | mu, sigma);  // cdf for bounds</span></span>
<span id="cb431-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-6" tabindex="-1"></a><span class="st">    real u = uniform_rng(p, 1);</span></span>
<span id="cb431-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-7" tabindex="-1"></a><span class="st">    return (sigma * inv_Phi(u)) + mu;  // inverse cdf for value</span></span>
<span id="cb431-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-8" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb431-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-9" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb431-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-10" tabindex="-1"></a></span>
<span id="cb431-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-11" tabindex="-1"></a><span class="st">// The input (data) for the model. </span></span>
<span id="cb431-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-12" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb431-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-13" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; trials;           // Number of trials</span></span>
<span id="cb431-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-14" tabindex="-1"></a><span class="st"> int&lt;lower = 1&gt; agents;           // Number of agents</span></span>
<span id="cb431-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-15" tabindex="-1"></a><span class="st"> array[trials, agents] int h;      // Choice data (0/1)</span></span>
<span id="cb431-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-16" tabindex="-1"></a><span class="st"> array[trials, agents] real win;   // Win signals</span></span>
<span id="cb431-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-17" tabindex="-1"></a><span class="st"> array[trials, agents] real lose;  // Lose signals</span></span>
<span id="cb431-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-18" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb431-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-19" tabindex="-1"></a></span>
<span id="cb431-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-20" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb431-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-21" tabindex="-1"></a><span class="st">  // Population-level parameters</span></span>
<span id="cb431-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-22" tabindex="-1"></a><span class="st">  real winM;                    // Population mean for win-stay parameter</span></span>
<span id="cb431-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-23" tabindex="-1"></a><span class="st">  real loseM;                   // Population mean for lose-shift parameter</span></span>
<span id="cb431-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-24" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb431-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-25" tabindex="-1"></a><span class="st">  // Population standard deviations</span></span>
<span id="cb431-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-26" tabindex="-1"></a><span class="st">  vector&lt;lower = 0&gt;[2] tau;     // SDs for [win, lose] parameters</span></span>
<span id="cb431-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-27" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb431-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-28" tabindex="-1"></a><span class="st">  // Individual z-scores (non-centered parameterization)</span></span>
<span id="cb431-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-29" tabindex="-1"></a><span class="st">  matrix[2, agents] z_IDs;</span></span>
<span id="cb431-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-30" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb431-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-31" tabindex="-1"></a><span class="st">  // Correlation matrix</span></span>
<span id="cb431-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-32" tabindex="-1"></a><span class="st">  cholesky_factor_corr[2] L_u;</span></span>
<span id="cb431-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb431-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-34" tabindex="-1"></a></span>
<span id="cb431-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-35" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb431-36"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-36" tabindex="-1"></a><span class="st">  // Individual parameters (constructed from non-centered parameterization)</span></span>
<span id="cb431-37"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-37" tabindex="-1"></a><span class="st">  matrix[agents, 2] IDs;</span></span>
<span id="cb431-38"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-38" tabindex="-1"></a><span class="st">  IDs = (diag_pre_multiply(tau, L_u) * z_IDs)&#39;;</span></span>
<span id="cb431-39"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-39" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb431-40"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-40" tabindex="-1"></a></span>
<span id="cb431-41"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-41" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb431-42"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-42" tabindex="-1"></a><span class="st">  // Population-level priors</span></span>
<span id="cb431-43"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-43" tabindex="-1"></a><span class="st">  target += normal_lpdf(winM | 0, 1);     // Prior for win-stay mean</span></span>
<span id="cb431-44"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-44" tabindex="-1"></a><span class="st">  target += normal_lpdf(tau[1] | 0, .3) - normal_lccdf(0 | 0, .3);  // Half-normal for SD</span></span>
<span id="cb431-45"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-45" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb431-46"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-46" tabindex="-1"></a><span class="st">  target += normal_lpdf(loseM | 0, .3);   // Prior for lose-shift mean</span></span>
<span id="cb431-47"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-47" tabindex="-1"></a><span class="st">  target += normal_lpdf(tau[2] | 0, .3) - normal_lccdf(0 | 0, .3);  // Half-normal for SD</span></span>
<span id="cb431-48"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-48" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb431-49"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-49" tabindex="-1"></a><span class="st">  // Prior for correlation matrix</span></span>
<span id="cb431-50"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-50" tabindex="-1"></a><span class="st">  target += lkj_corr_cholesky_lpdf(L_u | 2);</span></span>
<span id="cb431-51"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-51" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb431-52"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-52" tabindex="-1"></a><span class="st">  // Prior for individual z-scores</span></span>
<span id="cb431-53"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-53" tabindex="-1"></a><span class="st">  target += std_normal_lpdf(to_vector(z_IDs));</span></span>
<span id="cb431-54"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-54" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb431-55"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-55" tabindex="-1"></a><span class="st">  // Likelihood</span></span>
<span id="cb431-56"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-56" tabindex="-1"></a><span class="st">  for (i in 1:agents)</span></span>
<span id="cb431-57"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-57" tabindex="-1"></a><span class="st">    target += bernoulli_logit_lpmf(h[,i] | to_vector(win[,i]) * (winM + IDs[i,1]) + </span></span>
<span id="cb431-58"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-58" tabindex="-1"></a><span class="st">                                            to_vector(lose[,i]) * (loseM + IDs[i,2]));</span></span>
<span id="cb431-59"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-59" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb431-60"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-60" tabindex="-1"></a></span>
<span id="cb431-61"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-61" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb431-62"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-62" tabindex="-1"></a><span class="st">   // Prior predictive samples</span></span>
<span id="cb431-63"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-63" tabindex="-1"></a><span class="st">   real winM_prior;</span></span>
<span id="cb431-64"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-64" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; winSD_prior;</span></span>
<span id="cb431-65"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-65" tabindex="-1"></a><span class="st">   real loseM_prior;</span></span>
<span id="cb431-66"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-66" tabindex="-1"></a><span class="st">   real&lt;lower=0&gt; loseSD_prior;</span></span>
<span id="cb431-67"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-67" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb431-68"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-68" tabindex="-1"></a><span class="st">   real win_prior;</span></span>
<span id="cb431-69"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-69" tabindex="-1"></a><span class="st">   real lose_prior;</span></span>
<span id="cb431-70"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-70" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb431-71"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-71" tabindex="-1"></a><span class="st">   // Posterior predictive samples for various scenarios</span></span>
<span id="cb431-72"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-72" tabindex="-1"></a><span class="st">   array[trials, agents] int prior_preds;</span></span>
<span id="cb431-73"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-73" tabindex="-1"></a><span class="st">   array[trials, agents] int posterior_preds;</span></span>
<span id="cb431-74"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-74" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb431-75"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-75" tabindex="-1"></a><span class="st">   // Log likelihood for model comparison</span></span>
<span id="cb431-76"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-76" tabindex="-1"></a><span class="st">   array[trials, agents] real log_lik;</span></span>
<span id="cb431-77"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-77" tabindex="-1"></a></span>
<span id="cb431-78"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-78" tabindex="-1"></a><span class="st">   // Generate prior samples</span></span>
<span id="cb431-79"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-79" tabindex="-1"></a><span class="st">   winM_prior = normal_rng(0, 1);</span></span>
<span id="cb431-80"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-80" tabindex="-1"></a><span class="st">   winSD_prior = normal_lb_rng(0, 0.3, 0);</span></span>
<span id="cb431-81"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-81" tabindex="-1"></a><span class="st">   loseM_prior = normal_rng(0, 1);</span></span>
<span id="cb431-82"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-82" tabindex="-1"></a><span class="st">   loseSD_prior = normal_lb_rng(0, 0.3, 0);</span></span>
<span id="cb431-83"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-83" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb431-84"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-84" tabindex="-1"></a><span class="st">   win_prior = normal_rng(winM_prior, winSD_prior);</span></span>
<span id="cb431-85"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-85" tabindex="-1"></a><span class="st">   lose_prior = normal_rng(loseM_prior, loseSD_prior);</span></span>
<span id="cb431-86"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-86" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb431-87"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-87" tabindex="-1"></a><span class="st">   // Generate predictions</span></span>
<span id="cb431-88"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-88" tabindex="-1"></a><span class="st">   for (i in 1:agents){</span></span>
<span id="cb431-89"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-89" tabindex="-1"></a><span class="st">      // Prior predictive simulations</span></span>
<span id="cb431-90"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-90" tabindex="-1"></a><span class="st">      for (t in 1:trials) {</span></span>
<span id="cb431-91"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-91" tabindex="-1"></a><span class="st">        prior_preds[t, i] = bernoulli_logit_rng(</span></span>
<span id="cb431-92"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-92" tabindex="-1"></a><span class="st">          win[t, i] * win_prior + lose[t, i] * lose_prior</span></span>
<span id="cb431-93"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-93" tabindex="-1"></a><span class="st">        );</span></span>
<span id="cb431-94"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-94" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb431-95"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-95" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb431-96"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-96" tabindex="-1"></a><span class="st">      // Posterior predictive simulations</span></span>
<span id="cb431-97"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-97" tabindex="-1"></a><span class="st">      for (t in 1:trials) {</span></span>
<span id="cb431-98"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-98" tabindex="-1"></a><span class="st">        posterior_preds[t, i] = bernoulli_logit_rng(</span></span>
<span id="cb431-99"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-99" tabindex="-1"></a><span class="st">          win[t, i] * (winM + IDs[i, 1]) + lose[t, i] * (loseM + IDs[i, 2])</span></span>
<span id="cb431-100"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-100" tabindex="-1"></a><span class="st">        );</span></span>
<span id="cb431-101"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-101" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb431-102"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-102" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb431-103"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-103" tabindex="-1"></a><span class="st">      // Calculate log likelihood for each observation</span></span>
<span id="cb431-104"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-104" tabindex="-1"></a><span class="st">      for (t in 1:trials){</span></span>
<span id="cb431-105"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-105" tabindex="-1"></a><span class="st">        log_lik[t, i] = bernoulli_logit_lpmf(</span></span>
<span id="cb431-106"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-106" tabindex="-1"></a><span class="st">          h[t, i] | win[t, i] * (winM + IDs[i, 1]) + lose[t, i] * (loseM + IDs[i, 2])</span></span>
<span id="cb431-107"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-107" tabindex="-1"></a><span class="st">        );</span></span>
<span id="cb431-108"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-108" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb431-109"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-109" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb431-110"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-110" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb431-111"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-111" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb431-112"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-112" tabindex="-1"></a></span>
<span id="cb431-113"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-113" tabindex="-1"></a><span class="co"># Write the model to a file</span></span>
<span id="cb431-114"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-114" tabindex="-1"></a><span class="fu">write_stan_file</span>(</span>
<span id="cb431-115"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-115" tabindex="-1"></a>  stan_wsls_ml_model,</span>
<span id="cb431-116"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-116" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">&quot;stan/&quot;</span>,</span>
<span id="cb431-117"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb431-117" tabindex="-1"></a>  <span class="at">basename =</span> <span class="st">&quot;W9_WSLS_ml.stan&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/au209589/Dropbox/Teaching/AdvancedCognitiveModeling23_book/stan/W9_WSLS_ml.stan&quot;</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-1" tabindex="-1"></a><span class="co"># Compile the model</span></span>
<span id="cb433-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;stan/W9_WSLS_ml.stan&quot;</span>)</span>
<span id="cb433-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-3" tabindex="-1"></a>mod_wsls_ml <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(</span>
<span id="cb433-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-4" tabindex="-1"></a>  file, </span>
<span id="cb433-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-5" tabindex="-1"></a>  <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>),</span>
<span id="cb433-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-6" tabindex="-1"></a>  <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">&quot;O1&quot;</span>), </span>
<span id="cb433-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-7" tabindex="-1"></a>  <span class="at">pedantic =</span> <span class="cn">TRUE</span></span>
<span id="cb433-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb433-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Now letâ€™s fit the multilevel model to all agents:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-1" tabindex="-1"></a><span class="co"># File path for saved multilevel model results</span></span>
<span id="cb434-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-2" tabindex="-1"></a>multilevel_model_file <span class="ot">&lt;-</span> <span class="st">&quot;simmodels/W9_WSLS_multilevel.RDS&quot;</span></span>
<span id="cb434-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-3" tabindex="-1"></a></span>
<span id="cb434-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-4" tabindex="-1"></a><span class="co"># Check if we need to rerun the model</span></span>
<span id="cb434-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-5" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(multilevel_model_file)) {</span>
<span id="cb434-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-6" tabindex="-1"></a>  <span class="co"># Fit the multilevel model</span></span>
<span id="cb434-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-7" tabindex="-1"></a>  samples_wsls_ml <span class="ot">&lt;-</span> mod_wsls_ml<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb434-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-8" tabindex="-1"></a>    <span class="at">data =</span> data_wsls,</span>
<span id="cb434-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-9" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb434-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-10" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb434-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-11" tabindex="-1"></a>    <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb434-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-12" tabindex="-1"></a>    <span class="at">threads_per_chain =</span> <span class="dv">1</span>,</span>
<span id="cb434-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-13" tabindex="-1"></a>    <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb434-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-14" tabindex="-1"></a>    <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb434-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-15" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">500</span>,  <span class="co"># Reduced refresh rate for cleaner output</span></span>
<span id="cb434-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-16" tabindex="-1"></a>    <span class="at">max_treedepth =</span> <span class="dv">20</span>,</span>
<span id="cb434-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-17" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.99</span></span>
<span id="cb434-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-18" tabindex="-1"></a>  )</span>
<span id="cb434-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-19" tabindex="-1"></a>  </span>
<span id="cb434-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-20" tabindex="-1"></a>  <span class="co"># Save the results</span></span>
<span id="cb434-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-21" tabindex="-1"></a>  samples_wsls_ml<span class="sc">$</span><span class="fu">save_object</span>(<span class="at">file =</span> multilevel_model_file)</span>
<span id="cb434-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-22" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Generated new multilevel model fit and saved to&quot;</span>, multilevel_model_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb434-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-23" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb434-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-24" tabindex="-1"></a>  <span class="co"># Load existing results</span></span>
<span id="cb434-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-25" tabindex="-1"></a>  samples_wsls_ml <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(multilevel_model_file)</span>
<span id="cb434-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing multilevel model fit from&quot;</span>, multilevel_model_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb434-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb434-27" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing multilevel model fit from simmodels/W9_WSLS_multilevel.RDS</code></pre>
</div>
<div id="quality-checks-and-parameter-recovery" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> Quality Checks and Parameter Recovery<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#quality-checks-and-parameter-recovery" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="convergence-diagnostics" class="section level3 hasAnchor" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> Convergence Diagnostics<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#convergence-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Letâ€™s examine convergence diagnostics to ensure our model has estimated the parameters reliably:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-1" tabindex="-1"></a>draws_ml <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(samples_wsls_ml<span class="sc">$</span><span class="fu">draws</span>())</span>
<span id="cb436-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-2" tabindex="-1"></a></span>
<span id="cb436-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-3" tabindex="-1"></a><span class="co"># Trace plots for convergence checking</span></span>
<span id="cb436-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-4" tabindex="-1"></a><span class="fu">mcmc_trace</span>(draws_ml, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;winM&quot;</span>, <span class="st">&quot;loseM&quot;</span>, <span class="st">&quot;tau[1]&quot;</span>, <span class="st">&quot;tau[2]&quot;</span>)) <span class="sc">+</span></span>
<span id="cb436-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb436-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;MCMC Trace Plots for Key Parameters&quot;</span>,</span>
<span id="cb436-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-7" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Good mixing indicates model convergence&quot;</span></span>
<span id="cb436-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb436-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="series_files/figure-html/09-convergence-diagnostics-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb437-1" tabindex="-1"></a><span class="co"># Rank plots for assessing convergence</span></span>
<span id="cb437-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb437-2" tabindex="-1"></a><span class="fu">mcmc_rank_hist</span>(draws_ml, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;winM&quot;</span>, <span class="st">&quot;loseM&quot;</span>, <span class="st">&quot;tau[1]&quot;</span>, <span class="st">&quot;tau[2]&quot;</span>)) <span class="sc">+</span></span>
<span id="cb437-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb437-3" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb437-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb437-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Rank Plots for Key Parameters&quot;</span>,</span>
<span id="cb437-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb437-5" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Uniform distributions indicate good mixing&quot;</span></span>
<span id="cb437-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb437-6" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="series_files/figure-html/09-convergence-diagnostics-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The trace plots show the parameter values across iterations. Good mixing (chains overlapping without patterns) indicates convergence. Rank histograms near uniform also suggest good convergence, while U-shaped or inverted-U histograms would indicate poor mixing.</p>
</div>
<div id="prior-posterior-update-visualization" class="section level3 hasAnchor" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> Prior-Posterior Update Visualization<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#prior-posterior-update-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now letâ€™s visualize how our knowledge about the parameters has been updated by the data:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-1" tabindex="-1"></a><span class="co"># Extract prior samples</span></span>
<span id="cb438-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-2" tabindex="-1"></a>prior_samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb438-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-3" tabindex="-1"></a>  <span class="at">winM_prior =</span> draws_ml<span class="sc">$</span>winM_prior,</span>
<span id="cb438-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-4" tabindex="-1"></a>  <span class="at">loseM_prior =</span> draws_ml<span class="sc">$</span>loseM_prior,</span>
<span id="cb438-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-5" tabindex="-1"></a>  <span class="at">winSD_prior =</span> draws_ml<span class="sc">$</span>winSD_prior,</span>
<span id="cb438-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-6" tabindex="-1"></a>  <span class="at">loseSD_prior =</span> draws_ml<span class="sc">$</span>loseSD_prior</span>
<span id="cb438-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-7" tabindex="-1"></a>)</span>
<span id="cb438-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-8" tabindex="-1"></a></span>
<span id="cb438-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-9" tabindex="-1"></a><span class="co"># Create dataframe for prior-posterior comparison</span></span>
<span id="cb438-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-10" tabindex="-1"></a>update_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb438-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-11" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Win-Stay Mean&quot;</span>, <span class="st">&quot;Lose-Shift Mean&quot;</span>, <span class="st">&quot;Win-Stay SD&quot;</span>, <span class="st">&quot;Lose-Shift SD&quot;</span>), </span>
<span id="cb438-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-12" tabindex="-1"></a>                 <span class="at">each =</span> <span class="fu">nrow</span>(draws_ml), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb438-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-13" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(draws_ml<span class="sc">$</span>winM, draws_ml<span class="sc">$</span>loseM, draws_ml<span class="sc">$</span><span class="st">`</span><span class="at">tau[1]</span><span class="st">`</span>, draws_ml<span class="sc">$</span><span class="st">`</span><span class="at">tau[2]</span><span class="st">`</span>,</span>
<span id="cb438-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-14" tabindex="-1"></a>            prior_samples<span class="sc">$</span>winM_prior, prior_samples<span class="sc">$</span>loseM_prior, </span>
<span id="cb438-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-15" tabindex="-1"></a>            prior_samples<span class="sc">$</span>winSD_prior, prior_samples<span class="sc">$</span>loseSD_prior),</span>
<span id="cb438-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-16" tabindex="-1"></a>  <span class="at">Distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Posterior&quot;</span>, <span class="st">&quot;Prior&quot;</span>), <span class="at">each =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">nrow</span>(draws_ml)),</span>
<span id="cb438-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-17" tabindex="-1"></a>  <span class="at">True_Value =</span> <span class="fu">rep</span>(<span class="fu">c</span>(betaWinM, betaLoseM, betaWinSD, betaLoseSD), </span>
<span id="cb438-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-18" tabindex="-1"></a>                   <span class="at">each =</span> <span class="fu">nrow</span>(draws_ml), <span class="at">times =</span> <span class="dv">2</span>)</span>
<span id="cb438-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-19" tabindex="-1"></a>)</span>
<span id="cb438-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-20" tabindex="-1"></a></span>
<span id="cb438-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-21" tabindex="-1"></a><span class="co"># Visualize prior-posterior update</span></span>
<span id="cb438-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-22" tabindex="-1"></a><span class="fu">ggplot</span>(update_df, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Distribution)) <span class="sc">+</span></span>
<span id="cb438-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-23" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb438-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-24" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> True_Value), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb438-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-25" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Parameter, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb438-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-26" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightpink&quot;</span>, <span class="st">&quot;Posterior&quot;</span> <span class="ot">=</span> <span class="st">&quot;steelblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb438-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-27" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb438-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-28" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prior vs. Posterior Distributions&quot;</span>,</span>
<span id="cb438-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-29" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Prior (pink) vs. posterior (blue) distributions with true values (dashed lines)&quot;</span>,</span>
<span id="cb438-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-30" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Parameter Value&quot;</span>,</span>
<span id="cb438-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-31" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span></span>
<span id="cb438-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-32" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb438-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb438-33" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/09-prior-posterior-update-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This visualization shows how our knowledge about the parameters has been updated by the data. The prior distributions (pink) represent our knowledge before seeing the data, while the posterior distributions (blue) show what we learned after fitting the model to the data. Narrower posteriors centered near the true values indicate that our model effectively learned from the data.</p>
</div>
<div id="individual-level-parameter-recovery" class="section level3 hasAnchor" number="10.7.3">
<h3><span class="header-section-number">10.7.3</span> Individual-Level Parameter Recovery<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#individual-level-parameter-recovery" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the key advantages of multilevel modeling is the ability to estimate parameters for individual agents. Letâ€™s extract individual parameters and assess recovery:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-1" tabindex="-1"></a><span class="co"># Extract individual agent parameters</span></span>
<span id="cb439-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-2" tabindex="-1"></a>agent_params <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb439-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-3" tabindex="-1"></a></span>
<span id="cb439-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>agents) {</span>
<span id="cb439-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-5" tabindex="-1"></a>  <span class="co"># Extract parameters for this agent</span></span>
<span id="cb439-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-6" tabindex="-1"></a>  win_param <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_ml<span class="sc">$</span>winM) <span class="sc">+</span> <span class="fu">mean</span>(draws_ml[[<span class="fu">paste0</span>(<span class="st">&quot;IDs[&quot;</span>, i, <span class="st">&quot;,1]&quot;</span>)]])</span>
<span id="cb439-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-7" tabindex="-1"></a>  lose_param <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws_ml<span class="sc">$</span>loseM) <span class="sc">+</span> <span class="fu">mean</span>(draws_ml[[<span class="fu">paste0</span>(<span class="st">&quot;IDs[&quot;</span>, i, <span class="st">&quot;,2]&quot;</span>)]])</span>
<span id="cb439-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-8" tabindex="-1"></a>  </span>
<span id="cb439-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-9" tabindex="-1"></a>  <span class="co"># Get true parameters</span></span>
<span id="cb439-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-10" tabindex="-1"></a>  true_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, strategy <span class="sc">==</span> <span class="st">&quot;WSLS&quot;</span>, agent <span class="sc">==</span> i, trial <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb439-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-11" tabindex="-1"></a>  true_win <span class="ot">&lt;-</span> <span class="fu">first</span>(true_data<span class="sc">$</span>betaWin)</span>
<span id="cb439-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-12" tabindex="-1"></a>  true_lose <span class="ot">&lt;-</span> <span class="fu">first</span>(true_data<span class="sc">$</span>betaLose)</span>
<span id="cb439-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-13" tabindex="-1"></a>  </span>
<span id="cb439-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-14" tabindex="-1"></a>  <span class="co"># Add to dataframe</span></span>
<span id="cb439-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-15" tabindex="-1"></a>  agent_params <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb439-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-16" tabindex="-1"></a>    agent_params,</span>
<span id="cb439-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-17" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb439-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-18" tabindex="-1"></a>      <span class="at">agent =</span> i,</span>
<span id="cb439-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-19" tabindex="-1"></a>      <span class="at">win_estimated =</span> win_param,</span>
<span id="cb439-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-20" tabindex="-1"></a>      <span class="at">lose_estimated =</span> lose_param,</span>
<span id="cb439-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-21" tabindex="-1"></a>      <span class="at">win_true =</span> true_win,</span>
<span id="cb439-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-22" tabindex="-1"></a>      <span class="at">lose_true =</span> true_lose</span>
<span id="cb439-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-23" tabindex="-1"></a>    )</span>
<span id="cb439-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-24" tabindex="-1"></a>  )</span>
<span id="cb439-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-25" tabindex="-1"></a>}</span>
<span id="cb439-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-26" tabindex="-1"></a></span>
<span id="cb439-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-27" tabindex="-1"></a><span class="co"># Create comparison plots</span></span>
<span id="cb439-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-28" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agent_params, <span class="fu">aes</span>(win_true, win_estimated)) <span class="sc">+</span></span>
<span id="cb439-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-29" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb439-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-30" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb439-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-31" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb439-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-32" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb439-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-33" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Individual Win-Stay Parameter Recovery&quot;</span>,</span>
<span id="cb439-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-34" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Win-Stay Parameter&quot;</span>,</span>
<span id="cb439-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-35" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Win-Stay Parameter&quot;</span></span>
<span id="cb439-36"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-36" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb439-37"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-37" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb439-38"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-38" tabindex="-1"></a></span>
<span id="cb439-39"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-39" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agent_params, <span class="fu">aes</span>(lose_true, lose_estimated)) <span class="sc">+</span></span>
<span id="cb439-40"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-40" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb439-41"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-41" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb439-42"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-42" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb439-43"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-43" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb439-44"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-44" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Individual Lose-Shift Parameter Recovery&quot;</span>,</span>
<span id="cb439-45"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-45" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;True Lose-Shift Parameter&quot;</span>,</span>
<span id="cb439-46"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-46" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimated Lose-Shift Parameter&quot;</span></span>
<span id="cb439-47"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-47" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb439-48"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-48" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb439-49"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-49" tabindex="-1"></a></span>
<span id="cb439-50"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-50" tabindex="-1"></a><span class="co"># Calculate recovery statistics</span></span>
<span id="cb439-51"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-51" tabindex="-1"></a>win_corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(agent_params<span class="sc">$</span>win_true, agent_params<span class="sc">$</span>win_estimated)</span>
<span id="cb439-52"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-52" tabindex="-1"></a>lose_corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(agent_params<span class="sc">$</span>lose_true, agent_params<span class="sc">$</span>lose_estimated)</span>
<span id="cb439-53"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-53" tabindex="-1"></a></span>
<span id="cb439-54"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-54" tabindex="-1"></a><span class="co"># Display correlation statistics</span></span>
<span id="cb439-55"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb439-55" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Correlation between true and estimated Win-Stay parameters:&quot;</span>, <span class="fu">round</span>(win_corr, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Correlation between true and estimated Win-Stay parameters: 0.746</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb441-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Correlation between true and estimated Lose-Shift parameters:&quot;</span>, <span class="fu">round</span>(lose_corr, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Correlation between true and estimated Lose-Shift parameters: 0.666</code></pre>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb443-1" tabindex="-1"></a><span class="co"># Create combined plot</span></span>
<span id="cb443-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb443-2" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/09-individual-recovery-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>These scatter plots show how well our model recovers individual-level parameters. Points near the diagonal line (dashed) indicate accurate parameter recovery, while the red regression line shows the overall relationship between true and estimated values. High correlation coefficients suggest good recovery of individual differences.</p>
</div>
<div id="posterior-predictive-checks-2" class="section level3 hasAnchor" number="10.7.4">
<h3><span class="header-section-number">10.7.4</span> Posterior Predictive Checks<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#posterior-predictive-checks-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Posterior predictive checks help us assess whether our model can generate data that resembles the observed data:</p>
<p>Iâ€™ll modify the posterior predictive checks chunk to use the regeneration_simulations flag for better efficiency. This will save the computed results and reload them if they already exist:
rCopy# Posterior predictive checks with regeneration flag</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-1" tabindex="-1"></a><span class="co"># File path for saved predictive check data</span></span>
<span id="cb444-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-2" tabindex="-1"></a>pred_checks_file <span class="ot">&lt;-</span> <span class="st">&quot;simdata/W9_WSLS_predictive_checks.RDS&quot;</span></span>
<span id="cb444-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-3" tabindex="-1"></a>pred_checks_uncertainty_file <span class="ot">&lt;-</span> <span class="st">&quot;simdata/W9_WSLS_predictive_uncertainty.RDS&quot;</span></span>
<span id="cb444-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-4" tabindex="-1"></a></span>
<span id="cb444-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-5" tabindex="-1"></a><span class="co"># Check if we need to recompute the predictive checks</span></span>
<span id="cb444-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-6" tabindex="-1"></a><span class="cf">if</span> (regenerate_simulations <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(pred_checks_file) <span class="sc">||</span> <span class="sc">!</span><span class="fu">file.exists</span>(pred_checks_uncertainty_file)) {</span>
<span id="cb444-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-7" tabindex="-1"></a>  <span class="co"># Extract samples for a few selected agents</span></span>
<span id="cb444-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-8" tabindex="-1"></a>  selected_agents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>)</span>
<span id="cb444-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-9" tabindex="-1"></a>  </span>
<span id="cb444-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-10" tabindex="-1"></a>  <span class="co"># Initialize data structures</span></span>
<span id="cb444-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-11" tabindex="-1"></a>  observed_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> trials<span class="dv">-1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(selected_agents))</span>
<span id="cb444-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-12" tabindex="-1"></a>  prior_means <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> trials<span class="dv">-1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(selected_agents))</span>
<span id="cb444-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-13" tabindex="-1"></a>  posterior_means <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> trials<span class="dv">-1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(selected_agents))</span>
<span id="cb444-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-14" tabindex="-1"></a>  </span>
<span id="cb444-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-15" tabindex="-1"></a>  <span class="co"># Also track quantiles for uncertainty bands</span></span>
<span id="cb444-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-16" tabindex="-1"></a>  prior_lower <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> trials<span class="dv">-1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(selected_agents))</span>
<span id="cb444-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-17" tabindex="-1"></a>  prior_upper <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> trials<span class="dv">-1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(selected_agents))</span>
<span id="cb444-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-18" tabindex="-1"></a>  posterior_lower <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> trials<span class="dv">-1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(selected_agents))</span>
<span id="cb444-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-19" tabindex="-1"></a>  posterior_upper <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> trials<span class="dv">-1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(selected_agents))</span>
<span id="cb444-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-20" tabindex="-1"></a>  </span>
<span id="cb444-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-21" tabindex="-1"></a>  <span class="co"># Fill observed data </span></span>
<span id="cb444-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-22" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(selected_agents)) {</span>
<span id="cb444-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-23" tabindex="-1"></a>    agent_idx <span class="ot">&lt;-</span> selected_agents[i]</span>
<span id="cb444-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-24" tabindex="-1"></a>    observed_data[, i] <span class="ot">&lt;-</span> data_wsls<span class="sc">$</span>h[<span class="dv">1</span><span class="sc">:</span>(trials<span class="dv">-1</span>), agent_idx]</span>
<span id="cb444-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-25" tabindex="-1"></a>  }</span>
<span id="cb444-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-26" tabindex="-1"></a>  </span>
<span id="cb444-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-27" tabindex="-1"></a>  <span class="co"># Process the predictions trial by trial to reduce memory usage</span></span>
<span id="cb444-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-28" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(trials<span class="dv">-1</span>)) {</span>
<span id="cb444-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-29" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Processing trial&quot;</span>, t, <span class="st">&quot;of&quot;</span>, trials<span class="dv">-1</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb444-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-30" tabindex="-1"></a>    </span>
<span id="cb444-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-31" tabindex="-1"></a>    <span class="co"># Extract variable names for this trial</span></span>
<span id="cb444-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-32" tabindex="-1"></a>    prior_vars <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;prior_preds[&quot;</span>, t, <span class="st">&quot;,&quot;</span>, selected_agents, <span class="st">&quot;]&quot;</span>)</span>
<span id="cb444-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-33" tabindex="-1"></a>    post_vars <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;posterior_preds[&quot;</span>, t, <span class="st">&quot;,&quot;</span>, selected_agents, <span class="st">&quot;]&quot;</span>)</span>
<span id="cb444-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-34" tabindex="-1"></a>    </span>
<span id="cb444-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-35" tabindex="-1"></a>    <span class="co"># Extract predictions for all agents for this trial</span></span>
<span id="cb444-36"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-36" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(selected_agents)) {</span>
<span id="cb444-37"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-37" tabindex="-1"></a>      prior_preds <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(draws_ml[[prior_vars[i]]])</span>
<span id="cb444-38"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-38" tabindex="-1"></a>      post_preds <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(draws_ml[[post_vars[i]]])</span>
<span id="cb444-39"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-39" tabindex="-1"></a>      </span>
<span id="cb444-40"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-40" tabindex="-1"></a>      <span class="co"># Calculate means</span></span>
<span id="cb444-41"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-41" tabindex="-1"></a>      prior_means[t, i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(prior_preds)</span>
<span id="cb444-42"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-42" tabindex="-1"></a>      posterior_means[t, i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(post_preds)</span>
<span id="cb444-43"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-43" tabindex="-1"></a>      </span>
<span id="cb444-44"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-44" tabindex="-1"></a>      <span class="co"># Calculate 95% credible intervals</span></span>
<span id="cb444-45"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-45" tabindex="-1"></a>      prior_lower[t, i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(prior_preds, <span class="fl">0.025</span>)</span>
<span id="cb444-46"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-46" tabindex="-1"></a>      prior_upper[t, i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(prior_preds, <span class="fl">0.975</span>)</span>
<span id="cb444-47"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-47" tabindex="-1"></a>      posterior_lower[t, i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(post_preds, <span class="fl">0.025</span>)</span>
<span id="cb444-48"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-48" tabindex="-1"></a>      posterior_upper[t, i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(post_preds, <span class="fl">0.975</span>)</span>
<span id="cb444-49"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-49" tabindex="-1"></a>    }</span>
<span id="cb444-50"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-50" tabindex="-1"></a>  }</span>
<span id="cb444-51"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-51" tabindex="-1"></a>  </span>
<span id="cb444-52"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-52" tabindex="-1"></a>  <span class="co"># Convert to long format for plotting</span></span>
<span id="cb444-53"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-53" tabindex="-1"></a>  pred_check_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb444-54"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-54" tabindex="-1"></a>    <span class="at">trial =</span> <span class="fu">rep</span>(<span class="dv">2</span><span class="sc">:</span>trials, <span class="fu">length</span>(selected_agents)),  <span class="co"># Trial numbers (starting from 2)</span></span>
<span id="cb444-55"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-55" tabindex="-1"></a>    <span class="at">agent =</span> <span class="fu">rep</span>(selected_agents, <span class="at">each =</span> trials<span class="dv">-1</span>),</span>
<span id="cb444-56"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-56" tabindex="-1"></a>    <span class="at">observed =</span> <span class="fu">c</span>(observed_data),</span>
<span id="cb444-57"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-57" tabindex="-1"></a>    <span class="at">prior_mean =</span> <span class="fu">c</span>(prior_means),</span>
<span id="cb444-58"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-58" tabindex="-1"></a>    <span class="at">posterior_mean =</span> <span class="fu">c</span>(posterior_means),</span>
<span id="cb444-59"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-59" tabindex="-1"></a>    <span class="at">agent_label =</span> <span class="fu">factor</span>(<span class="fu">paste</span>(<span class="st">&quot;Agent&quot;</span>, <span class="fu">rep</span>(selected_agents, <span class="at">each =</span> trials<span class="dv">-1</span>)))</span>
<span id="cb444-60"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-60" tabindex="-1"></a>  )</span>
<span id="cb444-61"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-61" tabindex="-1"></a>  </span>
<span id="cb444-62"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-62" tabindex="-1"></a>  <span class="co"># Uncertainty data</span></span>
<span id="cb444-63"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-63" tabindex="-1"></a>  uncertainty_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb444-64"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-64" tabindex="-1"></a>    <span class="at">trial =</span> <span class="fu">rep</span>(<span class="dv">2</span><span class="sc">:</span>trials, <span class="fu">length</span>(selected_agents)),</span>
<span id="cb444-65"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-65" tabindex="-1"></a>    <span class="at">agent =</span> <span class="fu">rep</span>(selected_agents, <span class="at">each =</span> trials<span class="dv">-1</span>),</span>
<span id="cb444-66"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-66" tabindex="-1"></a>    <span class="at">prior_lower =</span> <span class="fu">c</span>(prior_lower),</span>
<span id="cb444-67"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-67" tabindex="-1"></a>    <span class="at">prior_upper =</span> <span class="fu">c</span>(prior_upper),</span>
<span id="cb444-68"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-68" tabindex="-1"></a>    <span class="at">posterior_lower =</span> <span class="fu">c</span>(posterior_lower),</span>
<span id="cb444-69"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-69" tabindex="-1"></a>    <span class="at">posterior_upper =</span> <span class="fu">c</span>(posterior_upper),</span>
<span id="cb444-70"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-70" tabindex="-1"></a>    <span class="at">agent_label =</span> <span class="fu">factor</span>(<span class="fu">paste</span>(<span class="st">&quot;Agent&quot;</span>, <span class="fu">rep</span>(selected_agents, <span class="at">each =</span> trials<span class="dv">-1</span>)))</span>
<span id="cb444-71"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-71" tabindex="-1"></a>  )</span>
<span id="cb444-72"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-72" tabindex="-1"></a>  </span>
<span id="cb444-73"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-73" tabindex="-1"></a>  <span class="co"># Calculate cumulative choice proportions</span></span>
<span id="cb444-74"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-74" tabindex="-1"></a>  pred_check_cumulative <span class="ot">&lt;-</span> pred_check_data <span class="sc">%&gt;%</span></span>
<span id="cb444-75"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-75" tabindex="-1"></a>    <span class="fu">group_by</span>(agent_label) <span class="sc">%&gt;%</span></span>
<span id="cb444-76"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-76" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb444-77"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-77" tabindex="-1"></a>      <span class="at">trial_idx =</span> trial <span class="sc">-</span> <span class="dv">1</span>,  <span class="co"># Index starting from 1</span></span>
<span id="cb444-78"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-78" tabindex="-1"></a>      <span class="at">obs_cumulative =</span> <span class="fu">cumsum</span>(observed) <span class="sc">/</span> <span class="fu">seq_along</span>(observed),</span>
<span id="cb444-79"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-79" tabindex="-1"></a>      <span class="at">prior_cumulative =</span> <span class="fu">cumsum</span>(prior_mean) <span class="sc">/</span> <span class="fu">seq_along</span>(prior_mean),</span>
<span id="cb444-80"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-80" tabindex="-1"></a>      <span class="at">posterior_cumulative =</span> <span class="fu">cumsum</span>(posterior_mean) <span class="sc">/</span> <span class="fu">seq_along</span>(posterior_mean)</span>
<span id="cb444-81"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-81" tabindex="-1"></a>    )</span>
<span id="cb444-82"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-82" tabindex="-1"></a>  </span>
<span id="cb444-83"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-83" tabindex="-1"></a>  <span class="co"># Save the results</span></span>
<span id="cb444-84"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-84" tabindex="-1"></a>  <span class="fu">saveRDS</span>(pred_check_cumulative, pred_checks_file)</span>
<span id="cb444-85"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-85" tabindex="-1"></a>  <span class="fu">saveRDS</span>(uncertainty_data, pred_checks_uncertainty_file)</span>
<span id="cb444-86"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-86" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Generated new predictive checks and saved to&quot;</span>, pred_checks_file, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb444-87"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-87" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb444-88"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-88" tabindex="-1"></a>  <span class="co"># Load existing results</span></span>
<span id="cb444-89"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-89" tabindex="-1"></a>  pred_check_cumulative <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(pred_checks_file)</span>
<span id="cb444-90"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-90" tabindex="-1"></a>  uncertainty_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(pred_checks_uncertainty_file)</span>
<span id="cb444-91"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-91" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Loaded existing predictive checks from saved files</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb444-92"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb444-92" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Loaded existing predictive checks from saved files</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-1" tabindex="-1"></a><span class="co"># Plot cumulative choice proportions - Posterior predictive check with uncertainty</span></span>
<span id="cb446-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pred_check_cumulative, <span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb446-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-3" tabindex="-1"></a>  <span class="co"># Add point-wise uncertainty intervals</span></span>
<span id="cb446-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-4" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> uncertainty_data, </span>
<span id="cb446-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-5" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">ymin =</span> posterior_lower, <span class="at">ymax =</span> posterior_upper),</span>
<span id="cb446-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-6" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb446-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-7" tabindex="-1"></a>  <span class="co"># Add observed and predicted lines</span></span>
<span id="cb446-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> obs_cumulative, <span class="at">color =</span> <span class="st">&quot;Observed&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb446-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> posterior_cumulative, <span class="at">color =</span> <span class="st">&quot;Posterior Predicted&quot;</span>), </span>
<span id="cb446-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-10" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb446-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_label, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb446-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb446-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-13" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Posterior Predictive Check with Uncertainty&quot;</span>,</span>
<span id="cb446-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-14" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Observed (solid) vs. Posterior Predicted (dashed) with 95% CI bands&quot;</span>,</span>
<span id="cb446-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-15" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb446-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-16" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion of &#39;Right&#39; Choices&quot;</span>,</span>
<span id="cb446-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-17" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Data Source&quot;</span></span>
<span id="cb446-18"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb446-19"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-19" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span>, <span class="st">&quot;Posterior Predicted&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb446-20"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb446-21"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb446-22"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-22" tabindex="-1"></a></span>
<span id="cb446-23"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-23" tabindex="-1"></a><span class="co"># Plot cumulative choice proportions - Prior predictive check with uncertainty</span></span>
<span id="cb446-24"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-24" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pred_check_cumulative, <span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb446-25"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-25" tabindex="-1"></a>  <span class="co"># Add point-wise uncertainty intervals</span></span>
<span id="cb446-26"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-26" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> uncertainty_data, </span>
<span id="cb446-27"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-27" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">ymin =</span> prior_lower, <span class="at">ymax =</span> prior_upper),</span>
<span id="cb446-28"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-28" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb446-29"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-29" tabindex="-1"></a>  <span class="co"># Add observed and predicted lines</span></span>
<span id="cb446-30"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-30" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> obs_cumulative, <span class="at">color =</span> <span class="st">&quot;Observed&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb446-31"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-31" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> prior_cumulative, <span class="at">color =</span> <span class="st">&quot;Prior Predicted&quot;</span>), </span>
<span id="cb446-32"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-32" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb446-33"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-33" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> agent_label, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb446-34"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-34" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb446-35"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-35" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prior Predictive Check with Uncertainty&quot;</span>,</span>
<span id="cb446-36"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-36" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Observed (solid) vs. Prior Predicted (dashed) with 95% CI bands&quot;</span>,</span>
<span id="cb446-37"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-37" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Trial&quot;</span>,</span>
<span id="cb446-38"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-38" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proportion of &#39;Right&#39; Choices&quot;</span>,</span>
<span id="cb446-39"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-39" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Data Source&quot;</span></span>
<span id="cb446-40"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-40" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb446-41"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-41" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span>, <span class="st">&quot;Prior Predicted&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb446-42"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-42" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb446-43"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-43" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb446-44"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-44" tabindex="-1"></a></span>
<span id="cb446-45"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-45" tabindex="-1"></a><span class="co"># Display both plots using patchwork</span></span>
<span id="cb446-46"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb446-46" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="series_files/figure-html/09-posterior-predictive-checks-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This posterior predictive check compares the observed choice patterns (solid lines) with those predicted by our model (dashed lines) for a few selected agents. Close alignment indicates that our model captures the key patterns in the data well.</p>
</div>
<div id="model-comparison-with-loo-cv" class="section level3 hasAnchor" number="10.7.5">
<h3><span class="header-section-number">10.7.5</span> Model Comparison with LOO-CV<a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#model-comparison-with-loo-cv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, letâ€™s compute Leave-One-Out Cross-Validation (LOO-CV) to assess our modelâ€™s predictive performance. Weâ€™ll also demonstrate how this could be used to compare our WSLS model with a simpler alternative:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb447-1" tabindex="-1"></a><span class="co"># Compute LOO for the multilevel WSLS model</span></span>
<span id="cb447-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb447-2" tabindex="-1"></a>loo_wsls <span class="ot">&lt;-</span> samples_wsls_ml<span class="sc">$</span><span class="fu">loo</span>()</span>
<span id="cb447-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb447-3" tabindex="-1"></a></span>
<span id="cb447-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb447-4" tabindex="-1"></a><span class="co"># Print LOO results</span></span>
<span id="cb447-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb447-5" tabindex="-1"></a><span class="fu">print</span>(loo_wsls)</span></code></pre></div>
<pre><code>## 
## Computed from 4000 by 12000 log-likelihood matrix.
## 
##          Estimate    SE
## elpd_loo  -5687.6  62.8
## p_loo        99.2   1.5
## looic     11375.1 125.6
## ------
## MCSE of elpd_loo is NA.
## MCSE and ESS estimates assume MCMC draws (r_eff in [0.5, 1.6]).
## 
## Pareto k diagnostic values:
##                          Count Pct.    Min. ESS
## (-Inf, 0.7]   (good)     11900 99.2%   2900    
##    (0.7, 1]   (bad)          0  0.0%   &lt;NA&gt;    
##    (1, Inf)   (very bad)   100  0.8%   &lt;NA&gt;    
## See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb449-1" tabindex="-1"></a><span class="co"># Check Pareto k diagnostics</span></span>
<span id="cb449-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb449-2" tabindex="-1"></a>pareto_k_table <span class="ot">&lt;-</span> <span class="fu">table</span>(loo_wsls<span class="sc">$</span>diagnostics<span class="sc">$</span>pareto_k <span class="sc">&gt;</span> <span class="fl">0.7</span>)</span>
<span id="cb449-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb449-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Number of observations with Pareto k &gt; 0.7:&quot;</span>, pareto_k_table[<span class="st">&quot;TRUE&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observations with Pareto k &gt; 0.7: 100</code></pre>
<p>The LOO-CV computation provides an estimate of the modelâ€™s expected predictive accuracy. In a full analysis, we would compare this with alternative models to determine which provides the best balance of fit and generalizability.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-1" tabindex="-1"></a><span class="co"># Visualize distribution of pointwise elpd values</span></span>
<span id="cb451-2"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-2" tabindex="-1"></a>elpd_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb451-3"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-3" tabindex="-1"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loo_wsls<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>]),</span>
<span id="cb451-4"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-4" tabindex="-1"></a>  <span class="at">elpd =</span> loo_wsls<span class="sc">$</span>pointwise[,<span class="st">&quot;elpd_loo&quot;</span>]</span>
<span id="cb451-5"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-5" tabindex="-1"></a>)</span>
<span id="cb451-6"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-6" tabindex="-1"></a></span>
<span id="cb451-7"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-7" tabindex="-1"></a><span class="co"># Create histogram of elpd values</span></span>
<span id="cb451-8"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-8" tabindex="-1"></a><span class="fu">ggplot</span>(elpd_data, <span class="fu">aes</span>(<span class="at">x =</span> elpd)) <span class="sc">+</span></span>
<span id="cb451-9"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb451-10"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(elpd)), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb451-11"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb451-12"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Distribution of Pointwise Expected Log Predictive Density (ELPD)&quot;</span>,</span>
<span id="cb451-13"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-13" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Higher values indicate better prediction for individual observations&quot;</span>,</span>
<span id="cb451-14"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-14" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;ELPD&quot;</span>,</span>
<span id="cb451-15"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-15" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb451-16"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb451-17"><a href="win-stay-lose-shift-a-heuristic-decision-strategy.html#cb451-17" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/09-loo-vis-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>This visualization shows the distribution of pointwise expected log predictive density (ELPD) values, with the mean indicated by the dashed line. Observations with higher ELPD values are better predicted by our model. A long left tail would suggest some observations are particularly difficult for the model to predict and in a real project we should explore what the issues are.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mixture-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-models-of-cognition.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fusaroli/AdvancedCognitiveModeling/edit/master/09-WinStayLoseShift.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["series.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
